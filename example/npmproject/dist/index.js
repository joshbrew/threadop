(()=>{var Hu=(n=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(n,{get:(z,q)=>(typeof require<"u"?require:z)[q]}):n)(function(n){if(typeof require<"u")return require.apply(this,arguments);throw new Error('Dynamic require of "'+n+'" is not supported')});function Np(n=i=>i,{imports:z,message:q,transfer:t,port:h,blocking:p,pool:l,loop:e,animate:o,callback:r}={}){return new Promise((i,u)=>{let s;if(typeof n!="function"){if(typeof n=="string"&&n.startsWith("./")){let c=location.origin,f=location.pathname.split("/");f.pop();let g=f.join("/");g.startsWith("http")?c+="/":c+=g+"/",n=c+n}s=n}else s=qp(n,z);let a=c=>{let f={},g=!1;c.onmessage=y=>{for(let v in f)f[v](y.data.message,y.data.cb)},c.onerror=y=>{console.error(new Error("Worker encountered an error: "+y.message))};let d=(y,v)=>new Promise((T,w)=>{if(c.PORTS)c.postMessage({message:y},v),T(!0);else{if(p){if(g)return new Promise((E,M)=>{M("Thread Blocked")});g=!0}let A=Math.random();f[A]=(E,M)=>{A===M&&(delete f[A],p&&(g=!1),T(E))},c.postMessage({message:y,cb:A},v)}}),m={run:(y,v)=>d(y,v),terminate:()=>{if(URL.revokeObjectURL(s),c.terminate(),c.PORTS){let y=(v,T)=>{v.postMessage({COMMAND:{DELETED:c.id}})};c.PORTS.forEach(y)}},addPort:y=>Gu(c,y,c.id,p),addCallback:(y=T=>{},v)=>{let T=Math.random();return f[T]=v?w=>{y(w),delete f[T]}:y,T},removeCallback:y=>{delete m.callbacks[y]},setLoop:(y,v,T)=>{c.postMessage({message:v,COMMAND:{SETLOOP:y}},T)},setAnimation:(y,v)=>{c.postMessage({message:y,COMMAND:{SETANIM:!0}},v)},stop:()=>{c.postMessage({COMMAND:{STOP:!0}})},worker:c,callbacks:f};return r&&m.addCallback(r),e?m.setLoop(e,q,t):o&&m.setAnimation(q,t),m};if(l){let g=function(){let m=new Worker(s,z||typeof n!="function"?{type:"module"}:void 0),y=Math.random();return m.id=y,c[y]=m,y},c={},f={};for(let m=0;m<l;m++)g();let d=Object.keys(c);if(h&&d.forEach((m,y)=>{let v=c[m];Array.isArray(h)?Gu(v,h[y],v.id,p):Gu(v,h,v.id,p)}),q&&!e&&!o)Promise.all(d.map((m,y)=>{let v=c[m],T=Array.isArray(q)?q[y]:q;return new Promise((w,A)=>{v.onmessage=M=>{Promise.resolve().then(()=>{v.terminate(),delete c[v.id]}),w(M.data.message)},v.onerror=M=>{Promise.resolve().then(()=>{v.terminate(),delete c[v.id]}),A(new Error("Worker encountered an error: "+M.message))};let E={message:T,oneOff:!0};v.postMessage(E,t)})})).then(m=>{URL.revokeObjectURL(s),i(m)}).catch(m=>{URL.revokeObjectURL(s),Object.keys(c).map((y,v)=>{let T=c[y];T&&T.terminate(),delete c[y],delete f.helpers?.[y]}),u(m)});else{let m=0;Object.assign(f,{workers:c,helpers:{},keys:d,run:(v,T,w)=>{if(w)f.helpers[w]?.run(v,T);else if(Array.isArray(v)){let A=v.length;for(let E=0;E<A;E++)f.helpers[d[m]].run(v[E],T[E]),m++,m>=d.length&&(m=0)}else f.helpers[d[m]].run(v,T),m++,m>=d.length&&(m=0)},terminate:v=>{function T(w){f.helpers[w]?.terminate(),delete f.helpers[w],delete f.workers[w]}v?T(v):d.forEach(T)},addWorker:()=>{let v=g(),T=c[v];return y(T),d.length=0,d.push(...d),v},addPort:(v,T)=>{function w(A){return f.helpers[A]?.addPort(v),!0}return T?w(T):d.map(w)},addCallback:(v,T,w)=>{function A(E){return f.helpers[E]?.addCallback(v,T)}return w?A(w):d.map(A)},removeCallback:(v,T)=>{function w(A){return f.helpers[A]?.removeCallback(v),!0}return T?w(T):d.map(w)},setLoop:(v,T,w,A)=>{function E(M){f.helpers[M]?.setLoop(v,T,w)}return A?E(A):d.map(E)},setAnimation:(v,T,w)=>{function A(E){f.helpers[E]?.setAnimation(v,T)}return w?A(w):d.map(A)},stop:v=>{function T(w){f.helpers[w]?.stop()}return v?T(v):d.map(T)}});let y=v=>{f.helpers[v.id]=a(v)};Object.keys(c).forEach((v,T)=>{y(c[v])}),i(f)}}else{let c=Math.random(),f=new Worker(s,z||typeof n!="function"?{type:"module"}:void 0);if(f.id=c,h&&(Array.isArray(h)?h.map(g=>{Gu(f,g,c,p)}):Gu(f,h,c,p)),q&&!e&&!o)f.onmessage=g=>{Promise.resolve().then(()=>{f.terminate(),URL.revokeObjectURL(s)}),i(g.data.message)},f.onerror=g=>{Promise.resolve().then(()=>{f.terminate(),URL.revokeObjectURL(s)}),u(new Error("Worker encountered an error: "+g.message))},f.postMessage({message:q,oneOff:!0},t);else{let g=a(f);i(g)}}})}function jp(n){let z=location.pathname.split("/");z.pop();let q=location.origin+z.join("/")+"/";return typeof n=="string"?(n.startsWith("./")&&(n=q+n),n.includes("import")?`${n}`:`import '${n}';`):Array.isArray(n)?n.map(t=>(t.startsWith("./")&&(t=q+t),t.includes("import")?t:`import '${t}';`)).join(`
`):typeof n=="object"?Object.entries(n).map(([h,p])=>(h.startsWith("./")&&(h=q+h),typeof p=="string"?`import ${p} from '${h}';`:typeof p=="boolean"&&p?`import '${h}'`:`import { ${Object.entries(p).map(([e,o])=>typeof o=="string"?`${e} as ${o}`:e).join(", ")} } from '${h}';`)).join(`
`)+"":""}function Gu(n,z,q,t){let h=new MessageChannel;n.postMessage({COMMAND:{SENDER:h.port1,id:q,blocking:t}},[h.port1]),z.postMessage({COMMAND:{RECEIVER:h.port2,id:q,blocking:t}},[h.port2]),n.PORTS||(n.PORTS=[]),n.PORTS.push(z),z.PORTS||(z.PORTS=[]),z.PORTS.push(n)}var Up=(n=()=>{})=>{globalThis.WORKER={};let z=(t,h,p)=>{if(globalThis.WORKER.SENDERS)for(let l in globalThis.WORKER.SENDERS){if(globalThis.WORKER.BLOCKING[l]){if(globalThis.WORKER.BLOCKED[l]){console.error("Thread Blocked: "+l);continue}globalThis.WORKER.BLOCKED[l]=!0}t?.message&&t?.transfer?globalThis.WORKER.SENDERS[l].postMessage({message:t.message,cb:h},t.transfer):globalThis.WORKER.SENDERS[l].postMessage({message:t,cb:h}),p&&postMessage(!0)}else t?.message&&t?.transfer?postMessage({message:t.message,cb:h},t.transfer):postMessage({message:t,cb:h})},q=(t,h)=>{let p=n(t.data?.message);p?.then?p.then(l=>{h&&h.postMessage(!0),z(l,t.data.cb,t.data.oneOff)}):(h&&h.postMessage(!0),z(p,t.data.cb,t.data.oneOff))};globalThis.onmessage=t=>{if(t.data?.COMMAND){let h=t.data.COMMAND;if(typeof h.SETLOOP=="number"){globalThis.WORKER.LOOP&&clearTimeout(globalThis.WORKER.LOOP);let p=()=>{q(t),globalThis.WORKER.LOOP=setTimeout(()=>{p()},h.SETLOOP)};p()}if(h.SETANIM){globalThis.WORKER.ANIM&&cancelAnimationFrame(globalThis.WORKER.ANIM);let p=()=>{q(t),globalThis.WORKER.ANIM=requestAnimationFrame(()=>{p()})};p()}if(h.STOP&&(globalThis.WORKER.LOOP&&clearTimeout(globalThis.WORKER.LOOP),globalThis.WORKER.ANIM&&cancelAnimationFrame(globalThis.WORKER.ANIM)),h.RECEIVER){let p=h.blocking;globalThis.WORKER.RECEIVERS||(globalThis.WORKER.RTCR=0,globalThis.WORKER.RECEIVERS={});let l=h.id;globalThis.WORKER.RECEIVERS[l]=h.RECEIVER,globalThis.WORKER.RTCR++,h.RECEIVER.onmessage=e=>{q(e,p?h.RECEIVER:void 0)},h.RECEIVER.onerror=e=>{delete globalThis.WORKER.RECEIVERS[l]}}if(h.SENDER){globalThis.WORKER.SENDERS||(globalThis.WORKER.PCTR=0,globalThis.WORKER.SENDERS={},globalThis.WORKER.BLOCKING={},globalThis.WORKER.BLOCKED={});let p=h.blocking,l=h.id?h.id:globalThis.WORKER.PCTR;globalThis.WORKER.SENDERS[l]=h.SENDER,globalThis.WORKER.PCTR++,p&&(globalThis.WORKER.BLOCKING[l]=!0),h.SENDER.onmessage=e=>{globalThis.WORKER.BLOCKING[l]&&(globalThis.WORKER.BLOCKED[l]=!1)},h.SENDER.onerror=e=>{delete globalThis.WORKER.SENDERS[l]}}h.DELETED&&(delete globalThis.WORKER.RECEIVERS?.[h.DELETED],delete globalThis.WORKER.SENDERS?.[h.DELETED])}else q(t)},globalThis.onerror=t=>{console.error(t)}},Vp=Up.toString(),qp=(n,z)=>{let q=Vp.replace("()=>{}",n.toString()),h=`${jp(z)}
(${q})()`,p=new Blob([h],{type:"application/javascript"});return URL.createObjectURL(p)},Wo=Np;(function(n){typeof exports=="object"&&typeof module<"u"?module.exports=n():typeof define=="function"&&define.amd?define([],n):(typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this).Plotly=n()})(function(){return function n(z,q,t){function h(e,o){if(!q[e]){if(!z[e]){var r=typeof Hu=="function"&&Hu;if(!o&&r)return r(e,!0);if(p)return p(e,!0);var i=new Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}var u=q[e]={exports:{}};z[e][0].call(u.exports,function(s){return h(z[e][1][s]||s)},u,u.exports,n,z,q,t)}return q[e].exports}for(var p=typeof Hu=="function"&&Hu,l=0;l<t.length;l++)h(t[l]);return h}({1:[function(n,z,q){"use strict";var t=n("../src/lib"),h={"X,X div":"direction:ltr;font-family:'Open Sans', verdana, arial, sans-serif;margin:0;padding:0;","X input,X button":"font-family:'Open Sans', verdana, arial, sans-serif;","X input:focus,X button:focus":"outline:none;","X a":"text-decoration:none;","X a:hover":"text-decoration:none;","X .crisp":"shape-rendering:crispEdges;","X .user-select-none":"-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;-o-user-select:none;user-select:none;","X svg":"overflow:hidden;","X svg a":"fill:#447adb;","X svg a:hover":"fill:#3c6dc5;","X .main-svg":"position:absolute;top:0;left:0;pointer-events:none;","X .main-svg .draglayer":"pointer-events:all;","X .cursor-default":"cursor:default;","X .cursor-pointer":"cursor:pointer;","X .cursor-crosshair":"cursor:crosshair;","X .cursor-move":"cursor:move;","X .cursor-col-resize":"cursor:col-resize;","X .cursor-row-resize":"cursor:row-resize;","X .cursor-ns-resize":"cursor:ns-resize;","X .cursor-ew-resize":"cursor:ew-resize;","X .cursor-sw-resize":"cursor:sw-resize;","X .cursor-s-resize":"cursor:s-resize;","X .cursor-se-resize":"cursor:se-resize;","X .cursor-w-resize":"cursor:w-resize;","X .cursor-e-resize":"cursor:e-resize;","X .cursor-nw-resize":"cursor:nw-resize;","X .cursor-n-resize":"cursor:n-resize;","X .cursor-ne-resize":"cursor:ne-resize;","X .cursor-grab":"cursor:-webkit-grab;cursor:grab;","X .modebar":"position:absolute;top:2px;right:2px;","X .ease-bg":"-webkit-transition:background-color 0.3s ease 0s;-moz-transition:background-color 0.3s ease 0s;-ms-transition:background-color 0.3s ease 0s;-o-transition:background-color 0.3s ease 0s;transition:background-color 0.3s ease 0s;","X .modebar--hover>:not(.watermark)":"opacity:0;-webkit-transition:opacity 0.3s ease 0s;-moz-transition:opacity 0.3s ease 0s;-ms-transition:opacity 0.3s ease 0s;-o-transition:opacity 0.3s ease 0s;transition:opacity 0.3s ease 0s;","X:hover .modebar--hover .modebar-group":"opacity:1;","X .modebar-group":"float:left;display:inline-block;box-sizing:border-box;padding-left:8px;position:relative;vertical-align:middle;white-space:nowrap;","X .modebar-btn":"position:relative;font-size:16px;padding:3px 4px;height:22px;cursor:pointer;line-height:normal;box-sizing:border-box;","X .modebar-btn svg":"position:relative;top:2px;","X .modebar.vertical":"display:flex;flex-direction:column;flex-wrap:wrap;align-content:flex-end;max-height:100%;","X .modebar.vertical svg":"top:-1px;","X .modebar.vertical .modebar-group":"display:block;float:none;padding-left:0px;padding-bottom:8px;","X .modebar.vertical .modebar-group .modebar-btn":"display:block;text-align:center;","X [data-title]:before,X [data-title]:after":"position:absolute;-webkit-transform:translate3d(0, 0, 0);-moz-transform:translate3d(0, 0, 0);-ms-transform:translate3d(0, 0, 0);-o-transform:translate3d(0, 0, 0);transform:translate3d(0, 0, 0);display:none;opacity:0;z-index:1001;pointer-events:none;top:110%;right:50%;","X [data-title]:hover:before,X [data-title]:hover:after":"display:block;opacity:1;","X [data-title]:before":"content:'';position:absolute;background:transparent;border:6px solid transparent;z-index:1002;margin-top:-12px;border-bottom-color:#69738a;margin-right:-6px;","X [data-title]:after":"content:attr(data-title);background:#69738a;color:white;padding:8px 10px;font-size:12px;line-height:12px;white-space:nowrap;margin-right:-18px;border-radius:2px;","X .vertical [data-title]:before,X .vertical [data-title]:after":"top:0%;right:200%;","X .vertical [data-title]:before":"border:6px solid transparent;border-left-color:#69738a;margin-top:8px;margin-right:-30px;","X .select-outline":"fill:none;stroke-width:1;shape-rendering:crispEdges;","X .select-outline-1":"stroke:white;","X .select-outline-2":"stroke:black;stroke-dasharray:2px 2px;",Y:"font-family:'Open Sans', verdana, arial, sans-serif;position:fixed;top:50px;right:20px;z-index:10000;font-size:10pt;max-width:180px;","Y p":"margin:0;","Y .notifier-note":"min-width:180px;max-width:250px;border:1px solid #fff;z-index:3000;margin:0;background-color:#8c97af;background-color:rgba(140,151,175,0.9);color:#fff;padding:10px;overflow-wrap:break-word;word-wrap:break-word;-ms-hyphens:auto;-webkit-hyphens:auto;hyphens:auto;","Y .notifier-close":"color:#fff;opacity:0.8;float:right;padding:0 5px;background:none;border:none;font-size:20px;font-weight:bold;line-height:20px;","Y .notifier-close:hover":"color:#444;text-decoration:none;cursor:pointer;"};for(var p in h){var l=p.replace(/^,/," ,").replace(/X/g,".js-plotly-plot .plotly").replace(/Y/g,".plotly-notifier");t.addStyleRule(l,h[p])}},{"../src/lib":778}],2:[function(n,z,q){"use strict";z.exports=n("../src/transforms/aggregate")},{"../src/transforms/aggregate":1365}],3:[function(n,z,q){"use strict";z.exports=n("../src/traces/bar")},{"../src/traces/bar":929}],4:[function(n,z,q){"use strict";z.exports=n("../src/traces/barpolar")},{"../src/traces/barpolar":942}],5:[function(n,z,q){"use strict";z.exports=n("../src/traces/box")},{"../src/traces/box":952}],6:[function(n,z,q){"use strict";z.exports=n("../src/components/calendars")},{"../src/components/calendars":641}],7:[function(n,z,q){"use strict";z.exports=n("../src/traces/candlestick")},{"../src/traces/candlestick":961}],8:[function(n,z,q){"use strict";z.exports=n("../src/traces/carpet")},{"../src/traces/carpet":980}],9:[function(n,z,q){"use strict";z.exports=n("../src/traces/choropleth")},{"../src/traces/choropleth":994}],10:[function(n,z,q){"use strict";z.exports=n("../src/traces/choroplethmapbox")},{"../src/traces/choroplethmapbox":1001}],11:[function(n,z,q){"use strict";z.exports=n("../src/traces/cone")},{"../src/traces/cone":1007}],12:[function(n,z,q){"use strict";z.exports=n("../src/traces/contour")},{"../src/traces/contour":1022}],13:[function(n,z,q){"use strict";z.exports=n("../src/traces/contourcarpet")},{"../src/traces/contourcarpet":1033}],14:[function(n,z,q){"use strict";z.exports=n("../src/core")},{"../src/core":755}],15:[function(n,z,q){"use strict";z.exports=n("../src/traces/densitymapbox")},{"../src/traces/densitymapbox":1041}],16:[function(n,z,q){"use strict";z.exports=n("../src/transforms/filter")},{"../src/transforms/filter":1366}],17:[function(n,z,q){"use strict";z.exports=n("../src/traces/funnel")},{"../src/traces/funnel":1051}],18:[function(n,z,q){"use strict";z.exports=n("../src/traces/funnelarea")},{"../src/traces/funnelarea":1060}],19:[function(n,z,q){"use strict";z.exports=n("../src/transforms/groupby")},{"../src/transforms/groupby":1367}],20:[function(n,z,q){"use strict";z.exports=n("../src/traces/heatmap")},{"../src/traces/heatmap":1073}],21:[function(n,z,q){"use strict";z.exports=n("../src/traces/heatmapgl")},{"../src/traces/heatmapgl":1083}],22:[function(n,z,q){"use strict";z.exports=n("../src/traces/histogram")},{"../src/traces/histogram":1095}],23:[function(n,z,q){"use strict";z.exports=n("../src/traces/histogram2d")},{"../src/traces/histogram2d":1101}],24:[function(n,z,q){"use strict";z.exports=n("../src/traces/histogram2dcontour")},{"../src/traces/histogram2dcontour":1105}],25:[function(n,z,q){"use strict";z.exports=n("../src/traces/image")},{"../src/traces/image":1113}],26:[function(n,z,q){"use strict";var t=n("./core");t.register([n("./bar"),n("./box"),n("./heatmap"),n("./histogram"),n("./histogram2d"),n("./histogram2dcontour"),n("./contour"),n("./scatterternary"),n("./violin"),n("./funnel"),n("./waterfall"),n("./image"),n("./pie"),n("./sunburst"),n("./treemap"),n("./funnelarea"),n("./scatter3d"),n("./surface"),n("./isosurface"),n("./volume"),n("./mesh3d"),n("./cone"),n("./streamtube"),n("./scattergeo"),n("./choropleth"),n("./scattergl"),n("./splom"),n("./pointcloud"),n("./heatmapgl"),n("./parcoords"),n("./parcats"),n("./scattermapbox"),n("./choroplethmapbox"),n("./densitymapbox"),n("./sankey"),n("./indicator"),n("./table"),n("./carpet"),n("./scattercarpet"),n("./contourcarpet"),n("./ohlc"),n("./candlestick"),n("./scatterpolar"),n("./scatterpolargl"),n("./barpolar")]),t.register([n("./aggregate"),n("./filter"),n("./groupby"),n("./sort")]),t.register([n("./calendars")]),z.exports=t},{"./aggregate":2,"./bar":3,"./barpolar":4,"./box":5,"./calendars":6,"./candlestick":7,"./carpet":8,"./choropleth":9,"./choroplethmapbox":10,"./cone":11,"./contour":12,"./contourcarpet":13,"./core":14,"./densitymapbox":15,"./filter":16,"./funnel":17,"./funnelarea":18,"./groupby":19,"./heatmap":20,"./heatmapgl":21,"./histogram":22,"./histogram2d":23,"./histogram2dcontour":24,"./image":25,"./indicator":27,"./isosurface":28,"./mesh3d":29,"./ohlc":30,"./parcats":31,"./parcoords":32,"./pie":33,"./pointcloud":34,"./sankey":35,"./scatter3d":36,"./scattercarpet":37,"./scattergeo":38,"./scattergl":39,"./scattermapbox":40,"./scatterpolar":41,"./scatterpolargl":42,"./scatterternary":43,"./sort":44,"./splom":45,"./streamtube":46,"./sunburst":47,"./surface":48,"./table":49,"./treemap":50,"./violin":51,"./volume":52,"./waterfall":53}],27:[function(n,z,q){"use strict";z.exports=n("../src/traces/indicator")},{"../src/traces/indicator":1121}],28:[function(n,z,q){"use strict";z.exports=n("../src/traces/isosurface")},{"../src/traces/isosurface":1127}],29:[function(n,z,q){"use strict";z.exports=n("../src/traces/mesh3d")},{"../src/traces/mesh3d":1132}],30:[function(n,z,q){"use strict";z.exports=n("../src/traces/ohlc")},{"../src/traces/ohlc":1137}],31:[function(n,z,q){"use strict";z.exports=n("../src/traces/parcats")},{"../src/traces/parcats":1146}],32:[function(n,z,q){"use strict";z.exports=n("../src/traces/parcoords")},{"../src/traces/parcoords":1156}],33:[function(n,z,q){"use strict";z.exports=n("../src/traces/pie")},{"../src/traces/pie":1167}],34:[function(n,z,q){"use strict";z.exports=n("../src/traces/pointcloud")},{"../src/traces/pointcloud":1176}],35:[function(n,z,q){"use strict";z.exports=n("../src/traces/sankey")},{"../src/traces/sankey":1182}],36:[function(n,z,q){"use strict";z.exports=n("../src/traces/scatter3d")},{"../src/traces/scatter3d":1220}],37:[function(n,z,q){"use strict";z.exports=n("../src/traces/scattercarpet")},{"../src/traces/scattercarpet":1227}],38:[function(n,z,q){"use strict";z.exports=n("../src/traces/scattergeo")},{"../src/traces/scattergeo":1235}],39:[function(n,z,q){"use strict";z.exports=n("../src/traces/scattergl")},{"../src/traces/scattergl":1248}],40:[function(n,z,q){"use strict";z.exports=n("../src/traces/scattermapbox")},{"../src/traces/scattermapbox":1258}],41:[function(n,z,q){"use strict";z.exports=n("../src/traces/scatterpolar")},{"../src/traces/scatterpolar":1266}],42:[function(n,z,q){"use strict";z.exports=n("../src/traces/scatterpolargl")},{"../src/traces/scatterpolargl":1273}],43:[function(n,z,q){"use strict";z.exports=n("../src/traces/scatterternary")},{"../src/traces/scatterternary":1281}],44:[function(n,z,q){"use strict";z.exports=n("../src/transforms/sort")},{"../src/transforms/sort":1369}],45:[function(n,z,q){"use strict";z.exports=n("../src/traces/splom")},{"../src/traces/splom":1290}],46:[function(n,z,q){"use strict";z.exports=n("../src/traces/streamtube")},{"../src/traces/streamtube":1298}],47:[function(n,z,q){"use strict";z.exports=n("../src/traces/sunburst")},{"../src/traces/sunburst":1306}],48:[function(n,z,q){"use strict";z.exports=n("../src/traces/surface")},{"../src/traces/surface":1315}],49:[function(n,z,q){"use strict";z.exports=n("../src/traces/table")},{"../src/traces/table":1323}],50:[function(n,z,q){"use strict";z.exports=n("../src/traces/treemap")},{"../src/traces/treemap":1332}],51:[function(n,z,q){"use strict";z.exports=n("../src/traces/violin")},{"../src/traces/violin":1344}],52:[function(n,z,q){"use strict";z.exports=n("../src/traces/volume")},{"../src/traces/volume":1352}],53:[function(n,z,q){"use strict";z.exports=n("../src/traces/waterfall")},{"../src/traces/waterfall":1360}],54:[function(n,z,q){"use strict";z.exports=function(o){var r=(o=o||{}).eye||[0,0,1],i=o.center||[0,0,0],u=o.up||[0,1,0],s=o.distanceLimits||[0,1/0],a=o.mode||"turntable",c=t(),f=h(),g=p();return c.setDistanceLimits(s[0],s[1]),c.lookAt(0,r,i,u),f.setDistanceLimits(s[0],s[1]),f.lookAt(0,r,i,u),g.setDistanceLimits(s[0],s[1]),g.lookAt(0,r,i,u),new l({turntable:c,orbit:f,matrix:g},a)};var t=n("turntable-camera-controller"),h=n("orbit-camera-controller"),p=n("matrix-camera-controller");function l(o,r){this._controllerNames=Object.keys(o),this._controllerList=this._controllerNames.map(function(i){return o[i]}),this._mode=r,this._active=o[r],this._active||(this._mode="turntable",this._active=o.turntable),this.modes=this._controllerNames,this.computedMatrix=this._active.computedMatrix,this.computedEye=this._active.computedEye,this.computedUp=this._active.computedUp,this.computedCenter=this._active.computedCenter,this.computedRadius=this._active.computedRadius}var e=l.prototype;[["flush",1],["idle",1],["lookAt",4],["rotate",4],["pan",4],["translate",4],["setMatrix",2],["setDistanceLimits",2],["setDistance",2]].forEach(function(o){for(var r=o[0],i=[],u=0;u<o[1];++u)i.push("a"+u);var s="var cc=this._controllerList;for(var i=0;i<cc.length;++i){cc[i]."+o[0]+"("+i.join()+")}";e[r]=Function.apply(null,i.concat(s))}),e.recalcMatrix=function(o){this._active.recalcMatrix(o)},e.getDistance=function(o){return this._active.getDistance(o)},e.getDistanceLimits=function(o){return this._active.getDistanceLimits(o)},e.lastT=function(){return this._active.lastT()},e.setMode=function(o){if(o!==this._mode){var r=this._controllerNames.indexOf(o);if(!(r<0)){var i=this._active,u=this._controllerList[r],s=Math.max(i.lastT(),u.lastT());i.recalcMatrix(s),u.setMatrix(s,i.computedMatrix),this._active=u,this._mode=o,this.computedMatrix=this._active.computedMatrix,this.computedEye=this._active.computedEye,this.computedUp=this._active.computedUp,this.computedCenter=this._active.computedCenter,this.computedRadius=this._active.computedRadius}}},e.getMode=function(){return this._mode}},{"matrix-camera-controller":480,"orbit-camera-controller":501,"turntable-camera-controller":581}],55:[function(n,z,q){(function(t,h){typeof q=="object"&&typeof z<"u"?h(q,n("d3-array"),n("d3-collection"),n("d3-shape"),n("elementary-circuits-directed-graph")):h(t.d3=t.d3||{},t.d3,t.d3,t.d3,null)})(this,function(t,h,p,l,e){"use strict";function o(ae){return ae.target.depth}function r(ae,oe){return ae.sourceLinks.length?ae.depth:oe-1}function i(ae){return function(){return ae}}e=e&&e.hasOwnProperty("default")?e.default:e;var u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ae){return typeof ae}:function(ae){return ae&&typeof Symbol=="function"&&ae.constructor===Symbol&&ae!==Symbol.prototype?"symbol":typeof ae};function s(ae,oe){return c(ae.source,oe.source)||ae.index-oe.index}function a(ae,oe){return c(ae.target,oe.target)||ae.index-oe.index}function c(ae,oe){return ae.partOfCycle===oe.partOfCycle?ae.y0-oe.y0:ae.circularLinkType==="top"||oe.circularLinkType==="bottom"?-1:1}function f(ae){return ae.value}function g(ae){return(ae.y0+ae.y1)/2}function d(ae){return g(ae.source)}function m(ae){return g(ae.target)}function y(ae){return ae.index}function v(ae){return ae.nodes}function T(ae){return ae.links}function w(ae,oe){var de=ae.get(oe);if(!de)throw new Error("missing: "+oe);return de}function A(ae,oe){return oe(ae)}function E(ae,oe,de){var le=0;if(de===null){for(var fe=[],ue=0;ue<ae.links.length;ue++){var we=ae.links[ue],Ae=we.source.index,Se=we.target.index;fe[Ae]||(fe[Ae]=[]),fe[Se]||(fe[Se]=[]),fe[Ae].indexOf(Se)===-1&&fe[Ae].push(Se)}var ke=e(fe);ke.sort(function(ge,De){return ge.length-De.length});var Me={};for(ue=0;ue<ke.length;ue++){var ve=ke[ue].slice(-2);Me[ve[0]]||(Me[ve[0]]={}),Me[ve[0]][ve[1]]=!0}ae.links.forEach(function(ge){var De=ge.target.index,_e=ge.source.index;De===_e||Me[_e]&&Me[_e][De]?(ge.circular=!0,ge.circularLinkID=le,le+=1):ge.circular=!1})}else ae.links.forEach(function(ge){ge.source[de]<ge.target[de]?ge.circular=!1:(ge.circular=!0,ge.circularLinkID=le,le+=1)})}function M(ae,oe){var de=0,le=0;ae.links.forEach(function(fe){fe.circular&&(fe.source.circularLinkType||fe.target.circularLinkType?fe.circularLinkType=fe.source.circularLinkType?fe.source.circularLinkType:fe.target.circularLinkType:fe.circularLinkType=de<le?"top":"bottom",fe.circularLinkType=="top"?de+=1:le+=1,ae.nodes.forEach(function(ue){A(ue,oe)!=A(fe.source,oe)&&A(ue,oe)!=A(fe.target,oe)||(ue.circularLinkType=fe.circularLinkType)}))}),ae.links.forEach(function(fe){fe.circular&&(fe.source.circularLinkType==fe.target.circularLinkType&&(fe.circularLinkType=fe.source.circularLinkType),ee(fe,oe)&&(fe.circularLinkType=fe.source.circularLinkType))})}function b(ae){var oe=Math.abs(ae.y1-ae.y0),de=Math.abs(ae.target.x0-ae.source.x1);return Math.atan(de/oe)}function _(ae,oe){var de=0;ae.sourceLinks.forEach(function(fe){de=fe.circular&&!ee(fe,oe)?de+1:de});var le=0;return ae.targetLinks.forEach(function(fe){le=fe.circular&&!ee(fe,oe)?le+1:le}),de+le}function S(ae){var oe=ae.source.sourceLinks,de=0;oe.forEach(function(ue){de=ue.circular?de+1:de});var le=ae.target.targetLinks,fe=0;return le.forEach(function(ue){fe=ue.circular?fe+1:fe}),!(de>1||fe>1)}function C(ae,oe,de){return ae.sort(L),ae.forEach(function(le,fe){var ue,we,Ae=0;if(ee(le,de)&&S(le))le.circularPathData.verticalBuffer=Ae+le.width/2;else{for(var Se=0;Se<fe;Se++)if(ue=ae[fe],we=ae[Se],!(ue.source.column<we.target.column||ue.target.column>we.source.column)){var ke=ae[Se].circularPathData.verticalBuffer+ae[Se].width/2+oe;Ae=ke>Ae?ke:Ae}le.circularPathData.verticalBuffer=Ae+le.width/2}}),ae}function k(ae,oe,de,le){var fe=h.min(ae.links,function(ue){return ue.source.y0});ae.links.forEach(function(ue){ue.circular&&(ue.circularPathData={})}),C(ae.links.filter(function(ue){return ue.circularLinkType=="top"}),oe,le),C(ae.links.filter(function(ue){return ue.circularLinkType=="bottom"}),oe,le),ae.links.forEach(function(ue){if(ue.circular){if(ue.circularPathData.arcRadius=ue.width+10,ue.circularPathData.leftNodeBuffer=5,ue.circularPathData.rightNodeBuffer=5,ue.circularPathData.sourceWidth=ue.source.x1-ue.source.x0,ue.circularPathData.sourceX=ue.source.x0+ue.circularPathData.sourceWidth,ue.circularPathData.targetX=ue.target.x0,ue.circularPathData.sourceY=ue.y0,ue.circularPathData.targetY=ue.y1,ee(ue,le)&&S(ue))ue.circularPathData.leftSmallArcRadius=10+ue.width/2,ue.circularPathData.leftLargeArcRadius=10+ue.width/2,ue.circularPathData.rightSmallArcRadius=10+ue.width/2,ue.circularPathData.rightLargeArcRadius=10+ue.width/2,ue.circularLinkType=="bottom"?(ue.circularPathData.verticalFullExtent=ue.source.y1+25+ue.circularPathData.verticalBuffer,ue.circularPathData.verticalLeftInnerExtent=ue.circularPathData.verticalFullExtent-ue.circularPathData.leftLargeArcRadius,ue.circularPathData.verticalRightInnerExtent=ue.circularPathData.verticalFullExtent-ue.circularPathData.rightLargeArcRadius):(ue.circularPathData.verticalFullExtent=ue.source.y0-25-ue.circularPathData.verticalBuffer,ue.circularPathData.verticalLeftInnerExtent=ue.circularPathData.verticalFullExtent+ue.circularPathData.leftLargeArcRadius,ue.circularPathData.verticalRightInnerExtent=ue.circularPathData.verticalFullExtent+ue.circularPathData.rightLargeArcRadius);else{var we=ue.source.column,Ae=ue.circularLinkType,Se=ae.links.filter(function(ve){return ve.source.column==we&&ve.circularLinkType==Ae});ue.circularLinkType=="bottom"?Se.sort(R):Se.sort(I);var ke=0;Se.forEach(function(ve,ge){ve.circularLinkID==ue.circularLinkID&&(ue.circularPathData.leftSmallArcRadius=10+ue.width/2+ke,ue.circularPathData.leftLargeArcRadius=10+ue.width/2+ge*oe+ke),ke+=ve.width}),we=ue.target.column,Se=ae.links.filter(function(ve){return ve.target.column==we&&ve.circularLinkType==Ae}),ue.circularLinkType=="bottom"?Se.sort(O):Se.sort(V),ke=0,Se.forEach(function(ve,ge){ve.circularLinkID==ue.circularLinkID&&(ue.circularPathData.rightSmallArcRadius=10+ue.width/2+ke,ue.circularPathData.rightLargeArcRadius=10+ue.width/2+ge*oe+ke),ke+=ve.width}),ue.circularLinkType=="bottom"?(ue.circularPathData.verticalFullExtent=Math.max(de,ue.source.y1,ue.target.y1)+25+ue.circularPathData.verticalBuffer,ue.circularPathData.verticalLeftInnerExtent=ue.circularPathData.verticalFullExtent-ue.circularPathData.leftLargeArcRadius,ue.circularPathData.verticalRightInnerExtent=ue.circularPathData.verticalFullExtent-ue.circularPathData.rightLargeArcRadius):(ue.circularPathData.verticalFullExtent=fe-25-ue.circularPathData.verticalBuffer,ue.circularPathData.verticalLeftInnerExtent=ue.circularPathData.verticalFullExtent+ue.circularPathData.leftLargeArcRadius,ue.circularPathData.verticalRightInnerExtent=ue.circularPathData.verticalFullExtent+ue.circularPathData.rightLargeArcRadius)}ue.circularPathData.leftInnerExtent=ue.circularPathData.sourceX+ue.circularPathData.leftNodeBuffer,ue.circularPathData.rightInnerExtent=ue.circularPathData.targetX-ue.circularPathData.rightNodeBuffer,ue.circularPathData.leftFullExtent=ue.circularPathData.sourceX+ue.circularPathData.leftLargeArcRadius+ue.circularPathData.leftNodeBuffer,ue.circularPathData.rightFullExtent=ue.circularPathData.targetX-ue.circularPathData.rightLargeArcRadius-ue.circularPathData.rightNodeBuffer}if(ue.circular)ue.path=function(ve){var ge="";return ge=ve.circularLinkType=="top"?"M"+ve.circularPathData.sourceX+" "+ve.circularPathData.sourceY+" L"+ve.circularPathData.leftInnerExtent+" "+ve.circularPathData.sourceY+" A"+ve.circularPathData.leftLargeArcRadius+" "+ve.circularPathData.leftSmallArcRadius+" 0 0 0 "+ve.circularPathData.leftFullExtent+" "+(ve.circularPathData.sourceY-ve.circularPathData.leftSmallArcRadius)+" L"+ve.circularPathData.leftFullExtent+" "+ve.circularPathData.verticalLeftInnerExtent+" A"+ve.circularPathData.leftLargeArcRadius+" "+ve.circularPathData.leftLargeArcRadius+" 0 0 0 "+ve.circularPathData.leftInnerExtent+" "+ve.circularPathData.verticalFullExtent+" L"+ve.circularPathData.rightInnerExtent+" "+ve.circularPathData.verticalFullExtent+" A"+ve.circularPathData.rightLargeArcRadius+" "+ve.circularPathData.rightLargeArcRadius+" 0 0 0 "+ve.circularPathData.rightFullExtent+" "+ve.circularPathData.verticalRightInnerExtent+" L"+ve.circularPathData.rightFullExtent+" "+(ve.circularPathData.targetY-ve.circularPathData.rightSmallArcRadius)+" A"+ve.circularPathData.rightLargeArcRadius+" "+ve.circularPathData.rightSmallArcRadius+" 0 0 0 "+ve.circularPathData.rightInnerExtent+" "+ve.circularPathData.targetY+" L"+ve.circularPathData.targetX+" "+ve.circularPathData.targetY:"M"+ve.circularPathData.sourceX+" "+ve.circularPathData.sourceY+" L"+ve.circularPathData.leftInnerExtent+" "+ve.circularPathData.sourceY+" A"+ve.circularPathData.leftLargeArcRadius+" "+ve.circularPathData.leftSmallArcRadius+" 0 0 1 "+ve.circularPathData.leftFullExtent+" "+(ve.circularPathData.sourceY+ve.circularPathData.leftSmallArcRadius)+" L"+ve.circularPathData.leftFullExtent+" "+ve.circularPathData.verticalLeftInnerExtent+" A"+ve.circularPathData.leftLargeArcRadius+" "+ve.circularPathData.leftLargeArcRadius+" 0 0 1 "+ve.circularPathData.leftInnerExtent+" "+ve.circularPathData.verticalFullExtent+" L"+ve.circularPathData.rightInnerExtent+" "+ve.circularPathData.verticalFullExtent+" A"+ve.circularPathData.rightLargeArcRadius+" "+ve.circularPathData.rightLargeArcRadius+" 0 0 1 "+ve.circularPathData.rightFullExtent+" "+ve.circularPathData.verticalRightInnerExtent+" L"+ve.circularPathData.rightFullExtent+" "+(ve.circularPathData.targetY+ve.circularPathData.rightSmallArcRadius)+" A"+ve.circularPathData.rightLargeArcRadius+" "+ve.circularPathData.rightSmallArcRadius+" 0 0 1 "+ve.circularPathData.rightInnerExtent+" "+ve.circularPathData.targetY+" L"+ve.circularPathData.targetX+" "+ve.circularPathData.targetY,ge}(ue);else{var Me=l.linkHorizontal().source(function(ve){return[ve.source.x0+(ve.source.x1-ve.source.x0),ve.y0]}).target(function(ve){return[ve.target.x0,ve.y1]});ue.path=Me(ue)}})}function L(ae,oe){return J(ae)==J(oe)?ae.circularLinkType=="bottom"?R(ae,oe):I(ae,oe):J(oe)-J(ae)}function I(ae,oe){return ae.y0-oe.y0}function R(ae,oe){return oe.y0-ae.y0}function V(ae,oe){return ae.y1-oe.y1}function O(ae,oe){return oe.y1-ae.y1}function J(ae){return ae.target.column-ae.source.column}function D(ae){return ae.target.x0-ae.source.x1}function B(ae,oe){var de=b(ae),le=D(oe)/Math.tan(de);return $(ae)=="up"?ae.y1+le:ae.y1-le}function N(ae,oe){var de=b(ae),le=D(oe)/Math.tan(de);return $(ae)=="up"?ae.y1-le:ae.y1+le}function F(ae,oe,de,le){ae.links.forEach(function(fe){if(!fe.circular&&fe.target.column-fe.source.column>1){var ue=fe.source.column+1,we=fe.target.column-1,Ae=1,Se=we-ue+1;for(Ae=1;ue<=we;ue++,Ae++)ae.nodes.forEach(function(ke){if(ke.column==ue){var Me,ve=Ae/(Se+1),ge=Math.pow(1-ve,3),De=3*ve*Math.pow(1-ve,2),_e=3*Math.pow(ve,2)*(1-ve),Pe=Math.pow(ve,3),Fe=ge*fe.y0+De*fe.y0+_e*fe.y1+Pe*fe.y1,ze=Fe-fe.width/2,He=Fe+fe.width/2;ze>ke.y0&&ze<ke.y1?(Me=ke.y1-ze+10,Me=ke.circularLinkType=="bottom"?Me:-Me,ke=j(ke,Me,oe,de),ae.nodes.forEach(function(et){A(et,le)!=A(ke,le)&&et.column==ke.column&&H(ke,et)&&j(et,Me,oe,de)})):(He>ke.y0&&He<ke.y1||ze<ke.y0&&He>ke.y1)&&(Me=He-ke.y0+10,ke=j(ke,Me,oe,de),ae.nodes.forEach(function(et){A(et,le)!=A(ke,le)&&et.column==ke.column&&et.y0<ke.y1&&et.y1>ke.y1&&j(et,Me,oe,de)}))}})}})}function H(ae,oe){return ae.y0>oe.y0&&ae.y0<oe.y1||ae.y1>oe.y0&&ae.y1<oe.y1||ae.y0<oe.y0&&ae.y1>oe.y1}function j(ae,oe,de,le){return ae.y0+oe>=de&&ae.y1+oe<=le&&(ae.y0=ae.y0+oe,ae.y1=ae.y1+oe,ae.targetLinks.forEach(function(fe){fe.y1=fe.y1+oe}),ae.sourceLinks.forEach(function(fe){fe.y0=fe.y0+oe})),ae}function G(ae,oe,de,le){ae.nodes.forEach(function(fe){le&&fe.y+(fe.y1-fe.y0)>oe&&(fe.y=fe.y-(fe.y+(fe.y1-fe.y0)-oe));var ue=ae.links.filter(function(Se){return A(Se.source,de)==A(fe,de)}),we=ue.length;we>1&&ue.sort(function(Se,ke){if(!Se.circular&&!ke.circular){if(Se.target.column==ke.target.column||!Q(Se,ke))return Se.y1-ke.y1;if(Se.target.column>ke.target.column){var Me=N(ke,Se);return Se.y1-Me}if(ke.target.column>Se.target.column)return N(Se,ke)-ke.y1}return Se.circular&&!ke.circular?Se.circularLinkType=="top"?-1:1:ke.circular&&!Se.circular?ke.circularLinkType=="top"?1:-1:Se.circular&&ke.circular?Se.circularLinkType===ke.circularLinkType&&Se.circularLinkType=="top"?Se.target.column===ke.target.column?Se.target.y1-ke.target.y1:ke.target.column-Se.target.column:Se.circularLinkType===ke.circularLinkType&&Se.circularLinkType=="bottom"?Se.target.column===ke.target.column?ke.target.y1-Se.target.y1:Se.target.column-ke.target.column:Se.circularLinkType=="top"?-1:1:void 0});var Ae=fe.y0;ue.forEach(function(Se){Se.y0=Ae+Se.width/2,Ae+=Se.width}),ue.forEach(function(Se,ke){if(Se.circularLinkType=="bottom"){for(var Me=ke+1,ve=0;Me<we;Me++)ve+=ue[Me].width;Se.y0=fe.y1-ve-Se.width/2}})})}function W(ae,oe,de){ae.nodes.forEach(function(le){var fe=ae.links.filter(function(Ae){return A(Ae.target,de)==A(le,de)}),ue=fe.length;ue>1&&fe.sort(function(Ae,Se){if(!Ae.circular&&!Se.circular){if(Ae.source.column==Se.source.column||!Q(Ae,Se))return Ae.y0-Se.y0;if(Se.source.column<Ae.source.column){var ke=B(Se,Ae);return Ae.y0-ke}if(Ae.source.column<Se.source.column)return B(Ae,Se)-Se.y0}return Ae.circular&&!Se.circular?Ae.circularLinkType=="top"?-1:1:Se.circular&&!Ae.circular?Se.circularLinkType=="top"?1:-1:Ae.circular&&Se.circular?Ae.circularLinkType===Se.circularLinkType&&Ae.circularLinkType=="top"?Ae.source.column===Se.source.column?Ae.source.y1-Se.source.y1:Ae.source.column-Se.source.column:Ae.circularLinkType===Se.circularLinkType&&Ae.circularLinkType=="bottom"?Ae.source.column===Se.source.column?Ae.source.y1-Se.source.y1:Se.source.column-Ae.source.column:Ae.circularLinkType=="top"?-1:1:void 0});var we=le.y0;fe.forEach(function(Ae){Ae.y1=we+Ae.width/2,we+=Ae.width}),fe.forEach(function(Ae,Se){if(Ae.circularLinkType=="bottom"){for(var ke=Se+1,Me=0;ke<ue;ke++)Me+=fe[ke].width;Ae.y1=le.y1-Me-Ae.width/2}})})}function Q(ae,oe){return $(ae)==$(oe)}function $(ae){return ae.y0-ae.y1>0?"up":"down"}function ee(ae,oe){return A(ae.source,oe)==A(ae.target,oe)}function ie(ae,oe,de){var le=ae.nodes,fe=ae.links,ue=!1,we=!1;if(fe.forEach(function(ke){ke.circularLinkType=="top"?ue=!0:ke.circularLinkType=="bottom"&&(we=!0)}),ue==0||we==0){var Ae=h.min(le,function(ke){return ke.y0}),Se=(de-oe)/(h.max(le,function(ke){return ke.y1})-Ae);le.forEach(function(ke){var Me=(ke.y1-ke.y0)*Se;ke.y0=(ke.y0-Ae)*Se,ke.y1=ke.y0+Me}),fe.forEach(function(ke){ke.y0=(ke.y0-Ae)*Se,ke.y1=(ke.y1-Ae)*Se,ke.width=ke.width*Se})}}t.sankeyCircular=function(){var ae,oe,de=0,le=0,fe=1,ue=1,we=24,Ae=y,Se=r,ke=v,Me=T,ve=32,ge=2,De=null;function _e(){var Re={nodes:ke.apply(null,arguments),links:Me.apply(null,arguments)};Pe(Re),E(Re,Ae,De),Fe(Re),ze(Re),M(Re,Ae),He(Re,ve,Ae),et(Re);for(var Ze=4,Ke=0;Ke<Ze;Ke++)G(Re,ue,Ae),W(Re,ue,Ae),F(Re,le,ue,Ae),G(Re,ue,Ae),W(Re,ue,Ae);return ie(Re,le,ue),k(Re,ge,ue,Ae),Re}function Pe(Re){Re.nodes.forEach(function(Ke,$e){Ke.index=$e,Ke.sourceLinks=[],Ke.targetLinks=[]});var Ze=p.map(Re.nodes,Ae);return Re.links.forEach(function(Ke,$e){Ke.index=$e;var rt=Ke.source,at=Ke.target;(typeof rt>"u"?"undefined":u(rt))!=="object"&&(rt=Ke.source=w(Ze,rt)),(typeof at>"u"?"undefined":u(at))!=="object"&&(at=Ke.target=w(Ze,at)),rt.sourceLinks.push(Ke),at.targetLinks.push(Ke)}),Re}function Fe(Re){Re.nodes.forEach(function(Ze){Ze.partOfCycle=!1,Ze.value=Math.max(h.sum(Ze.sourceLinks,f),h.sum(Ze.targetLinks,f)),Ze.sourceLinks.forEach(function(Ke){Ke.circular&&(Ze.partOfCycle=!0,Ze.circularLinkType=Ke.circularLinkType)}),Ze.targetLinks.forEach(function(Ke){Ke.circular&&(Ze.partOfCycle=!0,Ze.circularLinkType=Ke.circularLinkType)})})}function ze(Re){var Ze,Ke,$e;for(Ze=Re.nodes,Ke=[],$e=0;Ze.length;++$e,Ze=Ke,Ke=[])Ze.forEach(function(rt){rt.depth=$e,rt.sourceLinks.forEach(function(at){Ke.indexOf(at.target)<0&&!at.circular&&Ke.push(at.target)})});for(Ze=Re.nodes,Ke=[],$e=0;Ze.length;++$e,Ze=Ke,Ke=[])Ze.forEach(function(rt){rt.height=$e,rt.targetLinks.forEach(function(at){Ke.indexOf(at.source)<0&&!at.circular&&Ke.push(at.source)})});Re.nodes.forEach(function(rt){rt.column=Math.floor(Se.call(null,rt,$e))})}function He(Re,Ze,Ke){var $e=p.nest().key(function(Ie){return Ie.column}).sortKeys(h.ascending).entries(Re.nodes).map(function(Ie){return Ie.values});(function(Ie){if(oe){var be=1/0;$e.forEach(function(ot){var Ce=ue*oe/(ot.length+1);be=Ce<be?Ce:be}),ae=be}var We=h.min($e,function(ot){return(ue-le-(ot.length-1)*ae)/h.sum(ot,f)});We*=.3,Re.links.forEach(function(ot){ot.width=ot.value*We});var Ge=function(ot){var Ce=0,Ue=0,Ye=0,xe=0,Ee=h.max(ot.nodes,function(Je){return Je.column});return ot.links.forEach(function(Je){Je.circular&&(Je.circularLinkType=="top"?Ce+=Je.width:Ue+=Je.width,Je.target.column==0&&(xe+=Je.width),Je.source.column==Ee&&(Ye+=Je.width))}),{top:Ce=Ce>0?Ce+25+10:Ce,bottom:Ue=Ue>0?Ue+25+10:Ue,left:xe=xe>0?xe+25+10:xe,right:Ye=Ye>0?Ye+25+10:Ye}}(Re),st=function(ot,Ce){var Ue=h.max(ot.nodes,function(it){return it.column}),Ye=fe-de,xe=ue-le,Ee=Ye/(Ye+Ce.right+Ce.left),Je=xe/(xe+Ce.top+Ce.bottom);return de=de*Ee+Ce.left,fe=Ce.right==0?fe:fe*Ee,le=le*Je+Ce.top,ue*=Je,ot.nodes.forEach(function(it){it.x0=de+it.column*((fe-de-we)/Ue),it.x1=it.x0+we}),Je}(Re,Ge);We*=st,Re.links.forEach(function(ot){ot.width=ot.value*We}),$e.forEach(function(ot){var Ce=ot.length;ot.forEach(function(Ue,Ye){Ue.depth==$e.length-1&&Ce==1||Ue.depth==0&&Ce==1?(Ue.y0=ue/2-Ue.value*We,Ue.y1=Ue.y0+Ue.value*We):Ue.partOfCycle?_(Ue,Ie)==0?(Ue.y0=ue/2+Ye,Ue.y1=Ue.y0+Ue.value*We):Ue.circularLinkType=="top"?(Ue.y0=le+Ye,Ue.y1=Ue.y0+Ue.value*We):(Ue.y0=ue-Ue.value*We-Ye,Ue.y1=Ue.y0+Ue.value*We):Ge.top==0||Ge.bottom==0?(Ue.y0=(ue-le)/Ce*Ye,Ue.y1=Ue.y0+Ue.value*We):(Ue.y0=(ue-le)/2-Ce/2+Ye,Ue.y1=Ue.y0+Ue.value*We)})})})(Ke),gt();for(var rt=1,at=Ze;at>0;--at)lt(rt*=.99,Ke),gt();function lt(Ie,be){var We=$e.length;$e.forEach(function(Ge){var st=Ge.length,ot=Ge[0].depth;Ge.forEach(function(Ce){var Ue;if((Ce.sourceLinks.length||Ce.targetLinks.length)&&!(Ce.partOfCycle&&_(Ce,be)>0))if(ot==0&&st==1)Ue=Ce.y1-Ce.y0,Ce.y0=ue/2-Ue/2,Ce.y1=ue/2+Ue/2;else if(ot==We-1&&st==1)Ue=Ce.y1-Ce.y0,Ce.y0=ue/2-Ue/2,Ce.y1=ue/2+Ue/2;else{var Ye=h.mean(Ce.sourceLinks,m),xe=h.mean(Ce.targetLinks,d),Ee=((Ye&&xe?(Ye+xe)/2:Ye||xe)-g(Ce))*Ie;Ce.y0+=Ee,Ce.y1+=Ee}})})}function gt(){$e.forEach(function(Ie){var be,We,Ge,st=le,ot=Ie.length;for(Ie.sort(c),Ge=0;Ge<ot;++Ge)(We=st-(be=Ie[Ge]).y0)>0&&(be.y0+=We,be.y1+=We),st=be.y1+ae;if((We=st-ae-ue)>0)for(st=be.y0-=We,be.y1-=We,Ge=ot-2;Ge>=0;--Ge)(We=(be=Ie[Ge]).y1+ae-st)>0&&(be.y0-=We,be.y1-=We),st=be.y0})}}function et(Re){Re.nodes.forEach(function(Ze){Ze.sourceLinks.sort(a),Ze.targetLinks.sort(s)}),Re.nodes.forEach(function(Ze){var Ke=Ze.y0,$e=Ke,rt=Ze.y1,at=rt;Ze.sourceLinks.forEach(function(lt){lt.circular?(lt.y0=rt-lt.width/2,rt-=lt.width):(lt.y0=Ke+lt.width/2,Ke+=lt.width)}),Ze.targetLinks.forEach(function(lt){lt.circular?(lt.y1=at-lt.width/2,at-=lt.width):(lt.y1=$e+lt.width/2,$e+=lt.width)})})}return _e.nodeId=function(Re){return arguments.length?(Ae=typeof Re=="function"?Re:i(Re),_e):Ae},_e.nodeAlign=function(Re){return arguments.length?(Se=typeof Re=="function"?Re:i(Re),_e):Se},_e.nodeWidth=function(Re){return arguments.length?(we=+Re,_e):we},_e.nodePadding=function(Re){return arguments.length?(ae=+Re,_e):ae},_e.nodes=function(Re){return arguments.length?(ke=typeof Re=="function"?Re:i(Re),_e):ke},_e.links=function(Re){return arguments.length?(Me=typeof Re=="function"?Re:i(Re),_e):Me},_e.size=function(Re){return arguments.length?(de=le=0,fe=+Re[0],ue=+Re[1],_e):[fe-de,ue-le]},_e.extent=function(Re){return arguments.length?(de=+Re[0][0],fe=+Re[1][0],le=+Re[0][1],ue=+Re[1][1],_e):[[de,le],[fe,ue]]},_e.iterations=function(Re){return arguments.length?(ve=+Re,_e):ve},_e.circularLinkGap=function(Re){return arguments.length?(ge=+Re,_e):ge},_e.nodePaddingRatio=function(Re){return arguments.length?(oe=+Re,_e):oe},_e.sortNodes=function(Re){return arguments.length?(De=Re,_e):De},_e.update=function(Re){return M(Re,Ae),et(Re),Re.links.forEach(function(Ze){Ze.circular&&(Ze.circularLinkType=Ze.y0+Ze.y1<ue?"top":"bottom",Ze.source.circularLinkType=Ze.circularLinkType,Ze.target.circularLinkType=Ze.circularLinkType)}),G(Re,ue,Ae,!1),W(Re,ue,Ae),k(Re,ge,ue,Ae),Re},_e},t.sankeyCenter=function(ae){return ae.targetLinks.length?ae.depth:ae.sourceLinks.length?h.min(ae.sourceLinks,o)-1:0},t.sankeyLeft=function(ae){return ae.depth},t.sankeyRight=function(ae,oe){return oe-1-ae.height},t.sankeyJustify=r,Object.defineProperty(t,"__esModule",{value:!0})})},{"d3-array":156,"d3-collection":157,"d3-shape":165,"elementary-circuits-directed-graph":179}],56:[function(n,z,q){(function(t,h){typeof q=="object"&&typeof z<"u"?h(q,n("d3-array"),n("d3-collection"),n("d3-shape")):h(t.d3=t.d3||{},t.d3,t.d3,t.d3)})(this,function(t,h,p,l){"use strict";function e(A){return A.target.depth}function o(A,E){return A.sourceLinks.length?A.depth:E-1}function r(A){return function(){return A}}function i(A,E){return s(A.source,E.source)||A.index-E.index}function u(A,E){return s(A.target,E.target)||A.index-E.index}function s(A,E){return A.y0-E.y0}function a(A){return A.value}function c(A){return(A.y0+A.y1)/2}function f(A){return c(A.source)*A.value}function g(A){return c(A.target)*A.value}function d(A){return A.index}function m(A){return A.nodes}function y(A){return A.links}function v(A,E){var M=A.get(E);if(!M)throw new Error("missing: "+E);return M}function T(A){return[A.source.x1,A.y0]}function w(A){return[A.target.x0,A.y1]}t.sankey=function(){var A=0,E=0,M=1,b=1,_=24,S=8,C=d,k=o,L=m,I=y,R=32;function V(){var F={nodes:L.apply(null,arguments),links:I.apply(null,arguments)};return O(F),J(F),D(F),B(F),N(F),F}function O(F){F.nodes.forEach(function(j,G){j.index=G,j.sourceLinks=[],j.targetLinks=[]});var H=p.map(F.nodes,C);F.links.forEach(function(j,G){j.index=G;var W=j.source,Q=j.target;typeof W!="object"&&(W=j.source=v(H,W)),typeof Q!="object"&&(Q=j.target=v(H,Q)),W.sourceLinks.push(j),Q.targetLinks.push(j)})}function J(F){F.nodes.forEach(function(H){H.value=Math.max(h.sum(H.sourceLinks,a),h.sum(H.targetLinks,a))})}function D(F){var H,j,G;for(H=F.nodes,j=[],G=0;H.length;++G,H=j,j=[])H.forEach(function(Q){Q.depth=G,Q.sourceLinks.forEach(function($){j.indexOf($.target)<0&&j.push($.target)})});for(H=F.nodes,j=[],G=0;H.length;++G,H=j,j=[])H.forEach(function(Q){Q.height=G,Q.targetLinks.forEach(function($){j.indexOf($.source)<0&&j.push($.source)})});var W=(M-A-_)/(G-1);F.nodes.forEach(function(Q){Q.x1=(Q.x0=A+Math.max(0,Math.min(G-1,Math.floor(k.call(null,Q,G))))*W)+_})}function B(F){var H=p.nest().key(function(ee){return ee.x0}).sortKeys(h.ascending).entries(F.nodes).map(function(ee){return ee.values});(function(){var ee=h.max(H,function(oe){return oe.length}),ie=2/3*(b-E)/(ee-1);S>ie&&(S=ie);var ae=h.min(H,function(oe){return(b-E-(oe.length-1)*S)/h.sum(oe,a)});H.forEach(function(oe){oe.forEach(function(de,le){de.y1=(de.y0=le)+de.value*ae})}),F.links.forEach(function(oe){oe.width=oe.value*ae})})(),$();for(var j=1,G=R;G>0;--G)Q(j*=.99),$(),W(j),$();function W(ee){H.forEach(function(ie){ie.forEach(function(ae){if(ae.targetLinks.length){var oe=(h.sum(ae.targetLinks,f)/h.sum(ae.targetLinks,a)-c(ae))*ee;ae.y0+=oe,ae.y1+=oe}})})}function Q(ee){H.slice().reverse().forEach(function(ie){ie.forEach(function(ae){if(ae.sourceLinks.length){var oe=(h.sum(ae.sourceLinks,g)/h.sum(ae.sourceLinks,a)-c(ae))*ee;ae.y0+=oe,ae.y1+=oe}})})}function $(){H.forEach(function(ee){var ie,ae,oe,de=E,le=ee.length;for(ee.sort(s),oe=0;oe<le;++oe)(ae=de-(ie=ee[oe]).y0)>0&&(ie.y0+=ae,ie.y1+=ae),de=ie.y1+S;if((ae=de-S-b)>0)for(de=ie.y0-=ae,ie.y1-=ae,oe=le-2;oe>=0;--oe)(ae=(ie=ee[oe]).y1+S-de)>0&&(ie.y0-=ae,ie.y1-=ae),de=ie.y0})}}function N(F){F.nodes.forEach(function(H){H.sourceLinks.sort(u),H.targetLinks.sort(i)}),F.nodes.forEach(function(H){var j=H.y0,G=j;H.sourceLinks.forEach(function(W){W.y0=j+W.width/2,j+=W.width}),H.targetLinks.forEach(function(W){W.y1=G+W.width/2,G+=W.width})})}return V.update=function(F){return N(F),F},V.nodeId=function(F){return arguments.length?(C=typeof F=="function"?F:r(F),V):C},V.nodeAlign=function(F){return arguments.length?(k=typeof F=="function"?F:r(F),V):k},V.nodeWidth=function(F){return arguments.length?(_=+F,V):_},V.nodePadding=function(F){return arguments.length?(S=+F,V):S},V.nodes=function(F){return arguments.length?(L=typeof F=="function"?F:r(F),V):L},V.links=function(F){return arguments.length?(I=typeof F=="function"?F:r(F),V):I},V.size=function(F){return arguments.length?(A=E=0,M=+F[0],b=+F[1],V):[M-A,b-E]},V.extent=function(F){return arguments.length?(A=+F[0][0],M=+F[1][0],E=+F[0][1],b=+F[1][1],V):[[A,E],[M,b]]},V.iterations=function(F){return arguments.length?(R=+F,V):R},V},t.sankeyCenter=function(A){return A.targetLinks.length?A.depth:A.sourceLinks.length?h.min(A.sourceLinks,e)-1:0},t.sankeyLeft=function(A){return A.depth},t.sankeyRight=function(A,E){return E-1-A.height},t.sankeyJustify=o,t.sankeyLinkHorizontal=function(){return l.linkHorizontal().source(T).target(w)},Object.defineProperty(t,"__esModule",{value:!0})})},{"d3-array":156,"d3-collection":157,"d3-shape":165}],57:[function(n,z,q){"use strict";z.exports=n("./quad")},{"./quad":58}],58:[function(n,z,q){"use strict";var t=n("binary-search-bounds"),h=n("clamp"),p=n("parse-rect"),l=n("array-bounds"),e=n("pick-by-alias"),o=n("defined"),r=n("flatten-vertex-data"),i=n("is-obj"),u=n("dtype"),s=n("math-log2");function a(c,f){for(var g=f[0],d=f[1],m=1/(f[2]-g),y=1/(f[3]-d),v=new Array(c.length),T=0,w=c.length/2;T<w;T++)v[2*T]=h((c[2*T]-g)*m,0,1),v[2*T+1]=h((c[2*T+1]-d)*y,0,1);return v}z.exports=function(c,f){f||(f={}),c=r(c,"float64"),f=e(f,{bounds:"range bounds dataBox databox",maxDepth:"depth maxDepth maxdepth level maxLevel maxlevel levels",dtype:"type dtype format out dst output destination"});var g=o(f.maxDepth,255),d=o(f.bounds,l(c,2));d[0]===d[2]&&d[2]++,d[1]===d[3]&&d[3]++;var m,y=a(c,d),v=c.length>>>1;f.dtype||(f.dtype="array"),typeof f.dtype=="string"?m=new(u(f.dtype))(v):f.dtype&&(m=f.dtype,Array.isArray(m)&&(m.length=v));for(var T=0;T<v;++T)m[T]=T;var w=[],A=[],E=[],M=[];(function V(O,J,D,B,N,F){if(!B.length)return null;var H=w[N]||(w[N]=[]),j=E[N]||(E[N]=[]),G=A[N]||(A[N]=[]),W=H.length;if(++N>g||F>1073741824){for(var Q=0;Q<B.length;Q++)H.push(B[Q]),j.push(F),G.push(null,null,null,null);return W}if(H.push(B[0]),j.push(F),B.length<=1)return G.push(null,null,null,null),W;for(var $=.5*D,ee=O+$,ie=J+$,ae=[],oe=[],de=[],le=[],fe=1,ue=B.length;fe<ue;fe++){var we=B[fe],Ae=y[2*we],Se=y[2*we+1];Ae<ee?Se<ie?ae.push(we):oe.push(we):Se<ie?de.push(we):le.push(we)}return F<<=2,G.push(V(O,J,$,ae,N,F),V(O,ie,$,oe,N,F+1),V(ee,J,$,de,N,F+2),V(ee,ie,$,le,N,F+3)),W})(0,0,1,m,0,1);for(var b=0,_=0;_<w.length;_++){var S=w[_];if(m.set)m.set(S,b);else for(var C=0,k=S.length;C<k;C++)m[C+b]=S[C];var L=b+w[_].length;M[_]=[b,L],b=L}return m.range=function(){for(var V,O=[],J=arguments.length;J--;)O[J]=arguments[J];if(i(O[O.length-1])){var D=O.pop();O.length||D.x==null&&D.l==null&&D.left==null||(O=[D],V={}),V=e(D,{level:"level maxLevel",d:"d diam diameter r radius px pxSize pixel pixelSize maxD size minSize",lod:"lod details ranges offsets"})}else V={};O.length||(O=d);var B=p.apply(void 0,O),N=[Math.min(B.x,B.x+B.width),Math.min(B.y,B.y+B.height),Math.max(B.x,B.x+B.width),Math.max(B.y,B.y+B.height)],F=N[0],H=N[1],j=N[2],G=N[3],W=a([F,H,j,G],d),Q=W[0],$=W[1],ee=W[2],ie=W[3],ae=o(V.level,w.length);if(V.d!=null){var oe;typeof V.d=="number"?oe=[V.d,V.d]:V.d.length&&(oe=V.d),ae=Math.min(Math.max(Math.ceil(-s(Math.abs(oe[0])/(d[2]-d[0]))),Math.ceil(-s(Math.abs(oe[1])/(d[3]-d[1])))),ae)}if(ae=Math.min(ae,w.length),V.lod)return I(Q,$,ee,ie,ae);var de=[];function le(ue,we,Ae,Se,ke,Me){if(ke!==null&&Me!==null&&!(Q>ue+Ae||$>we+Ae||ee<ue||ie<we||Se>=ae||ke===Me)){var ve=w[Se];Me===void 0&&(Me=ve.length);for(var ge=ke;ge<Me;ge++){var De=ve[ge],_e=c[2*De],Pe=c[2*De+1];_e>=F&&_e<=j&&Pe>=H&&Pe<=G&&de.push(De)}var Fe=A[Se],ze=Fe[4*ke+0],He=Fe[4*ke+1],et=Fe[4*ke+2],Re=Fe[4*ke+3],Ze=fe(Fe,ke+1),Ke=.5*Ae,$e=Se+1;le(ue,we,Ke,$e,ze,He||et||Re||Ze),le(ue,we+Ke,Ke,$e,He,et||Re||Ze),le(ue+Ke,we,Ke,$e,et,Re||Ze),le(ue+Ke,we+Ke,Ke,$e,Re,Ze)}}function fe(ue,we){for(var Ae=null,Se=0;Ae===null;)if(Ae=ue[4*we+Se],++Se>ue.length)return null;return Ae}return le(0,0,1,0,0,1),de},m;function I(V,O,J,D,B){for(var N=[],F=0;F<B;F++){var H=E[F],j=M[F][0],G=R(V,O,F),W=R(J,D,F),Q=t.ge(H,G),$=t.gt(H,W,Q,H.length-1);N[F]=[Q+j,$+j]}return N}function R(V,O,J){for(var D=1,B=.5,N=.5,F=.5,H=0;H<J;H++)D<<=2,D+=V<B?O<N?0:1:O<N?2:3,F*=.5,B+=V<B?-F:F,N+=O<N?-F:F;return D}}},{"array-bounds":70,"binary-search-bounds":96,clamp:120,defined:170,dtype:175,"flatten-vertex-data":244,"is-obj":468,"math-log2":479,"parse-rect":504,"pick-by-alias":511}],59:[function(n,z,q){"use strict";Object.defineProperty(q,"__esModule",{value:!0});var t=n("@turf/meta");function h(e){var o=0;if(e&&e.length>0){o+=Math.abs(p(e[0]));for(var r=1;r<e.length;r++)o-=Math.abs(p(e[r]))}return o}function p(e){var o,r,i,u,s,a,c=0,f=e.length;if(f>2){for(a=0;a<f;a++)a===f-2?(i=f-2,u=f-1,s=0):a===f-1?(i=f-1,u=0,s=1):(i=a,u=a+1,s=a+2),o=e[i],r=e[u],c+=(l(e[s][0])-l(o[0]))*Math.sin(l(r[1]));c=6378137*c*6378137/2}return c}function l(e){return e*Math.PI/180}q.default=function(e){return t.geomReduce(e,function(o,r){return o+function(i){var u,s=0;switch(i.type){case"Polygon":return h(i.coordinates);case"MultiPolygon":for(u=0;u<i.coordinates.length;u++)s+=h(i.coordinates[u]);return s;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}(r)},0)}},{"@turf/meta":63}],60:[function(n,z,q){"use strict";Object.defineProperty(q,"__esModule",{value:!0});var t=n("@turf/meta");q.default=function(h){var p=[1/0,1/0,-1/0,-1/0];return t.coordEach(h,function(l){p[0]>l[0]&&(p[0]=l[0]),p[1]>l[1]&&(p[1]=l[1]),p[2]<l[0]&&(p[2]=l[0]),p[3]<l[1]&&(p[3]=l[1])}),p}},{"@turf/meta":63}],61:[function(n,z,q){"use strict";Object.defineProperty(q,"__esModule",{value:!0});var t=n("@turf/meta"),h=n("@turf/helpers");q.default=function(p,l){l===void 0&&(l={});var e=0,o=0,r=0;return t.coordEach(p,function(i){e+=i[0],o+=i[1],r++}),h.point([e/r,o/r],l.properties)}},{"@turf/helpers":62,"@turf/meta":63}],62:[function(n,z,q){"use strict";function t(f,g,d){d===void 0&&(d={});var m={type:"Feature"};return(d.id===0||d.id)&&(m.id=d.id),d.bbox&&(m.bbox=d.bbox),m.properties=g||{},m.geometry=f,m}function h(f,g,d){return d===void 0&&(d={}),t({type:"Point",coordinates:f},g,d)}function p(f,g,d){d===void 0&&(d={});for(var m=0,y=f;m<y.length;m++){var v=y[m];if(v.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var T=0;T<v[v.length-1].length;T++)if(v[v.length-1][T]!==v[0][T])throw new Error("First and last Position are not equivalent.")}return t({type:"Polygon",coordinates:f},g,d)}function l(f,g,d){if(d===void 0&&(d={}),f.length<2)throw new Error("coordinates must be an array of two or more positions");return t({type:"LineString",coordinates:f},g,d)}function e(f,g){g===void 0&&(g={});var d={type:"FeatureCollection"};return g.id&&(d.id=g.id),g.bbox&&(d.bbox=g.bbox),d.features=f,d}function o(f,g,d){return d===void 0&&(d={}),t({type:"MultiLineString",coordinates:f},g,d)}function r(f,g,d){return d===void 0&&(d={}),t({type:"MultiPoint",coordinates:f},g,d)}function i(f,g,d){return d===void 0&&(d={}),t({type:"MultiPolygon",coordinates:f},g,d)}function u(f,g){g===void 0&&(g="kilometers");var d=q.factors[g];if(!d)throw new Error(g+" units is invalid");return f*d}function s(f,g){g===void 0&&(g="kilometers");var d=q.factors[g];if(!d)throw new Error(g+" units is invalid");return f/d}function a(f){return 180*(f%(2*Math.PI))/Math.PI}function c(f){return!isNaN(f)&&f!==null&&!Array.isArray(f)&&!/^\s*$/.test(f)}Object.defineProperty(q,"__esModule",{value:!0}),q.earthRadius=63710088e-1,q.factors={centimeters:100*q.earthRadius,centimetres:100*q.earthRadius,degrees:q.earthRadius/111325,feet:3.28084*q.earthRadius,inches:39.37*q.earthRadius,kilometers:q.earthRadius/1e3,kilometres:q.earthRadius/1e3,meters:q.earthRadius,metres:q.earthRadius,miles:q.earthRadius/1609.344,millimeters:1e3*q.earthRadius,millimetres:1e3*q.earthRadius,nauticalmiles:q.earthRadius/1852,radians:1,yards:q.earthRadius/1.0936},q.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/q.earthRadius,yards:1/1.0936},q.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},q.feature=t,q.geometry=function(f,g,d){switch(d===void 0&&(d={}),f){case"Point":return h(g).geometry;case"LineString":return l(g).geometry;case"Polygon":return p(g).geometry;case"MultiPoint":return r(g).geometry;case"MultiLineString":return o(g).geometry;case"MultiPolygon":return i(g).geometry;default:throw new Error(f+" is invalid")}},q.point=h,q.points=function(f,g,d){return d===void 0&&(d={}),e(f.map(function(m){return h(m,g)}),d)},q.polygon=p,q.polygons=function(f,g,d){return d===void 0&&(d={}),e(f.map(function(m){return p(m,g)}),d)},q.lineString=l,q.lineStrings=function(f,g,d){return d===void 0&&(d={}),e(f.map(function(m){return l(m,g)}),d)},q.featureCollection=e,q.multiLineString=o,q.multiPoint=r,q.multiPolygon=i,q.geometryCollection=function(f,g,d){return d===void 0&&(d={}),t({type:"GeometryCollection",geometries:f},g,d)},q.round=function(f,g){if(g===void 0&&(g=0),g&&!(g>=0))throw new Error("precision must be a positive number");var d=Math.pow(10,g||0);return Math.round(f*d)/d},q.radiansToLength=u,q.lengthToRadians=s,q.lengthToDegrees=function(f,g){return a(s(f,g))},q.bearingToAzimuth=function(f){var g=f%360;return g<0&&(g+=360),g},q.radiansToDegrees=a,q.degreesToRadians=function(f){return f%360*Math.PI/180},q.convertLength=function(f,g,d){if(g===void 0&&(g="kilometers"),d===void 0&&(d="kilometers"),!(f>=0))throw new Error("length must be a positive number");return u(s(f,g),d)},q.convertArea=function(f,g,d){if(g===void 0&&(g="meters"),d===void 0&&(d="kilometers"),!(f>=0))throw new Error("area must be a positive number");var m=q.areaFactors[g];if(!m)throw new Error("invalid original units");var y=q.areaFactors[d];if(!y)throw new Error("invalid final units");return f/m*y},q.isNumber=c,q.isObject=function(f){return!!f&&f.constructor===Object},q.validateBBox=function(f){if(!f)throw new Error("bbox is required");if(!Array.isArray(f))throw new Error("bbox must be an Array");if(f.length!==4&&f.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");f.forEach(function(g){if(!c(g))throw new Error("bbox must only contain numbers")})},q.validateId=function(f){if(!f)throw new Error("id is required");if(["string","number"].indexOf(typeof f)===-1)throw new Error("id must be a number or a string")},q.radians2degrees=function(){throw new Error("method has been renamed to `radiansToDegrees`")},q.degrees2radians=function(){throw new Error("method has been renamed to `degreesToRadians`")},q.distanceToDegrees=function(){throw new Error("method has been renamed to `lengthToDegrees`")},q.distanceToRadians=function(){throw new Error("method has been renamed to `lengthToRadians`")},q.radiansToDistance=function(){throw new Error("method has been renamed to `radiansToLength`")},q.bearingToAngle=function(){throw new Error("method has been renamed to `bearingToAzimuth`")},q.convertDistance=function(){throw new Error("method has been renamed to `convertLength`")}},{}],63:[function(n,z,q){"use strict";Object.defineProperty(q,"__esModule",{value:!0});var t=n("@turf/helpers");function h(u,s,a){if(u!==null)for(var c,f,g,d,m,y,v,T,w=0,A=0,E=u.type,M=E==="FeatureCollection",b=E==="Feature",_=M?u.features.length:1,S=0;S<_;S++){m=(T=!!(v=M?u.features[S].geometry:b?u.geometry:u)&&v.type==="GeometryCollection")?v.geometries.length:1;for(var C=0;C<m;C++){var k=0,L=0;if((d=T?v.geometries[C]:v)!==null){y=d.coordinates;var I=d.type;switch(w=!a||I!=="Polygon"&&I!=="MultiPolygon"?0:1,I){case null:break;case"Point":if(s(y,A,S,k,L)===!1)return!1;A++,k++;break;case"LineString":case"MultiPoint":for(c=0;c<y.length;c++){if(s(y[c],A,S,k,L)===!1)return!1;A++,I==="MultiPoint"&&k++}I==="LineString"&&k++;break;case"Polygon":case"MultiLineString":for(c=0;c<y.length;c++){for(f=0;f<y[c].length-w;f++){if(s(y[c][f],A,S,k,L)===!1)return!1;A++}I==="MultiLineString"&&k++,I==="Polygon"&&L++}I==="Polygon"&&k++;break;case"MultiPolygon":for(c=0;c<y.length;c++){for(L=0,f=0;f<y[c].length;f++){for(g=0;g<y[c][f].length-w;g++){if(s(y[c][f][g],A,S,k,L)===!1)return!1;A++}L++}k++}break;case"GeometryCollection":for(c=0;c<d.geometries.length;c++)if(h(d.geometries[c],s,a)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function p(u,s){var a;switch(u.type){case"FeatureCollection":for(a=0;a<u.features.length&&s(u.features[a].properties,a)!==!1;a++);break;case"Feature":s(u.properties,0)}}function l(u,s){if(u.type==="Feature")s(u,0);else if(u.type==="FeatureCollection")for(var a=0;a<u.features.length&&s(u.features[a],a)!==!1;a++);}function e(u,s){var a,c,f,g,d,m,y,v,T,w,A=0,E=u.type==="FeatureCollection",M=u.type==="Feature",b=E?u.features.length:1;for(a=0;a<b;a++){for(m=E?u.features[a].geometry:M?u.geometry:u,v=E?u.features[a].properties:M?u.properties:{},T=E?u.features[a].bbox:M?u.bbox:void 0,w=E?u.features[a].id:M?u.id:void 0,d=(y=!!m&&m.type==="GeometryCollection")?m.geometries.length:1,f=0;f<d;f++)if((g=y?m.geometries[f]:m)!==null)switch(g.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(s(g,A,v,T,w)===!1)return!1;break;case"GeometryCollection":for(c=0;c<g.geometries.length;c++)if(s(g.geometries[c],A,v,T,w)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}else if(s(null,A,v,T,w)===!1)return!1;A++}}function o(u,s){e(u,function(a,c,f,g,d){var m,y=a===null?null:a.type;switch(y){case null:case"Point":case"LineString":case"Polygon":return s(t.feature(a,f,{bbox:g,id:d}),c,0)!==!1&&void 0}switch(y){case"MultiPoint":m="Point";break;case"MultiLineString":m="LineString";break;case"MultiPolygon":m="Polygon"}for(var v=0;v<a.coordinates.length;v++){var T={type:m,coordinates:a.coordinates[v]};if(s(t.feature(T,f),c,v)===!1)return!1}})}function r(u,s){o(u,function(a,c,f){var g=0;if(a.geometry){var d=a.geometry.type;if(d!=="Point"&&d!=="MultiPoint"){var m,y=0,v=0,T=0;return h(a,function(w,A,E,M,b){if(m===void 0||c>y||M>v||b>T)return m=w,y=c,v=M,T=b,void(g=0);var _=t.lineString([m,w],a.properties);if(s(_,c,f,b,g)===!1)return!1;g++,m=w})!==!1&&void 0}}})}function i(u,s){if(!u)throw new Error("geojson is required");o(u,function(a,c,f){if(a.geometry!==null){var g=a.geometry.type,d=a.geometry.coordinates;switch(g){case"LineString":if(s(a,c,f,0,0)===!1)return!1;break;case"Polygon":for(var m=0;m<d.length;m++)if(s(t.lineString(d[m],a.properties),c,f,m)===!1)return!1}}})}q.coordEach=h,q.coordReduce=function(u,s,a,c){var f=a;return h(u,function(g,d,m,y,v){f=d===0&&a===void 0?g:s(f,g,d,m,y,v)},c),f},q.propEach=p,q.propReduce=function(u,s,a){var c=a;return p(u,function(f,g){c=g===0&&a===void 0?f:s(c,f,g)}),c},q.featureEach=l,q.featureReduce=function(u,s,a){var c=a;return l(u,function(f,g){c=g===0&&a===void 0?f:s(c,f,g)}),c},q.coordAll=function(u){var s=[];return h(u,function(a){s.push(a)}),s},q.geomEach=e,q.geomReduce=function(u,s,a){var c=a;return e(u,function(f,g,d,m,y){c=g===0&&a===void 0?f:s(c,f,g,d,m,y)}),c},q.flattenEach=o,q.flattenReduce=function(u,s,a){var c=a;return o(u,function(f,g,d){c=g===0&&d===0&&a===void 0?f:s(c,f,g,d)}),c},q.segmentEach=r,q.segmentReduce=function(u,s,a){var c=a,f=!1;return r(u,function(g,d,m,y,v){c=f===!1&&a===void 0?g:s(c,g,d,m,y,v),f=!0}),c},q.lineEach=i,q.lineReduce=function(u,s,a){var c=a;return i(u,function(f,g,d,m){c=g===0&&a===void 0?f:s(c,f,g,d,m)}),c},q.findSegment=function(u,s){if(s=s||{},!t.isObject(s))throw new Error("options is invalid");var a,c=s.featureIndex||0,f=s.multiFeatureIndex||0,g=s.geometryIndex||0,d=s.segmentIndex||0,m=s.properties;switch(u.type){case"FeatureCollection":c<0&&(c=u.features.length+c),m=m||u.features[c].properties,a=u.features[c].geometry;break;case"Feature":m=m||u.properties,a=u.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":a=u;break;default:throw new Error("geojson is invalid")}if(a===null)return null;var y=a.coordinates;switch(a.type){case"Point":case"MultiPoint":return null;case"LineString":return d<0&&(d=y.length+d-1),t.lineString([y[d],y[d+1]],m,s);case"Polygon":return g<0&&(g=y.length+g),d<0&&(d=y[g].length+d-1),t.lineString([y[g][d],y[g][d+1]],m,s);case"MultiLineString":return f<0&&(f=y.length+f),d<0&&(d=y[f].length+d-1),t.lineString([y[f][d],y[f][d+1]],m,s);case"MultiPolygon":return f<0&&(f=y.length+f),g<0&&(g=y[f].length+g),d<0&&(d=y[f][g].length-d-1),t.lineString([y[f][g][d],y[f][g][d+1]],m,s)}throw new Error("geojson is invalid")},q.findPoint=function(u,s){if(s=s||{},!t.isObject(s))throw new Error("options is invalid");var a,c=s.featureIndex||0,f=s.multiFeatureIndex||0,g=s.geometryIndex||0,d=s.coordIndex||0,m=s.properties;switch(u.type){case"FeatureCollection":c<0&&(c=u.features.length+c),m=m||u.features[c].properties,a=u.features[c].geometry;break;case"Feature":m=m||u.properties,a=u.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":a=u;break;default:throw new Error("geojson is invalid")}if(a===null)return null;var y=a.coordinates;switch(a.type){case"Point":return t.point(y,m,s);case"MultiPoint":return f<0&&(f=y.length+f),t.point(y[f],m,s);case"LineString":return d<0&&(d=y.length+d),t.point(y[d],m,s);case"Polygon":return g<0&&(g=y.length+g),d<0&&(d=y[g].length+d),t.point(y[g][d],m,s);case"MultiLineString":return f<0&&(f=y.length+f),d<0&&(d=y[f].length+d),t.point(y[f][d],m,s);case"MultiPolygon":return f<0&&(f=y.length+f),g<0&&(g=y[f].length+g),d<0&&(d=y[f][g].length-d),t.point(y[f][g][d],m,s)}throw new Error("geojson is invalid")}},{"@turf/helpers":62}],64:[function(n,z,q){"use strict";var t=typeof WeakMap>"u"?n("weak-map"):WeakMap,h=n("gl-buffer"),p=n("gl-vao"),l=new t;z.exports=function(e){var o=l.get(e),r=o&&(o._triangleBuffer.handle||o._triangleBuffer.buffer);if(!r||!e.isBuffer(r)){var i=h(e,new Float32Array([-1,-1,-1,4,4,-1]));(o=p(e,[{buffer:i,type:e.FLOAT,size:2}]))._triangleBuffer=i,l.set(e,o)}o.bind(),e.drawArrays(e.TRIANGLES,0,3),o.unbind()}},{"gl-buffer":259,"gl-vao":358,"weak-map":602}],65:[function(n,z,q){z.exports=function(t){var h=0,p=0,l=0,e=0;return t.map(function(o){var r=(o=o.slice())[0],i=r.toUpperCase();if(r!=i)switch(o[0]=i,r){case"a":o[6]+=l,o[7]+=e;break;case"v":o[1]+=e;break;case"h":o[1]+=l;break;default:for(var u=1;u<o.length;)o[u++]+=l,o[u++]+=e}switch(i){case"Z":l=h,e=p;break;case"H":l=o[1];break;case"V":e=o[1];break;case"M":l=h=o[1],e=p=o[2];break;default:l=o[o.length-2],e=o[o.length-1]}return o})}},{}],66:[function(n,z,q){var t=n("pad-left");z.exports=function(h,p,l){p=typeof p=="number"?p:1,l=l||": ";var e=h.split(/\r?\n/),o=String(e.length+p-1).length;return e.map(function(r,i){var u=i+p,s=String(u).length;return t(u,o-s)+l+r}).join(`
`)}},{"pad-left":502}],67:[function(n,z,q){"use strict";z.exports=function(p){var l=p.length;if(l===0)return[];if(l===1)return[0];for(var e=p[0].length,o=[p[0]],r=[0],i=1;i<l;++i)if(o.push(p[i]),h(o,e)){if(r.push(i),r.length===e+1)return r}else o.pop();return r};var t=n("robust-orientation");function h(p,l){for(var e=new Array(l+1),o=0;o<p.length;++o)e[o]=p[o];for(o=0;o<=p.length;++o){for(var r=p.length;r<=l;++r){for(var i=new Array(l),u=0;u<l;++u)i[u]=Math.pow(r+1-o,u);e[r]=i}if(t.apply(void 0,e))return!0}return!1}},{"robust-orientation":548}],68:[function(n,z,q){"use strict";z.exports=function(p,l){return t(l).filter(function(e){for(var o=new Array(e.length),r=0;r<e.length;++r)o[r]=l[e[r]];return h(o)*p<1})};var t=n("delaunay-triangulate"),h=n("circumradius")},{circumradius:119,"delaunay-triangulate":171}],69:[function(n,z,q){z.exports=function(p,l){return h(t(p,l))};var t=n("alpha-complex"),h=n("simplicial-complex-boundary")},{"alpha-complex":68,"simplicial-complex-boundary":555}],70:[function(n,z,q){"use strict";z.exports=function(t,h){if(!t||t.length==null)throw Error("Argument should be an array");h=h==null?1:Math.floor(h);for(var p=Array(2*h),l=0;l<h;l++){for(var e=-1/0,o=1/0,r=l,i=t.length;r<i;r+=h)t[r]>e&&(e=t[r]),t[r]<o&&(o=t[r]);p[l]=o,p[h+l]=e}return p}},{}],71:[function(n,z,q){"use strict";var t=n("array-bounds");z.exports=function(h,p,l){if(!h||h.length==null)throw Error("Argument should be an array");p==null&&(p=1),l==null&&(l=t(h,p));for(var e=0;e<p;e++){var o=l[p+e],r=l[e],i=e,u=h.length;if(o===1/0&&r===-1/0)for(i=e;i<u;i+=p)h[i]=h[i]===o?1:h[i]===r?0:.5;else if(o===1/0)for(i=e;i<u;i+=p)h[i]=h[i]===o?1:0;else if(r===-1/0)for(i=e;i<u;i+=p)h[i]=h[i]===r?0:1;else{var s=o-r;for(i=e;i<u;i+=p)isNaN(h[i])||(h[i]=s===0?.5:(h[i]-r)/s)}}return h}},{"array-bounds":70}],72:[function(n,z,q){z.exports=function(t,h){var p=typeof t=="number",l=typeof h=="number";p&&!l?(h=t,t=0):p||l||(t=0,h=0);var e=(h|=0)-(t|=0);if(e<0)throw new Error("array length must be positive");for(var o=new Array(e),r=0,i=t;r<e;r++,i++)o[r]=i;return o}},{}],73:[function(n,z,q){(function(t){(function(){"use strict";var h=n("object-assign");function p(M,b){if(M===b)return 0;for(var _=M.length,S=b.length,C=0,k=Math.min(_,S);C<k;++C)if(M[C]!==b[C]){_=M[C],S=b[C];break}return _<S?-1:S<_?1:0}function l(M){return t.Buffer&&typeof t.Buffer.isBuffer=="function"?t.Buffer.isBuffer(M):!(M==null||!M._isBuffer)}var e=n("util/"),o=Object.prototype.hasOwnProperty,r=Array.prototype.slice,i=function(){}.name==="foo";function u(M){return Object.prototype.toString.call(M)}function s(M){return!l(M)&&typeof t.ArrayBuffer=="function"&&(typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(M):!!M&&(M instanceof DataView||!!(M.buffer&&M.buffer instanceof ArrayBuffer)))}var a=z.exports=y,c=/\s*function\s+([^\(\s]*)\s*/;function f(M){if(e.isFunction(M)){if(i)return M.name;var b=M.toString().match(c);return b&&b[1]}}function g(M,b){return typeof M=="string"?M.length<b?M:M.slice(0,b):M}function d(M){if(i||!e.isFunction(M))return e.inspect(M);var b=f(M);return"[Function"+(b?": "+b:"")+"]"}function m(M,b,_,S,C){throw new a.AssertionError({message:_,actual:M,expected:b,operator:S,stackStartFunction:C})}function y(M,b){M||m(M,!0,b,"==",a.ok)}function v(M,b,_,S){if(M===b)return!0;if(l(M)&&l(b))return p(M,b)===0;if(e.isDate(M)&&e.isDate(b))return M.getTime()===b.getTime();if(e.isRegExp(M)&&e.isRegExp(b))return M.source===b.source&&M.global===b.global&&M.multiline===b.multiline&&M.lastIndex===b.lastIndex&&M.ignoreCase===b.ignoreCase;if(M!==null&&typeof M=="object"||b!==null&&typeof b=="object"){if(s(M)&&s(b)&&u(M)===u(b)&&!(M instanceof Float32Array||M instanceof Float64Array))return p(new Uint8Array(M.buffer),new Uint8Array(b.buffer))===0;if(l(M)!==l(b))return!1;var C=(S=S||{actual:[],expected:[]}).actual.indexOf(M);return C!==-1&&C===S.expected.indexOf(b)||(S.actual.push(M),S.expected.push(b),function(k,L,I,R){if(k==null||L==null)return!1;if(e.isPrimitive(k)||e.isPrimitive(L))return k===L;if(I&&Object.getPrototypeOf(k)!==Object.getPrototypeOf(L))return!1;var V=T(k),O=T(L);if(V&&!O||!V&&O)return!1;if(V)return k=r.call(k),L=r.call(L),v(k,L,I);var J,D,B=E(k),N=E(L);if(B.length!==N.length)return!1;for(B.sort(),N.sort(),D=B.length-1;D>=0;D--)if(B[D]!==N[D])return!1;for(D=B.length-1;D>=0;D--)if(J=B[D],!v(k[J],L[J],I,R))return!1;return!0}(M,b,_,S))}return _?M===b:M==b}function T(M){return Object.prototype.toString.call(M)=="[object Arguments]"}function w(M,b){if(!M||!b)return!1;if(Object.prototype.toString.call(b)=="[object RegExp]")return b.test(M);try{if(M instanceof b)return!0}catch{}return!Error.isPrototypeOf(b)&&b.call({},M)===!0}function A(M,b,_,S){var C;if(typeof b!="function")throw new TypeError('"block" argument must be a function');typeof _=="string"&&(S=_,_=null),C=function(I){var R;try{I()}catch(V){R=V}return R}(b),S=(_&&_.name?" ("+_.name+").":".")+(S?" "+S:"."),M&&!C&&m(C,_,"Missing expected exception"+S);var k=typeof S=="string",L=!M&&C&&!_;if((!M&&e.isError(C)&&k&&w(C,_)||L)&&m(C,_,"Got unwanted exception"+S),M&&C&&_&&!w(C,_)||!M&&C)throw C}a.AssertionError=function(M){this.name="AssertionError",this.actual=M.actual,this.expected=M.expected,this.operator=M.operator,M.message?(this.message=M.message,this.generatedMessage=!1):(this.message=function(I){return g(d(I.actual),128)+" "+I.operator+" "+g(d(I.expected),128)}(this),this.generatedMessage=!0);var b=M.stackStartFunction||m;if(Error.captureStackTrace)Error.captureStackTrace(this,b);else{var _=new Error;if(_.stack){var S=_.stack,C=f(b),k=S.indexOf(`
`+C);if(k>=0){var L=S.indexOf(`
`,k+1);S=S.substring(L+1)}this.stack=S}}},e.inherits(a.AssertionError,Error),a.fail=m,a.ok=y,a.equal=function(M,b,_){M!=b&&m(M,b,_,"==",a.equal)},a.notEqual=function(M,b,_){M==b&&m(M,b,_,"!=",a.notEqual)},a.deepEqual=function(M,b,_){v(M,b,!1)||m(M,b,_,"deepEqual",a.deepEqual)},a.deepStrictEqual=function(M,b,_){v(M,b,!0)||m(M,b,_,"deepStrictEqual",a.deepStrictEqual)},a.notDeepEqual=function(M,b,_){v(M,b,!1)&&m(M,b,_,"notDeepEqual",a.notDeepEqual)},a.notDeepStrictEqual=function M(b,_,S){v(b,_,!0)&&m(b,_,S,"notDeepStrictEqual",M)},a.strictEqual=function(M,b,_){M!==b&&m(M,b,_,"===",a.strictEqual)},a.notStrictEqual=function(M,b,_){M===b&&m(M,b,_,"!==",a.notStrictEqual)},a.throws=function(M,b,_){A(!0,M,b,_)},a.doesNotThrow=function(M,b,_){A(!1,M,b,_)},a.ifError=function(M){if(M)throw M},a.strict=h(function M(b,_){b||m(b,!0,_,"==",M)},a,{equal:a.strictEqual,deepEqual:a.deepStrictEqual,notEqual:a.notStrictEqual,notDeepEqual:a.notDeepStrictEqual}),a.strict.strict=a.strict;var E=Object.keys||function(M){var b=[];for(var _ in M)o.call(M,_)&&b.push(_);return b}}).call(this)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{"object-assign":499,"util/":76}],74:[function(n,z,q){typeof Object.create=="function"?z.exports=function(t,h){t.super_=h,t.prototype=Object.create(h.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:z.exports=function(t,h){t.super_=h;var p=function(){};p.prototype=h.prototype,t.prototype=new p,t.prototype.constructor=t}},{}],75:[function(n,z,q){z.exports=function(t){return t&&typeof t=="object"&&typeof t.copy=="function"&&typeof t.fill=="function"&&typeof t.readUInt8=="function"}},{}],76:[function(n,z,q){(function(t,h){(function(){var p=/%[sdj%]/g;q.format=function(k){if(!m(k)){for(var L=[],I=0;I<arguments.length;I++)L.push(o(arguments[I]));return L.join(" ")}I=1;for(var R=arguments,V=R.length,O=String(k).replace(p,function(D){if(D==="%%")return"%";if(I>=V)return D;switch(D){case"%s":return String(R[I++]);case"%d":return Number(R[I++]);case"%j":try{return JSON.stringify(R[I++])}catch{return"[Circular]"}default:return D}}),J=R[I];I<V;J=R[++I])g(J)||!T(J)?O+=" "+J:O+=" "+o(J);return O},q.deprecate=function(k,L){if(y(h.process))return function(){return q.deprecate(k,L).apply(this,arguments)};if(t.noDeprecation===!0)return k;var I=!1;return function(){if(!I){if(t.throwDeprecation)throw new Error(L);t.traceDeprecation?console.trace(L):console.error(L),I=!0}return k.apply(this,arguments)}};var l,e={};function o(k,L){var I={seen:[],stylize:i};return arguments.length>=3&&(I.depth=arguments[2]),arguments.length>=4&&(I.colors=arguments[3]),f(L)?I.showHidden=L:L&&q._extend(I,L),y(I.showHidden)&&(I.showHidden=!1),y(I.depth)&&(I.depth=2),y(I.colors)&&(I.colors=!1),y(I.customInspect)&&(I.customInspect=!0),I.colors&&(I.stylize=r),u(I,k,I.depth)}function r(k,L){var I=o.styles[L];return I?"\x1B["+o.colors[I][0]+"m"+k+"\x1B["+o.colors[I][1]+"m":k}function i(k,L){return k}function u(k,L,I){if(k.customInspect&&L&&E(L.inspect)&&L.inspect!==q.inspect&&(!L.constructor||L.constructor.prototype!==L)){var R=L.inspect(I,k);return m(R)||(R=u(k,R,I)),R}var V=function(j,G){if(y(G))return j.stylize("undefined","undefined");if(m(G)){var W="'"+JSON.stringify(G).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return j.stylize(W,"string")}if(d(G))return j.stylize(""+G,"number");if(f(G))return j.stylize(""+G,"boolean");if(g(G))return j.stylize("null","null")}(k,L);if(V)return V;var O=Object.keys(L),J=function(j){var G={};return j.forEach(function(W,Q){G[W]=!0}),G}(O);if(k.showHidden&&(O=Object.getOwnPropertyNames(L)),A(L)&&(O.indexOf("message")>=0||O.indexOf("description")>=0))return s(L);if(O.length===0){if(E(L)){var D=L.name?": "+L.name:"";return k.stylize("[Function"+D+"]","special")}if(v(L))return k.stylize(RegExp.prototype.toString.call(L),"regexp");if(w(L))return k.stylize(Date.prototype.toString.call(L),"date");if(A(L))return s(L)}var B,N="",F=!1,H=["{","}"];return c(L)&&(F=!0,H=["[","]"]),E(L)&&(N=" [Function"+(L.name?": "+L.name:"")+"]"),v(L)&&(N=" "+RegExp.prototype.toString.call(L)),w(L)&&(N=" "+Date.prototype.toUTCString.call(L)),A(L)&&(N=" "+s(L)),O.length!==0||F&&L.length!=0?I<0?v(L)?k.stylize(RegExp.prototype.toString.call(L),"regexp"):k.stylize("[Object]","special"):(k.seen.push(L),B=F?function(j,G,W,Q,$){for(var ee=[],ie=0,ae=G.length;ie<ae;++ie)C(G,String(ie))?ee.push(a(j,G,W,Q,String(ie),!0)):ee.push("");return $.forEach(function(oe){oe.match(/^\d+$/)||ee.push(a(j,G,W,Q,oe,!0))}),ee}(k,L,I,J,O):O.map(function(j){return a(k,L,I,J,j,F)}),k.seen.pop(),function(j,G,W){return j.reduce(function(Q,$){return $.indexOf(`
`)>=0,Q+$.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?W[0]+(G===""?"":G+`
 `)+" "+j.join(`,
  `)+" "+W[1]:W[0]+G+" "+j.join(", ")+" "+W[1]}(B,N,H)):H[0]+N+H[1]}function s(k){return"["+Error.prototype.toString.call(k)+"]"}function a(k,L,I,R,V,O){var J,D,B;if((B=Object.getOwnPropertyDescriptor(L,V)||{value:L[V]}).get?D=B.set?k.stylize("[Getter/Setter]","special"):k.stylize("[Getter]","special"):B.set&&(D=k.stylize("[Setter]","special")),C(R,V)||(J="["+V+"]"),D||(k.seen.indexOf(B.value)<0?(D=g(I)?u(k,B.value,null):u(k,B.value,I-1)).indexOf(`
`)>-1&&(D=O?D.split(`
`).map(function(N){return"  "+N}).join(`
`).substr(2):`
`+D.split(`
`).map(function(N){return"   "+N}).join(`
`)):D=k.stylize("[Circular]","special")),y(J)){if(O&&V.match(/^\d+$/))return D;(J=JSON.stringify(""+V)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(J=J.substr(1,J.length-2),J=k.stylize(J,"name")):(J=J.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),J=k.stylize(J,"string"))}return J+": "+D}function c(k){return Array.isArray(k)}function f(k){return typeof k=="boolean"}function g(k){return k===null}function d(k){return typeof k=="number"}function m(k){return typeof k=="string"}function y(k){return k===void 0}function v(k){return T(k)&&M(k)==="[object RegExp]"}function T(k){return typeof k=="object"&&k!==null}function w(k){return T(k)&&M(k)==="[object Date]"}function A(k){return T(k)&&(M(k)==="[object Error]"||k instanceof Error)}function E(k){return typeof k=="function"}function M(k){return Object.prototype.toString.call(k)}function b(k){return k<10?"0"+k.toString(10):k.toString(10)}q.debuglog=function(k){if(y(l)&&(l=t.env.NODE_DEBUG||""),k=k.toUpperCase(),!e[k])if(new RegExp("\\b"+k+"\\b","i").test(l)){var L=t.pid;e[k]=function(){var I=q.format.apply(q,arguments);console.error("%s %d: %s",k,L,I)}}else e[k]=function(){};return e[k]},q.inspect=o,o.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},o.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},q.isArray=c,q.isBoolean=f,q.isNull=g,q.isNullOrUndefined=function(k){return k==null},q.isNumber=d,q.isString=m,q.isSymbol=function(k){return typeof k=="symbol"},q.isUndefined=y,q.isRegExp=v,q.isObject=T,q.isDate=w,q.isError=A,q.isFunction=E,q.isPrimitive=function(k){return k===null||typeof k=="boolean"||typeof k=="number"||typeof k=="string"||typeof k=="symbol"||typeof k>"u"},q.isBuffer=n("./support/isBuffer");var _=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function S(){var k=new Date,L=[b(k.getHours()),b(k.getMinutes()),b(k.getSeconds())].join(":");return[k.getDate(),_[k.getMonth()],L].join(" ")}function C(k,L){return Object.prototype.hasOwnProperty.call(k,L)}q.log=function(){console.log("%s - %s",S(),q.format.apply(q,arguments))},q.inherits=n("inherits"),q._extend=function(k,L){if(!L||!T(L))return k;for(var I=Object.keys(L),R=I.length;R--;)k[I[R]]=L[I[R]];return k}}).call(this)}).call(this,n("_process"),typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{"./support/isBuffer":75,_process:526,inherits:74}],77:[function(n,z,q){z.exports=function(t){return atob(t)}},{}],78:[function(n,z,q){"use strict";z.exports=function(p,l){for(var e=l.length,o=new Array(e+1),r=0;r<e;++r){for(var i=new Array(e+1),u=0;u<=e;++u)i[u]=p[u][r];o[r]=i}for(o[e]=new Array(e+1),r=0;r<=e;++r)o[e][r]=1;var s=new Array(e+1);for(r=0;r<e;++r)s[r]=l[r];s[e]=1;var a=t(o,s),c=h(a[e+1]);c===0&&(c=1);var f=new Array(e+1);for(r=0;r<=e;++r)f[r]=h(a[r])/c;return f};var t=n("robust-linear-solve");function h(p){for(var l=0,e=0;e<p.length;++e)l+=p[e];return l}},{"robust-linear-solve":547}],79:[function(n,z,q){"use strict";q.byteLength=function(u){var s=r(u),a=s[0],c=s[1];return 3*(a+c)/4-c},q.toByteArray=function(u){var s,a,c=r(u),f=c[0],g=c[1],d=new p(function(v,T,w){return 3*(T+w)/4-w}(0,f,g)),m=0,y=g>0?f-4:f;for(a=0;a<y;a+=4)s=h[u.charCodeAt(a)]<<18|h[u.charCodeAt(a+1)]<<12|h[u.charCodeAt(a+2)]<<6|h[u.charCodeAt(a+3)],d[m++]=s>>16&255,d[m++]=s>>8&255,d[m++]=255&s;return g===2&&(s=h[u.charCodeAt(a)]<<2|h[u.charCodeAt(a+1)]>>4,d[m++]=255&s),g===1&&(s=h[u.charCodeAt(a)]<<10|h[u.charCodeAt(a+1)]<<4|h[u.charCodeAt(a+2)]>>2,d[m++]=s>>8&255,d[m++]=255&s),d},q.fromByteArray=function(u){for(var s,a=u.length,c=a%3,f=[],g=0,d=a-c;g<d;g+=16383)f.push(i(u,g,g+16383>d?d:g+16383));return c===1?(s=u[a-1],f.push(t[s>>2]+t[s<<4&63]+"==")):c===2&&(s=(u[a-2]<<8)+u[a-1],f.push(t[s>>10]+t[s>>4&63]+t[s<<2&63]+"=")),f.join("")};for(var t=[],h=[],p=typeof Uint8Array<"u"?Uint8Array:Array,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=0,o=l.length;e<o;++e)t[e]=l[e],h[l.charCodeAt(e)]=e;function r(u){var s=u.length;if(s%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var a=u.indexOf("=");return a===-1&&(a=s),[a,a===s?0:4-a%4]}function i(u,s,a){for(var c,f,g=[],d=s;d<a;d+=3)c=(u[d]<<16&16711680)+(u[d+1]<<8&65280)+(255&u[d+2]),g.push(t[(f=c)>>18&63]+t[f>>12&63]+t[f>>6&63]+t[63&f]);return g.join("")}h["-".charCodeAt(0)]=62,h["_".charCodeAt(0)]=63},{}],80:[function(n,z,q){"use strict";var t=n("./lib/rationalize");z.exports=function(h,p){return t(h[0].mul(p[1]).add(p[0].mul(h[1])),h[1].mul(p[1]))}},{"./lib/rationalize":90}],81:[function(n,z,q){"use strict";z.exports=function(t,h){return t[0].mul(h[1]).cmp(h[0].mul(t[1]))}},{}],82:[function(n,z,q){"use strict";var t=n("./lib/rationalize");z.exports=function(h,p){return t(h[0].mul(p[1]),h[1].mul(p[0]))}},{"./lib/rationalize":90}],83:[function(n,z,q){"use strict";var t=n("./is-rat"),h=n("./lib/is-bn"),p=n("./lib/num-to-bn"),l=n("./lib/str-to-bn"),e=n("./lib/rationalize"),o=n("./div");z.exports=function r(i,u){if(t(i))return u?o(i,r(u)):[i[0].clone(),i[1].clone()];var s,a,c=0;if(h(i))s=i.clone();else if(typeof i=="string")s=l(i);else{if(i===0)return[p(0),p(1)];if(i===Math.floor(i))s=p(i);else{for(;i!==Math.floor(i);)i*=Math.pow(2,256),c-=256;s=p(i)}}if(t(u))s.mul(u[1]),a=u[0].clone();else if(h(u))a=u.clone();else if(typeof u=="string")a=l(u);else if(u)if(u===Math.floor(u))a=p(u);else{for(;u!==Math.floor(u);)u*=Math.pow(2,256),c+=256;a=p(u)}else a=p(1);return c>0?s=s.ushln(c):c<0&&(a=a.ushln(-c)),e(s,a)}},{"./div":82,"./is-rat":84,"./lib/is-bn":88,"./lib/num-to-bn":89,"./lib/rationalize":90,"./lib/str-to-bn":91}],84:[function(n,z,q){"use strict";var t=n("./lib/is-bn");z.exports=function(h){return Array.isArray(h)&&h.length===2&&t(h[0])&&t(h[1])}},{"./lib/is-bn":88}],85:[function(n,z,q){"use strict";var t=n("bn.js");z.exports=function(h){return h.cmp(new t(0))}},{"bn.js":99}],86:[function(n,z,q){"use strict";var t=n("./bn-sign");z.exports=function(h){var p=h.length,l=h.words,e=0;if(p===1)e=l[0];else if(p===2)e=l[0]+67108864*l[1];else for(var o=0;o<p;o++){var r=l[o];e+=r*Math.pow(67108864,o)}return t(h)*e}},{"./bn-sign":85}],87:[function(n,z,q){"use strict";var t=n("double-bits"),h=n("bit-twiddle").countTrailingZeros;z.exports=function(p){var l=h(t.lo(p));if(l<32)return l;var e=h(t.hi(p));return e>20?52:e+32}},{"bit-twiddle":97,"double-bits":173}],88:[function(n,z,q){"use strict";n("bn.js"),z.exports=function(t){return t&&typeof t=="object"&&!!t.words}},{"bn.js":99}],89:[function(n,z,q){"use strict";var t=n("bn.js"),h=n("double-bits");z.exports=function(p){var l=h.exponent(p);return l<52?new t(p):new t(p*Math.pow(2,52-l)).ushln(l-52)}},{"bn.js":99,"double-bits":173}],90:[function(n,z,q){"use strict";var t=n("./num-to-bn"),h=n("./bn-sign");z.exports=function(p,l){var e=h(p),o=h(l);if(e===0)return[t(0),t(1)];if(o===0)return[t(0),t(0)];o<0&&(p=p.neg(),l=l.neg());var r=p.gcd(l);return r.cmpn(1)?[p.div(r),l.div(r)]:[p,l]}},{"./bn-sign":85,"./num-to-bn":89}],91:[function(n,z,q){"use strict";var t=n("bn.js");z.exports=function(h){return new t(h)}},{"bn.js":99}],92:[function(n,z,q){"use strict";var t=n("./lib/rationalize");z.exports=function(h,p){return t(h[0].mul(p[0]),h[1].mul(p[1]))}},{"./lib/rationalize":90}],93:[function(n,z,q){"use strict";var t=n("./lib/bn-sign");z.exports=function(h){return t(h[0])*t(h[1])}},{"./lib/bn-sign":85}],94:[function(n,z,q){"use strict";var t=n("./lib/rationalize");z.exports=function(h,p){return t(h[0].mul(p[1]).sub(h[1].mul(p[0])),h[1].mul(p[1]))}},{"./lib/rationalize":90}],95:[function(n,z,q){"use strict";var t=n("./lib/bn-to-num"),h=n("./lib/ctz");z.exports=function(p){var l=p[0],e=p[1];if(l.cmpn(0)===0)return 0;var o=l.abs().divmod(e.abs()),r=o.div,i=t(r),u=o.mod,s=l.negative!==e.negative?-1:1;if(u.cmpn(0)===0)return s*i;if(i){var a=h(i)+4,c=t(u.ushln(a).divRound(e));return s*(i+c*Math.pow(2,-a))}var f=e.bitLength()-u.bitLength()+53;return c=t(u.ushln(f).divRound(e)),f<1023?s*c*Math.pow(2,-f):(c*=Math.pow(2,-1023),s*c*Math.pow(2,1023-f))}},{"./lib/bn-to-num":86,"./lib/ctz":87}],96:[function(n,z,q){"use strict";function t(p,l,e,o,r){var i=["function ",p,"(a,l,h,",o.join(","),"){",r?"":"var i=",e?"l-1":"h+1",";while(l<=h){var m=(l+h)>>>1,x=a[m]"];return r?l.indexOf("c")<0?i.push(";if(x===y){return m}else if(x<=y){"):i.push(";var p=c(x,y);if(p===0){return m}else if(p<=0){"):i.push(";if(",l,"){i=m;"),e?i.push("l=m+1}else{h=m-1}"):i.push("h=m-1}else{l=m+1}"),i.push("}"),r?i.push("return -1};"):i.push("return i};"),i.join("")}function h(p,l,e,o){return new Function([t("A","x"+p+"y",l,["y"],o),t("P","c(x,y)"+p+"0",l,["y","c"],o),"function dispatchBsearch",e,"(a,y,c,l,h){if(typeof(c)==='function'){return P(a,(l===void 0)?0:l|0,(h===void 0)?a.length-1:h|0,y,c)}else{return A(a,(c===void 0)?0:c|0,(l===void 0)?a.length-1:l|0,y)}}return dispatchBsearch",e].join(""))()}z.exports={ge:h(">=",!1,"GE"),gt:h(">",!1,"GT"),lt:h("<",!0,"LT"),le:h("<=",!0,"LE"),eq:h("-",!0,"EQ",!0)}},{}],97:[function(n,z,q){"use strict";function t(p){var l=32;return(p&=-p)&&l--,65535&p&&(l-=16),16711935&p&&(l-=8),252645135&p&&(l-=4),858993459&p&&(l-=2),1431655765&p&&(l-=1),l}q.INT_BITS=32,q.INT_MAX=2147483647,q.INT_MIN=-1<<31,q.sign=function(p){return(p>0)-(p<0)},q.abs=function(p){var l=p>>31;return(p^l)-l},q.min=function(p,l){return l^(p^l)&-(p<l)},q.max=function(p,l){return p^(p^l)&-(p<l)},q.isPow2=function(p){return!(p&p-1||!p)},q.log2=function(p){var l,e;return l=(p>65535)<<4,l|=e=((p>>>=l)>255)<<3,l|=e=((p>>>=e)>15)<<2,(l|=e=((p>>>=e)>3)<<1)|(p>>>=e)>>1},q.log10=function(p){return p>=1e9?9:p>=1e8?8:p>=1e7?7:p>=1e6?6:p>=1e5?5:p>=1e4?4:p>=1e3?3:p>=100?2:p>=10?1:0},q.popCount=function(p){return 16843009*((p=(858993459&(p-=p>>>1&1431655765))+(p>>>2&858993459))+(p>>>4)&252645135)>>>24},q.countTrailingZeros=t,q.nextPow2=function(p){return p+=p===0,--p,p|=p>>>1,p|=p>>>2,p|=p>>>4,p|=p>>>8,(p|=p>>>16)+1},q.prevPow2=function(p){return p|=p>>>1,p|=p>>>2,p|=p>>>4,p|=p>>>8,(p|=p>>>16)-(p>>>1)},q.parity=function(p){return p^=p>>>16,p^=p>>>8,p^=p>>>4,27030>>>(p&=15)&1};var h=new Array(256);(function(p){for(var l=0;l<256;++l){var e=l,o=l,r=7;for(e>>>=1;e;e>>>=1)o<<=1,o|=1&e,--r;p[l]=o<<r&255}})(h),q.reverse=function(p){return h[255&p]<<24|h[p>>>8&255]<<16|h[p>>>16&255]<<8|h[p>>>24&255]},q.interleave2=function(p,l){return(p=1431655765&((p=858993459&((p=252645135&((p=16711935&((p&=65535)|p<<8))|p<<4))|p<<2))|p<<1))|(l=1431655765&((l=858993459&((l=252645135&((l=16711935&((l&=65535)|l<<8))|l<<4))|l<<2))|l<<1))<<1},q.deinterleave2=function(p,l){return(p=65535&((p=16711935&((p=252645135&((p=858993459&((p=p>>>l&1431655765)|p>>>1))|p>>>2))|p>>>4))|p>>>16))<<16>>16},q.interleave3=function(p,l,e){return p=1227133513&((p=3272356035&((p=251719695&((p=4278190335&((p&=1023)|p<<16))|p<<8))|p<<4))|p<<2),(p|=(l=1227133513&((l=3272356035&((l=251719695&((l=4278190335&((l&=1023)|l<<16))|l<<8))|l<<4))|l<<2))<<1)|(e=1227133513&((e=3272356035&((e=251719695&((e=4278190335&((e&=1023)|e<<16))|e<<8))|e<<4))|e<<2))<<2},q.deinterleave3=function(p,l){return(p=1023&((p=4278190335&((p=251719695&((p=3272356035&((p=p>>>l&1227133513)|p>>>2))|p>>>4))|p>>>8))|p>>>16))<<22>>22},q.nextCombination=function(p){var l=p|p-1;return l+1|(~l&-~l)-1>>>t(p)+1}},{}],98:[function(n,z,q){"use strict";var t=n("clamp");z.exports=function(e,o){o||(o={});var r,i,u,s,a,c,f,g,d,m,y,v=o.cutoff==null?.25:o.cutoff,T=o.radius==null?8:o.radius,w=o.channel||0;if(ArrayBuffer.isView(e)||Array.isArray(e)){if(!o.width||!o.height)throw Error("For raw data width and height should be provided by options");r=o.width,i=o.height,s=e,c=o.stride?o.stride:Math.floor(e.length/r/i)}else window.HTMLCanvasElement&&e instanceof window.HTMLCanvasElement?(f=(g=e).getContext("2d"),r=g.width,i=g.height,d=f.getImageData(0,0,r,i),s=d.data,c=4):window.CanvasRenderingContext2D&&e instanceof window.CanvasRenderingContext2D?(g=e.canvas,f=e,r=g.width,i=g.height,d=f.getImageData(0,0,r,i),s=d.data,c=4):window.ImageData&&e instanceof window.ImageData&&(d=e,r=e.width,i=e.height,s=d.data,c=4);if(u=Math.max(r,i),window.Uint8ClampedArray&&s instanceof window.Uint8ClampedArray||window.Uint8Array&&s instanceof window.Uint8Array)for(a=s,s=Array(r*i),m=0,y=a.length;m<y;m++)s[m]=a[m*c+w]/255;else if(c!==1)throw Error("Raw data can have only 1 value per pixel");var A=Array(r*i),E=Array(r*i),M=Array(u),b=Array(u),_=Array(u+1),S=Array(u);for(m=0,y=r*i;m<y;m++){var C=s[m];A[m]=C===1?0:C===0?h:Math.pow(Math.max(0,.5-C),2),E[m]=C===1?h:C===0?0:Math.pow(Math.max(0,C-.5),2)}p(A,r,i,M,b,S,_),p(E,r,i,M,b,S,_);var k=window.Float32Array?new Float32Array(r*i):new Array(r*i);for(m=0,y=r*i;m<y;m++)k[m]=t(1-((A[m]-E[m])/T+v),0,1);return k};var h=1e20;function p(e,o,r,i,u,s,a){for(var c=0;c<o;c++){for(var f=0;f<r;f++)i[f]=e[f*o+c];for(l(i,u,s,a,r),f=0;f<r;f++)e[f*o+c]=u[f]}for(f=0;f<r;f++){for(c=0;c<o;c++)i[c]=e[f*o+c];for(l(i,u,s,a,o),c=0;c<o;c++)e[f*o+c]=Math.sqrt(u[c])}}function l(e,o,r,i,u){r[0]=0,i[0]=-h,i[1]=+h;for(var s=1,a=0;s<u;s++){for(var c=(e[s]+s*s-(e[r[a]]+r[a]*r[a]))/(2*s-2*r[a]);c<=i[a];)a--,c=(e[s]+s*s-(e[r[a]]+r[a]*r[a]))/(2*s-2*r[a]);r[++a]=s,i[a]=c,i[a+1]=+h}for(s=0,a=0;s<u;s++){for(;i[a+1]<s;)a++;o[s]=(s-r[a])*(s-r[a])+e[r[a]]}}},{clamp:120}],99:[function(n,z,q){(function(t,h){"use strict";function p(b,_){if(!b)throw new Error(_||"Assertion failed")}function l(b,_){b.super_=_;var S=function(){};S.prototype=_.prototype,b.prototype=new S,b.prototype.constructor=b}function e(b,_,S){if(e.isBN(b))return b;this.negative=0,this.words=null,this.length=0,this.red=null,b!==null&&(_!=="le"&&_!=="be"||(S=_,_=10),this._init(b||0,_||10,S||"be"))}var o;typeof t=="object"?t.exports=e:h.BN=e,e.BN=e,e.wordSize=26;try{o=n("buffer").Buffer}catch{}function r(b,_,S){for(var C=0,k=Math.min(b.length,S),L=_;L<k;L++){var I=b.charCodeAt(L)-48;C<<=4,C|=I>=49&&I<=54?I-49+10:I>=17&&I<=22?I-17+10:15&I}return C}function i(b,_,S,C){for(var k=0,L=Math.min(b.length,S),I=_;I<L;I++){var R=b.charCodeAt(I)-48;k*=C,k+=R>=49?R-49+10:R>=17?R-17+10:R}return k}e.isBN=function(b){return b instanceof e||b!==null&&typeof b=="object"&&b.constructor.wordSize===e.wordSize&&Array.isArray(b.words)},e.max=function(b,_){return b.cmp(_)>0?b:_},e.min=function(b,_){return b.cmp(_)<0?b:_},e.prototype._init=function(b,_,S){if(typeof b=="number")return this._initNumber(b,_,S);if(typeof b=="object")return this._initArray(b,_,S);_==="hex"&&(_=16),p(_===(0|_)&&_>=2&&_<=36);var C=0;(b=b.toString().replace(/\s+/g,""))[0]==="-"&&C++,_===16?this._parseHex(b,C):this._parseBase(b,_,C),b[0]==="-"&&(this.negative=1),this.strip(),S==="le"&&this._initArray(this.toArray(),_,S)},e.prototype._initNumber=function(b,_,S){b<0&&(this.negative=1,b=-b),b<67108864?(this.words=[67108863&b],this.length=1):b<4503599627370496?(this.words=[67108863&b,b/67108864&67108863],this.length=2):(p(b<9007199254740992),this.words=[67108863&b,b/67108864&67108863,1],this.length=3),S==="le"&&this._initArray(this.toArray(),_,S)},e.prototype._initArray=function(b,_,S){if(p(typeof b.length=="number"),b.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(b.length/3),this.words=new Array(this.length);for(var C=0;C<this.length;C++)this.words[C]=0;var k,L,I=0;if(S==="be")for(C=b.length-1,k=0;C>=0;C-=3)L=b[C]|b[C-1]<<8|b[C-2]<<16,this.words[k]|=L<<I&67108863,this.words[k+1]=L>>>26-I&67108863,(I+=24)>=26&&(I-=26,k++);else if(S==="le")for(C=0,k=0;C<b.length;C+=3)L=b[C]|b[C+1]<<8|b[C+2]<<16,this.words[k]|=L<<I&67108863,this.words[k+1]=L>>>26-I&67108863,(I+=24)>=26&&(I-=26,k++);return this.strip()},e.prototype._parseHex=function(b,_){this.length=Math.ceil((b.length-_)/6),this.words=new Array(this.length);for(var S=0;S<this.length;S++)this.words[S]=0;var C,k,L=0;for(S=b.length-6,C=0;S>=_;S-=6)k=r(b,S,S+6),this.words[C]|=k<<L&67108863,this.words[C+1]|=k>>>26-L&4194303,(L+=24)>=26&&(L-=26,C++);S+6!==_&&(k=r(b,_,S+6),this.words[C]|=k<<L&67108863,this.words[C+1]|=k>>>26-L&4194303),this.strip()},e.prototype._parseBase=function(b,_,S){this.words=[0],this.length=1;for(var C=0,k=1;k<=67108863;k*=_)C++;C--,k=k/_|0;for(var L=b.length-S,I=L%C,R=Math.min(L,L-I)+S,V=0,O=S;O<R;O+=C)V=i(b,O,O+C,_),this.imuln(k),this.words[0]+V<67108864?this.words[0]+=V:this._iaddn(V);if(I!==0){var J=1;for(V=i(b,O,b.length,_),O=0;O<I;O++)J*=_;this.imuln(J),this.words[0]+V<67108864?this.words[0]+=V:this._iaddn(V)}},e.prototype.copy=function(b){b.words=new Array(this.length);for(var _=0;_<this.length;_++)b.words[_]=this.words[_];b.length=this.length,b.negative=this.negative,b.red=this.red},e.prototype.clone=function(){var b=new e(null);return this.copy(b),b},e.prototype._expand=function(b){for(;this.length<b;)this.words[this.length++]=0;return this},e.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},e.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},e.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var u=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],s=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],a=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function c(b,_,S){S.negative=_.negative^b.negative;var C=b.length+_.length|0;S.length=C,C=C-1|0;var k=0|b.words[0],L=0|_.words[0],I=k*L,R=67108863&I,V=I/67108864|0;S.words[0]=R;for(var O=1;O<C;O++){for(var J=V>>>26,D=67108863&V,B=Math.min(O,_.length-1),N=Math.max(0,O-b.length+1);N<=B;N++){var F=O-N|0;J+=(I=(k=0|b.words[F])*(L=0|_.words[N])+D)/67108864|0,D=67108863&I}S.words[O]=0|D,V=0|J}return V!==0?S.words[O]=0|V:S.length--,S.strip()}e.prototype.toString=function(b,_){var S;if(_=0|_||1,(b=b||10)===16||b==="hex"){S="";for(var C=0,k=0,L=0;L<this.length;L++){var I=this.words[L],R=(16777215&(I<<C|k)).toString(16);S=(k=I>>>24-C&16777215)!==0||L!==this.length-1?u[6-R.length]+R+S:R+S,(C+=2)>=26&&(C-=26,L--)}for(k!==0&&(S=k.toString(16)+S);S.length%_!=0;)S="0"+S;return this.negative!==0&&(S="-"+S),S}if(b===(0|b)&&b>=2&&b<=36){var V=s[b],O=a[b];S="";var J=this.clone();for(J.negative=0;!J.isZero();){var D=J.modn(O).toString(b);S=(J=J.idivn(O)).isZero()?D+S:u[V-D.length]+D+S}for(this.isZero()&&(S="0"+S);S.length%_!=0;)S="0"+S;return this.negative!==0&&(S="-"+S),S}p(!1,"Base should be between 2 and 36")},e.prototype.toNumber=function(){var b=this.words[0];return this.length===2?b+=67108864*this.words[1]:this.length===3&&this.words[2]===1?b+=4503599627370496+67108864*this.words[1]:this.length>2&&p(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-b:b},e.prototype.toJSON=function(){return this.toString(16)},e.prototype.toBuffer=function(b,_){return p(typeof o<"u"),this.toArrayLike(o,b,_)},e.prototype.toArray=function(b,_){return this.toArrayLike(Array,b,_)},e.prototype.toArrayLike=function(b,_,S){var C=this.byteLength(),k=S||Math.max(1,C);p(C<=k,"byte array longer than desired length"),p(k>0,"Requested array length <= 0"),this.strip();var L,I,R=_==="le",V=new b(k),O=this.clone();if(R){for(I=0;!O.isZero();I++)L=O.andln(255),O.iushrn(8),V[I]=L;for(;I<k;I++)V[I]=0}else{for(I=0;I<k-C;I++)V[I]=0;for(I=0;!O.isZero();I++)L=O.andln(255),O.iushrn(8),V[k-I-1]=L}return V},Math.clz32?e.prototype._countBits=function(b){return 32-Math.clz32(b)}:e.prototype._countBits=function(b){var _=b,S=0;return _>=4096&&(S+=13,_>>>=13),_>=64&&(S+=7,_>>>=7),_>=8&&(S+=4,_>>>=4),_>=2&&(S+=2,_>>>=2),S+_},e.prototype._zeroBits=function(b){if(b===0)return 26;var _=b,S=0;return!(8191&_)&&(S+=13,_>>>=13),!(127&_)&&(S+=7,_>>>=7),!(15&_)&&(S+=4,_>>>=4),!(3&_)&&(S+=2,_>>>=2),!(1&_)&&S++,S},e.prototype.bitLength=function(){var b=this.words[this.length-1],_=this._countBits(b);return 26*(this.length-1)+_},e.prototype.zeroBits=function(){if(this.isZero())return 0;for(var b=0,_=0;_<this.length;_++){var S=this._zeroBits(this.words[_]);if(b+=S,S!==26)break}return b},e.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},e.prototype.toTwos=function(b){return this.negative!==0?this.abs().inotn(b).iaddn(1):this.clone()},e.prototype.fromTwos=function(b){return this.testn(b-1)?this.notn(b).iaddn(1).ineg():this.clone()},e.prototype.isNeg=function(){return this.negative!==0},e.prototype.neg=function(){return this.clone().ineg()},e.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},e.prototype.iuor=function(b){for(;this.length<b.length;)this.words[this.length++]=0;for(var _=0;_<b.length;_++)this.words[_]=this.words[_]|b.words[_];return this.strip()},e.prototype.ior=function(b){return p((this.negative|b.negative)==0),this.iuor(b)},e.prototype.or=function(b){return this.length>b.length?this.clone().ior(b):b.clone().ior(this)},e.prototype.uor=function(b){return this.length>b.length?this.clone().iuor(b):b.clone().iuor(this)},e.prototype.iuand=function(b){var _;_=this.length>b.length?b:this;for(var S=0;S<_.length;S++)this.words[S]=this.words[S]&b.words[S];return this.length=_.length,this.strip()},e.prototype.iand=function(b){return p((this.negative|b.negative)==0),this.iuand(b)},e.prototype.and=function(b){return this.length>b.length?this.clone().iand(b):b.clone().iand(this)},e.prototype.uand=function(b){return this.length>b.length?this.clone().iuand(b):b.clone().iuand(this)},e.prototype.iuxor=function(b){var _,S;this.length>b.length?(_=this,S=b):(_=b,S=this);for(var C=0;C<S.length;C++)this.words[C]=_.words[C]^S.words[C];if(this!==_)for(;C<_.length;C++)this.words[C]=_.words[C];return this.length=_.length,this.strip()},e.prototype.ixor=function(b){return p((this.negative|b.negative)==0),this.iuxor(b)},e.prototype.xor=function(b){return this.length>b.length?this.clone().ixor(b):b.clone().ixor(this)},e.prototype.uxor=function(b){return this.length>b.length?this.clone().iuxor(b):b.clone().iuxor(this)},e.prototype.inotn=function(b){p(typeof b=="number"&&b>=0);var _=0|Math.ceil(b/26),S=b%26;this._expand(_),S>0&&_--;for(var C=0;C<_;C++)this.words[C]=67108863&~this.words[C];return S>0&&(this.words[C]=~this.words[C]&67108863>>26-S),this.strip()},e.prototype.notn=function(b){return this.clone().inotn(b)},e.prototype.setn=function(b,_){p(typeof b=="number"&&b>=0);var S=b/26|0,C=b%26;return this._expand(S+1),this.words[S]=_?this.words[S]|1<<C:this.words[S]&~(1<<C),this.strip()},e.prototype.iadd=function(b){var _,S,C;if(this.negative!==0&&b.negative===0)return this.negative=0,_=this.isub(b),this.negative^=1,this._normSign();if(this.negative===0&&b.negative!==0)return b.negative=0,_=this.isub(b),b.negative=1,_._normSign();this.length>b.length?(S=this,C=b):(S=b,C=this);for(var k=0,L=0;L<C.length;L++)_=(0|S.words[L])+(0|C.words[L])+k,this.words[L]=67108863&_,k=_>>>26;for(;k!==0&&L<S.length;L++)_=(0|S.words[L])+k,this.words[L]=67108863&_,k=_>>>26;if(this.length=S.length,k!==0)this.words[this.length]=k,this.length++;else if(S!==this)for(;L<S.length;L++)this.words[L]=S.words[L];return this},e.prototype.add=function(b){var _;return b.negative!==0&&this.negative===0?(b.negative=0,_=this.sub(b),b.negative^=1,_):b.negative===0&&this.negative!==0?(this.negative=0,_=b.sub(this),this.negative=1,_):this.length>b.length?this.clone().iadd(b):b.clone().iadd(this)},e.prototype.isub=function(b){if(b.negative!==0){b.negative=0;var _=this.iadd(b);return b.negative=1,_._normSign()}if(this.negative!==0)return this.negative=0,this.iadd(b),this.negative=1,this._normSign();var S,C,k=this.cmp(b);if(k===0)return this.negative=0,this.length=1,this.words[0]=0,this;k>0?(S=this,C=b):(S=b,C=this);for(var L=0,I=0;I<C.length;I++)L=(_=(0|S.words[I])-(0|C.words[I])+L)>>26,this.words[I]=67108863&_;for(;L!==0&&I<S.length;I++)L=(_=(0|S.words[I])+L)>>26,this.words[I]=67108863&_;if(L===0&&I<S.length&&S!==this)for(;I<S.length;I++)this.words[I]=S.words[I];return this.length=Math.max(this.length,I),S!==this&&(this.negative=1),this.strip()},e.prototype.sub=function(b){return this.clone().isub(b)};var f=function(b,_,S){var C,k,L,I=b.words,R=_.words,V=S.words,O=0,J=0|I[0],D=8191&J,B=J>>>13,N=0|I[1],F=8191&N,H=N>>>13,j=0|I[2],G=8191&j,W=j>>>13,Q=0|I[3],$=8191&Q,ee=Q>>>13,ie=0|I[4],ae=8191&ie,oe=ie>>>13,de=0|I[5],le=8191&de,fe=de>>>13,ue=0|I[6],we=8191&ue,Ae=ue>>>13,Se=0|I[7],ke=8191&Se,Me=Se>>>13,ve=0|I[8],ge=8191&ve,De=ve>>>13,_e=0|I[9],Pe=8191&_e,Fe=_e>>>13,ze=0|R[0],He=8191&ze,et=ze>>>13,Re=0|R[1],Ze=8191&Re,Ke=Re>>>13,$e=0|R[2],rt=8191&$e,at=$e>>>13,lt=0|R[3],gt=8191&lt,Ie=lt>>>13,be=0|R[4],We=8191&be,Ge=be>>>13,st=0|R[5],ot=8191&st,Ce=st>>>13,Ue=0|R[6],Ye=8191&Ue,xe=Ue>>>13,Ee=0|R[7],Je=8191&Ee,it=Ee>>>13,ht=0|R[8],ct=8191&ht,mt=ht>>>13,bt=0|R[9],Et=8191&bt,Mt=bt>>>13;S.negative=b.negative^_.negative,S.length=19;var _t=(O+(C=Math.imul(D,He))|0)+((8191&(k=(k=Math.imul(D,et))+Math.imul(B,He)|0))<<13)|0;O=((L=Math.imul(B,et))+(k>>>13)|0)+(_t>>>26)|0,_t&=67108863,C=Math.imul(F,He),k=(k=Math.imul(F,et))+Math.imul(H,He)|0,L=Math.imul(H,et);var xt=(O+(C=C+Math.imul(D,Ze)|0)|0)+((8191&(k=(k=k+Math.imul(D,Ke)|0)+Math.imul(B,Ze)|0))<<13)|0;O=((L=L+Math.imul(B,Ke)|0)+(k>>>13)|0)+(xt>>>26)|0,xt&=67108863,C=Math.imul(G,He),k=(k=Math.imul(G,et))+Math.imul(W,He)|0,L=Math.imul(W,et),C=C+Math.imul(F,Ze)|0,k=(k=k+Math.imul(F,Ke)|0)+Math.imul(H,Ze)|0,L=L+Math.imul(H,Ke)|0;var At=(O+(C=C+Math.imul(D,rt)|0)|0)+((8191&(k=(k=k+Math.imul(D,at)|0)+Math.imul(B,rt)|0))<<13)|0;O=((L=L+Math.imul(B,at)|0)+(k>>>13)|0)+(At>>>26)|0,At&=67108863,C=Math.imul($,He),k=(k=Math.imul($,et))+Math.imul(ee,He)|0,L=Math.imul(ee,et),C=C+Math.imul(G,Ze)|0,k=(k=k+Math.imul(G,Ke)|0)+Math.imul(W,Ze)|0,L=L+Math.imul(W,Ke)|0,C=C+Math.imul(F,rt)|0,k=(k=k+Math.imul(F,at)|0)+Math.imul(H,rt)|0,L=L+Math.imul(H,at)|0;var It=(O+(C=C+Math.imul(D,gt)|0)|0)+((8191&(k=(k=k+Math.imul(D,Ie)|0)+Math.imul(B,gt)|0))<<13)|0;O=((L=L+Math.imul(B,Ie)|0)+(k>>>13)|0)+(It>>>26)|0,It&=67108863,C=Math.imul(ae,He),k=(k=Math.imul(ae,et))+Math.imul(oe,He)|0,L=Math.imul(oe,et),C=C+Math.imul($,Ze)|0,k=(k=k+Math.imul($,Ke)|0)+Math.imul(ee,Ze)|0,L=L+Math.imul(ee,Ke)|0,C=C+Math.imul(G,rt)|0,k=(k=k+Math.imul(G,at)|0)+Math.imul(W,rt)|0,L=L+Math.imul(W,at)|0,C=C+Math.imul(F,gt)|0,k=(k=k+Math.imul(F,Ie)|0)+Math.imul(H,gt)|0,L=L+Math.imul(H,Ie)|0;var Nt=(O+(C=C+Math.imul(D,We)|0)|0)+((8191&(k=(k=k+Math.imul(D,Ge)|0)+Math.imul(B,We)|0))<<13)|0;O=((L=L+Math.imul(B,Ge)|0)+(k>>>13)|0)+(Nt>>>26)|0,Nt&=67108863,C=Math.imul(le,He),k=(k=Math.imul(le,et))+Math.imul(fe,He)|0,L=Math.imul(fe,et),C=C+Math.imul(ae,Ze)|0,k=(k=k+Math.imul(ae,Ke)|0)+Math.imul(oe,Ze)|0,L=L+Math.imul(oe,Ke)|0,C=C+Math.imul($,rt)|0,k=(k=k+Math.imul($,at)|0)+Math.imul(ee,rt)|0,L=L+Math.imul(ee,at)|0,C=C+Math.imul(G,gt)|0,k=(k=k+Math.imul(G,Ie)|0)+Math.imul(W,gt)|0,L=L+Math.imul(W,Ie)|0,C=C+Math.imul(F,We)|0,k=(k=k+Math.imul(F,Ge)|0)+Math.imul(H,We)|0,L=L+Math.imul(H,Ge)|0;var Ot=(O+(C=C+Math.imul(D,ot)|0)|0)+((8191&(k=(k=k+Math.imul(D,Ce)|0)+Math.imul(B,ot)|0))<<13)|0;O=((L=L+Math.imul(B,Ce)|0)+(k>>>13)|0)+(Ot>>>26)|0,Ot&=67108863,C=Math.imul(we,He),k=(k=Math.imul(we,et))+Math.imul(Ae,He)|0,L=Math.imul(Ae,et),C=C+Math.imul(le,Ze)|0,k=(k=k+Math.imul(le,Ke)|0)+Math.imul(fe,Ze)|0,L=L+Math.imul(fe,Ke)|0,C=C+Math.imul(ae,rt)|0,k=(k=k+Math.imul(ae,at)|0)+Math.imul(oe,rt)|0,L=L+Math.imul(oe,at)|0,C=C+Math.imul($,gt)|0,k=(k=k+Math.imul($,Ie)|0)+Math.imul(ee,gt)|0,L=L+Math.imul(ee,Ie)|0,C=C+Math.imul(G,We)|0,k=(k=k+Math.imul(G,Ge)|0)+Math.imul(W,We)|0,L=L+Math.imul(W,Ge)|0,C=C+Math.imul(F,ot)|0,k=(k=k+Math.imul(F,Ce)|0)+Math.imul(H,ot)|0,L=L+Math.imul(H,Ce)|0;var Yt=(O+(C=C+Math.imul(D,Ye)|0)|0)+((8191&(k=(k=k+Math.imul(D,xe)|0)+Math.imul(B,Ye)|0))<<13)|0;O=((L=L+Math.imul(B,xe)|0)+(k>>>13)|0)+(Yt>>>26)|0,Yt&=67108863,C=Math.imul(ke,He),k=(k=Math.imul(ke,et))+Math.imul(Me,He)|0,L=Math.imul(Me,et),C=C+Math.imul(we,Ze)|0,k=(k=k+Math.imul(we,Ke)|0)+Math.imul(Ae,Ze)|0,L=L+Math.imul(Ae,Ke)|0,C=C+Math.imul(le,rt)|0,k=(k=k+Math.imul(le,at)|0)+Math.imul(fe,rt)|0,L=L+Math.imul(fe,at)|0,C=C+Math.imul(ae,gt)|0,k=(k=k+Math.imul(ae,Ie)|0)+Math.imul(oe,gt)|0,L=L+Math.imul(oe,Ie)|0,C=C+Math.imul($,We)|0,k=(k=k+Math.imul($,Ge)|0)+Math.imul(ee,We)|0,L=L+Math.imul(ee,Ge)|0,C=C+Math.imul(G,ot)|0,k=(k=k+Math.imul(G,Ce)|0)+Math.imul(W,ot)|0,L=L+Math.imul(W,Ce)|0,C=C+Math.imul(F,Ye)|0,k=(k=k+Math.imul(F,xe)|0)+Math.imul(H,Ye)|0,L=L+Math.imul(H,xe)|0;var Pt=(O+(C=C+Math.imul(D,Je)|0)|0)+((8191&(k=(k=k+Math.imul(D,it)|0)+Math.imul(B,Je)|0))<<13)|0;O=((L=L+Math.imul(B,it)|0)+(k>>>13)|0)+(Pt>>>26)|0,Pt&=67108863,C=Math.imul(ge,He),k=(k=Math.imul(ge,et))+Math.imul(De,He)|0,L=Math.imul(De,et),C=C+Math.imul(ke,Ze)|0,k=(k=k+Math.imul(ke,Ke)|0)+Math.imul(Me,Ze)|0,L=L+Math.imul(Me,Ke)|0,C=C+Math.imul(we,rt)|0,k=(k=k+Math.imul(we,at)|0)+Math.imul(Ae,rt)|0,L=L+Math.imul(Ae,at)|0,C=C+Math.imul(le,gt)|0,k=(k=k+Math.imul(le,Ie)|0)+Math.imul(fe,gt)|0,L=L+Math.imul(fe,Ie)|0,C=C+Math.imul(ae,We)|0,k=(k=k+Math.imul(ae,Ge)|0)+Math.imul(oe,We)|0,L=L+Math.imul(oe,Ge)|0,C=C+Math.imul($,ot)|0,k=(k=k+Math.imul($,Ce)|0)+Math.imul(ee,ot)|0,L=L+Math.imul(ee,Ce)|0,C=C+Math.imul(G,Ye)|0,k=(k=k+Math.imul(G,xe)|0)+Math.imul(W,Ye)|0,L=L+Math.imul(W,xe)|0,C=C+Math.imul(F,Je)|0,k=(k=k+Math.imul(F,it)|0)+Math.imul(H,Je)|0,L=L+Math.imul(H,it)|0;var Ne=(O+(C=C+Math.imul(D,ct)|0)|0)+((8191&(k=(k=k+Math.imul(D,mt)|0)+Math.imul(B,ct)|0))<<13)|0;O=((L=L+Math.imul(B,mt)|0)+(k>>>13)|0)+(Ne>>>26)|0,Ne&=67108863,C=Math.imul(Pe,He),k=(k=Math.imul(Pe,et))+Math.imul(Fe,He)|0,L=Math.imul(Fe,et),C=C+Math.imul(ge,Ze)|0,k=(k=k+Math.imul(ge,Ke)|0)+Math.imul(De,Ze)|0,L=L+Math.imul(De,Ke)|0,C=C+Math.imul(ke,rt)|0,k=(k=k+Math.imul(ke,at)|0)+Math.imul(Me,rt)|0,L=L+Math.imul(Me,at)|0,C=C+Math.imul(we,gt)|0,k=(k=k+Math.imul(we,Ie)|0)+Math.imul(Ae,gt)|0,L=L+Math.imul(Ae,Ie)|0,C=C+Math.imul(le,We)|0,k=(k=k+Math.imul(le,Ge)|0)+Math.imul(fe,We)|0,L=L+Math.imul(fe,Ge)|0,C=C+Math.imul(ae,ot)|0,k=(k=k+Math.imul(ae,Ce)|0)+Math.imul(oe,ot)|0,L=L+Math.imul(oe,Ce)|0,C=C+Math.imul($,Ye)|0,k=(k=k+Math.imul($,xe)|0)+Math.imul(ee,Ye)|0,L=L+Math.imul(ee,xe)|0,C=C+Math.imul(G,Je)|0,k=(k=k+Math.imul(G,it)|0)+Math.imul(W,Je)|0,L=L+Math.imul(W,it)|0,C=C+Math.imul(F,ct)|0,k=(k=k+Math.imul(F,mt)|0)+Math.imul(H,ct)|0,L=L+Math.imul(H,mt)|0;var ut=(O+(C=C+Math.imul(D,Et)|0)|0)+((8191&(k=(k=k+Math.imul(D,Mt)|0)+Math.imul(B,Et)|0))<<13)|0;O=((L=L+Math.imul(B,Mt)|0)+(k>>>13)|0)+(ut>>>26)|0,ut&=67108863,C=Math.imul(Pe,Ze),k=(k=Math.imul(Pe,Ke))+Math.imul(Fe,Ze)|0,L=Math.imul(Fe,Ke),C=C+Math.imul(ge,rt)|0,k=(k=k+Math.imul(ge,at)|0)+Math.imul(De,rt)|0,L=L+Math.imul(De,at)|0,C=C+Math.imul(ke,gt)|0,k=(k=k+Math.imul(ke,Ie)|0)+Math.imul(Me,gt)|0,L=L+Math.imul(Me,Ie)|0,C=C+Math.imul(we,We)|0,k=(k=k+Math.imul(we,Ge)|0)+Math.imul(Ae,We)|0,L=L+Math.imul(Ae,Ge)|0,C=C+Math.imul(le,ot)|0,k=(k=k+Math.imul(le,Ce)|0)+Math.imul(fe,ot)|0,L=L+Math.imul(fe,Ce)|0,C=C+Math.imul(ae,Ye)|0,k=(k=k+Math.imul(ae,xe)|0)+Math.imul(oe,Ye)|0,L=L+Math.imul(oe,xe)|0,C=C+Math.imul($,Je)|0,k=(k=k+Math.imul($,it)|0)+Math.imul(ee,Je)|0,L=L+Math.imul(ee,it)|0,C=C+Math.imul(G,ct)|0,k=(k=k+Math.imul(G,mt)|0)+Math.imul(W,ct)|0,L=L+Math.imul(W,mt)|0;var wt=(O+(C=C+Math.imul(F,Et)|0)|0)+((8191&(k=(k=k+Math.imul(F,Mt)|0)+Math.imul(H,Et)|0))<<13)|0;O=((L=L+Math.imul(H,Mt)|0)+(k>>>13)|0)+(wt>>>26)|0,wt&=67108863,C=Math.imul(Pe,rt),k=(k=Math.imul(Pe,at))+Math.imul(Fe,rt)|0,L=Math.imul(Fe,at),C=C+Math.imul(ge,gt)|0,k=(k=k+Math.imul(ge,Ie)|0)+Math.imul(De,gt)|0,L=L+Math.imul(De,Ie)|0,C=C+Math.imul(ke,We)|0,k=(k=k+Math.imul(ke,Ge)|0)+Math.imul(Me,We)|0,L=L+Math.imul(Me,Ge)|0,C=C+Math.imul(we,ot)|0,k=(k=k+Math.imul(we,Ce)|0)+Math.imul(Ae,ot)|0,L=L+Math.imul(Ae,Ce)|0,C=C+Math.imul(le,Ye)|0,k=(k=k+Math.imul(le,xe)|0)+Math.imul(fe,Ye)|0,L=L+Math.imul(fe,xe)|0,C=C+Math.imul(ae,Je)|0,k=(k=k+Math.imul(ae,it)|0)+Math.imul(oe,Je)|0,L=L+Math.imul(oe,it)|0,C=C+Math.imul($,ct)|0,k=(k=k+Math.imul($,mt)|0)+Math.imul(ee,ct)|0,L=L+Math.imul(ee,mt)|0;var Bt=(O+(C=C+Math.imul(G,Et)|0)|0)+((8191&(k=(k=k+Math.imul(G,Mt)|0)+Math.imul(W,Et)|0))<<13)|0;O=((L=L+Math.imul(W,Mt)|0)+(k>>>13)|0)+(Bt>>>26)|0,Bt&=67108863,C=Math.imul(Pe,gt),k=(k=Math.imul(Pe,Ie))+Math.imul(Fe,gt)|0,L=Math.imul(Fe,Ie),C=C+Math.imul(ge,We)|0,k=(k=k+Math.imul(ge,Ge)|0)+Math.imul(De,We)|0,L=L+Math.imul(De,Ge)|0,C=C+Math.imul(ke,ot)|0,k=(k=k+Math.imul(ke,Ce)|0)+Math.imul(Me,ot)|0,L=L+Math.imul(Me,Ce)|0,C=C+Math.imul(we,Ye)|0,k=(k=k+Math.imul(we,xe)|0)+Math.imul(Ae,Ye)|0,L=L+Math.imul(Ae,xe)|0,C=C+Math.imul(le,Je)|0,k=(k=k+Math.imul(le,it)|0)+Math.imul(fe,Je)|0,L=L+Math.imul(fe,it)|0,C=C+Math.imul(ae,ct)|0,k=(k=k+Math.imul(ae,mt)|0)+Math.imul(oe,ct)|0,L=L+Math.imul(oe,mt)|0;var Jt=(O+(C=C+Math.imul($,Et)|0)|0)+((8191&(k=(k=k+Math.imul($,Mt)|0)+Math.imul(ee,Et)|0))<<13)|0;O=((L=L+Math.imul(ee,Mt)|0)+(k>>>13)|0)+(Jt>>>26)|0,Jt&=67108863,C=Math.imul(Pe,We),k=(k=Math.imul(Pe,Ge))+Math.imul(Fe,We)|0,L=Math.imul(Fe,Ge),C=C+Math.imul(ge,ot)|0,k=(k=k+Math.imul(ge,Ce)|0)+Math.imul(De,ot)|0,L=L+Math.imul(De,Ce)|0,C=C+Math.imul(ke,Ye)|0,k=(k=k+Math.imul(ke,xe)|0)+Math.imul(Me,Ye)|0,L=L+Math.imul(Me,xe)|0,C=C+Math.imul(we,Je)|0,k=(k=k+Math.imul(we,it)|0)+Math.imul(Ae,Je)|0,L=L+Math.imul(Ae,it)|0,C=C+Math.imul(le,ct)|0,k=(k=k+Math.imul(le,mt)|0)+Math.imul(fe,ct)|0,L=L+Math.imul(fe,mt)|0;var er=(O+(C=C+Math.imul(ae,Et)|0)|0)+((8191&(k=(k=k+Math.imul(ae,Mt)|0)+Math.imul(oe,Et)|0))<<13)|0;O=((L=L+Math.imul(oe,Mt)|0)+(k>>>13)|0)+(er>>>26)|0,er&=67108863,C=Math.imul(Pe,ot),k=(k=Math.imul(Pe,Ce))+Math.imul(Fe,ot)|0,L=Math.imul(Fe,Ce),C=C+Math.imul(ge,Ye)|0,k=(k=k+Math.imul(ge,xe)|0)+Math.imul(De,Ye)|0,L=L+Math.imul(De,xe)|0,C=C+Math.imul(ke,Je)|0,k=(k=k+Math.imul(ke,it)|0)+Math.imul(Me,Je)|0,L=L+Math.imul(Me,it)|0,C=C+Math.imul(we,ct)|0,k=(k=k+Math.imul(we,mt)|0)+Math.imul(Ae,ct)|0,L=L+Math.imul(Ae,mt)|0;var or=(O+(C=C+Math.imul(le,Et)|0)|0)+((8191&(k=(k=k+Math.imul(le,Mt)|0)+Math.imul(fe,Et)|0))<<13)|0;O=((L=L+Math.imul(fe,Mt)|0)+(k>>>13)|0)+(or>>>26)|0,or&=67108863,C=Math.imul(Pe,Ye),k=(k=Math.imul(Pe,xe))+Math.imul(Fe,Ye)|0,L=Math.imul(Fe,xe),C=C+Math.imul(ge,Je)|0,k=(k=k+Math.imul(ge,it)|0)+Math.imul(De,Je)|0,L=L+Math.imul(De,it)|0,C=C+Math.imul(ke,ct)|0,k=(k=k+Math.imul(ke,mt)|0)+Math.imul(Me,ct)|0,L=L+Math.imul(Me,mt)|0;var zt=(O+(C=C+Math.imul(we,Et)|0)|0)+((8191&(k=(k=k+Math.imul(we,Mt)|0)+Math.imul(Ae,Et)|0))<<13)|0;O=((L=L+Math.imul(Ae,Mt)|0)+(k>>>13)|0)+(zt>>>26)|0,zt&=67108863,C=Math.imul(Pe,Je),k=(k=Math.imul(Pe,it))+Math.imul(Fe,Je)|0,L=Math.imul(Fe,it),C=C+Math.imul(ge,ct)|0,k=(k=k+Math.imul(ge,mt)|0)+Math.imul(De,ct)|0,L=L+Math.imul(De,mt)|0;var Qt=(O+(C=C+Math.imul(ke,Et)|0)|0)+((8191&(k=(k=k+Math.imul(ke,Mt)|0)+Math.imul(Me,Et)|0))<<13)|0;O=((L=L+Math.imul(Me,Mt)|0)+(k>>>13)|0)+(Qt>>>26)|0,Qt&=67108863,C=Math.imul(Pe,ct),k=(k=Math.imul(Pe,mt))+Math.imul(Fe,ct)|0,L=Math.imul(Fe,mt);var cr=(O+(C=C+Math.imul(ge,Et)|0)|0)+((8191&(k=(k=k+Math.imul(ge,Mt)|0)+Math.imul(De,Et)|0))<<13)|0;O=((L=L+Math.imul(De,Mt)|0)+(k>>>13)|0)+(cr>>>26)|0,cr&=67108863;var Dt=(O+(C=Math.imul(Pe,Et))|0)+((8191&(k=(k=Math.imul(Pe,Mt))+Math.imul(Fe,Et)|0))<<13)|0;return O=((L=Math.imul(Fe,Mt))+(k>>>13)|0)+(Dt>>>26)|0,Dt&=67108863,V[0]=_t,V[1]=xt,V[2]=At,V[3]=It,V[4]=Nt,V[5]=Ot,V[6]=Yt,V[7]=Pt,V[8]=Ne,V[9]=ut,V[10]=wt,V[11]=Bt,V[12]=Jt,V[13]=er,V[14]=or,V[15]=zt,V[16]=Qt,V[17]=cr,V[18]=Dt,O!==0&&(V[19]=O,S.length++),S};function g(b,_,S){return new d().mulp(b,_,S)}function d(b,_){this.x=b,this.y=_}Math.imul||(f=c),e.prototype.mulTo=function(b,_){var S=this.length+b.length;return this.length===10&&b.length===10?f(this,b,_):S<63?c(this,b,_):S<1024?function(C,k,L){L.negative=k.negative^C.negative,L.length=C.length+k.length;for(var I=0,R=0,V=0;V<L.length-1;V++){var O=R;R=0;for(var J=67108863&I,D=Math.min(V,k.length-1),B=Math.max(0,V-C.length+1);B<=D;B++){var N=V-B,F=(0|C.words[N])*(0|k.words[B]),H=67108863&F;J=67108863&(H=H+J|0),R+=(O=(O=O+(F/67108864|0)|0)+(H>>>26)|0)>>>26,O&=67108863}L.words[V]=J,I=O,O=R}return I!==0?L.words[V]=I:L.length--,L.strip()}(this,b,_):g(this,b,_)},d.prototype.makeRBT=function(b){for(var _=new Array(b),S=e.prototype._countBits(b)-1,C=0;C<b;C++)_[C]=this.revBin(C,S,b);return _},d.prototype.revBin=function(b,_,S){if(b===0||b===S-1)return b;for(var C=0,k=0;k<_;k++)C|=(1&b)<<_-k-1,b>>=1;return C},d.prototype.permute=function(b,_,S,C,k,L){for(var I=0;I<L;I++)C[I]=_[b[I]],k[I]=S[b[I]]},d.prototype.transform=function(b,_,S,C,k,L){this.permute(L,b,_,S,C,k);for(var I=1;I<k;I<<=1)for(var R=I<<1,V=Math.cos(2*Math.PI/R),O=Math.sin(2*Math.PI/R),J=0;J<k;J+=R)for(var D=V,B=O,N=0;N<I;N++){var F=S[J+N],H=C[J+N],j=S[J+N+I],G=C[J+N+I],W=D*j-B*G;G=D*G+B*j,j=W,S[J+N]=F+j,C[J+N]=H+G,S[J+N+I]=F-j,C[J+N+I]=H-G,N!==R&&(W=V*D-O*B,B=V*B+O*D,D=W)}},d.prototype.guessLen13b=function(b,_){var S=1|Math.max(_,b),C=1&S,k=0;for(S=S/2|0;S;S>>>=1)k++;return 1<<k+1+C},d.prototype.conjugate=function(b,_,S){if(!(S<=1))for(var C=0;C<S/2;C++){var k=b[C];b[C]=b[S-C-1],b[S-C-1]=k,k=_[C],_[C]=-_[S-C-1],_[S-C-1]=-k}},d.prototype.normalize13b=function(b,_){for(var S=0,C=0;C<_/2;C++){var k=8192*Math.round(b[2*C+1]/_)+Math.round(b[2*C]/_)+S;b[C]=67108863&k,S=k<67108864?0:k/67108864|0}return b},d.prototype.convert13b=function(b,_,S,C){for(var k=0,L=0;L<_;L++)k+=0|b[L],S[2*L]=8191&k,k>>>=13,S[2*L+1]=8191&k,k>>>=13;for(L=2*_;L<C;++L)S[L]=0;p(k===0),p((-8192&k)==0)},d.prototype.stub=function(b){for(var _=new Array(b),S=0;S<b;S++)_[S]=0;return _},d.prototype.mulp=function(b,_,S){var C=2*this.guessLen13b(b.length,_.length),k=this.makeRBT(C),L=this.stub(C),I=new Array(C),R=new Array(C),V=new Array(C),O=new Array(C),J=new Array(C),D=new Array(C),B=S.words;B.length=C,this.convert13b(b.words,b.length,I,C),this.convert13b(_.words,_.length,O,C),this.transform(I,L,R,V,C,k),this.transform(O,L,J,D,C,k);for(var N=0;N<C;N++){var F=R[N]*J[N]-V[N]*D[N];V[N]=R[N]*D[N]+V[N]*J[N],R[N]=F}return this.conjugate(R,V,C),this.transform(R,V,B,L,C,k),this.conjugate(B,L,C),this.normalize13b(B,C),S.negative=b.negative^_.negative,S.length=b.length+_.length,S.strip()},e.prototype.mul=function(b){var _=new e(null);return _.words=new Array(this.length+b.length),this.mulTo(b,_)},e.prototype.mulf=function(b){var _=new e(null);return _.words=new Array(this.length+b.length),g(this,b,_)},e.prototype.imul=function(b){return this.clone().mulTo(b,this)},e.prototype.imuln=function(b){p(typeof b=="number"),p(b<67108864);for(var _=0,S=0;S<this.length;S++){var C=(0|this.words[S])*b,k=(67108863&C)+(67108863&_);_>>=26,_+=C/67108864|0,_+=k>>>26,this.words[S]=67108863&k}return _!==0&&(this.words[S]=_,this.length++),this},e.prototype.muln=function(b){return this.clone().imuln(b)},e.prototype.sqr=function(){return this.mul(this)},e.prototype.isqr=function(){return this.imul(this.clone())},e.prototype.pow=function(b){var _=function(L){for(var I=new Array(L.bitLength()),R=0;R<I.length;R++){var V=R/26|0,O=R%26;I[R]=(L.words[V]&1<<O)>>>O}return I}(b);if(_.length===0)return new e(1);for(var S=this,C=0;C<_.length&&_[C]===0;C++,S=S.sqr());if(++C<_.length)for(var k=S.sqr();C<_.length;C++,k=k.sqr())_[C]!==0&&(S=S.mul(k));return S},e.prototype.iushln=function(b){p(typeof b=="number"&&b>=0);var _,S=b%26,C=(b-S)/26,k=67108863>>>26-S<<26-S;if(S!==0){var L=0;for(_=0;_<this.length;_++){var I=this.words[_]&k,R=(0|this.words[_])-I<<S;this.words[_]=R|L,L=I>>>26-S}L&&(this.words[_]=L,this.length++)}if(C!==0){for(_=this.length-1;_>=0;_--)this.words[_+C]=this.words[_];for(_=0;_<C;_++)this.words[_]=0;this.length+=C}return this.strip()},e.prototype.ishln=function(b){return p(this.negative===0),this.iushln(b)},e.prototype.iushrn=function(b,_,S){var C;p(typeof b=="number"&&b>=0),C=_?(_-_%26)/26:0;var k=b%26,L=Math.min((b-k)/26,this.length),I=67108863^67108863>>>k<<k,R=S;if(C-=L,C=Math.max(0,C),R){for(var V=0;V<L;V++)R.words[V]=this.words[V];R.length=L}if(L!==0)if(this.length>L)for(this.length-=L,V=0;V<this.length;V++)this.words[V]=this.words[V+L];else this.words[0]=0,this.length=1;var O=0;for(V=this.length-1;V>=0&&(O!==0||V>=C);V--){var J=0|this.words[V];this.words[V]=O<<26-k|J>>>k,O=J&I}return R&&O!==0&&(R.words[R.length++]=O),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},e.prototype.ishrn=function(b,_,S){return p(this.negative===0),this.iushrn(b,_,S)},e.prototype.shln=function(b){return this.clone().ishln(b)},e.prototype.ushln=function(b){return this.clone().iushln(b)},e.prototype.shrn=function(b){return this.clone().ishrn(b)},e.prototype.ushrn=function(b){return this.clone().iushrn(b)},e.prototype.testn=function(b){p(typeof b=="number"&&b>=0);var _=b%26,S=(b-_)/26,C=1<<_;return!(this.length<=S)&&!!(this.words[S]&C)},e.prototype.imaskn=function(b){p(typeof b=="number"&&b>=0);var _=b%26,S=(b-_)/26;if(p(this.negative===0,"imaskn works only with positive numbers"),this.length<=S)return this;if(_!==0&&S++,this.length=Math.min(S,this.length),_!==0){var C=67108863^67108863>>>_<<_;this.words[this.length-1]&=C}return this.strip()},e.prototype.maskn=function(b){return this.clone().imaskn(b)},e.prototype.iaddn=function(b){return p(typeof b=="number"),p(b<67108864),b<0?this.isubn(-b):this.negative!==0?this.length===1&&(0|this.words[0])<b?(this.words[0]=b-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(b),this.negative=1,this):this._iaddn(b)},e.prototype._iaddn=function(b){this.words[0]+=b;for(var _=0;_<this.length&&this.words[_]>=67108864;_++)this.words[_]-=67108864,_===this.length-1?this.words[_+1]=1:this.words[_+1]++;return this.length=Math.max(this.length,_+1),this},e.prototype.isubn=function(b){if(p(typeof b=="number"),p(b<67108864),b<0)return this.iaddn(-b);if(this.negative!==0)return this.negative=0,this.iaddn(b),this.negative=1,this;if(this.words[0]-=b,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var _=0;_<this.length&&this.words[_]<0;_++)this.words[_]+=67108864,this.words[_+1]-=1;return this.strip()},e.prototype.addn=function(b){return this.clone().iaddn(b)},e.prototype.subn=function(b){return this.clone().isubn(b)},e.prototype.iabs=function(){return this.negative=0,this},e.prototype.abs=function(){return this.clone().iabs()},e.prototype._ishlnsubmul=function(b,_,S){var C,k,L=b.length+S;this._expand(L);var I=0;for(C=0;C<b.length;C++){k=(0|this.words[C+S])+I;var R=(0|b.words[C])*_;I=((k-=67108863&R)>>26)-(R/67108864|0),this.words[C+S]=67108863&k}for(;C<this.length-S;C++)I=(k=(0|this.words[C+S])+I)>>26,this.words[C+S]=67108863&k;if(I===0)return this.strip();for(p(I===-1),I=0,C=0;C<this.length;C++)I=(k=-(0|this.words[C])+I)>>26,this.words[C]=67108863&k;return this.negative=1,this.strip()},e.prototype._wordDiv=function(b,_){var S=(this.length,b.length),C=this.clone(),k=b,L=0|k.words[k.length-1];(S=26-this._countBits(L))!==0&&(k=k.ushln(S),C.iushln(S),L=0|k.words[k.length-1]);var I,R=C.length-k.length;if(_!=="mod"){(I=new e(null)).length=R+1,I.words=new Array(I.length);for(var V=0;V<I.length;V++)I.words[V]=0}var O=C.clone()._ishlnsubmul(k,1,R);O.negative===0&&(C=O,I&&(I.words[R]=1));for(var J=R-1;J>=0;J--){var D=67108864*(0|C.words[k.length+J])+(0|C.words[k.length+J-1]);for(D=Math.min(D/L|0,67108863),C._ishlnsubmul(k,D,J);C.negative!==0;)D--,C.negative=0,C._ishlnsubmul(k,1,J),C.isZero()||(C.negative^=1);I&&(I.words[J]=D)}return I&&I.strip(),C.strip(),_!=="div"&&S!==0&&C.iushrn(S),{div:I||null,mod:C}},e.prototype.divmod=function(b,_,S){return p(!b.isZero()),this.isZero()?{div:new e(0),mod:new e(0)}:this.negative!==0&&b.negative===0?(L=this.neg().divmod(b,_),_!=="mod"&&(C=L.div.neg()),_!=="div"&&(k=L.mod.neg(),S&&k.negative!==0&&k.iadd(b)),{div:C,mod:k}):this.negative===0&&b.negative!==0?(L=this.divmod(b.neg(),_),_!=="mod"&&(C=L.div.neg()),{div:C,mod:L.mod}):this.negative&b.negative?(L=this.neg().divmod(b.neg(),_),_!=="div"&&(k=L.mod.neg(),S&&k.negative!==0&&k.isub(b)),{div:L.div,mod:k}):b.length>this.length||this.cmp(b)<0?{div:new e(0),mod:this}:b.length===1?_==="div"?{div:this.divn(b.words[0]),mod:null}:_==="mod"?{div:null,mod:new e(this.modn(b.words[0]))}:{div:this.divn(b.words[0]),mod:new e(this.modn(b.words[0]))}:this._wordDiv(b,_);var C,k,L},e.prototype.div=function(b){return this.divmod(b,"div",!1).div},e.prototype.mod=function(b){return this.divmod(b,"mod",!1).mod},e.prototype.umod=function(b){return this.divmod(b,"mod",!0).mod},e.prototype.divRound=function(b){var _=this.divmod(b);if(_.mod.isZero())return _.div;var S=_.div.negative!==0?_.mod.isub(b):_.mod,C=b.ushrn(1),k=b.andln(1),L=S.cmp(C);return L<0||k===1&&L===0?_.div:_.div.negative!==0?_.div.isubn(1):_.div.iaddn(1)},e.prototype.modn=function(b){p(b<=67108863);for(var _=(1<<26)%b,S=0,C=this.length-1;C>=0;C--)S=(_*S+(0|this.words[C]))%b;return S},e.prototype.idivn=function(b){p(b<=67108863);for(var _=0,S=this.length-1;S>=0;S--){var C=(0|this.words[S])+67108864*_;this.words[S]=C/b|0,_=C%b}return this.strip()},e.prototype.divn=function(b){return this.clone().idivn(b)},e.prototype.egcd=function(b){p(b.negative===0),p(!b.isZero());var _=this,S=b.clone();_=_.negative!==0?_.umod(b):_.clone();for(var C=new e(1),k=new e(0),L=new e(0),I=new e(1),R=0;_.isEven()&&S.isEven();)_.iushrn(1),S.iushrn(1),++R;for(var V=S.clone(),O=_.clone();!_.isZero();){for(var J=0,D=1;!(_.words[0]&D)&&J<26;++J,D<<=1);if(J>0)for(_.iushrn(J);J-- >0;)(C.isOdd()||k.isOdd())&&(C.iadd(V),k.isub(O)),C.iushrn(1),k.iushrn(1);for(var B=0,N=1;!(S.words[0]&N)&&B<26;++B,N<<=1);if(B>0)for(S.iushrn(B);B-- >0;)(L.isOdd()||I.isOdd())&&(L.iadd(V),I.isub(O)),L.iushrn(1),I.iushrn(1);_.cmp(S)>=0?(_.isub(S),C.isub(L),k.isub(I)):(S.isub(_),L.isub(C),I.isub(k))}return{a:L,b:I,gcd:S.iushln(R)}},e.prototype._invmp=function(b){p(b.negative===0),p(!b.isZero());var _=this,S=b.clone();_=_.negative!==0?_.umod(b):_.clone();for(var C,k=new e(1),L=new e(0),I=S.clone();_.cmpn(1)>0&&S.cmpn(1)>0;){for(var R=0,V=1;!(_.words[0]&V)&&R<26;++R,V<<=1);if(R>0)for(_.iushrn(R);R-- >0;)k.isOdd()&&k.iadd(I),k.iushrn(1);for(var O=0,J=1;!(S.words[0]&J)&&O<26;++O,J<<=1);if(O>0)for(S.iushrn(O);O-- >0;)L.isOdd()&&L.iadd(I),L.iushrn(1);_.cmp(S)>=0?(_.isub(S),k.isub(L)):(S.isub(_),L.isub(k))}return(C=_.cmpn(1)===0?k:L).cmpn(0)<0&&C.iadd(b),C},e.prototype.gcd=function(b){if(this.isZero())return b.abs();if(b.isZero())return this.abs();var _=this.clone(),S=b.clone();_.negative=0,S.negative=0;for(var C=0;_.isEven()&&S.isEven();C++)_.iushrn(1),S.iushrn(1);for(;;){for(;_.isEven();)_.iushrn(1);for(;S.isEven();)S.iushrn(1);var k=_.cmp(S);if(k<0){var L=_;_=S,S=L}else if(k===0||S.cmpn(1)===0)break;_.isub(S)}return S.iushln(C)},e.prototype.invm=function(b){return this.egcd(b).a.umod(b)},e.prototype.isEven=function(){return(1&this.words[0])==0},e.prototype.isOdd=function(){return(1&this.words[0])==1},e.prototype.andln=function(b){return this.words[0]&b},e.prototype.bincn=function(b){p(typeof b=="number");var _=b%26,S=(b-_)/26,C=1<<_;if(this.length<=S)return this._expand(S+1),this.words[S]|=C,this;for(var k=C,L=S;k!==0&&L<this.length;L++){var I=0|this.words[L];k=(I+=k)>>>26,I&=67108863,this.words[L]=I}return k!==0&&(this.words[L]=k,this.length++),this},e.prototype.isZero=function(){return this.length===1&&this.words[0]===0},e.prototype.cmpn=function(b){var _,S=b<0;if(this.negative!==0&&!S)return-1;if(this.negative===0&&S)return 1;if(this.strip(),this.length>1)_=1;else{S&&(b=-b),p(b<=67108863,"Number is too big");var C=0|this.words[0];_=C===b?0:C<b?-1:1}return this.negative!==0?0|-_:_},e.prototype.cmp=function(b){if(this.negative!==0&&b.negative===0)return-1;if(this.negative===0&&b.negative!==0)return 1;var _=this.ucmp(b);return this.negative!==0?0|-_:_},e.prototype.ucmp=function(b){if(this.length>b.length)return 1;if(this.length<b.length)return-1;for(var _=0,S=this.length-1;S>=0;S--){var C=0|this.words[S],k=0|b.words[S];if(C!==k){C<k?_=-1:C>k&&(_=1);break}}return _},e.prototype.gtn=function(b){return this.cmpn(b)===1},e.prototype.gt=function(b){return this.cmp(b)===1},e.prototype.gten=function(b){return this.cmpn(b)>=0},e.prototype.gte=function(b){return this.cmp(b)>=0},e.prototype.ltn=function(b){return this.cmpn(b)===-1},e.prototype.lt=function(b){return this.cmp(b)===-1},e.prototype.lten=function(b){return this.cmpn(b)<=0},e.prototype.lte=function(b){return this.cmp(b)<=0},e.prototype.eqn=function(b){return this.cmpn(b)===0},e.prototype.eq=function(b){return this.cmp(b)===0},e.red=function(b){return new E(b)},e.prototype.toRed=function(b){return p(!this.red,"Already a number in reduction context"),p(this.negative===0,"red works only with positives"),b.convertTo(this)._forceRed(b)},e.prototype.fromRed=function(){return p(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},e.prototype._forceRed=function(b){return this.red=b,this},e.prototype.forceRed=function(b){return p(!this.red,"Already a number in reduction context"),this._forceRed(b)},e.prototype.redAdd=function(b){return p(this.red,"redAdd works only with red numbers"),this.red.add(this,b)},e.prototype.redIAdd=function(b){return p(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,b)},e.prototype.redSub=function(b){return p(this.red,"redSub works only with red numbers"),this.red.sub(this,b)},e.prototype.redISub=function(b){return p(this.red,"redISub works only with red numbers"),this.red.isub(this,b)},e.prototype.redShl=function(b){return p(this.red,"redShl works only with red numbers"),this.red.shl(this,b)},e.prototype.redMul=function(b){return p(this.red,"redMul works only with red numbers"),this.red._verify2(this,b),this.red.mul(this,b)},e.prototype.redIMul=function(b){return p(this.red,"redMul works only with red numbers"),this.red._verify2(this,b),this.red.imul(this,b)},e.prototype.redSqr=function(){return p(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},e.prototype.redISqr=function(){return p(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},e.prototype.redSqrt=function(){return p(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},e.prototype.redInvm=function(){return p(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},e.prototype.redNeg=function(){return p(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},e.prototype.redPow=function(b){return p(this.red&&!b.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,b)};var m={k256:null,p224:null,p192:null,p25519:null};function y(b,_){this.name=b,this.p=new e(_,16),this.n=this.p.bitLength(),this.k=new e(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function v(){y.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function T(){y.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function w(){y.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function A(){y.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function E(b){if(typeof b=="string"){var _=e._prime(b);this.m=_.p,this.prime=_}else p(b.gtn(1),"modulus must be greater than 1"),this.m=b,this.prime=null}function M(b){E.call(this,b),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new e(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}y.prototype._tmp=function(){var b=new e(null);return b.words=new Array(Math.ceil(this.n/13)),b},y.prototype.ireduce=function(b){var _,S=b;do this.split(S,this.tmp),_=(S=(S=this.imulK(S)).iadd(this.tmp)).bitLength();while(_>this.n);var C=_<this.n?-1:S.ucmp(this.p);return C===0?(S.words[0]=0,S.length=1):C>0?S.isub(this.p):S.strip(),S},y.prototype.split=function(b,_){b.iushrn(this.n,0,_)},y.prototype.imulK=function(b){return b.imul(this.k)},l(v,y),v.prototype.split=function(b,_){for(var S=Math.min(b.length,9),C=0;C<S;C++)_.words[C]=b.words[C];if(_.length=S,b.length<=9)return b.words[0]=0,void(b.length=1);var k=b.words[9];for(_.words[_.length++]=4194303&k,C=10;C<b.length;C++){var L=0|b.words[C];b.words[C-10]=(4194303&L)<<4|k>>>22,k=L}k>>>=22,b.words[C-10]=k,k===0&&b.length>10?b.length-=10:b.length-=9},v.prototype.imulK=function(b){b.words[b.length]=0,b.words[b.length+1]=0,b.length+=2;for(var _=0,S=0;S<b.length;S++){var C=0|b.words[S];_+=977*C,b.words[S]=67108863&_,_=64*C+(_/67108864|0)}return b.words[b.length-1]===0&&(b.length--,b.words[b.length-1]===0&&b.length--),b},l(T,y),l(w,y),l(A,y),A.prototype.imulK=function(b){for(var _=0,S=0;S<b.length;S++){var C=19*(0|b.words[S])+_,k=67108863&C;C>>>=26,b.words[S]=k,_=C}return _!==0&&(b.words[b.length++]=_),b},e._prime=function(b){if(m[b])return m[b];var _;if(b==="k256")_=new v;else if(b==="p224")_=new T;else if(b==="p192")_=new w;else{if(b!=="p25519")throw new Error("Unknown prime "+b);_=new A}return m[b]=_,_},E.prototype._verify1=function(b){p(b.negative===0,"red works only with positives"),p(b.red,"red works only with red numbers")},E.prototype._verify2=function(b,_){p((b.negative|_.negative)==0,"red works only with positives"),p(b.red&&b.red===_.red,"red works only with red numbers")},E.prototype.imod=function(b){return this.prime?this.prime.ireduce(b)._forceRed(this):b.umod(this.m)._forceRed(this)},E.prototype.neg=function(b){return b.isZero()?b.clone():this.m.sub(b)._forceRed(this)},E.prototype.add=function(b,_){this._verify2(b,_);var S=b.add(_);return S.cmp(this.m)>=0&&S.isub(this.m),S._forceRed(this)},E.prototype.iadd=function(b,_){this._verify2(b,_);var S=b.iadd(_);return S.cmp(this.m)>=0&&S.isub(this.m),S},E.prototype.sub=function(b,_){this._verify2(b,_);var S=b.sub(_);return S.cmpn(0)<0&&S.iadd(this.m),S._forceRed(this)},E.prototype.isub=function(b,_){this._verify2(b,_);var S=b.isub(_);return S.cmpn(0)<0&&S.iadd(this.m),S},E.prototype.shl=function(b,_){return this._verify1(b),this.imod(b.ushln(_))},E.prototype.imul=function(b,_){return this._verify2(b,_),this.imod(b.imul(_))},E.prototype.mul=function(b,_){return this._verify2(b,_),this.imod(b.mul(_))},E.prototype.isqr=function(b){return this.imul(b,b.clone())},E.prototype.sqr=function(b){return this.mul(b,b)},E.prototype.sqrt=function(b){if(b.isZero())return b.clone();var _=this.m.andln(3);if(p(_%2==1),_===3){var S=this.m.add(new e(1)).iushrn(2);return this.pow(b,S)}for(var C=this.m.subn(1),k=0;!C.isZero()&&C.andln(1)===0;)k++,C.iushrn(1);p(!C.isZero());var L=new e(1).toRed(this),I=L.redNeg(),R=this.m.subn(1).iushrn(1),V=this.m.bitLength();for(V=new e(2*V*V).toRed(this);this.pow(V,R).cmp(I)!==0;)V.redIAdd(I);for(var O=this.pow(V,C),J=this.pow(b,C.addn(1).iushrn(1)),D=this.pow(b,C),B=k;D.cmp(L)!==0;){for(var N=D,F=0;N.cmp(L)!==0;F++)N=N.redSqr();p(F<B);var H=this.pow(O,new e(1).iushln(B-F-1));J=J.redMul(H),O=H.redSqr(),D=D.redMul(O),B=F}return J},E.prototype.invm=function(b){var _=b._invmp(this.m);return _.negative!==0?(_.negative=0,this.imod(_).redNeg()):this.imod(_)},E.prototype.pow=function(b,_){if(_.isZero())return new e(1).toRed(this);if(_.cmpn(1)===0)return b.clone();var S=new Array(16);S[0]=new e(1).toRed(this),S[1]=b;for(var C=2;C<S.length;C++)S[C]=this.mul(S[C-1],b);var k=S[0],L=0,I=0,R=_.bitLength()%26;for(R===0&&(R=26),C=_.length-1;C>=0;C--){for(var V=_.words[C],O=R-1;O>=0;O--){var J=V>>O&1;k!==S[0]&&(k=this.sqr(k)),J!==0||L!==0?(L<<=1,L|=J,(++I===4||C===0&&O===0)&&(k=this.mul(k,S[L]),I=0,L=0)):I=0}R=26}return k},E.prototype.convertTo=function(b){var _=b.umod(this.m);return _===b?_.clone():_},E.prototype.convertFrom=function(b){var _=b.clone();return _.red=null,_},e.mont=function(b){return new M(b)},l(M,E),M.prototype.convertTo=function(b){return this.imod(b.ushln(this.shift))},M.prototype.convertFrom=function(b){var _=this.imod(b.mul(this.rinv));return _.red=null,_},M.prototype.imul=function(b,_){if(b.isZero()||_.isZero())return b.words[0]=0,b.length=1,b;var S=b.imul(_),C=S.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),k=S.isub(C).iushrn(this.shift),L=k;return k.cmp(this.m)>=0?L=k.isub(this.m):k.cmpn(0)<0&&(L=k.iadd(this.m)),L._forceRed(this)},M.prototype.mul=function(b,_){if(b.isZero()||_.isZero())return new e(0)._forceRed(this);var S=b.mul(_),C=S.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),k=S.isub(C).iushrn(this.shift),L=k;return k.cmp(this.m)>=0?L=k.isub(this.m):k.cmpn(0)<0&&(L=k.iadd(this.m)),L._forceRed(this)},M.prototype.invm=function(b){return this.imod(b._invmp(this.m).mul(this.r2))._forceRed(this)}})(typeof z>"u"||z,this)},{buffer:108}],100:[function(n,z,q){"use strict";z.exports=function(t){var h,p,l,e=t.length,o=0;for(h=0;h<e;++h)o+=t[h].length;var r=new Array(o),i=0;for(h=0;h<e;++h){var u=t[h],s=u.length;for(p=0;p<s;++p){var a=r[i++]=new Array(s-1),c=0;for(l=0;l<s;++l)l!==p&&(a[c++]=u[l]);if(1&p){var f=a[1];a[1]=a[0],a[0]=f}}}return r}},{}],101:[function(n,z,q){"use strict";z.exports=function(a,c,f){switch(arguments.length){case 1:return u(a);case 2:return typeof c=="function"?r(a,a,c,!0):s(a,c);case 3:return r(a,c,f,!1);default:throw new Error("box-intersect: Invalid arguments")}};var t,h=n("typedarray-pool"),p=n("./lib/sweep"),l=n("./lib/intersect");function e(a,c){for(var f=0;f<a;++f)if(!(c[f]<=c[f+a]))return!0;return!1}function o(a,c,f,g){for(var d=0,m=0,y=0,v=a.length;y<v;++y){var T=a[y];if(!e(c,T)){for(var w=0;w<2*c;++w)f[d++]=T[w];g[m++]=y}}return m}function r(a,c,f,g){var d=a.length,m=c.length;if(!(d<=0||m<=0)){var y=a[0].length>>>1;if(!(y<=0)){var v,T=h.mallocDouble(2*y*d),w=h.mallocInt32(d);if((d=o(a,y,T,w))>0){if(y===1&&g)p.init(d),v=p.sweepComplete(y,f,0,d,T,w,0,d,T,w);else{var A=h.mallocDouble(2*y*m),E=h.mallocInt32(m);(m=o(c,y,A,E))>0&&(p.init(d+m),v=y===1?p.sweepBipartite(y,f,0,d,T,w,0,m,A,E):l(y,f,g,d,T,w,m,A,E),h.free(A),h.free(E))}h.free(T),h.free(w)}return v}}}function i(a,c){t.push([a,c])}function u(a){return t=[],r(a,a,i,!0),t}function s(a,c){return t=[],r(a,c,i,!1),t}},{"./lib/intersect":103,"./lib/sweep":107,"typedarray-pool":595}],102:[function(n,z,q){"use strict";var t=["d","ax","vv","rs","re","rb","ri","bs","be","bb","bi"];function h(p){var l="bruteForce"+(p?"Full":"Partial"),e=[],o=t.slice();p||o.splice(3,0,"fp");var r=["function "+l+"("+o.join()+"){"];function i(s,a){var c=function(f,g,d){var m="bruteForce"+(f?"Red":"Blue")+(g?"Flip":"")+(d?"Full":""),y=["function ",m,"(",t.join(),"){","var ","es","=2*","d",";"],v="for(var i=rs,rp=es*rs;i<re;++i,rp+=es){var x0=rb[ax+rp],x1=rb[ax+rp+d],xi=ri[i];",T="for(var j=bs,bp=es*bs;j<be;++j,bp+=es){var y0=bb[ax+bp],"+(d?"y1=bb[ax+bp+d],":"")+"yi=bi[j];";return f?y.push(v,"Q",":",T):y.push(T,"Q",":",v),d?y.push("if(y1<x0||x1<y0)continue;"):g?y.push("if(y0<=x0||x1<y0)continue;"):y.push("if(y0<x0||x1<y0)continue;"),y.push("for(var k=ax+1;k<d;++k){var r0=rb[k+rp],r1=rb[k+d+rp],b0=bb[k+bp],b1=bb[k+d+bp];if(r1<b0||b1<r0)continue Q;}var rv=vv("),g?y.push("yi,xi"):y.push("xi,yi"),y.push(");if(rv!==void 0)return rv;}}}"),{name:m,code:y.join("")}}(s,a,p);e.push(c.code),r.push("return "+c.name+"("+t.join()+");")}r.push("if(re-rs>be-bs){"),p?(i(!0,!1),r.push("}else{"),i(!1,!1)):(r.push("if(fp){"),i(!0,!0),r.push("}else{"),i(!0,!1),r.push("}}else{if(fp){"),i(!1,!0),r.push("}else{"),i(!1,!1),r.push("}")),r.push("}}return "+l);var u=e.join("")+r.join("");return new Function(u)()}q.partial=h(!1),q.full=h(!0)},{}],103:[function(n,z,q){"use strict";z.exports=function(w,A,E,M,b,_,S,C,k){(function(ke,Me){var ve=8*h.log2(Me+1)*(ke+1)|0,ge=h.nextPow2(6*ve);d.length<ge&&(t.free(d),d=t.mallocInt32(ge));var De=h.nextPow2(2*ve);m.length<De&&(t.free(m),m=t.mallocDouble(De))})(w,M+S);var L,I=0,R=2*w;for(y(I++,0,0,M,0,S,E?16:0,-1/0,1/0),E||y(I++,0,0,S,0,M,1,-1/0,1/0);I>0;){var V=6*(I-=1),O=d[V],J=d[V+1],D=d[V+2],B=d[V+3],N=d[V+4],F=d[V+5],H=2*I,j=m[H],G=m[H+1],W=1&F,Q=!!(16&F),$=b,ee=_,ie=C,ae=k;if(W&&($=C,ee=k,ie=b,ae=_),!(2&F&&(D=a(w,O,J,D,$,ee,G),J>=D)||4&F&&(J=c(w,O,J,D,$,ee,j))>=D)){var oe=D-J,de=N-B;if(Q){if(w*oe*(oe+de)<1<<22){if((L=o.scanComplete(w,O,A,J,D,$,ee,B,N,ie,ae))!==void 0)return L;continue}}else{if(w*Math.min(oe,de)<128){if((L=l(w,O,A,W,J,D,$,ee,B,N,ie,ae))!==void 0)return L;continue}if(w*oe*de<1<<22){if((L=o.scanBipartite(w,O,A,W,J,D,$,ee,B,N,ie,ae))!==void 0)return L;continue}}var le=u(w,O,J,D,$,ee,j,G);if(J<le)if(w*(le-J)<128){if((L=e(w,O+1,A,J,le,$,ee,B,N,ie,ae))!==void 0)return L}else if(O===w-2){if((L=W?o.sweepBipartite(w,A,B,N,ie,ae,J,le,$,ee):o.sweepBipartite(w,A,J,le,$,ee,B,N,ie,ae))!==void 0)return L}else y(I++,O+1,J,le,B,N,W,-1/0,1/0),y(I++,O+1,B,N,J,le,1^W,-1/0,1/0);if(le<D){var fe=r(w,O,B,N,ie,ae),ue=ie[R*fe+O],we=s(w,O,fe,N,ie,ae,ue);if(we<N&&y(I++,O,le,D,we,N,(4|W)+(Q?16:0),ue,G),B<fe&&y(I++,O,le,D,B,fe,(2|W)+(Q?16:0),j,ue),fe+1===we){if((L=Q?T(w,O,A,le,D,$,ee,fe,ie,ae[fe]):v(w,O,A,W,le,D,$,ee,fe,ie,ae[fe]))!==void 0)return L}else if(fe<we){var Ae;if(Q){if(Ae=f(w,O,le,D,$,ee,ue),le<Ae){var Se=s(w,O,le,Ae,$,ee,ue);if(O===w-2){if(le<Se&&(L=o.sweepComplete(w,A,le,Se,$,ee,fe,we,ie,ae))!==void 0||Se<Ae&&(L=o.sweepBipartite(w,A,Se,Ae,$,ee,fe,we,ie,ae))!==void 0)return L}else le<Se&&y(I++,O+1,le,Se,fe,we,16,-1/0,1/0),Se<Ae&&(y(I++,O+1,Se,Ae,fe,we,0,-1/0,1/0),y(I++,O+1,fe,we,Se,Ae,1,-1/0,1/0))}}else Ae=W?g(w,O,le,D,$,ee,ue):f(w,O,le,D,$,ee,ue),le<Ae&&(O===w-2?L=W?o.sweepBipartite(w,A,fe,we,ie,ae,le,Ae,$,ee):o.sweepBipartite(w,A,le,Ae,$,ee,fe,we,ie,ae):(y(I++,O+1,le,Ae,fe,we,W,-1/0,1/0),y(I++,O+1,fe,we,le,Ae,1^W,-1/0,1/0)))}}}}};var t=n("typedarray-pool"),h=n("bit-twiddle"),p=n("./brute"),l=p.partial,e=p.full,o=n("./sweep"),r=n("./median"),i=n("./partition"),u=i("!(lo>=p0)&&!(p1>=hi)",["p0","p1"]),s=i("lo===p0",["p0"]),a=i("lo<p0",["p0"]),c=i("hi<=p0",["p0"]),f=i("lo<=p0&&p0<=hi",["p0"]),g=i("lo<p0&&p0<=hi",["p0"]),d=t.mallocInt32(1024),m=t.mallocDouble(1024);function y(w,A,E,M,b,_,S,C,k){var L=6*w;d[L]=A,d[L+1]=E,d[L+2]=M,d[L+3]=b,d[L+4]=_,d[L+5]=S;var I=2*w;m[I]=C,m[I+1]=k}function v(w,A,E,M,b,_,S,C,k,L,I){var R=2*w,V=k*R,O=L[V+A];e:for(var J=b,D=b*R;J<_;++J,D+=R){var B=S[D+A],N=S[D+A+w];if(!(O<B||N<O)&&(!M||O!==B)){for(var F,H=C[J],j=A+1;j<w;++j){B=S[D+j],N=S[D+j+w];var G=L[V+j],W=L[V+j+w];if(N<G||W<B)continue e}if((F=M?E(I,H):E(H,I))!==void 0)return F}}}function T(w,A,E,M,b,_,S,C,k,L){var I=2*w,R=C*I,V=k[R+A];e:for(var O=M,J=M*I;O<b;++O,J+=I){var D=S[O];if(D!==L){var B=_[J+A],N=_[J+A+w];if(!(V<B||N<V)){for(var F=A+1;F<w;++F){B=_[J+F],N=_[J+F+w];var H=k[R+F],j=k[R+F+w];if(N<H||j<B)continue e}var G=E(D,L);if(G!==void 0)return G}}}}},{"./brute":102,"./median":104,"./partition":105,"./sweep":107,"bit-twiddle":97,"typedarray-pool":595}],104:[function(n,z,q){"use strict";z.exports=function(p,l,e,o,r,i){if(o<=e+1)return e;for(var u=e,s=o,a=o+e>>>1,c=2*p,f=a,g=r[c*a+l];u<s;){if(s-u<8){h(p,l,u,s,r,i),g=r[c*a+l];break}var d=s-u,m=Math.random()*d+u|0,y=r[c*m+l],v=Math.random()*d+u|0,T=r[c*v+l],w=Math.random()*d+u|0,A=r[c*w+l];y<=T?A>=T?(f=v,g=T):y>=A?(f=m,g=y):(f=w,g=A):T>=A?(f=v,g=T):A>=y?(f=m,g=y):(f=w,g=A);for(var E=c*(s-1),M=c*f,b=0;b<c;++b,++E,++M){var _=r[E];r[E]=r[M],r[M]=_}var S=i[s-1];for(i[s-1]=i[f],i[f]=S,f=t(p,l,u,s-1,r,i,g),E=c*(s-1),M=c*f,b=0;b<c;++b,++E,++M)_=r[E],r[E]=r[M],r[M]=_;if(S=i[s-1],i[s-1]=i[f],i[f]=S,a<f){for(s=f-1;u<s&&r[c*(s-1)+l]===g;)s-=1;s+=1}else{if(!(f<a))break;for(u=f+1;u<s&&r[c*u+l]===g;)u+=1}}return t(p,l,e,a,r,i,r[c*a+l])};var t=n("./partition")("lo<p0",["p0"]);function h(p,l,e,o,r,i){for(var u=2*p,s=u*(e+1)+l,a=e+1;a<o;++a,s+=u)for(var c=r[s],f=a,g=u*(a-1);f>e&&r[g+l]>c;--f,g-=u){for(var d=g,m=g+u,y=0;y<u;++y,++d,++m){var v=r[d];r[d]=r[m],r[m]=v}var T=i[f];i[f]=i[f-1],i[f-1]=T}}},{"./partition":105}],105:[function(n,z,q){"use strict";z.exports=function(t,h){var p="abcdef".split("").concat(h),l=[];return t.indexOf("lo")>=0&&l.push("lo=e[k+n]"),t.indexOf("hi")>=0&&l.push("hi=e[k+o]"),p.push("for(var j=2*a,k=j*c,l=k,m=c,n=b,o=a+b,p=c;d>p;++p,k+=j){var _;if($)if(m===p)m+=1,l+=j;else{for(var s=0;j>s;++s){var t=e[k+s];e[k+s]=e[l],e[l++]=t}var u=f[p];f[p]=f[m],f[m++]=u}}return m".replace("_",l.join()).replace("$",t)),Function.apply(void 0,p)}},{}],106:[function(n,z,q){"use strict";z.exports=function(i,u){u<=128?t(0,u-1,i):function s(a,c,f){var g=(c-a+1)/6|0,d=a+g,m=c-g,y=a+c>>1,v=y-g,T=y+g,w=d,A=v,E=y,M=T,b=m,_=a+1,S=c-1,C=0;o(w,A,f)&&(C=w,w=A,A=C),o(M,b,f)&&(C=M,M=b,b=C),o(w,E,f)&&(C=w,w=E,E=C),o(A,E,f)&&(C=A,A=E,E=C),o(w,M,f)&&(C=w,w=M,M=C),o(E,M,f)&&(C=E,E=M,M=C),o(A,b,f)&&(C=A,A=b,b=C),o(A,E,f)&&(C=A,A=E,E=C),o(M,b,f)&&(C=M,M=b,b=C);for(var k=f[2*A],L=f[2*A+1],I=f[2*M],R=f[2*M+1],V=2*w,O=2*E,J=2*b,D=2*d,B=2*y,N=2*m,F=0;F<2;++F){var H=f[V+F],j=f[O+F],G=f[J+F];f[D+F]=H,f[B+F]=j,f[N+F]=G}p(v,a,f),p(T,c,f);for(var W=_;W<=S;++W)if(r(W,k,L,f))W!==_&&h(W,_,f),++_;else if(!r(W,I,R,f))for(;;){if(r(S,I,R,f)){r(S,k,L,f)?(l(W,_,S,f),++_,--S):(h(W,S,f),--S);break}if(--S<W)break}e(a,_-1,k,L,f),e(c,S+1,I,R,f),_-2-a<=32?t(a,_-2,f):s(a,_-2,f),c-(S+2)<=32?t(S+2,c,f):s(S+2,c,f),S-_<=32?t(_,S,f):s(_,S,f)}(0,u-1,i)};function t(i,u,s){for(var a=2*(i+1),c=i+1;c<=u;++c){for(var f=s[a++],g=s[a++],d=c,m=a-2;d-- >i;){var y=s[m-2],v=s[m-1];if(y<f||y===f&&v<g)break;s[m]=y,s[m+1]=v,m-=2}s[m]=f,s[m+1]=g}}function h(i,u,s){u*=2;var a=s[i*=2],c=s[i+1];s[i]=s[u],s[i+1]=s[u+1],s[u]=a,s[u+1]=c}function p(i,u,s){u*=2,s[i*=2]=s[u],s[i+1]=s[u+1]}function l(i,u,s,a){u*=2,s*=2;var c=a[i*=2],f=a[i+1];a[i]=a[u],a[i+1]=a[u+1],a[u]=a[s],a[u+1]=a[s+1],a[s]=c,a[s+1]=f}function e(i,u,s,a,c){u*=2,c[i*=2]=c[u],c[u]=s,c[i+1]=c[u+1],c[u+1]=a}function o(i,u,s){u*=2;var a=s[i*=2],c=s[u];return!(a<c)&&(a!==c||s[i+1]>s[u+1])}function r(i,u,s,a){var c=a[i*=2];return c<u||c===u&&a[i+1]<s}},{}],107:[function(n,z,q){"use strict";z.exports={init:function(f){var g=h.nextPow2(f);l.length<g&&(t.free(l),l=t.mallocInt32(g)),e.length<g&&(t.free(e),e=t.mallocInt32(g)),o.length<g&&(t.free(o),o=t.mallocInt32(g)),r.length<g&&(t.free(r),r=t.mallocInt32(g)),i.length<g&&(t.free(i),i=t.mallocInt32(g)),u.length<g&&(t.free(u),u=t.mallocInt32(g));var d=8*g;s.length<d&&(t.free(s),s=t.mallocDouble(d))},sweepBipartite:function(f,g,d,m,y,v,T,w,A,E){for(var M=0,b=2*f,_=f-1,S=b-1,C=d;C<m;++C){var k=v[C],L=b*C;s[M++]=y[L+_],s[M++]=-(k+1),s[M++]=y[L+S],s[M++]=k}for(C=T;C<w;++C){k=E[C]+(1<<28);var I=b*C;s[M++]=A[I+_],s[M++]=-k,s[M++]=A[I+S],s[M++]=k}var R=M>>>1;p(s,R);var V=0,O=0;for(C=0;C<R;++C){var J=0|s[2*C+1];if(J>=1<<28)a(o,r,O--,J=J-(1<<28)|0);else if(J>=0)a(l,e,V--,J);else if(J<=-(1<<28)){J=-J-(1<<28)|0;for(var D=0;D<V;++D)if((B=g(l[D],J))!==void 0)return B;c(o,r,O++,J)}else{for(J=-J-1|0,D=0;D<O;++D){var B;if((B=g(J,o[D]))!==void 0)return B}c(l,e,V++,J)}}},sweepComplete:function(f,g,d,m,y,v,T,w,A,E){for(var M=0,b=2*f,_=f-1,S=b-1,C=d;C<m;++C){var k=v[C]+1<<1,L=b*C;s[M++]=y[L+_],s[M++]=-k,s[M++]=y[L+S],s[M++]=k}for(C=T;C<w;++C){k=E[C]+1<<1;var I=b*C;s[M++]=A[I+_],s[M++]=1|-k,s[M++]=A[I+S],s[M++]=1|k}var R=M>>>1;p(s,R);var V=0,O=0,J=0;for(C=0;C<R;++C){var D=0|s[2*C+1],B=1&D;if(C<R-1&&D>>1==s[2*C+3]>>1&&(B=2,C+=1),D<0){for(var N=-(D>>1)-1,F=0;F<J;++F)if((H=g(i[F],N))!==void 0)return H;if(B!==0){for(F=0;F<V;++F)if((H=g(l[F],N))!==void 0)return H}if(B!==1)for(F=0;F<O;++F){var H;if((H=g(o[F],N))!==void 0)return H}B===0?c(l,e,V++,N):B===1?c(o,r,O++,N):B===2&&c(i,u,J++,N)}else N=(D>>1)-1,B===0?a(l,e,V--,N):B===1?a(o,r,O--,N):B===2&&a(i,u,J--,N)}},scanBipartite:function(f,g,d,m,y,v,T,w,A,E,M,b){var _=0,S=2*f,C=g,k=g+f,L=1,I=1;m?I=1<<28:L=1<<28;for(var R=y;R<v;++R){var V=R+L,O=S*R;s[_++]=T[O+C],s[_++]=-V,s[_++]=T[O+k],s[_++]=V}for(R=A;R<E;++R){V=R+I;var J=S*R;s[_++]=M[J+C],s[_++]=-V}var D=_>>>1;p(s,D);var B=0;for(R=0;R<D;++R){var N=0|s[2*R+1];if(N<0){var F=!1;if((V=-N)>=1<<28?(F=!m,V-=1<<28):(F=!!m,V-=1),F)c(l,e,B++,V);else{var H=b[V],j=S*V,G=M[j+g+1],W=M[j+g+1+f];e:for(var Q=0;Q<B;++Q){var $=l[Q],ee=S*$;if(!(W<T[ee+g+1]||T[ee+g+1+f]<G)){for(var ie=g+2;ie<f;++ie)if(M[j+ie+f]<T[ee+ie]||T[ee+ie+f]<M[j+ie])continue e;var ae,oe=w[$];if((ae=m?d(H,oe):d(oe,H))!==void 0)return ae}}}}else a(l,e,B--,N-L)}},scanComplete:function(f,g,d,m,y,v,T,w,A,E,M){for(var b=0,_=2*f,S=g,C=g+f,k=m;k<y;++k){var L=k+268435456,I=_*k;s[b++]=v[I+S],s[b++]=-L,s[b++]=v[I+C],s[b++]=L}for(k=w;k<A;++k){L=k+1;var R=_*k;s[b++]=E[R+S],s[b++]=-L}var V=b>>>1;p(s,V);var O=0;for(k=0;k<V;++k){var J=0|s[2*k+1];if(J<0)if((L=-J)>=1<<28)l[O++]=L-(1<<28);else{var D=M[L-=1],B=_*L,N=E[B+g+1],F=E[B+g+1+f];e:for(var H=0;H<O;++H){var j=l[H],G=T[j];if(G===D)break;var W=_*j;if(!(F<v[W+g+1]||v[W+g+1+f]<N)){for(var Q=g+2;Q<f;++Q)if(E[B+Q+f]<v[W+Q]||v[W+Q+f]<E[B+Q])continue e;var $=d(G,D);if($!==void 0)return $}}}else{for(L=J-(1<<28),H=O-1;H>=0;--H)if(l[H]===L){for(Q=H+1;Q<O;++Q)l[Q-1]=l[Q];break}--O}}}};var t=n("typedarray-pool"),h=n("bit-twiddle"),p=n("./sort"),l=t.mallocInt32(1024),e=t.mallocInt32(1024),o=t.mallocInt32(1024),r=t.mallocInt32(1024),i=t.mallocInt32(1024),u=t.mallocInt32(1024),s=t.mallocDouble(8192);function a(f,g,d,m){var y=g[m],v=f[d-1];f[y]=v,g[v]=y}function c(f,g,d,m){f[d]=m,g[m]=d}},{"./sort":106,"bit-twiddle":97,"typedarray-pool":595}],108:[function(n,z,q){},{}],109:[function(n,z,q){arguments[4][108][0].apply(q,arguments)},{dup:108}],110:[function(n,z,q){"use strict";var t,h=typeof Reflect=="object"?Reflect:null,p=h&&typeof h.apply=="function"?h.apply:function(d,m,y){return Function.prototype.apply.call(d,m,y)};t=h&&typeof h.ownKeys=="function"?h.ownKeys:Object.getOwnPropertySymbols?function(d){return Object.getOwnPropertyNames(d).concat(Object.getOwnPropertySymbols(d))}:function(d){return Object.getOwnPropertyNames(d)};var l=Number.isNaN||function(d){return d!=d};function e(){e.init.call(this)}z.exports=e,z.exports.once=function(d,m){return new Promise(function(y,v){function T(){w!==void 0&&d.removeListener("error",w),y([].slice.call(arguments))}var w;m!=="error"&&(w=function(A){d.removeListener(m,T),v(A)},d.once("error",w)),d.once(m,T)})},e.EventEmitter=e,e.prototype._events=void 0,e.prototype._eventsCount=0,e.prototype._maxListeners=void 0;var o=10;function r(d){if(typeof d!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof d)}function i(d){return d._maxListeners===void 0?e.defaultMaxListeners:d._maxListeners}function u(d,m,y,v){var T,w,A,E;if(r(y),(w=d._events)===void 0?(w=d._events=Object.create(null),d._eventsCount=0):(w.newListener!==void 0&&(d.emit("newListener",m,y.listener?y.listener:y),w=d._events),A=w[m]),A===void 0)A=w[m]=y,++d._eventsCount;else if(typeof A=="function"?A=w[m]=v?[y,A]:[A,y]:v?A.unshift(y):A.push(y),(T=i(d))>0&&A.length>T&&!A.warned){A.warned=!0;var M=new Error("Possible EventEmitter memory leak detected. "+A.length+" "+String(m)+" listeners added. Use emitter.setMaxListeners() to increase limit");M.name="MaxListenersExceededWarning",M.emitter=d,M.type=m,M.count=A.length,E=M,console&&console.warn&&console.warn(E)}return d}function s(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function a(d,m,y){var v={fired:!1,wrapFn:void 0,target:d,type:m,listener:y},T=s.bind(v);return T.listener=y,v.wrapFn=T,T}function c(d,m,y){var v=d._events;if(v===void 0)return[];var T=v[m];return T===void 0?[]:typeof T=="function"?y?[T.listener||T]:[T]:y?function(w){for(var A=new Array(w.length),E=0;E<A.length;++E)A[E]=w[E].listener||w[E];return A}(T):g(T,T.length)}function f(d){var m=this._events;if(m!==void 0){var y=m[d];if(typeof y=="function")return 1;if(y!==void 0)return y.length}return 0}function g(d,m){for(var y=new Array(m),v=0;v<m;++v)y[v]=d[v];return y}Object.defineProperty(e,"defaultMaxListeners",{enumerable:!0,get:function(){return o},set:function(d){if(typeof d!="number"||d<0||l(d))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+d+".");o=d}}),e.init=function(){this._events!==void 0&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},e.prototype.setMaxListeners=function(d){if(typeof d!="number"||d<0||l(d))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+d+".");return this._maxListeners=d,this},e.prototype.getMaxListeners=function(){return i(this)},e.prototype.emit=function(d){for(var m=[],y=1;y<arguments.length;y++)m.push(arguments[y]);var v=d==="error",T=this._events;if(T!==void 0)v=v&&T.error===void 0;else if(!v)return!1;if(v){var w;if(m.length>0&&(w=m[0]),w instanceof Error)throw w;var A=new Error("Unhandled error."+(w?" ("+w.message+")":""));throw A.context=w,A}var E=T[d];if(E===void 0)return!1;if(typeof E=="function")p(E,this,m);else{var M=E.length,b=g(E,M);for(y=0;y<M;++y)p(b[y],this,m)}return!0},e.prototype.addListener=function(d,m){return u(this,d,m,!1)},e.prototype.on=e.prototype.addListener,e.prototype.prependListener=function(d,m){return u(this,d,m,!0)},e.prototype.once=function(d,m){return r(m),this.on(d,a(this,d,m)),this},e.prototype.prependOnceListener=function(d,m){return r(m),this.prependListener(d,a(this,d,m)),this},e.prototype.removeListener=function(d,m){var y,v,T,w,A;if(r(m),(v=this._events)===void 0)return this;if((y=v[d])===void 0)return this;if(y===m||y.listener===m)--this._eventsCount==0?this._events=Object.create(null):(delete v[d],v.removeListener&&this.emit("removeListener",d,y.listener||m));else if(typeof y!="function"){for(T=-1,w=y.length-1;w>=0;w--)if(y[w]===m||y[w].listener===m){A=y[w].listener,T=w;break}if(T<0)return this;T===0?y.shift():function(E,M){for(;M+1<E.length;M++)E[M]=E[M+1];E.pop()}(y,T),y.length===1&&(v[d]=y[0]),v.removeListener!==void 0&&this.emit("removeListener",d,A||m)}return this},e.prototype.off=e.prototype.removeListener,e.prototype.removeAllListeners=function(d){var m,y,v;if((y=this._events)===void 0)return this;if(y.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):y[d]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete y[d]),this;if(arguments.length===0){var T,w=Object.keys(y);for(v=0;v<w.length;++v)(T=w[v])!=="removeListener"&&this.removeAllListeners(T);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(typeof(m=y[d])=="function")this.removeListener(d,m);else if(m!==void 0)for(v=m.length-1;v>=0;v--)this.removeListener(d,m[v]);return this},e.prototype.listeners=function(d){return c(this,d,!0)},e.prototype.rawListeners=function(d){return c(this,d,!1)},e.listenerCount=function(d,m){return typeof d.listenerCount=="function"?d.listenerCount(m):f.call(d,m)},e.prototype.listenerCount=f,e.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},{}],111:[function(n,z,q){(function(t){(function(){"use strict";var h=n("base64-js"),p=n("ieee754");q.Buffer=e,q.SlowBuffer=function(j){return+j!=j&&(j=0),e.alloc(+j)},q.INSPECT_MAX_BYTES=50;function l(j){if(j>2147483647)throw new RangeError('The value "'+j+'" is invalid for option "size"');var G=new Uint8Array(j);return G.__proto__=e.prototype,G}function e(j,G,W){if(typeof j=="number"){if(typeof G=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return i(j)}return o(j,G,W)}function o(j,G,W){if(typeof j=="string")return function(ee,ie){if(typeof ie=="string"&&ie!==""||(ie="utf8"),!e.isEncoding(ie))throw new TypeError("Unknown encoding: "+ie);var ae=0|a(ee,ie),oe=l(ae),de=oe.write(ee,ie);return de!==ae&&(oe=oe.slice(0,de)),oe}(j,G);if(ArrayBuffer.isView(j))return u(j);if(j==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof j);if(F(j,ArrayBuffer)||j&&F(j.buffer,ArrayBuffer))return function(ee,ie,ae){if(ie<0||ee.byteLength<ie)throw new RangeError('"offset" is outside of buffer bounds');if(ee.byteLength<ie+(ae||0))throw new RangeError('"length" is outside of buffer bounds');var oe;return oe=ie===void 0&&ae===void 0?new Uint8Array(ee):ae===void 0?new Uint8Array(ee,ie):new Uint8Array(ee,ie,ae),oe.__proto__=e.prototype,oe}(j,G,W);if(typeof j=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var Q=j.valueOf&&j.valueOf();if(Q!=null&&Q!==j)return e.from(Q,G,W);var $=function(ee){if(e.isBuffer(ee)){var ie=0|s(ee.length),ae=l(ie);return ae.length===0||ee.copy(ae,0,0,ie),ae}if(ee.length!==void 0)return typeof ee.length!="number"||H(ee.length)?l(0):u(ee);if(ee.type==="Buffer"&&Array.isArray(ee.data))return u(ee.data)}(j);if($)return $;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof j[Symbol.toPrimitive]=="function")return e.from(j[Symbol.toPrimitive]("string"),G,W);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof j)}function r(j){if(typeof j!="number")throw new TypeError('"size" argument must be of type number');if(j<0)throw new RangeError('The value "'+j+'" is invalid for option "size"')}function i(j){return r(j),l(j<0?0:0|s(j))}function u(j){for(var G=j.length<0?0:0|s(j.length),W=l(G),Q=0;Q<G;Q+=1)W[Q]=255&j[Q];return W}function s(j){if(j>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+2147483647 .toString(16)+" bytes");return 0|j}function a(j,G){if(e.isBuffer(j))return j.length;if(ArrayBuffer.isView(j)||F(j,ArrayBuffer))return j.byteLength;if(typeof j!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof j);var W=j.length,Q=arguments.length>2&&arguments[2]===!0;if(!Q&&W===0)return 0;for(var $=!1;;)switch(G){case"ascii":case"latin1":case"binary":return W;case"utf8":case"utf-8":return D(j).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*W;case"hex":return W>>>1;case"base64":return B(j).length;default:if($)return Q?-1:D(j).length;G=(""+G).toLowerCase(),$=!0}}function c(j,G,W){var Q=!1;if((G===void 0||G<0)&&(G=0),G>this.length||((W===void 0||W>this.length)&&(W=this.length),W<=0)||(W>>>=0)<=(G>>>=0))return"";for(j||(j="utf8");;)switch(j){case"hex":return S(this,G,W);case"utf8":case"utf-8":return M(this,G,W);case"ascii":return b(this,G,W);case"latin1":case"binary":return _(this,G,W);case"base64":return E(this,G,W);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,G,W);default:if(Q)throw new TypeError("Unknown encoding: "+j);j=(j+"").toLowerCase(),Q=!0}}function f(j,G,W){var Q=j[G];j[G]=j[W],j[W]=Q}function g(j,G,W,Q,$){if(j.length===0)return-1;if(typeof W=="string"?(Q=W,W=0):W>2147483647?W=2147483647:W<-2147483648&&(W=-2147483648),H(W=+W)&&(W=$?0:j.length-1),W<0&&(W=j.length+W),W>=j.length){if($)return-1;W=j.length-1}else if(W<0){if(!$)return-1;W=0}if(typeof G=="string"&&(G=e.from(G,Q)),e.isBuffer(G))return G.length===0?-1:d(j,G,W,Q,$);if(typeof G=="number")return G&=255,typeof Uint8Array.prototype.indexOf=="function"?$?Uint8Array.prototype.indexOf.call(j,G,W):Uint8Array.prototype.lastIndexOf.call(j,G,W):d(j,[G],W,Q,$);throw new TypeError("val must be string, number or Buffer")}function d(j,G,W,Q,$){var ee,ie=1,ae=j.length,oe=G.length;if(Q!==void 0&&((Q=String(Q).toLowerCase())==="ucs2"||Q==="ucs-2"||Q==="utf16le"||Q==="utf-16le")){if(j.length<2||G.length<2)return-1;ie=2,ae/=2,oe/=2,W/=2}function de(we,Ae){return ie===1?we[Ae]:we.readUInt16BE(Ae*ie)}if($){var le=-1;for(ee=W;ee<ae;ee++)if(de(j,ee)===de(G,le===-1?0:ee-le)){if(le===-1&&(le=ee),ee-le+1===oe)return le*ie}else le!==-1&&(ee-=ee-le),le=-1}else for(W+oe>ae&&(W=ae-oe),ee=W;ee>=0;ee--){for(var fe=!0,ue=0;ue<oe;ue++)if(de(j,ee+ue)!==de(G,ue)){fe=!1;break}if(fe)return ee}return-1}function m(j,G,W,Q){W=Number(W)||0;var $=j.length-W;Q?(Q=Number(Q))>$&&(Q=$):Q=$;var ee=G.length;Q>ee/2&&(Q=ee/2);for(var ie=0;ie<Q;++ie){var ae=parseInt(G.substr(2*ie,2),16);if(H(ae))return ie;j[W+ie]=ae}return ie}function y(j,G,W,Q){return N(D(G,j.length-W),j,W,Q)}function v(j,G,W,Q){return N(function($){for(var ee=[],ie=0;ie<$.length;++ie)ee.push(255&$.charCodeAt(ie));return ee}(G),j,W,Q)}function T(j,G,W,Q){return v(j,G,W,Q)}function w(j,G,W,Q){return N(B(G),j,W,Q)}function A(j,G,W,Q){return N(function($,ee){for(var ie,ae,oe,de=[],le=0;le<$.length&&!((ee-=2)<0);++le)ie=$.charCodeAt(le),ae=ie>>8,oe=ie%256,de.push(oe),de.push(ae);return de}(G,j.length-W),j,W,Q)}function E(j,G,W){return G===0&&W===j.length?h.fromByteArray(j):h.fromByteArray(j.slice(G,W))}function M(j,G,W){W=Math.min(j.length,W);for(var Q=[],$=G;$<W;){var ee,ie,ae,oe,de=j[$],le=null,fe=de>239?4:de>223?3:de>191?2:1;if($+fe<=W)switch(fe){case 1:de<128&&(le=de);break;case 2:(192&(ee=j[$+1]))==128&&(oe=(31&de)<<6|63&ee)>127&&(le=oe);break;case 3:ee=j[$+1],ie=j[$+2],(192&ee)==128&&(192&ie)==128&&(oe=(15&de)<<12|(63&ee)<<6|63&ie)>2047&&(oe<55296||oe>57343)&&(le=oe);break;case 4:ee=j[$+1],ie=j[$+2],ae=j[$+3],(192&ee)==128&&(192&ie)==128&&(192&ae)==128&&(oe=(15&de)<<18|(63&ee)<<12|(63&ie)<<6|63&ae)>65535&&oe<1114112&&(le=oe)}le===null?(le=65533,fe=1):le>65535&&(le-=65536,Q.push(le>>>10&1023|55296),le=56320|1023&le),Q.push(le),$+=fe}return function(ue){var we=ue.length;if(we<=4096)return String.fromCharCode.apply(String,ue);for(var Ae="",Se=0;Se<we;)Ae+=String.fromCharCode.apply(String,ue.slice(Se,Se+=4096));return Ae}(Q)}q.kMaxLength=2147483647,e.TYPED_ARRAY_SUPPORT=function(){try{var j=new Uint8Array(1);return j.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},j.foo()===42}catch{return!1}}(),e.TYPED_ARRAY_SUPPORT||typeof console>"u"||typeof console.error!="function"||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(e.prototype,"parent",{enumerable:!0,get:function(){if(e.isBuffer(this))return this.buffer}}),Object.defineProperty(e.prototype,"offset",{enumerable:!0,get:function(){if(e.isBuffer(this))return this.byteOffset}}),typeof Symbol<"u"&&Symbol.species!=null&&e[Symbol.species]===e&&Object.defineProperty(e,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),e.poolSize=8192,e.from=function(j,G,W){return o(j,G,W)},e.prototype.__proto__=Uint8Array.prototype,e.__proto__=Uint8Array,e.alloc=function(j,G,W){return function(Q,$,ee){return r(Q),Q<=0?l(Q):$!==void 0?typeof ee=="string"?l(Q).fill($,ee):l(Q).fill($):l(Q)}(j,G,W)},e.allocUnsafe=function(j){return i(j)},e.allocUnsafeSlow=function(j){return i(j)},e.isBuffer=function(j){return j!=null&&j._isBuffer===!0&&j!==e.prototype},e.compare=function(j,G){if(F(j,Uint8Array)&&(j=e.from(j,j.offset,j.byteLength)),F(G,Uint8Array)&&(G=e.from(G,G.offset,G.byteLength)),!e.isBuffer(j)||!e.isBuffer(G))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(j===G)return 0;for(var W=j.length,Q=G.length,$=0,ee=Math.min(W,Q);$<ee;++$)if(j[$]!==G[$]){W=j[$],Q=G[$];break}return W<Q?-1:Q<W?1:0},e.isEncoding=function(j){switch(String(j).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},e.concat=function(j,G){if(!Array.isArray(j))throw new TypeError('"list" argument must be an Array of Buffers');if(j.length===0)return e.alloc(0);var W;if(G===void 0)for(G=0,W=0;W<j.length;++W)G+=j[W].length;var Q=e.allocUnsafe(G),$=0;for(W=0;W<j.length;++W){var ee=j[W];if(F(ee,Uint8Array)&&(ee=e.from(ee)),!e.isBuffer(ee))throw new TypeError('"list" argument must be an Array of Buffers');ee.copy(Q,$),$+=ee.length}return Q},e.byteLength=a,e.prototype._isBuffer=!0,e.prototype.swap16=function(){var j=this.length;if(j%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var G=0;G<j;G+=2)f(this,G,G+1);return this},e.prototype.swap32=function(){var j=this.length;if(j%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var G=0;G<j;G+=4)f(this,G,G+3),f(this,G+1,G+2);return this},e.prototype.swap64=function(){var j=this.length;if(j%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var G=0;G<j;G+=8)f(this,G,G+7),f(this,G+1,G+6),f(this,G+2,G+5),f(this,G+3,G+4);return this},e.prototype.toString=function(){var j=this.length;return j===0?"":arguments.length===0?M(this,0,j):c.apply(this,arguments)},e.prototype.toLocaleString=e.prototype.toString,e.prototype.equals=function(j){if(!e.isBuffer(j))throw new TypeError("Argument must be a Buffer");return this===j||e.compare(this,j)===0},e.prototype.inspect=function(){var j="",G=q.INSPECT_MAX_BYTES;return j=this.toString("hex",0,G).replace(/(.{2})/g,"$1 ").trim(),this.length>G&&(j+=" ... "),"<Buffer "+j+">"},e.prototype.compare=function(j,G,W,Q,$){if(F(j,Uint8Array)&&(j=e.from(j,j.offset,j.byteLength)),!e.isBuffer(j))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof j);if(G===void 0&&(G=0),W===void 0&&(W=j?j.length:0),Q===void 0&&(Q=0),$===void 0&&($=this.length),G<0||W>j.length||Q<0||$>this.length)throw new RangeError("out of range index");if(Q>=$&&G>=W)return 0;if(Q>=$)return-1;if(G>=W)return 1;if(this===j)return 0;for(var ee=($>>>=0)-(Q>>>=0),ie=(W>>>=0)-(G>>>=0),ae=Math.min(ee,ie),oe=this.slice(Q,$),de=j.slice(G,W),le=0;le<ae;++le)if(oe[le]!==de[le]){ee=oe[le],ie=de[le];break}return ee<ie?-1:ie<ee?1:0},e.prototype.includes=function(j,G,W){return this.indexOf(j,G,W)!==-1},e.prototype.indexOf=function(j,G,W){return g(this,j,G,W,!0)},e.prototype.lastIndexOf=function(j,G,W){return g(this,j,G,W,!1)},e.prototype.write=function(j,G,W,Q){if(G===void 0)Q="utf8",W=this.length,G=0;else if(W===void 0&&typeof G=="string")Q=G,W=this.length,G=0;else{if(!isFinite(G))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");G>>>=0,isFinite(W)?(W>>>=0,Q===void 0&&(Q="utf8")):(Q=W,W=void 0)}var $=this.length-G;if((W===void 0||W>$)&&(W=$),j.length>0&&(W<0||G<0)||G>this.length)throw new RangeError("Attempt to write outside buffer bounds");Q||(Q="utf8");for(var ee=!1;;)switch(Q){case"hex":return m(this,j,G,W);case"utf8":case"utf-8":return y(this,j,G,W);case"ascii":return v(this,j,G,W);case"latin1":case"binary":return T(this,j,G,W);case"base64":return w(this,j,G,W);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return A(this,j,G,W);default:if(ee)throw new TypeError("Unknown encoding: "+Q);Q=(""+Q).toLowerCase(),ee=!0}},e.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function b(j,G,W){var Q="";W=Math.min(j.length,W);for(var $=G;$<W;++$)Q+=String.fromCharCode(127&j[$]);return Q}function _(j,G,W){var Q="";W=Math.min(j.length,W);for(var $=G;$<W;++$)Q+=String.fromCharCode(j[$]);return Q}function S(j,G,W){var Q=j.length;(!G||G<0)&&(G=0),(!W||W<0||W>Q)&&(W=Q);for(var $="",ee=G;ee<W;++ee)$+=J(j[ee]);return $}function C(j,G,W){for(var Q=j.slice(G,W),$="",ee=0;ee<Q.length;ee+=2)$+=String.fromCharCode(Q[ee]+256*Q[ee+1]);return $}function k(j,G,W){if(j%1!=0||j<0)throw new RangeError("offset is not uint");if(j+G>W)throw new RangeError("Trying to access beyond buffer length")}function L(j,G,W,Q,$,ee){if(!e.isBuffer(j))throw new TypeError('"buffer" argument must be a Buffer instance');if(G>$||G<ee)throw new RangeError('"value" argument is out of bounds');if(W+Q>j.length)throw new RangeError("Index out of range")}function I(j,G,W,Q,$,ee){if(W+Q>j.length)throw new RangeError("Index out of range");if(W<0)throw new RangeError("Index out of range")}function R(j,G,W,Q,$){return G=+G,W>>>=0,$||I(j,0,W,4),p.write(j,G,W,Q,23,4),W+4}function V(j,G,W,Q,$){return G=+G,W>>>=0,$||I(j,0,W,8),p.write(j,G,W,Q,52,8),W+8}e.prototype.slice=function(j,G){var W=this.length;(j=~~j)<0?(j+=W)<0&&(j=0):j>W&&(j=W),(G=G===void 0?W:~~G)<0?(G+=W)<0&&(G=0):G>W&&(G=W),G<j&&(G=j);var Q=this.subarray(j,G);return Q.__proto__=e.prototype,Q},e.prototype.readUIntLE=function(j,G,W){j>>>=0,G>>>=0,W||k(j,G,this.length);for(var Q=this[j],$=1,ee=0;++ee<G&&($*=256);)Q+=this[j+ee]*$;return Q},e.prototype.readUIntBE=function(j,G,W){j>>>=0,G>>>=0,W||k(j,G,this.length);for(var Q=this[j+--G],$=1;G>0&&($*=256);)Q+=this[j+--G]*$;return Q},e.prototype.readUInt8=function(j,G){return j>>>=0,G||k(j,1,this.length),this[j]},e.prototype.readUInt16LE=function(j,G){return j>>>=0,G||k(j,2,this.length),this[j]|this[j+1]<<8},e.prototype.readUInt16BE=function(j,G){return j>>>=0,G||k(j,2,this.length),this[j]<<8|this[j+1]},e.prototype.readUInt32LE=function(j,G){return j>>>=0,G||k(j,4,this.length),(this[j]|this[j+1]<<8|this[j+2]<<16)+16777216*this[j+3]},e.prototype.readUInt32BE=function(j,G){return j>>>=0,G||k(j,4,this.length),16777216*this[j]+(this[j+1]<<16|this[j+2]<<8|this[j+3])},e.prototype.readIntLE=function(j,G,W){j>>>=0,G>>>=0,W||k(j,G,this.length);for(var Q=this[j],$=1,ee=0;++ee<G&&($*=256);)Q+=this[j+ee]*$;return Q>=($*=128)&&(Q-=Math.pow(2,8*G)),Q},e.prototype.readIntBE=function(j,G,W){j>>>=0,G>>>=0,W||k(j,G,this.length);for(var Q=G,$=1,ee=this[j+--Q];Q>0&&($*=256);)ee+=this[j+--Q]*$;return ee>=($*=128)&&(ee-=Math.pow(2,8*G)),ee},e.prototype.readInt8=function(j,G){return j>>>=0,G||k(j,1,this.length),128&this[j]?-1*(255-this[j]+1):this[j]},e.prototype.readInt16LE=function(j,G){j>>>=0,G||k(j,2,this.length);var W=this[j]|this[j+1]<<8;return 32768&W?4294901760|W:W},e.prototype.readInt16BE=function(j,G){j>>>=0,G||k(j,2,this.length);var W=this[j+1]|this[j]<<8;return 32768&W?4294901760|W:W},e.prototype.readInt32LE=function(j,G){return j>>>=0,G||k(j,4,this.length),this[j]|this[j+1]<<8|this[j+2]<<16|this[j+3]<<24},e.prototype.readInt32BE=function(j,G){return j>>>=0,G||k(j,4,this.length),this[j]<<24|this[j+1]<<16|this[j+2]<<8|this[j+3]},e.prototype.readFloatLE=function(j,G){return j>>>=0,G||k(j,4,this.length),p.read(this,j,!0,23,4)},e.prototype.readFloatBE=function(j,G){return j>>>=0,G||k(j,4,this.length),p.read(this,j,!1,23,4)},e.prototype.readDoubleLE=function(j,G){return j>>>=0,G||k(j,8,this.length),p.read(this,j,!0,52,8)},e.prototype.readDoubleBE=function(j,G){return j>>>=0,G||k(j,8,this.length),p.read(this,j,!1,52,8)},e.prototype.writeUIntLE=function(j,G,W,Q){j=+j,G>>>=0,W>>>=0,Q||L(this,j,G,W,Math.pow(2,8*W)-1,0);var $=1,ee=0;for(this[G]=255&j;++ee<W&&($*=256);)this[G+ee]=j/$&255;return G+W},e.prototype.writeUIntBE=function(j,G,W,Q){j=+j,G>>>=0,W>>>=0,Q||L(this,j,G,W,Math.pow(2,8*W)-1,0);var $=W-1,ee=1;for(this[G+$]=255&j;--$>=0&&(ee*=256);)this[G+$]=j/ee&255;return G+W},e.prototype.writeUInt8=function(j,G,W){return j=+j,G>>>=0,W||L(this,j,G,1,255,0),this[G]=255&j,G+1},e.prototype.writeUInt16LE=function(j,G,W){return j=+j,G>>>=0,W||L(this,j,G,2,65535,0),this[G]=255&j,this[G+1]=j>>>8,G+2},e.prototype.writeUInt16BE=function(j,G,W){return j=+j,G>>>=0,W||L(this,j,G,2,65535,0),this[G]=j>>>8,this[G+1]=255&j,G+2},e.prototype.writeUInt32LE=function(j,G,W){return j=+j,G>>>=0,W||L(this,j,G,4,4294967295,0),this[G+3]=j>>>24,this[G+2]=j>>>16,this[G+1]=j>>>8,this[G]=255&j,G+4},e.prototype.writeUInt32BE=function(j,G,W){return j=+j,G>>>=0,W||L(this,j,G,4,4294967295,0),this[G]=j>>>24,this[G+1]=j>>>16,this[G+2]=j>>>8,this[G+3]=255&j,G+4},e.prototype.writeIntLE=function(j,G,W,Q){if(j=+j,G>>>=0,!Q){var $=Math.pow(2,8*W-1);L(this,j,G,W,$-1,-$)}var ee=0,ie=1,ae=0;for(this[G]=255&j;++ee<W&&(ie*=256);)j<0&&ae===0&&this[G+ee-1]!==0&&(ae=1),this[G+ee]=(j/ie>>0)-ae&255;return G+W},e.prototype.writeIntBE=function(j,G,W,Q){if(j=+j,G>>>=0,!Q){var $=Math.pow(2,8*W-1);L(this,j,G,W,$-1,-$)}var ee=W-1,ie=1,ae=0;for(this[G+ee]=255&j;--ee>=0&&(ie*=256);)j<0&&ae===0&&this[G+ee+1]!==0&&(ae=1),this[G+ee]=(j/ie>>0)-ae&255;return G+W},e.prototype.writeInt8=function(j,G,W){return j=+j,G>>>=0,W||L(this,j,G,1,127,-128),j<0&&(j=255+j+1),this[G]=255&j,G+1},e.prototype.writeInt16LE=function(j,G,W){return j=+j,G>>>=0,W||L(this,j,G,2,32767,-32768),this[G]=255&j,this[G+1]=j>>>8,G+2},e.prototype.writeInt16BE=function(j,G,W){return j=+j,G>>>=0,W||L(this,j,G,2,32767,-32768),this[G]=j>>>8,this[G+1]=255&j,G+2},e.prototype.writeInt32LE=function(j,G,W){return j=+j,G>>>=0,W||L(this,j,G,4,2147483647,-2147483648),this[G]=255&j,this[G+1]=j>>>8,this[G+2]=j>>>16,this[G+3]=j>>>24,G+4},e.prototype.writeInt32BE=function(j,G,W){return j=+j,G>>>=0,W||L(this,j,G,4,2147483647,-2147483648),j<0&&(j=4294967295+j+1),this[G]=j>>>24,this[G+1]=j>>>16,this[G+2]=j>>>8,this[G+3]=255&j,G+4},e.prototype.writeFloatLE=function(j,G,W){return R(this,j,G,!0,W)},e.prototype.writeFloatBE=function(j,G,W){return R(this,j,G,!1,W)},e.prototype.writeDoubleLE=function(j,G,W){return V(this,j,G,!0,W)},e.prototype.writeDoubleBE=function(j,G,W){return V(this,j,G,!1,W)},e.prototype.copy=function(j,G,W,Q){if(!e.isBuffer(j))throw new TypeError("argument should be a Buffer");if(W||(W=0),Q||Q===0||(Q=this.length),G>=j.length&&(G=j.length),G||(G=0),Q>0&&Q<W&&(Q=W),Q===W||j.length===0||this.length===0)return 0;if(G<0)throw new RangeError("targetStart out of bounds");if(W<0||W>=this.length)throw new RangeError("Index out of range");if(Q<0)throw new RangeError("sourceEnd out of bounds");Q>this.length&&(Q=this.length),j.length-G<Q-W&&(Q=j.length-G+W);var $=Q-W;if(this===j&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(G,W,Q);else if(this===j&&W<G&&G<Q)for(var ee=$-1;ee>=0;--ee)j[ee+G]=this[ee+W];else Uint8Array.prototype.set.call(j,this.subarray(W,Q),G);return $},e.prototype.fill=function(j,G,W,Q){if(typeof j=="string"){if(typeof G=="string"?(Q=G,G=0,W=this.length):typeof W=="string"&&(Q=W,W=this.length),Q!==void 0&&typeof Q!="string")throw new TypeError("encoding must be a string");if(typeof Q=="string"&&!e.isEncoding(Q))throw new TypeError("Unknown encoding: "+Q);if(j.length===1){var $=j.charCodeAt(0);(Q==="utf8"&&$<128||Q==="latin1")&&(j=$)}}else typeof j=="number"&&(j&=255);if(G<0||this.length<G||this.length<W)throw new RangeError("Out of range index");if(W<=G)return this;var ee;if(G>>>=0,W=W===void 0?this.length:W>>>0,j||(j=0),typeof j=="number")for(ee=G;ee<W;++ee)this[ee]=j;else{var ie=e.isBuffer(j)?j:e.from(j,Q),ae=ie.length;if(ae===0)throw new TypeError('The value "'+j+'" is invalid for argument "value"');for(ee=0;ee<W-G;++ee)this[ee+G]=ie[ee%ae]}return this};var O=/[^+/0-9A-Za-z-_]/g;function J(j){return j<16?"0"+j.toString(16):j.toString(16)}function D(j,G){var W;G=G||1/0;for(var Q=j.length,$=null,ee=[],ie=0;ie<Q;++ie){if((W=j.charCodeAt(ie))>55295&&W<57344){if(!$){if(W>56319){(G-=3)>-1&&ee.push(239,191,189);continue}if(ie+1===Q){(G-=3)>-1&&ee.push(239,191,189);continue}$=W;continue}if(W<56320){(G-=3)>-1&&ee.push(239,191,189),$=W;continue}W=65536+($-55296<<10|W-56320)}else $&&(G-=3)>-1&&ee.push(239,191,189);if($=null,W<128){if((G-=1)<0)break;ee.push(W)}else if(W<2048){if((G-=2)<0)break;ee.push(W>>6|192,63&W|128)}else if(W<65536){if((G-=3)<0)break;ee.push(W>>12|224,W>>6&63|128,63&W|128)}else{if(!(W<1114112))throw new Error("Invalid code point");if((G-=4)<0)break;ee.push(W>>18|240,W>>12&63|128,W>>6&63|128,63&W|128)}}return ee}function B(j){return h.toByteArray(function(G){if((G=(G=G.split("=")[0]).trim().replace(O,"")).length<2)return"";for(;G.length%4!=0;)G+="=";return G}(j))}function N(j,G,W,Q){for(var $=0;$<Q&&!($+W>=G.length||$>=j.length);++$)G[$+W]=j[$];return $}function F(j,G){return j instanceof G||j!=null&&j.constructor!=null&&j.constructor.name!=null&&j.constructor.name===G.name}function H(j){return j!=j}}).call(this)}).call(this,n("buffer").Buffer)},{"base64-js":79,buffer:111,ieee754:442}],112:[function(n,z,q){"use strict";var t=n("./lib/monotone"),h=n("./lib/triangulation"),p=n("./lib/delaunay"),l=n("./lib/filter");function e(i){return[Math.min(i[0],i[1]),Math.max(i[0],i[1])]}function o(i,u){return i[0]-u[0]||i[1]-u[1]}function r(i,u,s){return u in i?i[u]:s}z.exports=function(i,u,s){Array.isArray(u)?(s=s||{},u=u||[]):(s=u||{},u=[]);var a=!!r(s,"delaunay",!0),c=!!r(s,"interior",!0),f=!!r(s,"exterior",!0),g=!!r(s,"infinity",!1);if(!c&&!f||i.length===0)return[];var d=t(i,u);if(a||c!==f||g){for(var m=h(i.length,function(T){return T.map(e).sort(o)}(u)),y=0;y<d.length;++y){var v=d[y];m.addTriangle(v[0],v[1],v[2])}return a&&p(i,m),f?c?g?l(m,0,g):m.cells():l(m,1,g):l(m,-1)}return d}},{"./lib/delaunay":113,"./lib/filter":114,"./lib/monotone":115,"./lib/triangulation":116}],113:[function(n,z,q){"use strict";var t=n("robust-in-sphere")[4];n("binary-search-bounds");function h(p,l,e,o,r,i){var u=l.opposite(o,r);if(!(u<0)){if(r<o){var s=o;o=r,r=s,s=i,i=u,u=s}l.isConstraint(o,r)||t(p[o],p[r],p[i],p[u])<0&&e.push(o,r)}}z.exports=function(p,l){for(var e=[],o=p.length,r=l.stars,i=0;i<o;++i)for(var u=r[i],s=1;s<u.length;s+=2)if(!((g=u[s])<i)&&!l.isConstraint(i,g)){for(var a=u[s-1],c=-1,f=1;f<u.length;f+=2)if(u[f-1]===g){c=u[f];break}c<0||t(p[i],p[g],p[a],p[c])<0&&e.push(i,g)}for(;e.length>0;){for(var g=e.pop(),d=(i=e.pop(),a=-1,c=-1,u=r[i],1);d<u.length;d+=2){var m=u[d-1],y=u[d];m===g?c=y:y===g&&(a=m)}a<0||c<0||t(p[i],p[g],p[a],p[c])>=0||(l.flip(i,g),h(p,l,e,a,i,c),h(p,l,e,i,c,a),h(p,l,e,c,g,a),h(p,l,e,g,a,c))}}},{"binary-search-bounds":96,"robust-in-sphere":546}],114:[function(n,z,q){"use strict";var t,h=n("binary-search-bounds");function p(e,o,r,i,u,s,a){this.cells=e,this.neighbor=o,this.flags=i,this.constraint=r,this.active=u,this.next=s,this.boundary=a}function l(e,o){return e[0]-o[0]||e[1]-o[1]||e[2]-o[2]}z.exports=function(e,o,r){var i=function(A,E){for(var M=A.cells(),b=M.length,_=0;_<b;++_){var S=(B=M[_])[0],C=B[1],k=B[2];C<k?C<S&&(B[0]=C,B[1]=k,B[2]=S):k<S&&(B[0]=k,B[1]=S,B[2]=C)}M.sort(l);var L=new Array(b);for(_=0;_<L.length;++_)L[_]=0;var I=[],R=[],V=new Array(3*b),O=new Array(3*b),J=null;E&&(J=[]);var D=new p(M,V,O,L,I,R,J);for(_=0;_<b;++_)for(var B=M[_],N=0;N<3;++N){S=B[N],C=B[(N+1)%3];var F=V[3*_+N]=D.locate(C,S,A.opposite(C,S)),H=O[3*_+N]=A.isConstraint(S,C);F<0&&(H?R.push(_):(I.push(_),L[_]=1),E&&J.push([C,S,-1]))}return D}(e,r);if(o===0)return r?i.cells.concat(i.boundary):i.cells;for(var u=1,s=i.active,a=i.next,c=i.flags,f=i.cells,g=i.constraint,d=i.neighbor;s.length>0||a.length>0;){for(;s.length>0;){var m=s.pop();if(c[m]!==-u){c[m]=u,f[m];for(var y=0;y<3;++y){var v=d[3*m+y];v>=0&&c[v]===0&&(g[3*m+y]?a.push(v):(s.push(v),c[v]=u))}}}var T=a;a=s,s=T,a.length=0,u=-u}var w=function(A,E,M){for(var b=0,_=0;_<A.length;++_)E[_]===M&&(A[b++]=A[_]);return A.length=b,A}(f,c,o);return r?w.concat(i.boundary):w},p.prototype.locate=(t=[0,0,0],function(e,o,r){var i=e,u=o,s=r;return o<r?o<e&&(i=o,u=r,s=e):r<e&&(i=r,u=e,s=o),i<0?-1:(t[0]=i,t[1]=u,t[2]=s,h.eq(this.cells,t,l))})},{"binary-search-bounds":96}],115:[function(n,z,q){"use strict";var t=n("binary-search-bounds"),h=n("robust-orientation")[3];function p(a,c,f,g,d){this.a=a,this.b=c,this.idx=f,this.lowerIds=g,this.upperIds=d}function l(a,c,f,g){this.a=a,this.b=c,this.type=f,this.idx=g}function e(a,c){var f=a.a[0]-c.a[0]||a.a[1]-c.a[1]||a.type-c.type;return f||(a.type!==0&&(f=h(a.a,a.b,c.b))?f:a.idx-c.idx)}function o(a,c){return h(a.a,a.b,c)}function r(a,c,f,g,d){for(var m=t.lt(c,g,o),y=t.gt(c,g,o),v=m;v<y;++v){for(var T=c[v],w=T.lowerIds,A=w.length;A>1&&h(f[w[A-2]],f[w[A-1]],g)>0;)a.push([w[A-1],w[A-2],d]),A-=1;w.length=A,w.push(d);var E=T.upperIds;for(A=E.length;A>1&&h(f[E[A-2]],f[E[A-1]],g)<0;)a.push([E[A-2],E[A-1],d]),A-=1;E.length=A,E.push(d)}}function i(a,c){var f;return(f=a.a[0]<c.a[0]?h(a.a,a.b,c.a):h(c.b,c.a,a.a))?f:(f=c.b[0]<a.b[0]?h(a.a,a.b,c.b):h(c.b,c.a,a.b))||a.idx-c.idx}function u(a,c,f){var g=t.le(a,f,i),d=a[g],m=d.upperIds,y=m[m.length-1];d.upperIds=[y],a.splice(g+1,0,new p(f.a,f.b,f.idx,[y],m))}function s(a,c,f){var g=f.a;f.a=f.b,f.b=g;var d=t.eq(a,f,i),m=a[d];a[d-1].upperIds=m.upperIds,a.splice(d,1)}z.exports=function(a,c){for(var f=a.length,g=c.length,d=[],m=0;m<f;++m)d.push(new l(a[m],null,0,m));for(m=0;m<g;++m){var y=c[m],v=a[y[0]],T=a[y[1]];v[0]<T[0]?d.push(new l(v,T,2,m),new l(T,v,1,m)):v[0]>T[0]&&d.push(new l(T,v,2,m),new l(v,T,1,m))}d.sort(e);for(var w=d[0].a[0]-(1+Math.abs(d[0].a[0]))*Math.pow(2,-52),A=[new p([w,1],[w,0],-1,[],[],[],[])],E=[],M=(m=0,d.length);m<M;++m){var b=d[m],_=b.type;_===0?r(E,A,a,b.a,b.idx):_===2?u(A,a,b):s(A,a,b)}return E}},{"binary-search-bounds":96,"robust-orientation":548}],116:[function(n,z,q){"use strict";var t=n("binary-search-bounds");function h(e,o){this.stars=e,this.edges=o}z.exports=function(e,o){for(var r=new Array(e),i=0;i<e;++i)r[i]=[];return new h(r,o)};var p=h.prototype;function l(e,o,r){for(var i=1,u=e.length;i<u;i+=2)if(e[i-1]===o&&e[i]===r)return e[i-1]=e[u-2],e[i]=e[u-1],void(e.length=u-2)}p.isConstraint=function(){var e=[0,0];function o(r,i){return r[0]-i[0]||r[1]-i[1]}return function(r,i){return e[0]=Math.min(r,i),e[1]=Math.max(r,i),t.eq(this.edges,e,o)>=0}}(),p.removeTriangle=function(e,o,r){var i=this.stars;l(i[e],o,r),l(i[o],r,e),l(i[r],e,o)},p.addTriangle=function(e,o,r){var i=this.stars;i[e].push(o,r),i[o].push(r,e),i[r].push(e,o)},p.opposite=function(e,o){for(var r=this.stars[o],i=1,u=r.length;i<u;i+=2)if(r[i]===e)return r[i-1];return-1},p.flip=function(e,o){var r=this.opposite(e,o),i=this.opposite(o,e);this.removeTriangle(e,o,r),this.removeTriangle(o,e,i),this.addTriangle(e,i,r),this.addTriangle(o,r,i)},p.edges=function(){for(var e=this.stars,o=[],r=0,i=e.length;r<i;++r)for(var u=e[r],s=0,a=u.length;s<a;s+=2)o.push([u[s],u[s+1]]);return o},p.cells=function(){for(var e=this.stars,o=[],r=0,i=e.length;r<i;++r)for(var u=e[r],s=0,a=u.length;s<a;s+=2){var c=u[s],f=u[s+1];r<Math.min(c,f)&&o.push([r,c,f])}return o}},{"binary-search-bounds":96}],117:[function(n,z,q){"use strict";z.exports=function(t){for(var h=1,p=1;p<t.length;++p)for(var l=0;l<p;++l)if(t[p]<t[l])h=-h;else if(t[l]===t[p])return 0;return h}},{}],118:[function(n,z,q){"use strict";var t=n("dup"),h=n("robust-linear-solve");function p(o,r){for(var i=0,u=o.length,s=0;s<u;++s)i+=o[s]*r[s];return i}function l(o){var r=o.length;if(r===0)return[];o[0].length;var i=t([o.length+1,o.length+1],1),u=t([o.length+1],1);i[r][r]=0;for(var s=0;s<r;++s){for(var a=0;a<=s;++a)i[a][s]=i[s][a]=2*p(o[s],o[a]);u[s]=p(o[s],o[s])}var c=h(i,u),f=0,g=c[r+1];for(s=0;s<g.length;++s)f+=g[s];var d=new Array(r);for(s=0;s<r;++s){g=c[s];var m=0;for(a=0;a<g.length;++a)m+=g[a];d[s]=m/f}return d}function e(o){if(o.length===0)return[];for(var r=o[0].length,i=t([r]),u=l(o),s=0;s<o.length;++s)for(var a=0;a<r;++a)i[a]+=o[s][a]*u[s];return i}e.barycenetric=l,z.exports=e},{dup:176,"robust-linear-solve":547}],119:[function(n,z,q){z.exports=function(h){for(var p=t(h),l=0,e=0;e<h.length;++e)for(var o=h[e],r=0;r<p.length;++r)l+=Math.pow(o[r]-p[r],2);return Math.sqrt(l/h.length)};var t=n("circumcenter")},{circumcenter:118}],120:[function(n,z,q){z.exports=function(t,h,p){return h<p?t<h?h:t>p?p:t:t<p?p:t>h?h:t}},{}],121:[function(n,z,q){"use strict";z.exports=function(y,v,T){var w;if(T){w=v;for(var A=new Array(v.length),E=0;E<v.length;++E){var M=v[E];A[E]=[M[0],M[1],T[E]]}v=A}for(var b=function(_,S,C){var k=c(_,[],a(_));return d(S,k,C),!!k}(y,v,!!T);m(y,v,!!T);)b=!0;if(T&&b)for(w.length=0,T.length=0,E=0;E<v.length;++E)M=v[E],w.push([M[0],M[1]]),T.push(M[2]);return b};var t=n("union-find"),h=n("box-intersect"),p=n("robust-segment-intersect"),l=n("big-rat"),e=n("big-rat/cmp"),o=n("big-rat/to-float"),r=n("rat-vec"),i=n("nextafter"),u=n("./lib/rat-seg-intersect");function s(y){var v=o(y);return[i(v,-1/0),i(v,1/0)]}function a(y){for(var v=new Array(y.length),T=0;T<y.length;++T){var w=y[T];v[T]=[i(w[0],-1/0),i(w[1],-1/0),i(w[0],1/0),i(w[1],1/0)]}return v}function c(y,v,T){for(var w=v.length,A=new t(w),E=[],M=0;M<v.length;++M){var b=v[M],_=s(b[0]),S=s(b[1]);E.push([i(_[0],-1/0),i(S[0],-1/0),i(_[1],1/0),i(S[1],1/0)])}h(E,function(R,V){A.link(R,V)});var C=!0,k=new Array(w);for(M=0;M<w;++M)(I=A.find(M))!==M&&(C=!1,y[I]=[Math.min(y[M][0],y[I][0]),Math.min(y[M][1],y[I][1])]);if(C)return null;var L=0;for(M=0;M<w;++M){var I;(I=A.find(M))===M?(k[M]=L,y[L++]=y[M]):k[M]=-1}for(y.length=L,M=0;M<w;++M)k[M]<0&&(k[M]=k[A.find(M)]);return k}function f(y,v){return y[0]-v[0]||y[1]-v[1]}function g(y,v){var T=y[0]-v[0]||y[1]-v[1];return T||(y[2]<v[2]?-1:y[2]>v[2]?1:0)}function d(y,v,T){if(y.length!==0){if(v)for(var w=0;w<y.length;++w){var A=v[(M=y[w])[0]],E=v[M[1]];M[0]=Math.min(A,E),M[1]=Math.max(A,E)}else for(w=0;w<y.length;++w){var M;A=(M=y[w])[0],E=M[1],M[0]=Math.min(A,E),M[1]=Math.max(A,E)}T?y.sort(g):y.sort(f);var b=1;for(w=1;w<y.length;++w){var _=y[w-1],S=y[w];(S[0]!==_[0]||S[1]!==_[1]||T&&S[2]!==_[2])&&(y[b++]=S)}y.length=b}}function m(y,v,T){var w=function(_,S){for(var C=new Array(S.length),k=0;k<S.length;++k){var L=S[k],I=_[L[0]],R=_[L[1]];C[k]=[i(Math.min(I[0],R[0]),-1/0),i(Math.min(I[1],R[1]),-1/0),i(Math.max(I[0],R[0]),1/0),i(Math.max(I[1],R[1]),1/0)]}return C}(y,v),A=function(_,S,C){var k=[];return h(C,function(L,I){var R=S[L],V=S[I];if(R[0]!==V[0]&&R[0]!==V[1]&&R[1]!==V[0]&&R[1]!==V[1]){var O=_[R[0]],J=_[R[1]],D=_[V[0]],B=_[V[1]];p(O,J,D,B)&&k.push([L,I])}}),k}(y,v,w),E=a(y),M=function(_,S,C,k){var L=[];return h(C,k,function(I,R){var V=S[I];if(V[0]!==R&&V[1]!==R){var O=_[R],J=_[V[0]],D=_[V[1]];p(J,D,O,O)&&L.push([I,R])}}),L}(y,v,w,E),b=c(y,function(_,S,C,k,L){var I,R,V=_.map(function(de){return[l(de[0]),l(de[1])]});for(I=0;I<C.length;++I){var O=C[I];R=O[0];var J=O[1],D=S[R],B=S[J],N=u(r(_[D[0]]),r(_[D[1]]),r(_[B[0]]),r(_[B[1]]));if(N){var F=_.length;_.push([o(N[0]),o(N[1])]),V.push(N),k.push([R,F],[J,F])}}for(k.sort(function(de,le){if(de[0]!==le[0])return de[0]-le[0];var fe=V[de[1]],ue=V[le[1]];return e(fe[0],ue[0])||e(fe[1],ue[1])}),I=k.length-1;I>=0;--I){var H=S[R=(ae=k[I])[0]],j=H[0],G=H[1],W=_[j],Q=_[G];if((W[0]-Q[0]||W[1]-Q[1])<0){var $=j;j=G,G=$}H[0]=j;var ee,ie=H[1]=ae[1];for(L&&(ee=H[2]);I>0&&k[I-1][0]===R;){var ae,oe=(ae=k[--I])[1];L?S.push([ie,oe,ee]):S.push([ie,oe]),ie=oe}L?S.push([ie,G,ee]):S.push([ie,G])}return V}(y,v,A,M,T));return d(v,b,T),!!b||A.length>0||M.length>0}},{"./lib/rat-seg-intersect":122,"big-rat":83,"big-rat/cmp":81,"big-rat/to-float":95,"box-intersect":101,nextafter:496,"rat-vec":530,"robust-segment-intersect":551,"union-find":596}],122:[function(n,z,q){"use strict";z.exports=function(u,s,a,c){var f=e(s,u),g=e(c,a),d=i(f,g);if(l(d)===0)return null;var m=e(u,a),y=i(g,m),v=h(y,d),T=r(f,v);return o(u,T)};var t=n("big-rat/mul"),h=n("big-rat/div"),p=n("big-rat/sub"),l=n("big-rat/sign"),e=n("rat-vec/sub"),o=n("rat-vec/add"),r=n("rat-vec/muls");function i(u,s){return p(t(u[0],s[1]),t(u[1],s[0]))}},{"big-rat/div":82,"big-rat/mul":92,"big-rat/sign":93,"big-rat/sub":94,"rat-vec/add":529,"rat-vec/muls":531,"rat-vec/sub":532}],123:[function(n,z,q){"use strict";var t=n("clamp");function h(p,l){l==null&&(l=!0);var e=p[0],o=p[1],r=p[2],i=p[3];return i==null&&(i=l?1:255),l&&(e*=255,o*=255,r*=255,i*=255),16777216*(e=255&t(e,0,255))+((o=255&t(o,0,255))<<16)+((r=255&t(r,0,255))<<8)+(i=255&t(i,0,255))}z.exports=h,z.exports.to=h,z.exports.from=function(p,l){var e=(p=+p)>>>24,o=(16711680&p)>>>16,r=(65280&p)>>>8,i=255&p;return l===!1?[e,o,r,i]:[e/255,o/255,r/255,i/255]}},{clamp:120}],124:[function(n,z,q){"use strict";z.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},{}],125:[function(n,z,q){"use strict";var t=n("color-rgba"),h=n("clamp"),p=n("dtype");z.exports=function(l,e){e!=="float"&&e||(e="array"),e==="uint"&&(e="uint8"),e==="uint_clamped"&&(e="uint8_clamped");var o=new(p(e))(4),r=e!=="uint8"&&e!=="uint8_clamped";return l.length&&typeof l!="string"||((l=t(l))[0]/=255,l[1]/=255,l[2]/=255),function(i){return i instanceof Uint8Array||i instanceof Uint8ClampedArray||!!(Array.isArray(i)&&(i[0]>1||i[0]===0)&&(i[1]>1||i[1]===0)&&(i[2]>1||i[2]===0)&&(!i[3]||i[3]>1))}(l)?(o[0]=l[0],o[1]=l[1],o[2]=l[2],o[3]=l[3]!=null?l[3]:255,r&&(o[0]/=255,o[1]/=255,o[2]/=255,o[3]/=255),o):(r?(o[0]=l[0],o[1]=l[1],o[2]=l[2],o[3]=l[3]!=null?l[3]:1):(o[0]=h(Math.floor(255*l[0]),0,255),o[1]=h(Math.floor(255*l[1]),0,255),o[2]=h(Math.floor(255*l[2]),0,255),o[3]=l[3]==null?255:h(Math.floor(255*l[3]),0,255)),o)}},{clamp:120,"color-rgba":127,dtype:175}],126:[function(n,z,q){(function(t){(function(){"use strict";var h=n("color-name"),p=n("is-plain-obj"),l=n("defined");z.exports=function(o){var r,i,u=[],s=1;if(typeof o=="string")if(h[o])u=h[o].slice(),i="rgb";else if(o==="transparent")s=0,i="rgb",u=[0,0,0];else if(/^#[A-Fa-f0-9]+$/.test(o)){var a=(g=o.slice(1)).length;s=1,a<=4?(u=[parseInt(g[0]+g[0],16),parseInt(g[1]+g[1],16),parseInt(g[2]+g[2],16)],a===4&&(s=parseInt(g[3]+g[3],16)/255)):(u=[parseInt(g[0]+g[1],16),parseInt(g[2]+g[3],16),parseInt(g[4]+g[5],16)],a===8&&(s=parseInt(g[6]+g[7],16)/255)),u[0]||(u[0]=0),u[1]||(u[1]=0),u[2]||(u[2]=0),i="rgb"}else if(r=/^((?:rgb|hs[lvb]|hwb|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms)a?)\s*\(([^\)]*)\)/.exec(o)){var c=r[1],f=c==="rgb",g=c.replace(/a$/,"");i=g,a=g==="cmyk"?4:g==="gray"?1:3,u=r[2].trim().split(/\s*,\s*/).map(function(m,y){if(/%$/.test(m))return y===a?parseFloat(m)/100:g==="rgb"?255*parseFloat(m)/100:parseFloat(m);if(g[y]==="h"){if(/deg$/.test(m))return parseFloat(m);if(e[m]!==void 0)return e[m]}return parseFloat(m)}),c===g&&u.push(1),s=f||u[a]===void 0?1:u[a],u=u.slice(0,a)}else o.length>10&&/[0-9](?:\s|\/)/.test(o)&&(u=o.match(/([0-9]+)/g).map(function(m){return parseFloat(m)}),i=o.match(/([a-z])/gi).join("").toLowerCase());else if(isNaN(o))if(p(o)){var d=l(o.r,o.red,o.R,null);d!==null?(i="rgb",u=[d,l(o.g,o.green,o.G),l(o.b,o.blue,o.B)]):(i="hsl",u=[l(o.h,o.hue,o.H),l(o.s,o.saturation,o.S),l(o.l,o.lightness,o.L,o.b,o.brightness)]),s=l(o.a,o.alpha,o.opacity,1),o.opacity!=null&&(s/=100)}else(Array.isArray(o)||t.ArrayBuffer&&ArrayBuffer.isView&&ArrayBuffer.isView(o))&&(u=[o[0],o[1],o[2]],i="rgb",s=o.length===4?o[3]:1);else i="rgb",u=[o>>>16,(65280&o)>>>8,255&o];return{space:i,values:u,alpha:s}};var e={red:0,orange:60,yellow:120,green:180,blue:240,purple:300}}).call(this)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{"color-name":124,defined:170,"is-plain-obj":469}],127:[function(n,z,q){"use strict";var t=n("color-parse"),h=n("color-space/hsl"),p=n("clamp");z.exports=function(l){var e,o=t(l);return o.space?((e=Array(3))[0]=p(o.values[0],0,255),e[1]=p(o.values[1],0,255),e[2]=p(o.values[2],0,255),o.space[0]==="h"&&(e=h.rgb(e)),e.push(p(o.alpha,0,1)),e):[]}},{clamp:120,"color-parse":126,"color-space/hsl":128}],128:[function(n,z,q){"use strict";var t=n("./rgb");z.exports={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(h){var p,l,e,o,r,i=h[0]/360,u=h[1]/100,s=h[2]/100;if(u===0)return[r=255*s,r,r];p=2*s-(l=s<.5?s*(1+u):s+u-s*u),o=[0,0,0];for(var a=0;a<3;a++)(e=i+1/3*-(a-1))<0?e++:e>1&&e--,r=6*e<1?p+6*(l-p)*e:2*e<1?l:3*e<2?p+(l-p)*(2/3-e)*6:p,o[a]=255*r;return o}},t.hsl=function(h){var p,l,e=h[0]/255,o=h[1]/255,r=h[2]/255,i=Math.min(e,o,r),u=Math.max(e,o,r),s=u-i;return u===i?p=0:e===u?p=(o-r)/s:o===u?p=2+(r-e)/s:r===u&&(p=4+(e-o)/s),(p=Math.min(60*p,360))<0&&(p+=360),l=(i+u)/2,[p,100*(u===i?0:l<=.5?s/(u+i):s/(2-u-i)),100*l]}},{"./rgb":129}],129:[function(n,z,q){"use strict";z.exports={name:"rgb",min:[0,0,0],max:[255,255,255],channel:["red","green","blue"],alias:["RGB"]}},{}],130:[function(n,z,q){z.exports={jet:[{index:0,rgb:[0,0,131]},{index:.125,rgb:[0,60,170]},{index:.375,rgb:[5,255,255]},{index:.625,rgb:[255,255,0]},{index:.875,rgb:[250,0,0]},{index:1,rgb:[128,0,0]}],hsv:[{index:0,rgb:[255,0,0]},{index:.169,rgb:[253,255,2]},{index:.173,rgb:[247,255,2]},{index:.337,rgb:[0,252,4]},{index:.341,rgb:[0,252,10]},{index:.506,rgb:[1,249,255]},{index:.671,rgb:[2,0,253]},{index:.675,rgb:[8,0,253]},{index:.839,rgb:[255,0,251]},{index:.843,rgb:[255,0,245]},{index:1,rgb:[255,0,6]}],hot:[{index:0,rgb:[0,0,0]},{index:.3,rgb:[230,0,0]},{index:.6,rgb:[255,210,0]},{index:1,rgb:[255,255,255]}],cool:[{index:0,rgb:[0,255,255]},{index:1,rgb:[255,0,255]}],spring:[{index:0,rgb:[255,0,255]},{index:1,rgb:[255,255,0]}],summer:[{index:0,rgb:[0,128,102]},{index:1,rgb:[255,255,102]}],autumn:[{index:0,rgb:[255,0,0]},{index:1,rgb:[255,255,0]}],winter:[{index:0,rgb:[0,0,255]},{index:1,rgb:[0,255,128]}],bone:[{index:0,rgb:[0,0,0]},{index:.376,rgb:[84,84,116]},{index:.753,rgb:[169,200,200]},{index:1,rgb:[255,255,255]}],copper:[{index:0,rgb:[0,0,0]},{index:.804,rgb:[255,160,102]},{index:1,rgb:[255,199,127]}],greys:[{index:0,rgb:[0,0,0]},{index:1,rgb:[255,255,255]}],yignbu:[{index:0,rgb:[8,29,88]},{index:.125,rgb:[37,52,148]},{index:.25,rgb:[34,94,168]},{index:.375,rgb:[29,145,192]},{index:.5,rgb:[65,182,196]},{index:.625,rgb:[127,205,187]},{index:.75,rgb:[199,233,180]},{index:.875,rgb:[237,248,217]},{index:1,rgb:[255,255,217]}],greens:[{index:0,rgb:[0,68,27]},{index:.125,rgb:[0,109,44]},{index:.25,rgb:[35,139,69]},{index:.375,rgb:[65,171,93]},{index:.5,rgb:[116,196,118]},{index:.625,rgb:[161,217,155]},{index:.75,rgb:[199,233,192]},{index:.875,rgb:[229,245,224]},{index:1,rgb:[247,252,245]}],yiorrd:[{index:0,rgb:[128,0,38]},{index:.125,rgb:[189,0,38]},{index:.25,rgb:[227,26,28]},{index:.375,rgb:[252,78,42]},{index:.5,rgb:[253,141,60]},{index:.625,rgb:[254,178,76]},{index:.75,rgb:[254,217,118]},{index:.875,rgb:[255,237,160]},{index:1,rgb:[255,255,204]}],bluered:[{index:0,rgb:[0,0,255]},{index:1,rgb:[255,0,0]}],rdbu:[{index:0,rgb:[5,10,172]},{index:.35,rgb:[106,137,247]},{index:.5,rgb:[190,190,190]},{index:.6,rgb:[220,170,132]},{index:.7,rgb:[230,145,90]},{index:1,rgb:[178,10,28]}],picnic:[{index:0,rgb:[0,0,255]},{index:.1,rgb:[51,153,255]},{index:.2,rgb:[102,204,255]},{index:.3,rgb:[153,204,255]},{index:.4,rgb:[204,204,255]},{index:.5,rgb:[255,255,255]},{index:.6,rgb:[255,204,255]},{index:.7,rgb:[255,153,255]},{index:.8,rgb:[255,102,204]},{index:.9,rgb:[255,102,102]},{index:1,rgb:[255,0,0]}],rainbow:[{index:0,rgb:[150,0,90]},{index:.125,rgb:[0,0,200]},{index:.25,rgb:[0,25,255]},{index:.375,rgb:[0,152,255]},{index:.5,rgb:[44,255,150]},{index:.625,rgb:[151,255,0]},{index:.75,rgb:[255,234,0]},{index:.875,rgb:[255,111,0]},{index:1,rgb:[255,0,0]}],portland:[{index:0,rgb:[12,51,131]},{index:.25,rgb:[10,136,186]},{index:.5,rgb:[242,211,56]},{index:.75,rgb:[242,143,56]},{index:1,rgb:[217,30,30]}],blackbody:[{index:0,rgb:[0,0,0]},{index:.2,rgb:[230,0,0]},{index:.4,rgb:[230,210,0]},{index:.7,rgb:[255,255,255]},{index:1,rgb:[160,200,255]}],earth:[{index:0,rgb:[0,0,130]},{index:.1,rgb:[0,180,180]},{index:.2,rgb:[40,210,40]},{index:.4,rgb:[230,230,50]},{index:.6,rgb:[120,70,20]},{index:1,rgb:[255,255,255]}],electric:[{index:0,rgb:[0,0,0]},{index:.15,rgb:[30,0,100]},{index:.4,rgb:[120,0,100]},{index:.6,rgb:[160,90,0]},{index:.8,rgb:[230,200,0]},{index:1,rgb:[255,250,220]}],alpha:[{index:0,rgb:[255,255,255,0]},{index:1,rgb:[255,255,255,1]}],viridis:[{index:0,rgb:[68,1,84]},{index:.13,rgb:[71,44,122]},{index:.25,rgb:[59,81,139]},{index:.38,rgb:[44,113,142]},{index:.5,rgb:[33,144,141]},{index:.63,rgb:[39,173,129]},{index:.75,rgb:[92,200,99]},{index:.88,rgb:[170,220,50]},{index:1,rgb:[253,231,37]}],inferno:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[31,12,72]},{index:.25,rgb:[85,15,109]},{index:.38,rgb:[136,34,106]},{index:.5,rgb:[186,54,85]},{index:.63,rgb:[227,89,51]},{index:.75,rgb:[249,140,10]},{index:.88,rgb:[249,201,50]},{index:1,rgb:[252,255,164]}],magma:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[28,16,68]},{index:.25,rgb:[79,18,123]},{index:.38,rgb:[129,37,129]},{index:.5,rgb:[181,54,122]},{index:.63,rgb:[229,80,100]},{index:.75,rgb:[251,135,97]},{index:.88,rgb:[254,194,135]},{index:1,rgb:[252,253,191]}],plasma:[{index:0,rgb:[13,8,135]},{index:.13,rgb:[75,3,161]},{index:.25,rgb:[125,3,168]},{index:.38,rgb:[168,34,150]},{index:.5,rgb:[203,70,121]},{index:.63,rgb:[229,107,93]},{index:.75,rgb:[248,148,65]},{index:.88,rgb:[253,195,40]},{index:1,rgb:[240,249,33]}],warm:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[172,0,187]},{index:.25,rgb:[219,0,170]},{index:.38,rgb:[255,0,130]},{index:.5,rgb:[255,63,74]},{index:.63,rgb:[255,123,0]},{index:.75,rgb:[234,176,0]},{index:.88,rgb:[190,228,0]},{index:1,rgb:[147,255,0]}],cool:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[116,0,218]},{index:.25,rgb:[98,74,237]},{index:.38,rgb:[68,146,231]},{index:.5,rgb:[0,204,197]},{index:.63,rgb:[0,247,146]},{index:.75,rgb:[0,255,88]},{index:.88,rgb:[40,255,8]},{index:1,rgb:[147,255,0]}],"rainbow-soft":[{index:0,rgb:[125,0,179]},{index:.1,rgb:[199,0,180]},{index:.2,rgb:[255,0,121]},{index:.3,rgb:[255,108,0]},{index:.4,rgb:[222,194,0]},{index:.5,rgb:[150,255,0]},{index:.6,rgb:[0,255,55]},{index:.7,rgb:[0,246,150]},{index:.8,rgb:[50,167,222]},{index:.9,rgb:[103,51,235]},{index:1,rgb:[124,0,186]}],bathymetry:[{index:0,rgb:[40,26,44]},{index:.13,rgb:[59,49,90]},{index:.25,rgb:[64,76,139]},{index:.38,rgb:[63,110,151]},{index:.5,rgb:[72,142,158]},{index:.63,rgb:[85,174,163]},{index:.75,rgb:[120,206,163]},{index:.88,rgb:[187,230,172]},{index:1,rgb:[253,254,204]}],cdom:[{index:0,rgb:[47,15,62]},{index:.13,rgb:[87,23,86]},{index:.25,rgb:[130,28,99]},{index:.38,rgb:[171,41,96]},{index:.5,rgb:[206,67,86]},{index:.63,rgb:[230,106,84]},{index:.75,rgb:[242,149,103]},{index:.88,rgb:[249,193,135]},{index:1,rgb:[254,237,176]}],chlorophyll:[{index:0,rgb:[18,36,20]},{index:.13,rgb:[25,63,41]},{index:.25,rgb:[24,91,59]},{index:.38,rgb:[13,119,72]},{index:.5,rgb:[18,148,80]},{index:.63,rgb:[80,173,89]},{index:.75,rgb:[132,196,122]},{index:.88,rgb:[175,221,162]},{index:1,rgb:[215,249,208]}],density:[{index:0,rgb:[54,14,36]},{index:.13,rgb:[89,23,80]},{index:.25,rgb:[110,45,132]},{index:.38,rgb:[120,77,178]},{index:.5,rgb:[120,113,213]},{index:.63,rgb:[115,151,228]},{index:.75,rgb:[134,185,227]},{index:.88,rgb:[177,214,227]},{index:1,rgb:[230,241,241]}],"freesurface-blue":[{index:0,rgb:[30,4,110]},{index:.13,rgb:[47,14,176]},{index:.25,rgb:[41,45,236]},{index:.38,rgb:[25,99,212]},{index:.5,rgb:[68,131,200]},{index:.63,rgb:[114,156,197]},{index:.75,rgb:[157,181,203]},{index:.88,rgb:[200,208,216]},{index:1,rgb:[241,237,236]}],"freesurface-red":[{index:0,rgb:[60,9,18]},{index:.13,rgb:[100,17,27]},{index:.25,rgb:[142,20,29]},{index:.38,rgb:[177,43,27]},{index:.5,rgb:[192,87,63]},{index:.63,rgb:[205,125,105]},{index:.75,rgb:[216,162,148]},{index:.88,rgb:[227,199,193]},{index:1,rgb:[241,237,236]}],oxygen:[{index:0,rgb:[64,5,5]},{index:.13,rgb:[106,6,15]},{index:.25,rgb:[144,26,7]},{index:.38,rgb:[168,64,3]},{index:.5,rgb:[188,100,4]},{index:.63,rgb:[206,136,11]},{index:.75,rgb:[220,174,25]},{index:.88,rgb:[231,215,44]},{index:1,rgb:[248,254,105]}],par:[{index:0,rgb:[51,20,24]},{index:.13,rgb:[90,32,35]},{index:.25,rgb:[129,44,34]},{index:.38,rgb:[159,68,25]},{index:.5,rgb:[182,99,19]},{index:.63,rgb:[199,134,22]},{index:.75,rgb:[212,171,35]},{index:.88,rgb:[221,210,54]},{index:1,rgb:[225,253,75]}],phase:[{index:0,rgb:[145,105,18]},{index:.13,rgb:[184,71,38]},{index:.25,rgb:[186,58,115]},{index:.38,rgb:[160,71,185]},{index:.5,rgb:[110,97,218]},{index:.63,rgb:[50,123,164]},{index:.75,rgb:[31,131,110]},{index:.88,rgb:[77,129,34]},{index:1,rgb:[145,105,18]}],salinity:[{index:0,rgb:[42,24,108]},{index:.13,rgb:[33,50,162]},{index:.25,rgb:[15,90,145]},{index:.38,rgb:[40,118,137]},{index:.5,rgb:[59,146,135]},{index:.63,rgb:[79,175,126]},{index:.75,rgb:[120,203,104]},{index:.88,rgb:[193,221,100]},{index:1,rgb:[253,239,154]}],temperature:[{index:0,rgb:[4,35,51]},{index:.13,rgb:[23,51,122]},{index:.25,rgb:[85,59,157]},{index:.38,rgb:[129,79,143]},{index:.5,rgb:[175,95,130]},{index:.63,rgb:[222,112,101]},{index:.75,rgb:[249,146,66]},{index:.88,rgb:[249,196,65]},{index:1,rgb:[232,250,91]}],turbidity:[{index:0,rgb:[34,31,27]},{index:.13,rgb:[65,50,41]},{index:.25,rgb:[98,69,52]},{index:.38,rgb:[131,89,57]},{index:.5,rgb:[161,112,59]},{index:.63,rgb:[185,140,66]},{index:.75,rgb:[202,174,88]},{index:.88,rgb:[216,209,126]},{index:1,rgb:[233,246,171]}],"velocity-blue":[{index:0,rgb:[17,32,64]},{index:.13,rgb:[35,52,116]},{index:.25,rgb:[29,81,156]},{index:.38,rgb:[31,113,162]},{index:.5,rgb:[50,144,169]},{index:.63,rgb:[87,173,176]},{index:.75,rgb:[149,196,189]},{index:.88,rgb:[203,221,211]},{index:1,rgb:[254,251,230]}],"velocity-green":[{index:0,rgb:[23,35,19]},{index:.13,rgb:[24,64,38]},{index:.25,rgb:[11,95,45]},{index:.38,rgb:[39,123,35]},{index:.5,rgb:[95,146,12]},{index:.63,rgb:[152,165,18]},{index:.75,rgb:[201,186,69]},{index:.88,rgb:[233,216,137]},{index:1,rgb:[255,253,205]}],cubehelix:[{index:0,rgb:[0,0,0]},{index:.07,rgb:[22,5,59]},{index:.13,rgb:[60,4,105]},{index:.2,rgb:[109,1,135]},{index:.27,rgb:[161,0,147]},{index:.33,rgb:[210,2,142]},{index:.4,rgb:[251,11,123]},{index:.47,rgb:[255,29,97]},{index:.53,rgb:[255,54,69]},{index:.6,rgb:[255,85,46]},{index:.67,rgb:[255,120,34]},{index:.73,rgb:[255,157,37]},{index:.8,rgb:[241,191,57]},{index:.87,rgb:[224,220,93]},{index:.93,rgb:[218,241,142]},{index:1,rgb:[227,253,198]}]}},{}],131:[function(n,z,q){"use strict";var t=n("./colorScale"),h=n("lerp");function p(o){return[o[0]/255,o[1]/255,o[2]/255,o[3]]}function l(o){for(var r,i="#",u=0;u<3;++u)i+=("00"+(r=(r=o[u]).toString(16))).substr(r.length);return i}function e(o){return"rgba("+o.join(",")+")"}z.exports=function(o){var r,i,u,s,a,c,f,g,d,m;if(o||(o={}),g=(o.nshades||72)-1,f=o.format||"hex",(c=o.colormap)||(c="jet"),typeof c=="string"){if(c=c.toLowerCase(),!t[c])throw Error(c+" not a supported colorscale");a=t[c]}else{if(!Array.isArray(c))throw Error("unsupported colormap option",c);a=c.slice()}if(a.length>g+1)throw new Error(c+" map requires nshades to be at least size "+a.length);d=Array.isArray(o.alpha)?o.alpha.length!==2?[1,1]:o.alpha.slice():typeof o.alpha=="number"?[o.alpha,o.alpha]:[1,1],r=a.map(function(A){return Math.round(A.index*g)}),d[0]=Math.min(Math.max(d[0],0),1),d[1]=Math.min(Math.max(d[1],0),1);var y=a.map(function(A,E){var M=a[E].index,b=a[E].rgb.slice();return b.length===4&&b[3]>=0&&b[3]<=1||(b[3]=d[0]+(d[1]-d[0])*M),b}),v=[];for(m=0;m<r.length-1;++m){s=r[m+1]-r[m],i=y[m],u=y[m+1];for(var T=0;T<s;T++){var w=T/s;v.push([Math.round(h(i[0],u[0],w)),Math.round(h(i[1],u[1],w)),Math.round(h(i[2],u[2],w)),h(i[3],u[3],w)])}}return v.push(a[a.length-1].rgb.concat(d[1])),f==="hex"?v=v.map(l):f==="rgbaString"?v=v.map(e):f==="float"&&(v=v.map(p)),v}},{"./colorScale":130,lerp:472}],132:[function(n,z,q){"use strict";z.exports=function(r,i,u,s){var a=t(i,u,s);if(a===0){var c=h(t(r,i,u)),f=h(t(r,i,s));if(c===f){if(c===0){var g=o(r,i,u),d=o(r,i,s);return g===d?0:g?1:-1}return 0}return f===0?c>0||o(r,i,s)?-1:1:c===0?f>0||o(r,i,u)?1:-1:h(f-c)}var m=t(r,i,u);return m>0?a>0&&t(r,i,s)>0?1:-1:m<0?a>0||t(r,i,s)>0?1:-1:t(r,i,s)>0||o(r,i,u)?1:-1};var t=n("robust-orientation"),h=n("signum"),p=n("two-sum"),l=n("robust-product"),e=n("robust-sum");function o(r,i,u){var s=p(r[0],-i[0]),a=p(r[1],-i[1]),c=p(u[0],-i[0]),f=p(u[1],-i[1]),g=e(l(s,c),l(a,f));return g[g.length-1]>=0}},{"robust-orientation":548,"robust-product":549,"robust-sum":553,signum:554,"two-sum":583}],133:[function(n,z,q){z.exports=function(p,l){var e=p.length,o=p.length-l.length;if(o)return o;switch(e){case 0:return 0;case 1:return p[0]-l[0];case 2:return p[0]+p[1]-l[0]-l[1]||t(p[0],p[1])-t(l[0],l[1]);case 3:var r=p[0]+p[1],i=l[0]+l[1];if(o=r+p[2]-(i+l[2]))return o;var u=t(p[0],p[1]),s=t(l[0],l[1]);return t(u,p[2])-t(s,l[2])||t(u+p[2],r)-t(s+l[2],i);case 4:var a=p[0],c=p[1],f=p[2],g=p[3],d=l[0],m=l[1],y=l[2],v=l[3];return a+c+f+g-(d+m+y+v)||t(a,c,f,g)-t(d,m,y,v,d)||t(a+c,a+f,a+g,c+f,c+g,f+g)-t(d+m,d+y,d+v,m+y,m+v,y+v)||t(a+c+f,a+c+g,a+f+g,c+f+g)-t(d+m+y,d+m+v,d+y+v,m+y+v);default:for(var T=p.slice().sort(h),w=l.slice().sort(h),A=0;A<e;++A)if(o=T[A]-w[A])return o;return 0}};var t=Math.min;function h(p,l){return p-l}},{}],134:[function(n,z,q){"use strict";var t=n("compare-cell"),h=n("cell-orientation");z.exports=function(p,l){return t(p,l)||h(p)-h(l)}},{"cell-orientation":117,"compare-cell":133}],135:[function(n,z,q){"use strict";var t=n("./lib/ch1d"),h=n("./lib/ch2d"),p=n("./lib/chnd");z.exports=function(l){var e=l.length;if(e===0)return[];if(e===1)return[[0]];var o=l[0].length;return o===0?[]:o===1?t(l):o===2?h(l):p(l,o)}},{"./lib/ch1d":136,"./lib/ch2d":137,"./lib/chnd":138}],136:[function(n,z,q){"use strict";z.exports=function(t){for(var h=0,p=0,l=1;l<t.length;++l)t[l][0]<t[h][0]&&(h=l),t[l][0]>t[p][0]&&(p=l);return h<p?[[h],[p]]:h>p?[[p],[h]]:[[h]]}},{}],137:[function(n,z,q){"use strict";z.exports=function(h){var p=t(h),l=p.length;if(l<=2)return[];for(var e=new Array(l),o=p[l-1],r=0;r<l;++r){var i=p[r];e[r]=[o,i],o=i}return e};var t=n("monotone-convex-hull-2d")},{"monotone-convex-hull-2d":482}],138:[function(n,z,q){"use strict";z.exports=function(p,l){try{return t(p,!0)}catch{var e=h(p);if(e.length<=l)return[];var o=function(i,u){for(var s=i.length,a=new Array(s),c=0;c<u.length;++c)a[c]=i[u[c]];var f=u.length;for(c=0;c<s;++c)u.indexOf(c)<0&&(a[f++]=i[c]);return a}(p,e);return function(i,u){for(var s=i.length,a=u.length,c=0;c<s;++c)for(var f=i[c],g=0;g<f.length;++g){var d=f[g];if(d<a)f[g]=u[d];else{d-=a;for(var m=0;m<a;++m)d>=u[m]&&(d+=1);f[g]=d}}return i}(t(o,!0),e)}};var t=n("incremental-convex-hull"),h=n("affine-hull")},{"affine-hull":67,"incremental-convex-hull":459}],139:[function(n,z,q){z.exports={AFG:"afghan",ALA:"\\b\\wland",ALB:"albania",DZA:"algeria",ASM:"^(?=.*americ).*samoa",AND:"andorra",AGO:"angola",AIA:"anguill?a",ATA:"antarctica",ATG:"antigua",ARG:"argentin",ARM:"armenia",ABW:"^(?!.*bonaire).*\\baruba",AUS:"australia",AUT:"^(?!.*hungary).*austria|\\baustri.*\\bemp",AZE:"azerbaijan",BHS:"bahamas",BHR:"bahrain",BGD:"bangladesh|^(?=.*east).*paki?stan",BRB:"barbados",BLR:"belarus|byelo",BEL:"^(?!.*luxem).*belgium",BLZ:"belize|^(?=.*british).*honduras",BEN:"benin|dahome",BMU:"bermuda",BTN:"bhutan",BOL:"bolivia",BES:"^(?=.*bonaire).*eustatius|^(?=.*carib).*netherlands|\\bbes.?islands",BIH:"herzegovina|bosnia",BWA:"botswana|bechuana",BVT:"bouvet",BRA:"brazil",IOT:"british.?indian.?ocean",BRN:"brunei",BGR:"bulgaria",BFA:"burkina|\\bfaso|upper.?volta",BDI:"burundi",CPV:"verde",KHM:"cambodia|kampuchea|khmer",CMR:"cameroon",CAN:"canada",CYM:"cayman",CAF:"\\bcentral.african.republic",TCD:"\\bchad",CHL:"\\bchile",CHN:"^(?!.*\\bmac)(?!.*\\bhong)(?!.*\\btai)(?!.*\\brep).*china|^(?=.*peo)(?=.*rep).*china",CXR:"christmas",CCK:"\\bcocos|keeling",COL:"colombia",COM:"comoro",COG:"^(?!.*\\bdem)(?!.*\\bd[\\.]?r)(?!.*kinshasa)(?!.*zaire)(?!.*belg)(?!.*l.opoldville)(?!.*free).*\\bcongo",COK:"\\bcook",CRI:"costa.?rica",CIV:"ivoire|ivory",HRV:"croatia",CUB:"\\bcuba",CUW:"^(?!.*bonaire).*\\bcura(c|\xE7)ao",CYP:"cyprus",CSK:"czechoslovakia",CZE:"^(?=.*rep).*czech|czechia|bohemia",COD:"\\bdem.*congo|congo.*\\bdem|congo.*\\bd[\\.]?r|\\bd[\\.]?r.*congo|belgian.?congo|congo.?free.?state|kinshasa|zaire|l.opoldville|drc|droc|rdc",DNK:"denmark",DJI:"djibouti",DMA:"dominica(?!n)",DOM:"dominican.rep",ECU:"ecuador",EGY:"egypt",SLV:"el.?salvador",GNQ:"guine.*eq|eq.*guine|^(?=.*span).*guinea",ERI:"eritrea",EST:"estonia",ETH:"ethiopia|abyssinia",FLK:"falkland|malvinas",FRO:"faroe|faeroe",FJI:"fiji",FIN:"finland",FRA:"^(?!.*\\bdep)(?!.*martinique).*france|french.?republic|\\bgaul",GUF:"^(?=.*french).*guiana",PYF:"french.?polynesia|tahiti",ATF:"french.?southern",GAB:"gabon",GMB:"gambia",GEO:"^(?!.*south).*georgia",DDR:"german.?democratic.?republic|democratic.?republic.*germany|east.germany",DEU:"^(?!.*east).*germany|^(?=.*\\bfed.*\\brep).*german",GHA:"ghana|gold.?coast",GIB:"gibraltar",GRC:"greece|hellenic|hellas",GRL:"greenland",GRD:"grenada",GLP:"guadeloupe",GUM:"\\bguam",GTM:"guatemala",GGY:"guernsey",GIN:"^(?!.*eq)(?!.*span)(?!.*bissau)(?!.*portu)(?!.*new).*guinea",GNB:"bissau|^(?=.*portu).*guinea",GUY:"guyana|british.?guiana",HTI:"haiti",HMD:"heard.*mcdonald",VAT:"holy.?see|vatican|papal.?st",HND:"^(?!.*brit).*honduras",HKG:"hong.?kong",HUN:"^(?!.*austr).*hungary",ISL:"iceland",IND:"india(?!.*ocea)",IDN:"indonesia",IRN:"\\biran|persia",IRQ:"\\biraq|mesopotamia",IRL:"(^ireland)|(^republic.*ireland)",IMN:"^(?=.*isle).*\\bman",ISR:"israel",ITA:"italy",JAM:"jamaica",JPN:"japan",JEY:"jersey",JOR:"jordan",KAZ:"kazak",KEN:"kenya|british.?east.?africa|east.?africa.?prot",KIR:"kiribati",PRK:"^(?=.*democrat|people|north|d.*p.*.r).*\\bkorea|dprk|korea.*(d.*p.*r)",KWT:"kuwait",KGZ:"kyrgyz|kirghiz",LAO:"\\blaos?\\b",LVA:"latvia",LBN:"lebanon",LSO:"lesotho|basuto",LBR:"liberia",LBY:"libya",LIE:"liechtenstein",LTU:"lithuania",LUX:"^(?!.*belg).*luxem",MAC:"maca(o|u)",MDG:"madagascar|malagasy",MWI:"malawi|nyasa",MYS:"malaysia",MDV:"maldive",MLI:"\\bmali\\b",MLT:"\\bmalta",MHL:"marshall",MTQ:"martinique",MRT:"mauritania",MUS:"mauritius",MYT:"\\bmayotte",MEX:"\\bmexic",FSM:"fed.*micronesia|micronesia.*fed",MCO:"monaco",MNG:"mongolia",MNE:"^(?!.*serbia).*montenegro",MSR:"montserrat",MAR:"morocco|\\bmaroc",MOZ:"mozambique",MMR:"myanmar|burma",NAM:"namibia",NRU:"nauru",NPL:"nepal",NLD:"^(?!.*\\bant)(?!.*\\bcarib).*netherlands",ANT:"^(?=.*\\bant).*(nether|dutch)",NCL:"new.?caledonia",NZL:"new.?zealand",NIC:"nicaragua",NER:"\\bniger(?!ia)",NGA:"nigeria",NIU:"niue",NFK:"norfolk",MNP:"mariana",NOR:"norway",OMN:"\\boman|trucial",PAK:"^(?!.*east).*paki?stan",PLW:"palau",PSE:"palestin|\\bgaza|west.?bank",PAN:"panama",PNG:"papua|new.?guinea",PRY:"paraguay",PER:"peru",PHL:"philippines",PCN:"pitcairn",POL:"poland",PRT:"portugal",PRI:"puerto.?rico",QAT:"qatar",KOR:"^(?!.*d.*p.*r)(?!.*democrat)(?!.*people)(?!.*north).*\\bkorea(?!.*d.*p.*r)",MDA:"moldov|b(a|e)ssarabia",REU:"r(e|\xE9)union",ROU:"r(o|u|ou)mania",RUS:"\\brussia|soviet.?union|u\\.?s\\.?s\\.?r|socialist.?republics",RWA:"rwanda",BLM:"barth(e|\xE9)lemy",SHN:"helena",KNA:"kitts|\\bnevis",LCA:"\\blucia",MAF:"^(?=.*collectivity).*martin|^(?=.*france).*martin(?!ique)|^(?=.*french).*martin(?!ique)",SPM:"miquelon",VCT:"vincent",WSM:"^(?!.*amer).*samoa",SMR:"san.?marino",STP:"\\bs(a|\xE3)o.?tom(e|\xE9)",SAU:"\\bsa\\w*.?arabia",SEN:"senegal",SRB:"^(?!.*monte).*serbia",SYC:"seychell",SLE:"sierra",SGP:"singapore",SXM:"^(?!.*martin)(?!.*saba).*maarten",SVK:"^(?!.*cze).*slovak",SVN:"slovenia",SLB:"solomon",SOM:"somali",ZAF:"south.africa|s\\\\..?africa",SGS:"south.?georgia|sandwich",SSD:"\\bs\\w*.?sudan",ESP:"spain",LKA:"sri.?lanka|ceylon",SDN:"^(?!.*\\bs(?!u)).*sudan",SUR:"surinam|dutch.?guiana",SJM:"svalbard",SWZ:"swaziland",SWE:"sweden",CHE:"switz|swiss",SYR:"syria",TWN:"taiwan|taipei|formosa|^(?!.*peo)(?=.*rep).*china",TJK:"tajik",THA:"thailand|\\bsiam",MKD:"macedonia|fyrom",TLS:"^(?=.*leste).*timor|^(?=.*east).*timor",TGO:"togo",TKL:"tokelau",TON:"tonga",TTO:"trinidad|tobago",TUN:"tunisia",TUR:"turkey",TKM:"turkmen",TCA:"turks",TUV:"tuvalu",UGA:"uganda",UKR:"ukrain",ARE:"emirates|^u\\.?a\\.?e\\.?$|united.?arab.?em",GBR:"united.?kingdom|britain|^u\\.?k\\.?$",TZA:"tanzania",USA:"united.?states\\b(?!.*islands)|\\bu\\.?s\\.?a\\.?\\b|^\\s*u\\.?s\\.?\\b(?!.*islands)",UMI:"minor.?outlying.?is",URY:"uruguay",UZB:"uzbek",VUT:"vanuatu|new.?hebrides",VEN:"venezuela",VNM:"^(?!.*republic).*viet.?nam|^(?=.*socialist).*viet.?nam",VGB:"^(?=.*\\bu\\.?\\s?k).*virgin|^(?=.*brit).*virgin|^(?=.*kingdom).*virgin",VIR:"^(?=.*\\bu\\.?\\s?s).*virgin|^(?=.*states).*virgin",WLF:"futuna|wallis",ESH:"western.sahara",YEM:"^(?!.*arab)(?!.*north)(?!.*sana)(?!.*peo)(?!.*dem)(?!.*south)(?!.*aden)(?!.*\\bp\\.?d\\.?r).*yemen",YMD:"^(?=.*peo).*yemen|^(?!.*rep)(?=.*dem).*yemen|^(?=.*south).*yemen|^(?=.*aden).*yemen|^(?=.*\\bp\\.?d\\.?r).*yemen",YUG:"yugoslavia",ZMB:"zambia|northern.?rhodesia",EAZ:"zanzibar",ZWE:"zimbabwe|^(?!.*northern).*rhodesia"}},{}],140:[function(n,z,q){z.exports=["xx-small","x-small","small","medium","large","x-large","xx-large","larger","smaller"]},{}],141:[function(n,z,q){z.exports=["normal","condensed","semi-condensed","extra-condensed","ultra-condensed","expanded","semi-expanded","extra-expanded","ultra-expanded"]},{}],142:[function(n,z,q){z.exports=["normal","italic","oblique"]},{}],143:[function(n,z,q){z.exports=["normal","bold","bolder","lighter","100","200","300","400","500","600","700","800","900"]},{}],144:[function(n,z,q){"use strict";z.exports={parse:n("./parse"),stringify:n("./stringify")}},{"./parse":146,"./stringify":147}],145:[function(n,z,q){"use strict";var t=n("css-font-size-keywords");z.exports={isSize:function(h){return/^[\d\.]/.test(h)||h.indexOf("/")!==-1||t.indexOf(h)!==-1}}},{"css-font-size-keywords":140}],146:[function(n,z,q){"use strict";var t=n("unquote"),h=n("css-global-keywords"),p=n("css-system-font-keywords"),l=n("css-font-weight-keywords"),e=n("css-font-style-keywords"),o=n("css-font-stretch-keywords"),r=n("string-split-by"),i=n("./lib/util").isSize;z.exports=s;var u=s.cache={};function s(c){if(typeof c!="string")throw new Error("Font argument must be a string.");if(u[c])return u[c];if(c==="")throw new Error("Cannot parse an empty string.");if(p.indexOf(c)!==-1)return u[c]={system:c};for(var f,g={style:"normal",variant:"normal",weight:"normal",stretch:"normal",lineHeight:"normal",size:"1rem",family:["serif"]},d=r(c,/\s+/);f=d.shift();){if(h.indexOf(f)!==-1)return["style","variant","weight","stretch"].forEach(function(y){g[y]=f}),u[c]=g;if(e.indexOf(f)===-1)if(f!=="normal"&&f!=="small-caps")if(o.indexOf(f)===-1){if(l.indexOf(f)===-1){if(i(f)){var m=r(f,"/");if(g.size=m[0],m[1]!=null?g.lineHeight=a(m[1]):d[0]==="/"&&(d.shift(),g.lineHeight=a(d.shift())),!d.length)throw new Error("Missing required font-family.");return g.family=r(d.join(" "),/\s*,\s*/).map(t),u[c]=g}throw new Error("Unknown or unsupported font token: "+f)}g.weight=f}else g.stretch=f;else g.variant=f;else g.style=f}throw new Error("Missing required font-size.")}function a(c){var f=parseFloat(c);return f.toString()===c?f:c}},{"./lib/util":145,"css-font-stretch-keywords":141,"css-font-style-keywords":142,"css-font-weight-keywords":143,"css-global-keywords":148,"css-system-font-keywords":149,"string-split-by":568,unquote:598}],147:[function(n,z,q){"use strict";var t=n("pick-by-alias"),h=n("./lib/util").isSize,p=f(n("css-global-keywords")),l=f(n("css-system-font-keywords")),e=f(n("css-font-weight-keywords")),o=f(n("css-font-style-keywords")),r=f(n("css-font-stretch-keywords")),i={normal:1,"small-caps":1},u={serif:1,"sans-serif":1,monospace:1,cursive:1,fantasy:1,"system-ui":1},s="1rem",a="serif";function c(g,d){if(g&&!d[g]&&!p[g])throw Error("Unknown keyword `"+g+"`");return g}function f(g){for(var d={},m=0;m<g.length;m++)d[g[m]]=1;return d}z.exports=function(g){if((g=t(g,{style:"style fontstyle fontStyle font-style slope distinction",variant:"variant font-variant fontVariant fontvariant var capitalization",weight:"weight w font-weight fontWeight fontweight",stretch:"stretch font-stretch fontStretch fontstretch width",size:"size s font-size fontSize fontsize height em emSize",lineHeight:"lh line-height lineHeight lineheight leading",family:"font family fontFamily font-family fontfamily type typeface face",system:"system reserved default global"})).system)return g.system&&c(g.system,l),g.system;if(c(g.style,o),c(g.variant,i),c(g.weight,e),c(g.stretch,r),g.size==null&&(g.size=s),typeof g.size=="number"&&(g.size+="px"),!h)throw Error("Bad size value `"+g.size+"`");g.family||(g.family=a),Array.isArray(g.family)&&(g.family.length||(g.family=[a]),g.family=g.family.map(function(m){return u[m]?m:'"'+m+'"'}).join(", "));var d=[];return d.push(g.style),g.variant!==g.style&&d.push(g.variant),g.weight!==g.variant&&g.weight!==g.style&&d.push(g.weight),g.stretch!==g.weight&&g.stretch!==g.variant&&g.stretch!==g.style&&d.push(g.stretch),d.push(g.size+(g.lineHeight==null||g.lineHeight==="normal"||g.lineHeight+""=="1"?"":"/"+g.lineHeight)),d.push(g.family),d.filter(Boolean).join(" ")}},{"./lib/util":145,"css-font-stretch-keywords":141,"css-font-style-keywords":142,"css-font-weight-keywords":143,"css-global-keywords":148,"css-system-font-keywords":149,"pick-by-alias":511}],148:[function(n,z,q){z.exports=["inherit","initial","unset"]},{}],149:[function(n,z,q){z.exports=["caption","icon","menu","message-box","small-caption","status-bar"]},{}],150:[function(n,z,q){"use strict";z.exports=function(t,h,p,l,e,o){var r=e-1,i=e*e,u=r*r,s=(1+2*e)*u,a=e*u,c=i*(3-2*e),f=i*r;if(t.length){o||(o=new Array(t.length));for(var g=t.length-1;g>=0;--g)o[g]=s*t[g]+a*h[g]+c*p[g]+f*l[g];return o}return s*t+a*h+c*p+f*l},z.exports.derivative=function(t,h,p,l,e,o){var r=6*e*e-6*e,i=3*e*e-4*e+1,u=-6*e*e+6*e,s=3*e*e-2*e;if(t.length){o||(o=new Array(t.length));for(var a=t.length-1;a>=0;--a)o[a]=r*t[a]+i*h[a]+u*p[a]+s*l[a];return o}return r*t+i*h+u*p[a]+s*l}},{}],151:[function(n,z,q){"use strict";var t=n("./lib/thunk.js");function h(){this.argTypes=[],this.shimArgs=[],this.arrayArgs=[],this.arrayBlockIndices=[],this.scalarArgs=[],this.offsetArgs=[],this.offsetArgIndex=[],this.indexArgs=[],this.shapeArgs=[],this.funcName="",this.pre=null,this.body=null,this.post=null,this.debug=!1}z.exports=function(p){var l=new h;l.pre=p.pre,l.body=p.body,l.post=p.post;var e=p.args.slice(0);l.argTypes=e;for(var o=0;o<e.length;++o){var r=e[o];if(r==="array"||typeof r=="object"&&r.blockIndices){if(l.argTypes[o]="array",l.arrayArgs.push(o),l.arrayBlockIndices.push(r.blockIndices?r.blockIndices:0),l.shimArgs.push("array"+o),o<l.pre.args.length&&l.pre.args[o].count>0)throw new Error("cwise: pre() block may not reference array args");if(o<l.post.args.length&&l.post.args[o].count>0)throw new Error("cwise: post() block may not reference array args")}else if(r==="scalar")l.scalarArgs.push(o),l.shimArgs.push("scalar"+o);else if(r==="index"){if(l.indexArgs.push(o),o<l.pre.args.length&&l.pre.args[o].count>0)throw new Error("cwise: pre() block may not reference array index");if(o<l.body.args.length&&l.body.args[o].lvalue)throw new Error("cwise: body() block may not write to array index");if(o<l.post.args.length&&l.post.args[o].count>0)throw new Error("cwise: post() block may not reference array index")}else if(r==="shape"){if(l.shapeArgs.push(o),o<l.pre.args.length&&l.pre.args[o].lvalue)throw new Error("cwise: pre() block may not write to array shape");if(o<l.body.args.length&&l.body.args[o].lvalue)throw new Error("cwise: body() block may not write to array shape");if(o<l.post.args.length&&l.post.args[o].lvalue)throw new Error("cwise: post() block may not write to array shape")}else{if(typeof r!="object"||!r.offset)throw new Error("cwise: Unknown argument type "+e[o]);l.argTypes[o]="offset",l.offsetArgs.push({array:r.array,offset:r.offset}),l.offsetArgIndex.push(o)}}if(l.arrayArgs.length<=0)throw new Error("cwise: No array arguments specified");if(l.pre.args.length>e.length)throw new Error("cwise: Too many arguments in pre() block");if(l.body.args.length>e.length)throw new Error("cwise: Too many arguments in body() block");if(l.post.args.length>e.length)throw new Error("cwise: Too many arguments in post() block");return l.debug=!!p.printCode||!!p.debug,l.funcName=p.funcName||"cwise",l.blockSize=p.blockSize||64,t(l)}},{"./lib/thunk.js":153}],152:[function(n,z,q){"use strict";var t=n("uniq");function h(e,o,r){var i,u,s=e.length,a=o.arrayArgs.length,c=o.indexArgs.length>0,f=[],g=[],d=0,m=0;for(i=0;i<s;++i)g.push(["i",i,"=0"].join(""));for(u=0;u<a;++u)for(i=0;i<s;++i)m=d,d=e[i],i===0?g.push(["d",u,"s",i,"=t",u,"p",d].join("")):g.push(["d",u,"s",i,"=(t",u,"p",d,"-s",m,"*t",u,"p",m,")"].join(""));for(g.length>0&&f.push("var "+g.join(",")),i=s-1;i>=0;--i)d=e[i],f.push(["for(i",i,"=0;i",i,"<s",d,";++i",i,"){"].join(""));for(f.push(r),i=0;i<s;++i){for(m=d,d=e[i],u=0;u<a;++u)f.push(["p",u,"+=d",u,"s",i].join(""));c&&(i>0&&f.push(["index[",m,"]-=s",m].join("")),f.push(["++index[",d,"]"].join(""))),f.push("}")}return f.join(`
`)}function p(e,o,r){for(var i=e.body,u=[],s=[],a=0;a<e.args.length;++a){var c=e.args[a];if(!(c.count<=0)){var f=new RegExp(c.name,"g"),g="",d=o.arrayArgs.indexOf(a);switch(o.argTypes[a]){case"offset":var m=o.offsetArgIndex.indexOf(a);d=o.offsetArgs[m].array,g="+q"+m;case"array":g="p"+d+g;var y="l"+a,v="a"+d;if(o.arrayBlockIndices[d]===0)c.count===1?r[d]==="generic"?c.lvalue?(u.push(["var ",y,"=",v,".get(",g,")"].join("")),i=i.replace(f,y),s.push([v,".set(",g,",",y,")"].join(""))):i=i.replace(f,[v,".get(",g,")"].join("")):i=i.replace(f,[v,"[",g,"]"].join("")):r[d]==="generic"?(u.push(["var ",y,"=",v,".get(",g,")"].join("")),i=i.replace(f,y),c.lvalue&&s.push([v,".set(",g,",",y,")"].join(""))):(u.push(["var ",y,"=",v,"[",g,"]"].join("")),i=i.replace(f,y),c.lvalue&&s.push([v,"[",g,"]=",y].join("")));else{for(var T=[c.name],w=[g],A=0;A<Math.abs(o.arrayBlockIndices[d]);A++)T.push("\\s*\\[([^\\]]+)\\]"),w.push("$"+(A+1)+"*t"+d+"b"+A);if(f=new RegExp(T.join(""),"g"),g=w.join("+"),r[d]==="generic")throw new Error("cwise: Generic arrays not supported in combination with blocks!");i=i.replace(f,[v,"[",g,"]"].join(""))}break;case"scalar":i=i.replace(f,"Y"+o.scalarArgs.indexOf(a));break;case"index":i=i.replace(f,"index");break;case"shape":i=i.replace(f,"shape")}}}return[u.join(`
`),i,s.join(`
`)].join(`
`).trim()}function l(e){for(var o=new Array(e.length),r=!0,i=0;i<e.length;++i){var u=e[i],s=u.match(/\d+/);s=s?s[0]:"",u.charAt(0)===0?o[i]="u"+u.charAt(1)+s:o[i]=u.charAt(0)+s,i>0&&(r=r&&o[i]===o[i-1])}return r?o[0]:o.join("")}z.exports=function(e,o){for(var r=o[1].length-Math.abs(e.arrayBlockIndices[0])|0,i=new Array(e.arrayArgs.length),u=new Array(e.arrayArgs.length),s=0;s<e.arrayArgs.length;++s)u[s]=o[2*s],i[s]=o[2*s+1];var a=[],c=[],f=[],g=[],d=[];for(s=0;s<e.arrayArgs.length;++s){e.arrayBlockIndices[s]<0?(f.push(0),g.push(r),a.push(r),c.push(r+e.arrayBlockIndices[s])):(f.push(e.arrayBlockIndices[s]),g.push(e.arrayBlockIndices[s]+r),a.push(0),c.push(e.arrayBlockIndices[s]));for(var m=[],y=0;y<i[s].length;y++)f[s]<=i[s][y]&&i[s][y]<g[s]&&m.push(i[s][y]-f[s]);d.push(m)}var v=["SS"],T=["'use strict'"],w=[];for(y=0;y<r;++y)w.push(["s",y,"=SS[",y,"]"].join(""));for(s=0;s<e.arrayArgs.length;++s){for(v.push("a"+s),v.push("t"+s),v.push("p"+s),y=0;y<r;++y)w.push(["t",s,"p",y,"=t",s,"[",f[s]+y,"]"].join(""));for(y=0;y<Math.abs(e.arrayBlockIndices[s]);++y)w.push(["t",s,"b",y,"=t",s,"[",a[s]+y,"]"].join(""))}for(s=0;s<e.scalarArgs.length;++s)v.push("Y"+s);if(e.shapeArgs.length>0&&w.push("shape=SS.slice(0)"),e.indexArgs.length>0){var A=new Array(r);for(s=0;s<r;++s)A[s]="0";w.push(["index=[",A.join(","),"]"].join(""))}for(s=0;s<e.offsetArgs.length;++s){var E=e.offsetArgs[s],M=[];for(y=0;y<E.offset.length;++y)E.offset[y]!==0&&(E.offset[y]===1?M.push(["t",E.array,"p",y].join("")):M.push([E.offset[y],"*t",E.array,"p",y].join("")));M.length===0?w.push("q"+s+"=0"):w.push(["q",s,"=",M.join("+")].join(""))}var b=t([].concat(e.pre.thisVars).concat(e.body.thisVars).concat(e.post.thisVars));for((w=w.concat(b)).length>0&&T.push("var "+w.join(",")),s=0;s<e.arrayArgs.length;++s)T.push("p"+s+"|=0");e.pre.body.length>3&&T.push(p(e.pre,e,u));var _=p(e.body,e,u),S=function(k){for(var L=0,I=k[0].length;L<I;){for(var R=1;R<k.length;++R)if(k[R][L]!==k[0][L])return L;++L}return L}(d);S<r?T.push(function(k,L,I,R){for(var V=L.length,O=I.arrayArgs.length,J=I.blockSize,D=I.indexArgs.length>0,B=[],N=0;N<O;++N)B.push(["var offset",N,"=p",N].join(""));for(N=k;N<V;++N)B.push(["for(var j"+N+"=SS[",L[N],"]|0;j",N,">0;){"].join("")),B.push(["if(j",N,"<",J,"){"].join("")),B.push(["s",L[N],"=j",N].join("")),B.push(["j",N,"=0"].join("")),B.push(["}else{s",L[N],"=",J].join("")),B.push(["j",N,"-=",J,"}"].join("")),D&&B.push(["index[",L[N],"]=j",N].join(""));for(N=0;N<O;++N){for(var F=["offset"+N],H=k;H<V;++H)F.push(["j",H,"*t",N,"p",L[H]].join(""));B.push(["p",N,"=(",F.join("+"),")"].join(""))}for(B.push(h(L,I,R)),N=k;N<V;++N)B.push("}");return B.join(`
`)}(S,d[0],e,_)):T.push(h(d[0],e,_)),e.post.body.length>3&&T.push(p(e.post,e,u)),e.debug&&console.log("-----Generated cwise routine for ",o,`:
`+T.join(`
`)+`
----------`);var C=[e.funcName||"unnamed","_cwise_loop_",i[0].join("s"),"m",S,l(u)].join("");return new Function(["function ",C,"(",v.join(","),"){",T.join(`
`),"} return ",C].join(""))()}},{uniq:597}],153:[function(n,z,q){"use strict";var t=n("./compile.js");z.exports=function(h){var p=["'use strict'","var CACHED={}"],l=[],e=h.funcName+"_cwise_thunk";p.push(["return function ",e,"(",h.shimArgs.join(","),"){"].join(""));for(var o=[],r=[],i=[["array",h.arrayArgs[0],".shape.slice(",Math.max(0,h.arrayBlockIndices[0]),h.arrayBlockIndices[0]<0?","+h.arrayBlockIndices[0]+")":")"].join("")],u=[],s=[],a=0;a<h.arrayArgs.length;++a){var c=h.arrayArgs[a];l.push(["t",c,"=array",c,".dtype,","r",c,"=array",c,".order"].join("")),o.push("t"+c),o.push("r"+c),r.push("t"+c),r.push("r"+c+".join()"),i.push("array"+c+".data"),i.push("array"+c+".stride"),i.push("array"+c+".offset|0"),a>0&&(u.push("array"+h.arrayArgs[0]+".shape.length===array"+c+".shape.length+"+(Math.abs(h.arrayBlockIndices[0])-Math.abs(h.arrayBlockIndices[a]))),s.push("array"+h.arrayArgs[0]+".shape[shapeIndex+"+Math.max(0,h.arrayBlockIndices[0])+"]===array"+c+".shape[shapeIndex+"+Math.max(0,h.arrayBlockIndices[a])+"]"))}for(h.arrayArgs.length>1&&(p.push("if (!("+u.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same dimensionality!')"),p.push("for(var shapeIndex=array"+h.arrayArgs[0]+".shape.length-"+Math.abs(h.arrayBlockIndices[0])+"; shapeIndex-->0;) {"),p.push("if (!("+s.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same shape!')"),p.push("}")),a=0;a<h.scalarArgs.length;++a)i.push("scalar"+h.scalarArgs[a]);return l.push(["type=[",r.join(","),"].join()"].join("")),l.push("proc=CACHED[type]"),p.push("var "+l.join(",")),p.push(["if(!proc){","CACHED[type]=proc=compile([",o.join(","),"])}","return proc(",i.join(","),")}"].join("")),h.debug&&console.log(`-----Generated thunk:
`+p.join(`
`)+`
----------`),new Function("compile",p.join(`
`))(t.bind(void 0,h))}},{"./compile.js":152}],154:[function(n,z,q){"use strict";var t,h=n("type/value/is"),p=n("type/value/ensure"),l=n("type/plain-function/ensure"),e=n("es5-ext/object/copy"),o=n("es5-ext/object/normalize-options"),r=n("es5-ext/object/map"),i=Function.prototype.bind,u=Object.defineProperty,s=Object.prototype.hasOwnProperty;t=function(a,c,f){var g,d=p(c)&&l(c.value);return delete(g=e(c)).writable,delete g.value,g.get=function(){return!f.overwriteDefinition&&s.call(this,a)?d:(c.value=i.call(d,f.resolveContext?f.resolveContext(this):this),u(this,a,c),this[a])},g},z.exports=function(a){var c=o(arguments[1]);return h(c.resolveContext)&&l(c.resolveContext),r(a,function(f,g){return t(g,f,c)})}},{"es5-ext/object/copy":196,"es5-ext/object/map":204,"es5-ext/object/normalize-options":205,"type/plain-function/ensure":589,"type/value/ensure":593,"type/value/is":594}],155:[function(n,z,q){"use strict";var t=n("type/value/is"),h=n("type/plain-function/is"),p=n("es5-ext/object/assign"),l=n("es5-ext/object/normalize-options"),e=n("es5-ext/string/#/contains");(z.exports=function(o,r){var i,u,s,a,c;return arguments.length<2||typeof o!="string"?(a=r,r=o,o=null):a=arguments[2],t(o)?(i=e.call(o,"c"),u=e.call(o,"e"),s=e.call(o,"w")):(i=s=!0,u=!1),c={value:r,configurable:i,enumerable:u,writable:s},a?p(l(a),c):c}).gs=function(o,r,i){var u,s,a,c;return typeof o!="string"?(a=i,i=r,r=o,o=null):a=arguments[3],t(r)?h(r)?t(i)?h(i)||(a=i,i=void 0):i=void 0:(a=r,r=i=void 0):r=void 0,t(o)?(u=e.call(o,"c"),s=e.call(o,"e")):(u=!0,s=!1),c={get:r,set:i,configurable:u,enumerable:s},a?p(l(a),c):c}},{"es5-ext/object/assign":193,"es5-ext/object/normalize-options":205,"es5-ext/string/#/contains":212,"type/plain-function/is":590,"type/value/is":594}],156:[function(n,z,q){(function(t,h){h(typeof q=="object"&&typeof z<"u"?q:t.d3=t.d3||{})})(this,function(t){"use strict";function h(k,L){return k<L?-1:k>L?1:k>=L?0:NaN}function p(k){var L;return k.length===1&&(L=k,k=function(I,R){return h(L(I),R)}),{left:function(I,R,V,O){for(V==null&&(V=0),O==null&&(O=I.length);V<O;){var J=V+O>>>1;k(I[J],R)<0?V=J+1:O=J}return V},right:function(I,R,V,O){for(V==null&&(V=0),O==null&&(O=I.length);V<O;){var J=V+O>>>1;k(I[J],R)>0?O=J:V=J+1}return V}}}var l=p(h),e=l.right,o=l.left;function r(k,L){return[k,L]}function i(k){return k===null?NaN:+k}function u(k,L){var I,R,V=k.length,O=0,J=-1,D=0,B=0;if(L==null)for(;++J<V;)isNaN(I=i(k[J]))||(B+=(R=I-D)*(I-(D+=R/++O)));else for(;++J<V;)isNaN(I=i(L(k[J],J,k)))||(B+=(R=I-D)*(I-(D+=R/++O)));if(O>1)return B/(O-1)}function s(k,L){var I=u(k,L);return I&&Math.sqrt(I)}function a(k,L){var I,R,V,O=k.length,J=-1;if(L==null){for(;++J<O;)if((I=k[J])!=null&&I>=I)for(R=V=I;++J<O;)(I=k[J])!=null&&(R>I&&(R=I),V<I&&(V=I))}else for(;++J<O;)if((I=L(k[J],J,k))!=null&&I>=I)for(R=V=I;++J<O;)(I=L(k[J],J,k))!=null&&(R>I&&(R=I),V<I&&(V=I));return[R,V]}var c=Array.prototype,f=c.slice,g=c.map;function d(k){return function(){return k}}function m(k){return k}function y(k,L,I){k=+k,L=+L,I=(V=arguments.length)<2?(L=k,k=0,1):V<3?1:+I;for(var R=-1,V=0|Math.max(0,Math.ceil((L-k)/I)),O=new Array(V);++R<V;)O[R]=k+R*I;return O}var v=Math.sqrt(50),T=Math.sqrt(10),w=Math.sqrt(2);function A(k,L,I){var R=(L-k)/Math.max(0,I),V=Math.floor(Math.log(R)/Math.LN10),O=R/Math.pow(10,V);return V>=0?(O>=v?10:O>=T?5:O>=w?2:1)*Math.pow(10,V):-Math.pow(10,-V)/(O>=v?10:O>=T?5:O>=w?2:1)}function E(k,L,I){var R=Math.abs(L-k)/Math.max(0,I),V=Math.pow(10,Math.floor(Math.log(R)/Math.LN10)),O=R/V;return O>=v?V*=10:O>=T?V*=5:O>=w&&(V*=2),L<k?-V:V}function M(k){return Math.ceil(Math.log(k.length)/Math.LN2)+1}function b(k,L,I){if(I==null&&(I=i),R=k.length){if((L=+L)<=0||R<2)return+I(k[0],0,k);if(L>=1)return+I(k[R-1],R-1,k);var R,V=(R-1)*L,O=Math.floor(V),J=+I(k[O],O,k);return J+(+I(k[O+1],O+1,k)-J)*(V-O)}}function _(k,L){var I,R,V=k.length,O=-1;if(L==null){for(;++O<V;)if((I=k[O])!=null&&I>=I)for(R=I;++O<V;)(I=k[O])!=null&&R>I&&(R=I)}else for(;++O<V;)if((I=L(k[O],O,k))!=null&&I>=I)for(R=I;++O<V;)(I=L(k[O],O,k))!=null&&R>I&&(R=I);return R}function S(k){if(!(V=k.length))return[];for(var L=-1,I=_(k,C),R=new Array(I);++L<I;)for(var V,O=-1,J=R[L]=new Array(V);++O<V;)J[O]=k[O][L];return R}function C(k){return k.length}t.bisect=e,t.bisectRight=e,t.bisectLeft=o,t.ascending=h,t.bisector=p,t.cross=function(k,L,I){var R,V,O,J,D=k.length,B=L.length,N=new Array(D*B);for(I==null&&(I=r),R=O=0;R<D;++R)for(J=k[R],V=0;V<B;++V,++O)N[O]=I(J,L[V]);return N},t.descending=function(k,L){return L<k?-1:L>k?1:L>=k?0:NaN},t.deviation=s,t.extent=a,t.histogram=function(){var k=m,L=a,I=M;function R(V){var O,J,D=V.length,B=new Array(D);for(O=0;O<D;++O)B[O]=k(V[O],O,V);var N=L(B),F=N[0],H=N[1],j=I(B,F,H);Array.isArray(j)||(j=E(F,H,j),j=y(Math.ceil(F/j)*j,H,j));for(var G=j.length;j[0]<=F;)j.shift(),--G;for(;j[G-1]>H;)j.pop(),--G;var W,Q=new Array(G+1);for(O=0;O<=G;++O)(W=Q[O]=[]).x0=O>0?j[O-1]:F,W.x1=O<G?j[O]:H;for(O=0;O<D;++O)F<=(J=B[O])&&J<=H&&Q[e(j,J,0,G)].push(V[O]);return Q}return R.value=function(V){return arguments.length?(k=typeof V=="function"?V:d(V),R):k},R.domain=function(V){return arguments.length?(L=typeof V=="function"?V:d([V[0],V[1]]),R):L},R.thresholds=function(V){return arguments.length?(I=typeof V=="function"?V:Array.isArray(V)?d(f.call(V)):d(V),R):I},R},t.thresholdFreedmanDiaconis=function(k,L,I){return k=g.call(k,i).sort(h),Math.ceil((I-L)/(2*(b(k,.75)-b(k,.25))*Math.pow(k.length,-1/3)))},t.thresholdScott=function(k,L,I){return Math.ceil((I-L)/(3.5*s(k)*Math.pow(k.length,-1/3)))},t.thresholdSturges=M,t.max=function(k,L){var I,R,V=k.length,O=-1;if(L==null){for(;++O<V;)if((I=k[O])!=null&&I>=I)for(R=I;++O<V;)(I=k[O])!=null&&I>R&&(R=I)}else for(;++O<V;)if((I=L(k[O],O,k))!=null&&I>=I)for(R=I;++O<V;)(I=L(k[O],O,k))!=null&&I>R&&(R=I);return R},t.mean=function(k,L){var I,R=k.length,V=R,O=-1,J=0;if(L==null)for(;++O<R;)isNaN(I=i(k[O]))?--V:J+=I;else for(;++O<R;)isNaN(I=i(L(k[O],O,k)))?--V:J+=I;if(V)return J/V},t.median=function(k,L){var I,R=k.length,V=-1,O=[];if(L==null)for(;++V<R;)isNaN(I=i(k[V]))||O.push(I);else for(;++V<R;)isNaN(I=i(L(k[V],V,k)))||O.push(I);return b(O.sort(h),.5)},t.merge=function(k){for(var L,I,R,V=k.length,O=-1,J=0;++O<V;)J+=k[O].length;for(I=new Array(J);--V>=0;)for(L=(R=k[V]).length;--L>=0;)I[--J]=R[L];return I},t.min=_,t.pairs=function(k,L){L==null&&(L=r);for(var I=0,R=k.length-1,V=k[0],O=new Array(R<0?0:R);I<R;)O[I]=L(V,V=k[++I]);return O},t.permute=function(k,L){for(var I=L.length,R=new Array(I);I--;)R[I]=k[L[I]];return R},t.quantile=b,t.range=y,t.scan=function(k,L){if(I=k.length){var I,R,V=0,O=0,J=k[O];for(L==null&&(L=h);++V<I;)(L(R=k[V],J)<0||L(J,J)!==0)&&(J=R,O=V);return L(J,J)===0?O:void 0}},t.shuffle=function(k,L,I){for(var R,V,O=(I??k.length)-(L=L==null?0:+L);O;)V=Math.random()*O--|0,R=k[O+L],k[O+L]=k[V+L],k[V+L]=R;return k},t.sum=function(k,L){var I,R=k.length,V=-1,O=0;if(L==null)for(;++V<R;)(I=+k[V])&&(O+=I);else for(;++V<R;)(I=+L(k[V],V,k))&&(O+=I);return O},t.ticks=function(k,L,I){var R,V,O,J,D=-1;if(I=+I,(k=+k)==(L=+L)&&I>0)return[k];if((R=L<k)&&(V=k,k=L,L=V),(J=A(k,L,I))===0||!isFinite(J))return[];if(J>0)for(k=Math.ceil(k/J),L=Math.floor(L/J),O=new Array(V=Math.ceil(L-k+1));++D<V;)O[D]=(k+D)*J;else for(k=Math.floor(k*J),L=Math.ceil(L*J),O=new Array(V=Math.ceil(k-L+1));++D<V;)O[D]=(k-D)/J;return R&&O.reverse(),O},t.tickIncrement=A,t.tickStep=E,t.transpose=S,t.variance=u,t.zip=function(){return S(arguments)},Object.defineProperty(t,"__esModule",{value:!0})})},{}],157:[function(n,z,q){(function(t,h){h(typeof q=="object"&&typeof z<"u"?q:t.d3=t.d3||{})})(this,function(t){"use strict";function h(){}function p(a,c){var f=new h;if(a instanceof h)a.each(function(v,T){f.set(T,v)});else if(Array.isArray(a)){var g,d=-1,m=a.length;if(c==null)for(;++d<m;)f.set(d,a[d]);else for(;++d<m;)f.set(c(g=a[d],d,a),g)}else if(a)for(var y in a)f.set(y,a[y]);return f}function l(){return{}}function e(a,c,f){a[c]=f}function o(){return p()}function r(a,c,f){a.set(c,f)}function i(){}h.prototype=p.prototype={constructor:h,has:function(a){return"$"+a in this},get:function(a){return this["$"+a]},set:function(a,c){return this["$"+a]=c,this},remove:function(a){var c="$"+a;return c in this&&delete this[c]},clear:function(){for(var a in this)a[0]==="$"&&delete this[a]},keys:function(){var a=[];for(var c in this)c[0]==="$"&&a.push(c.slice(1));return a},values:function(){var a=[];for(var c in this)c[0]==="$"&&a.push(this[c]);return a},entries:function(){var a=[];for(var c in this)c[0]==="$"&&a.push({key:c.slice(1),value:this[c]});return a},size:function(){var a=0;for(var c in this)c[0]==="$"&&++a;return a},empty:function(){for(var a in this)if(a[0]==="$")return!1;return!0},each:function(a){for(var c in this)c[0]==="$"&&a(this[c],c.slice(1),this)}};var u=p.prototype;function s(a,c){var f=new i;if(a instanceof i)a.each(function(m){f.add(m)});else if(a){var g=-1,d=a.length;if(c==null)for(;++g<d;)f.add(a[g]);else for(;++g<d;)f.add(c(a[g],g,a))}return f}i.prototype=s.prototype={constructor:i,has:u.has,add:function(a){return this["$"+(a+="")]=a,this},remove:u.remove,clear:u.clear,values:u.keys,size:u.size,empty:u.empty,each:u.each},t.nest=function(){var a,c,f,g=[],d=[];function m(y,v,T,w){if(v>=g.length)return a!=null&&y.sort(a),c!=null?c(y):y;for(var A,E,M,b=-1,_=y.length,S=g[v++],C=p(),k=T();++b<_;)(M=C.get(A=S(E=y[b])+""))?M.push(E):C.set(A,[E]);return C.each(function(L,I){w(k,I,m(L,v,T,w))}),k}return f={object:function(y){return m(y,0,l,e)},map:function(y){return m(y,0,o,r)},entries:function(y){return function v(T,w){if(++w>g.length)return T;var A,E=d[w-1];return c!=null&&w>=g.length?A=T.entries():(A=[],T.each(function(M,b){A.push({key:b,values:v(M,w)})})),E!=null?A.sort(function(M,b){return E(M.key,b.key)}):A}(m(y,0,o,r),0)},key:function(y){return g.push(y),f},sortKeys:function(y){return d[g.length-1]=y,f},sortValues:function(y){return a=y,f},rollup:function(y){return c=y,f}}},t.set=s,t.map=p,t.keys=function(a){var c=[];for(var f in a)c.push(f);return c},t.values=function(a){var c=[];for(var f in a)c.push(a[f]);return c},t.entries=function(a){var c=[];for(var f in a)c.push({key:f,value:a[f]});return c},Object.defineProperty(t,"__esModule",{value:!0})})},{}],158:[function(n,z,q){(function(t,h){h(typeof q=="object"&&typeof z<"u"?q:(t=t||self).d3=t.d3||{})})(this,function(t){"use strict";function h(ve,ge,De){ve.prototype=ge.prototype=De,De.constructor=ve}function p(ve,ge){var De=Object.create(ve.prototype);for(var _e in ge)De[_e]=ge[_e];return De}function l(){}var e="\\s*([+-]?\\d+)\\s*",o="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",r="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",i=/^#([0-9a-f]{3,8})$/,u=new RegExp("^rgb\\("+[e,e,e]+"\\)$"),s=new RegExp("^rgb\\("+[r,r,r]+"\\)$"),a=new RegExp("^rgba\\("+[e,e,e,o]+"\\)$"),c=new RegExp("^rgba\\("+[r,r,r,o]+"\\)$"),f=new RegExp("^hsl\\("+[o,r,r]+"\\)$"),g=new RegExp("^hsla\\("+[o,r,r,o]+"\\)$"),d={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function m(){return this.rgb().formatHex()}function y(){return this.rgb().formatRgb()}function v(ve){var ge,De;return ve=(ve+"").trim().toLowerCase(),(ge=i.exec(ve))?(De=ge[1].length,ge=parseInt(ge[1],16),De===6?T(ge):De===3?new M(ge>>8&15|ge>>4&240,ge>>4&15|240&ge,(15&ge)<<4|15&ge,1):De===8?w(ge>>24&255,ge>>16&255,ge>>8&255,(255&ge)/255):De===4?w(ge>>12&15|ge>>8&240,ge>>8&15|ge>>4&240,ge>>4&15|240&ge,((15&ge)<<4|15&ge)/255):null):(ge=u.exec(ve))?new M(ge[1],ge[2],ge[3],1):(ge=s.exec(ve))?new M(255*ge[1]/100,255*ge[2]/100,255*ge[3]/100,1):(ge=a.exec(ve))?w(ge[1],ge[2],ge[3],ge[4]):(ge=c.exec(ve))?w(255*ge[1]/100,255*ge[2]/100,255*ge[3]/100,ge[4]):(ge=f.exec(ve))?C(ge[1],ge[2]/100,ge[3]/100,1):(ge=g.exec(ve))?C(ge[1],ge[2]/100,ge[3]/100,ge[4]):d.hasOwnProperty(ve)?T(d[ve]):ve==="transparent"?new M(NaN,NaN,NaN,0):null}function T(ve){return new M(ve>>16&255,ve>>8&255,255&ve,1)}function w(ve,ge,De,_e){return _e<=0&&(ve=ge=De=NaN),new M(ve,ge,De,_e)}function A(ve){return ve instanceof l||(ve=v(ve)),ve?new M((ve=ve.rgb()).r,ve.g,ve.b,ve.opacity):new M}function E(ve,ge,De,_e){return arguments.length===1?A(ve):new M(ve,ge,De,_e??1)}function M(ve,ge,De,_e){this.r=+ve,this.g=+ge,this.b=+De,this.opacity=+_e}function b(){return"#"+S(this.r)+S(this.g)+S(this.b)}function _(){var ve=this.opacity;return((ve=isNaN(ve)?1:Math.max(0,Math.min(1,ve)))===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(ve===1?")":", "+ve+")")}function S(ve){return((ve=Math.max(0,Math.min(255,Math.round(ve)||0)))<16?"0":"")+ve.toString(16)}function C(ve,ge,De,_e){return _e<=0?ve=ge=De=NaN:De<=0||De>=1?ve=ge=NaN:ge<=0&&(ve=NaN),new I(ve,ge,De,_e)}function k(ve){if(ve instanceof I)return new I(ve.h,ve.s,ve.l,ve.opacity);if(ve instanceof l||(ve=v(ve)),!ve)return new I;if(ve instanceof I)return ve;var ge=(ve=ve.rgb()).r/255,De=ve.g/255,_e=ve.b/255,Pe=Math.min(ge,De,_e),Fe=Math.max(ge,De,_e),ze=NaN,He=Fe-Pe,et=(Fe+Pe)/2;return He?(ze=ge===Fe?(De-_e)/He+6*(De<_e):De===Fe?(_e-ge)/He+2:(ge-De)/He+4,He/=et<.5?Fe+Pe:2-Fe-Pe,ze*=60):He=et>0&&et<1?0:ze,new I(ze,He,et,ve.opacity)}function L(ve,ge,De,_e){return arguments.length===1?k(ve):new I(ve,ge,De,_e??1)}function I(ve,ge,De,_e){this.h=+ve,this.s=+ge,this.l=+De,this.opacity=+_e}function R(ve,ge,De){return 255*(ve<60?ge+(De-ge)*ve/60:ve<180?De:ve<240?ge+(De-ge)*(240-ve)/60:ge)}h(l,v,{copy:function(ve){return Object.assign(new this.constructor,this,ve)},displayable:function(){return this.rgb().displayable()},hex:m,formatHex:m,formatHsl:function(){return k(this).formatHsl()},formatRgb:y,toString:y}),h(M,E,p(l,{brighter:function(ve){return ve=ve==null?1/.7:Math.pow(1/.7,ve),new M(this.r*ve,this.g*ve,this.b*ve,this.opacity)},darker:function(ve){return ve=ve==null?.7:Math.pow(.7,ve),new M(this.r*ve,this.g*ve,this.b*ve,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:b,formatHex:b,formatRgb:_,toString:_})),h(I,L,p(l,{brighter:function(ve){return ve=ve==null?1/.7:Math.pow(1/.7,ve),new I(this.h,this.s,this.l*ve,this.opacity)},darker:function(ve){return ve=ve==null?.7:Math.pow(.7,ve),new I(this.h,this.s,this.l*ve,this.opacity)},rgb:function(){var ve=this.h%360+360*(this.h<0),ge=isNaN(ve)||isNaN(this.s)?0:this.s,De=this.l,_e=De+(De<.5?De:1-De)*ge,Pe=2*De-_e;return new M(R(ve>=240?ve-240:ve+120,Pe,_e),R(ve,Pe,_e),R(ve<120?ve+240:ve-120,Pe,_e),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var ve=this.opacity;return((ve=isNaN(ve)?1:Math.max(0,Math.min(1,ve)))===1?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(ve===1?")":", "+ve+")")}}));var V=Math.PI/180,O=180/Math.PI,J=6/29,D=3*J*J;function B(ve){if(ve instanceof F)return new F(ve.l,ve.a,ve.b,ve.opacity);if(ve instanceof ee)return ie(ve);ve instanceof M||(ve=A(ve));var ge,De,_e=W(ve.r),Pe=W(ve.g),Fe=W(ve.b),ze=H((.2225045*_e+.7168786*Pe+.0606169*Fe)/1);return _e===Pe&&Pe===Fe?ge=De=ze:(ge=H((.4360747*_e+.3850649*Pe+.1430804*Fe)/.96422),De=H((.0139322*_e+.0971045*Pe+.7141733*Fe)/.82521)),new F(116*ze-16,500*(ge-ze),200*(ze-De),ve.opacity)}function N(ve,ge,De,_e){return arguments.length===1?B(ve):new F(ve,ge,De,_e??1)}function F(ve,ge,De,_e){this.l=+ve,this.a=+ge,this.b=+De,this.opacity=+_e}function H(ve){return ve>.008856451679035631?Math.pow(ve,1/3):ve/D+4/29}function j(ve){return ve>J?ve*ve*ve:D*(ve-4/29)}function G(ve){return 255*(ve<=.0031308?12.92*ve:1.055*Math.pow(ve,1/2.4)-.055)}function W(ve){return(ve/=255)<=.04045?ve/12.92:Math.pow((ve+.055)/1.055,2.4)}function Q(ve){if(ve instanceof ee)return new ee(ve.h,ve.c,ve.l,ve.opacity);if(ve instanceof F||(ve=B(ve)),ve.a===0&&ve.b===0)return new ee(NaN,0<ve.l&&ve.l<100?0:NaN,ve.l,ve.opacity);var ge=Math.atan2(ve.b,ve.a)*O;return new ee(ge<0?ge+360:ge,Math.sqrt(ve.a*ve.a+ve.b*ve.b),ve.l,ve.opacity)}function $(ve,ge,De,_e){return arguments.length===1?Q(ve):new ee(ve,ge,De,_e??1)}function ee(ve,ge,De,_e){this.h=+ve,this.c=+ge,this.l=+De,this.opacity=+_e}function ie(ve){if(isNaN(ve.h))return new F(ve.l,0,0,ve.opacity);var ge=ve.h*V;return new F(ve.l,Math.cos(ge)*ve.c,Math.sin(ge)*ve.c,ve.opacity)}h(F,N,p(l,{brighter:function(ve){return new F(this.l+18*(ve??1),this.a,this.b,this.opacity)},darker:function(ve){return new F(this.l-18*(ve??1),this.a,this.b,this.opacity)},rgb:function(){var ve=(this.l+16)/116,ge=isNaN(this.a)?ve:ve+this.a/500,De=isNaN(this.b)?ve:ve-this.b/200;return new M(G(3.1338561*(ge=.96422*j(ge))-1.6168667*(ve=1*j(ve))-.4906146*(De=.82521*j(De))),G(-.9787684*ge+1.9161415*ve+.033454*De),G(.0719453*ge-.2289914*ve+1.4052427*De),this.opacity)}})),h(ee,$,p(l,{brighter:function(ve){return new ee(this.h,this.c,this.l+18*(ve??1),this.opacity)},darker:function(ve){return new ee(this.h,this.c,this.l-18*(ve??1),this.opacity)},rgb:function(){return ie(this).rgb()}}));var ae=-.14861,oe=1.78277,de=-.29227,le=-.90649,fe=1.97294,ue=fe*le,we=fe*oe,Ae=oe*de-le*ae;function Se(ve){if(ve instanceof Me)return new Me(ve.h,ve.s,ve.l,ve.opacity);ve instanceof M||(ve=A(ve));var ge=ve.r/255,De=ve.g/255,_e=ve.b/255,Pe=(Ae*_e+ue*ge-we*De)/(Ae+ue-we),Fe=_e-Pe,ze=(fe*(De-Pe)-de*Fe)/le,He=Math.sqrt(ze*ze+Fe*Fe)/(fe*Pe*(1-Pe)),et=He?Math.atan2(ze,Fe)*O-120:NaN;return new Me(et<0?et+360:et,He,Pe,ve.opacity)}function ke(ve,ge,De,_e){return arguments.length===1?Se(ve):new Me(ve,ge,De,_e??1)}function Me(ve,ge,De,_e){this.h=+ve,this.s=+ge,this.l=+De,this.opacity=+_e}h(Me,ke,p(l,{brighter:function(ve){return ve=ve==null?1/.7:Math.pow(1/.7,ve),new Me(this.h,this.s,this.l*ve,this.opacity)},darker:function(ve){return ve=ve==null?.7:Math.pow(.7,ve),new Me(this.h,this.s,this.l*ve,this.opacity)},rgb:function(){var ve=isNaN(this.h)?0:(this.h+120)*V,ge=+this.l,De=isNaN(this.s)?0:this.s*ge*(1-ge),_e=Math.cos(ve),Pe=Math.sin(ve);return new M(255*(ge+De*(ae*_e+oe*Pe)),255*(ge+De*(de*_e+le*Pe)),255*(ge+De*(fe*_e)),this.opacity)}})),t.color=v,t.cubehelix=ke,t.gray=function(ve,ge){return new F(ve,0,0,ge??1)},t.hcl=$,t.hsl=L,t.lab=N,t.lch=function(ve,ge,De,_e){return arguments.length===1?Q(ve):new ee(De,ge,ve,_e??1)},t.rgb=E,Object.defineProperty(t,"__esModule",{value:!0})})},{}],159:[function(n,z,q){(function(t,h){h(typeof q=="object"&&typeof z<"u"?q:(t=t||self).d3=t.d3||{})})(this,function(t){"use strict";var h={value:function(){}};function p(){for(var i,u=0,s=arguments.length,a={};u<s;++u){if(!(i=arguments[u]+"")||i in a||/[\s.]/.test(i))throw new Error("illegal type: "+i);a[i]=[]}return new l(a)}function l(i){this._=i}function e(i,u){return i.trim().split(/^|\s+/).map(function(s){var a="",c=s.indexOf(".");if(c>=0&&(a=s.slice(c+1),s=s.slice(0,c)),s&&!u.hasOwnProperty(s))throw new Error("unknown type: "+s);return{type:s,name:a}})}function o(i,u){for(var s,a=0,c=i.length;a<c;++a)if((s=i[a]).name===u)return s.value}function r(i,u,s){for(var a=0,c=i.length;a<c;++a)if(i[a].name===u){i[a]=h,i=i.slice(0,a).concat(i.slice(a+1));break}return s!=null&&i.push({name:u,value:s}),i}l.prototype=p.prototype={constructor:l,on:function(i,u){var s,a=this._,c=e(i+"",a),f=-1,g=c.length;if(!(arguments.length<2)){if(u!=null&&typeof u!="function")throw new Error("invalid callback: "+u);for(;++f<g;)if(s=(i=c[f]).type)a[s]=r(a[s],i.name,u);else if(u==null)for(s in a)a[s]=r(a[s],i.name,null);return this}for(;++f<g;)if((s=(i=c[f]).type)&&(s=o(a[s],i.name)))return s},copy:function(){var i={},u=this._;for(var s in u)i[s]=u[s].slice();return new l(i)},call:function(i,u){if((s=arguments.length-2)>0)for(var s,a,c=new Array(s),f=0;f<s;++f)c[f]=arguments[f+2];if(!this._.hasOwnProperty(i))throw new Error("unknown type: "+i);for(f=0,s=(a=this._[i]).length;f<s;++f)a[f].value.apply(u,c)},apply:function(i,u,s){if(!this._.hasOwnProperty(i))throw new Error("unknown type: "+i);for(var a=this._[i],c=0,f=a.length;c<f;++c)a[c].value.apply(u,s)}},t.dispatch=p,Object.defineProperty(t,"__esModule",{value:!0})})},{}],160:[function(n,z,q){(function(t,h){typeof q=="object"&&typeof z<"u"?h(q,n("d3-quadtree"),n("d3-collection"),n("d3-dispatch"),n("d3-timer")):h(t.d3=t.d3||{},t.d3,t.d3,t.d3,t.d3)})(this,function(t,h,p,l,e){"use strict";function o(d){return function(){return d}}function r(){return 1e-6*(Math.random()-.5)}function i(d){return d.x+d.vx}function u(d){return d.y+d.vy}function s(d){return d.index}function a(d,m){var y=d.get(m);if(!y)throw new Error("missing: "+m);return y}function c(d){return d.x}function f(d){return d.y}var g=Math.PI*(3-Math.sqrt(5));t.forceCenter=function(d,m){var y;function v(){var T,w,A=y.length,E=0,M=0;for(T=0;T<A;++T)E+=(w=y[T]).x,M+=w.y;for(E=E/A-d,M=M/A-m,T=0;T<A;++T)(w=y[T]).x-=E,w.y-=M}return d==null&&(d=0),m==null&&(m=0),v.initialize=function(T){y=T},v.x=function(T){return arguments.length?(d=+T,v):d},v.y=function(T){return arguments.length?(m=+T,v):m},v},t.forceCollide=function(d){var m,y,v=1,T=1;function w(){for(var M,b,_,S,C,k,L,I=m.length,R=0;R<T;++R)for(b=h.quadtree(m,i,u).visitAfter(A),M=0;M<I;++M)_=m[M],k=y[_.index],L=k*k,S=_.x+_.vx,C=_.y+_.vy,b.visit(V);function V(O,J,D,B,N){var F=O.data,H=O.r,j=k+H;if(!F)return J>S+j||B<S-j||D>C+j||N<C-j;if(F.index>_.index){var G=S-F.x-F.vx,W=C-F.y-F.vy,Q=G*G+W*W;Q<j*j&&(G===0&&(Q+=(G=r())*G),W===0&&(Q+=(W=r())*W),Q=(j-(Q=Math.sqrt(Q)))/Q*v,_.vx+=(G*=Q)*(j=(H*=H)/(L+H)),_.vy+=(W*=Q)*j,F.vx-=G*(j=1-j),F.vy-=W*j)}}}function A(M){if(M.data)return M.r=y[M.data.index];for(var b=M.r=0;b<4;++b)M[b]&&M[b].r>M.r&&(M.r=M[b].r)}function E(){if(m){var M,b,_=m.length;for(y=new Array(_),M=0;M<_;++M)b=m[M],y[b.index]=+d(b,M,m)}}return typeof d!="function"&&(d=o(d==null?1:+d)),w.initialize=function(M){m=M,E()},w.iterations=function(M){return arguments.length?(T=+M,w):T},w.strength=function(M){return arguments.length?(v=+M,w):v},w.radius=function(M){return arguments.length?(d=typeof M=="function"?M:o(+M),E(),w):d},w},t.forceLink=function(d){var m,y,v,T,w,A=s,E=function(L){return 1/Math.min(T[L.source.index],T[L.target.index])},M=o(30),b=1;function _(L){for(var I=0,R=d.length;I<b;++I)for(var V,O,J,D,B,N,F,H=0;H<R;++H)O=(V=d[H]).source,D=(J=V.target).x+J.vx-O.x-O.vx||r(),B=J.y+J.vy-O.y-O.vy||r(),D*=N=((N=Math.sqrt(D*D+B*B))-y[H])/N*L*m[H],B*=N,J.vx-=D*(F=w[H]),J.vy-=B*F,O.vx+=D*(F=1-F),O.vy+=B*F}function S(){if(v){var L,I,R=v.length,V=d.length,O=p.map(v,A);for(L=0,T=new Array(R);L<V;++L)(I=d[L]).index=L,typeof I.source!="object"&&(I.source=a(O,I.source)),typeof I.target!="object"&&(I.target=a(O,I.target)),T[I.source.index]=(T[I.source.index]||0)+1,T[I.target.index]=(T[I.target.index]||0)+1;for(L=0,w=new Array(V);L<V;++L)I=d[L],w[L]=T[I.source.index]/(T[I.source.index]+T[I.target.index]);m=new Array(V),C(),y=new Array(V),k()}}function C(){if(v)for(var L=0,I=d.length;L<I;++L)m[L]=+E(d[L],L,d)}function k(){if(v)for(var L=0,I=d.length;L<I;++L)y[L]=+M(d[L],L,d)}return d==null&&(d=[]),_.initialize=function(L){v=L,S()},_.links=function(L){return arguments.length?(d=L,S(),_):d},_.id=function(L){return arguments.length?(A=L,_):A},_.iterations=function(L){return arguments.length?(b=+L,_):b},_.strength=function(L){return arguments.length?(E=typeof L=="function"?L:o(+L),C(),_):E},_.distance=function(L){return arguments.length?(M=typeof L=="function"?L:o(+L),k(),_):M},_},t.forceManyBody=function(){var d,m,y,v,T=o(-30),w=1,A=1/0,E=.81;function M(C){var k,L=d.length,I=h.quadtree(d,c,f).visitAfter(_);for(y=C,k=0;k<L;++k)m=d[k],I.visit(S)}function b(){if(d){var C,k,L=d.length;for(v=new Array(L),C=0;C<L;++C)k=d[C],v[k.index]=+T(k,C,d)}}function _(C){var k,L,I,R,V,O=0,J=0;if(C.length){for(I=R=V=0;V<4;++V)(k=C[V])&&(L=Math.abs(k.value))&&(O+=k.value,J+=L,I+=L*k.x,R+=L*k.y);C.x=I/J,C.y=R/J}else{(k=C).x=k.data.x,k.y=k.data.y;do O+=v[k.data.index];while(k=k.next)}C.value=O}function S(C,k,L,I){if(!C.value)return!0;var R=C.x-m.x,V=C.y-m.y,O=I-k,J=R*R+V*V;if(O*O/E<J)return J<A&&(R===0&&(J+=(R=r())*R),V===0&&(J+=(V=r())*V),J<w&&(J=Math.sqrt(w*J)),m.vx+=R*C.value*y/J,m.vy+=V*C.value*y/J),!0;if(!(C.length||J>=A)){(C.data!==m||C.next)&&(R===0&&(J+=(R=r())*R),V===0&&(J+=(V=r())*V),J<w&&(J=Math.sqrt(w*J)));do C.data!==m&&(O=v[C.data.index]*y/J,m.vx+=R*O,m.vy+=V*O);while(C=C.next)}}return M.initialize=function(C){d=C,b()},M.strength=function(C){return arguments.length?(T=typeof C=="function"?C:o(+C),b(),M):T},M.distanceMin=function(C){return arguments.length?(w=C*C,M):Math.sqrt(w)},M.distanceMax=function(C){return arguments.length?(A=C*C,M):Math.sqrt(A)},M.theta=function(C){return arguments.length?(E=C*C,M):Math.sqrt(E)},M},t.forceRadial=function(d,m,y){var v,T,w,A=o(.1);function E(b){for(var _=0,S=v.length;_<S;++_){var C=v[_],k=C.x-m||1e-6,L=C.y-y||1e-6,I=Math.sqrt(k*k+L*L),R=(w[_]-I)*T[_]*b/I;C.vx+=k*R,C.vy+=L*R}}function M(){if(v){var b,_=v.length;for(T=new Array(_),w=new Array(_),b=0;b<_;++b)w[b]=+d(v[b],b,v),T[b]=isNaN(w[b])?0:+A(v[b],b,v)}}return typeof d!="function"&&(d=o(+d)),m==null&&(m=0),y==null&&(y=0),E.initialize=function(b){v=b,M()},E.strength=function(b){return arguments.length?(A=typeof b=="function"?b:o(+b),M(),E):A},E.radius=function(b){return arguments.length?(d=typeof b=="function"?b:o(+b),M(),E):d},E.x=function(b){return arguments.length?(m=+b,E):m},E.y=function(b){return arguments.length?(y=+b,E):y},E},t.forceSimulation=function(d){var m,y=1,v=.001,T=1-Math.pow(v,1/300),w=0,A=.6,E=p.map(),M=e.timer(_),b=l.dispatch("tick","end");function _(){S(),b.call("tick",m),y<v&&(M.stop(),b.call("end",m))}function S(L){var I,R,V=d.length;L===void 0&&(L=1);for(var O=0;O<L;++O)for(y+=(w-y)*T,E.each(function(J){J(y)}),I=0;I<V;++I)(R=d[I]).fx==null?R.x+=R.vx*=A:(R.x=R.fx,R.vx=0),R.fy==null?R.y+=R.vy*=A:(R.y=R.fy,R.vy=0);return m}function C(){for(var L,I=0,R=d.length;I<R;++I){if((L=d[I]).index=I,L.fx!=null&&(L.x=L.fx),L.fy!=null&&(L.y=L.fy),isNaN(L.x)||isNaN(L.y)){var V=10*Math.sqrt(I),O=I*g;L.x=V*Math.cos(O),L.y=V*Math.sin(O)}(isNaN(L.vx)||isNaN(L.vy))&&(L.vx=L.vy=0)}}function k(L){return L.initialize&&L.initialize(d),L}return d==null&&(d=[]),C(),m={tick:S,restart:function(){return M.restart(_),m},stop:function(){return M.stop(),m},nodes:function(L){return arguments.length?(d=L,C(),E.each(k),m):d},alpha:function(L){return arguments.length?(y=+L,m):y},alphaMin:function(L){return arguments.length?(v=+L,m):v},alphaDecay:function(L){return arguments.length?(T=+L,m):+T},alphaTarget:function(L){return arguments.length?(w=+L,m):w},velocityDecay:function(L){return arguments.length?(A=1-L,m):1-A},force:function(L,I){return arguments.length>1?(I==null?E.remove(L):E.set(L,k(I)),m):E.get(L)},find:function(L,I,R){var V,O,J,D,B,N=0,F=d.length;for(R==null?R=1/0:R*=R,N=0;N<F;++N)(J=(V=L-(D=d[N]).x)*V+(O=I-D.y)*O)<R&&(B=D,R=J);return B},on:function(L,I){return arguments.length>1?(b.on(L,I),m):b.on(L)}}},t.forceX=function(d){var m,y,v,T=o(.1);function w(E){for(var M,b=0,_=m.length;b<_;++b)(M=m[b]).vx+=(v[b]-M.x)*y[b]*E}function A(){if(m){var E,M=m.length;for(y=new Array(M),v=new Array(M),E=0;E<M;++E)y[E]=isNaN(v[E]=+d(m[E],E,m))?0:+T(m[E],E,m)}}return typeof d!="function"&&(d=o(d==null?0:+d)),w.initialize=function(E){m=E,A()},w.strength=function(E){return arguments.length?(T=typeof E=="function"?E:o(+E),A(),w):T},w.x=function(E){return arguments.length?(d=typeof E=="function"?E:o(+E),A(),w):d},w},t.forceY=function(d){var m,y,v,T=o(.1);function w(E){for(var M,b=0,_=m.length;b<_;++b)(M=m[b]).vy+=(v[b]-M.y)*y[b]*E}function A(){if(m){var E,M=m.length;for(y=new Array(M),v=new Array(M),E=0;E<M;++E)y[E]=isNaN(v[E]=+d(m[E],E,m))?0:+T(m[E],E,m)}}return typeof d!="function"&&(d=o(d==null?0:+d)),w.initialize=function(E){m=E,A()},w.strength=function(E){return arguments.length?(T=typeof E=="function"?E:o(+E),A(),w):T},w.y=function(E){return arguments.length?(d=typeof E=="function"?E:o(+E),A(),w):d},w},Object.defineProperty(t,"__esModule",{value:!0})})},{"d3-collection":157,"d3-dispatch":159,"d3-quadtree":164,"d3-timer":168}],161:[function(n,z,q){(function(t,h){h(typeof q=="object"&&typeof z<"u"?q:(t=t||self).d3=t.d3||{})})(this,function(t){"use strict";function h(le,fe){return le.parent===fe.parent?1:2}function p(le,fe){return le+fe.x}function l(le,fe){return Math.max(le,fe.y)}function e(le){var fe=0,ue=le.children,we=ue&&ue.length;if(we)for(;--we>=0;)fe+=ue[we].value;else fe=1;le.value=fe}function o(le,fe){var ue,we,Ae,Se,ke,Me=new s(le),ve=+le.value&&(Me.value=le.value),ge=[Me];for(fe==null&&(fe=r);ue=ge.pop();)if(ve&&(ue.value=+ue.data.value),(Ae=fe(ue.data))&&(ke=Ae.length))for(ue.children=new Array(ke),Se=ke-1;Se>=0;--Se)ge.push(we=ue.children[Se]=new s(Ae[Se])),we.parent=ue,we.depth=ue.depth+1;return Me.eachBefore(u)}function r(le){return le.children}function i(le){le.data=le.data.data}function u(le){var fe=0;do le.height=fe;while((le=le.parent)&&le.height<++fe)}function s(le){this.data=le,this.depth=this.height=0,this.parent=null}s.prototype=o.prototype={constructor:s,count:function(){return this.eachAfter(e)},each:function(le){var fe,ue,we,Ae,Se=this,ke=[Se];do for(fe=ke.reverse(),ke=[];Se=fe.pop();)if(le(Se),ue=Se.children)for(we=0,Ae=ue.length;we<Ae;++we)ke.push(ue[we]);while(ke.length);return this},eachAfter:function(le){for(var fe,ue,we,Ae=this,Se=[Ae],ke=[];Ae=Se.pop();)if(ke.push(Ae),fe=Ae.children)for(ue=0,we=fe.length;ue<we;++ue)Se.push(fe[ue]);for(;Ae=ke.pop();)le(Ae);return this},eachBefore:function(le){for(var fe,ue,we=this,Ae=[we];we=Ae.pop();)if(le(we),fe=we.children)for(ue=fe.length-1;ue>=0;--ue)Ae.push(fe[ue]);return this},sum:function(le){return this.eachAfter(function(fe){for(var ue=+le(fe.data)||0,we=fe.children,Ae=we&&we.length;--Ae>=0;)ue+=we[Ae].value;fe.value=ue})},sort:function(le){return this.eachBefore(function(fe){fe.children&&fe.children.sort(le)})},path:function(le){for(var fe=this,ue=function(Se,ke){if(Se===ke)return Se;var Me=Se.ancestors(),ve=ke.ancestors(),ge=null;for(Se=Me.pop(),ke=ve.pop();Se===ke;)ge=Se,Se=Me.pop(),ke=ve.pop();return ge}(fe,le),we=[fe];fe!==ue;)fe=fe.parent,we.push(fe);for(var Ae=we.length;le!==ue;)we.splice(Ae,0,le),le=le.parent;return we},ancestors:function(){for(var le=this,fe=[le];le=le.parent;)fe.push(le);return fe},descendants:function(){var le=[];return this.each(function(fe){le.push(fe)}),le},leaves:function(){var le=[];return this.eachBefore(function(fe){fe.children||le.push(fe)}),le},links:function(){var le=this,fe=[];return le.each(function(ue){ue!==le&&fe.push({source:ue.parent,target:ue})}),fe},copy:function(){return o(this).eachBefore(i)}};var a=Array.prototype.slice;function c(le){for(var fe,ue,we=0,Ae=(le=function(ke){for(var Me,ve,ge=ke.length;ge;)ve=Math.random()*ge--|0,Me=ke[ge],ke[ge]=ke[ve],ke[ve]=Me;return ke}(a.call(le))).length,Se=[];we<Ae;)fe=le[we],ue&&d(ue,fe)?++we:(ue=y(Se=f(Se,fe)),we=0);return ue}function f(le,fe){var ue,we;if(m(fe,le))return[fe];for(ue=0;ue<le.length;++ue)if(g(fe,le[ue])&&m(v(le[ue],fe),le))return[le[ue],fe];for(ue=0;ue<le.length-1;++ue)for(we=ue+1;we<le.length;++we)if(g(v(le[ue],le[we]),fe)&&g(v(le[ue],fe),le[we])&&g(v(le[we],fe),le[ue])&&m(T(le[ue],le[we],fe),le))return[le[ue],le[we],fe];throw new Error}function g(le,fe){var ue=le.r-fe.r,we=fe.x-le.x,Ae=fe.y-le.y;return ue<0||ue*ue<we*we+Ae*Ae}function d(le,fe){var ue=le.r-fe.r+1e-6,we=fe.x-le.x,Ae=fe.y-le.y;return ue>0&&ue*ue>we*we+Ae*Ae}function m(le,fe){for(var ue=0;ue<fe.length;++ue)if(!d(le,fe[ue]))return!1;return!0}function y(le){switch(le.length){case 1:return{x:(fe=le[0]).x,y:fe.y,r:fe.r};case 2:return v(le[0],le[1]);case 3:return T(le[0],le[1],le[2])}var fe}function v(le,fe){var ue=le.x,we=le.y,Ae=le.r,Se=fe.x,ke=fe.y,Me=fe.r,ve=Se-ue,ge=ke-we,De=Me-Ae,_e=Math.sqrt(ve*ve+ge*ge);return{x:(ue+Se+ve/_e*De)/2,y:(we+ke+ge/_e*De)/2,r:(_e+Ae+Me)/2}}function T(le,fe,ue){var we=le.x,Ae=le.y,Se=le.r,ke=fe.x,Me=fe.y,ve=fe.r,ge=ue.x,De=ue.y,_e=ue.r,Pe=we-ke,Fe=we-ge,ze=Ae-Me,He=Ae-De,et=ve-Se,Re=_e-Se,Ze=we*we+Ae*Ae-Se*Se,Ke=Ze-ke*ke-Me*Me+ve*ve,$e=Ze-ge*ge-De*De+_e*_e,rt=Fe*ze-Pe*He,at=(ze*$e-He*Ke)/(2*rt)-we,lt=(He*et-ze*Re)/rt,gt=(Fe*Ke-Pe*$e)/(2*rt)-Ae,Ie=(Pe*Re-Fe*et)/rt,be=lt*lt+Ie*Ie-1,We=2*(Se+at*lt+gt*Ie),Ge=at*at+gt*gt-Se*Se,st=-(be?(We+Math.sqrt(We*We-4*be*Ge))/(2*be):Ge/We);return{x:we+at+lt*st,y:Ae+gt+Ie*st,r:st}}function w(le,fe,ue){var we,Ae,Se,ke,Me=le.x-fe.x,ve=le.y-fe.y,ge=Me*Me+ve*ve;ge?(Ae=fe.r+ue.r,Ae*=Ae,ke=le.r+ue.r,Ae>(ke*=ke)?(we=(ge+ke-Ae)/(2*ge),Se=Math.sqrt(Math.max(0,ke/ge-we*we)),ue.x=le.x-we*Me-Se*ve,ue.y=le.y-we*ve+Se*Me):(we=(ge+Ae-ke)/(2*ge),Se=Math.sqrt(Math.max(0,Ae/ge-we*we)),ue.x=fe.x+we*Me-Se*ve,ue.y=fe.y+we*ve+Se*Me)):(ue.x=fe.x+ue.r,ue.y=fe.y)}function A(le,fe){var ue=le.r+fe.r-1e-6,we=fe.x-le.x,Ae=fe.y-le.y;return ue>0&&ue*ue>we*we+Ae*Ae}function E(le){var fe=le._,ue=le.next._,we=fe.r+ue.r,Ae=(fe.x*ue.r+ue.x*fe.r)/we,Se=(fe.y*ue.r+ue.y*fe.r)/we;return Ae*Ae+Se*Se}function M(le){this._=le,this.next=null,this.previous=null}function b(le){if(!(Ae=le.length))return 0;var fe,ue,we,Ae,Se,ke,Me,ve,ge,De,_e;if((fe=le[0]).x=0,fe.y=0,!(Ae>1))return fe.r;if(ue=le[1],fe.x=-ue.r,ue.x=fe.r,ue.y=0,!(Ae>2))return fe.r+ue.r;w(ue,fe,we=le[2]),fe=new M(fe),ue=new M(ue),we=new M(we),fe.next=we.previous=ue,ue.next=fe.previous=we,we.next=ue.previous=fe;e:for(Me=3;Me<Ae;++Me){w(fe._,ue._,we=le[Me]),we=new M(we),ve=ue.next,ge=fe.previous,De=ue._.r,_e=fe._.r;do if(De<=_e){if(A(ve._,we._)){ue=ve,fe.next=ue,ue.previous=fe,--Me;continue e}De+=ve._.r,ve=ve.next}else{if(A(ge._,we._)){(fe=ge).next=ue,ue.previous=fe,--Me;continue e}_e+=ge._.r,ge=ge.previous}while(ve!==ge.next);for(we.previous=fe,we.next=ue,fe.next=ue.previous=ue=we,Se=E(fe);(we=we.next)!==ue;)(ke=E(we))<Se&&(fe=we,Se=ke);ue=fe.next}for(fe=[ue._],we=ue;(we=we.next)!==ue;)fe.push(we._);for(we=c(fe),Me=0;Me<Ae;++Me)(fe=le[Me]).x-=we.x,fe.y-=we.y;return we.r}function _(le){return le==null?null:S(le)}function S(le){if(typeof le!="function")throw new Error;return le}function C(){return 0}function k(le){return function(){return le}}function L(le){return Math.sqrt(le.value)}function I(le){return function(fe){fe.children||(fe.r=Math.max(0,+le(fe)||0))}}function R(le,fe){return function(ue){if(we=ue.children){var we,Ae,Se,ke=we.length,Me=le(ue)*fe||0;if(Me)for(Ae=0;Ae<ke;++Ae)we[Ae].r+=Me;if(Se=b(we),Me)for(Ae=0;Ae<ke;++Ae)we[Ae].r-=Me;ue.r=Se+Me}}}function V(le){return function(fe){var ue=fe.parent;fe.r*=le,ue&&(fe.x=ue.x+le*fe.x,fe.y=ue.y+le*fe.y)}}function O(le){le.x0=Math.round(le.x0),le.y0=Math.round(le.y0),le.x1=Math.round(le.x1),le.y1=Math.round(le.y1)}function J(le,fe,ue,we,Ae){for(var Se,ke=le.children,Me=-1,ve=ke.length,ge=le.value&&(we-fe)/le.value;++Me<ve;)(Se=ke[Me]).y0=ue,Se.y1=Ae,Se.x0=fe,Se.x1=fe+=Se.value*ge}var D={depth:-1},B={};function N(le){return le.id}function F(le){return le.parentId}function H(le,fe){return le.parent===fe.parent?1:2}function j(le){var fe=le.children;return fe?fe[0]:le.t}function G(le){var fe=le.children;return fe?fe[fe.length-1]:le.t}function W(le,fe,ue){var we=ue/(fe.i-le.i);fe.c-=we,fe.s+=ue,le.c+=we,fe.z+=ue,fe.m+=ue}function Q(le,fe,ue){return le.a.parent===fe.parent?le.a:ue}function $(le,fe){this._=le,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=fe}function ee(le,fe,ue,we,Ae){for(var Se,ke=le.children,Me=-1,ve=ke.length,ge=le.value&&(Ae-ue)/le.value;++Me<ve;)(Se=ke[Me]).x0=fe,Se.x1=we,Se.y0=ue,Se.y1=ue+=Se.value*ge}$.prototype=Object.create(s.prototype);var ie=(1+Math.sqrt(5))/2;function ae(le,fe,ue,we,Ae,Se){for(var ke,Me,ve,ge,De,_e,Pe,Fe,ze,He,et,Re=[],Ze=fe.children,Ke=0,$e=0,rt=Ze.length,at=fe.value;Ke<rt;){ve=Ae-ue,ge=Se-we;do De=Ze[$e++].value;while(!De&&$e<rt);for(_e=Pe=De,et=De*De*(He=Math.max(ge/ve,ve/ge)/(at*le)),ze=Math.max(Pe/et,et/_e);$e<rt;++$e){if(De+=Me=Ze[$e].value,Me<_e&&(_e=Me),Me>Pe&&(Pe=Me),et=De*De*He,(Fe=Math.max(Pe/et,et/_e))>ze){De-=Me;break}ze=Fe}Re.push(ke={value:De,dice:ve<ge,children:Ze.slice(Ke,$e)}),ke.dice?J(ke,ue,we,Ae,at?we+=ge*De/at:Se):ee(ke,ue,we,at?ue+=ve*De/at:Ae,Se),at-=De,Ke=$e}return Re}var oe=function le(fe){function ue(we,Ae,Se,ke,Me){ae(fe,we,Ae,Se,ke,Me)}return ue.ratio=function(we){return le((we=+we)>1?we:1)},ue}(ie),de=function le(fe){function ue(we,Ae,Se,ke,Me){if((ve=we._squarify)&&ve.ratio===fe)for(var ve,ge,De,_e,Pe,Fe=-1,ze=ve.length,He=we.value;++Fe<ze;){for(De=(ge=ve[Fe]).children,_e=ge.value=0,Pe=De.length;_e<Pe;++_e)ge.value+=De[_e].value;ge.dice?J(ge,Ae,Se,ke,Se+=(Me-Se)*ge.value/He):ee(ge,Ae,Se,Ae+=(ke-Ae)*ge.value/He,Me),He-=ge.value}else we._squarify=ve=ae(fe,we,Ae,Se,ke,Me),ve.ratio=fe}return ue.ratio=function(we){return le((we=+we)>1?we:1)},ue}(ie);t.cluster=function(){var le=h,fe=1,ue=1,we=!1;function Ae(Se){var ke,Me=0;Se.eachAfter(function(Pe){var Fe=Pe.children;Fe?(Pe.x=function(ze){return ze.reduce(p,0)/ze.length}(Fe),Pe.y=function(ze){return 1+ze.reduce(l,0)}(Fe)):(Pe.x=ke?Me+=le(Pe,ke):0,Pe.y=0,ke=Pe)});var ve=function(Pe){for(var Fe;Fe=Pe.children;)Pe=Fe[0];return Pe}(Se),ge=function(Pe){for(var Fe;Fe=Pe.children;)Pe=Fe[Fe.length-1];return Pe}(Se),De=ve.x-le(ve,ge)/2,_e=ge.x+le(ge,ve)/2;return Se.eachAfter(we?function(Pe){Pe.x=(Pe.x-Se.x)*fe,Pe.y=(Se.y-Pe.y)*ue}:function(Pe){Pe.x=(Pe.x-De)/(_e-De)*fe,Pe.y=(1-(Se.y?Pe.y/Se.y:1))*ue})}return Ae.separation=function(Se){return arguments.length?(le=Se,Ae):le},Ae.size=function(Se){return arguments.length?(we=!1,fe=+Se[0],ue=+Se[1],Ae):we?null:[fe,ue]},Ae.nodeSize=function(Se){return arguments.length?(we=!0,fe=+Se[0],ue=+Se[1],Ae):we?[fe,ue]:null},Ae},t.hierarchy=o,t.pack=function(){var le=null,fe=1,ue=1,we=C;function Ae(Se){return Se.x=fe/2,Se.y=ue/2,le?Se.eachBefore(I(le)).eachAfter(R(we,.5)).eachBefore(V(1)):Se.eachBefore(I(L)).eachAfter(R(C,1)).eachAfter(R(we,Se.r/Math.min(fe,ue))).eachBefore(V(Math.min(fe,ue)/(2*Se.r))),Se}return Ae.radius=function(Se){return arguments.length?(le=_(Se),Ae):le},Ae.size=function(Se){return arguments.length?(fe=+Se[0],ue=+Se[1],Ae):[fe,ue]},Ae.padding=function(Se){return arguments.length?(we=typeof Se=="function"?Se:k(+Se),Ae):we},Ae},t.packEnclose=c,t.packSiblings=function(le){return b(le),le},t.partition=function(){var le=1,fe=1,ue=0,we=!1;function Ae(Se){var ke=Se.height+1;return Se.x0=Se.y0=ue,Se.x1=le,Se.y1=fe/ke,Se.eachBefore(function(Me,ve){return function(ge){ge.children&&J(ge,ge.x0,Me*(ge.depth+1)/ve,ge.x1,Me*(ge.depth+2)/ve);var De=ge.x0,_e=ge.y0,Pe=ge.x1-ue,Fe=ge.y1-ue;Pe<De&&(De=Pe=(De+Pe)/2),Fe<_e&&(_e=Fe=(_e+Fe)/2),ge.x0=De,ge.y0=_e,ge.x1=Pe,ge.y1=Fe}}(fe,ke)),we&&Se.eachBefore(O),Se}return Ae.round=function(Se){return arguments.length?(we=!!Se,Ae):we},Ae.size=function(Se){return arguments.length?(le=+Se[0],fe=+Se[1],Ae):[le,fe]},Ae.padding=function(Se){return arguments.length?(ue=+Se,Ae):ue},Ae},t.stratify=function(){var le=N,fe=F;function ue(we){var Ae,Se,ke,Me,ve,ge,De,_e=we.length,Pe=new Array(_e),Fe={};for(Se=0;Se<_e;++Se)Ae=we[Se],ve=Pe[Se]=new s(Ae),(ge=le(Ae,Se,we))!=null&&(ge+="")&&(Fe[De="$"+(ve.id=ge)]=De in Fe?B:ve);for(Se=0;Se<_e;++Se)if(ve=Pe[Se],(ge=fe(we[Se],Se,we))!=null&&(ge+="")){if(!(Me=Fe["$"+ge]))throw new Error("missing: "+ge);if(Me===B)throw new Error("ambiguous: "+ge);Me.children?Me.children.push(ve):Me.children=[ve],ve.parent=Me}else{if(ke)throw new Error("multiple roots");ke=ve}if(!ke)throw new Error("no root");if(ke.parent=D,ke.eachBefore(function(ze){ze.depth=ze.parent.depth+1,--_e}).eachBefore(u),ke.parent=null,_e>0)throw new Error("cycle");return ke}return ue.id=function(we){return arguments.length?(le=S(we),ue):le},ue.parentId=function(we){return arguments.length?(fe=S(we),ue):fe},ue},t.tree=function(){var le=H,fe=1,ue=1,we=null;function Ae(ve){var ge=function(Re){for(var Ze,Ke,$e,rt,at,lt=new $(Re,0),gt=[lt];Ze=gt.pop();)if($e=Ze._.children)for(Ze.children=new Array(at=$e.length),rt=at-1;rt>=0;--rt)gt.push(Ke=Ze.children[rt]=new $($e[rt],rt)),Ke.parent=Ze;return(lt.parent=new $(null,0)).children=[lt],lt}(ve);if(ge.eachAfter(Se),ge.parent.m=-ge.z,ge.eachBefore(ke),we)ve.eachBefore(Me);else{var De=ve,_e=ve,Pe=ve;ve.eachBefore(function(Re){Re.x<De.x&&(De=Re),Re.x>_e.x&&(_e=Re),Re.depth>Pe.depth&&(Pe=Re)});var Fe=De===_e?1:le(De,_e)/2,ze=Fe-De.x,He=fe/(_e.x+Fe+ze),et=ue/(Pe.depth||1);ve.eachBefore(function(Re){Re.x=(Re.x+ze)*He,Re.y=Re.depth*et})}return ve}function Se(ve){var ge=ve.children,De=ve.parent.children,_e=ve.i?De[ve.i-1]:null;if(ge){(function(Fe){for(var ze,He=0,et=0,Re=Fe.children,Ze=Re.length;--Ze>=0;)(ze=Re[Ze]).z+=He,ze.m+=He,He+=ze.s+(et+=ze.c)})(ve);var Pe=(ge[0].z+ge[ge.length-1].z)/2;_e?(ve.z=_e.z+le(ve._,_e._),ve.m=ve.z-Pe):ve.z=Pe}else _e&&(ve.z=_e.z+le(ve._,_e._));ve.parent.A=function(Fe,ze,He){if(ze){for(var et,Re=Fe,Ze=Fe,Ke=ze,$e=Re.parent.children[0],rt=Re.m,at=Ze.m,lt=Ke.m,gt=$e.m;Ke=G(Ke),Re=j(Re),Ke&&Re;)$e=j($e),(Ze=G(Ze)).a=Fe,(et=Ke.z+lt-Re.z-rt+le(Ke._,Re._))>0&&(W(Q(Ke,Fe,He),Fe,et),rt+=et,at+=et),lt+=Ke.m,rt+=Re.m,gt+=$e.m,at+=Ze.m;Ke&&!G(Ze)&&(Ze.t=Ke,Ze.m+=lt-at),Re&&!j($e)&&($e.t=Re,$e.m+=rt-gt,He=Fe)}return He}(ve,_e,ve.parent.A||De[0])}function ke(ve){ve._.x=ve.z+ve.parent.m,ve.m+=ve.parent.m}function Me(ve){ve.x*=fe,ve.y=ve.depth*ue}return Ae.separation=function(ve){return arguments.length?(le=ve,Ae):le},Ae.size=function(ve){return arguments.length?(we=!1,fe=+ve[0],ue=+ve[1],Ae):we?null:[fe,ue]},Ae.nodeSize=function(ve){return arguments.length?(we=!0,fe=+ve[0],ue=+ve[1],Ae):we?[fe,ue]:null},Ae},t.treemap=function(){var le=oe,fe=!1,ue=1,we=1,Ae=[0],Se=C,ke=C,Me=C,ve=C,ge=C;function De(Pe){return Pe.x0=Pe.y0=0,Pe.x1=ue,Pe.y1=we,Pe.eachBefore(_e),Ae=[0],fe&&Pe.eachBefore(O),Pe}function _e(Pe){var Fe=Ae[Pe.depth],ze=Pe.x0+Fe,He=Pe.y0+Fe,et=Pe.x1-Fe,Re=Pe.y1-Fe;et<ze&&(ze=et=(ze+et)/2),Re<He&&(He=Re=(He+Re)/2),Pe.x0=ze,Pe.y0=He,Pe.x1=et,Pe.y1=Re,Pe.children&&(Fe=Ae[Pe.depth+1]=Se(Pe)/2,ze+=ge(Pe)-Fe,He+=ke(Pe)-Fe,(et-=Me(Pe)-Fe)<ze&&(ze=et=(ze+et)/2),(Re-=ve(Pe)-Fe)<He&&(He=Re=(He+Re)/2),le(Pe,ze,He,et,Re))}return De.round=function(Pe){return arguments.length?(fe=!!Pe,De):fe},De.size=function(Pe){return arguments.length?(ue=+Pe[0],we=+Pe[1],De):[ue,we]},De.tile=function(Pe){return arguments.length?(le=S(Pe),De):le},De.padding=function(Pe){return arguments.length?De.paddingInner(Pe).paddingOuter(Pe):De.paddingInner()},De.paddingInner=function(Pe){return arguments.length?(Se=typeof Pe=="function"?Pe:k(+Pe),De):Se},De.paddingOuter=function(Pe){return arguments.length?De.paddingTop(Pe).paddingRight(Pe).paddingBottom(Pe).paddingLeft(Pe):De.paddingTop()},De.paddingTop=function(Pe){return arguments.length?(ke=typeof Pe=="function"?Pe:k(+Pe),De):ke},De.paddingRight=function(Pe){return arguments.length?(Me=typeof Pe=="function"?Pe:k(+Pe),De):Me},De.paddingBottom=function(Pe){return arguments.length?(ve=typeof Pe=="function"?Pe:k(+Pe),De):ve},De.paddingLeft=function(Pe){return arguments.length?(ge=typeof Pe=="function"?Pe:k(+Pe),De):ge},De},t.treemapBinary=function(le,fe,ue,we,Ae){var Se,ke,Me=le.children,ve=Me.length,ge=new Array(ve+1);for(ge[0]=ke=Se=0;Se<ve;++Se)ge[Se+1]=ke+=Me[Se].value;(function De(_e,Pe,Fe,ze,He,et,Re){if(_e>=Pe-1){var Ze=Me[_e];return Ze.x0=ze,Ze.y0=He,Ze.x1=et,void(Ze.y1=Re)}for(var Ke=ge[_e],$e=Fe/2+Ke,rt=_e+1,at=Pe-1;rt<at;){var lt=rt+at>>>1;ge[lt]<$e?rt=lt+1:at=lt}$e-ge[rt-1]<ge[rt]-$e&&_e+1<rt&&--rt;var gt=ge[rt]-Ke,Ie=Fe-gt;if(et-ze>Re-He){var be=(ze*Ie+et*gt)/Fe;De(_e,rt,gt,ze,He,be,Re),De(rt,Pe,Ie,be,He,et,Re)}else{var We=(He*Ie+Re*gt)/Fe;De(_e,rt,gt,ze,He,et,We),De(rt,Pe,Ie,ze,We,et,Re)}})(0,ve,le.value,fe,ue,we,Ae)},t.treemapDice=J,t.treemapResquarify=de,t.treemapSlice=ee,t.treemapSliceDice=function(le,fe,ue,we,Ae){(1&le.depth?ee:J)(le,fe,ue,we,Ae)},t.treemapSquarify=oe,Object.defineProperty(t,"__esModule",{value:!0})})},{}],162:[function(n,z,q){(function(t,h){typeof q=="object"&&typeof z<"u"?h(q,n("d3-color")):h((t=t||self).d3=t.d3||{},t.d3)})(this,function(t,h){"use strict";function p(ie,ae,oe,de,le){var fe=ie*ie,ue=fe*ie;return((1-3*ie+3*fe-ue)*ae+(4-6*fe+3*ue)*oe+(1+3*ie+3*fe-3*ue)*de+ue*le)/6}function l(ie){var ae=ie.length-1;return function(oe){var de=oe<=0?oe=0:oe>=1?(oe=1,ae-1):Math.floor(oe*ae),le=ie[de],fe=ie[de+1],ue=de>0?ie[de-1]:2*le-fe,we=de<ae-1?ie[de+2]:2*fe-le;return p((oe-de/ae)*ae,ue,le,fe,we)}}function e(ie){var ae=ie.length;return function(oe){var de=Math.floor(((oe%=1)<0?++oe:oe)*ae),le=ie[(de+ae-1)%ae],fe=ie[de%ae],ue=ie[(de+1)%ae],we=ie[(de+2)%ae];return p((oe-de/ae)*ae,le,fe,ue,we)}}function o(ie){return function(){return ie}}function r(ie,ae){return function(oe){return ie+oe*ae}}function i(ie,ae){var oe=ae-ie;return oe?r(ie,oe>180||oe<-180?oe-360*Math.round(oe/360):oe):o(isNaN(ie)?ae:ie)}function u(ie){return(ie=+ie)==1?s:function(ae,oe){return oe-ae?function(de,le,fe){return de=Math.pow(de,fe),le=Math.pow(le,fe)-de,fe=1/fe,function(ue){return Math.pow(de+ue*le,fe)}}(ae,oe,ie):o(isNaN(ae)?oe:ae)}}function s(ie,ae){var oe=ae-ie;return oe?r(ie,oe):o(isNaN(ie)?ae:ie)}var a=function ie(ae){var oe=u(ae);function de(le,fe){var ue=oe((le=h.rgb(le)).r,(fe=h.rgb(fe)).r),we=oe(le.g,fe.g),Ae=oe(le.b,fe.b),Se=s(le.opacity,fe.opacity);return function(ke){return le.r=ue(ke),le.g=we(ke),le.b=Ae(ke),le.opacity=Se(ke),le+""}}return de.gamma=ie,de}(1);function c(ie){return function(ae){var oe,de,le=ae.length,fe=new Array(le),ue=new Array(le),we=new Array(le);for(oe=0;oe<le;++oe)de=h.rgb(ae[oe]),fe[oe]=de.r||0,ue[oe]=de.g||0,we[oe]=de.b||0;return fe=ie(fe),ue=ie(ue),we=ie(we),de.opacity=1,function(Ae){return de.r=fe(Ae),de.g=ue(Ae),de.b=we(Ae),de+""}}}var f=c(l),g=c(e);function d(ie,ae){ae||(ae=[]);var oe,de=ie?Math.min(ae.length,ie.length):0,le=ae.slice();return function(fe){for(oe=0;oe<de;++oe)le[oe]=ie[oe]*(1-fe)+ae[oe]*fe;return le}}function m(ie){return ArrayBuffer.isView(ie)&&!(ie instanceof DataView)}function y(ie,ae){var oe,de=ae?ae.length:0,le=ie?Math.min(de,ie.length):0,fe=new Array(le),ue=new Array(de);for(oe=0;oe<le;++oe)fe[oe]=b(ie[oe],ae[oe]);for(;oe<de;++oe)ue[oe]=ae[oe];return function(we){for(oe=0;oe<le;++oe)ue[oe]=fe[oe](we);return ue}}function v(ie,ae){var oe=new Date;return ie=+ie,ae=+ae,function(de){return oe.setTime(ie*(1-de)+ae*de),oe}}function T(ie,ae){return ie=+ie,ae=+ae,function(oe){return ie*(1-oe)+ae*oe}}function w(ie,ae){var oe,de={},le={};for(oe in ie!==null&&typeof ie=="object"||(ie={}),ae!==null&&typeof ae=="object"||(ae={}),ae)oe in ie?de[oe]=b(ie[oe],ae[oe]):le[oe]=ae[oe];return function(fe){for(oe in de)le[oe]=de[oe](fe);return le}}var A=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,E=new RegExp(A.source,"g");function M(ie,ae){var oe,de,le,fe=A.lastIndex=E.lastIndex=0,ue=-1,we=[],Ae=[];for(ie+="",ae+="";(oe=A.exec(ie))&&(de=E.exec(ae));)(le=de.index)>fe&&(le=ae.slice(fe,le),we[ue]?we[ue]+=le:we[++ue]=le),(oe=oe[0])===(de=de[0])?we[ue]?we[ue]+=de:we[++ue]=de:(we[++ue]=null,Ae.push({i:ue,x:T(oe,de)})),fe=E.lastIndex;return fe<ae.length&&(le=ae.slice(fe),we[ue]?we[ue]+=le:we[++ue]=le),we.length<2?Ae[0]?function(Se){return function(ke){return Se(ke)+""}}(Ae[0].x):function(Se){return function(){return Se}}(ae):(ae=Ae.length,function(Se){for(var ke,Me=0;Me<ae;++Me)we[(ke=Ae[Me]).i]=ke.x(Se);return we.join("")})}function b(ie,ae){var oe,de=typeof ae;return ae==null||de==="boolean"?o(ae):(de==="number"?T:de==="string"?(oe=h.color(ae))?(ae=oe,a):M:ae instanceof h.color?a:ae instanceof Date?v:m(ae)?d:Array.isArray(ae)?y:typeof ae.valueOf!="function"&&typeof ae.toString!="function"||isNaN(ae)?w:T)(ie,ae)}var _,S,C,k,L=180/Math.PI,I={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function R(ie,ae,oe,de,le,fe){var ue,we,Ae;return(ue=Math.sqrt(ie*ie+ae*ae))&&(ie/=ue,ae/=ue),(Ae=ie*oe+ae*de)&&(oe-=ie*Ae,de-=ae*Ae),(we=Math.sqrt(oe*oe+de*de))&&(oe/=we,de/=we,Ae/=we),ie*de<ae*oe&&(ie=-ie,ae=-ae,Ae=-Ae,ue=-ue),{translateX:le,translateY:fe,rotate:Math.atan2(ae,ie)*L,skewX:Math.atan(Ae)*L,scaleX:ue,scaleY:we}}function V(ie,ae,oe,de){function le(fe){return fe.length?fe.pop()+" ":""}return function(fe,ue){var we=[],Ae=[];return fe=ie(fe),ue=ie(ue),function(Se,ke,Me,ve,ge,De){if(Se!==Me||ke!==ve){var _e=ge.push("translate(",null,ae,null,oe);De.push({i:_e-4,x:T(Se,Me)},{i:_e-2,x:T(ke,ve)})}else(Me||ve)&&ge.push("translate("+Me+ae+ve+oe)}(fe.translateX,fe.translateY,ue.translateX,ue.translateY,we,Ae),function(Se,ke,Me,ve){Se!==ke?(Se-ke>180?ke+=360:ke-Se>180&&(Se+=360),ve.push({i:Me.push(le(Me)+"rotate(",null,de)-2,x:T(Se,ke)})):ke&&Me.push(le(Me)+"rotate("+ke+de)}(fe.rotate,ue.rotate,we,Ae),function(Se,ke,Me,ve){Se!==ke?ve.push({i:Me.push(le(Me)+"skewX(",null,de)-2,x:T(Se,ke)}):ke&&Me.push(le(Me)+"skewX("+ke+de)}(fe.skewX,ue.skewX,we,Ae),function(Se,ke,Me,ve,ge,De){if(Se!==Me||ke!==ve){var _e=ge.push(le(ge)+"scale(",null,",",null,")");De.push({i:_e-4,x:T(Se,Me)},{i:_e-2,x:T(ke,ve)})}else Me===1&&ve===1||ge.push(le(ge)+"scale("+Me+","+ve+")")}(fe.scaleX,fe.scaleY,ue.scaleX,ue.scaleY,we,Ae),fe=ue=null,function(Se){for(var ke,Me=-1,ve=Ae.length;++Me<ve;)we[(ke=Ae[Me]).i]=ke.x(Se);return we.join("")}}}var O=V(function(ie){return ie==="none"?I:(_||(_=document.createElement("DIV"),S=document.documentElement,C=document.defaultView),_.style.transform=ie,ie=C.getComputedStyle(S.appendChild(_),null).getPropertyValue("transform"),S.removeChild(_),R(+(ie=ie.slice(7,-1).split(","))[0],+ie[1],+ie[2],+ie[3],+ie[4],+ie[5]))},"px, ","px)","deg)"),J=V(function(ie){return ie==null?I:(k||(k=document.createElementNS("http://www.w3.org/2000/svg","g")),k.setAttribute("transform",ie),(ie=k.transform.baseVal.consolidate())?R((ie=ie.matrix).a,ie.b,ie.c,ie.d,ie.e,ie.f):I)},", ",")",")"),D=Math.SQRT2;function B(ie){return((ie=Math.exp(ie))+1/ie)/2}function N(ie){return function(ae,oe){var de=ie((ae=h.hsl(ae)).h,(oe=h.hsl(oe)).h),le=s(ae.s,oe.s),fe=s(ae.l,oe.l),ue=s(ae.opacity,oe.opacity);return function(we){return ae.h=de(we),ae.s=le(we),ae.l=fe(we),ae.opacity=ue(we),ae+""}}}var F=N(i),H=N(s);function j(ie){return function(ae,oe){var de=ie((ae=h.hcl(ae)).h,(oe=h.hcl(oe)).h),le=s(ae.c,oe.c),fe=s(ae.l,oe.l),ue=s(ae.opacity,oe.opacity);return function(we){return ae.h=de(we),ae.c=le(we),ae.l=fe(we),ae.opacity=ue(we),ae+""}}}var G=j(i),W=j(s);function Q(ie){return function ae(oe){function de(le,fe){var ue=ie((le=h.cubehelix(le)).h,(fe=h.cubehelix(fe)).h),we=s(le.s,fe.s),Ae=s(le.l,fe.l),Se=s(le.opacity,fe.opacity);return function(ke){return le.h=ue(ke),le.s=we(ke),le.l=Ae(Math.pow(ke,oe)),le.opacity=Se(ke),le+""}}return oe=+oe,de.gamma=ae,de}(1)}var $=Q(i),ee=Q(s);t.interpolate=b,t.interpolateArray=function(ie,ae){return(m(ae)?d:y)(ie,ae)},t.interpolateBasis=l,t.interpolateBasisClosed=e,t.interpolateCubehelix=$,t.interpolateCubehelixLong=ee,t.interpolateDate=v,t.interpolateDiscrete=function(ie){var ae=ie.length;return function(oe){return ie[Math.max(0,Math.min(ae-1,Math.floor(oe*ae)))]}},t.interpolateHcl=G,t.interpolateHclLong=W,t.interpolateHsl=F,t.interpolateHslLong=H,t.interpolateHue=function(ie,ae){var oe=i(+ie,+ae);return function(de){var le=oe(de);return le-360*Math.floor(le/360)}},t.interpolateLab=function(ie,ae){var oe=s((ie=h.lab(ie)).l,(ae=h.lab(ae)).l),de=s(ie.a,ae.a),le=s(ie.b,ae.b),fe=s(ie.opacity,ae.opacity);return function(ue){return ie.l=oe(ue),ie.a=de(ue),ie.b=le(ue),ie.opacity=fe(ue),ie+""}},t.interpolateNumber=T,t.interpolateNumberArray=d,t.interpolateObject=w,t.interpolateRgb=a,t.interpolateRgbBasis=f,t.interpolateRgbBasisClosed=g,t.interpolateRound=function(ie,ae){return ie=+ie,ae=+ae,function(oe){return Math.round(ie*(1-oe)+ae*oe)}},t.interpolateString=M,t.interpolateTransformCss=O,t.interpolateTransformSvg=J,t.interpolateZoom=function(ie,ae){var oe,de,le=ie[0],fe=ie[1],ue=ie[2],we=ae[0],Ae=ae[1],Se=ae[2],ke=we-le,Me=Ae-fe,ve=ke*ke+Me*Me;if(ve<1e-12)de=Math.log(Se/ue)/D,oe=function(ze){return[le+ze*ke,fe+ze*Me,ue*Math.exp(D*ze*de)]};else{var ge=Math.sqrt(ve),De=(Se*Se-ue*ue+4*ve)/(2*ue*2*ge),_e=(Se*Se-ue*ue-4*ve)/(2*Se*2*ge),Pe=Math.log(Math.sqrt(De*De+1)-De),Fe=Math.log(Math.sqrt(_e*_e+1)-_e);de=(Fe-Pe)/D,oe=function(ze){var He,et=ze*de,Re=B(Pe),Ze=ue/(2*ge)*(Re*(He=D*et+Pe,((He=Math.exp(2*He))-1)/(He+1))-function(Ke){return((Ke=Math.exp(Ke))-1/Ke)/2}(Pe));return[le+Ze*ke,fe+Ze*Me,ue*Re/B(D*et+Pe)]}}return oe.duration=1e3*de,oe},t.piecewise=function(ie,ae){for(var oe=0,de=ae.length-1,le=ae[0],fe=new Array(de<0?0:de);oe<de;)fe[oe]=ie(le,le=ae[++oe]);return function(ue){var we=Math.max(0,Math.min(de-1,Math.floor(ue*=de)));return fe[we](ue-we)}},t.quantize=function(ie,ae){for(var oe=new Array(ae),de=0;de<ae;++de)oe[de]=ie(de/(ae-1));return oe},Object.defineProperty(t,"__esModule",{value:!0})})},{"d3-color":158}],163:[function(n,z,q){(function(t,h){h(typeof q=="object"&&typeof z<"u"?q:(t=t||self).d3=t.d3||{})})(this,function(t){"use strict";var h=Math.PI,p=2*h,l=p-1e-6;function e(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function o(){return new e}e.prototype=o.prototype={constructor:e,moveTo:function(r,i){this._+="M"+(this._x0=this._x1=+r)+","+(this._y0=this._y1=+i)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(r,i){this._+="L"+(this._x1=+r)+","+(this._y1=+i)},quadraticCurveTo:function(r,i,u,s){this._+="Q"+ +r+","+ +i+","+(this._x1=+u)+","+(this._y1=+s)},bezierCurveTo:function(r,i,u,s,a,c){this._+="C"+ +r+","+ +i+","+ +u+","+ +s+","+(this._x1=+a)+","+(this._y1=+c)},arcTo:function(r,i,u,s,a){r=+r,i=+i,u=+u,s=+s,a=+a;var c=this._x1,f=this._y1,g=u-r,d=s-i,m=c-r,y=f-i,v=m*m+y*y;if(a<0)throw new Error("negative radius: "+a);if(this._x1===null)this._+="M"+(this._x1=r)+","+(this._y1=i);else if(v>1e-6)if(Math.abs(y*g-d*m)>1e-6&&a){var T=u-c,w=s-f,A=g*g+d*d,E=T*T+w*w,M=Math.sqrt(A),b=Math.sqrt(v),_=a*Math.tan((h-Math.acos((A+v-E)/(2*M*b)))/2),S=_/b,C=_/M;Math.abs(S-1)>1e-6&&(this._+="L"+(r+S*m)+","+(i+S*y)),this._+="A"+a+","+a+",0,0,"+ +(y*T>m*w)+","+(this._x1=r+C*g)+","+(this._y1=i+C*d)}else this._+="L"+(this._x1=r)+","+(this._y1=i)},arc:function(r,i,u,s,a,c){r=+r,i=+i,c=!!c;var f=(u=+u)*Math.cos(s),g=u*Math.sin(s),d=r+f,m=i+g,y=1^c,v=c?s-a:a-s;if(u<0)throw new Error("negative radius: "+u);this._x1===null?this._+="M"+d+","+m:(Math.abs(this._x1-d)>1e-6||Math.abs(this._y1-m)>1e-6)&&(this._+="L"+d+","+m),u&&(v<0&&(v=v%p+p),v>l?this._+="A"+u+","+u+",0,1,"+y+","+(r-f)+","+(i-g)+"A"+u+","+u+",0,1,"+y+","+(this._x1=d)+","+(this._y1=m):v>1e-6&&(this._+="A"+u+","+u+",0,"+ +(v>=h)+","+y+","+(this._x1=r+u*Math.cos(a))+","+(this._y1=i+u*Math.sin(a))))},rect:function(r,i,u,s){this._+="M"+(this._x0=this._x1=+r)+","+(this._y0=this._y1=+i)+"h"+ +u+"v"+ +s+"h"+-u+"Z"},toString:function(){return this._}},t.path=o,Object.defineProperty(t,"__esModule",{value:!0})})},{}],164:[function(n,z,q){(function(t,h){h(typeof q=="object"&&typeof z<"u"?q:(t=t||self).d3=t.d3||{})})(this,function(t){"use strict";function h(s,a,c,f){if(isNaN(a)||isNaN(c))return s;var g,d,m,y,v,T,w,A,E,M=s._root,b={data:f},_=s._x0,S=s._y0,C=s._x1,k=s._y1;if(!M)return s._root=b,s;for(;M.length;)if((T=a>=(d=(_+C)/2))?_=d:C=d,(w=c>=(m=(S+k)/2))?S=m:k=m,g=M,!(M=M[A=w<<1|T]))return g[A]=b,s;if(y=+s._x.call(null,M.data),v=+s._y.call(null,M.data),a===y&&c===v)return b.next=M,g?g[A]=b:s._root=b,s;do g=g?g[A]=new Array(4):s._root=new Array(4),(T=a>=(d=(_+C)/2))?_=d:C=d,(w=c>=(m=(S+k)/2))?S=m:k=m;while((A=w<<1|T)==(E=(v>=m)<<1|y>=d));return g[E]=M,g[A]=b,s}function p(s,a,c,f,g){this.node=s,this.x0=a,this.y0=c,this.x1=f,this.y1=g}function l(s){return s[0]}function e(s){return s[1]}function o(s,a,c){var f=new r(a??l,c??e,NaN,NaN,NaN,NaN);return s==null?f:f.addAll(s)}function r(s,a,c,f,g,d){this._x=s,this._y=a,this._x0=c,this._y0=f,this._x1=g,this._y1=d,this._root=void 0}function i(s){for(var a={data:s.data},c=a;s=s.next;)c=c.next={data:s.data};return a}var u=o.prototype=r.prototype;u.copy=function(){var s,a,c=new r(this._x,this._y,this._x0,this._y0,this._x1,this._y1),f=this._root;if(!f)return c;if(!f.length)return c._root=i(f),c;for(s=[{source:f,target:c._root=new Array(4)}];f=s.pop();)for(var g=0;g<4;++g)(a=f.source[g])&&(a.length?s.push({source:a,target:f.target[g]=new Array(4)}):f.target[g]=i(a));return c},u.add=function(s){var a=+this._x.call(null,s),c=+this._y.call(null,s);return h(this.cover(a,c),a,c,s)},u.addAll=function(s){var a,c,f,g,d=s.length,m=new Array(d),y=new Array(d),v=1/0,T=1/0,w=-1/0,A=-1/0;for(c=0;c<d;++c)isNaN(f=+this._x.call(null,a=s[c]))||isNaN(g=+this._y.call(null,a))||(m[c]=f,y[c]=g,f<v&&(v=f),f>w&&(w=f),g<T&&(T=g),g>A&&(A=g));if(v>w||T>A)return this;for(this.cover(v,T).cover(w,A),c=0;c<d;++c)h(this,m[c],y[c],s[c]);return this},u.cover=function(s,a){if(isNaN(s=+s)||isNaN(a=+a))return this;var c=this._x0,f=this._y0,g=this._x1,d=this._y1;if(isNaN(c))g=(c=Math.floor(s))+1,d=(f=Math.floor(a))+1;else{for(var m,y,v=g-c,T=this._root;c>s||s>=g||f>a||a>=d;)switch(y=(a<f)<<1|s<c,(m=new Array(4))[y]=T,T=m,v*=2,y){case 0:g=c+v,d=f+v;break;case 1:c=g-v,d=f+v;break;case 2:g=c+v,f=d-v;break;case 3:c=g-v,f=d-v}this._root&&this._root.length&&(this._root=T)}return this._x0=c,this._y0=f,this._x1=g,this._y1=d,this},u.data=function(){var s=[];return this.visit(function(a){if(!a.length)do s.push(a.data);while(a=a.next)}),s},u.extent=function(s){return arguments.length?this.cover(+s[0][0],+s[0][1]).cover(+s[1][0],+s[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},u.find=function(s,a,c){var f,g,d,m,y,v,T,w=this._x0,A=this._y0,E=this._x1,M=this._y1,b=[],_=this._root;for(_&&b.push(new p(_,w,A,E,M)),c==null?c=1/0:(w=s-c,A=a-c,E=s+c,M=a+c,c*=c);v=b.pop();)if(!(!(_=v.node)||(g=v.x0)>E||(d=v.y0)>M||(m=v.x1)<w||(y=v.y1)<A))if(_.length){var S=(g+m)/2,C=(d+y)/2;b.push(new p(_[3],S,C,m,y),new p(_[2],g,C,S,y),new p(_[1],S,d,m,C),new p(_[0],g,d,S,C)),(T=(a>=C)<<1|s>=S)&&(v=b[b.length-1],b[b.length-1]=b[b.length-1-T],b[b.length-1-T]=v)}else{var k=s-+this._x.call(null,_.data),L=a-+this._y.call(null,_.data),I=k*k+L*L;if(I<c){var R=Math.sqrt(c=I);w=s-R,A=a-R,E=s+R,M=a+R,f=_.data}}return f},u.remove=function(s){if(isNaN(d=+this._x.call(null,s))||isNaN(m=+this._y.call(null,s)))return this;var a,c,f,g,d,m,y,v,T,w,A,E,M=this._root,b=this._x0,_=this._y0,S=this._x1,C=this._y1;if(!M)return this;if(M.length)for(;;){if((T=d>=(y=(b+S)/2))?b=y:S=y,(w=m>=(v=(_+C)/2))?_=v:C=v,a=M,!(M=M[A=w<<1|T]))return this;if(!M.length)break;(a[A+1&3]||a[A+2&3]||a[A+3&3])&&(c=a,E=A)}for(;M.data!==s;)if(f=M,!(M=M.next))return this;return(g=M.next)&&delete M.next,f?(g?f.next=g:delete f.next,this):a?(g?a[A]=g:delete a[A],(M=a[0]||a[1]||a[2]||a[3])&&M===(a[3]||a[2]||a[1]||a[0])&&!M.length&&(c?c[E]=M:this._root=M),this):(this._root=g,this)},u.removeAll=function(s){for(var a=0,c=s.length;a<c;++a)this.remove(s[a]);return this},u.root=function(){return this._root},u.size=function(){var s=0;return this.visit(function(a){if(!a.length)do++s;while(a=a.next)}),s},u.visit=function(s){var a,c,f,g,d,m,y=[],v=this._root;for(v&&y.push(new p(v,this._x0,this._y0,this._x1,this._y1));a=y.pop();)if(!s(v=a.node,f=a.x0,g=a.y0,d=a.x1,m=a.y1)&&v.length){var T=(f+d)/2,w=(g+m)/2;(c=v[3])&&y.push(new p(c,T,w,d,m)),(c=v[2])&&y.push(new p(c,f,w,T,m)),(c=v[1])&&y.push(new p(c,T,g,d,w)),(c=v[0])&&y.push(new p(c,f,g,T,w))}return this},u.visitAfter=function(s){var a,c=[],f=[];for(this._root&&c.push(new p(this._root,this._x0,this._y0,this._x1,this._y1));a=c.pop();){var g=a.node;if(g.length){var d,m=a.x0,y=a.y0,v=a.x1,T=a.y1,w=(m+v)/2,A=(y+T)/2;(d=g[0])&&c.push(new p(d,m,y,w,A)),(d=g[1])&&c.push(new p(d,w,y,v,A)),(d=g[2])&&c.push(new p(d,m,A,w,T)),(d=g[3])&&c.push(new p(d,w,A,v,T))}f.push(a)}for(;a=f.pop();)s(a.node,a.x0,a.y0,a.x1,a.y1);return this},u.x=function(s){return arguments.length?(this._x=s,this):this._x},u.y=function(s){return arguments.length?(this._y=s,this):this._y},t.quadtree=o,Object.defineProperty(t,"__esModule",{value:!0})})},{}],165:[function(n,z,q){(function(t,h){typeof q=="object"&&typeof z<"u"?h(q,n("d3-path")):h((t=t||self).d3=t.d3||{},t.d3)})(this,function(t,h){"use strict";function p(Ne){return function(){return Ne}}var l=Math.abs,e=Math.atan2,o=Math.cos,r=Math.max,i=Math.min,u=Math.sin,s=Math.sqrt,a=Math.PI,c=a/2,f=2*a;function g(Ne){return Ne>1?0:Ne<-1?a:Math.acos(Ne)}function d(Ne){return Ne>=1?c:Ne<=-1?-c:Math.asin(Ne)}function m(Ne){return Ne.innerRadius}function y(Ne){return Ne.outerRadius}function v(Ne){return Ne.startAngle}function T(Ne){return Ne.endAngle}function w(Ne){return Ne&&Ne.padAngle}function A(Ne,ut,wt,Bt,Jt,er,or,zt){var Qt=wt-Ne,cr=Bt-ut,Dt=or-Jt,Ut=zt-er,ur=Ut*Qt-Dt*cr;if(!(ur*ur<1e-12))return[Ne+(ur=(Dt*(ut-er)-Ut*(Ne-Jt))/ur)*Qt,ut+ur*cr]}function E(Ne,ut,wt,Bt,Jt,er,or){var zt=Ne-wt,Qt=ut-Bt,cr=(or?er:-er)/s(zt*zt+Qt*Qt),Dt=cr*Qt,Ut=-cr*zt,ur=Ne+Dt,Sr=ut+Ut,Lr=wt+Dt,Hr=Bt+Ut,Kr=(ur+Lr)/2,Ir=(Sr+Hr)/2,kr=Lr-ur,rn=Hr-Sr,Qr=kr*kr+rn*rn,nn=Jt-er,Xr=ur*Hr-Lr*Sr,Nr=(rn<0?-1:1)*s(r(0,nn*nn*Qr-Xr*Xr)),Br=(Xr*rn-kr*Nr)/Qr,on=(-Xr*kr-rn*Nr)/Qr,cn=(Xr*rn+kr*Nr)/Qr,un=(-Xr*kr+rn*Nr)/Qr,Zr=Br-Kr,yn=on-Ir,In=cn-Kr,Un=un-Ir;return Zr*Zr+yn*yn>In*In+Un*Un&&(Br=cn,on=un),{cx:Br,cy:on,x01:-Dt,y01:-Ut,x11:Br*(Jt/nn-1),y11:on*(Jt/nn-1)}}function M(Ne){this._context=Ne}function b(Ne){return new M(Ne)}function _(Ne){return Ne[0]}function S(Ne){return Ne[1]}function C(){var Ne=_,ut=S,wt=p(!0),Bt=null,Jt=b,er=null;function or(zt){var Qt,cr,Dt,Ut=zt.length,ur=!1;for(Bt==null&&(er=Jt(Dt=h.path())),Qt=0;Qt<=Ut;++Qt)!(Qt<Ut&&wt(cr=zt[Qt],Qt,zt))===ur&&((ur=!ur)?er.lineStart():er.lineEnd()),ur&&er.point(+Ne(cr,Qt,zt),+ut(cr,Qt,zt));if(Dt)return er=null,Dt+""||null}return or.x=function(zt){return arguments.length?(Ne=typeof zt=="function"?zt:p(+zt),or):Ne},or.y=function(zt){return arguments.length?(ut=typeof zt=="function"?zt:p(+zt),or):ut},or.defined=function(zt){return arguments.length?(wt=typeof zt=="function"?zt:p(!!zt),or):wt},or.curve=function(zt){return arguments.length?(Jt=zt,Bt!=null&&(er=Jt(Bt)),or):Jt},or.context=function(zt){return arguments.length?(zt==null?Bt=er=null:er=Jt(Bt=zt),or):Bt},or}function k(){var Ne=_,ut=null,wt=p(0),Bt=S,Jt=p(!0),er=null,or=b,zt=null;function Qt(Dt){var Ut,ur,Sr,Lr,Hr,Kr=Dt.length,Ir=!1,kr=new Array(Kr),rn=new Array(Kr);for(er==null&&(zt=or(Hr=h.path())),Ut=0;Ut<=Kr;++Ut){if(!(Ut<Kr&&Jt(Lr=Dt[Ut],Ut,Dt))===Ir)if(Ir=!Ir)ur=Ut,zt.areaStart(),zt.lineStart();else{for(zt.lineEnd(),zt.lineStart(),Sr=Ut-1;Sr>=ur;--Sr)zt.point(kr[Sr],rn[Sr]);zt.lineEnd(),zt.areaEnd()}Ir&&(kr[Ut]=+Ne(Lr,Ut,Dt),rn[Ut]=+wt(Lr,Ut,Dt),zt.point(ut?+ut(Lr,Ut,Dt):kr[Ut],Bt?+Bt(Lr,Ut,Dt):rn[Ut]))}if(Hr)return zt=null,Hr+""||null}function cr(){return C().defined(Jt).curve(or).context(er)}return Qt.x=function(Dt){return arguments.length?(Ne=typeof Dt=="function"?Dt:p(+Dt),ut=null,Qt):Ne},Qt.x0=function(Dt){return arguments.length?(Ne=typeof Dt=="function"?Dt:p(+Dt),Qt):Ne},Qt.x1=function(Dt){return arguments.length?(ut=Dt==null?null:typeof Dt=="function"?Dt:p(+Dt),Qt):ut},Qt.y=function(Dt){return arguments.length?(wt=typeof Dt=="function"?Dt:p(+Dt),Bt=null,Qt):wt},Qt.y0=function(Dt){return arguments.length?(wt=typeof Dt=="function"?Dt:p(+Dt),Qt):wt},Qt.y1=function(Dt){return arguments.length?(Bt=Dt==null?null:typeof Dt=="function"?Dt:p(+Dt),Qt):Bt},Qt.lineX0=Qt.lineY0=function(){return cr().x(Ne).y(wt)},Qt.lineY1=function(){return cr().x(Ne).y(Bt)},Qt.lineX1=function(){return cr().x(ut).y(wt)},Qt.defined=function(Dt){return arguments.length?(Jt=typeof Dt=="function"?Dt:p(!!Dt),Qt):Jt},Qt.curve=function(Dt){return arguments.length?(or=Dt,er!=null&&(zt=or(er)),Qt):or},Qt.context=function(Dt){return arguments.length?(Dt==null?er=zt=null:zt=or(er=Dt),Qt):er},Qt}function L(Ne,ut){return ut<Ne?-1:ut>Ne?1:ut>=Ne?0:NaN}function I(Ne){return Ne}M.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(Ne,ut){switch(Ne=+Ne,ut=+ut,this._point){case 0:this._point=1,this._line?this._context.lineTo(Ne,ut):this._context.moveTo(Ne,ut);break;case 1:this._point=2;default:this._context.lineTo(Ne,ut)}}};var R=O(b);function V(Ne){this._curve=Ne}function O(Ne){function ut(wt){return new V(Ne(wt))}return ut._curve=Ne,ut}function J(Ne){var ut=Ne.curve;return Ne.angle=Ne.x,delete Ne.x,Ne.radius=Ne.y,delete Ne.y,Ne.curve=function(wt){return arguments.length?ut(O(wt)):ut()._curve},Ne}function D(){return J(C().curve(R))}function B(){var Ne=k().curve(R),ut=Ne.curve,wt=Ne.lineX0,Bt=Ne.lineX1,Jt=Ne.lineY0,er=Ne.lineY1;return Ne.angle=Ne.x,delete Ne.x,Ne.startAngle=Ne.x0,delete Ne.x0,Ne.endAngle=Ne.x1,delete Ne.x1,Ne.radius=Ne.y,delete Ne.y,Ne.innerRadius=Ne.y0,delete Ne.y0,Ne.outerRadius=Ne.y1,delete Ne.y1,Ne.lineStartAngle=function(){return J(wt())},delete Ne.lineX0,Ne.lineEndAngle=function(){return J(Bt())},delete Ne.lineX1,Ne.lineInnerRadius=function(){return J(Jt())},delete Ne.lineY0,Ne.lineOuterRadius=function(){return J(er())},delete Ne.lineY1,Ne.curve=function(or){return arguments.length?ut(O(or)):ut()._curve},Ne}function N(Ne,ut){return[(ut=+ut)*Math.cos(Ne-=Math.PI/2),ut*Math.sin(Ne)]}V.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(Ne,ut){this._curve.point(ut*Math.sin(Ne),ut*-Math.cos(Ne))}};var F=Array.prototype.slice;function H(Ne){return Ne.source}function j(Ne){return Ne.target}function G(Ne){var ut=H,wt=j,Bt=_,Jt=S,er=null;function or(){var zt,Qt=F.call(arguments),cr=ut.apply(this,Qt),Dt=wt.apply(this,Qt);if(er||(er=zt=h.path()),Ne(er,+Bt.apply(this,(Qt[0]=cr,Qt)),+Jt.apply(this,Qt),+Bt.apply(this,(Qt[0]=Dt,Qt)),+Jt.apply(this,Qt)),zt)return er=null,zt+""||null}return or.source=function(zt){return arguments.length?(ut=zt,or):ut},or.target=function(zt){return arguments.length?(wt=zt,or):wt},or.x=function(zt){return arguments.length?(Bt=typeof zt=="function"?zt:p(+zt),or):Bt},or.y=function(zt){return arguments.length?(Jt=typeof zt=="function"?zt:p(+zt),or):Jt},or.context=function(zt){return arguments.length?(er=zt??null,or):er},or}function W(Ne,ut,wt,Bt,Jt){Ne.moveTo(ut,wt),Ne.bezierCurveTo(ut=(ut+Bt)/2,wt,ut,Jt,Bt,Jt)}function Q(Ne,ut,wt,Bt,Jt){Ne.moveTo(ut,wt),Ne.bezierCurveTo(ut,wt=(wt+Jt)/2,Bt,wt,Bt,Jt)}function $(Ne,ut,wt,Bt,Jt){var er=N(ut,wt),or=N(ut,wt=(wt+Jt)/2),zt=N(Bt,wt),Qt=N(Bt,Jt);Ne.moveTo(er[0],er[1]),Ne.bezierCurveTo(or[0],or[1],zt[0],zt[1],Qt[0],Qt[1])}var ee={draw:function(Ne,ut){var wt=Math.sqrt(ut/a);Ne.moveTo(wt,0),Ne.arc(0,0,wt,0,f)}},ie={draw:function(Ne,ut){var wt=Math.sqrt(ut/5)/2;Ne.moveTo(-3*wt,-wt),Ne.lineTo(-wt,-wt),Ne.lineTo(-wt,-3*wt),Ne.lineTo(wt,-3*wt),Ne.lineTo(wt,-wt),Ne.lineTo(3*wt,-wt),Ne.lineTo(3*wt,wt),Ne.lineTo(wt,wt),Ne.lineTo(wt,3*wt),Ne.lineTo(-wt,3*wt),Ne.lineTo(-wt,wt),Ne.lineTo(-3*wt,wt),Ne.closePath()}},ae=Math.sqrt(1/3),oe=2*ae,de={draw:function(Ne,ut){var wt=Math.sqrt(ut/oe),Bt=wt*ae;Ne.moveTo(0,-wt),Ne.lineTo(Bt,0),Ne.lineTo(0,wt),Ne.lineTo(-Bt,0),Ne.closePath()}},le=Math.sin(a/10)/Math.sin(7*a/10),fe=Math.sin(f/10)*le,ue=-Math.cos(f/10)*le,we={draw:function(Ne,ut){var wt=Math.sqrt(.8908130915292852*ut),Bt=fe*wt,Jt=ue*wt;Ne.moveTo(0,-wt),Ne.lineTo(Bt,Jt);for(var er=1;er<5;++er){var or=f*er/5,zt=Math.cos(or),Qt=Math.sin(or);Ne.lineTo(Qt*wt,-zt*wt),Ne.lineTo(zt*Bt-Qt*Jt,Qt*Bt+zt*Jt)}Ne.closePath()}},Ae={draw:function(Ne,ut){var wt=Math.sqrt(ut),Bt=-wt/2;Ne.rect(Bt,Bt,wt,wt)}},Se=Math.sqrt(3),ke={draw:function(Ne,ut){var wt=-Math.sqrt(ut/(3*Se));Ne.moveTo(0,2*wt),Ne.lineTo(-Se*wt,-wt),Ne.lineTo(Se*wt,-wt),Ne.closePath()}},Me=-.5,ve=Math.sqrt(3)/2,ge=1/Math.sqrt(12),De=3*(ge/2+1),_e={draw:function(Ne,ut){var wt=Math.sqrt(ut/De),Bt=wt/2,Jt=wt*ge,er=Bt,or=wt*ge+wt,zt=-er,Qt=or;Ne.moveTo(Bt,Jt),Ne.lineTo(er,or),Ne.lineTo(zt,Qt),Ne.lineTo(Me*Bt-ve*Jt,ve*Bt+Me*Jt),Ne.lineTo(Me*er-ve*or,ve*er+Me*or),Ne.lineTo(Me*zt-ve*Qt,ve*zt+Me*Qt),Ne.lineTo(Me*Bt+ve*Jt,Me*Jt-ve*Bt),Ne.lineTo(Me*er+ve*or,Me*or-ve*er),Ne.lineTo(Me*zt+ve*Qt,Me*Qt-ve*zt),Ne.closePath()}},Pe=[ee,ie,de,Ae,we,ke,_e];function Fe(){}function ze(Ne,ut,wt){Ne._context.bezierCurveTo((2*Ne._x0+Ne._x1)/3,(2*Ne._y0+Ne._y1)/3,(Ne._x0+2*Ne._x1)/3,(Ne._y0+2*Ne._y1)/3,(Ne._x0+4*Ne._x1+ut)/6,(Ne._y0+4*Ne._y1+wt)/6)}function He(Ne){this._context=Ne}function et(Ne){this._context=Ne}function Re(Ne){this._context=Ne}function Ze(Ne,ut){this._basis=new He(Ne),this._beta=ut}He.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:ze(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(Ne,ut){switch(Ne=+Ne,ut=+ut,this._point){case 0:this._point=1,this._line?this._context.lineTo(Ne,ut):this._context.moveTo(Ne,ut);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:ze(this,Ne,ut)}this._x0=this._x1,this._x1=Ne,this._y0=this._y1,this._y1=ut}},et.prototype={areaStart:Fe,areaEnd:Fe,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(Ne,ut){switch(Ne=+Ne,ut=+ut,this._point){case 0:this._point=1,this._x2=Ne,this._y2=ut;break;case 1:this._point=2,this._x3=Ne,this._y3=ut;break;case 2:this._point=3,this._x4=Ne,this._y4=ut,this._context.moveTo((this._x0+4*this._x1+Ne)/6,(this._y0+4*this._y1+ut)/6);break;default:ze(this,Ne,ut)}this._x0=this._x1,this._x1=Ne,this._y0=this._y1,this._y1=ut}},Re.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(Ne,ut){switch(Ne=+Ne,ut=+ut,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var wt=(this._x0+4*this._x1+Ne)/6,Bt=(this._y0+4*this._y1+ut)/6;this._line?this._context.lineTo(wt,Bt):this._context.moveTo(wt,Bt);break;case 3:this._point=4;default:ze(this,Ne,ut)}this._x0=this._x1,this._x1=Ne,this._y0=this._y1,this._y1=ut}},Ze.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var Ne=this._x,ut=this._y,wt=Ne.length-1;if(wt>0)for(var Bt,Jt=Ne[0],er=ut[0],or=Ne[wt]-Jt,zt=ut[wt]-er,Qt=-1;++Qt<=wt;)Bt=Qt/wt,this._basis.point(this._beta*Ne[Qt]+(1-this._beta)*(Jt+Bt*or),this._beta*ut[Qt]+(1-this._beta)*(er+Bt*zt));this._x=this._y=null,this._basis.lineEnd()},point:function(Ne,ut){this._x.push(+Ne),this._y.push(+ut)}};var Ke=function Ne(ut){function wt(Bt){return ut===1?new He(Bt):new Ze(Bt,ut)}return wt.beta=function(Bt){return Ne(+Bt)},wt}(.85);function $e(Ne,ut,wt){Ne._context.bezierCurveTo(Ne._x1+Ne._k*(Ne._x2-Ne._x0),Ne._y1+Ne._k*(Ne._y2-Ne._y0),Ne._x2+Ne._k*(Ne._x1-ut),Ne._y2+Ne._k*(Ne._y1-wt),Ne._x2,Ne._y2)}function rt(Ne,ut){this._context=Ne,this._k=(1-ut)/6}rt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:$e(this,this._x1,this._y1)}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(Ne,ut){switch(Ne=+Ne,ut=+ut,this._point){case 0:this._point=1,this._line?this._context.lineTo(Ne,ut):this._context.moveTo(Ne,ut);break;case 1:this._point=2,this._x1=Ne,this._y1=ut;break;case 2:this._point=3;default:$e(this,Ne,ut)}this._x0=this._x1,this._x1=this._x2,this._x2=Ne,this._y0=this._y1,this._y1=this._y2,this._y2=ut}};var at=function Ne(ut){function wt(Bt){return new rt(Bt,ut)}return wt.tension=function(Bt){return Ne(+Bt)},wt}(0);function lt(Ne,ut){this._context=Ne,this._k=(1-ut)/6}lt.prototype={areaStart:Fe,areaEnd:Fe,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(Ne,ut){switch(Ne=+Ne,ut=+ut,this._point){case 0:this._point=1,this._x3=Ne,this._y3=ut;break;case 1:this._point=2,this._context.moveTo(this._x4=Ne,this._y4=ut);break;case 2:this._point=3,this._x5=Ne,this._y5=ut;break;default:$e(this,Ne,ut)}this._x0=this._x1,this._x1=this._x2,this._x2=Ne,this._y0=this._y1,this._y1=this._y2,this._y2=ut}};var gt=function Ne(ut){function wt(Bt){return new lt(Bt,ut)}return wt.tension=function(Bt){return Ne(+Bt)},wt}(0);function Ie(Ne,ut){this._context=Ne,this._k=(1-ut)/6}Ie.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(Ne,ut){switch(Ne=+Ne,ut=+ut,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:$e(this,Ne,ut)}this._x0=this._x1,this._x1=this._x2,this._x2=Ne,this._y0=this._y1,this._y1=this._y2,this._y2=ut}};var be=function Ne(ut){function wt(Bt){return new Ie(Bt,ut)}return wt.tension=function(Bt){return Ne(+Bt)},wt}(0);function We(Ne,ut,wt){var Bt=Ne._x1,Jt=Ne._y1,er=Ne._x2,or=Ne._y2;if(Ne._l01_a>1e-12){var zt=2*Ne._l01_2a+3*Ne._l01_a*Ne._l12_a+Ne._l12_2a,Qt=3*Ne._l01_a*(Ne._l01_a+Ne._l12_a);Bt=(Bt*zt-Ne._x0*Ne._l12_2a+Ne._x2*Ne._l01_2a)/Qt,Jt=(Jt*zt-Ne._y0*Ne._l12_2a+Ne._y2*Ne._l01_2a)/Qt}if(Ne._l23_a>1e-12){var cr=2*Ne._l23_2a+3*Ne._l23_a*Ne._l12_a+Ne._l12_2a,Dt=3*Ne._l23_a*(Ne._l23_a+Ne._l12_a);er=(er*cr+Ne._x1*Ne._l23_2a-ut*Ne._l12_2a)/Dt,or=(or*cr+Ne._y1*Ne._l23_2a-wt*Ne._l12_2a)/Dt}Ne._context.bezierCurveTo(Bt,Jt,er,or,Ne._x2,Ne._y2)}function Ge(Ne,ut){this._context=Ne,this._alpha=ut}Ge.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(Ne,ut){if(Ne=+Ne,ut=+ut,this._point){var wt=this._x2-Ne,Bt=this._y2-ut;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(wt*wt+Bt*Bt,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(Ne,ut):this._context.moveTo(Ne,ut);break;case 1:this._point=2;break;case 2:this._point=3;default:We(this,Ne,ut)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=Ne,this._y0=this._y1,this._y1=this._y2,this._y2=ut}};var st=function Ne(ut){function wt(Bt){return ut?new Ge(Bt,ut):new rt(Bt,0)}return wt.alpha=function(Bt){return Ne(+Bt)},wt}(.5);function ot(Ne,ut){this._context=Ne,this._alpha=ut}ot.prototype={areaStart:Fe,areaEnd:Fe,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(Ne,ut){if(Ne=+Ne,ut=+ut,this._point){var wt=this._x2-Ne,Bt=this._y2-ut;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(wt*wt+Bt*Bt,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=Ne,this._y3=ut;break;case 1:this._point=2,this._context.moveTo(this._x4=Ne,this._y4=ut);break;case 2:this._point=3,this._x5=Ne,this._y5=ut;break;default:We(this,Ne,ut)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=Ne,this._y0=this._y1,this._y1=this._y2,this._y2=ut}};var Ce=function Ne(ut){function wt(Bt){return ut?new ot(Bt,ut):new lt(Bt,0)}return wt.alpha=function(Bt){return Ne(+Bt)},wt}(.5);function Ue(Ne,ut){this._context=Ne,this._alpha=ut}Ue.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(Ne,ut){if(Ne=+Ne,ut=+ut,this._point){var wt=this._x2-Ne,Bt=this._y2-ut;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(wt*wt+Bt*Bt,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:We(this,Ne,ut)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=Ne,this._y0=this._y1,this._y1=this._y2,this._y2=ut}};var Ye=function Ne(ut){function wt(Bt){return ut?new Ue(Bt,ut):new Ie(Bt,0)}return wt.alpha=function(Bt){return Ne(+Bt)},wt}(.5);function xe(Ne){this._context=Ne}function Ee(Ne){return Ne<0?-1:1}function Je(Ne,ut,wt){var Bt=Ne._x1-Ne._x0,Jt=ut-Ne._x1,er=(Ne._y1-Ne._y0)/(Bt||Jt<0&&-0),or=(wt-Ne._y1)/(Jt||Bt<0&&-0),zt=(er*Jt+or*Bt)/(Bt+Jt);return(Ee(er)+Ee(or))*Math.min(Math.abs(er),Math.abs(or),.5*Math.abs(zt))||0}function it(Ne,ut){var wt=Ne._x1-Ne._x0;return wt?(3*(Ne._y1-Ne._y0)/wt-ut)/2:ut}function ht(Ne,ut,wt){var Bt=Ne._x0,Jt=Ne._y0,er=Ne._x1,or=Ne._y1,zt=(er-Bt)/3;Ne._context.bezierCurveTo(Bt+zt,Jt+zt*ut,er-zt,or-zt*wt,er,or)}function ct(Ne){this._context=Ne}function mt(Ne){this._context=new bt(Ne)}function bt(Ne){this._context=Ne}function Et(Ne){this._context=Ne}function Mt(Ne){var ut,wt,Bt=Ne.length-1,Jt=new Array(Bt),er=new Array(Bt),or=new Array(Bt);for(Jt[0]=0,er[0]=2,or[0]=Ne[0]+2*Ne[1],ut=1;ut<Bt-1;++ut)Jt[ut]=1,er[ut]=4,or[ut]=4*Ne[ut]+2*Ne[ut+1];for(Jt[Bt-1]=2,er[Bt-1]=7,or[Bt-1]=8*Ne[Bt-1]+Ne[Bt],ut=1;ut<Bt;++ut)wt=Jt[ut]/er[ut-1],er[ut]-=wt,or[ut]-=wt*or[ut-1];for(Jt[Bt-1]=or[Bt-1]/er[Bt-1],ut=Bt-2;ut>=0;--ut)Jt[ut]=(or[ut]-Jt[ut+1])/er[ut];for(er[Bt-1]=(Ne[Bt]+Jt[Bt-1])/2,ut=0;ut<Bt-1;++ut)er[ut]=2*Ne[ut+1]-Jt[ut+1];return[Jt,er]}function _t(Ne,ut){this._context=Ne,this._t=ut}function xt(Ne,ut){if((Jt=Ne.length)>1)for(var wt,Bt,Jt,er=1,or=Ne[ut[0]],zt=or.length;er<Jt;++er)for(Bt=or,or=Ne[ut[er]],wt=0;wt<zt;++wt)or[wt][1]+=or[wt][0]=isNaN(Bt[wt][1])?Bt[wt][0]:Bt[wt][1]}function At(Ne){for(var ut=Ne.length,wt=new Array(ut);--ut>=0;)wt[ut]=ut;return wt}function It(Ne,ut){return Ne[ut]}function Nt(Ne){var ut=Ne.map(Ot);return At(Ne).sort(function(wt,Bt){return ut[wt]-ut[Bt]})}function Ot(Ne){for(var ut,wt=-1,Bt=0,Jt=Ne.length,er=-1/0;++wt<Jt;)(ut=+Ne[wt][1])>er&&(er=ut,Bt=wt);return Bt}function Yt(Ne){var ut=Ne.map(Pt);return At(Ne).sort(function(wt,Bt){return ut[wt]-ut[Bt]})}function Pt(Ne){for(var ut,wt=0,Bt=-1,Jt=Ne.length;++Bt<Jt;)(ut=+Ne[Bt][1])&&(wt+=ut);return wt}xe.prototype={areaStart:Fe,areaEnd:Fe,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(Ne,ut){Ne=+Ne,ut=+ut,this._point?this._context.lineTo(Ne,ut):(this._point=1,this._context.moveTo(Ne,ut))}},ct.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:ht(this,this._t0,it(this,this._t0))}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(Ne,ut){var wt=NaN;if(ut=+ut,(Ne=+Ne)!==this._x1||ut!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(Ne,ut):this._context.moveTo(Ne,ut);break;case 1:this._point=2;break;case 2:this._point=3,ht(this,it(this,wt=Je(this,Ne,ut)),wt);break;default:ht(this,this._t0,wt=Je(this,Ne,ut))}this._x0=this._x1,this._x1=Ne,this._y0=this._y1,this._y1=ut,this._t0=wt}}},(mt.prototype=Object.create(ct.prototype)).point=function(Ne,ut){ct.prototype.point.call(this,ut,Ne)},bt.prototype={moveTo:function(Ne,ut){this._context.moveTo(ut,Ne)},closePath:function(){this._context.closePath()},lineTo:function(Ne,ut){this._context.lineTo(ut,Ne)},bezierCurveTo:function(Ne,ut,wt,Bt,Jt,er){this._context.bezierCurveTo(ut,Ne,Bt,wt,er,Jt)}},Et.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var Ne=this._x,ut=this._y,wt=Ne.length;if(wt)if(this._line?this._context.lineTo(Ne[0],ut[0]):this._context.moveTo(Ne[0],ut[0]),wt===2)this._context.lineTo(Ne[1],ut[1]);else for(var Bt=Mt(Ne),Jt=Mt(ut),er=0,or=1;or<wt;++er,++or)this._context.bezierCurveTo(Bt[0][er],Jt[0][er],Bt[1][er],Jt[1][er],Ne[or],ut[or]);(this._line||this._line!==0&&wt===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(Ne,ut){this._x.push(+Ne),this._y.push(+ut)}},_t.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(Ne,ut){switch(Ne=+Ne,ut=+ut,this._point){case 0:this._point=1,this._line?this._context.lineTo(Ne,ut):this._context.moveTo(Ne,ut);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,ut),this._context.lineTo(Ne,ut);else{var wt=this._x*(1-this._t)+Ne*this._t;this._context.lineTo(wt,this._y),this._context.lineTo(wt,ut)}}this._x=Ne,this._y=ut}},t.arc=function(){var Ne=m,ut=y,wt=p(0),Bt=null,Jt=v,er=T,or=w,zt=null;function Qt(){var cr,Dt,Ut=+Ne.apply(this,arguments),ur=+ut.apply(this,arguments),Sr=Jt.apply(this,arguments)-c,Lr=er.apply(this,arguments)-c,Hr=l(Lr-Sr),Kr=Lr>Sr;if(zt||(zt=cr=h.path()),ur<Ut&&(Dt=ur,ur=Ut,Ut=Dt),ur>1e-12)if(Hr>f-1e-12)zt.moveTo(ur*o(Sr),ur*u(Sr)),zt.arc(0,0,ur,Sr,Lr,!Kr),Ut>1e-12&&(zt.moveTo(Ut*o(Lr),Ut*u(Lr)),zt.arc(0,0,Ut,Lr,Sr,Kr));else{var Ir,kr,rn=Sr,Qr=Lr,nn=Sr,Xr=Lr,Nr=Hr,Br=Hr,on=or.apply(this,arguments)/2,cn=on>1e-12&&(Bt?+Bt.apply(this,arguments):s(Ut*Ut+ur*ur)),un=i(l(ur-Ut)/2,+wt.apply(this,arguments)),Zr=un,yn=un;if(cn>1e-12){var In=d(cn/Ut*u(on)),Un=d(cn/ur*u(on));(Nr-=2*In)>1e-12?(nn+=In*=Kr?1:-1,Xr-=In):(Nr=0,nn=Xr=(Sr+Lr)/2),(Br-=2*Un)>1e-12?(rn+=Un*=Kr?1:-1,Qr-=Un):(Br=0,rn=Qr=(Sr+Lr)/2)}var Kn=ur*o(rn),vt=ur*u(rn),Zt=Ut*o(Xr),qt=Ut*u(Xr);if(un>1e-12){var yr,Dr=ur*o(Qr),Mr=ur*u(Qr),xr=Ut*o(nn),hr=Ut*u(nn);if(Hr<a&&(yr=A(Kn,vt,xr,hr,Dr,Mr,Zt,qt))){var Tr=Kn-yr[0],fr=vt-yr[1],br=Dr-yr[0],Or=Mr-yr[1],sn=1/u(g((Tr*br+fr*Or)/(s(Tr*Tr+fr*fr)*s(br*br+Or*Or)))/2),Jr=s(yr[0]*yr[0]+yr[1]*yr[1]);Zr=i(un,(Ut-Jr)/(sn-1)),yn=i(un,(ur-Jr)/(sn+1))}}Br>1e-12?yn>1e-12?(Ir=E(xr,hr,Kn,vt,ur,yn,Kr),kr=E(Dr,Mr,Zt,qt,ur,yn,Kr),zt.moveTo(Ir.cx+Ir.x01,Ir.cy+Ir.y01),yn<un?zt.arc(Ir.cx,Ir.cy,yn,e(Ir.y01,Ir.x01),e(kr.y01,kr.x01),!Kr):(zt.arc(Ir.cx,Ir.cy,yn,e(Ir.y01,Ir.x01),e(Ir.y11,Ir.x11),!Kr),zt.arc(0,0,ur,e(Ir.cy+Ir.y11,Ir.cx+Ir.x11),e(kr.cy+kr.y11,kr.cx+kr.x11),!Kr),zt.arc(kr.cx,kr.cy,yn,e(kr.y11,kr.x11),e(kr.y01,kr.x01),!Kr))):(zt.moveTo(Kn,vt),zt.arc(0,0,ur,rn,Qr,!Kr)):zt.moveTo(Kn,vt),Ut>1e-12&&Nr>1e-12?Zr>1e-12?(Ir=E(Zt,qt,Dr,Mr,Ut,-Zr,Kr),kr=E(Kn,vt,xr,hr,Ut,-Zr,Kr),zt.lineTo(Ir.cx+Ir.x01,Ir.cy+Ir.y01),Zr<un?zt.arc(Ir.cx,Ir.cy,Zr,e(Ir.y01,Ir.x01),e(kr.y01,kr.x01),!Kr):(zt.arc(Ir.cx,Ir.cy,Zr,e(Ir.y01,Ir.x01),e(Ir.y11,Ir.x11),!Kr),zt.arc(0,0,Ut,e(Ir.cy+Ir.y11,Ir.cx+Ir.x11),e(kr.cy+kr.y11,kr.cx+kr.x11),Kr),zt.arc(kr.cx,kr.cy,Zr,e(kr.y11,kr.x11),e(kr.y01,kr.x01),!Kr))):zt.arc(0,0,Ut,Xr,nn,Kr):zt.lineTo(Zt,qt)}else zt.moveTo(0,0);if(zt.closePath(),cr)return zt=null,cr+""||null}return Qt.centroid=function(){var cr=(+Ne.apply(this,arguments)+ +ut.apply(this,arguments))/2,Dt=(+Jt.apply(this,arguments)+ +er.apply(this,arguments))/2-a/2;return[o(Dt)*cr,u(Dt)*cr]},Qt.innerRadius=function(cr){return arguments.length?(Ne=typeof cr=="function"?cr:p(+cr),Qt):Ne},Qt.outerRadius=function(cr){return arguments.length?(ut=typeof cr=="function"?cr:p(+cr),Qt):ut},Qt.cornerRadius=function(cr){return arguments.length?(wt=typeof cr=="function"?cr:p(+cr),Qt):wt},Qt.padRadius=function(cr){return arguments.length?(Bt=cr==null?null:typeof cr=="function"?cr:p(+cr),Qt):Bt},Qt.startAngle=function(cr){return arguments.length?(Jt=typeof cr=="function"?cr:p(+cr),Qt):Jt},Qt.endAngle=function(cr){return arguments.length?(er=typeof cr=="function"?cr:p(+cr),Qt):er},Qt.padAngle=function(cr){return arguments.length?(or=typeof cr=="function"?cr:p(+cr),Qt):or},Qt.context=function(cr){return arguments.length?(zt=cr??null,Qt):zt},Qt},t.area=k,t.areaRadial=B,t.curveBasis=function(Ne){return new He(Ne)},t.curveBasisClosed=function(Ne){return new et(Ne)},t.curveBasisOpen=function(Ne){return new Re(Ne)},t.curveBundle=Ke,t.curveCardinal=at,t.curveCardinalClosed=gt,t.curveCardinalOpen=be,t.curveCatmullRom=st,t.curveCatmullRomClosed=Ce,t.curveCatmullRomOpen=Ye,t.curveLinear=b,t.curveLinearClosed=function(Ne){return new xe(Ne)},t.curveMonotoneX=function(Ne){return new ct(Ne)},t.curveMonotoneY=function(Ne){return new mt(Ne)},t.curveNatural=function(Ne){return new Et(Ne)},t.curveStep=function(Ne){return new _t(Ne,.5)},t.curveStepAfter=function(Ne){return new _t(Ne,1)},t.curveStepBefore=function(Ne){return new _t(Ne,0)},t.line=C,t.lineRadial=D,t.linkHorizontal=function(){return G(W)},t.linkRadial=function(){var Ne=G($);return Ne.angle=Ne.x,delete Ne.x,Ne.radius=Ne.y,delete Ne.y,Ne},t.linkVertical=function(){return G(Q)},t.pie=function(){var Ne=I,ut=L,wt=null,Bt=p(0),Jt=p(f),er=p(0);function or(zt){var Qt,cr,Dt,Ut,ur,Sr=zt.length,Lr=0,Hr=new Array(Sr),Kr=new Array(Sr),Ir=+Bt.apply(this,arguments),kr=Math.min(f,Math.max(-f,Jt.apply(this,arguments)-Ir)),rn=Math.min(Math.abs(kr)/Sr,er.apply(this,arguments)),Qr=rn*(kr<0?-1:1);for(Qt=0;Qt<Sr;++Qt)(ur=Kr[Hr[Qt]=Qt]=+Ne(zt[Qt],Qt,zt))>0&&(Lr+=ur);for(ut!=null?Hr.sort(function(nn,Xr){return ut(Kr[nn],Kr[Xr])}):wt!=null&&Hr.sort(function(nn,Xr){return wt(zt[nn],zt[Xr])}),Qt=0,Dt=Lr?(kr-Sr*Qr)/Lr:0;Qt<Sr;++Qt,Ir=Ut)cr=Hr[Qt],Ut=Ir+((ur=Kr[cr])>0?ur*Dt:0)+Qr,Kr[cr]={data:zt[cr],index:Qt,value:ur,startAngle:Ir,endAngle:Ut,padAngle:rn};return Kr}return or.value=function(zt){return arguments.length?(Ne=typeof zt=="function"?zt:p(+zt),or):Ne},or.sortValues=function(zt){return arguments.length?(ut=zt,wt=null,or):ut},or.sort=function(zt){return arguments.length?(wt=zt,ut=null,or):wt},or.startAngle=function(zt){return arguments.length?(Bt=typeof zt=="function"?zt:p(+zt),or):Bt},or.endAngle=function(zt){return arguments.length?(Jt=typeof zt=="function"?zt:p(+zt),or):Jt},or.padAngle=function(zt){return arguments.length?(er=typeof zt=="function"?zt:p(+zt),or):er},or},t.pointRadial=N,t.radialArea=B,t.radialLine=D,t.stack=function(){var Ne=p([]),ut=At,wt=xt,Bt=It;function Jt(er){var or,zt,Qt=Ne.apply(this,arguments),cr=er.length,Dt=Qt.length,Ut=new Array(Dt);for(or=0;or<Dt;++or){for(var ur,Sr=Qt[or],Lr=Ut[or]=new Array(cr),Hr=0;Hr<cr;++Hr)Lr[Hr]=ur=[0,+Bt(er[Hr],Sr,Hr,er)],ur.data=er[Hr];Lr.key=Sr}for(or=0,zt=ut(Ut);or<Dt;++or)Ut[zt[or]].index=or;return wt(Ut,zt),Ut}return Jt.keys=function(er){return arguments.length?(Ne=typeof er=="function"?er:p(F.call(er)),Jt):Ne},Jt.value=function(er){return arguments.length?(Bt=typeof er=="function"?er:p(+er),Jt):Bt},Jt.order=function(er){return arguments.length?(ut=er==null?At:typeof er=="function"?er:p(F.call(er)),Jt):ut},Jt.offset=function(er){return arguments.length?(wt=er??xt,Jt):wt},Jt},t.stackOffsetDiverging=function(Ne,ut){if((zt=Ne.length)>0)for(var wt,Bt,Jt,er,or,zt,Qt=0,cr=Ne[ut[0]].length;Qt<cr;++Qt)for(er=or=0,wt=0;wt<zt;++wt)(Jt=(Bt=Ne[ut[wt]][Qt])[1]-Bt[0])>0?(Bt[0]=er,Bt[1]=er+=Jt):Jt<0?(Bt[1]=or,Bt[0]=or+=Jt):(Bt[0]=0,Bt[1]=Jt)},t.stackOffsetExpand=function(Ne,ut){if((Bt=Ne.length)>0){for(var wt,Bt,Jt,er=0,or=Ne[0].length;er<or;++er){for(Jt=wt=0;wt<Bt;++wt)Jt+=Ne[wt][er][1]||0;if(Jt)for(wt=0;wt<Bt;++wt)Ne[wt][er][1]/=Jt}xt(Ne,ut)}},t.stackOffsetNone=xt,t.stackOffsetSilhouette=function(Ne,ut){if((wt=Ne.length)>0){for(var wt,Bt=0,Jt=Ne[ut[0]],er=Jt.length;Bt<er;++Bt){for(var or=0,zt=0;or<wt;++or)zt+=Ne[or][Bt][1]||0;Jt[Bt][1]+=Jt[Bt][0]=-zt/2}xt(Ne,ut)}},t.stackOffsetWiggle=function(Ne,ut){if((Jt=Ne.length)>0&&(Bt=(wt=Ne[ut[0]]).length)>0){for(var wt,Bt,Jt,er=0,or=1;or<Bt;++or){for(var zt=0,Qt=0,cr=0;zt<Jt;++zt){for(var Dt=Ne[ut[zt]],Ut=Dt[or][1]||0,ur=(Ut-(Dt[or-1][1]||0))/2,Sr=0;Sr<zt;++Sr){var Lr=Ne[ut[Sr]];ur+=(Lr[or][1]||0)-(Lr[or-1][1]||0)}Qt+=Ut,cr+=ur*Ut}wt[or-1][1]+=wt[or-1][0]=er,Qt&&(er-=cr/Qt)}wt[or-1][1]+=wt[or-1][0]=er,xt(Ne,ut)}},t.stackOrderAppearance=Nt,t.stackOrderAscending=Yt,t.stackOrderDescending=function(Ne){return Yt(Ne).reverse()},t.stackOrderInsideOut=function(Ne){var ut,wt,Bt=Ne.length,Jt=Ne.map(Pt),er=Nt(Ne),or=0,zt=0,Qt=[],cr=[];for(ut=0;ut<Bt;++ut)wt=er[ut],or<zt?(or+=Jt[wt],Qt.push(wt)):(zt+=Jt[wt],cr.push(wt));return cr.reverse().concat(Qt)},t.stackOrderNone=At,t.stackOrderReverse=function(Ne){return At(Ne).reverse()},t.symbol=function(){var Ne=p(ee),ut=p(64),wt=null;function Bt(){var Jt;if(wt||(wt=Jt=h.path()),Ne.apply(this,arguments).draw(wt,+ut.apply(this,arguments)),Jt)return wt=null,Jt+""||null}return Bt.type=function(Jt){return arguments.length?(Ne=typeof Jt=="function"?Jt:p(Jt),Bt):Ne},Bt.size=function(Jt){return arguments.length?(ut=typeof Jt=="function"?Jt:p(+Jt),Bt):ut},Bt.context=function(Jt){return arguments.length?(wt=Jt??null,Bt):wt},Bt},t.symbolCircle=ee,t.symbolCross=ie,t.symbolDiamond=de,t.symbolSquare=Ae,t.symbolStar=we,t.symbolTriangle=ke,t.symbolWye=_e,t.symbols=Pe,Object.defineProperty(t,"__esModule",{value:!0})})},{"d3-path":163}],166:[function(n,z,q){(function(t,h){typeof q=="object"&&typeof z<"u"?h(q,n("d3-time")):h((t=t||self).d3=t.d3||{},t.d3)})(this,function(t,h){"use strict";function p(be){if(0<=be.y&&be.y<100){var We=new Date(-1,be.m,be.d,be.H,be.M,be.S,be.L);return We.setFullYear(be.y),We}return new Date(be.y,be.m,be.d,be.H,be.M,be.S,be.L)}function l(be){if(0<=be.y&&be.y<100){var We=new Date(Date.UTC(-1,be.m,be.d,be.H,be.M,be.S,be.L));return We.setUTCFullYear(be.y),We}return new Date(Date.UTC(be.y,be.m,be.d,be.H,be.M,be.S,be.L))}function e(be,We,Ge){return{y:be,m:We,d:Ge,H:0,M:0,S:0,L:0}}function o(be){var We=be.dateTime,Ge=be.date,st=be.time,ot=be.periods,Ce=be.days,Ue=be.shortDays,Ye=be.months,xe=be.shortMonths,Ee=g(ot),Je=d(ot),it=g(Ce),ht=d(Ce),ct=g(Ue),mt=d(Ue),bt=g(Ye),Et=d(Ye),Mt=g(xe),_t=d(xe),xt={a:function(Pt){return Ue[Pt.getDay()]},A:function(Pt){return Ce[Pt.getDay()]},b:function(Pt){return xe[Pt.getMonth()]},B:function(Pt){return Ye[Pt.getMonth()]},c:null,d:B,e:B,f:G,H:N,I:F,j:H,L:j,m:W,M:Q,p:function(Pt){return ot[+(Pt.getHours()>=12)]},q:function(Pt){return 1+~~(Pt.getMonth()/3)},Q:rt,s:at,S:$,u:ee,U:ie,V:ae,w:oe,W:de,x:null,X:null,y:le,Y:fe,Z:ue,"%":$e},At={a:function(Pt){return Ue[Pt.getUTCDay()]},A:function(Pt){return Ce[Pt.getUTCDay()]},b:function(Pt){return xe[Pt.getUTCMonth()]},B:function(Pt){return Ye[Pt.getUTCMonth()]},c:null,d:we,e:we,f:ve,H:Ae,I:Se,j:ke,L:Me,m:ge,M:De,p:function(Pt){return ot[+(Pt.getUTCHours()>=12)]},q:function(Pt){return 1+~~(Pt.getUTCMonth()/3)},Q:rt,s:at,S:_e,u:Pe,U:Fe,V:ze,w:He,W:et,x:null,X:null,y:Re,Y:Ze,Z:Ke,"%":$e},It={a:function(Pt,Ne,ut){var wt=ct.exec(Ne.slice(ut));return wt?(Pt.w=mt[wt[0].toLowerCase()],ut+wt[0].length):-1},A:function(Pt,Ne,ut){var wt=it.exec(Ne.slice(ut));return wt?(Pt.w=ht[wt[0].toLowerCase()],ut+wt[0].length):-1},b:function(Pt,Ne,ut){var wt=Mt.exec(Ne.slice(ut));return wt?(Pt.m=_t[wt[0].toLowerCase()],ut+wt[0].length):-1},B:function(Pt,Ne,ut){var wt=bt.exec(Ne.slice(ut));return wt?(Pt.m=Et[wt[0].toLowerCase()],ut+wt[0].length):-1},c:function(Pt,Ne,ut){return Yt(Pt,We,Ne,ut)},d:S,e:S,f:V,H:k,I:k,j:C,L:R,m:_,M:L,p:function(Pt,Ne,ut){var wt=Ee.exec(Ne.slice(ut));return wt?(Pt.p=Je[wt[0].toLowerCase()],ut+wt[0].length):-1},q:b,Q:J,s:D,S:I,u:y,U:v,V:T,w:m,W:w,x:function(Pt,Ne,ut){return Yt(Pt,Ge,Ne,ut)},X:function(Pt,Ne,ut){return Yt(Pt,st,Ne,ut)},y:E,Y:A,Z:M,"%":O};function Nt(Pt,Ne){return function(ut){var wt,Bt,Jt,er=[],or=-1,zt=0,Qt=Pt.length;for(ut instanceof Date||(ut=new Date(+ut));++or<Qt;)Pt.charCodeAt(or)===37&&(er.push(Pt.slice(zt,or)),(Bt=i[wt=Pt.charAt(++or)])!=null?wt=Pt.charAt(++or):Bt=wt==="e"?" ":"0",(Jt=Ne[wt])&&(wt=Jt(ut,Bt)),er.push(wt),zt=or+1);return er.push(Pt.slice(zt,or)),er.join("")}}function Ot(Pt,Ne){return function(ut){var wt,Bt,Jt=e(1900,void 0,1);if(Yt(Jt,Pt,ut+="",0)!=ut.length)return null;if("Q"in Jt)return new Date(Jt.Q);if("s"in Jt)return new Date(1e3*Jt.s+("L"in Jt?Jt.L:0));if(Ne&&!("Z"in Jt)&&(Jt.Z=0),"p"in Jt&&(Jt.H=Jt.H%12+12*Jt.p),Jt.m===void 0&&(Jt.m="q"in Jt?Jt.q:0),"V"in Jt){if(Jt.V<1||Jt.V>53)return null;"w"in Jt||(Jt.w=1),"Z"in Jt?(Bt=(wt=l(e(Jt.y,0,1))).getUTCDay(),wt=Bt>4||Bt===0?h.utcMonday.ceil(wt):h.utcMonday(wt),wt=h.utcDay.offset(wt,7*(Jt.V-1)),Jt.y=wt.getUTCFullYear(),Jt.m=wt.getUTCMonth(),Jt.d=wt.getUTCDate()+(Jt.w+6)%7):(Bt=(wt=p(e(Jt.y,0,1))).getDay(),wt=Bt>4||Bt===0?h.timeMonday.ceil(wt):h.timeMonday(wt),wt=h.timeDay.offset(wt,7*(Jt.V-1)),Jt.y=wt.getFullYear(),Jt.m=wt.getMonth(),Jt.d=wt.getDate()+(Jt.w+6)%7)}else("W"in Jt||"U"in Jt)&&("w"in Jt||(Jt.w="u"in Jt?Jt.u%7:"W"in Jt?1:0),Bt="Z"in Jt?l(e(Jt.y,0,1)).getUTCDay():p(e(Jt.y,0,1)).getDay(),Jt.m=0,Jt.d="W"in Jt?(Jt.w+6)%7+7*Jt.W-(Bt+5)%7:Jt.w+7*Jt.U-(Bt+6)%7);return"Z"in Jt?(Jt.H+=Jt.Z/100|0,Jt.M+=Jt.Z%100,l(Jt)):p(Jt)}}function Yt(Pt,Ne,ut,wt){for(var Bt,Jt,er=0,or=Ne.length,zt=ut.length;er<or;){if(wt>=zt)return-1;if((Bt=Ne.charCodeAt(er++))===37){if(Bt=Ne.charAt(er++),!(Jt=It[Bt in i?Ne.charAt(er++):Bt])||(wt=Jt(Pt,ut,wt))<0)return-1}else if(Bt!=ut.charCodeAt(wt++))return-1}return wt}return xt.x=Nt(Ge,xt),xt.X=Nt(st,xt),xt.c=Nt(We,xt),At.x=Nt(Ge,At),At.X=Nt(st,At),At.c=Nt(We,At),{format:function(Pt){var Ne=Nt(Pt+="",xt);return Ne.toString=function(){return Pt},Ne},parse:function(Pt){var Ne=Ot(Pt+="",!1);return Ne.toString=function(){return Pt},Ne},utcFormat:function(Pt){var Ne=Nt(Pt+="",At);return Ne.toString=function(){return Pt},Ne},utcParse:function(Pt){var Ne=Ot(Pt+="",!0);return Ne.toString=function(){return Pt},Ne}}}var r,i={"-":"",_:" ",0:"0"},u=/^\s*\d+/,s=/^%/,a=/[\\^$*+?|[\]().{}]/g;function c(be,We,Ge){var st=be<0?"-":"",ot=(st?-be:be)+"",Ce=ot.length;return st+(Ce<Ge?new Array(Ge-Ce+1).join(We)+ot:ot)}function f(be){return be.replace(a,"\\$&")}function g(be){return new RegExp("^(?:"+be.map(f).join("|")+")","i")}function d(be){for(var We={},Ge=-1,st=be.length;++Ge<st;)We[be[Ge].toLowerCase()]=Ge;return We}function m(be,We,Ge){var st=u.exec(We.slice(Ge,Ge+1));return st?(be.w=+st[0],Ge+st[0].length):-1}function y(be,We,Ge){var st=u.exec(We.slice(Ge,Ge+1));return st?(be.u=+st[0],Ge+st[0].length):-1}function v(be,We,Ge){var st=u.exec(We.slice(Ge,Ge+2));return st?(be.U=+st[0],Ge+st[0].length):-1}function T(be,We,Ge){var st=u.exec(We.slice(Ge,Ge+2));return st?(be.V=+st[0],Ge+st[0].length):-1}function w(be,We,Ge){var st=u.exec(We.slice(Ge,Ge+2));return st?(be.W=+st[0],Ge+st[0].length):-1}function A(be,We,Ge){var st=u.exec(We.slice(Ge,Ge+4));return st?(be.y=+st[0],Ge+st[0].length):-1}function E(be,We,Ge){var st=u.exec(We.slice(Ge,Ge+2));return st?(be.y=+st[0]+(+st[0]>68?1900:2e3),Ge+st[0].length):-1}function M(be,We,Ge){var st=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(We.slice(Ge,Ge+6));return st?(be.Z=st[1]?0:-(st[2]+(st[3]||"00")),Ge+st[0].length):-1}function b(be,We,Ge){var st=u.exec(We.slice(Ge,Ge+1));return st?(be.q=3*st[0]-3,Ge+st[0].length):-1}function _(be,We,Ge){var st=u.exec(We.slice(Ge,Ge+2));return st?(be.m=st[0]-1,Ge+st[0].length):-1}function S(be,We,Ge){var st=u.exec(We.slice(Ge,Ge+2));return st?(be.d=+st[0],Ge+st[0].length):-1}function C(be,We,Ge){var st=u.exec(We.slice(Ge,Ge+3));return st?(be.m=0,be.d=+st[0],Ge+st[0].length):-1}function k(be,We,Ge){var st=u.exec(We.slice(Ge,Ge+2));return st?(be.H=+st[0],Ge+st[0].length):-1}function L(be,We,Ge){var st=u.exec(We.slice(Ge,Ge+2));return st?(be.M=+st[0],Ge+st[0].length):-1}function I(be,We,Ge){var st=u.exec(We.slice(Ge,Ge+2));return st?(be.S=+st[0],Ge+st[0].length):-1}function R(be,We,Ge){var st=u.exec(We.slice(Ge,Ge+3));return st?(be.L=+st[0],Ge+st[0].length):-1}function V(be,We,Ge){var st=u.exec(We.slice(Ge,Ge+6));return st?(be.L=Math.floor(st[0]/1e3),Ge+st[0].length):-1}function O(be,We,Ge){var st=s.exec(We.slice(Ge,Ge+1));return st?Ge+st[0].length:-1}function J(be,We,Ge){var st=u.exec(We.slice(Ge));return st?(be.Q=+st[0],Ge+st[0].length):-1}function D(be,We,Ge){var st=u.exec(We.slice(Ge));return st?(be.s=+st[0],Ge+st[0].length):-1}function B(be,We){return c(be.getDate(),We,2)}function N(be,We){return c(be.getHours(),We,2)}function F(be,We){return c(be.getHours()%12||12,We,2)}function H(be,We){return c(1+h.timeDay.count(h.timeYear(be),be),We,3)}function j(be,We){return c(be.getMilliseconds(),We,3)}function G(be,We){return j(be,We)+"000"}function W(be,We){return c(be.getMonth()+1,We,2)}function Q(be,We){return c(be.getMinutes(),We,2)}function $(be,We){return c(be.getSeconds(),We,2)}function ee(be){var We=be.getDay();return We===0?7:We}function ie(be,We){return c(h.timeSunday.count(h.timeYear(be)-1,be),We,2)}function ae(be,We){var Ge=be.getDay();return be=Ge>=4||Ge===0?h.timeThursday(be):h.timeThursday.ceil(be),c(h.timeThursday.count(h.timeYear(be),be)+(h.timeYear(be).getDay()===4),We,2)}function oe(be){return be.getDay()}function de(be,We){return c(h.timeMonday.count(h.timeYear(be)-1,be),We,2)}function le(be,We){return c(be.getFullYear()%100,We,2)}function fe(be,We){return c(be.getFullYear()%1e4,We,4)}function ue(be){var We=be.getTimezoneOffset();return(We>0?"-":(We*=-1,"+"))+c(We/60|0,"0",2)+c(We%60,"0",2)}function we(be,We){return c(be.getUTCDate(),We,2)}function Ae(be,We){return c(be.getUTCHours(),We,2)}function Se(be,We){return c(be.getUTCHours()%12||12,We,2)}function ke(be,We){return c(1+h.utcDay.count(h.utcYear(be),be),We,3)}function Me(be,We){return c(be.getUTCMilliseconds(),We,3)}function ve(be,We){return Me(be,We)+"000"}function ge(be,We){return c(be.getUTCMonth()+1,We,2)}function De(be,We){return c(be.getUTCMinutes(),We,2)}function _e(be,We){return c(be.getUTCSeconds(),We,2)}function Pe(be){var We=be.getUTCDay();return We===0?7:We}function Fe(be,We){return c(h.utcSunday.count(h.utcYear(be)-1,be),We,2)}function ze(be,We){var Ge=be.getUTCDay();return be=Ge>=4||Ge===0?h.utcThursday(be):h.utcThursday.ceil(be),c(h.utcThursday.count(h.utcYear(be),be)+(h.utcYear(be).getUTCDay()===4),We,2)}function He(be){return be.getUTCDay()}function et(be,We){return c(h.utcMonday.count(h.utcYear(be)-1,be),We,2)}function Re(be,We){return c(be.getUTCFullYear()%100,We,2)}function Ze(be,We){return c(be.getUTCFullYear()%1e4,We,4)}function Ke(){return"+0000"}function $e(){return"%"}function rt(be){return+be}function at(be){return Math.floor(+be/1e3)}function lt(be){return r=o(be),t.timeFormat=r.format,t.timeParse=r.parse,t.utcFormat=r.utcFormat,t.utcParse=r.utcParse,r}lt({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var gt=Date.prototype.toISOString?function(be){return be.toISOString()}:t.utcFormat("%Y-%m-%dT%H:%M:%S.%LZ"),Ie=+new Date("2000-01-01T00:00:00.000Z")?function(be){var We=new Date(be);return isNaN(We)?null:We}:t.utcParse("%Y-%m-%dT%H:%M:%S.%LZ");t.isoFormat=gt,t.isoParse=Ie,t.timeFormatDefaultLocale=lt,t.timeFormatLocale=o,Object.defineProperty(t,"__esModule",{value:!0})})},{"d3-time":167}],167:[function(n,z,q){(function(t,h){h(typeof q=="object"&&typeof z<"u"?q:(t=t||self).d3=t.d3||{})})(this,function(t){"use strict";var h=new Date,p=new Date;function l(ge,De,_e,Pe){function Fe(ze){return ge(ze=arguments.length===0?new Date:new Date(+ze)),ze}return Fe.floor=function(ze){return ge(ze=new Date(+ze)),ze},Fe.ceil=function(ze){return ge(ze=new Date(ze-1)),De(ze,1),ge(ze),ze},Fe.round=function(ze){var He=Fe(ze),et=Fe.ceil(ze);return ze-He<et-ze?He:et},Fe.offset=function(ze,He){return De(ze=new Date(+ze),He==null?1:Math.floor(He)),ze},Fe.range=function(ze,He,et){var Re,Ze=[];if(ze=Fe.ceil(ze),et=et==null?1:Math.floor(et),!(ze<He&&et>0))return Ze;do Ze.push(Re=new Date(+ze)),De(ze,et),ge(ze);while(Re<ze&&ze<He);return Ze},Fe.filter=function(ze){return l(function(He){if(He>=He)for(;ge(He),!ze(He);)He.setTime(He-1)},function(He,et){if(He>=He)if(et<0)for(;++et<=0;)for(;De(He,-1),!ze(He););else for(;--et>=0;)for(;De(He,1),!ze(He););})},_e&&(Fe.count=function(ze,He){return h.setTime(+ze),p.setTime(+He),ge(h),ge(p),Math.floor(_e(h,p))},Fe.every=function(ze){return ze=Math.floor(ze),isFinite(ze)&&ze>0?ze>1?Fe.filter(Pe?function(He){return Pe(He)%ze==0}:function(He){return Fe.count(0,He)%ze==0}):Fe:null}),Fe}var e=l(function(){},function(ge,De){ge.setTime(+ge+De)},function(ge,De){return De-ge});e.every=function(ge){return ge=Math.floor(ge),isFinite(ge)&&ge>0?ge>1?l(function(De){De.setTime(Math.floor(De/ge)*ge)},function(De,_e){De.setTime(+De+_e*ge)},function(De,_e){return(_e-De)/ge}):e:null};var o=e.range,r=l(function(ge){ge.setTime(ge-ge.getMilliseconds())},function(ge,De){ge.setTime(+ge+1e3*De)},function(ge,De){return(De-ge)/1e3},function(ge){return ge.getUTCSeconds()}),i=r.range,u=l(function(ge){ge.setTime(ge-ge.getMilliseconds()-1e3*ge.getSeconds())},function(ge,De){ge.setTime(+ge+6e4*De)},function(ge,De){return(De-ge)/6e4},function(ge){return ge.getMinutes()}),s=u.range,a=l(function(ge){ge.setTime(ge-ge.getMilliseconds()-1e3*ge.getSeconds()-6e4*ge.getMinutes())},function(ge,De){ge.setTime(+ge+36e5*De)},function(ge,De){return(De-ge)/36e5},function(ge){return ge.getHours()}),c=a.range,f=l(function(ge){ge.setHours(0,0,0,0)},function(ge,De){ge.setDate(ge.getDate()+De)},function(ge,De){return(De-ge-6e4*(De.getTimezoneOffset()-ge.getTimezoneOffset()))/864e5},function(ge){return ge.getDate()-1}),g=f.range;function d(ge){return l(function(De){De.setDate(De.getDate()-(De.getDay()+7-ge)%7),De.setHours(0,0,0,0)},function(De,_e){De.setDate(De.getDate()+7*_e)},function(De,_e){return(_e-De-6e4*(_e.getTimezoneOffset()-De.getTimezoneOffset()))/6048e5})}var m=d(0),y=d(1),v=d(2),T=d(3),w=d(4),A=d(5),E=d(6),M=m.range,b=y.range,_=v.range,S=T.range,C=w.range,k=A.range,L=E.range,I=l(function(ge){ge.setDate(1),ge.setHours(0,0,0,0)},function(ge,De){ge.setMonth(ge.getMonth()+De)},function(ge,De){return De.getMonth()-ge.getMonth()+12*(De.getFullYear()-ge.getFullYear())},function(ge){return ge.getMonth()}),R=I.range,V=l(function(ge){ge.setMonth(0,1),ge.setHours(0,0,0,0)},function(ge,De){ge.setFullYear(ge.getFullYear()+De)},function(ge,De){return De.getFullYear()-ge.getFullYear()},function(ge){return ge.getFullYear()});V.every=function(ge){return isFinite(ge=Math.floor(ge))&&ge>0?l(function(De){De.setFullYear(Math.floor(De.getFullYear()/ge)*ge),De.setMonth(0,1),De.setHours(0,0,0,0)},function(De,_e){De.setFullYear(De.getFullYear()+_e*ge)}):null};var O=V.range,J=l(function(ge){ge.setUTCSeconds(0,0)},function(ge,De){ge.setTime(+ge+6e4*De)},function(ge,De){return(De-ge)/6e4},function(ge){return ge.getUTCMinutes()}),D=J.range,B=l(function(ge){ge.setUTCMinutes(0,0,0)},function(ge,De){ge.setTime(+ge+36e5*De)},function(ge,De){return(De-ge)/36e5},function(ge){return ge.getUTCHours()}),N=B.range,F=l(function(ge){ge.setUTCHours(0,0,0,0)},function(ge,De){ge.setUTCDate(ge.getUTCDate()+De)},function(ge,De){return(De-ge)/864e5},function(ge){return ge.getUTCDate()-1}),H=F.range;function j(ge){return l(function(De){De.setUTCDate(De.getUTCDate()-(De.getUTCDay()+7-ge)%7),De.setUTCHours(0,0,0,0)},function(De,_e){De.setUTCDate(De.getUTCDate()+7*_e)},function(De,_e){return(_e-De)/6048e5})}var G=j(0),W=j(1),Q=j(2),$=j(3),ee=j(4),ie=j(5),ae=j(6),oe=G.range,de=W.range,le=Q.range,fe=$.range,ue=ee.range,we=ie.range,Ae=ae.range,Se=l(function(ge){ge.setUTCDate(1),ge.setUTCHours(0,0,0,0)},function(ge,De){ge.setUTCMonth(ge.getUTCMonth()+De)},function(ge,De){return De.getUTCMonth()-ge.getUTCMonth()+12*(De.getUTCFullYear()-ge.getUTCFullYear())},function(ge){return ge.getUTCMonth()}),ke=Se.range,Me=l(function(ge){ge.setUTCMonth(0,1),ge.setUTCHours(0,0,0,0)},function(ge,De){ge.setUTCFullYear(ge.getUTCFullYear()+De)},function(ge,De){return De.getUTCFullYear()-ge.getUTCFullYear()},function(ge){return ge.getUTCFullYear()});Me.every=function(ge){return isFinite(ge=Math.floor(ge))&&ge>0?l(function(De){De.setUTCFullYear(Math.floor(De.getUTCFullYear()/ge)*ge),De.setUTCMonth(0,1),De.setUTCHours(0,0,0,0)},function(De,_e){De.setUTCFullYear(De.getUTCFullYear()+_e*ge)}):null};var ve=Me.range;t.timeDay=f,t.timeDays=g,t.timeFriday=A,t.timeFridays=k,t.timeHour=a,t.timeHours=c,t.timeInterval=l,t.timeMillisecond=e,t.timeMilliseconds=o,t.timeMinute=u,t.timeMinutes=s,t.timeMonday=y,t.timeMondays=b,t.timeMonth=I,t.timeMonths=R,t.timeSaturday=E,t.timeSaturdays=L,t.timeSecond=r,t.timeSeconds=i,t.timeSunday=m,t.timeSundays=M,t.timeThursday=w,t.timeThursdays=C,t.timeTuesday=v,t.timeTuesdays=_,t.timeWednesday=T,t.timeWednesdays=S,t.timeWeek=m,t.timeWeeks=M,t.timeYear=V,t.timeYears=O,t.utcDay=F,t.utcDays=H,t.utcFriday=ie,t.utcFridays=we,t.utcHour=B,t.utcHours=N,t.utcMillisecond=e,t.utcMilliseconds=o,t.utcMinute=J,t.utcMinutes=D,t.utcMonday=W,t.utcMondays=de,t.utcMonth=Se,t.utcMonths=ke,t.utcSaturday=ae,t.utcSaturdays=Ae,t.utcSecond=r,t.utcSeconds=i,t.utcSunday=G,t.utcSundays=oe,t.utcThursday=ee,t.utcThursdays=ue,t.utcTuesday=Q,t.utcTuesdays=le,t.utcWednesday=$,t.utcWednesdays=fe,t.utcWeek=G,t.utcWeeks=oe,t.utcYear=Me,t.utcYears=ve,Object.defineProperty(t,"__esModule",{value:!0})})},{}],168:[function(n,z,q){(function(t,h){h(typeof q=="object"&&typeof z<"u"?q:(t=t||self).d3=t.d3||{})})(this,function(t){"use strict";var h,p,l=0,e=0,o=0,r=0,i=0,u=0,s=typeof performance=="object"&&performance.now?performance:Date,a=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(w){setTimeout(w,17)};function c(){return i||(a(f),i=s.now()+u)}function f(){i=0}function g(){this._call=this._time=this._next=null}function d(w,A,E){var M=new g;return M.restart(w,A,E),M}function m(){c(),++l;for(var w,A=h;A;)(w=i-A._time)>=0&&A._call.call(null,w),A=A._next;--l}function y(){i=(r=s.now())+u,l=e=0;try{m()}finally{l=0,function(){for(var w,A,E=h,M=1/0;E;)E._call?(M>E._time&&(M=E._time),w=E,E=E._next):(A=E._next,E._next=null,E=w?w._next=A:h=A);p=w,T(M)}(),i=0}}function v(){var w=s.now(),A=w-r;A>1e3&&(u-=A,r=w)}function T(w){l||(e&&(e=clearTimeout(e)),w-i>24?(w<1/0&&(e=setTimeout(y,w-s.now()-u)),o&&(o=clearInterval(o))):(o||(r=s.now(),o=setInterval(v,1e3)),l=1,a(y)))}g.prototype=d.prototype={constructor:g,restart:function(w,A,E){if(typeof w!="function")throw new TypeError("callback is not a function");E=(E==null?c():+E)+(A==null?0:+A),this._next||p===this||(p?p._next=this:h=this,p=this),this._call=w,this._time=E,T()},stop:function(){this._call&&(this._call=null,this._time=1/0,T())}},t.interval=function(w,A,E){var M=new g,b=A;return A==null?(M.restart(w,A,E),M):(A=+A,E=E==null?c():+E,M.restart(function _(S){S+=b,M.restart(_,b+=A,E),w(S)},A,E),M)},t.now=c,t.timeout=function(w,A,E){var M=new g;return A=A==null?0:+A,M.restart(function(b){M.stop(),w(b+A)},A,E),M},t.timer=d,t.timerFlush=m,Object.defineProperty(t,"__esModule",{value:!0})})},{}],169:[function(n,z,q){(function(){var t={version:"3.5.17"},h=[].slice,p=function(Z){return h.call(Z)},l=this.document;function e(Z){return Z&&(Z.ownerDocument||Z.document||Z).documentElement}function o(Z){return Z&&(Z.ownerDocument&&Z.ownerDocument.defaultView||Z.document&&Z||Z.defaultView)}if(l)try{p(l.documentElement.childNodes)[0].nodeType}catch{p=function(ne){for(var se=ne.length,he=new Array(se);se--;)he[se]=ne[se];return he}}if(Date.now||(Date.now=function(){return+new Date}),l)try{l.createElement("DIV").style.setProperty("opacity",0,"")}catch{var r=this.Element.prototype,i=r.setAttribute,u=r.setAttributeNS,s=this.CSSStyleDeclaration.prototype,a=s.setProperty;r.setAttribute=function(ne,se){i.call(this,ne,se+"")},r.setAttributeNS=function(ne,se,he){u.call(this,ne,se,he+"")},s.setProperty=function(ne,se,he){a.call(this,ne,se+"",he)}}function c(Z,ne){return Z<ne?-1:Z>ne?1:Z>=ne?0:NaN}function f(Z){return Z===null?NaN:+Z}function g(Z){return!isNaN(Z)}function d(Z){return{left:function(ne,se,he,ye){for(arguments.length<3&&(he=0),arguments.length<4&&(ye=ne.length);he<ye;){var Le=he+ye>>>1;Z(ne[Le],se)<0?he=Le+1:ye=Le}return he},right:function(ne,se,he,ye){for(arguments.length<3&&(he=0),arguments.length<4&&(ye=ne.length);he<ye;){var Le=he+ye>>>1;Z(ne[Le],se)>0?ye=Le:he=Le+1}return he}}}t.ascending=c,t.descending=function(Z,ne){return ne<Z?-1:ne>Z?1:ne>=Z?0:NaN},t.min=function(Z,ne){var se,he,ye=-1,Le=Z.length;if(arguments.length===1){for(;++ye<Le;)if((he=Z[ye])!=null&&he>=he){se=he;break}for(;++ye<Le;)(he=Z[ye])!=null&&se>he&&(se=he)}else{for(;++ye<Le;)if((he=ne.call(Z,Z[ye],ye))!=null&&he>=he){se=he;break}for(;++ye<Le;)(he=ne.call(Z,Z[ye],ye))!=null&&se>he&&(se=he)}return se},t.max=function(Z,ne){var se,he,ye=-1,Le=Z.length;if(arguments.length===1){for(;++ye<Le;)if((he=Z[ye])!=null&&he>=he){se=he;break}for(;++ye<Le;)(he=Z[ye])!=null&&he>se&&(se=he)}else{for(;++ye<Le;)if((he=ne.call(Z,Z[ye],ye))!=null&&he>=he){se=he;break}for(;++ye<Le;)(he=ne.call(Z,Z[ye],ye))!=null&&he>se&&(se=he)}return se},t.extent=function(Z,ne){var se,he,ye,Le=-1,Ve=Z.length;if(arguments.length===1){for(;++Le<Ve;)if((he=Z[Le])!=null&&he>=he){se=ye=he;break}for(;++Le<Ve;)(he=Z[Le])!=null&&(se>he&&(se=he),ye<he&&(ye=he))}else{for(;++Le<Ve;)if((he=ne.call(Z,Z[Le],Le))!=null&&he>=he){se=ye=he;break}for(;++Le<Ve;)(he=ne.call(Z,Z[Le],Le))!=null&&(se>he&&(se=he),ye<he&&(ye=he))}return[se,ye]},t.sum=function(Z,ne){var se,he=0,ye=Z.length,Le=-1;if(arguments.length===1)for(;++Le<ye;)g(se=+Z[Le])&&(he+=se);else for(;++Le<ye;)g(se=+ne.call(Z,Z[Le],Le))&&(he+=se);return he},t.mean=function(Z,ne){var se,he=0,ye=Z.length,Le=-1,Ve=ye;if(arguments.length===1)for(;++Le<ye;)g(se=f(Z[Le]))?he+=se:--Ve;else for(;++Le<ye;)g(se=f(ne.call(Z,Z[Le],Le)))?he+=se:--Ve;if(Ve)return he/Ve},t.quantile=function(Z,ne){var se=(Z.length-1)*ne+1,he=Math.floor(se),ye=+Z[he-1],Le=se-he;return Le?ye+Le*(Z[he]-ye):ye},t.median=function(Z,ne){var se,he=[],ye=Z.length,Le=-1;if(arguments.length===1)for(;++Le<ye;)g(se=f(Z[Le]))&&he.push(se);else for(;++Le<ye;)g(se=f(ne.call(Z,Z[Le],Le)))&&he.push(se);if(he.length)return t.quantile(he.sort(c),.5)},t.variance=function(Z,ne){var se,he,ye=Z.length,Le=0,Ve=0,Xe=-1,qe=0;if(arguments.length===1)for(;++Xe<ye;)g(se=f(Z[Xe]))&&(Ve+=(he=se-Le)*(se-(Le+=he/++qe)));else for(;++Xe<ye;)g(se=f(ne.call(Z,Z[Xe],Xe)))&&(Ve+=(he=se-Le)*(se-(Le+=he/++qe)));if(qe>1)return Ve/(qe-1)},t.deviation=function(){var Z=t.variance.apply(this,arguments);return Z&&Math.sqrt(Z)};var m=d(c);function y(Z){return Z.length}t.bisectLeft=m.left,t.bisect=t.bisectRight=m.right,t.bisector=function(Z){return d(Z.length===1?function(ne,se){return c(Z(ne),se)}:Z)},t.shuffle=function(Z,ne,se){(Le=arguments.length)<3&&(se=Z.length,Le<2&&(ne=0));for(var he,ye,Le=se-ne;Le;)ye=Math.random()*Le--|0,he=Z[Le+ne],Z[Le+ne]=Z[ye+ne],Z[ye+ne]=he;return Z},t.permute=function(Z,ne){for(var se=ne.length,he=new Array(se);se--;)he[se]=Z[ne[se]];return he},t.pairs=function(Z){for(var ne=0,se=Z.length-1,he=Z[0],ye=new Array(se<0?0:se);ne<se;)ye[ne]=[he,he=Z[++ne]];return ye},t.transpose=function(Z){if(!(ye=Z.length))return[];for(var ne=-1,se=t.min(Z,y),he=new Array(se);++ne<se;)for(var ye,Le=-1,Ve=he[ne]=new Array(ye);++Le<ye;)Ve[Le]=Z[Le][ne];return he},t.zip=function(){return t.transpose(arguments)},t.keys=function(Z){var ne=[];for(var se in Z)ne.push(se);return ne},t.values=function(Z){var ne=[];for(var se in Z)ne.push(Z[se]);return ne},t.entries=function(Z){var ne=[];for(var se in Z)ne.push({key:se,value:Z[se]});return ne},t.merge=function(Z){for(var ne,se,he,ye=Z.length,Le=-1,Ve=0;++Le<ye;)Ve+=Z[Le].length;for(se=new Array(Ve);--ye>=0;)for(ne=(he=Z[ye]).length;--ne>=0;)se[--Ve]=he[ne];return se};var v=Math.abs;function T(Z){for(var ne=1;Z*ne%1;)ne*=10;return ne}function w(Z,ne){for(var se in ne)Object.defineProperty(Z.prototype,se,{value:ne[se],enumerable:!1})}function A(){this._=Object.create(null)}t.range=function(Z,ne,se){if(arguments.length<3&&(se=1,arguments.length<2&&(ne=Z,Z=0)),(ne-Z)/se==1/0)throw new Error("infinite range");var he,ye=[],Le=T(v(se)),Ve=-1;if(Z*=Le,ne*=Le,(se*=Le)<0)for(;(he=Z+se*++Ve)>ne;)ye.push(he/Le);else for(;(he=Z+se*++Ve)<ne;)ye.push(he/Le);return ye},t.map=function(Z,ne){var se=new A;if(Z instanceof A)Z.forEach(function(Xe,qe){se.set(Xe,qe)});else if(Array.isArray(Z)){var he,ye=-1,Le=Z.length;if(arguments.length===1)for(;++ye<Le;)se.set(ye,Z[ye]);else for(;++ye<Le;)se.set(ne.call(Z,he=Z[ye],ye),he)}else for(var Ve in Z)se.set(Ve,Z[Ve]);return se};function E(Z){return(Z+="")=="__proto__"||Z[0]==="\0"?"\0"+Z:Z}function M(Z){return(Z+="")[0]==="\0"?Z.slice(1):Z}function b(Z){return E(Z)in this._}function _(Z){return(Z=E(Z))in this._&&delete this._[Z]}function S(){var Z=[];for(var ne in this._)Z.push(M(ne));return Z}function C(){var Z=0;for(var ne in this._)++Z;return Z}function k(){for(var Z in this._)return!1;return!0}function L(){this._=Object.create(null)}function I(Z){return Z}function R(Z,ne,se){return function(){var he=se.apply(ne,arguments);return he===ne?Z:he}}function V(Z,ne){if(ne in Z)return ne;ne=ne.charAt(0).toUpperCase()+ne.slice(1);for(var se=0,he=O.length;se<he;++se){var ye=O[se]+ne;if(ye in Z)return ye}}w(A,{has:b,get:function(Z){return this._[E(Z)]},set:function(Z,ne){return this._[E(Z)]=ne},remove:_,keys:S,values:function(){var Z=[];for(var ne in this._)Z.push(this._[ne]);return Z},entries:function(){var Z=[];for(var ne in this._)Z.push({key:M(ne),value:this._[ne]});return Z},size:C,empty:k,forEach:function(Z){for(var ne in this._)Z.call(this,M(ne),this._[ne])}}),t.nest=function(){var Z,ne,se={},he=[],ye=[];function Le(Ve,Xe,qe){if(qe>=he.length)return ne?ne.call(se,Xe):Z?Xe.sort(Z):Xe;for(var Qe,pt,Tt,Ct,jt=-1,nr=Xe.length,Vt=he[qe++],Xt=new A;++jt<nr;)(Ct=Xt.get(Qe=Vt(pt=Xe[jt])))?Ct.push(pt):Xt.set(Qe,[pt]);return Ve?(pt=Ve(),Tt=function(Ht,pr){pt.set(Ht,Le(Ve,pr,qe))}):(pt={},Tt=function(Ht,pr){pt[Ht]=Le(Ve,pr,qe)}),Xt.forEach(Tt),pt}return se.map=function(Ve,Xe){return Le(Xe,Ve,0)},se.entries=function(Ve){return function Xe(qe,Qe){if(Qe>=he.length)return qe;var pt=[],Tt=ye[Qe++];return qe.forEach(function(Ct,jt){pt.push({key:Ct,values:Xe(jt,Qe)})}),Tt?pt.sort(function(Ct,jt){return Tt(Ct.key,jt.key)}):pt}(Le(t.map,Ve,0),0)},se.key=function(Ve){return he.push(Ve),se},se.sortKeys=function(Ve){return ye[he.length-1]=Ve,se},se.sortValues=function(Ve){return Z=Ve,se},se.rollup=function(Ve){return ne=Ve,se},se},t.set=function(Z){var ne=new L;if(Z)for(var se=0,he=Z.length;se<he;++se)ne.add(Z[se]);return ne},w(L,{has:b,add:function(Z){return this._[E(Z+="")]=!0,Z},remove:_,values:S,size:C,empty:k,forEach:function(Z){for(var ne in this._)Z.call(this,M(ne))}}),t.behavior={},t.rebind=function(Z,ne){for(var se,he=1,ye=arguments.length;++he<ye;)Z[se=arguments[he]]=R(Z,ne,ne[se]);return Z};var O=["webkit","ms","moz","Moz","o","O"];function J(){}function D(){}function B(Z){var ne=[],se=new A;function he(){for(var ye,Le=ne,Ve=-1,Xe=Le.length;++Ve<Xe;)(ye=Le[Ve].on)&&ye.apply(this,arguments);return Z}return he.on=function(ye,Le){var Ve,Xe=se.get(ye);return arguments.length<2?Xe&&Xe.on:(Xe&&(Xe.on=null,ne=ne.slice(0,Ve=ne.indexOf(Xe)).concat(ne.slice(Ve+1)),se.remove(ye)),Le&&ne.push(se.set(ye,{on:Le})),Z)},he}function N(){t.event.preventDefault()}function F(){for(var Z,ne=t.event;Z=ne.sourceEvent;)ne=Z;return ne}function H(Z){for(var ne=new D,se=0,he=arguments.length;++se<he;)ne[arguments[se]]=B(ne);return ne.of=function(ye,Le){return function(Ve){try{var Xe=Ve.sourceEvent=t.event;Ve.target=Z,t.event=Ve,ne[Ve.type].apply(ye,Le)}finally{t.event=Xe}}},ne}t.dispatch=function(){for(var Z=new D,ne=-1,se=arguments.length;++ne<se;)Z[arguments[ne]]=B(Z);return Z},D.prototype.on=function(Z,ne){var se=Z.indexOf("."),he="";if(se>=0&&(he=Z.slice(se+1),Z=Z.slice(0,se)),Z)return arguments.length<2?this[Z].on(he):this[Z].on(he,ne);if(arguments.length===2){if(ne==null)for(Z in this)this.hasOwnProperty(Z)&&this[Z].on(he,null);return this}},t.event=null,t.requote=function(Z){return Z.replace(j,"\\$&")};var j=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,G={}.__proto__?function(Z,ne){Z.__proto__=ne}:function(Z,ne){for(var se in ne)Z[se]=ne[se]};function W(Z){return G(Z,ie),Z}var Q=function(Z,ne){return ne.querySelector(Z)},$=function(Z,ne){return ne.querySelectorAll(Z)},ee=function(Z,ne){var se=Z.matches||Z[V(Z,"matchesSelector")];return(ee=function(he,ye){return se.call(he,ye)})(Z,ne)};typeof Sizzle=="function"&&(Q=function(Z,ne){return Sizzle(Z,ne)[0]||null},$=Sizzle,ee=Sizzle.matchesSelector),t.selection=function(){return t.select(l.documentElement)};var ie=t.selection.prototype=[];function ae(Z){return typeof Z=="function"?Z:function(){return Q(Z,this)}}function oe(Z){return typeof Z=="function"?Z:function(){return $(Z,this)}}ie.select=function(Z){var ne,se,he,ye,Le=[];Z=ae(Z);for(var Ve=-1,Xe=this.length;++Ve<Xe;){Le.push(ne=[]),ne.parentNode=(he=this[Ve]).parentNode;for(var qe=-1,Qe=he.length;++qe<Qe;)(ye=he[qe])?(ne.push(se=Z.call(ye,ye.__data__,qe,Ve)),se&&"__data__"in ye&&(se.__data__=ye.__data__)):ne.push(null)}return W(Le)},ie.selectAll=function(Z){var ne,se,he=[];Z=oe(Z);for(var ye=-1,Le=this.length;++ye<Le;)for(var Ve=this[ye],Xe=-1,qe=Ve.length;++Xe<qe;)(se=Ve[Xe])&&(he.push(ne=p(Z.call(se,se.__data__,Xe,ye))),ne.parentNode=se);return W(he)};var de="http://www.w3.org/1999/xhtml",le={svg:"http://www.w3.org/2000/svg",xhtml:de,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function fe(Z,ne){return Z=t.ns.qualify(Z),ne==null?Z.local?function(){this.removeAttributeNS(Z.space,Z.local)}:function(){this.removeAttribute(Z)}:typeof ne=="function"?Z.local?function(){var se=ne.apply(this,arguments);se==null?this.removeAttributeNS(Z.space,Z.local):this.setAttributeNS(Z.space,Z.local,se)}:function(){var se=ne.apply(this,arguments);se==null?this.removeAttribute(Z):this.setAttribute(Z,se)}:Z.local?function(){this.setAttributeNS(Z.space,Z.local,ne)}:function(){this.setAttribute(Z,ne)}}function ue(Z){return Z.trim().replace(/\s+/g," ")}function we(Z){return new RegExp("(?:^|\\s+)"+t.requote(Z)+"(?:\\s+|$)","g")}function Ae(Z){return(Z+"").trim().split(/^|\s+/)}function Se(Z,ne){var se=(Z=Ae(Z).map(ke)).length;return typeof ne=="function"?function(){for(var he=-1,ye=ne.apply(this,arguments);++he<se;)Z[he](this,ye)}:function(){for(var he=-1;++he<se;)Z[he](this,ne)}}function ke(Z){var ne=we(Z);return function(se,he){if(ye=se.classList)return he?ye.add(Z):ye.remove(Z);var ye=se.getAttribute("class")||"";he?(ne.lastIndex=0,ne.test(ye)||se.setAttribute("class",ue(ye+" "+Z))):se.setAttribute("class",ue(ye.replace(ne," ")))}}function Me(Z,ne,se){return ne==null?function(){this.style.removeProperty(Z)}:typeof ne=="function"?function(){var he=ne.apply(this,arguments);he==null?this.style.removeProperty(Z):this.style.setProperty(Z,he,se)}:function(){this.style.setProperty(Z,ne,se)}}function ve(Z,ne){return ne==null?function(){delete this[Z]}:typeof ne=="function"?function(){var se=ne.apply(this,arguments);se==null?delete this[Z]:this[Z]=se}:function(){this[Z]=ne}}function ge(Z){return typeof Z=="function"?Z:(Z=t.ns.qualify(Z)).local?function(){return this.ownerDocument.createElementNS(Z.space,Z.local)}:function(){var ne=this.ownerDocument,se=this.namespaceURI;return se===de&&ne.documentElement.namespaceURI===de?ne.createElement(Z):ne.createElementNS(se,Z)}}function De(){var Z=this.parentNode;Z&&Z.removeChild(this)}function _e(Z){return{__data__:Z}}function Pe(Z){return function(){return ee(this,Z)}}function Fe(Z){return arguments.length||(Z=c),function(ne,se){return ne&&se?Z(ne.__data__,se.__data__):!ne-!se}}function ze(Z,ne){for(var se=0,he=Z.length;se<he;se++)for(var ye,Le=Z[se],Ve=0,Xe=Le.length;Ve<Xe;Ve++)(ye=Le[Ve])&&ne(ye,Ve,se);return Z}function He(Z){return G(Z,et),Z}t.ns={prefix:le,qualify:function(Z){var ne=Z.indexOf(":"),se=Z;return ne>=0&&(se=Z.slice(0,ne))!=="xmlns"&&(Z=Z.slice(ne+1)),le.hasOwnProperty(se)?{space:le[se],local:Z}:Z}},ie.attr=function(Z,ne){if(arguments.length<2){if(typeof Z=="string"){var se=this.node();return(Z=t.ns.qualify(Z)).local?se.getAttributeNS(Z.space,Z.local):se.getAttribute(Z)}for(ne in Z)this.each(fe(ne,Z[ne]));return this}return this.each(fe(Z,ne))},ie.classed=function(Z,ne){if(arguments.length<2){if(typeof Z=="string"){var se=this.node(),he=(Z=Ae(Z)).length,ye=-1;if(ne=se.classList){for(;++ye<he;)if(!ne.contains(Z[ye]))return!1}else for(ne=se.getAttribute("class");++ye<he;)if(!we(Z[ye]).test(ne))return!1;return!0}for(ne in Z)this.each(Se(ne,Z[ne]));return this}return this.each(Se(Z,ne))},ie.style=function(Z,ne,se){var he=arguments.length;if(he<3){if(typeof Z!="string"){for(se in he<2&&(ne=""),Z)this.each(Me(se,Z[se],ne));return this}if(he<2){var ye=this.node();return o(ye).getComputedStyle(ye,null).getPropertyValue(Z)}se=""}return this.each(Me(Z,ne,se))},ie.property=function(Z,ne){if(arguments.length<2){if(typeof Z=="string")return this.node()[Z];for(ne in Z)this.each(ve(ne,Z[ne]));return this}return this.each(ve(Z,ne))},ie.text=function(Z){return arguments.length?this.each(typeof Z=="function"?function(){var ne=Z.apply(this,arguments);this.textContent=ne??""}:Z==null?function(){this.textContent=""}:function(){this.textContent=Z}):this.node().textContent},ie.html=function(Z){return arguments.length?this.each(typeof Z=="function"?function(){var ne=Z.apply(this,arguments);this.innerHTML=ne??""}:Z==null?function(){this.innerHTML=""}:function(){this.innerHTML=Z}):this.node().innerHTML},ie.append=function(Z){return Z=ge(Z),this.select(function(){return this.appendChild(Z.apply(this,arguments))})},ie.insert=function(Z,ne){return Z=ge(Z),ne=ae(ne),this.select(function(){return this.insertBefore(Z.apply(this,arguments),ne.apply(this,arguments)||null)})},ie.remove=function(){return this.each(De)},ie.data=function(Z,ne){var se,he,ye=-1,Le=this.length;if(!arguments.length){for(Z=new Array(Le=(se=this[0]).length);++ye<Le;)(he=se[ye])&&(Z[ye]=he.__data__);return Z}function Ve(pt,Tt){var Ct,jt,nr,Vt=pt.length,Xt=Tt.length,Ht=Math.min(Vt,Xt),pr=new Array(Xt),Wt=new Array(Xt),Kt=new Array(Vt);if(ne){var Cr,tr=new A,mr=new Array(Vt);for(Ct=-1;++Ct<Vt;)(jt=pt[Ct])&&(tr.has(Cr=ne.call(jt,jt.__data__,Ct))?Kt[Ct]=jt:tr.set(Cr,jt),mr[Ct]=Cr);for(Ct=-1;++Ct<Xt;)(jt=tr.get(Cr=ne.call(Tt,nr=Tt[Ct],Ct)))?jt!==!0&&(pr[Ct]=jt,jt.__data__=nr):Wt[Ct]=_e(nr),tr.set(Cr,!0);for(Ct=-1;++Ct<Vt;)Ct in mr&&tr.get(mr[Ct])!==!0&&(Kt[Ct]=pt[Ct])}else{for(Ct=-1;++Ct<Ht;)jt=pt[Ct],nr=Tt[Ct],jt?(jt.__data__=nr,pr[Ct]=jt):Wt[Ct]=_e(nr);for(;Ct<Xt;++Ct)Wt[Ct]=_e(Tt[Ct]);for(;Ct<Vt;++Ct)Kt[Ct]=pt[Ct]}Wt.update=pr,Wt.parentNode=pr.parentNode=Kt.parentNode=pt.parentNode,Xe.push(Wt),qe.push(pr),Qe.push(Kt)}var Xe=He([]),qe=W([]),Qe=W([]);if(typeof Z=="function")for(;++ye<Le;)Ve(se=this[ye],Z.call(se,se.parentNode.__data__,ye));else for(;++ye<Le;)Ve(se=this[ye],Z);return qe.enter=function(){return Xe},qe.exit=function(){return Qe},qe},ie.datum=function(Z){return arguments.length?this.property("__data__",Z):this.property("__data__")},ie.filter=function(Z){var ne,se,he,ye=[];typeof Z!="function"&&(Z=Pe(Z));for(var Le=0,Ve=this.length;Le<Ve;Le++){ye.push(ne=[]),ne.parentNode=(se=this[Le]).parentNode;for(var Xe=0,qe=se.length;Xe<qe;Xe++)(he=se[Xe])&&Z.call(he,he.__data__,Xe,Le)&&ne.push(he)}return W(ye)},ie.order=function(){for(var Z=-1,ne=this.length;++Z<ne;)for(var se,he=this[Z],ye=he.length-1,Le=he[ye];--ye>=0;)(se=he[ye])&&(Le&&Le!==se.nextSibling&&Le.parentNode.insertBefore(se,Le),Le=se);return this},ie.sort=function(Z){Z=Fe.apply(this,arguments);for(var ne=-1,se=this.length;++ne<se;)this[ne].sort(Z);return this.order()},ie.each=function(Z){return ze(this,function(ne,se,he){Z.call(ne,ne.__data__,se,he)})},ie.call=function(Z){var ne=p(arguments);return Z.apply(ne[0]=this,ne),this},ie.empty=function(){return!this.node()},ie.node=function(){for(var Z=0,ne=this.length;Z<ne;Z++)for(var se=this[Z],he=0,ye=se.length;he<ye;he++){var Le=se[he];if(Le)return Le}return null},ie.size=function(){var Z=0;return ze(this,function(){++Z}),Z};var et=[];function Re(Z){var ne,se;return function(he,ye,Le){var Ve,Xe=Z[Le].update,qe=Xe.length;for(Le!=se&&(se=Le,ne=0),ye>=ne&&(ne=ye+1);!(Ve=Xe[ne])&&++ne<qe;);return Ve}}function Ze(Z,ne,se){var he="__on"+Z,ye=Z.indexOf("."),Le=$e;ye>0&&(Z=Z.slice(0,ye));var Ve=Ke.get(Z);function Xe(){var qe=this[he];qe&&(this.removeEventListener(Z,qe,qe.$),delete this[he])}return Ve&&(Z=Ve,Le=rt),ye?ne?function(){var qe=Le(ne,p(arguments));Xe.call(this),this.addEventListener(Z,this[he]=qe,qe.$=se),qe._=ne}:Xe:ne?J:function(){var qe,Qe=new RegExp("^__on([^.]+)"+t.requote(Z)+"$");for(var pt in this)if(qe=pt.match(Qe)){var Tt=this[pt];this.removeEventListener(qe[1],Tt,Tt.$),delete this[pt]}}}t.selection.enter=He,t.selection.enter.prototype=et,et.append=ie.append,et.empty=ie.empty,et.node=ie.node,et.call=ie.call,et.size=ie.size,et.select=function(Z){for(var ne,se,he,ye,Le,Ve=[],Xe=-1,qe=this.length;++Xe<qe;){he=(ye=this[Xe]).update,Ve.push(ne=[]),ne.parentNode=ye.parentNode;for(var Qe=-1,pt=ye.length;++Qe<pt;)(Le=ye[Qe])?(ne.push(he[Qe]=se=Z.call(ye.parentNode,Le.__data__,Qe,Xe)),se.__data__=Le.__data__):ne.push(null)}return W(Ve)},et.insert=function(Z,ne){return arguments.length<2&&(ne=Re(this)),ie.insert.call(this,Z,ne)},t.select=function(Z){var ne;return typeof Z=="string"?(ne=[Q(Z,l)]).parentNode=l.documentElement:(ne=[Z]).parentNode=e(Z),W([ne])},t.selectAll=function(Z){var ne;return typeof Z=="string"?(ne=p($(Z,l))).parentNode=l.documentElement:(ne=p(Z)).parentNode=null,W([ne])},ie.on=function(Z,ne,se){var he=arguments.length;if(he<3){if(typeof Z!="string"){for(se in he<2&&(ne=!1),Z)this.each(Ze(se,Z[se],ne));return this}if(he<2)return(he=this.node()["__on"+Z])&&he._;se=!1}return this.each(Ze(Z,ne,se))};var Ke=t.map({mouseenter:"mouseover",mouseleave:"mouseout"});function $e(Z,ne){return function(se){var he=t.event;t.event=se,ne[0]=this.__data__;try{Z.apply(this,ne)}finally{t.event=he}}}function rt(Z,ne){var se=$e(Z,ne);return function(he){var ye=he.relatedTarget;ye&&(ye===this||8&ye.compareDocumentPosition(this))||se.call(this,he)}}l&&Ke.forEach(function(Z){"on"+Z in l&&Ke.remove(Z)});var at,lt=0;function gt(Z){var ne=".dragsuppress-"+ ++lt,se="click"+ne,he=t.select(o(Z)).on("touchmove"+ne,N).on("dragstart"+ne,N).on("selectstart"+ne,N);if(at==null&&(at=!("onselectstart"in Z)&&V(Z.style,"userSelect")),at){var ye=e(Z).style,Le=ye[at];ye[at]="none"}return function(Ve){if(he.on(ne,null),at&&(ye[at]=Le),Ve){var Xe=function(){he.on(se,null)};he.on(se,function(){N(),Xe()},!0),setTimeout(Xe,0)}}}t.mouse=function(Z){return be(Z,F())};var Ie=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;function be(Z,ne){ne.changedTouches&&(ne=ne.changedTouches[0]);var se=Z.ownerSVGElement||Z;if(se.createSVGPoint){var he=se.createSVGPoint();if(Ie<0){var ye=o(Z);if(ye.scrollX||ye.scrollY){var Le=(se=t.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important"))[0][0].getScreenCTM();Ie=!(Le.f||Le.e),se.remove()}}return Ie?(he.x=ne.pageX,he.y=ne.pageY):(he.x=ne.clientX,he.y=ne.clientY),[(he=he.matrixTransform(Z.getScreenCTM().inverse())).x,he.y]}var Ve=Z.getBoundingClientRect();return[ne.clientX-Ve.left-Z.clientLeft,ne.clientY-Ve.top-Z.clientTop]}function We(){return t.event.changedTouches[0].identifier}t.touch=function(Z,ne,se){if(arguments.length<3&&(se=ne,ne=F().changedTouches),ne){for(var he,ye=0,Le=ne.length;ye<Le;++ye)if((he=ne[ye]).identifier===se)return be(Z,he)}},t.behavior.drag=function(){var Z=H(ye,"drag","dragstart","dragend"),ne=null,se=Le(J,t.mouse,o,"mousemove","mouseup"),he=Le(We,t.touch,I,"touchmove","touchend");function ye(){this.on("mousedown.drag",se).on("touchstart.drag",he)}function Le(Ve,Xe,qe,Qe,pt){return function(){var Tt,Ct=this,jt=t.event.target.correspondingElement||t.event.target,nr=Ct.parentNode,Vt=Z.of(Ct,arguments),Xt=0,Ht=Ve(),pr=".drag"+(Ht==null?"":"-"+Ht),Wt=t.select(qe(jt)).on(Qe+pr,tr).on(pt+pr,mr),Kt=gt(jt),Cr=Xe(nr,Ht);function tr(){var wr,Wr,Rr=Xe(nr,Ht);Rr&&(wr=Rr[0]-Cr[0],Wr=Rr[1]-Cr[1],Xt|=wr|Wr,Cr=Rr,Vt({type:"drag",x:Rr[0]+Tt[0],y:Rr[1]+Tt[1],dx:wr,dy:Wr}))}function mr(){Xe(nr,Ht)&&(Wt.on(Qe+pr,null).on(pt+pr,null),Kt(Xt),Vt({type:"dragend"}))}Tt=ne?[(Tt=ne.apply(Ct,arguments)).x-Cr[0],Tt.y-Cr[1]]:[0,0],Vt({type:"dragstart"})}}return ye.origin=function(Ve){return arguments.length?(ne=Ve,ye):ne},t.rebind(ye,Z,"on")},t.touches=function(Z,ne){return arguments.length<2&&(ne=F().touches),ne?p(ne).map(function(se){var he=be(Z,se);return he.identifier=se.identifier,he}):[]};var Ge=1e-6,st=1e-12,ot=Math.PI,Ce=2*ot,Ue=Ce-Ge,Ye=ot/2,xe=ot/180,Ee=180/ot;function Je(Z){return Z>0?1:Z<0?-1:0}function it(Z,ne,se){return(ne[0]-Z[0])*(se[1]-Z[1])-(ne[1]-Z[1])*(se[0]-Z[0])}function ht(Z){return Z>1?0:Z<-1?ot:Math.acos(Z)}function ct(Z){return Z>1?Ye:Z<-1?-Ye:Math.asin(Z)}function mt(Z){return((Z=Math.exp(Z))+1/Z)/2}function bt(Z){return(Z=Math.sin(Z/2))*Z}var Et=Math.SQRT2;t.interpolateZoom=function(Z,ne){var se,he,ye=Z[0],Le=Z[1],Ve=Z[2],Xe=ne[0],qe=ne[1],Qe=ne[2],pt=Xe-ye,Tt=qe-Le,Ct=pt*pt+Tt*Tt;if(Ct<st)he=Math.log(Qe/Ve)/Et,se=function(pr){return[ye+pr*pt,Le+pr*Tt,Ve*Math.exp(Et*pr*he)]};else{var jt=Math.sqrt(Ct),nr=(Qe*Qe-Ve*Ve+4*Ct)/(2*Ve*2*jt),Vt=(Qe*Qe-Ve*Ve-4*Ct)/(2*Qe*2*jt),Xt=Math.log(Math.sqrt(nr*nr+1)-nr),Ht=Math.log(Math.sqrt(Vt*Vt+1)-Vt);he=(Ht-Xt)/Et,se=function(pr){var Wt,Kt=pr*he,Cr=mt(Xt),tr=Ve/(2*jt)*(Cr*(Wt=Et*Kt+Xt,((Wt=Math.exp(2*Wt))-1)/(Wt+1))-function(mr){return((mr=Math.exp(mr))-1/mr)/2}(Xt));return[ye+tr*pt,Le+tr*Tt,Ve*Cr/mt(Et*Kt+Xt)]}}return se.duration=1e3*he,se},t.behavior.zoom=function(){var Z,ne,se,he,ye,Le,Ve,Xe,qe,Qe={x:0,y:0,k:1},pt=[960,500],Tt=xt,Ct=250,jt=0,nr="mousedown.zoom",Vt="mousemove.zoom",Xt="mouseup.zoom",Ht="touchstart.zoom",pr=H(Wt,"zoomstart","zoom","zoomend");function Wt($r){$r.on(nr,jr).on(_t+".zoom",Mn).on("dblclick.zoom",An).on(Ht,ln)}function Kt($r){return[($r[0]-Qe.x)/Qe.k,($r[1]-Qe.y)/Qe.k]}function Cr($r){Qe.k=Math.max(Tt[0],Math.min(Tt[1],$r))}function tr($r,Tn){Tn=function(Xn){return[Xn[0]*Qe.k+Qe.x,Xn[1]*Qe.k+Qe.y]}(Tn),Qe.x+=$r[0]-Tn[0],Qe.y+=$r[1]-Tn[1]}function mr($r,Tn,Xn,Bn){$r.__chart__={x:Qe.x,y:Qe.y,k:Qe.k},Cr(Math.pow(2,Bn)),tr(ne=Tn,Xn),$r=t.select($r),Ct>0&&($r=$r.transition().duration(Ct)),$r.call(Wt.event)}function wr(){Ve&&Ve.domain(Le.range().map(function($r){return($r-Qe.x)/Qe.k}).map(Le.invert)),qe&&qe.domain(Xe.range().map(function($r){return($r-Qe.y)/Qe.k}).map(Xe.invert))}function Wr($r){jt++||$r({type:"zoomstart"})}function Rr($r){wr(),$r({type:"zoom",scale:Qe.k,translate:[Qe.x,Qe.y]})}function tn($r){--jt||($r({type:"zoomend"}),ne=null)}function jr(){var $r=this,Tn=pr.of($r,arguments),Xn=0,Bn=t.select(o($r)).on(Vt,xa).on(Xt,ka),aa=Kt(t.mouse($r)),la=gt($r);function xa(){Xn=1,tr(t.mouse($r),aa),Rr(Tn)}function ka(){Bn.on(Vt,null).on(Xt,null),la(Xn),tn(Tn)}_c.call($r),Wr(Tn)}function ln(){var $r,Tn=this,Xn=pr.of(Tn,arguments),Bn={},aa=0,la=".zoom-"+t.event.changedTouches[0].identifier,xa="touchmove"+la,ka="touchend"+la,Na=[],ii=t.select(Tn),Ki=gt(Tn);function xi(){var si=t.touches(Tn);return $r=Qe.k,si.forEach(function(hi){hi.identifier in Bn&&(Bn[hi.identifier]=Kt(hi))}),si}function oi(){var si=t.event.target;t.select(si).on(xa,oo).on(ka,Vo),Na.push(si);for(var hi=t.event.changedTouches,Di=0,qo=hi.length;Di<qo;++Di)Bn[hi[Di].identifier]=null;var Ho=xi(),Cl=Date.now();if(Ho.length===1){if(Cl-ye<500){var xs=Ho[0];mr(Tn,xs,Bn[xs.identifier],Math.floor(Math.log(Qe.k)/Math.LN2)+1),N()}ye=Cl}else if(Ho.length>1){xs=Ho[0];var Fs=Ho[1],Ll=xs[0]-Fs[0],kc=xs[1]-Fs[1];aa=Ll*Ll+kc*kc}}function oo(){var si,hi,Di,qo,Ho=t.touches(Tn);_c.call(Tn);for(var Cl=0,xs=Ho.length;Cl<xs;++Cl,qo=null)if(Di=Ho[Cl],qo=Bn[Di.identifier]){if(hi)break;si=Di,hi=qo}if(qo){var Fs=(Fs=Di[0]-si[0])*Fs+(Fs=Di[1]-si[1])*Fs,Ll=aa&&Math.sqrt(Fs/aa);si=[(si[0]+Di[0])/2,(si[1]+Di[1])/2],hi=[(hi[0]+qo[0])/2,(hi[1]+qo[1])/2],Cr(Ll*$r)}ye=null,tr(si,hi),Rr(Xn)}function Vo(){if(t.event.touches.length){for(var si=t.event.changedTouches,hi=0,Di=si.length;hi<Di;++hi)delete Bn[si[hi].identifier];for(var qo in Bn)return void xi()}t.selectAll(Na).on(la,null),ii.on(nr,jr).on(Ht,ln),Ki(),tn(Xn)}oi(),Wr(Xn),ii.on(nr,null).on(Ht,oi)}function Mn(){var $r=pr.of(this,arguments);he?clearTimeout(he):(_c.call(this),Z=Kt(ne=se||t.mouse(this)),Wr($r)),he=setTimeout(function(){he=null,tn($r)},50),N(),Cr(Math.pow(2,.002*Mt())*Qe.k),tr(ne,Z),Rr($r)}function An(){var $r=t.mouse(this),Tn=Math.log(Qe.k)/Math.LN2;mr(this,$r,Kt($r),t.event.shiftKey?Math.ceil(Tn)-1:Math.floor(Tn)+1)}return _t||(_t="onwheel"in l?(Mt=function(){return-t.event.deltaY*(t.event.deltaMode?120:1)},"wheel"):"onmousewheel"in l?(Mt=function(){return t.event.wheelDelta},"mousewheel"):(Mt=function(){return-t.event.detail},"MozMousePixelScroll")),Wt.event=function($r){$r.each(function(){var Tn=pr.of(this,arguments),Xn=Qe;Uo?t.select(this).transition().each("start.zoom",function(){Qe=this.__chart__||{x:0,y:0,k:1},Wr(Tn)}).tween("zoom:zoom",function(){var Bn=pt[0],aa=pt[1],la=ne?ne[0]:Bn/2,xa=ne?ne[1]:aa/2,ka=t.interpolateZoom([(la-Qe.x)/Qe.k,(xa-Qe.y)/Qe.k,Bn/Qe.k],[(la-Xn.x)/Xn.k,(xa-Xn.y)/Xn.k,Bn/Xn.k]);return function(Na){var ii=ka(Na),Ki=Bn/ii[2];this.__chart__=Qe={x:la-ii[0]*Ki,y:xa-ii[1]*Ki,k:Ki},Rr(Tn)}}).each("interrupt.zoom",function(){tn(Tn)}).each("end.zoom",function(){tn(Tn)}):(this.__chart__=Qe,Wr(Tn),Rr(Tn),tn(Tn))})},Wt.translate=function($r){return arguments.length?(Qe={x:+$r[0],y:+$r[1],k:Qe.k},wr(),Wt):[Qe.x,Qe.y]},Wt.scale=function($r){return arguments.length?(Qe={x:Qe.x,y:Qe.y,k:null},Cr(+$r),wr(),Wt):Qe.k},Wt.scaleExtent=function($r){return arguments.length?(Tt=$r==null?xt:[+$r[0],+$r[1]],Wt):Tt},Wt.center=function($r){return arguments.length?(se=$r&&[+$r[0],+$r[1]],Wt):se},Wt.size=function($r){return arguments.length?(pt=$r&&[+$r[0],+$r[1]],Wt):pt},Wt.duration=function($r){return arguments.length?(Ct=+$r,Wt):Ct},Wt.x=function($r){return arguments.length?(Ve=$r,Le=$r.copy(),Qe={x:0,y:0,k:1},Wt):Ve},Wt.y=function($r){return arguments.length?(qe=$r,Xe=$r.copy(),Qe={x:0,y:0,k:1},Wt):qe},t.rebind(Wt,pr,"on")};var Mt,_t,xt=[0,1/0];function At(){}function It(Z,ne,se){return this instanceof It?(this.h=+Z,this.s=+ne,void(this.l=+se)):arguments.length<2?Z instanceof It?new It(Z.h,Z.s,Z.l):Lr(""+Z,Hr,It):new It(Z,ne,se)}t.color=At,At.prototype.toString=function(){return this.rgb()+""},t.hsl=It;var Nt=It.prototype=new At;function Ot(Z,ne,se){var he,ye;function Le(Ve){return Math.round(255*function(Xe){return Xe>360?Xe-=360:Xe<0&&(Xe+=360),Xe<60?he+(ye-he)*Xe/60:Xe<180?ye:Xe<240?he+(ye-he)*(240-Xe)/60:he}(Ve))}return Z=isNaN(Z)?0:(Z%=360)<0?Z+360:Z,ne=isNaN(ne)||ne<0?0:ne>1?1:ne,he=2*(se=se<0?0:se>1?1:se)-(ye=se<=.5?se*(1+ne):se+ne-se*ne),new cr(Le(Z+120),Le(Z),Le(Z-120))}function Yt(Z,ne,se){return this instanceof Yt?(this.h=+Z,this.c=+ne,void(this.l=+se)):arguments.length<2?Z instanceof Yt?new Yt(Z.h,Z.c,Z.l):er(Z instanceof ut?Z.l:(Z=Kr((Z=t.rgb(Z)).r,Z.g,Z.b)).l,Z.a,Z.b):new Yt(Z,ne,se)}Nt.brighter=function(Z){return Z=Math.pow(.7,arguments.length?Z:1),new It(this.h,this.s,this.l/Z)},Nt.darker=function(Z){return Z=Math.pow(.7,arguments.length?Z:1),new It(this.h,this.s,Z*this.l)},Nt.rgb=function(){return Ot(this.h,this.s,this.l)},t.hcl=Yt;var Pt=Yt.prototype=new At;function Ne(Z,ne,se){return isNaN(Z)&&(Z=0),isNaN(ne)&&(ne=0),new ut(se,Math.cos(Z*=xe)*ne,Math.sin(Z)*ne)}function ut(Z,ne,se){return this instanceof ut?(this.l=+Z,this.a=+ne,void(this.b=+se)):arguments.length<2?Z instanceof ut?new ut(Z.l,Z.a,Z.b):Z instanceof Yt?Ne(Z.h,Z.c,Z.l):Kr((Z=cr(Z)).r,Z.g,Z.b):new ut(Z,ne,se)}Pt.brighter=function(Z){return new Yt(this.h,this.c,Math.min(100,this.l+wt*(arguments.length?Z:1)))},Pt.darker=function(Z){return new Yt(this.h,this.c,Math.max(0,this.l-wt*(arguments.length?Z:1)))},Pt.rgb=function(){return Ne(this.h,this.c,this.l).rgb()},t.lab=ut;var wt=18,Bt=ut.prototype=new At;function Jt(Z,ne,se){var he=(Z+16)/116,ye=he+ne/500,Le=he-se/200;return new cr(Qt(3.2404542*(ye=.95047*or(ye))-1.5371385*(he=1*or(he))-.4985314*(Le=1.08883*or(Le))),Qt(-.969266*ye+1.8760108*he+.041556*Le),Qt(.0556434*ye-.2040259*he+1.0572252*Le))}function er(Z,ne,se){return Z>0?new Yt(Math.atan2(se,ne)*Ee,Math.sqrt(ne*ne+se*se),Z):new Yt(NaN,NaN,Z)}function or(Z){return Z>.206893034?Z*Z*Z:(Z-4/29)/7.787037}function zt(Z){return Z>.008856?Math.pow(Z,1/3):7.787037*Z+4/29}function Qt(Z){return Math.round(255*(Z<=.00304?12.92*Z:1.055*Math.pow(Z,1/2.4)-.055))}function cr(Z,ne,se){return this instanceof cr?(this.r=~~Z,this.g=~~ne,void(this.b=~~se)):arguments.length<2?Z instanceof cr?new cr(Z.r,Z.g,Z.b):Lr(""+Z,cr,Ot):new cr(Z,ne,se)}function Dt(Z){return new cr(Z>>16,Z>>8&255,255&Z)}function Ut(Z){return Dt(Z)+""}Bt.brighter=function(Z){return new ut(Math.min(100,this.l+wt*(arguments.length?Z:1)),this.a,this.b)},Bt.darker=function(Z){return new ut(Math.max(0,this.l-wt*(arguments.length?Z:1)),this.a,this.b)},Bt.rgb=function(){return Jt(this.l,this.a,this.b)},t.rgb=cr;var ur=cr.prototype=new At;function Sr(Z){return Z<16?"0"+Math.max(0,Z).toString(16):Math.min(255,Z).toString(16)}function Lr(Z,ne,se){var he,ye,Le,Ve=0,Xe=0,qe=0;if(he=/([a-z]+)\((.*)\)/.exec(Z=Z.toLowerCase()))switch(ye=he[2].split(","),he[1]){case"hsl":return se(parseFloat(ye[0]),parseFloat(ye[1])/100,parseFloat(ye[2])/100);case"rgb":return ne(kr(ye[0]),kr(ye[1]),kr(ye[2]))}return(Le=rn.get(Z))?ne(Le.r,Le.g,Le.b):(Z==null||Z.charAt(0)!=="#"||isNaN(Le=parseInt(Z.slice(1),16))||(Z.length===4?(Ve=(3840&Le)>>4,Ve|=Ve>>4,Xe=240&Le,Xe|=Xe>>4,qe=15&Le,qe|=qe<<4):Z.length===7&&(Ve=(16711680&Le)>>16,Xe=(65280&Le)>>8,qe=255&Le)),ne(Ve,Xe,qe))}function Hr(Z,ne,se){var he,ye,Le=Math.min(Z/=255,ne/=255,se/=255),Ve=Math.max(Z,ne,se),Xe=Ve-Le,qe=(Ve+Le)/2;return Xe?(ye=qe<.5?Xe/(Ve+Le):Xe/(2-Ve-Le),he=Z==Ve?(ne-se)/Xe+(ne<se?6:0):ne==Ve?(se-Z)/Xe+2:(Z-ne)/Xe+4,he*=60):(he=NaN,ye=qe>0&&qe<1?0:he),new It(he,ye,qe)}function Kr(Z,ne,se){var he=zt((.4124564*(Z=Ir(Z))+.3575761*(ne=Ir(ne))+.1804375*(se=Ir(se)))/.95047),ye=zt((.2126729*Z+.7151522*ne+.072175*se)/1);return ut(116*ye-16,500*(he-ye),200*(ye-zt((.0193339*Z+.119192*ne+.9503041*se)/1.08883)))}function Ir(Z){return(Z/=255)<=.04045?Z/12.92:Math.pow((Z+.055)/1.055,2.4)}function kr(Z){var ne=parseFloat(Z);return Z.charAt(Z.length-1)==="%"?Math.round(2.55*ne):ne}ur.brighter=function(Z){Z=Math.pow(.7,arguments.length?Z:1);var ne=this.r,se=this.g,he=this.b,ye=30;return ne||se||he?(ne&&ne<ye&&(ne=ye),se&&se<ye&&(se=ye),he&&he<ye&&(he=ye),new cr(Math.min(255,ne/Z),Math.min(255,se/Z),Math.min(255,he/Z))):new cr(ye,ye,ye)},ur.darker=function(Z){return new cr((Z=Math.pow(.7,arguments.length?Z:1))*this.r,Z*this.g,Z*this.b)},ur.hsl=function(){return Hr(this.r,this.g,this.b)},ur.toString=function(){return"#"+Sr(this.r)+Sr(this.g)+Sr(this.b)};var rn=t.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});function Qr(Z){return typeof Z=="function"?Z:function(){return Z}}function nn(Z){return function(ne,se,he){return arguments.length===2&&typeof se=="function"&&(he=se,se=null),Xr(ne,se,Z,he)}}function Xr(Z,ne,se,he){var ye={},Le=t.dispatch("beforesend","progress","load","error"),Ve={},Xe=new XMLHttpRequest,qe=null;function Qe(){var pt,Tt=Xe.status;if(!Tt&&function(Ct){var jt=Ct.responseType;return jt&&jt!=="text"?Ct.response:Ct.responseText}(Xe)||Tt>=200&&Tt<300||Tt===304){try{pt=se.call(ye,Xe)}catch(Ct){return void Le.error.call(ye,Ct)}Le.load.call(ye,pt)}else Le.error.call(ye,Xe)}return this.XDomainRequest&&!("withCredentials"in Xe)&&/^(http(s)?:)?\/\//.test(Z)&&(Xe=new XDomainRequest),"onload"in Xe?Xe.onload=Xe.onerror=Qe:Xe.onreadystatechange=function(){Xe.readyState>3&&Qe()},Xe.onprogress=function(pt){var Tt=t.event;t.event=pt;try{Le.progress.call(ye,Xe)}finally{t.event=Tt}},ye.header=function(pt,Tt){return pt=(pt+"").toLowerCase(),arguments.length<2?Ve[pt]:(Tt==null?delete Ve[pt]:Ve[pt]=Tt+"",ye)},ye.mimeType=function(pt){return arguments.length?(ne=pt==null?null:pt+"",ye):ne},ye.responseType=function(pt){return arguments.length?(qe=pt,ye):qe},ye.response=function(pt){return se=pt,ye},["get","post"].forEach(function(pt){ye[pt]=function(){return ye.send.apply(ye,[pt].concat(p(arguments)))}}),ye.send=function(pt,Tt,Ct){if(arguments.length===2&&typeof Tt=="function"&&(Ct=Tt,Tt=null),Xe.open(pt,Z,!0),ne==null||"accept"in Ve||(Ve.accept=ne+",*/*"),Xe.setRequestHeader)for(var jt in Ve)Xe.setRequestHeader(jt,Ve[jt]);return ne!=null&&Xe.overrideMimeType&&Xe.overrideMimeType(ne),qe!=null&&(Xe.responseType=qe),Ct!=null&&ye.on("error",Ct).on("load",function(nr){Ct(null,nr)}),Le.beforesend.call(ye,Xe),Xe.send(Tt??null),ye},ye.abort=function(){return Xe.abort(),ye},t.rebind(ye,Le,"on"),he==null?ye:ye.get(function(pt){return pt.length===1?function(Tt,Ct){pt(Tt==null?Ct:null)}:pt}(he))}rn.forEach(function(Z,ne){rn.set(Z,Dt(ne))}),t.functor=Qr,t.xhr=nn(I),t.dsv=function(Z,ne){var se=new RegExp('["'+Z+`
]`),he=Z.charCodeAt(0);function ye(Qe,pt,Tt){arguments.length<3&&(Tt=pt,pt=null);var Ct=Xr(Qe,ne,pt==null?Le:Ve(pt),Tt);return Ct.row=function(jt){return arguments.length?Ct.response((pt=jt)==null?Le:Ve(jt)):pt},Ct}function Le(Qe){return ye.parse(Qe.responseText)}function Ve(Qe){return function(pt){return ye.parse(pt.responseText,Qe)}}function Xe(Qe){return Qe.map(qe).join(Z)}function qe(Qe){return se.test(Qe)?'"'+Qe.replace(/\"/g,'""')+'"':Qe}return ye.parse=function(Qe,pt){var Tt;return ye.parseRows(Qe,function(Ct,jt){if(Tt)return Tt(Ct,jt-1);var nr=new Function("d","return {"+Ct.map(function(Vt,Xt){return JSON.stringify(Vt)+": d["+Xt+"]"}).join(",")+"}");Tt=pt?function(Vt,Xt){return pt(nr(Vt),Xt)}:nr})},ye.parseRows=function(Qe,pt){var Tt,Ct,jt={},nr={},Vt=[],Xt=Qe.length,Ht=0,pr=0;function Wt(){if(Ht>=Xt)return nr;if(Ct)return Ct=!1,jt;var Cr=Ht;if(Qe.charCodeAt(Cr)===34){for(var tr=Cr;tr++<Xt;)if(Qe.charCodeAt(tr)===34){if(Qe.charCodeAt(tr+1)!==34)break;++tr}return Ht=tr+2,(mr=Qe.charCodeAt(tr+1))===13?(Ct=!0,Qe.charCodeAt(tr+2)===10&&++Ht):mr===10&&(Ct=!0),Qe.slice(Cr+1,tr).replace(/""/g,'"')}for(;Ht<Xt;){var mr,wr=1;if((mr=Qe.charCodeAt(Ht++))===10)Ct=!0;else if(mr===13)Ct=!0,Qe.charCodeAt(Ht)===10&&(++Ht,++wr);else if(mr!==he)continue;return Qe.slice(Cr,Ht-wr)}return Qe.slice(Cr)}for(;(Tt=Wt())!==nr;){for(var Kt=[];Tt!==jt&&Tt!==nr;)Kt.push(Tt),Tt=Wt();pt&&(Kt=pt(Kt,pr++))==null||Vt.push(Kt)}return Vt},ye.format=function(Qe){if(Array.isArray(Qe[0]))return ye.formatRows(Qe);var pt=new L,Tt=[];return Qe.forEach(function(Ct){for(var jt in Ct)pt.has(jt)||Tt.push(pt.add(jt))}),[Tt.map(qe).join(Z)].concat(Qe.map(function(Ct){return Tt.map(function(jt){return qe(Ct[jt])}).join(Z)})).join(`
`)},ye.formatRows=function(Qe){return Qe.map(Xe).join(`
`)},ye},t.csv=t.dsv(",","text/csv"),t.tsv=t.dsv("	","text/tab-separated-values");var Nr,Br,on,cn,un=this[V(this,"requestAnimationFrame")]||function(Z){setTimeout(Z,17)};function Zr(Z,ne,se){var he=arguments.length;he<2&&(ne=0),he<3&&(se=Date.now());var ye=se+ne,Le={c:Z,t:ye,n:null};return Br?Br.n=Le:Nr=Le,Br=Le,on||(cn=clearTimeout(cn),on=1,un(yn)),Le}function yn(){var Z=In(),ne=Un()-Z;ne>24?(isFinite(ne)&&(clearTimeout(cn),cn=setTimeout(yn,ne)),on=0):(on=1,un(yn))}function In(){for(var Z=Date.now(),ne=Nr;ne;)Z>=ne.t&&ne.c(Z-ne.t)&&(ne.c=null),ne=ne.n;return Z}function Un(){for(var Z,ne=Nr,se=1/0;ne;)ne.c?(ne.t<se&&(se=ne.t),ne=(Z=ne).n):ne=Z?Z.n=ne.n:Nr=ne.n;return Br=Z,se}function Kn(Z,ne){return ne-(Z?Math.ceil(Math.log(Z)/Math.LN10):1)}t.timer=function(){Zr.apply(this,arguments)},t.timer.flush=function(){In(),Un()},t.round=function(Z,ne){return ne?Math.round(Z*(ne=Math.pow(10,ne)))/ne:Math.round(Z)};var vt=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"].map(function(Z,ne){var se=Math.pow(10,3*v(8-ne));return{scale:ne>8?function(he){return he/se}:function(he){return he*se},symbol:Z}});function Zt(Z){var ne=Z.decimal,se=Z.thousands,he=Z.grouping,ye=Z.currency,Le=he&&se?function(Ve,Xe){for(var qe=Ve.length,Qe=[],pt=0,Tt=he[0],Ct=0;qe>0&&Tt>0&&(Ct+Tt+1>Xe&&(Tt=Math.max(1,Xe-Ct)),Qe.push(Ve.substring(qe-=Tt,qe+Tt)),!((Ct+=Tt+1)>Xe));)Tt=he[pt=(pt+1)%he.length];return Qe.reverse().join(se)}:I;return function(Ve){var Xe=qt.exec(Ve),qe=Xe[1]||" ",Qe=Xe[2]||">",pt=Xe[3]||"-",Tt=Xe[4]||"",Ct=Xe[5],jt=+Xe[6],nr=Xe[7],Vt=Xe[8],Xt=Xe[9],Ht=1,pr="",Wt="",Kt=!1,Cr=!0;switch(Vt&&(Vt=+Vt.substring(1)),(Ct||qe==="0"&&Qe==="=")&&(Ct=qe="0",Qe="="),Xt){case"n":nr=!0,Xt="g";break;case"%":Ht=100,Wt="%",Xt="f";break;case"p":Ht=100,Wt="%",Xt="r";break;case"b":case"o":case"x":case"X":Tt==="#"&&(pr="0"+Xt.toLowerCase());case"c":Cr=!1;case"d":Kt=!0,Vt=0;break;case"s":Ht=-1,Xt="r"}Tt==="$"&&(pr=ye[0],Wt=ye[1]),Xt!="r"||Vt||(Xt="g"),Vt!=null&&(Xt=="g"?Vt=Math.max(1,Math.min(21,Vt)):Xt!="e"&&Xt!="f"||(Vt=Math.max(0,Math.min(20,Vt)))),Xt=yr.get(Xt)||Dr;var tr=Ct&&nr;return function(mr){var wr=Wt;if(Kt&&mr%1)return"";var Wr=mr<0||mr===0&&1/mr<0?(mr=-mr,"-"):pt==="-"?"":pt;if(Ht<0){var Rr=t.formatPrefix(mr,Vt);mr=Rr.scale(mr),wr=Rr.symbol+Wt}else mr*=Ht;var tn,jr,ln=(mr=Xt(mr,Vt)).lastIndexOf(".");if(ln<0){var Mn=Cr?mr.lastIndexOf("e"):-1;Mn<0?(tn=mr,jr=""):(tn=mr.substring(0,Mn),jr=mr.substring(Mn))}else tn=mr.substring(0,ln),jr=ne+mr.substring(ln+1);!Ct&&nr&&(tn=Le(tn,1/0));var An=pr.length+tn.length+jr.length+(tr?0:Wr.length),$r=An<jt?new Array(An=jt-An+1).join(qe):"";return tr&&(tn=Le($r+tn,$r.length?jt-jr.length:1/0)),Wr+=pr,mr=tn+jr,(Qe==="<"?Wr+mr+$r:Qe===">"?$r+Wr+mr:Qe==="^"?$r.substring(0,An>>=1)+Wr+mr+$r.substring(An):Wr+(tr?mr:$r+mr))+wr}}}t.formatPrefix=function(Z,ne){var se=0;return(Z=+Z)&&(Z<0&&(Z*=-1),ne&&(Z=t.round(Z,Kn(Z,ne))),se=1+Math.floor(1e-12+Math.log(Z)/Math.LN10),se=Math.max(-24,Math.min(24,3*Math.floor((se-1)/3)))),vt[8+se/3]};var qt=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,yr=t.map({b:function(Z){return Z.toString(2)},c:function(Z){return String.fromCharCode(Z)},o:function(Z){return Z.toString(8)},x:function(Z){return Z.toString(16)},X:function(Z){return Z.toString(16).toUpperCase()},g:function(Z,ne){return Z.toPrecision(ne)},e:function(Z,ne){return Z.toExponential(ne)},f:function(Z,ne){return Z.toFixed(ne)},r:function(Z,ne){return(Z=t.round(Z,Kn(Z,ne))).toFixed(Math.max(0,Math.min(20,Kn(Z*(1+1e-15),ne))))}});function Dr(Z){return Z+""}var Mr=t.time={},xr=Date;function hr(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}hr.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){Tr.setUTCDate.apply(this._,arguments)},setDay:function(){Tr.setUTCDay.apply(this._,arguments)},setFullYear:function(){Tr.setUTCFullYear.apply(this._,arguments)},setHours:function(){Tr.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){Tr.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){Tr.setUTCMinutes.apply(this._,arguments)},setMonth:function(){Tr.setUTCMonth.apply(this._,arguments)},setSeconds:function(){Tr.setUTCSeconds.apply(this._,arguments)},setTime:function(){Tr.setTime.apply(this._,arguments)}};var Tr=Date.prototype;function fr(Z,ne,se){function he(qe){var Qe=Z(qe),pt=Le(Qe,1);return qe-Qe<pt-qe?Qe:pt}function ye(qe){return ne(qe=Z(new xr(qe-1)),1),qe}function Le(qe,Qe){return ne(qe=new xr(+qe),Qe),qe}function Ve(qe,Qe,pt){var Tt=ye(qe),Ct=[];if(pt>1)for(;Tt<Qe;)se(Tt)%pt||Ct.push(new Date(+Tt)),ne(Tt,1);else for(;Tt<Qe;)Ct.push(new Date(+Tt)),ne(Tt,1);return Ct}Z.floor=Z,Z.round=he,Z.ceil=ye,Z.offset=Le,Z.range=Ve;var Xe=Z.utc=br(Z);return Xe.floor=Xe,Xe.round=br(he),Xe.ceil=br(ye),Xe.offset=br(Le),Xe.range=function(qe,Qe,pt){try{xr=hr;var Tt=new hr;return Tt._=qe,Ve(Tt,Qe,pt)}finally{xr=Date}},Z}function br(Z){return function(ne,se){try{xr=hr;var he=new hr;return he._=ne,Z(he,se)._}finally{xr=Date}}}function Or(Z){var ne=Z.dateTime,se=Z.date,he=Z.time,ye=Z.periods,Le=Z.days,Ve=Z.shortDays,Xe=Z.months,qe=Z.shortMonths;function Qe(tr){var mr=tr.length;function wr(Wr){for(var Rr,tn,jr,ln=[],Mn=-1,An=0;++Mn<mr;)tr.charCodeAt(Mn)===37&&(ln.push(tr.slice(An,Mn)),(tn=sn[Rr=tr.charAt(++Mn)])!=null&&(Rr=tr.charAt(++Mn)),(jr=Kt[Rr])&&(Rr=jr(Wr,tn??(Rr==="e"?" ":"0"))),ln.push(Rr),An=Mn+1);return ln.push(tr.slice(An,Mn)),ln.join("")}return wr.parse=function(Wr){var Rr={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null};if(pt(Rr,tr,Wr,0)!=Wr.length)return null;"p"in Rr&&(Rr.H=Rr.H%12+12*Rr.p);var tn=Rr.Z!=null&&xr!==hr,jr=new(tn?hr:xr);return"j"in Rr?jr.setFullYear(Rr.y,0,Rr.j):"W"in Rr||"U"in Rr?("w"in Rr||(Rr.w="W"in Rr?1:0),jr.setFullYear(Rr.y,0,1),jr.setFullYear(Rr.y,0,"W"in Rr?(Rr.w+6)%7+7*Rr.W-(jr.getDay()+5)%7:Rr.w+7*Rr.U-(jr.getDay()+6)%7)):jr.setFullYear(Rr.y,Rr.m,Rr.d),jr.setHours(Rr.H+(Rr.Z/100|0),Rr.M+Rr.Z%100,Rr.S,Rr.L),tn?jr._:jr},wr.toString=function(){return tr},wr}function pt(tr,mr,wr,Wr){for(var Rr,tn,jr,ln=0,Mn=mr.length,An=wr.length;ln<Mn;){if(Wr>=An)return-1;if((Rr=mr.charCodeAt(ln++))===37){if(jr=mr.charAt(ln++),!(tn=Cr[jr in sn?mr.charAt(ln++):jr])||(Wr=tn(tr,wr,Wr))<0)return-1}else if(Rr!=wr.charCodeAt(Wr++))return-1}return Wr}Qe.utc=function(tr){var mr=Qe(tr);function wr(Wr){try{var Rr=new(xr=hr);return Rr._=Wr,mr(Rr)}finally{xr=Date}}return wr.parse=function(Wr){try{xr=hr;var Rr=mr.parse(Wr);return Rr&&Rr._}finally{xr=Date}},wr.toString=mr.toString,wr},Qe.multi=Qe.utc.multi=ss;var Tt=t.map(),Ct=bn(Le),jt=Qn(Le),nr=bn(Ve),Vt=Qn(Ve),Xt=bn(Xe),Ht=Qn(Xe),pr=bn(qe),Wt=Qn(qe);ye.forEach(function(tr,mr){Tt.set(tr.toLowerCase(),mr)});var Kt={a:function(tr){return Ve[tr.getDay()]},A:function(tr){return Le[tr.getDay()]},b:function(tr){return qe[tr.getMonth()]},B:function(tr){return Xe[tr.getMonth()]},c:Qe(ne),d:function(tr,mr){return qr(tr.getDate(),mr,2)},e:function(tr,mr){return qr(tr.getDate(),mr,2)},H:function(tr,mr){return qr(tr.getHours(),mr,2)},I:function(tr,mr){return qr(tr.getHours()%12||12,mr,2)},j:function(tr,mr){return qr(1+Mr.dayOfYear(tr),mr,3)},L:function(tr,mr){return qr(tr.getMilliseconds(),mr,3)},m:function(tr,mr){return qr(tr.getMonth()+1,mr,2)},M:function(tr,mr){return qr(tr.getMinutes(),mr,2)},p:function(tr){return ye[+(tr.getHours()>=12)]},S:function(tr,mr){return qr(tr.getSeconds(),mr,2)},U:function(tr,mr){return qr(Mr.sundayOfYear(tr),mr,2)},w:function(tr){return tr.getDay()},W:function(tr,mr){return qr(Mr.mondayOfYear(tr),mr,2)},x:Qe(se),X:Qe(he),y:function(tr,mr){return qr(tr.getFullYear()%100,mr,2)},Y:function(tr,mr){return qr(tr.getFullYear()%1e4,mr,4)},Z:ja,"%":function(){return"%"}},Cr={a:function(tr,mr,wr){nr.lastIndex=0;var Wr=nr.exec(mr.slice(wr));return Wr?(tr.w=Vt.get(Wr[0].toLowerCase()),wr+Wr[0].length):-1},A:function(tr,mr,wr){Ct.lastIndex=0;var Wr=Ct.exec(mr.slice(wr));return Wr?(tr.w=jt.get(Wr[0].toLowerCase()),wr+Wr[0].length):-1},b:function(tr,mr,wr){pr.lastIndex=0;var Wr=pr.exec(mr.slice(wr));return Wr?(tr.m=Wt.get(Wr[0].toLowerCase()),wr+Wr[0].length):-1},B:function(tr,mr,wr){Xt.lastIndex=0;var Wr=Xt.exec(mr.slice(wr));return Wr?(tr.m=Ht.get(Wr[0].toLowerCase()),wr+Wr[0].length):-1},c:function(tr,mr,wr){return pt(tr,Kt.c.toString(),mr,wr)},d:Wn,e:Wn,H:ti,I:ti,j:Sa,L:ki,m:zn,M:yi,p:function(tr,mr,wr){var Wr=Tt.get(mr.slice(wr,wr+=2).toLowerCase());return Wr==null?-1:(tr.p=Wr,wr)},S:xo,U:gn,w:Dn,W:Pn,x:function(tr,mr,wr){return pt(tr,Kt.x.toString(),mr,wr)},X:function(tr,mr,wr){return pt(tr,Kt.X.toString(),mr,wr)},y:ta,Y:na,Z:fn,"%":bo};return Qe}Mr.year=fr(function(Z){return(Z=Mr.day(Z)).setMonth(0,1),Z},function(Z,ne){Z.setFullYear(Z.getFullYear()+ne)},function(Z){return Z.getFullYear()}),Mr.years=Mr.year.range,Mr.years.utc=Mr.year.utc.range,Mr.day=fr(function(Z){var ne=new xr(2e3,0);return ne.setFullYear(Z.getFullYear(),Z.getMonth(),Z.getDate()),ne},function(Z,ne){Z.setDate(Z.getDate()+ne)},function(Z){return Z.getDate()-1}),Mr.days=Mr.day.range,Mr.days.utc=Mr.day.utc.range,Mr.dayOfYear=function(Z){var ne=Mr.year(Z);return Math.floor((Z-ne-6e4*(Z.getTimezoneOffset()-ne.getTimezoneOffset()))/864e5)},["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].forEach(function(Z,ne){ne=7-ne;var se=Mr[Z]=fr(function(he){return(he=Mr.day(he)).setDate(he.getDate()-(he.getDay()+ne)%7),he},function(he,ye){he.setDate(he.getDate()+7*Math.floor(ye))},function(he){var ye=Mr.year(he).getDay();return Math.floor((Mr.dayOfYear(he)+(ye+ne)%7)/7)-(ye!==ne)});Mr[Z+"s"]=se.range,Mr[Z+"s"].utc=se.utc.range,Mr[Z+"OfYear"]=function(he){var ye=Mr.year(he).getDay();return Math.floor((Mr.dayOfYear(he)+(ye+ne)%7)/7)}}),Mr.week=Mr.sunday,Mr.weeks=Mr.sunday.range,Mr.weeks.utc=Mr.sunday.utc.range,Mr.weekOfYear=Mr.sundayOfYear;var sn={"-":"",_:" ",0:"0"},Jr=/^\s*\d+/,dn=/^%/;function qr(Z,ne,se){var he=Z<0?"-":"",ye=(he?-Z:Z)+"",Le=ye.length;return he+(Le<se?new Array(se-Le+1).join(ne)+ye:ye)}function bn(Z){return new RegExp("^(?:"+Z.map(t.requote).join("|")+")","i")}function Qn(Z){for(var ne=new A,se=-1,he=Z.length;++se<he;)ne.set(Z[se].toLowerCase(),se);return ne}function Dn(Z,ne,se){Jr.lastIndex=0;var he=Jr.exec(ne.slice(se,se+1));return he?(Z.w=+he[0],se+he[0].length):-1}function gn(Z,ne,se){Jr.lastIndex=0;var he=Jr.exec(ne.slice(se));return he?(Z.U=+he[0],se+he[0].length):-1}function Pn(Z,ne,se){Jr.lastIndex=0;var he=Jr.exec(ne.slice(se));return he?(Z.W=+he[0],se+he[0].length):-1}function na(Z,ne,se){Jr.lastIndex=0;var he=Jr.exec(ne.slice(se,se+4));return he?(Z.y=+he[0],se+he[0].length):-1}function ta(Z,ne,se){Jr.lastIndex=0;var he,ye=Jr.exec(ne.slice(se,se+2));return ye?(Z.y=(he=+ye[0])+(he>68?1900:2e3),se+ye[0].length):-1}function fn(Z,ne,se){return/^[+-]\d{4}$/.test(ne=ne.slice(se,se+5))?(Z.Z=-ne,se+5):-1}function zn(Z,ne,se){Jr.lastIndex=0;var he=Jr.exec(ne.slice(se,se+2));return he?(Z.m=he[0]-1,se+he[0].length):-1}function Wn(Z,ne,se){Jr.lastIndex=0;var he=Jr.exec(ne.slice(se,se+2));return he?(Z.d=+he[0],se+he[0].length):-1}function Sa(Z,ne,se){Jr.lastIndex=0;var he=Jr.exec(ne.slice(se,se+3));return he?(Z.j=+he[0],se+he[0].length):-1}function ti(Z,ne,se){Jr.lastIndex=0;var he=Jr.exec(ne.slice(se,se+2));return he?(Z.H=+he[0],se+he[0].length):-1}function yi(Z,ne,se){Jr.lastIndex=0;var he=Jr.exec(ne.slice(se,se+2));return he?(Z.M=+he[0],se+he[0].length):-1}function xo(Z,ne,se){Jr.lastIndex=0;var he=Jr.exec(ne.slice(se,se+2));return he?(Z.S=+he[0],se+he[0].length):-1}function ki(Z,ne,se){Jr.lastIndex=0;var he=Jr.exec(ne.slice(se,se+3));return he?(Z.L=+he[0],se+he[0].length):-1}function ja(Z){var ne=Z.getTimezoneOffset(),se=ne>0?"-":"+",he=v(ne)/60|0,ye=v(ne)%60;return se+qr(he,"0",2)+qr(ye,"0",2)}function bo(Z,ne,se){dn.lastIndex=0;var he=dn.exec(ne.slice(se,se+1));return he?se+he[0].length:-1}function ss(Z){for(var ne=Z.length,se=-1;++se<ne;)Z[se][0]=this(Z[se][0]);return function(he){for(var ye=0,Le=Z[ye];!Le[1](he);)Le=Z[++ye];return Le[0](he)}}t.locale=function(Z){return{numberFormat:Zt(Z),timeFormat:Or(Z)}};var Ua=t.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function hl(){}t.format=Ua.numberFormat,t.geo={},hl.prototype={s:0,t:0,add:function(Z){Zo(Z,this.t,_o),Zo(_o.s,this.s,this),this.s?this.t+=_o.t:this.s=_o.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var _o=new hl;function Zo(Z,ne,se){var he=se.s=Z+ne,ye=he-Z,Le=he-ye;se.t=Z-Le+(ne-ye)}function Co(Z,ne){Z&&Xo.hasOwnProperty(Z.type)&&Xo[Z.type](Z,ne)}t.geo.stream=function(Z,ne){Z&&ls.hasOwnProperty(Z.type)?ls[Z.type](Z,ne):Co(Z,ne)};var ls={Feature:function(Z,ne){Co(Z.geometry,ne)},FeatureCollection:function(Z,ne){for(var se=Z.features,he=-1,ye=se.length;++he<ye;)Co(se[he].geometry,ne)}},Xo={Sphere:function(Z,ne){ne.sphere()},Point:function(Z,ne){Z=Z.coordinates,ne.point(Z[0],Z[1],Z[2])},MultiPoint:function(Z,ne){for(var se=Z.coordinates,he=-1,ye=se.length;++he<ye;)Z=se[he],ne.point(Z[0],Z[1],Z[2])},LineString:function(Z,ne){Jo(Z.coordinates,ne,0)},MultiLineString:function(Z,ne){for(var se=Z.coordinates,he=-1,ye=se.length;++he<ye;)Jo(se[he],ne,0)},Polygon:function(Z,ne){cs(Z.coordinates,ne)},MultiPolygon:function(Z,ne){for(var se=Z.coordinates,he=-1,ye=se.length;++he<ye;)cs(se[he],ne)},GeometryCollection:function(Z,ne){for(var se=Z.geometries,he=-1,ye=se.length;++he<ye;)Co(se[he],ne)}};function Jo(Z,ne,se){var he,ye=-1,Le=Z.length-se;for(ne.lineStart();++ye<Le;)he=Z[ye],ne.point(he[0],he[1],he[2]);ne.lineEnd()}function cs(Z,ne){var se=-1,he=Z.length;for(ne.polygonStart();++se<he;)Jo(Z[se],ne,1);ne.polygonEnd()}t.geo.area=function(Z){return wo=0,t.geo.stream(Z,Fi),wo};var wo,js,pl,lo,_s,Ko,ma,us,$i,ws,eo,Ri,co=new hl,Fi={sphere:function(){wo+=4*ot},point:J,lineStart:J,lineEnd:J,polygonStart:function(){co.reset(),Fi.lineStart=oc},polygonEnd:function(){var Z=2*co;wo+=Z<0?4*ot+Z:Z,Fi.lineStart=Fi.lineEnd=Fi.point=J}};function oc(){var Z,ne,se,he,ye;function Le(Ve,Xe){Xe=Xe*xe/2+ot/4;var qe=(Ve*=xe)-se,Qe=qe>=0?1:-1,pt=Qe*qe,Tt=Math.cos(Xe),Ct=Math.sin(Xe),jt=ye*Ct,nr=he*Tt+jt*Math.cos(pt),Vt=jt*Qe*Math.sin(pt);co.add(Math.atan2(Vt,nr)),se=Ve,he=Tt,ye=Ct}Fi.point=function(Ve,Xe){Fi.point=Le,se=(Z=Ve)*xe,he=Math.cos(Xe=(ne=Xe)*xe/2+ot/4),ye=Math.sin(Xe)},Fi.lineEnd=function(){Le(Z,ne)}}function Qo(Z){var ne=Z[0],se=Z[1],he=Math.cos(se);return[he*Math.cos(ne),he*Math.sin(ne),Math.sin(se)]}function Lo(Z,ne){return Z[0]*ne[0]+Z[1]*ne[1]+Z[2]*ne[2]}function Ts(Z,ne){return[Z[1]*ne[2]-Z[2]*ne[1],Z[2]*ne[0]-Z[0]*ne[2],Z[0]*ne[1]-Z[1]*ne[0]]}function fs(Z,ne){Z[0]+=ne[0],Z[1]+=ne[1],Z[2]+=ne[2]}function $o(Z,ne){return[Z[0]*ne,Z[1]*ne,Z[2]*ne]}function Us(Z){var ne=Math.sqrt(Z[0]*Z[0]+Z[1]*Z[1]+Z[2]*Z[2]);Z[0]/=ne,Z[1]/=ne,Z[2]/=ne}function ks(Z){return[Math.atan2(Z[1],Z[0]),ct(Z[2])]}function va(Z,ne){return v(Z[0]-ne[0])<Ge&&v(Z[1]-ne[1])<Ge}t.geo.bounds=function(){var Z,ne,se,he,ye,Le,Ve,Xe,qe,Qe,pt,Tt={point:Ct,lineStart:nr,lineEnd:Vt,polygonStart:function(){Tt.point=Xt,Tt.lineStart=Ht,Tt.lineEnd=pr,qe=0,Fi.polygonStart()},polygonEnd:function(){Fi.polygonEnd(),Tt.point=Ct,Tt.lineStart=nr,Tt.lineEnd=Vt,co<0?(Z=-(se=180),ne=-(he=90)):qe>Ge?he=90:qe<-Ge&&(ne=-90),pt[0]=Z,pt[1]=se}};function Ct(tr,mr){Qe.push(pt=[Z=tr,se=tr]),mr<ne&&(ne=mr),mr>he&&(he=mr)}function jt(tr,mr){var wr=Qo([tr*xe,mr*xe]);if(Xe){var Wr=Ts(Xe,wr),Rr=Ts([Wr[1],-Wr[0],0],Wr);Us(Rr),Rr=ks(Rr);var tn=tr-ye,jr=tn>0?1:-1,ln=Rr[0]*Ee*jr,Mn=v(tn)>180;if(Mn^(jr*ye<ln&&ln<jr*tr))(An=Rr[1]*Ee)>he&&(he=An);else if(Mn^(jr*ye<(ln=(ln+360)%360-180)&&ln<jr*tr)){var An;(An=-Rr[1]*Ee)<ne&&(ne=An)}else mr<ne&&(ne=mr),mr>he&&(he=mr);Mn?tr<ye?Wt(Z,tr)>Wt(Z,se)&&(se=tr):Wt(tr,se)>Wt(Z,se)&&(Z=tr):se>=Z?(tr<Z&&(Z=tr),tr>se&&(se=tr)):tr>ye?Wt(Z,tr)>Wt(Z,se)&&(se=tr):Wt(tr,se)>Wt(Z,se)&&(Z=tr)}else Ct(tr,mr);Xe=wr,ye=tr}function nr(){Tt.point=jt}function Vt(){pt[0]=Z,pt[1]=se,Tt.point=Ct,Xe=null}function Xt(tr,mr){if(Xe){var wr=tr-ye;qe+=v(wr)>180?wr+(wr>0?360:-360):wr}else Le=tr,Ve=mr;Fi.point(tr,mr),jt(tr,mr)}function Ht(){Fi.lineStart()}function pr(){Xt(Le,Ve),Fi.lineEnd(),v(qe)>Ge&&(Z=-(se=180)),pt[0]=Z,pt[1]=se,Xe=null}function Wt(tr,mr){return(mr-=tr)<0?mr+360:mr}function Kt(tr,mr){return tr[0]-mr[0]}function Cr(tr,mr){return mr[0]<=mr[1]?mr[0]<=tr&&tr<=mr[1]:tr<mr[0]||mr[1]<tr}return function(tr){if(he=se=-(Z=ne=1/0),Qe=[],t.geo.stream(tr,Tt),Rr=Qe.length){Qe.sort(Kt);for(var mr=1,wr=[ln=Qe[0]];mr<Rr;++mr)Cr((tn=Qe[mr])[0],ln)||Cr(tn[1],ln)?(Wt(ln[0],tn[1])>Wt(ln[0],ln[1])&&(ln[1]=tn[1]),Wt(tn[0],ln[1])>Wt(ln[0],ln[1])&&(ln[0]=tn[0])):wr.push(ln=tn);for(var Wr,Rr,tn,jr=-1/0,ln=(mr=0,wr[Rr=wr.length-1]);mr<=Rr;ln=tn,++mr)tn=wr[mr],(Wr=Wt(ln[1],tn[0]))>jr&&(jr=Wr,Z=tn[0],se=ln[1])}return Qe=pt=null,Z===1/0||ne===1/0?[[NaN,NaN],[NaN,NaN]]:[[Z,ne],[se,he]]}}(),t.geo.centroid=function(Z){js=pl=lo=_s=Ko=ma=us=$i=ws=eo=Ri=0,t.geo.stream(Z,Li);var ne=ws,se=eo,he=Ri,ye=ne*ne+se*se+he*he;return ye<st&&(ne=ma,se=us,he=$i,pl<Ge&&(ne=lo,se=_s,he=Ko),(ye=ne*ne+se*se+he*he)<st)?[NaN,NaN]:[Math.atan2(se,ne)*Ee,ct(he/Math.sqrt(ye))*Ee]};var Li={sphere:J,point:sc,lineStart:Ic,lineEnd:lc,polygonStart:function(){Li.lineStart=cc},polygonEnd:function(){Li.lineStart=Ic}};function sc(Z,ne){Z*=xe;var se=Math.cos(ne*=xe);es(se*Math.cos(Z),se*Math.sin(Z),Math.sin(ne))}function es(Z,ne,se){++js,lo+=(Z-lo)/js,_s+=(ne-_s)/js,Ko+=(se-Ko)/js}function Ic(){var Z,ne,se;function he(ye,Le){ye*=xe;var Ve=Math.cos(Le*=xe),Xe=Ve*Math.cos(ye),qe=Ve*Math.sin(ye),Qe=Math.sin(Le),pt=Math.atan2(Math.sqrt((pt=ne*Qe-se*qe)*pt+(pt=se*Xe-Z*Qe)*pt+(pt=Z*qe-ne*Xe)*pt),Z*Xe+ne*qe+se*Qe);pl+=pt,ma+=pt*(Z+(Z=Xe)),us+=pt*(ne+(ne=qe)),$i+=pt*(se+(se=Qe)),es(Z,ne,se)}Li.point=function(ye,Le){ye*=xe;var Ve=Math.cos(Le*=xe);Z=Ve*Math.cos(ye),ne=Ve*Math.sin(ye),se=Math.sin(Le),Li.point=he,es(Z,ne,se)}}function lc(){Li.point=sc}function cc(){var Z,ne,se,he,ye;function Le(Ve,Xe){Ve*=xe;var qe=Math.cos(Xe*=xe),Qe=qe*Math.cos(Ve),pt=qe*Math.sin(Ve),Tt=Math.sin(Xe),Ct=he*Tt-ye*pt,jt=ye*Qe-se*Tt,nr=se*pt-he*Qe,Vt=Math.sqrt(Ct*Ct+jt*jt+nr*nr),Xt=se*Qe+he*pt+ye*Tt,Ht=Vt&&-ht(Xt)/Vt,pr=Math.atan2(Vt,Xt);ws+=Ht*Ct,eo+=Ht*jt,Ri+=Ht*nr,pl+=pr,ma+=pr*(se+(se=Qe)),us+=pr*(he+(he=pt)),$i+=pr*(ye+(ye=Tt)),es(se,he,ye)}Li.point=function(Ve,Xe){Z=Ve,ne=Xe,Li.point=Le,Ve*=xe;var qe=Math.cos(Xe*=xe);se=qe*Math.cos(Ve),he=qe*Math.sin(Ve),ye=Math.sin(Xe),es(se,he,ye)},Li.lineEnd=function(){Le(Z,ne),Li.lineEnd=lc,Li.point=sc}}function Oc(Z,ne){function se(he,ye){return he=Z(he,ye),ne(he[0],he[1])}return Z.invert&&ne.invert&&(se.invert=function(he,ye){return(he=ne.invert(he,ye))&&Z.invert(he[0],he[1])}),se}function ts(){return!0}function hs(Z,ne,se,he,ye){var Le=[],Ve=[];if(Z.forEach(function(Vt){if(!((Xt=Vt.length-1)<=0)){var Xt,Ht=Vt[0],pr=Vt[Xt];if(va(Ht,pr)){ye.lineStart();for(var Wt=0;Wt<Xt;++Wt)ye.point((Ht=Vt[Wt])[0],Ht[1]);ye.lineEnd()}else{var Kt=new rs(Ht,Vt,null,!0),Cr=new rs(Ht,null,Kt,!1);Kt.o=Cr,Le.push(Kt),Ve.push(Cr),Kt=new rs(pr,Vt,null,!1),Cr=new rs(pr,null,Kt,!0),Kt.o=Cr,Le.push(Kt),Ve.push(Cr)}}}),Ve.sort(ne),Vs(Le),Vs(Ve),Le.length){for(var Xe=0,qe=se,Qe=Ve.length;Xe<Qe;++Xe)Ve[Xe].e=qe=!qe;for(var pt,Tt,Ct=Le[0];;){for(var jt=Ct,nr=!0;jt.v;)if((jt=jt.n)===Ct)return;pt=jt.z,ye.lineStart();do{if(jt.v=jt.o.v=!0,jt.e){if(nr)for(Xe=0,Qe=pt.length;Xe<Qe;++Xe)ye.point((Tt=pt[Xe])[0],Tt[1]);else he(jt.x,jt.n.x,1,ye);jt=jt.n}else{if(nr)for(Xe=(pt=jt.p.z).length-1;Xe>=0;--Xe)ye.point((Tt=pt[Xe])[0],Tt[1]);else he(jt.x,jt.p.x,-1,ye);jt=jt.p}pt=(jt=jt.o).z,nr=!nr}while(!jt.v);ye.lineEnd()}}}function Vs(Z){if(ne=Z.length){for(var ne,se,he=0,ye=Z[0];++he<ne;)ye.n=se=Z[he],se.p=ye,ye=se;ye.n=se=Z[0],se.p=ye}}function rs(Z,ne,se,he){this.x=Z,this.z=ne,this.o=se,this.e=he,this.v=!1,this.n=this.p=null}function Ms(Z,ne,se,he){return function(ye,Le){var Ve,Xe=ne(Le),qe=ye.invert(he[0],he[1]),Qe={point:pt,lineStart:Ct,lineEnd:jt,polygonStart:function(){Qe.point=Wt,Qe.lineStart=Kt,Qe.lineEnd=Cr,Ve=[],nr=[]},polygonEnd:function(){Qe.point=pt,Qe.lineStart=Ct,Qe.lineEnd=jt,Ve=t.merge(Ve);var tr=function(mr,wr){var Wr=mr[0],Rr=mr[1],tn=[Math.sin(Wr),-Math.cos(Wr),0],jr=0,ln=0;co.reset();for(var Mn=0,An=wr.length;Mn<An;++Mn){var $r=wr[Mn],Tn=$r.length;if(Tn)for(var Xn=$r[0],Bn=Xn[0],aa=Xn[1]/2+ot/4,la=Math.sin(aa),xa=Math.cos(aa),ka=1;;){ka===Tn&&(ka=0);var Na=(mr=$r[ka])[0],ii=mr[1]/2+ot/4,Ki=Math.sin(ii),xi=Math.cos(ii),oi=Na-Bn,oo=oi>=0?1:-1,Vo=oo*oi,si=Vo>ot,hi=la*Ki;if(co.add(Math.atan2(hi*oo*Math.sin(Vo),xa*xi+hi*Math.cos(Vo))),jr+=si?oi+oo*Ce:oi,si^Bn>=Wr^Na>=Wr){var Di=Ts(Qo(Xn),Qo(mr));Us(Di);var qo=Ts(tn,Di);Us(qo);var Ho=(si^oi>=0?-1:1)*ct(qo[2]);(Rr>Ho||Rr===Ho&&(Di[0]||Di[1]))&&(ln+=si^oi>=0?1:-1)}if(!ka++)break;Bn=Na,la=Ki,xa=xi,Xn=mr}}return(jr<-Ge||jr<Ge&&co<-Ge)^1&ln}(qe,nr);Ve.length?(pr||(Le.polygonStart(),pr=!0),hs(Ve,To,tr,se,Le)):tr&&(pr||(Le.polygonStart(),pr=!0),Le.lineStart(),se(null,null,1,Le),Le.lineEnd()),pr&&(Le.polygonEnd(),pr=!1),Ve=nr=null},sphere:function(){Le.polygonStart(),Le.lineStart(),se(null,null,1,Le),Le.lineEnd(),Le.polygonEnd()}};function pt(tr,mr){var wr=ye(tr,mr);Z(tr=wr[0],mr=wr[1])&&Le.point(tr,mr)}function Tt(tr,mr){var wr=ye(tr,mr);Xe.point(wr[0],wr[1])}function Ct(){Qe.point=Tt,Xe.lineStart()}function jt(){Qe.point=pt,Xe.lineEnd()}var nr,Vt,Xt=qs(),Ht=ne(Xt),pr=!1;function Wt(tr,mr){Vt.push([tr,mr]);var wr=ye(tr,mr);Ht.point(wr[0],wr[1])}function Kt(){Ht.lineStart(),Vt=[]}function Cr(){Wt(Vt[0][0],Vt[0][1]),Ht.lineEnd();var tr,mr=Ht.clean(),wr=Xt.buffer(),Wr=wr.length;if(Vt.pop(),nr.push(Vt),Vt=null,Wr)if(1&mr){var Rr,tn=-1;if((Wr=(tr=wr[0]).length-1)>0){for(pr||(Le.polygonStart(),pr=!0),Le.lineStart();++tn<Wr;)Le.point((Rr=tr[tn])[0],Rr[1]);Le.lineEnd()}}else Wr>1&&2&mr&&wr.push(wr.pop().concat(wr.shift())),Ve.push(wr.filter(zc))}return Qe}}function zc(Z){return Z.length>1}function qs(){var Z,ne=[];return{lineStart:function(){ne.push(Z=[])},point:function(se,he){Z.push([se,he])},lineEnd:J,buffer:function(){var se=ne;return ne=[],Z=null,se},rejoin:function(){ne.length>1&&ne.push(ne.pop().concat(ne.shift()))}}}function To(Z,ne){return((Z=Z.x)[0]<0?Z[1]-Ye-Ge:Ye-Z[1])-((ne=ne.x)[0]<0?ne[1]-Ye-Ge:Ye-ne[1])}var Fl=Ms(ts,function(Z){var ne,se=NaN,he=NaN,ye=NaN;return{lineStart:function(){Z.lineStart(),ne=1},point:function(Le,Ve){var Xe=Le>0?ot:-ot,qe=v(Le-se);v(qe-ot)<Ge?(Z.point(se,he=(he+Ve)/2>0?Ye:-Ye),Z.point(ye,he),Z.lineEnd(),Z.lineStart(),Z.point(Xe,he),Z.point(Le,he),ne=0):ye!==Xe&&qe>=ot&&(v(se-ye)<Ge&&(se-=ye*Ge),v(Le-Xe)<Ge&&(Le-=Xe*Ge),he=function(Qe,pt,Tt,Ct){var jt,nr,Vt=Math.sin(Qe-Tt);return v(Vt)>Ge?Math.atan((Math.sin(pt)*(nr=Math.cos(Ct))*Math.sin(Tt)-Math.sin(Ct)*(jt=Math.cos(pt))*Math.sin(Qe))/(jt*nr*Vt)):(pt+Ct)/2}(se,he,Le,Ve),Z.point(ye,he),Z.lineEnd(),Z.lineStart(),Z.point(Xe,he),ne=0),Z.point(se=Le,he=Ve),ye=Xe},lineEnd:function(){Z.lineEnd(),se=he=NaN},clean:function(){return 2-ne}}},function(Z,ne,se,he){var ye;if(Z==null)ye=se*Ye,he.point(-ot,ye),he.point(0,ye),he.point(ot,ye),he.point(ot,0),he.point(ot,-ye),he.point(0,-ye),he.point(-ot,-ye),he.point(-ot,0),he.point(-ot,ye);else if(v(Z[0]-ne[0])>Ge){var Le=Z[0]<ne[0]?ot:-ot;ye=se*Le/2,he.point(-Le,ye),he.point(0,ye),he.point(Le,ye)}else he.point(ne[0],ne[1])},[-ot,-ot/2]);function Dc(Z){var ne=Math.cos(Z),se=ne>0,he=v(ne)>Ge;return Ms(ye,function(Xe){var qe,Qe,pt,Tt,Ct;return{lineStart:function(){Tt=pt=!1,Ct=1},point:function(jt,nr){var Vt,Xt=[jt,nr],Ht=ye(jt,nr),pr=se?Ht?0:Ve(jt,nr):Ht?Ve(jt+(jt<0?ot:-ot),nr):0;if(!qe&&(Tt=pt=Ht)&&Xe.lineStart(),Ht!==pt&&(Vt=Le(qe,Xt),(va(qe,Vt)||va(Xt,Vt))&&(Xt[0]+=Ge,Xt[1]+=Ge,Ht=ye(Xt[0],Xt[1]))),Ht!==pt)Ct=0,Ht?(Xe.lineStart(),Vt=Le(Xt,qe),Xe.point(Vt[0],Vt[1])):(Vt=Le(qe,Xt),Xe.point(Vt[0],Vt[1]),Xe.lineEnd()),qe=Vt;else if(he&&qe&&se^Ht){var Wt;pr&Qe||!(Wt=Le(Xt,qe,!0))||(Ct=0,se?(Xe.lineStart(),Xe.point(Wt[0][0],Wt[0][1]),Xe.point(Wt[1][0],Wt[1][1]),Xe.lineEnd()):(Xe.point(Wt[1][0],Wt[1][1]),Xe.lineEnd(),Xe.lineStart(),Xe.point(Wt[0][0],Wt[0][1])))}!Ht||qe&&va(qe,Xt)||Xe.point(Xt[0],Xt[1]),qe=Xt,pt=Ht,Qe=pr},lineEnd:function(){pt&&Xe.lineEnd(),qe=null},clean:function(){return Ct|(Tt&&pt)<<1}}},Ni(Z,6*xe),se?[0,-Z]:[-ot,Z-ot]);function ye(Xe,qe){return Math.cos(Xe)*Math.cos(qe)>ne}function Le(Xe,qe,Qe){var pt=[1,0,0],Tt=Ts(Qo(Xe),Qo(qe)),Ct=Lo(Tt,Tt),jt=Tt[0],nr=Ct-jt*jt;if(!nr)return!Qe&&Xe;var Vt=ne*Ct/nr,Xt=-ne*jt/nr,Ht=Ts(pt,Tt),pr=$o(pt,Vt);fs(pr,$o(Tt,Xt));var Wt=Ht,Kt=Lo(pr,Wt),Cr=Lo(Wt,Wt),tr=Kt*Kt-Cr*(Lo(pr,pr)-1);if(!(tr<0)){var mr=Math.sqrt(tr),wr=$o(Wt,(-Kt-mr)/Cr);if(fs(wr,pr),wr=ks(wr),!Qe)return wr;var Wr,Rr=Xe[0],tn=qe[0],jr=Xe[1],ln=qe[1];tn<Rr&&(Wr=Rr,Rr=tn,tn=Wr);var Mn=tn-Rr,An=v(Mn-ot)<Ge;if(!An&&ln<jr&&(Wr=jr,jr=ln,ln=Wr),An||Mn<Ge?An?jr+ln>0^wr[1]<(v(wr[0]-Rr)<Ge?jr:ln):jr<=wr[1]&&wr[1]<=ln:Mn>ot^(Rr<=wr[0]&&wr[0]<=tn)){var $r=$o(Wt,(-Kt+mr)/Cr);return fs($r,pr),[wr,ks($r)]}}}function Ve(Xe,qe){var Qe=se?Z:ot-Z,pt=0;return Xe<-Qe?pt|=1:Xe>Qe&&(pt|=2),qe<-Qe?pt|=4:qe>Qe&&(pt|=8),pt}}function uc(Z,ne,se,he){return function(ye){var Le,Ve=ye.a,Xe=ye.b,qe=Ve.x,Qe=Ve.y,pt=0,Tt=1,Ct=Xe.x-qe,jt=Xe.y-Qe;if(Le=Z-qe,Ct||!(Le>0)){if(Le/=Ct,Ct<0){if(Le<pt)return;Le<Tt&&(Tt=Le)}else if(Ct>0){if(Le>Tt)return;Le>pt&&(pt=Le)}if(Le=se-qe,Ct||!(Le<0)){if(Le/=Ct,Ct<0){if(Le>Tt)return;Le>pt&&(pt=Le)}else if(Ct>0){if(Le<pt)return;Le<Tt&&(Tt=Le)}if(Le=ne-Qe,jt||!(Le>0)){if(Le/=jt,jt<0){if(Le<pt)return;Le<Tt&&(Tt=Le)}else if(jt>0){if(Le>Tt)return;Le>pt&&(pt=Le)}if(Le=he-Qe,jt||!(Le<0)){if(Le/=jt,jt<0){if(Le>Tt)return;Le>pt&&(pt=Le)}else if(jt>0){if(Le<pt)return;Le<Tt&&(Tt=Le)}return pt>0&&(ye.a={x:qe+pt*Ct,y:Qe+pt*jt}),Tt<1&&(ye.b={x:qe+Tt*Ct,y:Qe+Tt*jt}),ye}}}}}}function As(Z,ne,se,he){return function(Xe){var qe,Qe,pt,Tt,Ct,jt,nr,Vt,Xt,Ht,pr,Wt=Xe,Kt=qs(),Cr=uc(Z,ne,se,he),tr={point:Wr,lineStart:function(){tr.point=Rr,Qe&&Qe.push(pt=[]),Ht=!0,Xt=!1,nr=Vt=NaN},lineEnd:function(){qe&&(Rr(Tt,Ct),jt&&Xt&&Kt.rejoin(),qe.push(Kt.buffer())),tr.point=Wr,Xt&&Xe.lineEnd()},polygonStart:function(){Xe=Kt,qe=[],Qe=[],pr=!0},polygonEnd:function(){Xe=Wt,qe=t.merge(qe);var tn=function(Mn){for(var An=0,$r=Qe.length,Tn=Mn[1],Xn=0;Xn<$r;++Xn)for(var Bn,aa=1,la=Qe[Xn],xa=la.length,ka=la[0];aa<xa;++aa)Bn=la[aa],ka[1]<=Tn?Bn[1]>Tn&&it(ka,Bn,Mn)>0&&++An:Bn[1]<=Tn&&it(ka,Bn,Mn)<0&&--An,ka=Bn;return An!==0}([Z,he]),jr=pr&&tn,ln=qe.length;(jr||ln)&&(Xe.polygonStart(),jr&&(Xe.lineStart(),mr(null,null,1,Xe),Xe.lineEnd()),ln&&hs(qe,Le,tn,mr,Xe),Xe.polygonEnd()),qe=Qe=pt=null}};function mr(tn,jr,ln,Mn){var An=0,$r=0;if(tn==null||(An=ye(tn,ln))!==($r=ye(jr,ln))||Ve(tn,jr)<0^ln>0)do Mn.point(An===0||An===3?Z:se,An>1?he:ne);while((An=(An+ln+4)%4)!==$r);else Mn.point(jr[0],jr[1])}function wr(tn,jr){return Z<=tn&&tn<=se&&ne<=jr&&jr<=he}function Wr(tn,jr){wr(tn,jr)&&Xe.point(tn,jr)}function Rr(tn,jr){var ln=wr(tn=Math.max(-1e9,Math.min(1e9,tn)),jr=Math.max(-1e9,Math.min(1e9,jr)));if(Qe&&pt.push([tn,jr]),Ht)Tt=tn,Ct=jr,jt=ln,Ht=!1,ln&&(Xe.lineStart(),Xe.point(tn,jr));else if(ln&&Xt)Xe.point(tn,jr);else{var Mn={a:{x:nr,y:Vt},b:{x:tn,y:jr}};Cr(Mn)?(Xt||(Xe.lineStart(),Xe.point(Mn.a.x,Mn.a.y)),Xe.point(Mn.b.x,Mn.b.y),ln||Xe.lineEnd(),pr=!1):ln&&(Xe.lineStart(),Xe.point(tn,jr),pr=!1)}nr=tn,Vt=jr,Xt=ln}return tr};function ye(Xe,qe){return v(Xe[0]-Z)<Ge?qe>0?0:3:v(Xe[0]-se)<Ge?qe>0?2:1:v(Xe[1]-ne)<Ge?qe>0?1:0:qe>0?3:2}function Le(Xe,qe){return Ve(Xe.x,qe.x)}function Ve(Xe,qe){var Qe=ye(Xe,1),pt=ye(qe,1);return Qe!==pt?Qe-pt:Qe===0?qe[1]-Xe[1]:Qe===1?Xe[0]-qe[0]:Qe===2?Xe[1]-qe[1]:qe[0]-Xe[0]}}function Hs(Z){var ne=0,se=ot/3,he=Po(Z),ye=he(ne,se);return ye.parallels=function(Le){return arguments.length?he(ne=Le[0]*ot/180,se=Le[1]*ot/180):[ne/ot*180,se/ot*180]},ye}function dl(Z,ne){var se=Math.sin(Z),he=(se+Math.sin(ne))/2,ye=1+se*(2*he-se),Le=Math.sqrt(ye)/he;function Ve(Xe,qe){var Qe=Math.sqrt(ye-2*he*Math.sin(qe))/he;return[Qe*Math.sin(Xe*=he),Le-Qe*Math.cos(Xe)]}return Ve.invert=function(Xe,qe){var Qe=Le-qe;return[Math.atan2(Xe,Qe)/he,ct((ye-(Xe*Xe+Qe*Qe)*he*he)/(2*he))]},Ve}t.geo.clipExtent=function(){var Z,ne,se,he,ye,Le,Ve={stream:function(Xe){return ye&&(ye.valid=!1),(ye=Le(Xe)).valid=!0,ye},extent:function(Xe){return arguments.length?(Le=As(Z=+Xe[0][0],ne=+Xe[0][1],se=+Xe[1][0],he=+Xe[1][1]),ye&&(ye.valid=!1,ye=null),Ve):[[Z,ne],[se,he]]}};return Ve.extent([[0,0],[960,500]])},(t.geo.conicEqualArea=function(){return Hs(dl)}).raw=dl,t.geo.albers=function(){return t.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)},t.geo.albersUsa=function(){var Z,ne,se,he,ye=t.geo.albers(),Le=t.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),Ve=t.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),Xe={point:function(Qe,pt){Z=[Qe,pt]}};function qe(Qe){var pt=Qe[0],Tt=Qe[1];return Z=null,ne(pt,Tt),Z||(se(pt,Tt),Z)||he(pt,Tt),Z}return qe.invert=function(Qe){var pt=ye.scale(),Tt=ye.translate(),Ct=(Qe[0]-Tt[0])/pt,jt=(Qe[1]-Tt[1])/pt;return(jt>=.12&&jt<.234&&Ct>=-.425&&Ct<-.214?Le:jt>=.166&&jt<.234&&Ct>=-.214&&Ct<-.115?Ve:ye).invert(Qe)},qe.stream=function(Qe){var pt=ye.stream(Qe),Tt=Le.stream(Qe),Ct=Ve.stream(Qe);return{point:function(jt,nr){pt.point(jt,nr),Tt.point(jt,nr),Ct.point(jt,nr)},sphere:function(){pt.sphere(),Tt.sphere(),Ct.sphere()},lineStart:function(){pt.lineStart(),Tt.lineStart(),Ct.lineStart()},lineEnd:function(){pt.lineEnd(),Tt.lineEnd(),Ct.lineEnd()},polygonStart:function(){pt.polygonStart(),Tt.polygonStart(),Ct.polygonStart()},polygonEnd:function(){pt.polygonEnd(),Tt.polygonEnd(),Ct.polygonEnd()}}},qe.precision=function(Qe){return arguments.length?(ye.precision(Qe),Le.precision(Qe),Ve.precision(Qe),qe):ye.precision()},qe.scale=function(Qe){return arguments.length?(ye.scale(Qe),Le.scale(.35*Qe),Ve.scale(Qe),qe.translate(ye.translate())):ye.scale()},qe.translate=function(Qe){if(!arguments.length)return ye.translate();var pt=ye.scale(),Tt=+Qe[0],Ct=+Qe[1];return ne=ye.translate(Qe).clipExtent([[Tt-.455*pt,Ct-.238*pt],[Tt+.455*pt,Ct+.238*pt]]).stream(Xe).point,se=Le.translate([Tt-.307*pt,Ct+.201*pt]).clipExtent([[Tt-.425*pt+Ge,Ct+.12*pt+Ge],[Tt-.214*pt-Ge,Ct+.234*pt-Ge]]).stream(Xe).point,he=Ve.translate([Tt-.205*pt,Ct+.212*pt]).clipExtent([[Tt-.214*pt+Ge,Ct+.166*pt+Ge],[Tt-.115*pt-Ge,Ct+.234*pt-Ge]]).stream(Xe).point,qe},qe.scale(1070)};var Bl,Ss,Gs,Es,Ys,ml,ns={point:J,lineStart:J,lineEnd:J,polygonStart:function(){Ss=0,ns.lineStart=Nl},polygonEnd:function(){ns.lineStart=ns.lineEnd=ns.point=J,Bl+=v(Ss/2)}};function Nl(){var Z,ne,se,he;function ye(Le,Ve){Ss+=he*Le-se*Ve,se=Le,he=Ve}ns.point=function(Le,Ve){ns.point=ye,Z=se=Le,ne=he=Ve},ns.lineEnd=function(){ye(Z,ne)}}var fc={point:function(Z,ne){Z<Gs&&(Gs=Z),Z>Ys&&(Ys=Z),ne<Es&&(Es=ne),ne>ml&&(ml=ne)},lineStart:J,lineEnd:J,polygonStart:J,polygonEnd:J};function Rc(){var Z=hc(4.5),ne=[],se={point:he,lineStart:function(){se.point=ye},lineEnd:Ve,polygonStart:function(){se.lineEnd=Xe},polygonEnd:function(){se.lineEnd=Ve,se.point=he},pointRadius:function(qe){return Z=hc(qe),se},result:function(){if(ne.length){var qe=ne.join("");return ne=[],qe}}};function he(qe,Qe){ne.push("M",qe,",",Qe,Z)}function ye(qe,Qe){ne.push("M",qe,",",Qe),se.point=Le}function Le(qe,Qe){ne.push("L",qe,",",Qe)}function Ve(){se.point=he}function Xe(){ne.push("Z")}return se}function hc(Z){return"m0,"+Z+"a"+Z+","+Z+" 0 1,1 0,"+-2*Z+"a"+Z+","+Z+" 0 1,1 0,"+2*Z+"z"}var vl,to={point:Bi,lineStart:pc,lineEnd:jl,polygonStart:function(){to.lineStart=Aa},polygonEnd:function(){to.point=Bi,to.lineStart=pc,to.lineEnd=jl}};function Bi(Z,ne){lo+=Z,_s+=ne,++Ko}function pc(){var Z,ne;function se(he,ye){var Le=he-Z,Ve=ye-ne,Xe=Math.sqrt(Le*Le+Ve*Ve);ma+=Xe*(Z+he)/2,us+=Xe*(ne+ye)/2,$i+=Xe,Bi(Z=he,ne=ye)}to.point=function(he,ye){to.point=se,Bi(Z=he,ne=ye)}}function jl(){to.point=Bi}function Aa(){var Z,ne,se,he;function ye(Le,Ve){var Xe=Le-se,qe=Ve-he,Qe=Math.sqrt(Xe*Xe+qe*qe);ma+=Qe*(se+Le)/2,us+=Qe*(he+Ve)/2,$i+=Qe,ws+=(Qe=he*Le-se*Ve)*(se+Le),eo+=Qe*(he+Ve),Ri+=3*Qe,Bi(se=Le,he=Ve)}to.point=function(Le,Ve){to.point=ye,Bi(Z=se=Le,ne=he=Ve)},to.lineEnd=function(){ye(Z,ne)}}function Ul(Z){var ne=4.5,se={point:he,lineStart:function(){se.point=ye},lineEnd:Ve,polygonStart:function(){se.lineEnd=Xe},polygonEnd:function(){se.lineEnd=Ve,se.point=he},pointRadius:function(qe){return ne=qe,se},result:J};function he(qe,Qe){Z.moveTo(qe+ne,Qe),Z.arc(qe,Qe,ne,0,Ce)}function ye(qe,Qe){Z.moveTo(qe,Qe),se.point=Le}function Le(qe,Qe){Z.lineTo(qe,Qe)}function Ve(){se.point=he}function Xe(){Z.closePath()}return se}function Mi(Z){var ne=.5,se=Math.cos(30*xe),he=16;function ye(qe){return(he?Ve:Le)(qe)}function Le(qe){return ya(qe,function(Qe,pt){Qe=Z(Qe,pt),qe.point(Qe[0],Qe[1])})}function Ve(qe){var Qe,pt,Tt,Ct,jt,nr,Vt,Xt,Ht,pr,Wt,Kt,Cr={point:tr,lineStart:mr,lineEnd:Wr,polygonStart:function(){qe.polygonStart(),Cr.lineStart=Rr},polygonEnd:function(){qe.polygonEnd(),Cr.lineStart=mr}};function tr(ln,Mn){ln=Z(ln,Mn),qe.point(ln[0],ln[1])}function mr(){Xt=NaN,Cr.point=wr,qe.lineStart()}function wr(ln,Mn){var An=Qo([ln,Mn]),$r=Z(ln,Mn);Xe(Xt,Ht,Vt,pr,Wt,Kt,Xt=$r[0],Ht=$r[1],Vt=ln,pr=An[0],Wt=An[1],Kt=An[2],he,qe),qe.point(Xt,Ht)}function Wr(){Cr.point=tr,qe.lineEnd()}function Rr(){mr(),Cr.point=tn,Cr.lineEnd=jr}function tn(ln,Mn){wr(Qe=ln,Mn),pt=Xt,Tt=Ht,Ct=pr,jt=Wt,nr=Kt,Cr.point=wr}function jr(){Xe(Xt,Ht,Vt,pr,Wt,Kt,pt,Tt,Qe,Ct,jt,nr,he,qe),Cr.lineEnd=Wr,Wr()}return Cr}function Xe(qe,Qe,pt,Tt,Ct,jt,nr,Vt,Xt,Ht,pr,Wt,Kt,Cr){var tr=nr-qe,mr=Vt-Qe,wr=tr*tr+mr*mr;if(wr>4*ne&&Kt--){var Wr=Tt+Ht,Rr=Ct+pr,tn=jt+Wt,jr=Math.sqrt(Wr*Wr+Rr*Rr+tn*tn),ln=Math.asin(tn/=jr),Mn=v(v(tn)-1)<Ge||v(pt-Xt)<Ge?(pt+Xt)/2:Math.atan2(Rr,Wr),An=Z(Mn,ln),$r=An[0],Tn=An[1],Xn=$r-qe,Bn=Tn-Qe,aa=mr*Xn-tr*Bn;(aa*aa/wr>ne||v((tr*Xn+mr*Bn)/wr-.5)>.3||Tt*Ht+Ct*pr+jt*Wt<se)&&(Xe(qe,Qe,pt,Tt,Ct,jt,$r,Tn,Mn,Wr/=jr,Rr/=jr,tn,Kt,Cr),Cr.point($r,Tn),Xe($r,Tn,Mn,Wr,Rr,tn,nr,Vt,Xt,Ht,pr,Wt,Kt,Cr))}}return ye.precision=function(qe){return arguments.length?(he=(ne=qe*qe)>0&&16,ye):Math.sqrt(ne)},ye}function Cs(Z){var ne=Mi(function(se,he){return Z([se*Ee,he*Ee])});return function(se){return Fc(ne(se))}}function fa(Z){this.stream=Z}function ya(Z,ne){return{point:ne,sphere:function(){Z.sphere()},lineStart:function(){Z.lineStart()},lineEnd:function(){Z.lineEnd()},polygonStart:function(){Z.polygonStart()},polygonEnd:function(){Z.polygonEnd()}}}function ui(Z){return Po(function(){return Z})()}function Po(Z){var ne,se,he,ye,Le,Ve,Xe=Mi(function(wr,Wr){return[(wr=ne(wr,Wr))[0]*qe+ye,Le-wr[1]*qe]}),qe=150,Qe=480,pt=250,Tt=0,Ct=0,jt=0,nr=0,Vt=0,Xt=Fl,Ht=I,pr=null,Wt=null;function Kt(wr){return[(wr=he(wr[0]*xe,wr[1]*xe))[0]*qe+ye,Le-wr[1]*qe]}function Cr(wr){return(wr=he.invert((wr[0]-ye)/qe,(Le-wr[1])/qe))&&[wr[0]*Ee,wr[1]*Ee]}function tr(){he=Oc(se=Vl(jt,nr,Vt),ne);var wr=ne(Tt,Ct);return ye=Qe-wr[0]*qe,Le=pt+wr[1]*qe,mr()}function mr(){return Ve&&(Ve.valid=!1,Ve=null),Kt}return Kt.stream=function(wr){return Ve&&(Ve.valid=!1),(Ve=Fc(Xt(se,Xe(Ht(wr))))).valid=!0,Ve},Kt.clipAngle=function(wr){return arguments.length?(Xt=wr==null?(pr=wr,Fl):Dc((pr=+wr)*xe),mr()):pr},Kt.clipExtent=function(wr){return arguments.length?(Wt=wr,Ht=wr?As(wr[0][0],wr[0][1],wr[1][0],wr[1][1]):I,mr()):Wt},Kt.scale=function(wr){return arguments.length?(qe=+wr,tr()):qe},Kt.translate=function(wr){return arguments.length?(Qe=+wr[0],pt=+wr[1],tr()):[Qe,pt]},Kt.center=function(wr){return arguments.length?(Tt=wr[0]%360*xe,Ct=wr[1]%360*xe,tr()):[Tt*Ee,Ct*Ee]},Kt.rotate=function(wr){return arguments.length?(jt=wr[0]%360*xe,nr=wr[1]%360*xe,Vt=wr.length>2?wr[2]%360*xe:0,tr()):[jt*Ee,nr*Ee,Vt*Ee]},t.rebind(Kt,Xe,"precision"),function(){return ne=Z.apply(this,arguments),Kt.invert=ne.invert&&Cr,tr()}}function Fc(Z){return ya(Z,function(ne,se){Z.point(ne*xe,se*xe)})}function yl(Z,ne){return[Z,ne]}function Bc(Z,ne){return[Z>ot?Z-Ce:Z<-ot?Z+Ce:Z,ne]}function Vl(Z,ne,se){return Z?ne||se?Oc(Wi(Z),Ws(ne,se)):Wi(Z):ne||se?Ws(ne,se):Bc}function ko(Z){return function(ne,se){return[(ne+=Z)>ot?ne-Ce:ne<-ot?ne+Ce:ne,se]}}function Wi(Z){var ne=ko(Z);return ne.invert=ko(-Z),ne}function Ws(Z,ne){var se=Math.cos(Z),he=Math.sin(Z),ye=Math.cos(ne),Le=Math.sin(ne);function Ve(Xe,qe){var Qe=Math.cos(qe),pt=Math.cos(Xe)*Qe,Tt=Math.sin(Xe)*Qe,Ct=Math.sin(qe),jt=Ct*se+pt*he;return[Math.atan2(Tt*ye-jt*Le,pt*se-Ct*he),ct(jt*ye+Tt*Le)]}return Ve.invert=function(Xe,qe){var Qe=Math.cos(qe),pt=Math.cos(Xe)*Qe,Tt=Math.sin(Xe)*Qe,Ct=Math.sin(qe),jt=Ct*ye-Tt*Le;return[Math.atan2(Tt*ye+Ct*Le,pt*se+jt*he),ct(jt*se-pt*he)]},Ve}function Ni(Z,ne){var se=Math.cos(Z),he=Math.sin(Z);return function(ye,Le,Ve,Xe){var qe=Ve*ne;ye!=null?(ye=as(se,ye),Le=as(se,Le),(Ve>0?ye<Le:ye>Le)&&(ye+=Ve*Ce)):(ye=Z+Ve*Ce,Le=Z-.5*qe);for(var Qe,pt=ye;Ve>0?pt>Le:pt<Le;pt-=qe)Xe.point((Qe=ks([se,-he*Math.cos(pt),-he*Math.sin(pt)]))[0],Qe[1])}}function as(Z,ne){var se=Qo(ne);se[0]-=Z,Us(se);var he=ht(-se[1]);return((-se[2]<0?-he:he)+2*Math.PI-Ge)%(2*Math.PI)}function En(Z,ne,se){var he=t.range(Z,ne-Ge,se).concat(ne);return function(ye){return he.map(function(Le){return[ye,Le]})}}function Wa(Z,ne,se){var he=t.range(Z,ne-Ge,se).concat(ne);return function(ye){return he.map(function(Le){return[Le,ye]})}}function ro(Z){return Z.source}function Zi(Z){return Z.target}t.geo.path=function(){var Z,ne,se,he,ye,Le=4.5;function Ve(qe){return qe&&(typeof Le=="function"&&he.pointRadius(+Le.apply(this,arguments)),ye&&ye.valid||(ye=se(he)),t.geo.stream(qe,ye)),he.result()}function Xe(){return ye=null,Ve}return Ve.area=function(qe){return Bl=0,t.geo.stream(qe,se(ns)),Bl},Ve.centroid=function(qe){return lo=_s=Ko=ma=us=$i=ws=eo=Ri=0,t.geo.stream(qe,se(to)),Ri?[ws/Ri,eo/Ri]:$i?[ma/$i,us/$i]:Ko?[lo/Ko,_s/Ko]:[NaN,NaN]},Ve.bounds=function(qe){return Ys=ml=-(Gs=Es=1/0),t.geo.stream(qe,se(fc)),[[Gs,Es],[Ys,ml]]},Ve.projection=function(qe){return arguments.length?(se=(Z=qe)?qe.stream||Cs(qe):I,Xe()):Z},Ve.context=function(qe){return arguments.length?(he=(ne=qe)==null?new Rc:new Ul(qe),typeof Le!="function"&&he.pointRadius(Le),Xe()):ne},Ve.pointRadius=function(qe){return arguments.length?(Le=typeof qe=="function"?qe:(he.pointRadius(+qe),+qe),Ve):Le},Ve.projection(t.geo.albersUsa()).context(null)},t.geo.transform=function(Z){return{stream:function(ne){var se=new fa(ne);for(var he in Z)se[he]=Z[he];return se}}},fa.prototype={point:function(Z,ne){this.stream.point(Z,ne)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},t.geo.projection=ui,t.geo.projectionMutator=Po,(t.geo.equirectangular=function(){return ui(yl)}).raw=yl.invert=yl,t.geo.rotation=function(Z){function ne(se){return(se=Z(se[0]*xe,se[1]*xe))[0]*=Ee,se[1]*=Ee,se}return Z=Vl(Z[0]%360*xe,Z[1]*xe,Z.length>2?Z[2]*xe:0),ne.invert=function(se){return(se=Z.invert(se[0]*xe,se[1]*xe))[0]*=Ee,se[1]*=Ee,se},ne},Bc.invert=yl,t.geo.circle=function(){var Z,ne,se=[0,0],he=6;function ye(){var Le=typeof se=="function"?se.apply(this,arguments):se,Ve=Vl(-Le[0]*xe,-Le[1]*xe,0).invert,Xe=[];return ne(null,null,1,{point:function(qe,Qe){Xe.push(qe=Ve(qe,Qe)),qe[0]*=Ee,qe[1]*=Ee}}),{type:"Polygon",coordinates:[Xe]}}return ye.origin=function(Le){return arguments.length?(se=Le,ye):se},ye.angle=function(Le){return arguments.length?(ne=Ni((Z=+Le)*xe,he*xe),ye):Z},ye.precision=function(Le){return arguments.length?(ne=Ni(Z*xe,(he=+Le)*xe),ye):he},ye.angle(90)},t.geo.distance=function(Z,ne){var se,he=(ne[0]-Z[0])*xe,ye=Z[1]*xe,Le=ne[1]*xe,Ve=Math.sin(he),Xe=Math.cos(he),qe=Math.sin(ye),Qe=Math.cos(ye),pt=Math.sin(Le),Tt=Math.cos(Le);return Math.atan2(Math.sqrt((se=Tt*Ve)*se+(se=Qe*pt-qe*Tt*Xe)*se),qe*pt+Qe*Tt*Xe)},t.geo.graticule=function(){var Z,ne,se,he,ye,Le,Ve,Xe,qe,Qe,pt,Tt,Ct=10,jt=Ct,nr=90,Vt=360,Xt=2.5;function Ht(){return{type:"MultiLineString",coordinates:pr()}}function pr(){return t.range(Math.ceil(he/nr)*nr,se,nr).map(pt).concat(t.range(Math.ceil(Xe/Vt)*Vt,Ve,Vt).map(Tt)).concat(t.range(Math.ceil(ne/Ct)*Ct,Z,Ct).filter(function(Wt){return v(Wt%nr)>Ge}).map(qe)).concat(t.range(Math.ceil(Le/jt)*jt,ye,jt).filter(function(Wt){return v(Wt%Vt)>Ge}).map(Qe))}return Ht.lines=function(){return pr().map(function(Wt){return{type:"LineString",coordinates:Wt}})},Ht.outline=function(){return{type:"Polygon",coordinates:[pt(he).concat(Tt(Ve).slice(1),pt(se).reverse().slice(1),Tt(Xe).reverse().slice(1))]}},Ht.extent=function(Wt){return arguments.length?Ht.majorExtent(Wt).minorExtent(Wt):Ht.minorExtent()},Ht.majorExtent=function(Wt){return arguments.length?(he=+Wt[0][0],se=+Wt[1][0],Xe=+Wt[0][1],Ve=+Wt[1][1],he>se&&(Wt=he,he=se,se=Wt),Xe>Ve&&(Wt=Xe,Xe=Ve,Ve=Wt),Ht.precision(Xt)):[[he,Xe],[se,Ve]]},Ht.minorExtent=function(Wt){return arguments.length?(ne=+Wt[0][0],Z=+Wt[1][0],Le=+Wt[0][1],ye=+Wt[1][1],ne>Z&&(Wt=ne,ne=Z,Z=Wt),Le>ye&&(Wt=Le,Le=ye,ye=Wt),Ht.precision(Xt)):[[ne,Le],[Z,ye]]},Ht.step=function(Wt){return arguments.length?Ht.majorStep(Wt).minorStep(Wt):Ht.minorStep()},Ht.majorStep=function(Wt){return arguments.length?(nr=+Wt[0],Vt=+Wt[1],Ht):[nr,Vt]},Ht.minorStep=function(Wt){return arguments.length?(Ct=+Wt[0],jt=+Wt[1],Ht):[Ct,jt]},Ht.precision=function(Wt){return arguments.length?(Xt=+Wt,qe=En(Le,ye,90),Qe=Wa(ne,Z,Xt),pt=En(Xe,Ve,90),Tt=Wa(he,se,Xt),Ht):Xt},Ht.majorExtent([[-180,-90+Ge],[180,90-Ge]]).minorExtent([[-180,-80-Ge],[180,80+Ge]])},t.geo.greatArc=function(){var Z,ne,se=ro,he=Zi;function ye(){return{type:"LineString",coordinates:[Z||se.apply(this,arguments),ne||he.apply(this,arguments)]}}return ye.distance=function(){return t.geo.distance(Z||se.apply(this,arguments),ne||he.apply(this,arguments))},ye.source=function(Le){return arguments.length?(se=Le,Z=typeof Le=="function"?null:Le,ye):se},ye.target=function(Le){return arguments.length?(he=Le,ne=typeof Le=="function"?null:Le,ye):he},ye.precision=function(){return arguments.length?ye:0},ye},t.geo.interpolate=function(Z,ne){return se=Z[0]*xe,he=Z[1]*xe,ye=ne[0]*xe,Le=ne[1]*xe,Ve=Math.cos(he),Xe=Math.sin(he),qe=Math.cos(Le),Qe=Math.sin(Le),pt=Ve*Math.cos(se),Tt=Ve*Math.sin(se),Ct=qe*Math.cos(ye),jt=qe*Math.sin(ye),nr=2*Math.asin(Math.sqrt(bt(Le-he)+Ve*qe*bt(ye-se))),Vt=1/Math.sin(nr),(Xt=nr?function(Ht){var pr=Math.sin(Ht*=nr)*Vt,Wt=Math.sin(nr-Ht)*Vt,Kt=Wt*pt+pr*Ct,Cr=Wt*Tt+pr*jt,tr=Wt*Xe+pr*Qe;return[Math.atan2(Cr,Kt)*Ee,Math.atan2(tr,Math.sqrt(Kt*Kt+Cr*Cr))*Ee]}:function(){return[se*Ee,he*Ee]}).distance=nr,Xt;var se,he,ye,Le,Ve,Xe,qe,Qe,pt,Tt,Ct,jt,nr,Vt,Xt},t.geo.length=function(Z){return vl=0,t.geo.stream(Z,uo),vl};var uo={sphere:J,point:J,lineStart:function(){var Z,ne,se;function he(ye,Le){var Ve=Math.sin(Le*=xe),Xe=Math.cos(Le),qe=v((ye*=xe)-Z),Qe=Math.cos(qe);vl+=Math.atan2(Math.sqrt((qe=Xe*Math.sin(qe))*qe+(qe=se*Ve-ne*Xe*Qe)*qe),ne*Ve+se*Xe*Qe),Z=ye,ne=Ve,se=Xe}uo.point=function(ye,Le){Z=ye*xe,ne=Math.sin(Le*=xe),se=Math.cos(Le),uo.point=he},uo.lineEnd=function(){uo.point=uo.lineEnd=J}},lineEnd:J,polygonStart:J,polygonEnd:J};function no(Z,ne){function se(he,ye){var Le=Math.cos(he),Ve=Math.cos(ye),Xe=Z(Le*Ve);return[Xe*Ve*Math.sin(he),Xe*Math.sin(ye)]}return se.invert=function(he,ye){var Le=Math.sqrt(he*he+ye*ye),Ve=ne(Le),Xe=Math.sin(Ve),qe=Math.cos(Ve);return[Math.atan2(he*Xe,Le*qe),Math.asin(Le&&ye*Xe/Le)]},se}var Io=no(function(Z){return Math.sqrt(2/(1+Z))},function(Z){return 2*Math.asin(Z/2)});(t.geo.azimuthalEqualArea=function(){return ui(Io)}).raw=Io;var vn=no(function(Z){var ne=Math.acos(Z);return ne&&ne/Math.sin(ne)},I);function Pi(Z,ne){var se=Math.cos(Z),he=function(Xe){return Math.tan(ot/4+Xe/2)},ye=Z===ne?Math.sin(Z):Math.log(se/Math.cos(ne))/Math.log(he(ne)/he(Z)),Le=se*Math.pow(he(Z),ye)/ye;if(!ye)return Zs;function Ve(Xe,qe){Le>0?qe<-Ye+Ge&&(qe=-Ye+Ge):qe>Ye-Ge&&(qe=Ye-Ge);var Qe=Le/Math.pow(he(qe),ye);return[Qe*Math.sin(ye*Xe),Le-Qe*Math.cos(ye*Xe)]}return Ve.invert=function(Xe,qe){var Qe=Le-qe,pt=Je(ye)*Math.sqrt(Xe*Xe+Qe*Qe);return[Math.atan2(Xe,Qe)/ye,2*Math.atan(Math.pow(Le/pt,1/ye))-Ye]},Ve}function ql(Z,ne){var se=Math.cos(Z),he=Z===ne?Math.sin(Z):(se-Math.cos(ne))/(ne-Z),ye=se/he+Z;if(v(he)<Ge)return yl;function Le(Ve,Xe){var qe=ye-Xe;return[qe*Math.sin(he*Ve),ye-qe*Math.cos(he*Ve)]}return Le.invert=function(Ve,Xe){var qe=ye-Xe;return[Math.atan2(Ve,qe)/he,ye-Je(he)*Math.sqrt(Ve*Ve+qe*qe)]},Le}(t.geo.azimuthalEquidistant=function(){return ui(vn)}).raw=vn,(t.geo.conicConformal=function(){return Hs(Pi)}).raw=Pi,(t.geo.conicEquidistant=function(){return Hs(ql)}).raw=ql;var Hl=no(function(Z){return 1/Z},Math.atan);function Zs(Z,ne){return[Z,Math.log(Math.tan(ot/4+ne/2))]}function fo(Z){var ne,se=ui(Z),he=se.scale,ye=se.translate,Le=se.clipExtent;return se.scale=function(){var Ve=he.apply(se,arguments);return Ve===se?ne?se.clipExtent(null):se:Ve},se.translate=function(){var Ve=ye.apply(se,arguments);return Ve===se?ne?se.clipExtent(null):se:Ve},se.clipExtent=function(Ve){var Xe=Le.apply(se,arguments);if(Xe===se){if(ne=Ve==null){var qe=ot*he(),Qe=ye();Le([[Qe[0]-qe,Qe[1]-qe],[Qe[0]+qe,Qe[1]+qe]])}}else ne&&(Xe=null);return Xe},se.clipExtent(null)}(t.geo.gnomonic=function(){return ui(Hl)}).raw=Hl,Zs.invert=function(Z,ne){return[Z,2*Math.atan(Math.exp(ne))-Ye]},(t.geo.mercator=function(){return fo(Zs)}).raw=Zs;var ji=no(function(){return 1},Math.asin);(t.geo.orthographic=function(){return ui(ji)}).raw=ji;var Ls=no(function(Z){return 1/(1+Z)},function(Z){return 2*Math.atan(Z)});function Ai(Z,ne){return[Math.log(Math.tan(ot/4+ne/2)),-Z]}function ao(Z){return Z[0]}function Ps(Z){return Z[1]}function Gl(Z){for(var ne=Z.length,se=[0,1],he=2,ye=2;ye<ne;ye++){for(;he>1&&it(Z[se[he-2]],Z[se[he-1]],Z[ye])<=0;)--he;se[he++]=ye}return se.slice(0,he)}function xl(Z,ne){return Z[0]-ne[0]||Z[1]-ne[1]}(t.geo.stereographic=function(){return ui(Ls)}).raw=Ls,Ai.invert=function(Z,ne){return[-ne,2*Math.atan(Math.exp(Z))-Ye]},(t.geo.transverseMercator=function(){var Z=fo(Ai),ne=Z.center,se=Z.rotate;return Z.center=function(he){return he?ne([-he[1],he[0]]):[(he=ne())[1],-he[0]]},Z.rotate=function(he){return he?se([he[0],he[1],he.length>2?he[2]+90:90]):[(he=se())[0],he[1],he[2]-90]},se([0,0,90])}).raw=Ai,t.geom={},t.geom.hull=function(Z){var ne=ao,se=Ps;if(arguments.length)return he(Z);function he(ye){if(ye.length<3)return[];var Le,Ve=Qr(ne),Xe=Qr(se),qe=ye.length,Qe=[],pt=[];for(Le=0;Le<qe;Le++)Qe.push([+Ve.call(this,ye[Le],Le),+Xe.call(this,ye[Le],Le),Le]);for(Qe.sort(xl),Le=0;Le<qe;Le++)pt.push([Qe[Le][0],-Qe[Le][1]]);var Tt=Gl(Qe),Ct=Gl(pt),jt=Ct[0]===Tt[0],nr=Ct[Ct.length-1]===Tt[Tt.length-1],Vt=[];for(Le=Tt.length-1;Le>=0;--Le)Vt.push(ye[Qe[Tt[Le]][2]]);for(Le=+jt;Le<Ct.length-nr;++Le)Vt.push(ye[Qe[Ct[Le]][2]]);return Vt}return he.x=function(ye){return arguments.length?(ne=ye,he):ne},he.y=function(ye){return arguments.length?(se=ye,he):se},he},t.geom.polygon=function(Z){return G(Z,Xs),Z};var Xs=t.geom.polygon.prototype=[];function Yl(Z,ne,se){return(se[0]-ne[0])*(Z[1]-ne[1])<(se[1]-ne[1])*(Z[0]-ne[0])}function Za(Z,ne,se,he){var ye=Z[0],Le=se[0],Ve=ne[0]-ye,Xe=he[0]-Le,qe=Z[1],Qe=se[1],pt=ne[1]-qe,Tt=he[1]-Qe,Ct=(Xe*(qe-Qe)-Tt*(ye-Le))/(Tt*Ve-Xe*pt);return[ye+Ct*Ve,qe+Ct*pt]}function Ta(Z){var ne=Z[0],se=Z[Z.length-1];return!(ne[0]-se[0]||ne[1]-se[1])}Xs.area=function(){for(var Z,ne=-1,se=this.length,he=this[se-1],ye=0;++ne<se;)Z=he,he=this[ne],ye+=Z[1]*he[0]-Z[0]*he[1];return .5*ye},Xs.centroid=function(Z){var ne,se,he=-1,ye=this.length,Le=0,Ve=0,Xe=this[ye-1];for(arguments.length||(Z=-1/(6*this.area()));++he<ye;)ne=Xe,Xe=this[he],se=ne[0]*Xe[1]-Xe[0]*ne[1],Le+=(ne[0]+Xe[0])*se,Ve+=(ne[1]+Xe[1])*se;return[Le*Z,Ve*Z]},Xs.clip=function(Z){for(var ne,se,he,ye,Le,Ve,Xe=Ta(Z),qe=-1,Qe=this.length-Ta(this),pt=this[Qe-1];++qe<Qe;){for(ne=Z.slice(),Z.length=0,ye=this[qe],Le=ne[(he=ne.length-Xe)-1],se=-1;++se<he;)Yl(Ve=ne[se],pt,ye)?(Yl(Le,pt,ye)||Z.push(Za(Le,Ve,pt,ye)),Z.push(Ve)):Yl(Le,pt,ye)&&Z.push(Za(Le,Ve,pt,ye)),Le=Ve;Xe&&Z.push(Z[0]),pt=ye}return Z};var za,Ui,ri,Xi,ho,Oo=[],ni=[];function ps(){ds(this),this.edge=this.site=this.circle=null}function Rn(Z){var ne=Oo.pop()||new ps;return ne.site=Z,ne}function jn(Z){Ma(Z),ri.remove(Z),Oo.push(Z),ds(Z)}function Va(Z){var ne=Z.circle,se=ne.x,he=ne.cy,ye={x:se,y:he},Le=Z.P,Ve=Z.N,Xe=[Z];jn(Z);for(var qe=Le;qe.circle&&v(se-qe.circle.x)<Ge&&v(he-qe.circle.cy)<Ge;)Le=qe.P,Xe.unshift(qe),jn(qe),qe=Le;Xe.unshift(qe),Ma(qe);for(var Qe=Ve;Qe.circle&&v(se-Qe.circle.x)<Ge&&v(he-Qe.circle.cy)<Ge;)Ve=Qe.N,Xe.push(Qe),jn(Qe),Qe=Ve;Xe.push(Qe),Ma(Qe);var pt,Tt=Xe.length;for(pt=1;pt<Tt;++pt)Qe=Xe[pt],qe=Xe[pt-1],po(Qe.edge,qe.site,Qe.site,ye);qe=Xe[0],(Qe=Xe[Tt-1]).edge=is(qe.site,Qe.site,null,ye),da(qe),da(Qe)}function Js(Z){for(var ne,se,he,ye,Le=Z.x,Ve=Z.y,Xe=ri._;Xe;)if((he=Ji(Xe,Ve)-Le)>Ge)Xe=Xe.L;else{if(!((ye=Le-ai(Xe,Ve))>Ge)){he>-Ge?(ne=Xe.P,se=Xe):ye>-Ge?(ne=Xe,se=Xe.N):ne=se=Xe;break}if(!Xe.R){ne=Xe;break}Xe=Xe.R}var qe=Rn(Z);if(ri.insert(ne,qe),ne||se){if(ne===se)return Ma(ne),se=Rn(ne.site),ri.insert(qe,se),qe.edge=se.edge=is(ne.site,qe.site),da(ne),void da(se);if(se){Ma(ne),Ma(se);var Qe=ne.site,pt=Qe.x,Tt=Qe.y,Ct=Z.x-pt,jt=Z.y-Tt,nr=se.site,Vt=nr.x-pt,Xt=nr.y-Tt,Ht=2*(Ct*Xt-jt*Vt),pr=Ct*Ct+jt*jt,Wt=Vt*Vt+Xt*Xt,Kt={x:(Xt*pr-jt*Wt)/Ht+pt,y:(Ct*Wt-Vt*pr)/Ht+Tt};po(se.edge,Qe,nr,Kt),qe.edge=is(Qe,Z,null,Kt),se.edge=is(Z,nr,null,Kt),da(ne),da(se)}else qe.edge=is(ne.site,qe.site)}}function Ji(Z,ne){var se=Z.site,he=se.x,ye=se.y,Le=ye-ne;if(!Le)return he;var Ve=Z.P;if(!Ve)return-1/0;var Xe=(se=Ve.site).x,qe=se.y,Qe=qe-ne;if(!Qe)return Xe;var pt=Xe-he,Tt=1/Le-1/Qe,Ct=pt/Qe;return Tt?(-Ct+Math.sqrt(Ct*Ct-2*Tt*(pt*pt/(-2*Qe)-qe+Qe/2+ye-Le/2)))/Tt+he:(he+Xe)/2}function ai(Z,ne){var se=Z.N;if(se)return Ji(se,ne);var he=Z.site;return he.y===ne?he.x:1/0}function Vi(Z){this.site=Z,this.edges=[]}function Nc(Z,ne){return ne.angle-Z.angle}function Ks(){ds(this),this.x=this.y=this.arc=this.site=this.cy=null}function da(Z){var ne=Z.P,se=Z.N;if(ne&&se){var he=ne.site,ye=Z.site,Le=se.site;if(he!==Le){var Ve=ye.x,Xe=ye.y,qe=he.x-Ve,Qe=he.y-Xe,pt=Le.x-Ve,Tt=2*(qe*(Xt=Le.y-Xe)-Qe*pt);if(!(Tt>=-st)){var Ct=qe*qe+Qe*Qe,jt=pt*pt+Xt*Xt,nr=(Xt*Ct-Qe*jt)/Tt,Vt=(qe*jt-pt*Ct)/Tt,Xt=Vt+Xe,Ht=ni.pop()||new Ks;Ht.arc=Z,Ht.site=ye,Ht.x=nr+Ve,Ht.y=Xt+Math.sqrt(nr*nr+Vt*Vt),Ht.cy=Xt,Z.circle=Ht;for(var pr=null,Wt=ho._;Wt;)if(Ht.y<Wt.y||Ht.y===Wt.y&&Ht.x<=Wt.x){if(!Wt.L){pr=Wt.P;break}Wt=Wt.L}else{if(!Wt.R){pr=Wt;break}Wt=Wt.R}ho.insert(pr,Ht),pr||(Xi=Ht)}}}}function Ma(Z){var ne=Z.circle;ne&&(ne.P||(Xi=ne.N),ho.remove(ne),ni.push(ne),ds(ne),Z.circle=null)}function jc(Z,ne){var se=Z.b;if(se)return!0;var he,ye,Le=Z.a,Ve=ne[0][0],Xe=ne[1][0],qe=ne[0][1],Qe=ne[1][1],pt=Z.l,Tt=Z.r,Ct=pt.x,jt=pt.y,nr=Tt.x,Vt=Tt.y,Xt=(Ct+nr)/2,Ht=(jt+Vt)/2;if(Vt===jt){if(Xt<Ve||Xt>=Xe)return;if(Ct>nr){if(Le){if(Le.y>=Qe)return}else Le={x:Xt,y:qe};se={x:Xt,y:Qe}}else{if(Le){if(Le.y<qe)return}else Le={x:Xt,y:Qe};se={x:Xt,y:qe}}}else if(ye=Ht-(he=(Ct-nr)/(Vt-jt))*Xt,he<-1||he>1)if(Ct>nr){if(Le){if(Le.y>=Qe)return}else Le={x:(qe-ye)/he,y:qe};se={x:(Qe-ye)/he,y:Qe}}else{if(Le){if(Le.y<qe)return}else Le={x:(Qe-ye)/he,y:Qe};se={x:(qe-ye)/he,y:qe}}else if(jt<Vt){if(Le){if(Le.x>=Xe)return}else Le={x:Ve,y:he*Ve+ye};se={x:Xe,y:he*Xe+ye}}else{if(Le){if(Le.x<Ve)return}else Le={x:Xe,y:he*Xe+ye};se={x:Ve,y:he*Ve+ye}}return Z.a=Le,Z.b=se,!0}function Qs(Z,ne){this.l=Z,this.r=ne,this.a=this.b=null}function is(Z,ne,se,he){var ye=new Qs(Z,ne);return za.push(ye),se&&po(ye,Z,ne,se),he&&po(ye,ne,Z,he),Ui[Z.i].edges.push(new qa(ye,Z,ne)),Ui[ne.i].edges.push(new qa(ye,ne,Z)),ye}function dc(Z,ne,se){var he=new Qs(Z,null);return he.a=ne,he.b=se,za.push(he),he}function po(Z,ne,se,he){Z.a||Z.b?Z.l===se?Z.b=he:Z.a=he:(Z.a=he,Z.l=ne,Z.r=se)}function qa(Z,ne,se){var he=Z.a,ye=Z.b;this.edge=Z,this.site=ne,this.angle=se?Math.atan2(se.y-ne.y,se.x-ne.x):Z.l===ne?Math.atan2(ye.x-he.x,he.y-ye.y):Math.atan2(he.x-ye.x,ye.y-he.y)}function $s(){this._=null}function ds(Z){Z.U=Z.C=Z.L=Z.R=Z.P=Z.N=null}function gs(Z,ne){var se=ne,he=ne.R,ye=se.U;ye?ye.L===se?ye.L=he:ye.R=he:Z._=he,he.U=ye,se.U=he,se.R=he.L,se.R&&(se.R.U=se),he.L=se}function zo(Z,ne){var se=ne,he=ne.L,ye=se.U;ye?ye.L===se?ye.L=he:ye.R=he:Z._=he,he.U=ye,se.U=he,se.L=he.R,se.L&&(se.L.U=se),he.R=se}function Is(Z){for(;Z.L;)Z=Z.L;return Z}function bl(Z,ne){var se,he,ye,Le=Z.sort(_l).pop();for(za=[],Ui=new Array(Z.length),ri=new $s,ho=new $s;;)if(ye=Xi,Le&&(!ye||Le.y<ye.y||Le.y===ye.y&&Le.x<ye.x))Le.x===se&&Le.y===he||(Ui[Le.i]=new Vi(Le),Js(Le),se=Le.x,he=Le.y),Le=Z.pop();else{if(!ye)break;Va(ye.arc)}ne&&(function(Xe){for(var qe,Qe=za,pt=uc(Xe[0][0],Xe[0][1],Xe[1][0],Xe[1][1]),Tt=Qe.length;Tt--;)(!jc(qe=Qe[Tt],Xe)||!pt(qe)||v(qe.a.x-qe.b.x)<Ge&&v(qe.a.y-qe.b.y)<Ge)&&(qe.a=qe.b=null,Qe.splice(Tt,1))}(ne),function(Xe){for(var qe,Qe,pt,Tt,Ct,jt,nr,Vt,Xt,Ht,pr=Xe[0][0],Wt=Xe[1][0],Kt=Xe[0][1],Cr=Xe[1][1],tr=Ui,mr=tr.length;mr--;)if((Ct=tr[mr])&&Ct.prepare())for(Vt=(nr=Ct.edges).length,jt=0;jt<Vt;)pt=(Ht=nr[jt].end()).x,Tt=Ht.y,qe=(Xt=nr[++jt%Vt].start()).x,Qe=Xt.y,(v(pt-qe)>Ge||v(Tt-Qe)>Ge)&&(nr.splice(jt,0,new qa(dc(Ct.site,Ht,v(pt-pr)<Ge&&Cr-Tt>Ge?{x:pr,y:v(qe-pr)<Ge?Qe:Cr}:v(Tt-Cr)<Ge&&Wt-pt>Ge?{x:v(Qe-Cr)<Ge?qe:Wt,y:Cr}:v(pt-Wt)<Ge&&Tt-Kt>Ge?{x:Wt,y:v(qe-Wt)<Ge?Qe:Kt}:v(Tt-Kt)<Ge&&pt-pr>Ge?{x:v(Qe-Kt)<Ge?qe:pr,y:Kt}:null),Ct.site,null)),++Vt)}(ne));var Ve={cells:Ui,edges:za};return ri=ho=za=Ui=null,Ve}function _l(Z,ne){return ne.y-Z.y||ne.x-Z.x}Vi.prototype.prepare=function(){for(var Z,ne=this.edges,se=ne.length;se--;)(Z=ne[se].edge).b&&Z.a||ne.splice(se,1);return ne.sort(Nc),ne.length},qa.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},$s.prototype={insert:function(Z,ne){var se,he,ye;if(Z){if(ne.P=Z,ne.N=Z.N,Z.N&&(Z.N.P=ne),Z.N=ne,Z.R){for(Z=Z.R;Z.L;)Z=Z.L;Z.L=ne}else Z.R=ne;se=Z}else this._?(Z=Is(this._),ne.P=null,ne.N=Z,Z.P=Z.L=ne,se=Z):(ne.P=ne.N=null,this._=ne,se=null);for(ne.L=ne.R=null,ne.U=se,ne.C=!0,Z=ne;se&&se.C;)se===(he=se.U).L?(ye=he.R)&&ye.C?(se.C=ye.C=!1,he.C=!0,Z=he):(Z===se.R&&(gs(this,se),se=(Z=se).U),se.C=!1,he.C=!0,zo(this,he)):(ye=he.L)&&ye.C?(se.C=ye.C=!1,he.C=!0,Z=he):(Z===se.L&&(zo(this,se),se=(Z=se).U),se.C=!1,he.C=!0,gs(this,he)),se=Z.U;this._.C=!1},remove:function(Z){Z.N&&(Z.N.P=Z.P),Z.P&&(Z.P.N=Z.N),Z.N=Z.P=null;var ne,se,he,ye=Z.U,Le=Z.L,Ve=Z.R;if(se=Le?Ve?Is(Ve):Le:Ve,ye?ye.L===Z?ye.L=se:ye.R=se:this._=se,Le&&Ve?(he=se.C,se.C=Z.C,se.L=Le,Le.U=se,se!==Ve?(ye=se.U,se.U=Z.U,Z=se.R,ye.L=Z,se.R=Ve,Ve.U=se):(se.U=ye,ye=se,Z=se.R)):(he=Z.C,Z=se),Z&&(Z.U=ye),!he)if(Z&&Z.C)Z.C=!1;else{do{if(Z===this._)break;if(Z===ye.L){if((ne=ye.R).C&&(ne.C=!1,ye.C=!0,gs(this,ye),ne=ye.R),ne.L&&ne.L.C||ne.R&&ne.R.C){ne.R&&ne.R.C||(ne.L.C=!1,ne.C=!0,zo(this,ne),ne=ye.R),ne.C=ye.C,ye.C=ne.R.C=!1,gs(this,ye),Z=this._;break}}else if((ne=ye.L).C&&(ne.C=!1,ye.C=!0,zo(this,ye),ne=ye.L),ne.L&&ne.L.C||ne.R&&ne.R.C){ne.L&&ne.L.C||(ne.R.C=!1,ne.C=!0,gs(this,ne),ne=ye.L),ne.C=ye.C,ye.C=ne.L.C=!1,zo(this,ye),Z=this._;break}ne.C=!0,Z=ye,ye=ye.U}while(!Z.C);Z&&(Z.C=!1)}}},t.geom.voronoi=function(Z){var ne=ao,se=Ps,he=ne,ye=se,Le=qi;if(Z)return Ve(Z);function Ve(qe){var Qe=new Array(qe.length),pt=Le[0][0],Tt=Le[0][1],Ct=Le[1][0],jt=Le[1][1];return bl(Xe(qe),Le).cells.forEach(function(nr,Vt){var Xt=nr.edges,Ht=nr.site;(Qe[Vt]=Xt.length?Xt.map(function(pr){var Wt=pr.start();return[Wt.x,Wt.y]}):Ht.x>=pt&&Ht.x<=Ct&&Ht.y>=Tt&&Ht.y<=jt?[[pt,jt],[Ct,jt],[Ct,Tt],[pt,Tt]]:[]).point=qe[Vt]}),Qe}function Xe(qe){return qe.map(function(Qe,pt){return{x:Math.round(he(Qe,pt)/Ge)*Ge,y:Math.round(ye(Qe,pt)/Ge)*Ge,i:pt}})}return Ve.links=function(qe){return bl(Xe(qe)).edges.filter(function(Qe){return Qe.l&&Qe.r}).map(function(Qe){return{source:qe[Qe.l.i],target:qe[Qe.r.i]}})},Ve.triangles=function(qe){var Qe=[];return bl(Xe(qe)).cells.forEach(function(pt,Tt){for(var Ct,jt,nr,Vt,Xt=pt.site,Ht=pt.edges.sort(Nc),pr=-1,Wt=Ht.length,Kt=Ht[Wt-1].edge,Cr=Kt.l===Xt?Kt.r:Kt.l;++pr<Wt;)Ct=Cr,Cr=(Kt=Ht[pr].edge).l===Xt?Kt.r:Kt.l,Tt<Ct.i&&Tt<Cr.i&&(nr=Ct,Vt=Cr,((jt=Xt).x-Vt.x)*(nr.y-jt.y)-(jt.x-nr.x)*(Vt.y-jt.y)<0)&&Qe.push([qe[Tt],qe[Ct.i],qe[Cr.i]])}),Qe},Ve.x=function(qe){return arguments.length?(he=Qr(ne=qe),Ve):ne},Ve.y=function(qe){return arguments.length?(ye=Qr(se=qe),Ve):se},Ve.clipExtent=function(qe){return arguments.length?(Le=qe??qi,Ve):Le===qi?null:Le},Ve.size=function(qe){return arguments.length?Ve.clipExtent(qe&&[[0,0],qe]):Le===qi?null:Le&&Le[1]},Ve};var qi=[[-1e6,-1e6],[1e6,1e6]];function gc(Z){return Z.x}function mc(Z){return Z.y}function io(Z,ne,se,he,ye,Le){if(!Z(ne,se,he,ye,Le)){var Ve=.5*(se+ye),Xe=.5*(he+Le),qe=ne.nodes;qe[0]&&io(Z,qe[0],se,he,Ve,Xe),qe[1]&&io(Z,qe[1],Ve,he,ye,Xe),qe[2]&&io(Z,qe[2],se,Xe,Ve,Le),qe[3]&&io(Z,qe[3],Ve,Xe,ye,Le)}}function Wl(Z,ne,se,he,ye,Le,Ve){var Xe,qe=1/0;return function Qe(pt,Tt,Ct,jt,nr){if(!(Tt>Le||Ct>Ve||jt<he||nr<ye)){if(Vt=pt.point){var Vt,Xt=ne-pt.x,Ht=se-pt.y,pr=Xt*Xt+Ht*Ht;if(pr<qe){var Wt=Math.sqrt(qe=pr);he=ne-Wt,ye=se-Wt,Le=ne+Wt,Ve=se+Wt,Xe=Vt}}for(var Kt=pt.nodes,Cr=.5*(Tt+jt),tr=.5*(Ct+nr),mr=(se>=tr)<<1|ne>=Cr,wr=mr+4;mr<wr;++mr)if(pt=Kt[3&mr])switch(3&mr){case 0:Qe(pt,Tt,Ct,Cr,tr);break;case 1:Qe(pt,Cr,Ct,jt,tr);break;case 2:Qe(pt,Tt,tr,Cr,nr);break;case 3:Qe(pt,Cr,tr,jt,nr)}}}(Z,he,ye,Le,Ve),Xe}function os(Z,ne){Z=t.rgb(Z),ne=t.rgb(ne);var se=Z.r,he=Z.g,ye=Z.b,Le=ne.r-se,Ve=ne.g-he,Xe=ne.b-ye;return function(qe){return"#"+Sr(Math.round(se+Le*qe))+Sr(Math.round(he+Ve*qe))+Sr(Math.round(ye+Xe*qe))}}function Hi(Z,ne){var se,he={},ye={};for(se in Z)se in ne?he[se]=K(Z[se],ne[se]):ye[se]=Z[se];for(se in ne)se in Z||(ye[se]=ne[se]);return function(Le){for(se in he)ye[se]=he[se](Le);return ye}}function Mo(Z,ne){return Z=+Z,ne=+ne,function(se){return Z*(1-se)+ne*se}}function wl(Z,ne){var se,he,ye,Le=el.lastIndex=Y.lastIndex=0,Ve=-1,Xe=[],qe=[];for(Z+="",ne+="";(se=el.exec(Z))&&(he=Y.exec(ne));)(ye=he.index)>Le&&(ye=ne.slice(Le,ye),Xe[Ve]?Xe[Ve]+=ye:Xe[++Ve]=ye),(se=se[0])===(he=he[0])?Xe[Ve]?Xe[Ve]+=he:Xe[++Ve]=he:(Xe[++Ve]=null,qe.push({i:Ve,x:Mo(se,he)})),Le=Y.lastIndex;return Le<ne.length&&(ye=ne.slice(Le),Xe[Ve]?Xe[Ve]+=ye:Xe[++Ve]=ye),Xe.length<2?qe[0]?(ne=qe[0].x,function(Qe){return ne(Qe)+""}):function(){return ne}:(ne=qe.length,function(Qe){for(var pt,Tt=0;Tt<ne;++Tt)Xe[(pt=qe[Tt]).i]=pt.x(Qe);return Xe.join("")})}t.geom.delaunay=function(Z){return t.geom.voronoi().triangles(Z)},t.geom.quadtree=function(Z,ne,se,he,ye){var Le,Ve=ao,Xe=Ps;if(Le=arguments.length)return Ve=gc,Xe=mc,Le===3&&(ye=se,he=ne,se=ne=0),qe(Z);function qe(Qe){var pt,Tt,Ct,jt,nr,Vt,Xt,Ht,pr,Wt=Qr(Ve),Kt=Qr(Xe);if(ne!=null)Vt=ne,Xt=se,Ht=he,pr=ye;else if(Ht=pr=-(Vt=Xt=1/0),Tt=[],Ct=[],nr=Qe.length,Le)for(jt=0;jt<nr;++jt)(pt=Qe[jt]).x<Vt&&(Vt=pt.x),pt.y<Xt&&(Xt=pt.y),pt.x>Ht&&(Ht=pt.x),pt.y>pr&&(pr=pt.y),Tt.push(pt.x),Ct.push(pt.y);else for(jt=0;jt<nr;++jt){var Cr=+Wt(pt=Qe[jt],jt),tr=+Kt(pt,jt);Cr<Vt&&(Vt=Cr),tr<Xt&&(Xt=tr),Cr>Ht&&(Ht=Cr),tr>pr&&(pr=tr),Tt.push(Cr),Ct.push(tr)}var mr=Ht-Vt,wr=pr-Xt;function Wr(jr,ln,Mn,An,$r,Tn,Xn,Bn){if(!isNaN(Mn)&&!isNaN(An))if(jr.leaf){var aa=jr.x,la=jr.y;if(aa!=null)if(v(aa-Mn)+v(la-An)<.01)Rr(jr,ln,Mn,An,$r,Tn,Xn,Bn);else{var xa=jr.point;jr.x=jr.y=jr.point=null,Rr(jr,xa,aa,la,$r,Tn,Xn,Bn),Rr(jr,ln,Mn,An,$r,Tn,Xn,Bn)}else jr.x=Mn,jr.y=An,jr.point=ln}else Rr(jr,ln,Mn,An,$r,Tn,Xn,Bn)}function Rr(jr,ln,Mn,An,$r,Tn,Xn,Bn){var aa=.5*($r+Xn),la=.5*(Tn+Bn),xa=Mn>=aa,ka=An>=la,Na=ka<<1|xa;jr.leaf=!1,xa?$r=aa:Xn=aa,ka?Tn=la:Bn=la,Wr(jr=jr.nodes[Na]||(jr.nodes[Na]={leaf:!0,nodes:[],point:null,x:null,y:null}),ln,Mn,An,$r,Tn,Xn,Bn)}mr>wr?pr=Xt+mr:Ht=Vt+wr;var tn={leaf:!0,nodes:[],point:null,x:null,y:null,add:function(jr){Wr(tn,jr,+Wt(jr,++jt),+Kt(jr,jt),Vt,Xt,Ht,pr)},visit:function(jr){io(jr,tn,Vt,Xt,Ht,pr)},find:function(jr){return Wl(tn,jr[0],jr[1],Vt,Xt,Ht,pr)}};if(jt=-1,ne==null){for(;++jt<nr;)Wr(tn,Qe[jt],Tt[jt],Ct[jt],Vt,Xt,Ht,pr);--jt}else Qe.forEach(tn.add);return Tt=Ct=Qe=pt=null,tn}return qe.x=function(Qe){return arguments.length?(Ve=Qe,qe):Ve},qe.y=function(Qe){return arguments.length?(Xe=Qe,qe):Xe},qe.extent=function(Qe){return arguments.length?(Qe==null?ne=se=he=ye=null:(ne=+Qe[0][0],se=+Qe[0][1],he=+Qe[1][0],ye=+Qe[1][1]),qe):ne==null?null:[[ne,se],[he,ye]]},qe.size=function(Qe){return arguments.length?(Qe==null?ne=se=he=ye=null:(ne=se=0,he=+Qe[0],ye=+Qe[1]),qe):ne==null?null:[he-ne,ye-se]},qe},t.interpolateRgb=os,t.interpolateObject=Hi,t.interpolateNumber=Mo,t.interpolateString=wl;var el=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Y=new RegExp(el.source,"g");function K(Z,ne){for(var se,he=t.interpolators.length;--he>=0&&!(se=t.interpolators[he](Z,ne)););return se}function X(Z,ne){var se,he=[],ye=[],Le=Z.length,Ve=ne.length,Xe=Math.min(Z.length,ne.length);for(se=0;se<Xe;++se)he.push(K(Z[se],ne[se]));for(;se<Le;++se)ye[se]=Z[se];for(;se<Ve;++se)ye[se]=ne[se];return function(qe){for(se=0;se<Xe;++se)ye[se]=he[se](qe);return ye}}t.interpolate=K,t.interpolators=[function(Z,ne){var se=typeof ne;return(se==="string"?rn.has(ne.toLowerCase())||/^(#|rgb\(|hsl\()/i.test(ne)?os:wl:ne instanceof At?os:Array.isArray(ne)?X:se==="object"&&isNaN(ne)?Hi:Mo)(Z,ne)}],t.interpolateArray=X;var re=function(){return I},me=t.map({linear:re,poly:function(Z){return function(ne){return Math.pow(ne,Z)}},quad:function(){return St},cubic:function(){return Ft},sin:function(){return $t},exp:function(){return sr},circle:function(){return lr},elastic:function(Z,ne){var se;return arguments.length<2&&(ne=.45),arguments.length?se=ne/Ce*Math.asin(1/Z):(Z=1,se=ne/4),function(he){return 1+Z*Math.pow(2,-10*he)*Math.sin((he-se)*Ce/ne)}},back:function(Z){return Z||(Z=1.70158),function(ne){return ne*ne*((Z+1)*ne-Z)}},bounce:function(){return vr}}),Oe=t.map({in:I,out:tt,"in-out":ft,"out-in":function(Z){return ft(tt(Z))}});function Be(Z){return function(ne){return ne<=0?0:ne>=1?1:Z(ne)}}function tt(Z){return function(ne){return 1-Z(1-ne)}}function ft(Z){return function(ne){return .5*(ne<.5?Z(2*ne):2-Z(2-2*ne))}}function St(Z){return Z*Z}function Ft(Z){return Z*Z*Z}function Gt(Z){if(Z<=0)return 0;if(Z>=1)return 1;var ne=Z*Z,se=ne*Z;return 4*(Z<.5?se:3*(Z-ne)+se-.75)}function $t(Z){return 1-Math.cos(Z*Ye)}function sr(Z){return Math.pow(2,10*(Z-1))}function lr(Z){return 1-Math.sqrt(1-Z*Z)}function vr(Z){return Z<1/2.75?7.5625*Z*Z:Z<2/2.75?7.5625*(Z-=1.5/2.75)*Z+.75:Z<2.5/2.75?7.5625*(Z-=2.25/2.75)*Z+.9375:7.5625*(Z-=2.625/2.75)*Z+.984375}function ir(Z,ne){return ne-=Z,function(se){return Math.round(Z+ne*se)}}function gr(Z){var ne,se,he,ye=[Z.a,Z.b],Le=[Z.c,Z.d],Ve=Pr(ye),Xe=Ar(ye,Le),qe=Pr(((ne=Le)[0]+=(he=-Xe)*(se=ye)[0],ne[1]+=he*se[1],ne))||0;ye[0]*Le[1]<Le[0]*ye[1]&&(ye[0]*=-1,ye[1]*=-1,Ve*=-1,Xe*=-1),this.rotate=(Ve?Math.atan2(ye[1],ye[0]):Math.atan2(-Le[0],Le[1]))*Ee,this.translate=[Z.e,Z.f],this.scale=[Ve,qe],this.skew=qe?Math.atan2(Xe,qe)*Ee:0}function Ar(Z,ne){return Z[0]*ne[0]+Z[1]*ne[1]}function Pr(Z){var ne=Math.sqrt(Ar(Z,Z));return ne&&(Z[0]/=ne,Z[1]/=ne),ne}t.ease=function(Z){var ne=Z.indexOf("-"),se=ne>=0?Z.slice(0,ne):Z,he=ne>=0?Z.slice(ne+1):"in";return se=me.get(se)||re,Be((he=Oe.get(he)||I)(se.apply(null,h.call(arguments,1))))},t.interpolateHcl=function(Z,ne){Z=t.hcl(Z),ne=t.hcl(ne);var se=Z.h,he=Z.c,ye=Z.l,Le=ne.h-se,Ve=ne.c-he,Xe=ne.l-ye;return isNaN(Ve)&&(Ve=0,he=isNaN(he)?ne.c:he),isNaN(Le)?(Le=0,se=isNaN(se)?ne.h:se):Le>180?Le-=360:Le<-180&&(Le+=360),function(qe){return Ne(se+Le*qe,he+Ve*qe,ye+Xe*qe)+""}},t.interpolateHsl=function(Z,ne){Z=t.hsl(Z),ne=t.hsl(ne);var se=Z.h,he=Z.s,ye=Z.l,Le=ne.h-se,Ve=ne.s-he,Xe=ne.l-ye;return isNaN(Ve)&&(Ve=0,he=isNaN(he)?ne.s:he),isNaN(Le)?(Le=0,se=isNaN(se)?ne.h:se):Le>180?Le-=360:Le<-180&&(Le+=360),function(qe){return Ot(se+Le*qe,he+Ve*qe,ye+Xe*qe)+""}},t.interpolateLab=function(Z,ne){Z=t.lab(Z),ne=t.lab(ne);var se=Z.l,he=Z.a,ye=Z.b,Le=ne.l-se,Ve=ne.a-he,Xe=ne.b-ye;return function(qe){return Jt(se+Le*qe,he+Ve*qe,ye+Xe*qe)+""}},t.interpolateRound=ir,t.transform=function(Z){var ne=l.createElementNS(t.ns.prefix.svg,"g");return(t.transform=function(se){if(se!=null){ne.setAttribute("transform",se);var he=ne.transform.baseVal.consolidate()}return new gr(he?he.matrix:Gr)})(Z)},gr.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var Gr={a:1,b:0,c:0,d:1,e:0,f:0};function Fr(Z){return Z.length?Z.pop()+",":""}function Yr(Z,ne){var se=[],he=[];return Z=t.transform(Z),ne=t.transform(ne),function(ye,Le,Ve,Xe){if(ye[0]!==Le[0]||ye[1]!==Le[1]){var qe=Ve.push("translate(",null,",",null,")");Xe.push({i:qe-4,x:Mo(ye[0],Le[0])},{i:qe-2,x:Mo(ye[1],Le[1])})}else(Le[0]||Le[1])&&Ve.push("translate("+Le+")")}(Z.translate,ne.translate,se,he),function(ye,Le,Ve,Xe){ye!==Le?(ye-Le>180?Le+=360:Le-ye>180&&(ye+=360),Xe.push({i:Ve.push(Fr(Ve)+"rotate(",null,")")-2,x:Mo(ye,Le)})):Le&&Ve.push(Fr(Ve)+"rotate("+Le+")")}(Z.rotate,ne.rotate,se,he),function(ye,Le,Ve,Xe){ye!==Le?Xe.push({i:Ve.push(Fr(Ve)+"skewX(",null,")")-2,x:Mo(ye,Le)}):Le&&Ve.push(Fr(Ve)+"skewX("+Le+")")}(Z.skew,ne.skew,se,he),function(ye,Le,Ve,Xe){if(ye[0]!==Le[0]||ye[1]!==Le[1]){var qe=Ve.push(Fr(Ve)+"scale(",null,",",null,")");Xe.push({i:qe-4,x:Mo(ye[0],Le[0])},{i:qe-2,x:Mo(ye[1],Le[1])})}else Le[0]===1&&Le[1]===1||Ve.push(Fr(Ve)+"scale("+Le+")")}(Z.scale,ne.scale,se,he),Z=ne=null,function(ye){for(var Le,Ve=-1,Xe=he.length;++Ve<Xe;)se[(Le=he[Ve]).i]=Le.x(ye);return se.join("")}}function an(Z,ne){return ne=(ne-=Z=+Z)||1/ne,function(se){return(se-Z)/ne}}function mn(Z,ne){return ne=(ne-=Z=+Z)||1/ne,function(se){return Math.max(0,Math.min(1,(se-Z)/ne))}}function pn(Z){for(var ne=Z.source,se=Z.target,he=function(Ve,Xe){if(Ve===Xe)return Ve;for(var qe=xn(Ve),Qe=xn(Xe),pt=qe.pop(),Tt=Qe.pop(),Ct=null;pt===Tt;)Ct=pt,pt=qe.pop(),Tt=Qe.pop();return Ct}(ne,se),ye=[ne];ne!==he;)ne=ne.parent,ye.push(ne);for(var Le=ye.length;se!==he;)ye.splice(Le,0,se),se=se.parent;return ye}function xn(Z){for(var ne=[],se=Z.parent;se!=null;)ne.push(Z),Z=se,se=se.parent;return ne.push(Z),ne}function Ln(Z){Z.fixed|=2}function Jn(Z){Z.fixed&=-7}function Vn(Z){Z.fixed|=4,Z.px=Z.x,Z.py=Z.y}function oa(Z){Z.fixed&=-5}t.interpolateTransform=Yr,t.layout={},t.layout.bundle=function(){return function(Z){for(var ne=[],se=-1,he=Z.length;++se<he;)ne.push(pn(Z[se]));return ne}},t.layout.chord=function(){var Z,ne,se,he,ye,Le,Ve,Xe={},qe=0;function Qe(){var Tt,Ct,jt,nr,Vt,Xt={},Ht=[],pr=t.range(he),Wt=[];for(Z=[],ne=[],Tt=0,nr=-1;++nr<he;){for(Ct=0,Vt=-1;++Vt<he;)Ct+=se[nr][Vt];Ht.push(Ct),Wt.push(t.range(he)),Tt+=Ct}for(ye&&pr.sort(function(tn,jr){return ye(Ht[tn],Ht[jr])}),Le&&Wt.forEach(function(tn,jr){tn.sort(function(ln,Mn){return Le(se[jr][ln],se[jr][Mn])})}),Tt=(Ce-qe*he)/Tt,Ct=0,nr=-1;++nr<he;){for(jt=Ct,Vt=-1;++Vt<he;){var Kt=pr[nr],Cr=Wt[Kt][Vt],tr=se[Kt][Cr],mr=Ct,wr=Ct+=tr*Tt;Xt[Kt+"-"+Cr]={index:Kt,subindex:Cr,startAngle:mr,endAngle:wr,value:tr}}ne[Kt]={index:Kt,startAngle:jt,endAngle:Ct,value:Ht[Kt]},Ct+=qe}for(nr=-1;++nr<he;)for(Vt=nr-1;++Vt<he;){var Wr=Xt[nr+"-"+Vt],Rr=Xt[Vt+"-"+nr];(Wr.value||Rr.value)&&Z.push(Wr.value<Rr.value?{source:Rr,target:Wr}:{source:Wr,target:Rr})}Ve&&pt()}function pt(){Z.sort(function(Tt,Ct){return Ve((Tt.source.value+Tt.target.value)/2,(Ct.source.value+Ct.target.value)/2)})}return Xe.matrix=function(Tt){return arguments.length?(he=(se=Tt)&&se.length,Z=ne=null,Xe):se},Xe.padding=function(Tt){return arguments.length?(qe=Tt,Z=ne=null,Xe):qe},Xe.sortGroups=function(Tt){return arguments.length?(ye=Tt,Z=ne=null,Xe):ye},Xe.sortSubgroups=function(Tt){return arguments.length?(Le=Tt,Z=null,Xe):Le},Xe.sortChords=function(Tt){return arguments.length?(Ve=Tt,Z&&pt(),Xe):Ve},Xe.chords=function(){return Z||Qe(),Z},Xe.groups=function(){return ne||Qe(),ne},Xe},t.layout.force=function(){var Z,ne,se,he,ye,Le,Ve={},Xe=t.dispatch("start","tick","end"),qe=[1,1],Qe=.9,pt=Sn,Tt=ra,Ct=-30,jt=sa,nr=.1,Vt=.64,Xt=[],Ht=[];function pr(Kt){return function(Cr,tr,mr,wr){if(Cr.point!==Kt){var Wr=Cr.cx-Kt.x,Rr=Cr.cy-Kt.y,tn=wr-tr,jr=Wr*Wr+Rr*Rr;if(tn*tn/Vt<jr){if(jr<jt){var ln=Cr.charge/jr;Kt.px-=Wr*ln,Kt.py-=Rr*ln}return!0}Cr.point&&jr&&jr<jt&&(ln=Cr.pointCharge/jr,Kt.px-=Wr*ln,Kt.py-=Rr*ln)}return!Cr.charge}}function Wt(Kt){Kt.px=t.event.x,Kt.py=t.event.y,Ve.resume()}return Ve.tick=function(){if((se*=.99)<.005)return Z=null,Xe.end({type:"end",alpha:se=0}),!0;var Kt,Cr,tr,mr,wr,Wr,Rr,tn,jr,ln=Xt.length,Mn=Ht.length;for(Cr=0;Cr<Mn;++Cr)mr=(tr=Ht[Cr]).source,(Wr=(tn=(wr=tr.target).x-mr.x)*tn+(jr=wr.y-mr.y)*jr)&&(tn*=Wr=se*ye[Cr]*((Wr=Math.sqrt(Wr))-he[Cr])/Wr,jr*=Wr,wr.x-=tn*(Rr=mr.weight+wr.weight?mr.weight/(mr.weight+wr.weight):.5),wr.y-=jr*Rr,mr.x+=tn*(Rr=1-Rr),mr.y+=jr*Rr);if((Rr=se*nr)&&(tn=qe[0]/2,jr=qe[1]/2,Cr=-1,Rr))for(;++Cr<ln;)(tr=Xt[Cr]).x+=(tn-tr.x)*Rr,tr.y+=(jr-tr.y)*Rr;if(Ct)for(function An($r,Tn,Xn){var Bn=0,aa=0;if($r.charge=0,!$r.leaf)for(var la,xa=$r.nodes,ka=xa.length,Na=-1;++Na<ka;)(la=xa[Na])!=null&&(An(la,Tn,Xn),$r.charge+=la.charge,Bn+=la.charge*la.cx,aa+=la.charge*la.cy);if($r.point){$r.leaf||($r.point.x+=Math.random()-.5,$r.point.y+=Math.random()-.5);var ii=Tn*Xn[$r.point.index];$r.charge+=$r.pointCharge=ii,Bn+=ii*$r.point.x,aa+=ii*$r.point.y}$r.cx=Bn/$r.charge,$r.cy=aa/$r.charge}(Kt=t.geom.quadtree(Xt),se,Le),Cr=-1;++Cr<ln;)(tr=Xt[Cr]).fixed||Kt.visit(pr(tr));for(Cr=-1;++Cr<ln;)(tr=Xt[Cr]).fixed?(tr.x=tr.px,tr.y=tr.py):(tr.x-=(tr.px-(tr.px=tr.x))*Qe,tr.y-=(tr.py-(tr.py=tr.y))*Qe);Xe.tick({type:"tick",alpha:se})},Ve.nodes=function(Kt){return arguments.length?(Xt=Kt,Ve):Xt},Ve.links=function(Kt){return arguments.length?(Ht=Kt,Ve):Ht},Ve.size=function(Kt){return arguments.length?(qe=Kt,Ve):qe},Ve.linkDistance=function(Kt){return arguments.length?(pt=typeof Kt=="function"?Kt:+Kt,Ve):pt},Ve.distance=Ve.linkDistance,Ve.linkStrength=function(Kt){return arguments.length?(Tt=typeof Kt=="function"?Kt:+Kt,Ve):Tt},Ve.friction=function(Kt){return arguments.length?(Qe=+Kt,Ve):Qe},Ve.charge=function(Kt){return arguments.length?(Ct=typeof Kt=="function"?Kt:+Kt,Ve):Ct},Ve.chargeDistance=function(Kt){return arguments.length?(jt=Kt*Kt,Ve):Math.sqrt(jt)},Ve.gravity=function(Kt){return arguments.length?(nr=+Kt,Ve):nr},Ve.theta=function(Kt){return arguments.length?(Vt=Kt*Kt,Ve):Math.sqrt(Vt)},Ve.alpha=function(Kt){return arguments.length?(Kt=+Kt,se?Kt>0?se=Kt:(Z.c=null,Z.t=NaN,Z=null,Xe.end({type:"end",alpha:se=0})):Kt>0&&(Xe.start({type:"start",alpha:se=Kt}),Z=Zr(Ve.tick)),Ve):se},Ve.start=function(){var Kt,Cr,tr,mr=Xt.length,wr=Ht.length,Wr=qe[0],Rr=qe[1];for(Kt=0;Kt<mr;++Kt)(tr=Xt[Kt]).index=Kt,tr.weight=0;for(Kt=0;Kt<wr;++Kt)typeof(tr=Ht[Kt]).source=="number"&&(tr.source=Xt[tr.source]),typeof tr.target=="number"&&(tr.target=Xt[tr.target]),++tr.source.weight,++tr.target.weight;for(Kt=0;Kt<mr;++Kt)tr=Xt[Kt],isNaN(tr.x)&&(tr.x=tn("x",Wr)),isNaN(tr.y)&&(tr.y=tn("y",Rr)),isNaN(tr.px)&&(tr.px=tr.x),isNaN(tr.py)&&(tr.py=tr.y);if(he=[],typeof pt=="function")for(Kt=0;Kt<wr;++Kt)he[Kt]=+pt.call(this,Ht[Kt],Kt);else for(Kt=0;Kt<wr;++Kt)he[Kt]=pt;if(ye=[],typeof Tt=="function")for(Kt=0;Kt<wr;++Kt)ye[Kt]=+Tt.call(this,Ht[Kt],Kt);else for(Kt=0;Kt<wr;++Kt)ye[Kt]=Tt;if(Le=[],typeof Ct=="function")for(Kt=0;Kt<mr;++Kt)Le[Kt]=+Ct.call(this,Xt[Kt],Kt);else for(Kt=0;Kt<mr;++Kt)Le[Kt]=Ct;function tn(jr,ln){if(!Cr){for(Cr=new Array(mr),Tn=0;Tn<mr;++Tn)Cr[Tn]=[];for(Tn=0;Tn<wr;++Tn){var Mn=Ht[Tn];Cr[Mn.source.index].push(Mn.target),Cr[Mn.target.index].push(Mn.source)}}for(var An,$r=Cr[Kt],Tn=-1,Xn=$r.length;++Tn<Xn;)if(!isNaN(An=$r[Tn][jr]))return An;return Math.random()*ln}return Ve.resume()},Ve.resume=function(){return Ve.alpha(.1)},Ve.stop=function(){return Ve.alpha(0)},Ve.drag=function(){if(ne||(ne=t.behavior.drag().origin(I).on("dragstart.force",Ln).on("drag.force",Wt).on("dragend.force",Jn)),!arguments.length)return ne;this.on("mouseover.force",Vn).on("mouseout.force",oa).call(ne)},t.rebind(Ve,Xe,"on")};var Sn=20,ra=1,sa=1/0;function Hn(Z,ne){return t.rebind(Z,ne,"sort","children","value"),Z.nodes=Z,Z.links=Fa,Z}function Gn(Z,ne){for(var se=[Z];(Z=se.pop())!=null;)if(ne(Z),(ye=Z.children)&&(he=ye.length))for(var he,ye;--he>=0;)se.push(ye[he])}function $n(Z,ne){for(var se=[Z],he=[];(Z=se.pop())!=null;)if(he.push(Z),(Le=Z.children)&&(ye=Le.length))for(var ye,Le,Ve=-1;++Ve<ye;)se.push(Le[Ve]);for(;(Z=he.pop())!=null;)ne(Z)}function Zn(Z){return Z.children}function qn(Z){return Z.value}function fi(Z,ne){return ne.value-Z.value}function Fa(Z){return t.merge(Z.map(function(ne){return(ne.children||[]).map(function(se){return{source:ne,target:se}})}))}t.layout.hierarchy=function(){var Z=fi,ne=Zn,se=qn;function he(ye){var Le,Ve=[ye],Xe=[];for(ye.depth=0;(Le=Ve.pop())!=null;)if(Xe.push(Le),(Qe=ne.call(he,Le,Le.depth))&&(qe=Qe.length)){for(var qe,Qe,pt;--qe>=0;)Ve.push(pt=Qe[qe]),pt.parent=Le,pt.depth=Le.depth+1;se&&(Le.value=0),Le.children=Qe}else se&&(Le.value=+se.call(he,Le,Le.depth)||0),delete Le.children;return $n(ye,function(Tt){var Ct,jt;Z&&(Ct=Tt.children)&&Ct.sort(Z),se&&(jt=Tt.parent)&&(jt.value+=Tt.value)}),Xe}return he.sort=function(ye){return arguments.length?(Z=ye,he):Z},he.children=function(ye){return arguments.length?(ne=ye,he):ne},he.value=function(ye){return arguments.length?(se=ye,he):se},he.revalue=function(ye){return se&&(Gn(ye,function(Le){Le.children&&(Le.value=0)}),$n(ye,function(Le){var Ve;Le.children||(Le.value=+se.call(he,Le,Le.depth)||0),(Ve=Le.parent)&&(Ve.value+=Le.value)})),ye},he},t.layout.partition=function(){var Z=t.layout.hierarchy(),ne=[1,1];function se(he,ye){var Le=Z.call(this,he,ye);return function Ve(Xe,qe,Qe,pt){var Tt=Xe.children;if(Xe.x=qe,Xe.y=Xe.depth*pt,Xe.dx=Qe,Xe.dy=pt,Tt&&(Ct=Tt.length)){var Ct,jt,nr,Vt=-1;for(Qe=Xe.value?Qe/Xe.value:0;++Vt<Ct;)Ve(jt=Tt[Vt],qe,nr=jt.value*Qe,pt),qe+=nr}}(Le[0],0,ne[0],ne[1]/function Ve(Xe){var qe=Xe.children,Qe=0;if(qe&&(pt=qe.length))for(var pt,Tt=-1;++Tt<pt;)Qe=Math.max(Qe,Ve(qe[Tt]));return 1+Qe}(Le[0])),Le}return se.size=function(he){return arguments.length?(ne=he,se):ne},Hn(se,Z)},t.layout.pie=function(){var Z=Number,ne=Ha,se=0,he=Ce,ye=0;function Le(Ve){var Xe,qe=Ve.length,Qe=Ve.map(function(pr,Wt){return+Z.call(Le,pr,Wt)}),pt=+(typeof se=="function"?se.apply(this,arguments):se),Tt=(typeof he=="function"?he.apply(this,arguments):he)-pt,Ct=Math.min(Math.abs(Tt)/qe,+(typeof ye=="function"?ye.apply(this,arguments):ye)),jt=Ct*(Tt<0?-1:1),nr=t.sum(Qe),Vt=nr?(Tt-qe*jt)/nr:0,Xt=t.range(qe),Ht=[];return ne!=null&&Xt.sort(ne===Ha?function(pr,Wt){return Qe[Wt]-Qe[pr]}:function(pr,Wt){return ne(Ve[pr],Ve[Wt])}),Xt.forEach(function(pr){Ht[pr]={data:Ve[pr],value:Xe=Qe[pr],startAngle:pt,endAngle:pt+=Xe*Vt+jt,padAngle:Ct}}),Ht}return Le.value=function(Ve){return arguments.length?(Z=Ve,Le):Z},Le.sort=function(Ve){return arguments.length?(ne=Ve,Le):ne},Le.startAngle=function(Ve){return arguments.length?(se=Ve,Le):se},Le.endAngle=function(Ve){return arguments.length?(he=Ve,Le):he},Le.padAngle=function(Ve){return arguments.length?(ye=Ve,Le):ye},Le};var Ha={};function ba(Z){return Z.x}function Ga(Z){return Z.y}function Ea(Z,ne,se){Z.y0=ne,Z.y=se}t.layout.stack=function(){var Z=I,ne=go,se=Si,he=Ea,ye=ba,Le=Ga;function Ve(Xe,qe){if(!(Ct=Xe.length))return Xe;var Qe=Xe.map(function(pr,Wt){return Z.call(Ve,pr,Wt)}),pt=Qe.map(function(pr){return pr.map(function(Wt,Kt){return[ye.call(Ve,Wt,Kt),Le.call(Ve,Wt,Kt)]})}),Tt=ne.call(Ve,pt,qe);Qe=t.permute(Qe,Tt),pt=t.permute(pt,Tt);var Ct,jt,nr,Vt,Xt=se.call(Ve,pt,qe),Ht=Qe[0].length;for(nr=0;nr<Ht;++nr)for(he.call(Ve,Qe[0][nr],Vt=Xt[nr],pt[0][nr][1]),jt=1;jt<Ct;++jt)he.call(Ve,Qe[jt][nr],Vt+=pt[jt-1][nr][1],pt[jt][nr][1]);return Xe}return Ve.values=function(Xe){return arguments.length?(Z=Xe,Ve):Z},Ve.order=function(Xe){return arguments.length?(ne=typeof Xe=="function"?Xe:Ao.get(Xe)||go,Ve):ne},Ve.offset=function(Xe){return arguments.length?(se=typeof Xe=="function"?Xe:Os.get(Xe)||Si,Ve):se},Ve.x=function(Xe){return arguments.length?(ye=Xe,Ve):ye},Ve.y=function(Xe){return arguments.length?(Le=Xe,Ve):Le},Ve.out=function(Xe){return arguments.length?(he=Xe,Ve):he},Ve};var Ao=t.map({"inside-out":function(Z){var ne,se,he=Z.length,ye=Z.map(mo),Le=Z.map(Do),Ve=t.range(he).sort(function(Tt,Ct){return ye[Tt]-ye[Ct]}),Xe=0,qe=0,Qe=[],pt=[];for(ne=0;ne<he;++ne)se=Ve[ne],Xe<qe?(Xe+=Le[se],Qe.push(se)):(qe+=Le[se],pt.push(se));return pt.reverse().concat(Qe)},reverse:function(Z){return t.range(Z.length).reverse()},default:go}),Os=t.map({silhouette:function(Z){var ne,se,he,ye=Z.length,Le=Z[0].length,Ve=[],Xe=0,qe=[];for(se=0;se<Le;++se){for(ne=0,he=0;ne<ye;ne++)he+=Z[ne][se][1];he>Xe&&(Xe=he),Ve.push(he)}for(se=0;se<Le;++se)qe[se]=(Xe-Ve[se])/2;return qe},wiggle:function(Z){var ne,se,he,ye,Le,Ve,Xe,qe,Qe,pt=Z.length,Tt=Z[0],Ct=Tt.length,jt=[];for(jt[0]=qe=Qe=0,se=1;se<Ct;++se){for(ne=0,ye=0;ne<pt;++ne)ye+=Z[ne][se][1];for(ne=0,Le=0,Xe=Tt[se][0]-Tt[se-1][0];ne<pt;++ne){for(he=0,Ve=(Z[ne][se][1]-Z[ne][se-1][1])/(2*Xe);he<ne;++he)Ve+=(Z[he][se][1]-Z[he][se-1][1])/Xe;Le+=Ve*Z[ne][se][1]}jt[se]=qe-=ye?Le/ye*Xe:0,qe<Qe&&(Qe=qe)}for(se=0;se<Ct;++se)jt[se]-=Qe;return jt},expand:function(Z){var ne,se,he,ye=Z.length,Le=Z[0].length,Ve=1/ye,Xe=[];for(se=0;se<Le;++se){for(ne=0,he=0;ne<ye;ne++)he+=Z[ne][se][1];if(he)for(ne=0;ne<ye;ne++)Z[ne][se][1]/=he;else for(ne=0;ne<ye;ne++)Z[ne][se][1]=Ve}for(se=0;se<Le;++se)Xe[se]=0;return Xe},zero:Si});function go(Z){return t.range(Z.length)}function Si(Z){for(var ne=-1,se=Z[0].length,he=[];++ne<se;)he[ne]=0;return he}function mo(Z){for(var ne,se=1,he=0,ye=Z[0][1],Le=Z.length;se<Le;++se)(ne=Z[se][1])>ye&&(he=se,ye=ne);return he}function Do(Z){return Z.reduce(tl,0)}function tl(Z,ne){return Z+ne[1]}function ms(Z,ne){return zs(Z,Math.ceil(Math.log(ne.length)/Math.LN2+1))}function zs(Z,ne){for(var se=-1,he=+Z[0],ye=(Z[1]-he)/ne,Le=[];++se<=ne;)Le[se]=ye*se+he;return Le}function Ro(Z){return[t.min(Z),t.max(Z)]}function Tl(Z,ne){return Z.value-ne.value}function Fo(Z,ne){var se=Z._pack_next;Z._pack_next=ne,ne._pack_prev=Z,ne._pack_next=se,se._pack_prev=ne}function Bo(Z,ne){Z._pack_next=ne,ne._pack_prev=Z}function Xa(Z,ne){var se=ne.x-Z.x,he=ne.y-Z.y,ye=Z.r+ne.r;return .999*ye*ye>se*se+he*he}function Ds(Z){if((ne=Z.children)&&(qe=ne.length)){var ne,se,he,ye,Le,Ve,Xe,qe,Qe=1/0,pt=-1/0,Tt=1/0,Ct=-1/0;if(ne.forEach(Zl),(se=ne[0]).x=-se.r,se.y=0,Wt(se),qe>1&&((he=ne[1]).x=he.r,he.y=0,Wt(he),qe>2))for(vs(se,he,ye=ne[2]),Wt(ye),Fo(se,ye),se._pack_prev=ye,Fo(ye,he),he=se._pack_next,Le=3;Le<qe;Le++){vs(se,he,ye=ne[Le]);var jt=0,nr=1,Vt=1;for(Ve=he._pack_next;Ve!==he;Ve=Ve._pack_next,nr++)if(Xa(Ve,ye)){jt=1;break}if(jt==1)for(Xe=se._pack_prev;Xe!==Ve._pack_prev&&!Xa(Xe,ye);Xe=Xe._pack_prev,Vt++);jt?(nr<Vt||nr==Vt&&he.r<se.r?Bo(se,he=Ve):Bo(se=Xe,he),Le--):(Fo(se,ye),he=ye,Wt(ye))}var Xt=(Qe+pt)/2,Ht=(Tt+Ct)/2,pr=0;for(Le=0;Le<qe;Le++)(ye=ne[Le]).x-=Xt,ye.y-=Ht,pr=Math.max(pr,ye.r+Math.sqrt(ye.x*ye.x+ye.y*ye.y));Z.r=pr,ne.forEach(Ja)}function Wt(Kt){Qe=Math.min(Kt.x-Kt.r,Qe),pt=Math.max(Kt.x+Kt.r,pt),Tt=Math.min(Kt.y-Kt.r,Tt),Ct=Math.max(Kt.y+Kt.r,Ct)}}function Zl(Z){Z._pack_next=Z._pack_prev=Z}function Ja(Z){delete Z._pack_next,delete Z._pack_prev}function vs(Z,ne,se){var he=Z.r+se.r,ye=ne.x-Z.x,Le=ne.y-Z.y;if(he&&(ye||Le)){var Ve=ne.r+se.r,Xe=ye*ye+Le*Le,qe=.5+((he*=he)-(Ve*=Ve))/(2*Xe),Qe=Math.sqrt(Math.max(0,2*Ve*(he+Xe)-(he-=Xe)*he-Ve*Ve))/(2*Xe);se.x=Z.x+qe*ye+Qe*Le,se.y=Z.y+qe*Le-Qe*ye}else se.x=Z.x+he,se.y=Z.y}function Da(Z,ne){return Z.parent==ne.parent?1:2}function Ii(Z){var ne=Z.children;return ne.length?ne[0]:Z.t}function Oi(Z){var ne,se=Z.children;return(ne=se.length)?se[ne-1]:Z.t}function Rs(Z,ne,se){var he=se/(ne.i-Z.i);ne.c-=he,ne.s+=se,Z.c+=he,ne.z+=se,ne.m+=se}function vu(Z,ne,se){return Z.a.parent===ne.parent?Z.a:se}function Xl(Z){return{x:Z.x,y:Z.y,dx:Z.dx,dy:Z.dy}}function vc(Z,ne){var se=Z.x+ne[3],he=Z.y+ne[0],ye=Z.dx-ne[1]-ne[3],Le=Z.dy-ne[0]-ne[2];return ye<0&&(se+=ye/2,ye=0),Le<0&&(he+=Le/2,Le=0),{x:se,y:he,dx:ye,dy:Le}}function So(Z){var ne=Z[0],se=Z[Z.length-1];return ne<se?[ne,se]:[se,ne]}function kl(Z){return Z.rangeExtent?Z.rangeExtent():So(Z.range())}function rl(Z,ne,se,he){var ye=se(Z[0],Z[1]),Le=he(ne[0],ne[1]);return function(Ve){return Le(ye(Ve))}}function vo(Z,ne){var se,he=0,ye=Z.length-1,Le=Z[he],Ve=Z[ye];return Ve<Le&&(se=he,he=ye,ye=se,se=Le,Le=Ve,Ve=se),Z[he]=ne.floor(Le),Z[ye]=ne.ceil(Ve),Z}function Gi(Z){return Z?{floor:function(ne){return Math.floor(ne/Z)*Z},ceil:function(ne){return Math.ceil(ne/Z)*Z}}:Of}t.layout.histogram=function(){var Z=!0,ne=Number,se=Ro,he=ms;function ye(Le,Ve){for(var Xe,qe,Qe=[],pt=Le.map(ne,this),Tt=se.call(this,pt,Ve),Ct=he.call(this,Tt,pt,Ve),jt=(Ve=-1,pt.length),nr=Ct.length-1,Vt=Z?1:1/jt;++Ve<nr;)(Xe=Qe[Ve]=[]).dx=Ct[Ve+1]-(Xe.x=Ct[Ve]),Xe.y=0;if(nr>0)for(Ve=-1;++Ve<jt;)(qe=pt[Ve])>=Tt[0]&&qe<=Tt[1]&&((Xe=Qe[t.bisect(Ct,qe,1,nr)-1]).y+=Vt,Xe.push(Le[Ve]));return Qe}return ye.value=function(Le){return arguments.length?(ne=Le,ye):ne},ye.range=function(Le){return arguments.length?(se=Qr(Le),ye):se},ye.bins=function(Le){return arguments.length?(he=typeof Le=="number"?function(Ve){return zs(Ve,Le)}:Qr(Le),ye):he},ye.frequency=function(Le){return arguments.length?(Z=!!Le,ye):Z},ye},t.layout.pack=function(){var Z,ne=t.layout.hierarchy().sort(Tl),se=0,he=[1,1];function ye(Le,Ve){var Xe=ne.call(this,Le,Ve),qe=Xe[0],Qe=he[0],pt=he[1],Tt=Z==null?Math.sqrt:typeof Z=="function"?Z:function(){return Z};if(qe.x=qe.y=0,$n(qe,function(jt){jt.r=+Tt(jt.value)}),$n(qe,Ds),se){var Ct=se*(Z?1:Math.max(2*qe.r/Qe,2*qe.r/pt))/2;$n(qe,function(jt){jt.r+=Ct}),$n(qe,Ds),$n(qe,function(jt){jt.r-=Ct})}return function jt(nr,Vt,Xt,Ht){var pr=nr.children;if(nr.x=Vt+=Ht*nr.x,nr.y=Xt+=Ht*nr.y,nr.r*=Ht,pr)for(var Wt=-1,Kt=pr.length;++Wt<Kt;)jt(pr[Wt],Vt,Xt,Ht)}(qe,Qe/2,pt/2,Z?1:1/Math.max(2*qe.r/Qe,2*qe.r/pt)),Xe}return ye.size=function(Le){return arguments.length?(he=Le,ye):he},ye.radius=function(Le){return arguments.length?(Z=Le==null||typeof Le=="function"?Le:+Le,ye):Z},ye.padding=function(Le){return arguments.length?(se=+Le,ye):se},Hn(ye,ne)},t.layout.tree=function(){var Z=t.layout.hierarchy().sort(null).value(null),ne=Da,se=[1,1],he=null;function ye(qe,Qe){var pt=Z.call(this,qe,Qe),Tt=pt[0],Ct=function(Wt){for(var Kt,Cr={A:null,children:[Wt]},tr=[Cr];(Kt=tr.pop())!=null;)for(var mr,wr=Kt.children,Wr=0,Rr=wr.length;Wr<Rr;++Wr)tr.push((wr[Wr]=mr={_:wr[Wr],parent:Kt,children:(mr=wr[Wr].children)&&mr.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:Wr}).a=mr);return Cr.children[0]}(Tt);if($n(Ct,Le),Ct.parent.m=-Ct.z,Gn(Ct,Ve),he)Gn(Tt,Xe);else{var jt=Tt,nr=Tt,Vt=Tt;Gn(Tt,function(Wt){Wt.x<jt.x&&(jt=Wt),Wt.x>nr.x&&(nr=Wt),Wt.depth>Vt.depth&&(Vt=Wt)});var Xt=ne(jt,nr)/2-jt.x,Ht=se[0]/(nr.x+ne(nr,jt)/2+Xt),pr=se[1]/(Vt.depth||1);Gn(Tt,function(Wt){Wt.x=(Wt.x+Xt)*Ht,Wt.y=Wt.depth*pr})}return pt}function Le(qe){var Qe=qe.children,pt=qe.parent.children,Tt=qe.i?pt[qe.i-1]:null;if(Qe.length){(function(jt){for(var nr,Vt=0,Xt=0,Ht=jt.children,pr=Ht.length;--pr>=0;)(nr=Ht[pr]).z+=Vt,nr.m+=Vt,Vt+=nr.s+(Xt+=nr.c)})(qe);var Ct=(Qe[0].z+Qe[Qe.length-1].z)/2;Tt?(qe.z=Tt.z+ne(qe._,Tt._),qe.m=qe.z-Ct):qe.z=Ct}else Tt&&(qe.z=Tt.z+ne(qe._,Tt._));qe.parent.A=function(jt,nr,Vt){if(nr){for(var Xt,Ht=jt,pr=jt,Wt=nr,Kt=Ht.parent.children[0],Cr=Ht.m,tr=pr.m,mr=Wt.m,wr=Kt.m;Wt=Oi(Wt),Ht=Ii(Ht),Wt&&Ht;)Kt=Ii(Kt),(pr=Oi(pr)).a=jt,(Xt=Wt.z+mr-Ht.z-Cr+ne(Wt._,Ht._))>0&&(Rs(vu(Wt,jt,Vt),jt,Xt),Cr+=Xt,tr+=Xt),mr+=Wt.m,Cr+=Ht.m,wr+=Kt.m,tr+=pr.m;Wt&&!Oi(pr)&&(pr.t=Wt,pr.m+=mr-tr),Ht&&!Ii(Kt)&&(Kt.t=Ht,Kt.m+=Cr-wr,Vt=jt)}return Vt}(qe,Tt,qe.parent.A||pt[0])}function Ve(qe){qe._.x=qe.z+qe.parent.m,qe.m+=qe.parent.m}function Xe(qe){qe.x*=se[0],qe.y=qe.depth*se[1]}return ye.separation=function(qe){return arguments.length?(ne=qe,ye):ne},ye.size=function(qe){return arguments.length?(he=(se=qe)==null?Xe:null,ye):he?null:se},ye.nodeSize=function(qe){return arguments.length?(he=(se=qe)==null?null:Xe,ye):he?se:null},Hn(ye,Z)},t.layout.cluster=function(){var Z=t.layout.hierarchy().sort(null).value(null),ne=Da,se=[1,1],he=!1;function ye(Le,Ve){var Xe,qe=Z.call(this,Le,Ve),Qe=qe[0],pt=0;$n(Qe,function(Vt){var Xt=Vt.children;Xt&&Xt.length?(Vt.x=function(Ht){return Ht.reduce(function(pr,Wt){return pr+Wt.x},0)/Ht.length}(Xt),Vt.y=function(Ht){return 1+t.max(Ht,function(pr){return pr.y})}(Xt)):(Vt.x=Xe?pt+=ne(Vt,Xe):0,Vt.y=0,Xe=Vt)});var Tt=function Vt(Xt){var Ht=Xt.children;return Ht&&Ht.length?Vt(Ht[0]):Xt}(Qe),Ct=function Vt(Xt){var Ht,pr=Xt.children;return pr&&(Ht=pr.length)?Vt(pr[Ht-1]):Xt}(Qe),jt=Tt.x-ne(Tt,Ct)/2,nr=Ct.x+ne(Ct,Tt)/2;return $n(Qe,he?function(Vt){Vt.x=(Vt.x-Qe.x)*se[0],Vt.y=(Qe.y-Vt.y)*se[1]}:function(Vt){Vt.x=(Vt.x-jt)/(nr-jt)*se[0],Vt.y=(1-(Qe.y?Vt.y/Qe.y:1))*se[1]}),qe}return ye.separation=function(Le){return arguments.length?(ne=Le,ye):ne},ye.size=function(Le){return arguments.length?(he=(se=Le)==null,ye):he?null:se},ye.nodeSize=function(Le){return arguments.length?(he=(se=Le)!=null,ye):he?se:null},Hn(ye,Z)},t.layout.treemap=function(){var Z,ne=t.layout.hierarchy(),se=Math.round,he=[1,1],ye=null,Le=Xl,Ve=!1,Xe="squarify",qe=.5*(1+Math.sqrt(5));function Qe(Vt,Xt){for(var Ht,pr,Wt=-1,Kt=Vt.length;++Wt<Kt;)pr=(Ht=Vt[Wt]).value*(Xt<0?0:Xt),Ht.area=isNaN(pr)||pr<=0?0:pr}function pt(Vt){var Xt=Vt.children;if(Xt&&Xt.length){var Ht,pr,Wt,Kt=Le(Vt),Cr=[],tr=Xt.slice(),mr=1/0,wr=Xe==="slice"?Kt.dx:Xe==="dice"?Kt.dy:Xe==="slice-dice"?1&Vt.depth?Kt.dy:Kt.dx:Math.min(Kt.dx,Kt.dy);for(Qe(tr,Kt.dx*Kt.dy/Vt.value),Cr.area=0;(Wt=tr.length)>0;)Cr.push(Ht=tr[Wt-1]),Cr.area+=Ht.area,Xe!=="squarify"||(pr=Ct(Cr,wr))<=mr?(tr.pop(),mr=pr):(Cr.area-=Cr.pop().area,jt(Cr,wr,Kt,!1),wr=Math.min(Kt.dx,Kt.dy),Cr.length=Cr.area=0,mr=1/0);Cr.length&&(jt(Cr,wr,Kt,!0),Cr.length=Cr.area=0),Xt.forEach(pt)}}function Tt(Vt){var Xt=Vt.children;if(Xt&&Xt.length){var Ht,pr=Le(Vt),Wt=Xt.slice(),Kt=[];for(Qe(Wt,pr.dx*pr.dy/Vt.value),Kt.area=0;Ht=Wt.pop();)Kt.push(Ht),Kt.area+=Ht.area,Ht.z!=null&&(jt(Kt,Ht.z?pr.dx:pr.dy,pr,!Wt.length),Kt.length=Kt.area=0);Xt.forEach(Tt)}}function Ct(Vt,Xt){for(var Ht,pr=Vt.area,Wt=0,Kt=1/0,Cr=-1,tr=Vt.length;++Cr<tr;)(Ht=Vt[Cr].area)&&(Ht<Kt&&(Kt=Ht),Ht>Wt&&(Wt=Ht));return Xt*=Xt,(pr*=pr)?Math.max(Xt*Wt*qe/pr,pr/(Xt*Kt*qe)):1/0}function jt(Vt,Xt,Ht,pr){var Wt,Kt=-1,Cr=Vt.length,tr=Ht.x,mr=Ht.y,wr=Xt?se(Vt.area/Xt):0;if(Xt==Ht.dx){for((pr||wr>Ht.dy)&&(wr=Ht.dy);++Kt<Cr;)(Wt=Vt[Kt]).x=tr,Wt.y=mr,Wt.dy=wr,tr+=Wt.dx=Math.min(Ht.x+Ht.dx-tr,wr?se(Wt.area/wr):0);Wt.z=!0,Wt.dx+=Ht.x+Ht.dx-tr,Ht.y+=wr,Ht.dy-=wr}else{for((pr||wr>Ht.dx)&&(wr=Ht.dx);++Kt<Cr;)(Wt=Vt[Kt]).x=tr,Wt.y=mr,Wt.dx=wr,mr+=Wt.dy=Math.min(Ht.y+Ht.dy-mr,wr?se(Wt.area/wr):0);Wt.z=!1,Wt.dy+=Ht.y+Ht.dy-mr,Ht.x+=wr,Ht.dx-=wr}}function nr(Vt){var Xt=Z||ne(Vt),Ht=Xt[0];return Ht.x=Ht.y=0,Ht.value?(Ht.dx=he[0],Ht.dy=he[1]):Ht.dx=Ht.dy=0,Z&&ne.revalue(Ht),Qe([Ht],Ht.dx*Ht.dy/Ht.value),(Z?Tt:pt)(Ht),Ve&&(Z=Xt),Xt}return nr.size=function(Vt){return arguments.length?(he=Vt,nr):he},nr.padding=function(Vt){if(!arguments.length)return ye;function Xt(Wt){var Kt=Vt.call(nr,Wt,Wt.depth);return Kt==null?Xl(Wt):vc(Wt,typeof Kt=="number"?[Kt,Kt,Kt,Kt]:Kt)}function Ht(Wt){return vc(Wt,Vt)}var pr;return Le=(ye=Vt)==null?Xl:(pr=typeof Vt)=="function"?Xt:(pr==="number"&&(Vt=[Vt,Vt,Vt,Vt]),Ht),nr},nr.round=function(Vt){return arguments.length?(se=Vt?Math.round:Number,nr):se!=Number},nr.sticky=function(Vt){return arguments.length?(Ve=Vt,Z=null,nr):Ve},nr.ratio=function(Vt){return arguments.length?(qe=Vt,nr):qe},nr.mode=function(Vt){return arguments.length?(Xe=Vt+"",nr):Xe},Hn(nr,ne)},t.random={normal:function(Z,ne){var se=arguments.length;return se<2&&(ne=1),se<1&&(Z=0),function(){var he,ye,Le;do Le=(he=2*Math.random()-1)*he+(ye=2*Math.random()-1)*ye;while(!Le||Le>1);return Z+ne*he*Math.sqrt(-2*Math.log(Le)/Le)}},logNormal:function(){var Z=t.random.normal.apply(t,arguments);return function(){return Math.exp(Z())}},bates:function(Z){var ne=t.random.irwinHall(Z);return function(){return ne()/Z}},irwinHall:function(Z){return function(){for(var ne=0,se=0;se<Z;se++)ne+=Math.random();return ne}}},t.scale={};var Of={floor:I,ceil:I};function Wu(Z,ne,se,he){var ye=[],Le=[],Ve=0,Xe=Math.min(Z.length,ne.length)-1;for(Z[Xe]<Z[0]&&(Z=Z.slice().reverse(),ne=ne.slice().reverse());++Ve<=Xe;)ye.push(se(Z[Ve-1],Z[Ve])),Le.push(he(ne[Ve-1],ne[Ve]));return function(qe){var Qe=t.bisect(Z,qe,1,Xe)-1;return Le[Qe](ye[Qe](qe))}}function yu(Z,ne){return t.rebind(Z,ne,"range","rangeRound","interpolate","clamp")}function Zu(Z,ne){return vo(Z,Gi(Jl(Z,ne)[2])),vo(Z,Gi(Jl(Z,ne)[2])),Z}function Jl(Z,ne){ne==null&&(ne=10);var se=So(Z),he=se[1]-se[0],ye=Math.pow(10,Math.floor(Math.log(he/ne)/Math.LN10)),Le=ne/he*ye;return Le<=.15?ye*=10:Le<=.35?ye*=5:Le<=.75&&(ye*=2),se[0]=Math.ceil(se[0]/ye)*ye,se[1]=Math.floor(se[1]/ye)*ye+.5*ye,se[2]=ye,se}function Uc(Z,ne){return t.range.apply(t,Jl(Z,ne))}function yc(Z,ne,se){var he=Jl(Z,ne);if(se){var ye=qt.exec(se);if(ye.shift(),ye[8]==="s"){var Le=t.formatPrefix(Math.max(v(he[0]),v(he[1])));return ye[7]||(ye[7]="."+Ml(Le.scale(he[2]))),ye[8]="f",se=t.format(ye.join("")),function(Ve){return se(Le.scale(Ve))+Le.symbol}}ye[7]||(ye[7]="."+function(Ve,Xe){var qe=Ml(Xe[2]);return Ve in zf?Math.abs(qe-Ml(Math.max(v(Xe[0]),v(Xe[1]))))+ +(Ve!=="e"):qe-2*(Ve==="%")}(ye[8],he)),se=ye.join("")}else se=",."+Ml(he[2])+"f";return t.format(se)}t.scale.linear=function(){return function Z(ne,se,he,ye){var Le,Ve;function Xe(){var Qe=Math.min(ne.length,se.length)>2?Wu:rl,pt=ye?mn:an;return Le=Qe(ne,se,pt,he),Ve=Qe(se,ne,pt,K),qe}function qe(Qe){return Le(Qe)}return qe.invert=function(Qe){return Ve(Qe)},qe.domain=function(Qe){return arguments.length?(ne=Qe.map(Number),Xe()):ne},qe.range=function(Qe){return arguments.length?(se=Qe,Xe()):se},qe.rangeRound=function(Qe){return qe.range(Qe).interpolate(ir)},qe.clamp=function(Qe){return arguments.length?(ye=Qe,Xe()):ye},qe.interpolate=function(Qe){return arguments.length?(he=Qe,Xe()):he},qe.ticks=function(Qe){return Uc(ne,Qe)},qe.tickFormat=function(Qe,pt){return yc(ne,Qe,pt)},qe.nice=function(Qe){return Zu(ne,Qe),Xe()},qe.copy=function(){return Z(ne,se,he,ye)},Xe()}([0,1],[0,1],K,!1)};var zf={s:1,g:1,p:1,r:1,e:1};function Ml(Z){return-Math.floor(Math.log(Z)/Math.LN10+.01)}t.scale.log=function(){return function Z(ne,se,he,ye){function Le(qe){return(he?Math.log(qe<0?0:qe):-Math.log(qe>0?0:-qe))/Math.log(se)}function Ve(qe){return he?Math.pow(se,qe):-Math.pow(se,-qe)}function Xe(qe){return ne(Le(qe))}return Xe.invert=function(qe){return Ve(ne.invert(qe))},Xe.domain=function(qe){return arguments.length?(he=qe[0]>=0,ne.domain((ye=qe.map(Number)).map(Le)),Xe):ye},Xe.base=function(qe){return arguments.length?(se=+qe,ne.domain(ye.map(Le)),Xe):se},Xe.nice=function(){var qe=vo(ye.map(Le),he?Math:nl);return ne.domain(qe),ye=qe.map(Ve),Xe},Xe.ticks=function(){var qe=So(ye),Qe=[],pt=qe[0],Tt=qe[1],Ct=Math.floor(Le(pt)),jt=Math.ceil(Le(Tt)),nr=se%1?2:se;if(isFinite(jt-Ct)){if(he){for(;Ct<jt;Ct++)for(var Vt=1;Vt<nr;Vt++)Qe.push(Ve(Ct)*Vt);Qe.push(Ve(Ct))}else for(Qe.push(Ve(Ct));Ct++<jt;)for(Vt=nr-1;Vt>0;Vt--)Qe.push(Ve(Ct)*Vt);for(Ct=0;Qe[Ct]<pt;Ct++);for(jt=Qe.length;Qe[jt-1]>Tt;jt--);Qe=Qe.slice(Ct,jt)}return Qe},Xe.tickFormat=function(qe,Qe){if(!arguments.length)return xu;arguments.length<2?Qe=xu:typeof Qe!="function"&&(Qe=t.format(Qe));var pt=Math.max(1,se*qe/Xe.ticks().length);return function(Tt){var Ct=Tt/Ve(Math.round(Le(Tt)));return Ct*se<se-.5&&(Ct*=se),Ct<=pt?Qe(Tt):""}},Xe.copy=function(){return Z(ne.copy(),se,he,ye)},yu(Xe,ne)}(t.scale.linear().domain([0,1]),10,!0,[1,10])};var xu=t.format(".0e"),nl={floor:function(Z){return-Math.ceil(-Z)},ceil:function(Z){return-Math.floor(-Z)}};function al(Z){return function(ne){return ne<0?-Math.pow(-ne,Z):Math.pow(ne,Z)}}t.scale.pow=function(){return function Z(ne,se,he){var ye=al(se),Le=al(1/se);function Ve(Xe){return ne(ye(Xe))}return Ve.invert=function(Xe){return Le(ne.invert(Xe))},Ve.domain=function(Xe){return arguments.length?(ne.domain((he=Xe.map(Number)).map(ye)),Ve):he},Ve.ticks=function(Xe){return Uc(he,Xe)},Ve.tickFormat=function(Xe,qe){return yc(he,Xe,qe)},Ve.nice=function(Xe){return Ve.domain(Zu(he,Xe))},Ve.exponent=function(Xe){return arguments.length?(ye=al(se=Xe),Le=al(1/se),ne.domain(he.map(ye)),Ve):se},Ve.copy=function(){return Z(ne.copy(),se,he)},yu(Ve,ne)}(t.scale.linear(),1,[0,1])},t.scale.sqrt=function(){return t.scale.pow().exponent(.5)},t.scale.ordinal=function(){return function Z(ne,se){var he,ye,Le;function Ve(qe){return ye[((he.get(qe)||(se.t==="range"?he.set(qe,ne.push(qe)):NaN))-1)%ye.length]}function Xe(qe,Qe){return t.range(ne.length).map(function(pt){return qe+Qe*pt})}return Ve.domain=function(qe){if(!arguments.length)return ne;ne=[],he=new A;for(var Qe,pt=-1,Tt=qe.length;++pt<Tt;)he.has(Qe=qe[pt])||he.set(Qe,ne.push(Qe));return Ve[se.t].apply(Ve,se.a)},Ve.range=function(qe){return arguments.length?(ye=qe,Le=0,se={t:"range",a:arguments},Ve):ye},Ve.rangePoints=function(qe,Qe){arguments.length<2&&(Qe=0);var pt=qe[0],Tt=qe[1],Ct=ne.length<2?(pt=(pt+Tt)/2,0):(Tt-pt)/(ne.length-1+Qe);return ye=Xe(pt+Ct*Qe/2,Ct),Le=0,se={t:"rangePoints",a:arguments},Ve},Ve.rangeRoundPoints=function(qe,Qe){arguments.length<2&&(Qe=0);var pt=qe[0],Tt=qe[1],Ct=ne.length<2?(pt=Tt=Math.round((pt+Tt)/2),0):(Tt-pt)/(ne.length-1+Qe)|0;return ye=Xe(pt+Math.round(Ct*Qe/2+(Tt-pt-(ne.length-1+Qe)*Ct)/2),Ct),Le=0,se={t:"rangeRoundPoints",a:arguments},Ve},Ve.rangeBands=function(qe,Qe,pt){arguments.length<2&&(Qe=0),arguments.length<3&&(pt=Qe);var Tt=qe[1]<qe[0],Ct=qe[Tt-0],jt=qe[1-Tt],nr=(jt-Ct)/(ne.length-Qe+2*pt);return ye=Xe(Ct+nr*pt,nr),Tt&&ye.reverse(),Le=nr*(1-Qe),se={t:"rangeBands",a:arguments},Ve},Ve.rangeRoundBands=function(qe,Qe,pt){arguments.length<2&&(Qe=0),arguments.length<3&&(pt=Qe);var Tt=qe[1]<qe[0],Ct=qe[Tt-0],jt=qe[1-Tt],nr=Math.floor((jt-Ct)/(ne.length-Qe+2*pt));return ye=Xe(Ct+Math.round((jt-Ct-(ne.length-Qe)*nr)/2),nr),Tt&&ye.reverse(),Le=Math.round(nr*(1-Qe)),se={t:"rangeRoundBands",a:arguments},Ve},Ve.rangeBand=function(){return Le},Ve.rangeExtent=function(){return So(se.a[0])},Ve.copy=function(){return Z(ne,se)},Ve.domain(ne)}([],{t:"range",a:[[]]})},t.scale.category10=function(){return t.scale.ordinal().range(Df)},t.scale.category20=function(){return t.scale.ordinal().range(Rf)},t.scale.category20b=function(){return t.scale.ordinal().range(Ff)},t.scale.category20c=function(){return t.scale.ordinal().range(Bf)};var Df=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(Ut),Rf=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(Ut),Ff=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(Ut),Bf=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(Ut);function Nf(){return 0}t.scale.quantile=function(){return function Z(ne,se){var he;function ye(){var Ve=0,Xe=se.length;for(he=[];++Ve<Xe;)he[Ve-1]=t.quantile(ne,Ve/Xe);return Le}function Le(Ve){if(!isNaN(Ve=+Ve))return se[t.bisect(he,Ve)]}return Le.domain=function(Ve){return arguments.length?(ne=Ve.map(f).filter(g).sort(c),ye()):ne},Le.range=function(Ve){return arguments.length?(se=Ve,ye()):se},Le.quantiles=function(){return he},Le.invertExtent=function(Ve){return(Ve=se.indexOf(Ve))<0?[NaN,NaN]:[Ve>0?he[Ve-1]:ne[0],Ve<he.length?he[Ve]:ne[ne.length-1]]},Le.copy=function(){return Z(ne,se)},ye()}([],[])},t.scale.quantize=function(){return function Z(ne,se,he){var ye,Le;function Ve(qe){return he[Math.max(0,Math.min(Le,Math.floor(ye*(qe-ne))))]}function Xe(){return ye=he.length/(se-ne),Le=he.length-1,Ve}return Ve.domain=function(qe){return arguments.length?(ne=+qe[0],se=+qe[qe.length-1],Xe()):[ne,se]},Ve.range=function(qe){return arguments.length?(he=qe,Xe()):he},Ve.invertExtent=function(qe){return[qe=(qe=he.indexOf(qe))<0?NaN:qe/ye+ne,qe+1/ye]},Ve.copy=function(){return Z(ne,se,he)},Xe()}(0,1,[0,1])},t.scale.threshold=function(){return function Z(ne,se){function he(ye){if(ye<=ye)return se[t.bisect(ne,ye)]}return he.domain=function(ye){return arguments.length?(ne=ye,he):ne},he.range=function(ye){return arguments.length?(se=ye,he):se},he.invertExtent=function(ye){return ye=se.indexOf(ye),[ne[ye-1],ne[ye]]},he.copy=function(){return Z(ne,se)},he}([.5],[0,1])},t.scale.identity=function(){return function Z(ne){function se(he){return+he}return se.invert=se,se.domain=se.range=function(he){return arguments.length?(ne=he.map(se),se):ne},se.ticks=function(he){return Uc(ne,he)},se.tickFormat=function(he,ye){return yc(ne,he,ye)},se.copy=function(){return Z(ne)},se}([0,1])},t.svg={},t.svg.arc=function(){var Z=jf,ne=bu,se=Nf,he=Vc,ye=Xu,Le=Al,Ve=Uf;function Xe(){var Qe=Math.max(0,+Z.apply(this,arguments)),pt=Math.max(0,+ne.apply(this,arguments)),Tt=ye.apply(this,arguments)-Ye,Ct=Le.apply(this,arguments)-Ye,jt=Math.abs(Ct-Tt),nr=Tt>Ct?0:1;if(pt<Qe&&(Vt=pt,pt=Qe,Qe=Vt),jt>=Ue)return qe(pt,nr)+(Qe?qe(Qe,1-nr):"")+"Z";var Vt,Xt,Ht,pr,Wt,Kt,Cr,tr,mr,wr,Wr,Rr,tn=0,jr=0,ln=[];if((pr=(+Ve.apply(this,arguments)||0)/2)&&(Ht=he===Vc?Math.sqrt(Qe*Qe+pt*pt):+he.apply(this,arguments),nr||(jr*=-1),pt&&(jr=ct(Ht/pt*Math.sin(pr))),Qe&&(tn=ct(Ht/Qe*Math.sin(pr)))),pt){Wt=pt*Math.cos(Tt+jr),Kt=pt*Math.sin(Tt+jr),Cr=pt*Math.cos(Ct-jr),tr=pt*Math.sin(Ct-jr);var Mn=Math.abs(Ct-Tt-2*jr)<=ot?0:1;if(jr&&Ba(Wt,Kt,Cr,tr)===nr^Mn){var An=(Tt+Ct)/2;Wt=pt*Math.cos(An),Kt=pt*Math.sin(An),Cr=tr=null}}else Wt=Kt=0;if(Qe){mr=Qe*Math.cos(Ct-tn),wr=Qe*Math.sin(Ct-tn),Wr=Qe*Math.cos(Tt+tn),Rr=Qe*Math.sin(Tt+tn);var $r=Math.abs(Tt-Ct+2*tn)<=ot?0:1;if(tn&&Ba(mr,wr,Wr,Rr)===1-nr^$r){var Tn=(Tt+Ct)/2;mr=Qe*Math.cos(Tn),wr=Qe*Math.sin(Tn),Wr=Rr=null}}else mr=wr=0;if(jt>Ge&&(Vt=Math.min(Math.abs(pt-Qe)/2,+se.apply(this,arguments)))>.001){Xt=Qe<pt^nr?0:1;var Xn=Vt,Bn=Vt;if(jt<ot){var aa=Wr==null?[mr,wr]:Cr==null?[Wt,Kt]:Za([Wt,Kt],[Wr,Rr],[Cr,tr],[mr,wr]),la=Wt-aa[0],xa=Kt-aa[1],ka=Cr-aa[0],Na=tr-aa[1],ii=1/Math.sin(Math.acos((la*ka+xa*Na)/(Math.sqrt(la*la+xa*xa)*Math.sqrt(ka*ka+Na*Na)))/2),Ki=Math.sqrt(aa[0]*aa[0]+aa[1]*aa[1]);Bn=Math.min(Vt,(Qe-Ki)/(ii-1)),Xn=Math.min(Vt,(pt-Ki)/(ii+1))}if(Cr!=null){var xi=Sl(Wr==null?[mr,wr]:[Wr,Rr],[Wt,Kt],pt,Xn,nr),oi=Sl([Cr,tr],[mr,wr],pt,Xn,nr);Vt===Xn?ln.push("M",xi[0],"A",Xn,",",Xn," 0 0,",Xt," ",xi[1],"A",pt,",",pt," 0 ",1-nr^Ba(xi[1][0],xi[1][1],oi[1][0],oi[1][1]),",",nr," ",oi[1],"A",Xn,",",Xn," 0 0,",Xt," ",oi[0]):ln.push("M",xi[0],"A",Xn,",",Xn," 0 1,",Xt," ",oi[0])}else ln.push("M",Wt,",",Kt);if(Wr!=null){var oo=Sl([Wt,Kt],[Wr,Rr],Qe,-Bn,nr),Vo=Sl([mr,wr],Cr==null?[Wt,Kt]:[Cr,tr],Qe,-Bn,nr);Vt===Bn?ln.push("L",Vo[0],"A",Bn,",",Bn," 0 0,",Xt," ",Vo[1],"A",Qe,",",Qe," 0 ",nr^Ba(Vo[1][0],Vo[1][1],oo[1][0],oo[1][1]),",",1-nr," ",oo[1],"A",Bn,",",Bn," 0 0,",Xt," ",oo[0]):ln.push("L",Vo[0],"A",Bn,",",Bn," 0 0,",Xt," ",oo[0])}else ln.push("L",mr,",",wr)}else ln.push("M",Wt,",",Kt),Cr!=null&&ln.push("A",pt,",",pt," 0 ",Mn,",",nr," ",Cr,",",tr),ln.push("L",mr,",",wr),Wr!=null&&ln.push("A",Qe,",",Qe," 0 ",$r,",",1-nr," ",Wr,",",Rr);return ln.push("Z"),ln.join("")}function qe(Qe,pt){return"M0,"+Qe+"A"+Qe+","+Qe+" 0 1,"+pt+" 0,"+-Qe+"A"+Qe+","+Qe+" 0 1,"+pt+" 0,"+Qe}return Xe.innerRadius=function(Qe){return arguments.length?(Z=Qr(Qe),Xe):Z},Xe.outerRadius=function(Qe){return arguments.length?(ne=Qr(Qe),Xe):ne},Xe.cornerRadius=function(Qe){return arguments.length?(se=Qr(Qe),Xe):se},Xe.padRadius=function(Qe){return arguments.length?(he=Qe==Vc?Vc:Qr(Qe),Xe):he},Xe.startAngle=function(Qe){return arguments.length?(ye=Qr(Qe),Xe):ye},Xe.endAngle=function(Qe){return arguments.length?(Le=Qr(Qe),Xe):Le},Xe.padAngle=function(Qe){return arguments.length?(Ve=Qr(Qe),Xe):Ve},Xe.centroid=function(){var Qe=(+Z.apply(this,arguments)+ +ne.apply(this,arguments))/2,pt=(+ye.apply(this,arguments)+ +Le.apply(this,arguments))/2-Ye;return[Math.cos(pt)*Qe,Math.sin(pt)*Qe]},Xe};var Vc="auto";function jf(Z){return Z.innerRadius}function bu(Z){return Z.outerRadius}function Xu(Z){return Z.startAngle}function Al(Z){return Z.endAngle}function Uf(Z){return Z&&Z.padAngle}function Ba(Z,ne,se,he){return(Z-se)*ne-(ne-he)*Z>0?0:1}function Sl(Z,ne,se,he,ye){var Le=Z[0]-ne[0],Ve=Z[1]-ne[1],Xe=(ye?he:-he)/Math.sqrt(Le*Le+Ve*Ve),qe=Xe*Ve,Qe=-Xe*Le,pt=Z[0]+qe,Tt=Z[1]+Qe,Ct=ne[0]+qe,jt=ne[1]+Qe,nr=(pt+Ct)/2,Vt=(Tt+jt)/2,Xt=Ct-pt,Ht=jt-Tt,pr=Xt*Xt+Ht*Ht,Wt=se-he,Kt=pt*jt-Ct*Tt,Cr=(Ht<0?-1:1)*Math.sqrt(Math.max(0,Wt*Wt*pr-Kt*Kt)),tr=(Kt*Ht-Xt*Cr)/pr,mr=(-Kt*Xt-Ht*Cr)/pr,wr=(Kt*Ht+Xt*Cr)/pr,Wr=(-Kt*Xt+Ht*Cr)/pr,Rr=tr-nr,tn=mr-Vt,jr=wr-nr,ln=Wr-Vt;return Rr*Rr+tn*tn>jr*jr+ln*ln&&(tr=wr,mr=Wr),[[tr-qe,mr-Qe],[tr*se/Wt,mr*se/Wt]]}function _u(Z){var ne=ao,se=Ps,he=ts,ye=yo,Le=ye.key,Ve=.7;function Xe(qe){var Qe,pt=[],Tt=[],Ct=-1,jt=qe.length,nr=Qr(ne),Vt=Qr(se);function Xt(){pt.push("M",ye(Z(Tt),Ve))}for(;++Ct<jt;)he.call(this,Qe=qe[Ct],Ct)?Tt.push([+nr.call(this,Qe,Ct),+Vt.call(this,Qe,Ct)]):Tt.length&&(Xt(),Tt=[]);return Tt.length&&Xt(),pt.length?pt.join(""):null}return Xe.x=function(qe){return arguments.length?(ne=qe,Xe):ne},Xe.y=function(qe){return arguments.length?(se=qe,Xe):se},Xe.defined=function(qe){return arguments.length?(he=qe,Xe):he},Xe.interpolate=function(qe){return arguments.length?(Le=typeof qe=="function"?ye=qe:(ye=Kl.get(qe)||yo).key,Xe):Le},Xe.tension=function(qe){return arguments.length?(Ve=qe,Xe):Ve},Xe}t.svg.line=function(){return _u(I)};var Kl=t.map({linear:yo,"linear-closed":Ql,step:function(Z){for(var ne=0,se=Z.length,he=Z[0],ye=[he[0],",",he[1]];++ne<se;)ye.push("H",(he[0]+(he=Z[ne])[0])/2,"V",he[1]);return se>1&&ye.push("H",he[0]),ye.join("")},"step-before":qc,"step-after":Hc,basis:Gc,"basis-open":function(Z){if(Z.length<4)return yo(Z);for(var ne,se=[],he=-1,ye=Z.length,Le=[0],Ve=[0];++he<3;)ne=Z[he],Le.push(ne[0]),Ve.push(ne[1]);for(se.push(No(ys,Le)+","+No(ys,Ve)),--he;++he<ye;)ne=Z[he],Le.shift(),Le.push(ne[0]),Ve.shift(),Ve.push(ne[1]),wu(se,Le,Ve);return se.join("")},"basis-closed":function(Z){for(var ne,se,he=-1,ye=Z.length,Le=ye+4,Ve=[],Xe=[];++he<4;)se=Z[he%ye],Ve.push(se[0]),Xe.push(se[1]);for(ne=[No(ys,Ve),",",No(ys,Xe)],--he;++he<Le;)se=Z[he%ye],Ve.shift(),Ve.push(se[0]),Xe.shift(),Xe.push(se[1]),wu(ne,Ve,Xe);return ne.join("")},bundle:function(Z,ne){var se=Z.length-1;if(se)for(var he,ye,Le=Z[0][0],Ve=Z[0][1],Xe=Z[se][0]-Le,qe=Z[se][1]-Ve,Qe=-1;++Qe<=se;)he=Z[Qe],ye=Qe/se,he[0]=ne*he[0]+(1-ne)*(Le+ye*Xe),he[1]=ne*he[1]+(1-ne)*(Ve+ye*qe);return Gc(Z)},cardinal:function(Z,ne){return Z.length<3?yo(Z):Z[0]+il(Z,xc(Z,ne))},"cardinal-open":function(Z,ne){return Z.length<4?yo(Z):Z[1]+il(Z.slice(1,-1),xc(Z,ne))},"cardinal-closed":function(Z,ne){return Z.length<3?Ql(Z):Z[0]+il((Z.push(Z[0]),Z),xc([Z[Z.length-2]].concat(Z,[Z[1]]),ne))},monotone:function(Z){return Z.length<3?yo(Z):Z[0]+il(Z,function(ne){for(var se,he,ye,Le,Ve=[],Xe=function(pt){for(var Tt=0,Ct=pt.length-1,jt=[],nr=pt[0],Vt=pt[1],Xt=jt[0]=bc(nr,Vt);++Tt<Ct;)jt[Tt]=(Xt+(Xt=bc(nr=Vt,Vt=pt[Tt+1])))/2;return jt[Tt]=Xt,jt}(ne),qe=-1,Qe=ne.length-1;++qe<Qe;)se=bc(ne[qe],ne[qe+1]),v(se)<Ge?Xe[qe]=Xe[qe+1]=0:(he=Xe[qe]/se,ye=Xe[qe+1]/se,(Le=he*he+ye*ye)>9&&(Le=3*se/Math.sqrt(Le),Xe[qe]=Le*he,Xe[qe+1]=Le*ye));for(qe=-1;++qe<=Qe;)Le=(ne[Math.min(Qe,qe+1)][0]-ne[Math.max(0,qe-1)][0])/(6*(1+Xe[qe]*Xe[qe])),Ve.push([Le||0,Xe[qe]*Le||0]);return Ve}(Z))}});function yo(Z){return Z.length>1?Z.join("L"):Z+"Z"}function Ql(Z){return Z.join("L")+"Z"}function qc(Z){for(var ne=0,se=Z.length,he=Z[0],ye=[he[0],",",he[1]];++ne<se;)ye.push("V",(he=Z[ne])[1],"H",he[0]);return ye.join("")}function Hc(Z){for(var ne=0,se=Z.length,he=Z[0],ye=[he[0],",",he[1]];++ne<se;)ye.push("H",(he=Z[ne])[0],"V",he[1]);return ye.join("")}function il(Z,ne){if(ne.length<1||Z.length!=ne.length&&Z.length!=ne.length+2)return yo(Z);var se=Z.length!=ne.length,he="",ye=Z[0],Le=Z[1],Ve=ne[0],Xe=Ve,qe=1;if(se&&(he+="Q"+(Le[0]-2*Ve[0]/3)+","+(Le[1]-2*Ve[1]/3)+","+Le[0]+","+Le[1],ye=Z[1],qe=2),ne.length>1){Xe=ne[1],Le=Z[qe],qe++,he+="C"+(ye[0]+Ve[0])+","+(ye[1]+Ve[1])+","+(Le[0]-Xe[0])+","+(Le[1]-Xe[1])+","+Le[0]+","+Le[1];for(var Qe=2;Qe<ne.length;Qe++,qe++)Le=Z[qe],Xe=ne[Qe],he+="S"+(Le[0]-Xe[0])+","+(Le[1]-Xe[1])+","+Le[0]+","+Le[1]}if(se){var pt=Z[qe];he+="Q"+(Le[0]+2*Xe[0]/3)+","+(Le[1]+2*Xe[1]/3)+","+pt[0]+","+pt[1]}return he}function xc(Z,ne){for(var se,he=[],ye=(1-ne)/2,Le=Z[0],Ve=Z[1],Xe=1,qe=Z.length;++Xe<qe;)se=Le,Le=Ve,Ve=Z[Xe],he.push([ye*(Ve[0]-se[0]),ye*(Ve[1]-se[1])]);return he}function Gc(Z){if(Z.length<3)return yo(Z);var ne=1,se=Z.length,he=Z[0],ye=he[0],Le=he[1],Ve=[ye,ye,ye,(he=Z[1])[0]],Xe=[Le,Le,Le,he[1]],qe=[ye,",",Le,"L",No(ys,Ve),",",No(ys,Xe)];for(Z.push(Z[se-1]);++ne<=se;)he=Z[ne],Ve.shift(),Ve.push(he[0]),Xe.shift(),Xe.push(he[1]),wu(qe,Ve,Xe);return Z.pop(),qe.push("L",he),qe.join("")}function No(Z,ne){return Z[0]*ne[0]+Z[1]*ne[1]+Z[2]*ne[2]+Z[3]*ne[3]}Kl.forEach(function(Z,ne){ne.key=Z,ne.closed=/-closed$/.test(Z)});var $l=[0,2/3,1/3,0],Ju=[0,1/3,2/3,0],ys=[0,1/6,2/3,1/6];function wu(Z,ne,se){Z.push("C",No($l,ne),",",No($l,se),",",No(Ju,ne),",",No(Ju,se),",",No(ys,ne),",",No(ys,se))}function bc(Z,ne){return(ne[1]-Z[1])/(ne[0]-Z[0])}function Yc(Z){for(var ne,se,he,ye=-1,Le=Z.length;++ye<Le;)se=(ne=Z[ye])[0],he=ne[1]-Ye,ne[0]=se*Math.cos(he),ne[1]=se*Math.sin(he);return Z}function jo(Z){var ne=ao,se=ao,he=0,ye=Ps,Le=ts,Ve=yo,Xe=Ve.key,qe=Ve,Qe="L",pt=.7;function Tt(Ct){var jt,nr,Vt,Xt=[],Ht=[],pr=[],Wt=-1,Kt=Ct.length,Cr=Qr(ne),tr=Qr(he),mr=ne===se?function(){return nr}:Qr(se),wr=he===ye?function(){return Vt}:Qr(ye);function Wr(){Xt.push("M",Ve(Z(pr),pt),Qe,qe(Z(Ht.reverse()),pt),"Z")}for(;++Wt<Kt;)Le.call(this,jt=Ct[Wt],Wt)?(Ht.push([nr=+Cr.call(this,jt,Wt),Vt=+tr.call(this,jt,Wt)]),pr.push([+mr.call(this,jt,Wt),+wr.call(this,jt,Wt)])):Ht.length&&(Wr(),Ht=[],pr=[]);return Ht.length&&Wr(),Xt.length?Xt.join(""):null}return Tt.x=function(Ct){return arguments.length?(ne=se=Ct,Tt):se},Tt.x0=function(Ct){return arguments.length?(ne=Ct,Tt):ne},Tt.x1=function(Ct){return arguments.length?(se=Ct,Tt):se},Tt.y=function(Ct){return arguments.length?(he=ye=Ct,Tt):ye},Tt.y0=function(Ct){return arguments.length?(he=Ct,Tt):he},Tt.y1=function(Ct){return arguments.length?(ye=Ct,Tt):ye},Tt.defined=function(Ct){return arguments.length?(Le=Ct,Tt):Le},Tt.interpolate=function(Ct){return arguments.length?(Xe=typeof Ct=="function"?Ve=Ct:(Ve=Kl.get(Ct)||yo).key,qe=Ve.reverse||Ve,Qe=Ve.closed?"M":"L",Tt):Xe},Tt.tension=function(Ct){return arguments.length?(pt=Ct,Tt):pt},Tt}function Vf(Z){return Z.radius}function Ku(Z){return[Z.x,Z.y]}function qf(Z){return function(){var ne=Z.apply(this,arguments),se=ne[0],he=ne[1]-Ye;return[se*Math.cos(he),se*Math.sin(he)]}}function Qu(){return 64}function $u(){return"circle"}function El(Z){var ne=Math.sqrt(Z/ot);return"M0,"+ne+"A"+ne+","+ne+" 0 1,1 0,"+-ne+"A"+ne+","+ne+" 0 1,1 0,"+ne+"Z"}t.svg.line.radial=function(){var Z=_u(Yc);return Z.radius=Z.x,delete Z.x,Z.angle=Z.y,delete Z.y,Z},qc.reverse=Hc,Hc.reverse=qc,t.svg.area=function(){return jo(I)},t.svg.area.radial=function(){var Z=jo(Yc);return Z.radius=Z.x,delete Z.x,Z.innerRadius=Z.x0,delete Z.x0,Z.outerRadius=Z.x1,delete Z.x1,Z.angle=Z.y,delete Z.y,Z.startAngle=Z.y0,delete Z.y0,Z.endAngle=Z.y1,delete Z.y1,Z},t.svg.chord=function(){var Z=ro,ne=Zi,se=Vf,he=Xu,ye=Al;function Le(Qe,pt){var Tt,Ct,jt=Ve(this,Z,Qe,pt),nr=Ve(this,ne,Qe,pt);return"M"+jt.p0+Xe(jt.r,jt.p1,jt.a1-jt.a0)+(Ct=nr,((Tt=jt).a0==Ct.a0&&Tt.a1==Ct.a1?qe(jt.r,jt.p1,jt.r,jt.p0):qe(jt.r,jt.p1,nr.r,nr.p0)+Xe(nr.r,nr.p1,nr.a1-nr.a0)+qe(nr.r,nr.p1,jt.r,jt.p0))+"Z")}function Ve(Qe,pt,Tt,Ct){var jt=pt.call(Qe,Tt,Ct),nr=se.call(Qe,jt,Ct),Vt=he.call(Qe,jt,Ct)-Ye,Xt=ye.call(Qe,jt,Ct)-Ye;return{r:nr,a0:Vt,a1:Xt,p0:[nr*Math.cos(Vt),nr*Math.sin(Vt)],p1:[nr*Math.cos(Xt),nr*Math.sin(Xt)]}}function Xe(Qe,pt,Tt){return"A"+Qe+","+Qe+" 0 "+ +(Tt>ot)+",1 "+pt}function qe(Qe,pt,Tt,Ct){return"Q 0,0 "+Ct}return Le.radius=function(Qe){return arguments.length?(se=Qr(Qe),Le):se},Le.source=function(Qe){return arguments.length?(Z=Qr(Qe),Le):Z},Le.target=function(Qe){return arguments.length?(ne=Qr(Qe),Le):ne},Le.startAngle=function(Qe){return arguments.length?(he=Qr(Qe),Le):he},Le.endAngle=function(Qe){return arguments.length?(ye=Qr(Qe),Le):ye},Le},t.svg.diagonal=function(){var Z=ro,ne=Zi,se=Ku;function he(ye,Le){var Ve=Z.call(this,ye,Le),Xe=ne.call(this,ye,Le),qe=(Ve.y+Xe.y)/2,Qe=[Ve,{x:Ve.x,y:qe},{x:Xe.x,y:qe},Xe];return"M"+(Qe=Qe.map(se))[0]+"C"+Qe[1]+" "+Qe[2]+" "+Qe[3]}return he.source=function(ye){return arguments.length?(Z=Qr(ye),he):Z},he.target=function(ye){return arguments.length?(ne=Qr(ye),he):ne},he.projection=function(ye){return arguments.length?(se=ye,he):se},he},t.svg.diagonal.radial=function(){var Z=t.svg.diagonal(),ne=Ku,se=Z.projection;return Z.projection=function(he){return arguments.length?se(qf(ne=he)):ne},Z},t.svg.symbol=function(){var Z=$u,ne=Qu;function se(he,ye){return(ef.get(Z.call(this,he,ye))||El)(ne.call(this,he,ye))}return se.type=function(he){return arguments.length?(Z=Qr(he),se):Z},se.size=function(he){return arguments.length?(ne=Qr(he),se):ne},se};var ef=t.map({circle:El,cross:function(Z){var ne=Math.sqrt(Z/5)/2;return"M"+-3*ne+","+-ne+"H"+-ne+"V"+-3*ne+"H"+ne+"V"+-ne+"H"+3*ne+"V"+ne+"H"+ne+"V"+3*ne+"H"+-ne+"V"+ne+"H"+-3*ne+"Z"},diamond:function(Z){var ne=Math.sqrt(Z/(2*Tu)),se=ne*Tu;return"M0,"+-ne+"L"+se+",0 0,"+ne+" "+-se+",0Z"},square:function(Z){var ne=Math.sqrt(Z)/2;return"M"+-ne+","+-ne+"L"+ne+","+-ne+" "+ne+","+ne+" "+-ne+","+ne+"Z"},"triangle-down":function(Z){var ne=Math.sqrt(Z/Wc),se=ne*Wc/2;return"M0,"+se+"L"+ne+","+-se+" "+-ne+","+-se+"Z"},"triangle-up":function(Z){var ne=Math.sqrt(Z/Wc),se=ne*Wc/2;return"M0,"+-se+"L"+ne+","+se+" "+-ne+","+se+"Z"}});t.svg.symbolTypes=ef.keys();var Wc=Math.sqrt(3),Tu=Math.tan(30*xe);ie.transition=function(Z){for(var ne,se,he=Uo||++ec,ye=ku(Z),Le=[],Ve=Zc||{time:Date.now(),ease:Gt,delay:0,duration:250},Xe=-1,qe=this.length;++Xe<qe;){Le.push(ne=[]);for(var Qe=this[Xe],pt=-1,Tt=Qe.length;++pt<Tt;)(se=Qe[pt])&&Xc(se,pt,ye,he,Ve),ne.push(se)}return wc(Le,ye,he)},ie.interrupt=function(Z){return this.each(Z==null?_c:tf(ku(Z)))};var _c=tf(ku());function tf(Z){return function(){var ne,se,he;(ne=this[Z])&&(he=ne[se=ne.active])&&(he.timer.c=null,he.timer.t=NaN,--ne.count?delete ne[se]:delete this[Z],ne.active+=.5,he.event&&he.event.interrupt.call(this,this.__data__,he.index))}}function wc(Z,ne,se){return G(Z,Ka),Z.namespace=ne,Z.id=se,Z}var Uo,Zc,Ka=[],ec=0;function Eo(Z,ne,se,he){var ye=Z.id,Le=Z.namespace;return ze(Z,typeof se=="function"?function(Ve,Xe,qe){Ve[Le][ye].tween.set(ne,he(se.call(Ve,Ve.__data__,Xe,qe)))}:(se=he(se),function(Ve){Ve[Le][ye].tween.set(ne,se)}))}function Hf(Z){return Z==null&&(Z=""),function(){this.textContent=Z}}function ku(Z){return Z==null?"__transition__":"__transition_"+Z+"__"}function Xc(Z,ne,se,he,ye){var Le,Ve,Xe,qe,Qe,pt=Z[se]||(Z[se]={active:0,count:0}),Tt=pt[he];function Ct(nr){var Vt=pt.active,Xt=pt[Vt];for(var Ht in Xt&&(Xt.timer.c=null,Xt.timer.t=NaN,--pt.count,delete pt[Vt],Xt.event&&Xt.event.interrupt.call(Z,Z.__data__,Xt.index)),pt)if(+Ht<he){var pr=pt[Ht];pr.timer.c=null,pr.timer.t=NaN,--pt.count,delete pt[Ht]}Ve.c=jt,Zr(function(){return Ve.c&&jt(nr||1)&&(Ve.c=null,Ve.t=NaN),1},0,Le),pt.active=he,Tt.event&&Tt.event.start.call(Z,Z.__data__,ne),Qe=[],Tt.tween.forEach(function(Wt,Kt){(Kt=Kt.call(Z,Z.__data__,ne))&&Qe.push(Kt)}),qe=Tt.ease,Xe=Tt.duration}function jt(nr){for(var Vt=nr/Xe,Xt=qe(Vt),Ht=Qe.length;Ht>0;)Qe[--Ht].call(Z,Xt);if(Vt>=1)return Tt.event&&Tt.event.end.call(Z,Z.__data__,ne),--pt.count?delete pt[he]:delete Z[se],1}Tt||(Le=ye.time,Ve=Zr(function(nr){var Vt=Tt.delay;if(Ve.t=Vt+Le,Vt<=nr)return Ct(nr-Vt);Ve.c=Ct},0,Le),Tt=pt[he]={tween:new A,time:Le,timer:Ve,delay:ye.delay,duration:ye.duration,ease:ye.ease,index:ne},ye=null,++pt.count)}Ka.call=ie.call,Ka.empty=ie.empty,Ka.node=ie.node,Ka.size=ie.size,t.transition=function(Z,ne){return Z&&Z.transition?Uo?Z.transition(ne):Z:t.selection().transition(Z)},t.transition.prototype=Ka,Ka.select=function(Z){var ne,se,he,ye=this.id,Le=this.namespace,Ve=[];Z=ae(Z);for(var Xe=-1,qe=this.length;++Xe<qe;){Ve.push(ne=[]);for(var Qe=this[Xe],pt=-1,Tt=Qe.length;++pt<Tt;)(he=Qe[pt])&&(se=Z.call(he,he.__data__,pt,Xe))?("__data__"in he&&(se.__data__=he.__data__),Xc(se,pt,Le,ye,he[Le][ye]),ne.push(se)):ne.push(null)}return wc(Ve,Le,ye)},Ka.selectAll=function(Z){var ne,se,he,ye,Le,Ve=this.id,Xe=this.namespace,qe=[];Z=oe(Z);for(var Qe=-1,pt=this.length;++Qe<pt;)for(var Tt=this[Qe],Ct=-1,jt=Tt.length;++Ct<jt;)if(he=Tt[Ct]){Le=he[Xe][Ve],se=Z.call(he,he.__data__,Ct,Qe),qe.push(ne=[]);for(var nr=-1,Vt=se.length;++nr<Vt;)(ye=se[nr])&&Xc(ye,nr,Xe,Ve,Le),ne.push(ye)}return wc(qe,Xe,Ve)},Ka.filter=function(Z){var ne,se,he=[];typeof Z!="function"&&(Z=Pe(Z));for(var ye=0,Le=this.length;ye<Le;ye++){he.push(ne=[]);for(var Ve,Xe=0,qe=(Ve=this[ye]).length;Xe<qe;Xe++)(se=Ve[Xe])&&Z.call(se,se.__data__,Xe,ye)&&ne.push(se)}return wc(he,this.namespace,this.id)},Ka.tween=function(Z,ne){var se=this.id,he=this.namespace;return arguments.length<2?this.node()[he][se].tween.get(Z):ze(this,ne==null?function(ye){ye[he][se].tween.remove(Z)}:function(ye){ye[he][se].tween.set(Z,ne)})},Ka.attr=function(Z,ne){if(arguments.length<2){for(ne in Z)this.attr(ne,Z[ne]);return this}var se=Z=="transform"?Yr:K,he=t.ns.qualify(Z);function ye(){this.removeAttribute(he)}function Le(){this.removeAttributeNS(he.space,he.local)}function Ve(qe){return qe==null?ye:(qe+="",function(){var Qe,pt=this.getAttribute(he);return pt!==qe&&(Qe=se(pt,qe),function(Tt){this.setAttribute(he,Qe(Tt))})})}function Xe(qe){return qe==null?Le:(qe+="",function(){var Qe,pt=this.getAttributeNS(he.space,he.local);return pt!==qe&&(Qe=se(pt,qe),function(Tt){this.setAttributeNS(he.space,he.local,Qe(Tt))})})}return Eo(this,"attr."+Z,ne,he.local?Xe:Ve)},Ka.attrTween=function(Z,ne){var se=t.ns.qualify(Z);return this.tween("attr."+Z,se.local?function(he,ye){var Le=ne.call(this,he,ye,this.getAttributeNS(se.space,se.local));return Le&&function(Ve){this.setAttributeNS(se.space,se.local,Le(Ve))}}:function(he,ye){var Le=ne.call(this,he,ye,this.getAttribute(se));return Le&&function(Ve){this.setAttribute(se,Le(Ve))}})},Ka.style=function(Z,ne,se){var he=arguments.length;if(he<3){if(typeof Z!="string"){for(se in he<2&&(ne=""),Z)this.style(se,Z[se],ne);return this}se=""}function ye(){this.style.removeProperty(Z)}function Le(Ve){return Ve==null?ye:(Ve+="",function(){var Xe,qe=o(this).getComputedStyle(this,null).getPropertyValue(Z);return qe!==Ve&&(Xe=K(qe,Ve),function(Qe){this.style.setProperty(Z,Xe(Qe),se)})})}return Eo(this,"style."+Z,ne,Le)},Ka.styleTween=function(Z,ne,se){function he(ye,Le){var Ve=ne.call(this,ye,Le,o(this).getComputedStyle(this,null).getPropertyValue(Z));return Ve&&function(Xe){this.style.setProperty(Z,Ve(Xe),se)}}return arguments.length<3&&(se=""),this.tween("style."+Z,he)},Ka.text=function(Z){return Eo(this,"text",Z,Hf)},Ka.remove=function(){var Z=this.namespace;return this.each("end.transition",function(){var ne;this[Z].count<2&&(ne=this.parentNode)&&ne.removeChild(this)})},Ka.ease=function(Z){var ne=this.id,se=this.namespace;return arguments.length<1?this.node()[se][ne].ease:(typeof Z!="function"&&(Z=t.ease.apply(t,arguments)),ze(this,function(he){he[se][ne].ease=Z}))},Ka.delay=function(Z){var ne=this.id,se=this.namespace;return arguments.length<1?this.node()[se][ne].delay:ze(this,typeof Z=="function"?function(he,ye,Le){he[se][ne].delay=+Z.call(he,he.__data__,ye,Le)}:(Z=+Z,function(he){he[se][ne].delay=Z}))},Ka.duration=function(Z){var ne=this.id,se=this.namespace;return arguments.length<1?this.node()[se][ne].duration:ze(this,typeof Z=="function"?function(he,ye,Le){he[se][ne].duration=Math.max(1,Z.call(he,he.__data__,ye,Le))}:(Z=Math.max(1,Z),function(he){he[se][ne].duration=Z}))},Ka.each=function(Z,ne){var se=this.id,he=this.namespace;if(arguments.length<2){var ye=Zc,Le=Uo;try{Uo=se,ze(this,function(Ve,Xe,qe){Zc=Ve[he][se],Z.call(Ve,Ve.__data__,Xe,qe)})}finally{Zc=ye,Uo=Le}}else ze(this,function(Ve){var Xe=Ve[he][se];(Xe.event||(Xe.event=t.dispatch("start","end","interrupt"))).on(Z,ne)});return this},Ka.transition=function(){for(var Z,ne,se,he=this.id,ye=++ec,Le=this.namespace,Ve=[],Xe=0,qe=this.length;Xe<qe;Xe++){Ve.push(Z=[]);for(var Qe,pt=0,Tt=(Qe=this[Xe]).length;pt<Tt;pt++)(ne=Qe[pt])&&Xc(ne,pt,Le,ye,{time:(se=ne[Le][he]).time,ease:se.ease,delay:se.delay+se.duration,duration:se.duration}),Z.push(ne)}return wc(Ve,Le,ye)},t.svg.axis=function(){var Z,ne=t.scale.linear(),se=tc,he=6,ye=6,Le=3,Ve=[10],Xe=null;function qe(Qe){Qe.each(function(){var pt,Tt=t.select(this),Ct=this.__chart__||ne,jt=this.__chart__=ne.copy(),nr=Xe??(jt.ticks?jt.ticks.apply(jt,Ve):jt.domain()),Vt=Z??(jt.tickFormat?jt.tickFormat.apply(jt,Ve):I),Xt=Tt.selectAll(".tick").data(nr,jt),Ht=Xt.enter().insert("g",".domain").attr("class","tick").style("opacity",Ge),pr=t.transition(Xt.exit()).style("opacity",Ge).remove(),Wt=t.transition(Xt.order()).style("opacity",1),Kt=Math.max(he,0)+Le,Cr=kl(jt),tr=Tt.selectAll(".domain").data([0]),mr=(tr.enter().append("path").attr("class","domain"),t.transition(tr));Ht.append("line"),Ht.append("text");var wr,Wr,Rr,tn,jr=Ht.select("line"),ln=Wt.select("line"),Mn=Xt.select("text").text(Vt),An=Ht.select("text"),$r=Wt.select("text"),Tn=se==="top"||se==="left"?-1:1;if(se==="bottom"||se==="top"?(pt=nf,wr="x",Rr="y",Wr="x2",tn="y2",Mn.attr("dy",Tn<0?"0em":".71em").style("text-anchor","middle"),mr.attr("d","M"+Cr[0]+","+Tn*ye+"V0H"+Cr[1]+"V"+Tn*ye)):(pt=Gf,wr="y",Rr="x",Wr="y2",tn="x2",Mn.attr("dy",".32em").style("text-anchor",Tn<0?"end":"start"),mr.attr("d","M"+Tn*ye+","+Cr[0]+"H0V"+Cr[1]+"H"+Tn*ye)),jr.attr(tn,Tn*he),An.attr(Rr,Tn*Kt),ln.attr(Wr,0).attr(tn,Tn*he),$r.attr(wr,0).attr(Rr,Tn*Kt),jt.rangeBand){var Xn=jt,Bn=Xn.rangeBand()/2;Ct=jt=function(aa){return Xn(aa)+Bn}}else Ct.rangeBand?Ct=jt:pr.call(pt,jt,Ct);Ht.call(pt,Ct,jt),Wt.call(pt,jt,jt)})}return qe.scale=function(Qe){return arguments.length?(ne=Qe,qe):ne},qe.orient=function(Qe){return arguments.length?(se=Qe in rf?Qe+"":tc,qe):se},qe.ticks=function(){return arguments.length?(Ve=p(arguments),qe):Ve},qe.tickValues=function(Qe){return arguments.length?(Xe=Qe,qe):Xe},qe.tickFormat=function(Qe){return arguments.length?(Z=Qe,qe):Z},qe.tickSize=function(Qe){var pt=arguments.length;return pt?(he=+Qe,ye=+arguments[pt-1],qe):he},qe.innerTickSize=function(Qe){return arguments.length?(he=+Qe,qe):he},qe.outerTickSize=function(Qe){return arguments.length?(ye=+Qe,qe):ye},qe.tickPadding=function(Qe){return arguments.length?(Le=+Qe,qe):Le},qe.tickSubdivide=function(){return arguments.length&&qe},qe};var tc="bottom",rf={top:1,right:1,bottom:1,left:1};function nf(Z,ne,se){Z.attr("transform",function(he){var ye=ne(he);return"translate("+(isFinite(ye)?ye:se(he))+",0)"})}function Gf(Z,ne,se){Z.attr("transform",function(he){var ye=ne(he);return"translate(0,"+(isFinite(ye)?ye:se(he))+")"})}t.svg.brush=function(){var Z,ne,se=H(pt,"brushstart","brush","brushend"),he=null,ye=null,Le=[0,0],Ve=[0,0],Xe=!0,qe=!0,Qe=Jc[0];function pt(Vt){Vt.each(function(){var Xt=t.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",nr).on("touchstart.brush",nr),Ht=Xt.selectAll(".background").data([0]);Ht.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),Xt.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var pr=Xt.selectAll(".resize").data(Qe,I);pr.exit().remove(),pr.enter().append("g").attr("class",function(tr){return"resize "+tr}).style("cursor",function(tr){return Yf[tr]}).append("rect").attr("x",function(tr){return/[ew]$/.test(tr)?-3:null}).attr("y",function(tr){return/^[ns]/.test(tr)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),pr.style("display",pt.empty()?"none":null);var Wt,Kt=t.transition(Xt),Cr=t.transition(Ht);he&&(Wt=kl(he),Cr.attr("x",Wt[0]).attr("width",Wt[1]-Wt[0]),Ct(Kt)),ye&&(Wt=kl(ye),Cr.attr("y",Wt[0]).attr("height",Wt[1]-Wt[0]),jt(Kt)),Tt(Kt)})}function Tt(Vt){Vt.selectAll(".resize").attr("transform",function(Xt){return"translate("+Le[+/e$/.test(Xt)]+","+Ve[+/^s/.test(Xt)]+")"})}function Ct(Vt){Vt.select(".extent").attr("x",Le[0]),Vt.selectAll(".extent,.n>rect,.s>rect").attr("width",Le[1]-Le[0])}function jt(Vt){Vt.select(".extent").attr("y",Ve[0]),Vt.selectAll(".extent,.e>rect,.w>rect").attr("height",Ve[1]-Ve[0])}function nr(){var Vt,Xt,Ht=this,pr=t.select(t.event.target),Wt=se.of(Ht,arguments),Kt=t.select(Ht),Cr=pr.datum(),tr=!/^(n|s)$/.test(Cr)&&he,mr=!/^(e|w)$/.test(Cr)&&ye,wr=pr.classed("extent"),Wr=gt(Ht),Rr=t.mouse(Ht),tn=t.select(o(Ht)).on("keydown.brush",Mn).on("keyup.brush",An);if(t.event.changedTouches?tn.on("touchmove.brush",$r).on("touchend.brush",Xn):tn.on("mousemove.brush",$r).on("mouseup.brush",Xn),Kt.interrupt().selectAll("*").interrupt(),wr)Rr[0]=Le[0]-Rr[0],Rr[1]=Ve[0]-Rr[1];else if(Cr){var jr=+/w$/.test(Cr),ln=+/^n/.test(Cr);Xt=[Le[1-jr]-Rr[0],Ve[1-ln]-Rr[1]],Rr[0]=Le[jr],Rr[1]=Ve[ln]}else t.event.altKey&&(Vt=Rr.slice());function Mn(){t.event.keyCode==32&&(wr||(Vt=null,Rr[0]-=Le[1],Rr[1]-=Ve[1],wr=2),N())}function An(){t.event.keyCode==32&&wr==2&&(Rr[0]+=Le[1],Rr[1]+=Ve[1],wr=0,N())}function $r(){var Bn=t.mouse(Ht),aa=!1;Xt&&(Bn[0]+=Xt[0],Bn[1]+=Xt[1]),wr||(t.event.altKey?(Vt||(Vt=[(Le[0]+Le[1])/2,(Ve[0]+Ve[1])/2]),Rr[0]=Le[+(Bn[0]<Vt[0])],Rr[1]=Ve[+(Bn[1]<Vt[1])]):Vt=null),tr&&Tn(Bn,he,0)&&(Ct(Kt),aa=!0),mr&&Tn(Bn,ye,1)&&(jt(Kt),aa=!0),aa&&(Tt(Kt),Wt({type:"brush",mode:wr?"move":"resize"}))}function Tn(Bn,aa,la){var xa,ka,Na=kl(aa),ii=Na[0],Ki=Na[1],xi=Rr[la],oi=la?Ve:Le,oo=oi[1]-oi[0];if(wr&&(ii-=xi,Ki-=oo+xi),xa=(la?qe:Xe)?Math.max(ii,Math.min(Ki,Bn[la])):Bn[la],wr?ka=(xa+=xi)+oo:(Vt&&(xi=Math.max(ii,Math.min(Ki,2*Vt[la]-xa))),xi<xa?(ka=xa,xa=xi):ka=xi),oi[0]!=xa||oi[1]!=ka)return la?ne=null:Z=null,oi[0]=xa,oi[1]=ka,!0}function Xn(){$r(),Kt.style("pointer-events","all").selectAll(".resize").style("display",pt.empty()?"none":null),t.select("body").style("cursor",null),tn.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),Wr(),Wt({type:"brushend"})}Kt.style("pointer-events","none").selectAll(".resize").style("display",null),t.select("body").style("cursor",pr.style("cursor")),Wt({type:"brushstart"}),$r()}return pt.event=function(Vt){Vt.each(function(){var Xt=se.of(this,arguments),Ht={x:Le,y:Ve,i:Z,j:ne},pr=this.__chart__||Ht;this.__chart__=Ht,Uo?t.select(this).transition().each("start.brush",function(){Z=pr.i,ne=pr.j,Le=pr.x,Ve=pr.y,Xt({type:"brushstart"})}).tween("brush:brush",function(){var Wt=X(Le,Ht.x),Kt=X(Ve,Ht.y);return Z=ne=null,function(Cr){Le=Ht.x=Wt(Cr),Ve=Ht.y=Kt(Cr),Xt({type:"brush",mode:"resize"})}}).each("end.brush",function(){Z=Ht.i,ne=Ht.j,Xt({type:"brush",mode:"resize"}),Xt({type:"brushend"})}):(Xt({type:"brushstart"}),Xt({type:"brush",mode:"resize"}),Xt({type:"brushend"}))})},pt.x=function(Vt){return arguments.length?(Qe=Jc[!(he=Vt)<<1|!ye],pt):he},pt.y=function(Vt){return arguments.length?(Qe=Jc[!he<<1|!(ye=Vt)],pt):ye},pt.clamp=function(Vt){return arguments.length?(he&&ye?(Xe=!!Vt[0],qe=!!Vt[1]):he?Xe=!!Vt:ye&&(qe=!!Vt),pt):he&&ye?[Xe,qe]:he?Xe:ye?qe:null},pt.extent=function(Vt){var Xt,Ht,pr,Wt,Kt;return arguments.length?(he&&(Xt=Vt[0],Ht=Vt[1],ye&&(Xt=Xt[0],Ht=Ht[0]),Z=[Xt,Ht],he.invert&&(Xt=he(Xt),Ht=he(Ht)),Ht<Xt&&(Kt=Xt,Xt=Ht,Ht=Kt),Xt==Le[0]&&Ht==Le[1]||(Le=[Xt,Ht])),ye&&(pr=Vt[0],Wt=Vt[1],he&&(pr=pr[1],Wt=Wt[1]),ne=[pr,Wt],ye.invert&&(pr=ye(pr),Wt=ye(Wt)),Wt<pr&&(Kt=pr,pr=Wt,Wt=Kt),pr==Ve[0]&&Wt==Ve[1]||(Ve=[pr,Wt])),pt):(he&&(Z?(Xt=Z[0],Ht=Z[1]):(Xt=Le[0],Ht=Le[1],he.invert&&(Xt=he.invert(Xt),Ht=he.invert(Ht)),Ht<Xt&&(Kt=Xt,Xt=Ht,Ht=Kt))),ye&&(ne?(pr=ne[0],Wt=ne[1]):(pr=Ve[0],Wt=Ve[1],ye.invert&&(pr=ye.invert(pr),Wt=ye.invert(Wt)),Wt<pr&&(Kt=pr,pr=Wt,Wt=Kt))),he&&ye?[[Xt,pr],[Ht,Wt]]:he?[Xt,Ht]:ye&&[pr,Wt])},pt.clear=function(){return pt.empty()||(Le=[0,0],Ve=[0,0],Z=ne=null),pt},pt.empty=function(){return!!he&&Le[0]==Le[1]||!!ye&&Ve[0]==Ve[1]},t.rebind(pt,se,"on")};var Yf={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},Jc=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]],zi=Mr.format=Ua.timeFormat,af=zi.utc,Mu=af("%Y-%m-%dT%H:%M:%S.%LZ");function Kc(Z){return Z.toISOString()}function Au(Z,ne,se){function he(Le){return Z(Le)}function ye(Le,Ve){var Xe=(Le[1]-Le[0])/Ve,qe=t.bisect(rc,Xe);return qe==rc.length?[ne.year,Jl(Le.map(function(Qe){return Qe/31536e6}),Ve)[2]]:qe?ne[Xe/rc[qe-1]<rc[qe]/Xe?qe-1:qe]:[of,Jl(Le,Ve)[2]]}return he.invert=function(Le){return ol(Z.invert(Le))},he.domain=function(Le){return arguments.length?(Z.domain(Le),he):Z.domain().map(ol)},he.nice=function(Le,Ve){var Xe=he.domain(),qe=So(Xe),Qe=Le==null?ye(qe,10):typeof Le=="number"&&ye(qe,Le);function pt(Tt){return!isNaN(Tt)&&!Le.range(Tt,ol(+Tt+1),Ve).length}return Qe&&(Le=Qe[0],Ve=Qe[1]),he.domain(vo(Xe,Ve>1?{floor:function(Tt){for(;pt(Tt=Le.floor(Tt));)Tt=ol(Tt-1);return Tt},ceil:function(Tt){for(;pt(Tt=Le.ceil(Tt));)Tt=ol(+Tt+1);return Tt}}:Le))},he.ticks=function(Le,Ve){var Xe=So(he.domain()),qe=Le==null?ye(Xe,10):typeof Le=="number"?ye(Xe,Le):!Le.range&&[{range:Le},Ve];return qe&&(Le=qe[0],Ve=qe[1]),Le.range(Xe[0],ol(+Xe[1]+1),Ve<1?1:Ve)},he.tickFormat=function(){return se},he.copy=function(){return Au(Z.copy(),ne,se)},yu(he,Z)}function ol(Z){return new Date(Z)}zi.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?Kc:Mu,Kc.parse=function(Z){var ne=new Date(Z);return isNaN(ne)?null:ne},Kc.toString=Mu.toString,Mr.second=fr(function(Z){return new xr(1e3*Math.floor(Z/1e3))},function(Z,ne){Z.setTime(Z.getTime()+1e3*Math.floor(ne))},function(Z){return Z.getSeconds()}),Mr.seconds=Mr.second.range,Mr.seconds.utc=Mr.second.utc.range,Mr.minute=fr(function(Z){return new xr(6e4*Math.floor(Z/6e4))},function(Z,ne){Z.setTime(Z.getTime()+6e4*Math.floor(ne))},function(Z){return Z.getMinutes()}),Mr.minutes=Mr.minute.range,Mr.minutes.utc=Mr.minute.utc.range,Mr.hour=fr(function(Z){var ne=Z.getTimezoneOffset()/60;return new xr(36e5*(Math.floor(Z/36e5-ne)+ne))},function(Z,ne){Z.setTime(Z.getTime()+36e5*Math.floor(ne))},function(Z){return Z.getHours()}),Mr.hours=Mr.hour.range,Mr.hours.utc=Mr.hour.utc.range,Mr.month=fr(function(Z){return(Z=Mr.day(Z)).setDate(1),Z},function(Z,ne){Z.setMonth(Z.getMonth()+ne)},function(Z){return Z.getMonth()}),Mr.months=Mr.month.range,Mr.months.utc=Mr.month.utc.range;var rc=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],Su=[[Mr.second,1],[Mr.second,5],[Mr.second,15],[Mr.second,30],[Mr.minute,1],[Mr.minute,5],[Mr.minute,15],[Mr.minute,30],[Mr.hour,1],[Mr.hour,3],[Mr.hour,6],[Mr.hour,12],[Mr.day,1],[Mr.day,2],[Mr.week,1],[Mr.month,1],[Mr.month,3],[Mr.year,1]],Wf=zi.multi([[".%L",function(Z){return Z.getMilliseconds()}],[":%S",function(Z){return Z.getSeconds()}],["%I:%M",function(Z){return Z.getMinutes()}],["%I %p",function(Z){return Z.getHours()}],["%a %d",function(Z){return Z.getDay()&&Z.getDate()!=1}],["%b %d",function(Z){return Z.getDate()!=1}],["%B",function(Z){return Z.getMonth()}],["%Y",ts]]),of={range:function(Z,ne,se){return t.range(Math.ceil(Z/se)*se,+ne,se).map(ol)},floor:I,ceil:I};Su.year=Mr.year,Mr.scale=function(){return Au(t.scale.linear(),Su,Wf)};var sf=Su.map(function(Z){return[Z[0].utc,Z[1]]}),Zf=af.multi([[".%L",function(Z){return Z.getUTCMilliseconds()}],[":%S",function(Z){return Z.getUTCSeconds()}],["%I:%M",function(Z){return Z.getUTCMinutes()}],["%I %p",function(Z){return Z.getUTCHours()}],["%a %d",function(Z){return Z.getUTCDay()&&Z.getUTCDate()!=1}],["%b %d",function(Z){return Z.getUTCDate()!=1}],["%B",function(Z){return Z.getUTCMonth()}],["%Y",ts]]);function Tc(Z){return JSON.parse(Z.responseText)}function lf(Z){var ne=l.createRange();return ne.selectNode(l.body),ne.createContextualFragment(Z.responseText)}sf.year=Mr.year.utc,Mr.scale.utc=function(){return Au(t.scale.linear(),sf,Zf)},t.text=nn(function(Z){return Z.responseText}),t.json=function(Z,ne){return Xr(Z,"application/json",Tc,ne)},t.html=function(Z,ne){return Xr(Z,"text/html",lf,ne)},t.xml=nn(function(Z){return Z.responseXML}),typeof z=="object"&&z.exports?z.exports=t:this.d3=t})()},{}],170:[function(n,z,q){z.exports=function(){for(var t=0;t<arguments.length;t++)if(arguments[t]!==void 0)return arguments[t]}},{}],171:[function(n,z,q){"use strict";var t=n("incremental-convex-hull"),h=n("uniq");function p(e,o){this.point=e,this.index=o}function l(e,o){for(var r=e.point,i=o.point,u=r.length,s=0;s<u;++s){var a=i[s]-r[s];if(a)return a}return 0}z.exports=function(e,o){var r=e.length;if(r===0)return[];var i=e[0].length;if(i<1)return[];if(i===1)return function(M,b,_){if(M===1)return _?[[-1,0]]:[];var S=b.map(function(R,V){return[R[0],V]});S.sort(function(R,V){return R[0]-V[0]});for(var C=new Array(M-1),k=1;k<M;++k){var L=S[k-1],I=S[k];C[k-1]=[L[1],I[1]]}return _&&C.push([-1,C[0][1]],[C[M-1][1],-1]),C}(r,e,o);for(var u=new Array(r),s=1,a=0;a<r;++a){for(var c=e[a],f=new Array(i+1),g=0,d=0;d<i;++d){var m=c[d];f[d]=m,g+=m*m}f[i]=g,u[a]=new p(f,a),s=Math.max(g,s)}h(u,l),r=u.length;var y=new Array(r+i+1),v=new Array(r+i+1),T=(i+1)*(i+1)*s,w=new Array(i+1);for(a=0;a<=i;++a)w[a]=0;for(w[i]=T,y[0]=w.slice(),v[0]=-1,a=0;a<=i;++a)(f=w.slice())[a]=1,y[a+1]=f,v[a+1]=-1;for(a=0;a<r;++a){var A=u[a];y[a+i+1]=A.point,v[a+i+1]=A.index}var E=t(y,!1);if(E=o?E.filter(function(M){for(var b=0,_=0;_<=i;++_){var S=v[M[_]];if(S<0&&++b>=2)return!1;M[_]=S}return!0}):E.filter(function(M){for(var b=0;b<=i;++b){var _=v[M[b]];if(_<0)return!1;M[b]=_}return!0}),1&i)for(a=0;a<E.length;++a)f=(A=E[a])[0],A[0]=A[1],A[1]=f;return E}},{"incremental-convex-hull":459,uniq:597}],172:[function(n,z,q){"use strict";z.exports=p;var t=(p.canvas=document.createElement("canvas")).getContext("2d"),h=l([32,126]);function p(e,o){Array.isArray(e)&&(e=e.join(", "));var r,i={},u=16,s=.05;o&&(o.length===2&&typeof o[0]=="number"?r=l(o):Array.isArray(o)?r=o:(o.o?r=l(o.o):o.pairs&&(r=o.pairs),o.fontSize&&(u=o.fontSize),o.threshold!=null&&(s=o.threshold))),r||(r=h),t.font=u+"px "+e;for(var a=0;a<r.length;a++){var c=r[a],f=t.measureText(c[0]).width+t.measureText(c[1]).width,g=t.measureText(c).width;if(Math.abs(f-g)>u*s){var d=(g-f)/u;i[c]=1e3*d}}return i}function l(e){for(var o=[],r=e[0];r<=e[1];r++)for(var i=String.fromCharCode(r),u=e[0];u<e[1];u++){var s=i+String.fromCharCode(u);o.push(s)}return o}p.createPairs=l,p.ascii=h},{}],173:[function(n,z,q){(function(t){(function(){var h=!1;if(typeof Float64Array<"u"){var p=new Float64Array(1),l=new Uint32Array(p.buffer);p[0]=1,h=!0,l[1]===1072693248?(z.exports=function(o){return p[0]=o,[l[0],l[1]]},z.exports.pack=function(o,r){return l[0]=o,l[1]=r,p[0]},z.exports.lo=function(o){return p[0]=o,l[0]},z.exports.hi=function(o){return p[0]=o,l[1]}):l[0]===1072693248?(z.exports=function(o){return p[0]=o,[l[1],l[0]]},z.exports.pack=function(o,r){return l[1]=o,l[0]=r,p[0]},z.exports.lo=function(o){return p[0]=o,l[1]},z.exports.hi=function(o){return p[0]=o,l[0]}):h=!1}if(!h){var e=new t(8);z.exports=function(o){return e.writeDoubleLE(o,0,!0),[e.readUInt32LE(0,!0),e.readUInt32LE(4,!0)]},z.exports.pack=function(o,r){return e.writeUInt32LE(o,0,!0),e.writeUInt32LE(r,4,!0),e.readDoubleLE(0,!0)},z.exports.lo=function(o){return e.writeDoubleLE(o,0,!0),e.readUInt32LE(0,!0)},z.exports.hi=function(o){return e.writeDoubleLE(o,0,!0),e.readUInt32LE(4,!0)}}z.exports.sign=function(o){return z.exports.hi(o)>>>31},z.exports.exponent=function(o){return(z.exports.hi(o)<<1>>>21)-1023},z.exports.fraction=function(o){var r=z.exports.lo(o),i=z.exports.hi(o),u=1048575&i;return 2146435072&i&&(u+=1<<20),[r,u]},z.exports.denormalized=function(o){return!(2146435072&z.exports.hi(o))}}).call(this)}).call(this,n("buffer").Buffer)},{buffer:111}],174:[function(n,z,q){var t=n("abs-svg-path"),h=n("normalize-svg-path"),p={M:"moveTo",C:"bezierCurveTo"};z.exports=function(l,e){l.beginPath(),h(t(e)).forEach(function(o){var r=o[0],i=o.slice(1);l[p[r]].apply(l,i)}),l.closePath()}},{"abs-svg-path":65,"normalize-svg-path":497}],175:[function(n,z,q){z.exports=function(t){switch(t){case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;case"array":return Array;case"uint8_clamped":return Uint8ClampedArray}}},{}],176:[function(n,z,q){"use strict";z.exports=function(t,h){switch(typeof h>"u"&&(h=0),typeof t){case"number":if(t>0)return function(p,l){var e,o;for(e=new Array(p),o=0;o<p;++o)e[o]=l;return e}(0|t,h);break;case"object":if(typeof t.length=="number")return function p(l,e,o){var r=0|l[o];if(r<=0)return[];var i,u=new Array(r);if(o===l.length-1)for(i=0;i<r;++i)u[i]=e;else for(i=0;i<r;++i)u[i]=p(l,e,o+1);return u}(t,h,0)}return[]}},{}],177:[function(n,z,q){"use strict";function t(C,k,L){L=L||2;var I,R,V,O,J,D,B,N=k&&k.length,F=N?k[0]*L:C.length,H=h(C,0,F,L,!0),j=[];if(!H||H.next===H.prev)return j;if(N&&(H=function(W,Q,$,ee){var ie,ae,oe,de,le,fe=[];for(ie=0,ae=Q.length;ie<ae;ie++)oe=Q[ie]*ee,de=ie<ae-1?Q[ie+1]*ee:W.length,(le=h(W,oe,de,ee,!1))===le.next&&(le.steiner=!0),fe.push(f(le));for(fe.sort(u),ie=0;ie<fe.length;ie++)s(fe[ie],$),$=p($,$.next);return $}(C,k,H,L)),C.length>80*L){I=V=C[0],R=O=C[1];for(var G=L;G<F;G+=L)(J=C[G])<I&&(I=J),(D=C[G+1])<R&&(R=D),J>V&&(V=J),D>O&&(O=D);B=(B=Math.max(V-I,O-R))!==0?1/B:0}return l(H,j,L,I,R,B),j}function h(C,k,L,I,R){var V,O;if(R===S(C,k,L,I)>0)for(V=k;V<L;V+=I)O=M(V,C[V],C[V+1],O);else for(V=L-I;V>=k;V-=I)O=M(V,C[V],C[V+1],O);return O&&y(O,O.next)&&(b(O),O=O.next),O}function p(C,k){if(!C)return C;k||(k=C);var L,I=C;do if(L=!1,I.steiner||!y(I,I.next)&&m(I.prev,I,I.next)!==0)I=I.next;else{if(b(I),(I=k=I.prev)===I.next)break;L=!0}while(L||I!==k);return k}function l(C,k,L,I,R,V,O){if(C){!O&&V&&function(N,F,H,j){var G=N;do G.z===null&&(G.z=c(G.x,G.y,F,H,j)),G.prevZ=G.prev,G.nextZ=G.next,G=G.next;while(G!==N);G.prevZ.nextZ=null,G.prevZ=null,function(W){var Q,$,ee,ie,ae,oe,de,le,fe=1;do{for($=W,W=null,ae=null,oe=0;$;){for(oe++,ee=$,de=0,Q=0;Q<fe&&(de++,ee=ee.nextZ);Q++);for(le=fe;de>0||le>0&&ee;)de!==0&&(le===0||!ee||$.z<=ee.z)?(ie=$,$=$.nextZ,de--):(ie=ee,ee=ee.nextZ,le--),ae?ae.nextZ=ie:W=ie,ie.prevZ=ae,ae=ie;$=ee}ae.nextZ=null,fe*=2}while(oe>1)}(G)}(C,I,R,V);for(var J,D,B=C;C.prev!==C.next;)if(J=C.prev,D=C.next,V?o(C,I,R,V):e(C))k.push(J.i/L),k.push(C.i/L),k.push(D.i/L),b(C),C=D.next,B=D.next;else if((C=D)===B){O?O===1?l(C=r(p(C),k,L),k,L,I,R,V,2):O===2&&i(C,k,L,I,R,V):l(p(C),k,L,I,R,V,1);break}}}function e(C){var k=C.prev,L=C,I=C.next;if(m(k,L,I)>=0)return!1;for(var R=C.next.next;R!==C.prev;){if(g(k.x,k.y,L.x,L.y,I.x,I.y,R.x,R.y)&&m(R.prev,R,R.next)>=0)return!1;R=R.next}return!0}function o(C,k,L,I){var R=C.prev,V=C,O=C.next;if(m(R,V,O)>=0)return!1;for(var J=R.x<V.x?R.x<O.x?R.x:O.x:V.x<O.x?V.x:O.x,D=R.y<V.y?R.y<O.y?R.y:O.y:V.y<O.y?V.y:O.y,B=R.x>V.x?R.x>O.x?R.x:O.x:V.x>O.x?V.x:O.x,N=R.y>V.y?R.y>O.y?R.y:O.y:V.y>O.y?V.y:O.y,F=c(J,D,k,L,I),H=c(B,N,k,L,I),j=C.prevZ,G=C.nextZ;j&&j.z>=F&&G&&G.z<=H;){if(j!==C.prev&&j!==C.next&&g(R.x,R.y,V.x,V.y,O.x,O.y,j.x,j.y)&&m(j.prev,j,j.next)>=0||(j=j.prevZ,G!==C.prev&&G!==C.next&&g(R.x,R.y,V.x,V.y,O.x,O.y,G.x,G.y)&&m(G.prev,G,G.next)>=0))return!1;G=G.nextZ}for(;j&&j.z>=F;){if(j!==C.prev&&j!==C.next&&g(R.x,R.y,V.x,V.y,O.x,O.y,j.x,j.y)&&m(j.prev,j,j.next)>=0)return!1;j=j.prevZ}for(;G&&G.z<=H;){if(G!==C.prev&&G!==C.next&&g(R.x,R.y,V.x,V.y,O.x,O.y,G.x,G.y)&&m(G.prev,G,G.next)>=0)return!1;G=G.nextZ}return!0}function r(C,k,L){var I=C;do{var R=I.prev,V=I.next.next;!y(R,V)&&v(R,I,I.next,V)&&A(R,V)&&A(V,R)&&(k.push(R.i/L),k.push(I.i/L),k.push(V.i/L),b(I),b(I.next),I=C=V),I=I.next}while(I!==C);return p(I)}function i(C,k,L,I,R,V){var O=C;do{for(var J=O.next.next;J!==O.prev;){if(O.i!==J.i&&d(O,J)){var D=E(O,J);return O=p(O,O.next),D=p(D,D.next),l(O,k,L,I,R,V),void l(D,k,L,I,R,V)}J=J.next}O=O.next}while(O!==C)}function u(C,k){return C.x-k.x}function s(C,k){if(k=function(I,R){var V,O=R,J=I.x,D=I.y,B=-1/0;do{if(D<=O.y&&D>=O.next.y&&O.next.y!==O.y){var N=O.x+(D-O.y)*(O.next.x-O.x)/(O.next.y-O.y);if(N<=J&&N>B){if(B=N,N===J){if(D===O.y)return O;if(D===O.next.y)return O.next}V=O.x<O.next.x?O:O.next}}O=O.next}while(O!==R);if(!V)return null;if(J===B)return V;var F,H=V,j=V.x,G=V.y,W=1/0;O=V;do J>=O.x&&O.x>=j&&J!==O.x&&g(D<G?J:B,D,j,G,D<G?B:J,D,O.x,O.y)&&(F=Math.abs(D-O.y)/(J-O.x),A(O,I)&&(F<W||F===W&&(O.x>V.x||O.x===V.x&&a(V,O)))&&(V=O,W=F)),O=O.next;while(O!==H);return V}(C,k)){var L=E(k,C);p(k,k.next),p(L,L.next)}}function a(C,k){return m(C.prev,C,k.prev)<0&&m(k.next,C,C.next)<0}function c(C,k,L,I,R){return(C=1431655765&((C=858993459&((C=252645135&((C=16711935&((C=32767*(C-L)*R)|C<<8))|C<<4))|C<<2))|C<<1))|(k=1431655765&((k=858993459&((k=252645135&((k=16711935&((k=32767*(k-I)*R)|k<<8))|k<<4))|k<<2))|k<<1))<<1}function f(C){var k=C,L=C;do(k.x<L.x||k.x===L.x&&k.y<L.y)&&(L=k),k=k.next;while(k!==C);return L}function g(C,k,L,I,R,V,O,J){return(R-O)*(k-J)-(C-O)*(V-J)>=0&&(C-O)*(I-J)-(L-O)*(k-J)>=0&&(L-O)*(V-J)-(R-O)*(I-J)>=0}function d(C,k){return C.next.i!==k.i&&C.prev.i!==k.i&&!function(L,I){var R=L;do{if(R.i!==L.i&&R.next.i!==L.i&&R.i!==I.i&&R.next.i!==I.i&&v(R,R.next,L,I))return!0;R=R.next}while(R!==L);return!1}(C,k)&&(A(C,k)&&A(k,C)&&function(L,I){var R=L,V=!1,O=(L.x+I.x)/2,J=(L.y+I.y)/2;do R.y>J!=R.next.y>J&&R.next.y!==R.y&&O<(R.next.x-R.x)*(J-R.y)/(R.next.y-R.y)+R.x&&(V=!V),R=R.next;while(R!==L);return V}(C,k)&&(m(C.prev,C,k.prev)||m(C,k.prev,k))||y(C,k)&&m(C.prev,C,C.next)>0&&m(k.prev,k,k.next)>0)}function m(C,k,L){return(k.y-C.y)*(L.x-k.x)-(k.x-C.x)*(L.y-k.y)}function y(C,k){return C.x===k.x&&C.y===k.y}function v(C,k,L,I){var R=w(m(C,k,L)),V=w(m(C,k,I)),O=w(m(L,I,C)),J=w(m(L,I,k));return R!==V&&O!==J||!(R!==0||!T(C,L,k))||!(V!==0||!T(C,I,k))||!(O!==0||!T(L,C,I))||!(J!==0||!T(L,k,I))}function T(C,k,L){return k.x<=Math.max(C.x,L.x)&&k.x>=Math.min(C.x,L.x)&&k.y<=Math.max(C.y,L.y)&&k.y>=Math.min(C.y,L.y)}function w(C){return C>0?1:C<0?-1:0}function A(C,k){return m(C.prev,C,C.next)<0?m(C,k,C.next)>=0&&m(C,C.prev,k)>=0:m(C,k,C.prev)<0||m(C,C.next,k)<0}function E(C,k){var L=new _(C.i,C.x,C.y),I=new _(k.i,k.x,k.y),R=C.next,V=k.prev;return C.next=k,k.prev=C,L.next=R,R.prev=L,I.next=L,L.prev=I,V.next=I,I.prev=V,I}function M(C,k,L,I){var R=new _(C,k,L);return I?(R.next=I.next,R.prev=I,I.next.prev=R,I.next=R):(R.prev=R,R.next=R),R}function b(C){C.next.prev=C.prev,C.prev.next=C.next,C.prevZ&&(C.prevZ.nextZ=C.nextZ),C.nextZ&&(C.nextZ.prevZ=C.prevZ)}function _(C,k,L){this.i=C,this.x=k,this.y=L,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function S(C,k,L,I){for(var R=0,V=k,O=L-I;V<L;V+=I)R+=(C[O]-C[V])*(C[V+1]+C[O+1]),O=V;return R}z.exports=t,z.exports.default=t,t.deviation=function(C,k,L,I){var R=k&&k.length,V=R?k[0]*L:C.length,O=Math.abs(S(C,0,V,L));if(R)for(var J=0,D=k.length;J<D;J++){var B=k[J]*L,N=J<D-1?k[J+1]*L:C.length;O-=Math.abs(S(C,B,N,L))}var F=0;for(J=0;J<I.length;J+=3){var H=I[J]*L,j=I[J+1]*L,G=I[J+2]*L;F+=Math.abs((C[H]-C[G])*(C[j+1]-C[H+1])-(C[H]-C[j])*(C[G+1]-C[H+1]))}return O===0&&F===0?0:Math.abs((F-O)/O)},t.flatten=function(C){for(var k=C[0][0].length,L={vertices:[],holes:[],dimensions:k},I=0,R=0;R<C.length;R++){for(var V=0;V<C[R].length;V++)for(var O=0;O<k;O++)L.vertices.push(C[R][V][O]);R>0&&(I+=C[R-1].length,L.holes.push(I))}return L}},{}],178:[function(n,z,q){"use strict";z.exports=function(h,p){var l=h.length;if(typeof p!="number"){p=0;for(var e=0;e<l;++e){var o=h[e];p=Math.max(p,o[0],o[1])}p=1+(0|p)}p|=0;var r=new Array(p);for(e=0;e<p;++e)r[e]=[];for(e=0;e<l;++e)o=h[e],r[o[0]].push(o[1]),r[o[1]].push(o[0]);for(var i=0;i<p;++i)t(r[i],function(u,s){return u-s});return r};var t=n("uniq")},{uniq:597}],179:[function(n,z,q){var t=n("strongly-connected-components");z.exports=function(h,p){var l,e=[],o=[],r=[],i={},u=[];function s(v){var T,w,A=!1;for(o.push(v),r[v]=!0,T=0;T<u[v].length;T++)(w=u[v][T])===l?(a(l,o),A=!0):r[w]||(A=s(w));if(A)(function M(b){r[b]=!1,i.hasOwnProperty(b)&&Object.keys(i[b]).forEach(function(_){delete i[b][_],r[_]&&M(_)})})(v);else for(T=0;T<u[v].length;T++){w=u[v][T];var E=i[w];E||(E={},i[w]=E),E[w]=!0}return o.pop(),A}function a(v,T){var w=[].concat(T).concat(v);p?p(s):e.push(w)}function c(v){(function(_){for(var S=0;S<h.length;S++)S<_&&(h[S]=[]),h[S]=h[S].filter(function(C){return C>=_})})(v);for(var T,w=t(h).components.filter(function(_){return _.length>1}),A=1/0,E=0;E<w.length;E++)for(var M=0;M<w[E].length;M++)w[E][M]<A&&(A=w[E][M],T=E);var b=w[T];return!!b&&{leastVertex:A,adjList:h.map(function(_,S){return b.indexOf(S)===-1?[]:_.filter(function(C){return b.indexOf(C)!==-1})})}}l=0;for(var f=h.length;l<f;){var g=c(l);if(l=g.leastVertex,u=g.adjList){for(var d=0;d<u.length;d++)for(var m=0;m<u[d].length;m++){var y=u[d][m];r[+y]=!1,i[y]={}}s(l),l+=1}else l=f}return p?void 0:e}},{"strongly-connected-components":569}],180:[function(n,z,q){"use strict";var t=n("../../object/valid-value");z.exports=function(){return t(this).length=0,this}},{"../../object/valid-value":211}],181:[function(n,z,q){"use strict";z.exports=n("./is-implemented")()?Array.from:n("./shim")},{"./is-implemented":182,"./shim":183}],182:[function(n,z,q){"use strict";z.exports=function(){var t,h,p=Array.from;return typeof p=="function"&&(h=p(t=["raz","dwa"]),!!(h&&h!==t&&h[1]==="dwa"))}},{}],183:[function(n,z,q){"use strict";var t=n("es6-symbol").iterator,h=n("../../function/is-arguments"),p=n("../../function/is-function"),l=n("../../number/to-pos-integer"),e=n("../../object/valid-callable"),o=n("../../object/valid-value"),r=n("../../object/is-value"),i=n("../../string/is-string"),u=Array.isArray,s=Function.prototype.call,a={configurable:!0,enumerable:!0,writable:!0,value:null},c=Object.defineProperty;z.exports=function(f){var g,d,m,y,v,T,w,A,E,M,b=arguments[1],_=arguments[2];if(f=Object(o(f)),r(b)&&e(b),this&&this!==Array&&p(this))g=this;else{if(!b){if(h(f))return(v=f.length)!==1?Array.apply(null,f):((y=new Array(1))[0]=f[0],y);if(u(f)){for(y=new Array(v=f.length),d=0;d<v;++d)y[d]=f[d];return y}}y=[]}if(!u(f)){if((E=f[t])!==void 0){for(w=e(E).call(f),g&&(y=new g),A=w.next(),d=0;!A.done;)M=b?s.call(b,_,A.value,d):A.value,g?(a.value=M,c(y,d,a)):y[d]=M,A=w.next(),++d;v=d}else if(i(f)){for(v=f.length,g&&(y=new g),d=0,m=0;d<v;++d)M=f[d],d+1<v&&(T=M.charCodeAt(0))>=55296&&T<=56319&&(M+=f[++d]),M=b?s.call(b,_,M,m):M,g?(a.value=M,c(y,m,a)):y[m]=M,++m;v=m}}if(v===void 0)for(v=l(f.length),g&&(y=new g(v)),d=0;d<v;++d)M=b?s.call(b,_,f[d],d):f[d],g?(a.value=M,c(y,d,a)):y[d]=M;return g&&(a.value=null,y.length=v),y}},{"../../function/is-arguments":184,"../../function/is-function":185,"../../number/to-pos-integer":191,"../../object/is-value":200,"../../object/valid-callable":209,"../../object/valid-value":211,"../../string/is-string":215,"es6-symbol":225}],184:[function(n,z,q){"use strict";var t=Object.prototype.toString,h=t.call(function(){return arguments}());z.exports=function(p){return t.call(p)===h}},{}],185:[function(n,z,q){"use strict";var t=Object.prototype.toString,h=RegExp.prototype.test.bind(/^[object [A-Za-z0-9]*Function]$/);z.exports=function(p){return typeof p=="function"&&h(t.call(p))}},{}],186:[function(n,z,q){"use strict";z.exports=function(){}},{}],187:[function(n,z,q){"use strict";z.exports=n("./is-implemented")()?Math.sign:n("./shim")},{"./is-implemented":188,"./shim":189}],188:[function(n,z,q){"use strict";z.exports=function(){var t=Math.sign;return typeof t=="function"&&t(10)===1&&t(-20)===-1}},{}],189:[function(n,z,q){"use strict";z.exports=function(t){return t=Number(t),isNaN(t)||t===0?t:t>0?1:-1}},{}],190:[function(n,z,q){"use strict";var t=n("../math/sign"),h=Math.abs,p=Math.floor;z.exports=function(l){return isNaN(l)?0:(l=Number(l))!==0&&isFinite(l)?t(l)*p(h(l)):l}},{"../math/sign":187}],191:[function(n,z,q){"use strict";var t=n("./to-integer"),h=Math.max;z.exports=function(p){return h(0,t(p))}},{"./to-integer":190}],192:[function(n,z,q){"use strict";var t=n("./valid-callable"),h=n("./valid-value"),p=Function.prototype.bind,l=Function.prototype.call,e=Object.keys,o=Object.prototype.propertyIsEnumerable;z.exports=function(r,i){return function(u,s){var a,c=arguments[2],f=arguments[3];return u=Object(h(u)),t(s),a=e(u),f&&a.sort(typeof f=="function"?p.call(f,u):void 0),typeof r!="function"&&(r=a[r]),l.call(r,a,function(g,d){return o.call(u,g)?l.call(s,c,u[g],g,u,d):i})}}},{"./valid-callable":209,"./valid-value":211}],193:[function(n,z,q){"use strict";z.exports=n("./is-implemented")()?Object.assign:n("./shim")},{"./is-implemented":194,"./shim":195}],194:[function(n,z,q){"use strict";z.exports=function(){var t,h=Object.assign;return typeof h=="function"&&(h(t={foo:"raz"},{bar:"dwa"},{trzy:"trzy"}),t.foo+t.bar+t.trzy==="razdwatrzy")}},{}],195:[function(n,z,q){"use strict";var t=n("../keys"),h=n("../valid-value"),p=Math.max;z.exports=function(l,e){var o,r,i,u=p(arguments.length,2);for(l=Object(h(l)),i=function(s){try{l[s]=e[s]}catch(a){o||(o=a)}},r=1;r<u;++r)t(e=arguments[r]).forEach(i);if(o!==void 0)throw o;return l}},{"../keys":201,"../valid-value":211}],196:[function(n,z,q){"use strict";var t=n("../array/from"),h=n("./assign"),p=n("./valid-value");z.exports=function(l){var e=Object(p(l)),o=arguments[1],r=Object(arguments[2]);if(e!==l&&!o)return e;var i={};return o?t(o,function(u){(r.ensure||u in l)&&(i[u]=l[u])}):h(i,l),i}},{"../array/from":181,"./assign":193,"./valid-value":211}],197:[function(n,z,q){"use strict";var t,h,p,l,e=Object.create;n("./set-prototype-of/is-implemented")()||(t=n("./set-prototype-of/shim")),z.exports=t?t.level!==1?e:(h={},p={},l={configurable:!1,enumerable:!1,writable:!0,value:void 0},Object.getOwnPropertyNames(Object.prototype).forEach(function(o){p[o]=o!=="__proto__"?l:{configurable:!0,enumerable:!1,writable:!0,value:void 0}}),Object.defineProperties(h,p),Object.defineProperty(t,"nullPolyfill",{configurable:!1,enumerable:!1,writable:!1,value:h}),function(o,r){return e(o===null?h:o,r)}):e},{"./set-prototype-of/is-implemented":207,"./set-prototype-of/shim":208}],198:[function(n,z,q){"use strict";z.exports=n("./_iterate")("forEach")},{"./_iterate":192}],199:[function(n,z,q){"use strict";var t=n("./is-value"),h={function:!0,object:!0};z.exports=function(p){return t(p)&&h[typeof p]||!1}},{"./is-value":200}],200:[function(n,z,q){"use strict";var t=n("../function/noop")();z.exports=function(h){return h!==t&&h!==null}},{"../function/noop":186}],201:[function(n,z,q){"use strict";z.exports=n("./is-implemented")()?Object.keys:n("./shim")},{"./is-implemented":202,"./shim":203}],202:[function(n,z,q){"use strict";z.exports=function(){try{return Object.keys("primitive"),!0}catch{return!1}}},{}],203:[function(n,z,q){"use strict";var t=n("../is-value"),h=Object.keys;z.exports=function(p){return h(t(p)?Object(p):p)}},{"../is-value":200}],204:[function(n,z,q){"use strict";var t=n("./valid-callable"),h=n("./for-each"),p=Function.prototype.call;z.exports=function(l,e){var o={},r=arguments[2];return t(e),h(l,function(i,u,s,a){o[u]=p.call(e,r,i,u,s,a)}),o}},{"./for-each":198,"./valid-callable":209}],205:[function(n,z,q){"use strict";var t=n("./is-value"),h=Array.prototype.forEach,p=Object.create,l=function(e,o){var r;for(r in e)o[r]=e[r]};z.exports=function(e){var o=p(null);return h.call(arguments,function(r){t(r)&&l(Object(r),o)}),o}},{"./is-value":200}],206:[function(n,z,q){"use strict";z.exports=n("./is-implemented")()?Object.setPrototypeOf:n("./shim")},{"./is-implemented":207,"./shim":208}],207:[function(n,z,q){"use strict";var t=Object.create,h=Object.getPrototypeOf,p={};z.exports=function(){var l=Object.setPrototypeOf,e=arguments[0]||t;return typeof l=="function"&&h(l(e(null),p))===p}},{}],208:[function(n,z,q){"use strict";var t,h=n("../is-object"),p=n("../valid-value"),l=Object.prototype.isPrototypeOf,e=Object.defineProperty,o={configurable:!0,enumerable:!1,writable:!0,value:void 0};t=function(r,i){if(p(r),i===null||h(i))return r;throw new TypeError("Prototype must be null or an object")},z.exports=function(r){var i,u;return r?(r.level===2?r.set?(u=r.set,i=function(s,a){return u.call(t(s,a),a),s}):i=function(s,a){return t(s,a).__proto__=a,s}:i=function s(a,c){var f;return t(a,c),(f=l.call(s.nullPolyfill,a))&&delete s.nullPolyfill.__proto__,c===null&&(c=s.nullPolyfill),a.__proto__=c,f&&e(s.nullPolyfill,"__proto__",o),a},Object.defineProperty(i,"level",{configurable:!1,enumerable:!1,writable:!1,value:r.level})):null}(function(){var r,i=Object.create(null),u={},s=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__");if(s){try{(r=s.set).call(i,u)}catch{}if(Object.getPrototypeOf(i)===u)return{set:r,level:2}}return i.__proto__=u,Object.getPrototypeOf(i)===u?{level:2}:((i={}).__proto__=u,Object.getPrototypeOf(i)===u&&{level:1})}()),n("../create")},{"../create":197,"../is-object":199,"../valid-value":211}],209:[function(n,z,q){"use strict";z.exports=function(t){if(typeof t!="function")throw new TypeError(t+" is not a function");return t}},{}],210:[function(n,z,q){"use strict";var t=n("./is-object");z.exports=function(h){if(!t(h))throw new TypeError(h+" is not an Object");return h}},{"./is-object":199}],211:[function(n,z,q){"use strict";var t=n("./is-value");z.exports=function(h){if(!t(h))throw new TypeError("Cannot use null or undefined");return h}},{"./is-value":200}],212:[function(n,z,q){"use strict";z.exports=n("./is-implemented")()?String.prototype.contains:n("./shim")},{"./is-implemented":213,"./shim":214}],213:[function(n,z,q){"use strict";var t="razdwatrzy";z.exports=function(){return typeof t.contains=="function"&&t.contains("dwa")===!0&&t.contains("foo")===!1}},{}],214:[function(n,z,q){"use strict";var t=String.prototype.indexOf;z.exports=function(h){return t.call(this,h,arguments[1])>-1}},{}],215:[function(n,z,q){"use strict";var t=Object.prototype.toString,h=t.call("");z.exports=function(p){return typeof p=="string"||p&&typeof p=="object"&&(p instanceof String||t.call(p)===h)||!1}},{}],216:[function(n,z,q){"use strict";var t=Object.create(null),h=Math.random;z.exports=function(){var p;do p=h().toString(36).slice(2);while(t[p]);return p}},{}],217:[function(n,z,q){"use strict";var t,h=n("es5-ext/object/set-prototype-of"),p=n("es5-ext/string/#/contains"),l=n("d"),e=n("es6-symbol"),o=n("./"),r=Object.defineProperty;t=z.exports=function(i,u){if(!(this instanceof t))throw new TypeError("Constructor requires 'new'");o.call(this,i),u=u?p.call(u,"key+value")?"key+value":p.call(u,"key")?"key":"value":"value",r(this,"__kind__",l("",u))},h&&h(t,o),delete t.prototype.constructor,t.prototype=Object.create(o.prototype,{_resolve:l(function(i){return this.__kind__==="value"?this.__list__[i]:this.__kind__==="key+value"?[i,this.__list__[i]]:i})}),r(t.prototype,e.toStringTag,l("c","Array Iterator"))},{"./":220,d:155,"es5-ext/object/set-prototype-of":206,"es5-ext/string/#/contains":212,"es6-symbol":225}],218:[function(n,z,q){"use strict";var t=n("es5-ext/function/is-arguments"),h=n("es5-ext/object/valid-callable"),p=n("es5-ext/string/is-string"),l=n("./get"),e=Array.isArray,o=Function.prototype.call,r=Array.prototype.some;z.exports=function(i,u){var s,a,c,f,g,d,m,y,v=arguments[2];if(e(i)||t(i)?s="array":p(i)?s="string":i=l(i),h(u),c=function(){f=!0},s!=="array")if(s!=="string")for(a=i.next();!a.done;){if(o.call(u,v,a.value,c),f)return;a=i.next()}else for(d=i.length,g=0;g<d&&(m=i[g],g+1<d&&(y=m.charCodeAt(0))>=55296&&y<=56319&&(m+=i[++g]),o.call(u,v,m,c),!f);++g);else r.call(i,function(T){return o.call(u,v,T,c),f})}},{"./get":219,"es5-ext/function/is-arguments":184,"es5-ext/object/valid-callable":209,"es5-ext/string/is-string":215}],219:[function(n,z,q){"use strict";var t=n("es5-ext/function/is-arguments"),h=n("es5-ext/string/is-string"),p=n("./array"),l=n("./string"),e=n("./valid-iterable"),o=n("es6-symbol").iterator;z.exports=function(r){return typeof e(r)[o]=="function"?r[o]():t(r)?new p(r):h(r)?new l(r):new p(r)}},{"./array":217,"./string":222,"./valid-iterable":223,"es5-ext/function/is-arguments":184,"es5-ext/string/is-string":215,"es6-symbol":225}],220:[function(n,z,q){"use strict";var t,h=n("es5-ext/array/#/clear"),p=n("es5-ext/object/assign"),l=n("es5-ext/object/valid-callable"),e=n("es5-ext/object/valid-value"),o=n("d"),r=n("d/auto-bind"),i=n("es6-symbol"),u=Object.defineProperty,s=Object.defineProperties;z.exports=t=function(a,c){if(!(this instanceof t))throw new TypeError("Constructor requires 'new'");s(this,{__list__:o("w",e(a)),__context__:o("w",c),__nextIndex__:o("w",0)}),c&&(l(c.on),c.on("_add",this._onAdd),c.on("_delete",this._onDelete),c.on("_clear",this._onClear))},delete t.prototype.constructor,s(t.prototype,p({_next:o(function(){var a;if(this.__list__)return this.__redo__&&(a=this.__redo__.shift())!==void 0?a:this.__nextIndex__<this.__list__.length?this.__nextIndex__++:void this._unBind()}),next:o(function(){return this._createResult(this._next())}),_createResult:o(function(a){return a===void 0?{done:!0,value:void 0}:{done:!1,value:this._resolve(a)}}),_resolve:o(function(a){return this.__list__[a]}),_unBind:o(function(){this.__list__=null,delete this.__redo__,this.__context__&&(this.__context__.off("_add",this._onAdd),this.__context__.off("_delete",this._onDelete),this.__context__.off("_clear",this._onClear),this.__context__=null)}),toString:o(function(){return"[object "+(this[i.toStringTag]||"Object")+"]"})},r({_onAdd:o(function(a){a>=this.__nextIndex__||(++this.__nextIndex__,this.__redo__?(this.__redo__.forEach(function(c,f){c>=a&&(this.__redo__[f]=++c)},this),this.__redo__.push(a)):u(this,"__redo__",o("c",[a])))}),_onDelete:o(function(a){var c;a>=this.__nextIndex__||(--this.__nextIndex__,this.__redo__&&((c=this.__redo__.indexOf(a))!==-1&&this.__redo__.splice(c,1),this.__redo__.forEach(function(f,g){f>a&&(this.__redo__[g]=--f)},this)))}),_onClear:o(function(){this.__redo__&&h.call(this.__redo__),this.__nextIndex__=0})}))),u(t.prototype,i.iterator,o(function(){return this}))},{d:155,"d/auto-bind":154,"es5-ext/array/#/clear":180,"es5-ext/object/assign":193,"es5-ext/object/valid-callable":209,"es5-ext/object/valid-value":211,"es6-symbol":225}],221:[function(n,z,q){"use strict";var t=n("es5-ext/function/is-arguments"),h=n("es5-ext/object/is-value"),p=n("es5-ext/string/is-string"),l=n("es6-symbol").iterator,e=Array.isArray;z.exports=function(o){return!!h(o)&&(!!e(o)||!!p(o)||!!t(o)||typeof o[l]=="function")}},{"es5-ext/function/is-arguments":184,"es5-ext/object/is-value":200,"es5-ext/string/is-string":215,"es6-symbol":225}],222:[function(n,z,q){"use strict";var t,h=n("es5-ext/object/set-prototype-of"),p=n("d"),l=n("es6-symbol"),e=n("./"),o=Object.defineProperty;t=z.exports=function(r){if(!(this instanceof t))throw new TypeError("Constructor requires 'new'");r=String(r),e.call(this,r),o(this,"__length__",p("",r.length))},h&&h(t,e),delete t.prototype.constructor,t.prototype=Object.create(e.prototype,{_next:p(function(){if(this.__list__)return this.__nextIndex__<this.__length__?this.__nextIndex__++:void this._unBind()}),_resolve:p(function(r){var i,u=this.__list__[r];return this.__nextIndex__===this.__length__?u:(i=u.charCodeAt(0))>=55296&&i<=56319?u+this.__list__[this.__nextIndex__++]:u})}),o(t.prototype,l.toStringTag,p("c","String Iterator"))},{"./":220,d:155,"es5-ext/object/set-prototype-of":206,"es6-symbol":225}],223:[function(n,z,q){"use strict";var t=n("./is-iterable");z.exports=function(h){if(!t(h))throw new TypeError(h+" is not iterable");return h}},{"./is-iterable":221}],224:[function(n,z,q){(function(t,h){(function(){(function(p,l){typeof q=="object"&&typeof z<"u"?z.exports=l():p.ES6Promise=l()})(this,function(){"use strict";function p(F){return typeof F=="function"}var l=Array.isArray?Array.isArray:function(F){return Object.prototype.toString.call(F)==="[object Array]"},e=0,o=void 0,r=void 0,i=function(F,H){d[e]=F,d[e+1]=H,(e+=2)===2&&(r?r(m):A())},u=typeof window<"u"?window:void 0,s=u||{},a=s.MutationObserver||s.WebKitMutationObserver,c=typeof self>"u"&&typeof t<"u"&&{}.toString.call(t)==="[object process]",f=typeof Uint8ClampedArray<"u"&&typeof importScripts<"u"&&typeof MessageChannel<"u";function g(){var F=setTimeout;return function(){return F(m,1)}}var d=new Array(1e3);function m(){for(var F=0;F<e;F+=2)(0,d[F])(d[F+1]),d[F]=void 0,d[F+1]=void 0;e=0}var y,v,T,w,A=void 0;function E(F,H){var j=this,G=new this.constructor(_);G[b]===void 0&&D(G);var W=j._state;if(W){var Q=arguments[W-1];i(function(){return O(W,G,Q,j._result)})}else R(j,G,F,H);return G}function M(F){if(F&&typeof F=="object"&&F.constructor===this)return F;var H=new this(_);return C(H,F),H}c?A=function(){return t.nextTick(m)}:a?(v=0,T=new a(m),w=document.createTextNode(""),T.observe(w,{characterData:!0}),A=function(){w.data=v=++v%2}):f?((y=new MessageChannel).port1.onmessage=m,A=function(){return y.port2.postMessage(0)}):A=u===void 0&&typeof n=="function"?function(){try{var F=Function("return this")().require("vertx");return typeof(o=F.runOnLoop||F.runOnContext)<"u"?function(){o(m)}:g()}catch{return g()}}():g();var b=Math.random().toString(36).substring(2);function _(){}function S(F,H,j){H.constructor===F.constructor&&j===E&&H.constructor.resolve===M?function(G,W){W._state===1?L(G,W._result):W._state===2?I(G,W._result):R(W,void 0,function(Q){return C(G,Q)},function(Q){return I(G,Q)})}(F,H):j===void 0?L(F,H):p(j)?function(G,W,Q){i(function($){var ee=!1,ie=function(ae,oe,de,le){try{ae.call(oe,de,le)}catch(fe){return fe}}(Q,W,function(ae){ee||(ee=!0,W!==ae?C($,ae):L($,ae))},function(ae){ee||(ee=!0,I($,ae))},$._label);!ee&&ie&&(ee=!0,I($,ie))},G)}(F,H,j):L(F,H)}function C(F,H){if(F===H)I(F,new TypeError("You cannot resolve a promise with itself"));else if(W=typeof(G=H),G===null||W!=="object"&&W!=="function")L(F,H);else{var j=void 0;try{j=H.then}catch(Q){return void I(F,Q)}S(F,H,j)}var G,W}function k(F){F._onerror&&F._onerror(F._result),V(F)}function L(F,H){F._state===void 0&&(F._result=H,F._state=1,F._subscribers.length!==0&&i(V,F))}function I(F,H){F._state===void 0&&(F._state=2,F._result=H,i(k,F))}function R(F,H,j,G){var W=F._subscribers,Q=W.length;F._onerror=null,W[Q]=H,W[Q+1]=j,W[Q+2]=G,Q===0&&F._state&&i(V,F)}function V(F){var H=F._subscribers,j=F._state;if(H.length!==0){for(var G=void 0,W=void 0,Q=F._result,$=0;$<H.length;$+=3)G=H[$],W=H[$+j],G?O(j,G,W,Q):W(Q);F._subscribers.length=0}}function O(F,H,j,G){var W=p(j),Q=void 0,$=void 0,ee=!0;if(W){try{Q=j(G)}catch(ie){ee=!1,$=ie}if(H===Q)return void I(H,new TypeError("A promises callback cannot return that same promise."))}else Q=G;H._state!==void 0||(W&&ee?C(H,Q):ee===!1?I(H,$):F===1?L(H,Q):F===2&&I(H,Q))}var J=0;function D(F){F[b]=J++,F._state=void 0,F._result=void 0,F._subscribers=[]}var B=function(){function F(H,j){this._instanceConstructor=H,this.promise=new H(_),this.promise[b]||D(this.promise),l(j)?(this.length=j.length,this._remaining=j.length,this._result=new Array(this.length),this.length===0?L(this.promise,this._result):(this.length=this.length||0,this._enumerate(j),this._remaining===0&&L(this.promise,this._result))):I(this.promise,new Error("Array Methods must be provided an Array"))}return F.prototype._enumerate=function(H){for(var j=0;this._state===void 0&&j<H.length;j++)this._eachEntry(H[j],j)},F.prototype._eachEntry=function(H,j){var G=this._instanceConstructor,W=G.resolve;if(W===M){var Q=void 0,$=void 0,ee=!1;try{Q=H.then}catch(ae){ee=!0,$=ae}if(Q===E&&H._state!==void 0)this._settledAt(H._state,j,H._result);else if(typeof Q!="function")this._remaining--,this._result[j]=H;else if(G===N){var ie=new G(_);ee?I(ie,$):S(ie,H,Q),this._willSettleAt(ie,j)}else this._willSettleAt(new G(function(ae){return ae(H)}),j)}else this._willSettleAt(W(H),j)},F.prototype._settledAt=function(H,j,G){var W=this.promise;W._state===void 0&&(this._remaining--,H===2?I(W,G):this._result[j]=G),this._remaining===0&&L(W,this._result)},F.prototype._willSettleAt=function(H,j){var G=this;R(H,void 0,function(W){return G._settledAt(1,j,W)},function(W){return G._settledAt(2,j,W)})},F}(),N=function(){function F(H){this[b]=J++,this._result=this._state=void 0,this._subscribers=[],_!==H&&(typeof H!="function"&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof F?function(j,G){try{G(function(W){C(j,W)},function(W){I(j,W)})}catch(W){I(j,W)}}(this,H):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return F.prototype.catch=function(H){return this.then(null,H)},F.prototype.finally=function(H){var j=this.constructor;return p(H)?this.then(function(G){return j.resolve(H()).then(function(){return G})},function(G){return j.resolve(H()).then(function(){throw G})}):this.then(H,H)},F}();return N.prototype.then=E,N.all=function(F){return new B(this,F).promise},N.race=function(F){var H=this;return l(F)?new H(function(j,G){for(var W=F.length,Q=0;Q<W;Q++)H.resolve(F[Q]).then(j,G)}):new H(function(j,G){return G(new TypeError("You must pass an array to race."))})},N.resolve=M,N.reject=function(F){var H=new this(_);return I(H,F),H},N._setScheduler=function(F){r=F},N._setAsap=function(F){i=F},N._asap=i,N.polyfill=function(){var F=void 0;if(typeof h<"u")F=h;else if(typeof self<"u")F=self;else try{F=Function("return this")()}catch{throw new Error("polyfill failed because global object is unavailable in this environment")}var H=F.Promise;if(H){var j=null;try{j=Object.prototype.toString.call(H.resolve())}catch{}if(j==="[object Promise]"&&!H.cast)return}F.Promise=N},N.Promise=N,N})}).call(this)}).call(this,n("_process"),typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{_process:526}],225:[function(n,z,q){"use strict";z.exports=n("./is-implemented")()?n("ext/global-this").Symbol:n("./polyfill")},{"./is-implemented":226,"./polyfill":231,"ext/global-this":238}],226:[function(n,z,q){"use strict";var t=n("ext/global-this"),h={object:!0,symbol:!0};z.exports=function(){var p,l=t.Symbol;if(typeof l!="function")return!1;p=l("test symbol");try{String(p)}catch{return!1}return!!h[typeof l.iterator]&&!!h[typeof l.toPrimitive]&&!!h[typeof l.toStringTag]}},{"ext/global-this":238}],227:[function(n,z,q){"use strict";z.exports=function(t){return!!t&&(typeof t=="symbol"||!!t.constructor&&t.constructor.name==="Symbol"&&t[t.constructor.toStringTag]==="Symbol")}},{}],228:[function(n,z,q){"use strict";var t=n("d"),h=Object.create,p=Object.defineProperty,l=Object.prototype,e=h(null);z.exports=function(o){for(var r,i,u=0;e[o+(u||"")];)++u;return e[o+=u||""]=!0,p(l,r="@@"+o,t.gs(null,function(s){i||(i=!0,p(this,r,t(s)),i=!1)})),r}},{d:155}],229:[function(n,z,q){"use strict";var t=n("d"),h=n("ext/global-this").Symbol;z.exports=function(p){return Object.defineProperties(p,{hasInstance:t("",h&&h.hasInstance||p("hasInstance")),isConcatSpreadable:t("",h&&h.isConcatSpreadable||p("isConcatSpreadable")),iterator:t("",h&&h.iterator||p("iterator")),match:t("",h&&h.match||p("match")),replace:t("",h&&h.replace||p("replace")),search:t("",h&&h.search||p("search")),species:t("",h&&h.species||p("species")),split:t("",h&&h.split||p("split")),toPrimitive:t("",h&&h.toPrimitive||p("toPrimitive")),toStringTag:t("",h&&h.toStringTag||p("toStringTag")),unscopables:t("",h&&h.unscopables||p("unscopables"))})}},{d:155,"ext/global-this":238}],230:[function(n,z,q){"use strict";var t=n("d"),h=n("../../../validate-symbol"),p=Object.create(null);z.exports=function(l){return Object.defineProperties(l,{for:t(function(e){return p[e]?p[e]:p[e]=l(String(e))}),keyFor:t(function(e){var o;for(o in h(e),p)if(p[o]===e)return o})})}},{"../../../validate-symbol":232,d:155}],231:[function(n,z,q){"use strict";var t,h,p,l=n("d"),e=n("./validate-symbol"),o=n("ext/global-this").Symbol,r=n("./lib/private/generate-name"),i=n("./lib/private/setup/standard-symbols"),u=n("./lib/private/setup/symbol-registry"),s=Object.create,a=Object.defineProperties,c=Object.defineProperty;if(typeof o=="function")try{String(o()),p=!0}catch{}else o=null;h=function(f){if(this instanceof h)throw new TypeError("Symbol is not a constructor");return t(f)},z.exports=t=function f(g){var d;if(this instanceof f)throw new TypeError("Symbol is not a constructor");return p?o(g):(d=s(h.prototype),g=g===void 0?"":String(g),a(d,{__description__:l("",g),__name__:l("",r(g))}))},i(t),u(t),a(h.prototype,{constructor:l(t),toString:l("",function(){return this.__name__})}),a(t.prototype,{toString:l(function(){return"Symbol ("+e(this).__description__+")"}),valueOf:l(function(){return e(this)})}),c(t.prototype,t.toPrimitive,l("",function(){var f=e(this);return typeof f=="symbol"?f:f.toString()})),c(t.prototype,t.toStringTag,l("c","Symbol")),c(h.prototype,t.toStringTag,l("c",t.prototype[t.toStringTag])),c(h.prototype,t.toPrimitive,l("c",t.prototype[t.toPrimitive]))},{"./lib/private/generate-name":228,"./lib/private/setup/standard-symbols":229,"./lib/private/setup/symbol-registry":230,"./validate-symbol":232,d:155,"ext/global-this":238}],232:[function(n,z,q){"use strict";var t=n("./is-symbol");z.exports=function(h){if(!t(h))throw new TypeError(h+" is not a symbol");return h}},{"./is-symbol":227}],233:[function(n,z,q){"use strict";z.exports=n("./is-implemented")()?WeakMap:n("./polyfill")},{"./is-implemented":234,"./polyfill":236}],234:[function(n,z,q){"use strict";z.exports=function(){var t,h;if(typeof WeakMap!="function")return!1;try{t=new WeakMap([[h={},"one"],[{},"two"],[{},"three"]])}catch{return!1}return String(t)==="[object WeakMap]"&&typeof t.set=="function"&&t.set({},1)===t&&typeof t.delete=="function"&&typeof t.has=="function"&&t.get(h)==="one"}},{}],235:[function(n,z,q){"use strict";z.exports=typeof WeakMap=="function"&&Object.prototype.toString.call(new WeakMap)==="[object WeakMap]"},{}],236:[function(n,z,q){"use strict";var t,h=n("es5-ext/object/is-value"),p=n("es5-ext/object/set-prototype-of"),l=n("es5-ext/object/valid-object"),e=n("es5-ext/object/valid-value"),o=n("es5-ext/string/random-uniq"),r=n("d"),i=n("es6-iterator/get"),u=n("es6-iterator/for-of"),s=n("es6-symbol").toStringTag,a=n("./is-native-implemented"),c=Array.isArray,f=Object.defineProperty,g=Object.prototype.hasOwnProperty,d=Object.getPrototypeOf;z.exports=t=function(){var m,y=arguments[0];if(!(this instanceof t))throw new TypeError("Constructor requires 'new'");return m=a&&p&&WeakMap!==t?p(new WeakMap,d(this)):this,h(y)&&(c(y)||(y=i(y))),f(m,"__weakMapData__",r("c","$weakMap$"+o())),y&&u(y,function(v){e(v),m.set(v[0],v[1])}),m},a&&(p&&p(t,WeakMap),t.prototype=Object.create(WeakMap.prototype,{constructor:r(t)})),Object.defineProperties(t.prototype,{delete:r(function(m){return!!g.call(l(m),this.__weakMapData__)&&(delete m[this.__weakMapData__],!0)}),get:r(function(m){if(g.call(l(m),this.__weakMapData__))return m[this.__weakMapData__]}),has:r(function(m){return g.call(l(m),this.__weakMapData__)}),set:r(function(m,y){return f(l(m),this.__weakMapData__,r("c",y)),this}),toString:r(function(){return"[object WeakMap]"})}),f(t.prototype,s,r("c","WeakMap"))},{"./is-native-implemented":235,d:155,"es5-ext/object/is-value":200,"es5-ext/object/set-prototype-of":206,"es5-ext/object/valid-object":210,"es5-ext/object/valid-value":211,"es5-ext/string/random-uniq":216,"es6-iterator/for-of":218,"es6-iterator/get":219,"es6-symbol":225}],237:[function(n,z,q){var t=function(){if(typeof self=="object"&&self)return self;if(typeof window=="object"&&window)return window;throw new Error("Unable to resolve global `this`")};z.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch{return t()}try{return __global__||t()}finally{delete Object.prototype.__global__}}()},{}],238:[function(n,z,q){"use strict";z.exports=n("./is-implemented")()?globalThis:n("./implementation")},{"./implementation":237,"./is-implemented":239}],239:[function(n,z,q){"use strict";z.exports=function(){return typeof globalThis=="object"&&!!globalThis&&globalThis.Array===Array}},{}],240:[function(n,z,q){"use strict";z.exports=function(t,h,p){var l=h||0,e=p||1;return[[t[12]+t[0],t[13]+t[1],t[14]+t[2],t[15]+t[3]],[t[12]-t[0],t[13]-t[1],t[14]-t[2],t[15]-t[3]],[t[12]+t[4],t[13]+t[5],t[14]+t[6],t[15]+t[7]],[t[12]-t[4],t[13]-t[5],t[14]-t[6],t[15]-t[7]],[l*t[12]+t[8],l*t[13]+t[9],l*t[14]+t[10],l*t[15]+t[11]],[e*t[12]-t[8],e*t[13]-t[9],e*t[14]-t[10],e*t[15]-t[11]]]}},{}],241:[function(n,z,q){"use strict";var t=n("is-string-blank");z.exports=function(h){var p=typeof h;if(p==="string"){var l=h;if((h=+h)==0&&t(l))return!1}else if(p!=="number")return!1;return h-h<1}},{"is-string-blank":470}],242:[function(n,z,q){"use strict";z.exports=function(r,i,u){switch(arguments.length){case 0:return new l([0],[0],0);case 1:return typeof r=="number"?new l(s=o(r),s,0):new l(r,o(r.length),0);case 2:if(typeof i=="number"){var s=o(r.length);return new l(r,s,+i)}u=0;case 3:if(r.length!==i.length)throw new Error("state and velocity lengths must match");return new l(r,i,u)}};var t=n("cubic-hermite"),h=n("binary-search-bounds");function p(r,i,u){return Math.min(i,Math.max(r,u))}function l(r,i,u){this.dimension=r.length,this.bounds=[new Array(this.dimension),new Array(this.dimension)];for(var s=0;s<this.dimension;++s)this.bounds[0][s]=-1/0,this.bounds[1][s]=1/0;this._state=r.slice().reverse(),this._velocity=i.slice().reverse(),this._time=[u],this._scratch=[r.slice(),r.slice(),r.slice(),r.slice(),r.slice()]}var e=l.prototype;function o(r){for(var i=new Array(r),u=0;u<r;++u)i[u]=0;return i}e.flush=function(r){var i=h.gt(this._time,r)-1;i<=0||(this._time.splice(0,i),this._state.splice(0,i*this.dimension),this._velocity.splice(0,i*this.dimension))},e.curve=function(r){var i=this._time,u=i.length,s=h.le(i,r),a=this._scratch[0],c=this._state,f=this._velocity,g=this.dimension,d=this.bounds;if(s<0)for(var m=g-1,y=0;y<g;++y,--m)a[y]=c[m];else if(s>=u-1){m=c.length-1;var v=r-i[u-1];for(y=0;y<g;++y,--m)a[y]=c[m]+v*f[m]}else{m=g*(s+1)-1;var T=i[s],w=i[s+1]-T||1,A=this._scratch[1],E=this._scratch[2],M=this._scratch[3],b=this._scratch[4],_=!0;for(y=0;y<g;++y,--m)A[y]=c[m],M[y]=f[m]*w,E[y]=c[m+g],b[y]=f[m+g]*w,_=_&&A[y]===E[y]&&M[y]===b[y]&&M[y]===0;if(_)for(y=0;y<g;++y)a[y]=A[y];else t(A,M,E,b,(r-T)/w,a)}var S=d[0],C=d[1];for(y=0;y<g;++y)a[y]=p(S[y],C[y],a[y]);return a},e.dcurve=function(r){var i=this._time,u=i.length,s=h.le(i,r),a=this._scratch[0],c=this._state,f=this._velocity,g=this.dimension;if(s>=u-1)for(var d=c.length-1,m=(i[u-1],0);m<g;++m,--d)a[m]=f[d];else{d=g*(s+1)-1;var y=i[s],v=i[s+1]-y||1,T=this._scratch[1],w=this._scratch[2],A=this._scratch[3],E=this._scratch[4],M=!0;for(m=0;m<g;++m,--d)T[m]=c[d],A[m]=f[d]*v,w[m]=c[d+g],E[m]=f[d+g]*v,M=M&&T[m]===w[m]&&A[m]===E[m]&&A[m]===0;if(M)for(m=0;m<g;++m)a[m]=0;else for(t.derivative(T,A,w,E,(r-y)/v,a),m=0;m<g;++m)a[m]/=v}return a},e.lastT=function(){var r=this._time;return r[r.length-1]},e.stable=function(){for(var r=this._velocity,i=r.length,u=this.dimension-1;u>=0;--u)if(r[--i])return!1;return!0},e.jump=function(r){var i=this.lastT(),u=this.dimension;if(!(r<i||arguments.length!==u+1)){var s=this._state,a=this._velocity,c=s.length-this.dimension,f=this.bounds,g=f[0],d=f[1];this._time.push(i,r);for(var m=0;m<2;++m)for(var y=0;y<u;++y)s.push(s[c++]),a.push(0);for(this._time.push(r),y=u;y>0;--y)s.push(p(g[y-1],d[y-1],arguments[y])),a.push(0)}},e.push=function(r){var i=this.lastT(),u=this.dimension;if(!(r<i||arguments.length!==u+1)){var s=this._state,a=this._velocity,c=s.length-this.dimension,f=r-i,g=this.bounds,d=g[0],m=g[1],y=f>1e-6?1/f:0;this._time.push(r);for(var v=u;v>0;--v){var T=p(d[v-1],m[v-1],arguments[v]);s.push(T),a.push((T-s[c++])*y)}}},e.set=function(r){var i=this.dimension;if(!(r<this.lastT()||arguments.length!==i+1)){var u=this._state,s=this._velocity,a=this.bounds,c=a[0],f=a[1];this._time.push(r);for(var g=i;g>0;--g)u.push(p(c[g-1],f[g-1],arguments[g])),s.push(0)}},e.move=function(r){var i=this.lastT(),u=this.dimension;if(!(r<=i||arguments.length!==u+1)){var s=this._state,a=this._velocity,c=s.length-this.dimension,f=this.bounds,g=f[0],d=f[1],m=r-i,y=m>1e-6?1/m:0;this._time.push(r);for(var v=u;v>0;--v){var T=arguments[v];s.push(p(g[v-1],d[v-1],s[c++]+T)),a.push(T*y)}}},e.idle=function(r){var i=this.lastT();if(!(r<i)){var u=this.dimension,s=this._state,a=this._velocity,c=s.length-u,f=this.bounds,g=f[0],d=f[1],m=r-i;this._time.push(r);for(var y=u-1;y>=0;--y)s.push(p(g[y],d[y],s[c]+m*a[c])),a.push(0),c+=1}}},{"binary-search-bounds":243,"cubic-hermite":150}],243:[function(n,z,q){"use strict";function t(p,l,e,o,r,i){var u=["function ",p,"(a,l,h,",o.join(","),"){",i?"":"var i=",e?"l-1":"h+1",";while(l<=h){var m=(l+h)>>>1,x=a",r?".get(m)":"[m]"];return i?l.indexOf("c")<0?u.push(";if(x===y){return m}else if(x<=y){"):u.push(";var p=c(x,y);if(p===0){return m}else if(p<=0){"):u.push(";if(",l,"){i=m;"),e?u.push("l=m+1}else{h=m-1}"):u.push("h=m-1}else{l=m+1}"),u.push("}"),i?u.push("return -1};"):u.push("return i};"),u.join("")}function h(p,l,e,o){return new Function([t("A","x"+p+"y",l,["y"],!1,o),t("B","x"+p+"y",l,["y"],!0,o),t("P","c(x,y)"+p+"0",l,["y","c"],!1,o),t("Q","c(x,y)"+p+"0",l,["y","c"],!0,o),"function dispatchBsearch",e,"(a,y,c,l,h){if(a.shape){if(typeof(c)==='function'){return Q(a,(l===undefined)?0:l|0,(h===undefined)?a.shape[0]-1:h|0,y,c)}else{return B(a,(c===undefined)?0:c|0,(l===undefined)?a.shape[0]-1:l|0,y)}}else{if(typeof(c)==='function'){return P(a,(l===undefined)?0:l|0,(h===undefined)?a.length-1:h|0,y,c)}else{return A(a,(c===undefined)?0:c|0,(l===undefined)?a.length-1:l|0,y)}}}return dispatchBsearch",e].join(""))()}z.exports={ge:h(">=",!1,"GE"),gt:h(">",!1,"GT"),lt:h("<",!0,"LT"),le:h("<=",!0,"LE"),eq:h("-",!0,"EQ",!0)}},{}],244:[function(n,z,q){var t=n("dtype");z.exports=function(h,p,l){if(!h)throw new TypeError("must specify data as first parameter");if(l=0|+(l||0),Array.isArray(h)&&h[0]&&typeof h[0][0]=="number"){var e,o,r,i,u=h[0].length,s=h.length*u;p&&typeof p!="string"||(p=new(t(p||"float32"))(s+l));var a=p.length-l;if(s!==a)throw new Error("source length "+s+" ("+u+"x"+h.length+") does not match destination length "+a);for(e=0,r=l;e<h.length;e++)for(o=0;o<u;o++)p[r++]=h[e][o]===null?NaN:h[e][o]}else if(p&&typeof p!="string")p.set(h,l);else{var c=t(p||"float32");if(Array.isArray(h)||p==="array")for(p=new c(h.length+l),e=0,r=l,i=p.length;r<i;r++,e++)p[r]=h[e]===null?NaN:h[e];else l===0?p=new c(h):(p=new c(h.length+l)).set(h,l)}return p}},{dtype:175}],245:[function(n,z,q){"use strict";var t=n("css-font/stringify"),h=[32,126];z.exports=function(p){var l=(p=p||{}).shape?p.shape:p.canvas?[p.canvas.width,p.canvas.height]:[512,512],e=p.canvas||document.createElement("canvas"),o=p.font,r=typeof p.step=="number"?[p.step,p.step]:p.step||[32,32],i=p.chars||h;if(o&&typeof o!="string"&&(o=t(o)),Array.isArray(i)){if(i.length===2&&typeof i[0]=="number"&&typeof i[1]=="number"){for(var u=[],s=i[0],a=0;s<=i[1];s++)u[a++]=String.fromCharCode(s);i=u}}else i=String(i).split("");l=l.slice(),e.width=l[0],e.height=l[1];var c=e.getContext("2d");c.fillStyle="#000",c.fillRect(0,0,e.width,e.height),c.font=o,c.textAlign="center",c.textBaseline="middle",c.fillStyle="#fff";var f=r[0]/2,g=r[1]/2;for(s=0;s<i.length;s++)c.fillText(i[s],f,g),(f+=r[0])>l[0]-r[0]/2&&(f=r[0]/2,g+=r[1]);return e}},{"css-font/stringify":147}],246:[function(n,z,q){"use strict";function t(e,o){o||(o={}),(typeof e=="string"||Array.isArray(e))&&(o.family=e);var r=Array.isArray(o.family)?o.family.join(", "):o.family;if(!r)throw Error("`family` must be defined");var i=o.size||o.fontSize||o.em||48,u=o.weight||o.fontWeight||"",s=(e=[o.style||o.fontStyle||"",u,i].join(" ")+"px "+r,o.origin||"top");if(t.cache[r]&&i<=t.cache[r].em)return h(t.cache[r],s);var a=o.canvas||t.canvas,c=a.getContext("2d"),f={upper:o.upper!==void 0?o.upper:"H",lower:o.lower!==void 0?o.lower:"x",descent:o.descent!==void 0?o.descent:"p",ascent:o.ascent!==void 0?o.ascent:"h",tittle:o.tittle!==void 0?o.tittle:"i",overshoot:o.overshoot!==void 0?o.overshoot:"O"},g=Math.ceil(1.5*i);a.height=g,a.width=.5*g,c.font=e;var d={top:0};c.clearRect(0,0,g,g),c.textBaseline="top",c.fillStyle="black",c.fillText("H",0,0);var m=p(c.getImageData(0,0,g,g));c.clearRect(0,0,g,g),c.textBaseline="bottom",c.fillText("H",0,g);var y=p(c.getImageData(0,0,g,g));d.lineHeight=d.bottom=g-y+m,c.clearRect(0,0,g,g),c.textBaseline="alphabetic",c.fillText("H",0,g);var v=g-p(c.getImageData(0,0,g,g))-1+m;d.baseline=d.alphabetic=v,c.clearRect(0,0,g,g),c.textBaseline="middle",c.fillText("H",0,.5*g);var T=p(c.getImageData(0,0,g,g));d.median=d.middle=g-T-1+m-.5*g,c.clearRect(0,0,g,g),c.textBaseline="hanging",c.fillText("H",0,.5*g);var w=p(c.getImageData(0,0,g,g));d.hanging=g-w-1+m-.5*g,c.clearRect(0,0,g,g),c.textBaseline="ideographic",c.fillText("H",0,g);var A=p(c.getImageData(0,0,g,g));if(d.ideographic=g-A-1+m,f.upper&&(c.clearRect(0,0,g,g),c.textBaseline="top",c.fillText(f.upper,0,0),d.upper=p(c.getImageData(0,0,g,g)),d.capHeight=d.baseline-d.upper),f.lower&&(c.clearRect(0,0,g,g),c.textBaseline="top",c.fillText(f.lower,0,0),d.lower=p(c.getImageData(0,0,g,g)),d.xHeight=d.baseline-d.lower),f.tittle&&(c.clearRect(0,0,g,g),c.textBaseline="top",c.fillText(f.tittle,0,0),d.tittle=p(c.getImageData(0,0,g,g))),f.ascent&&(c.clearRect(0,0,g,g),c.textBaseline="top",c.fillText(f.ascent,0,0),d.ascent=p(c.getImageData(0,0,g,g))),f.descent&&(c.clearRect(0,0,g,g),c.textBaseline="top",c.fillText(f.descent,0,0),d.descent=l(c.getImageData(0,0,g,g))),f.overshoot){c.clearRect(0,0,g,g),c.textBaseline="top",c.fillText(f.overshoot,0,0);var E=l(c.getImageData(0,0,g,g));d.overshoot=E-v}for(var M in d)d[M]/=i;return d.em=i,t.cache[r]=d,h(d,s)}function h(e,o){var r={};for(var i in typeof o=="string"&&(o=e[o]),e)i!=="em"&&(r[i]=e[i]-o);return r}function p(e){for(var o=e.height,r=e.data,i=3;i<r.length;i+=4)if(r[i]!==0)return Math.floor(.25*(i-3)/o)}function l(e){for(var o=e.height,r=e.data,i=r.length-1;i>0;i-=4)if(r[i]!==0)return Math.floor(.25*(i-3)/o)}z.exports=t,t.canvas=document.createElement("canvas"),t.cache={}},{}],247:[function(n,z,q){"use strict";z.exports=function(g){return new e(g||f,null)};function t(g,d,m,y,v,T){this._color=g,this.key=d,this.value=m,this.left=y,this.right=v,this._count=T}function h(g){return new t(g._color,g.key,g.value,g.left,g.right,g._count)}function p(g,d){return new t(g,d.key,d.value,d.left,d.right,d._count)}function l(g){g._count=1+(g.left?g.left._count:0)+(g.right?g.right._count:0)}function e(g,d){this._compare=g,this.root=d}var o=e.prototype;function r(g,d){var m;return d.left&&(m=r(g,d.left))?m:(m=g(d.key,d.value))||(d.right?r(g,d.right):void 0)}function i(g,d,m,y){if(d(g,y.key)<=0){var v;if(y.left&&(v=i(g,d,m,y.left))||(v=m(y.key,y.value)))return v}if(y.right)return i(g,d,m,y.right)}function u(g,d,m,y,v){var T,w=m(g,v.key),A=m(d,v.key);if(w<=0&&(v.left&&(T=u(g,d,m,y,v.left))||A>0&&(T=y(v.key,v.value))))return T;if(A>0&&v.right)return u(g,d,m,y,v.right)}function s(g,d){this.tree=g,this._stack=d}Object.defineProperty(o,"keys",{get:function(){var g=[];return this.forEach(function(d,m){g.push(d)}),g}}),Object.defineProperty(o,"values",{get:function(){var g=[];return this.forEach(function(d,m){g.push(m)}),g}}),Object.defineProperty(o,"length",{get:function(){return this.root?this.root._count:0}}),o.insert=function(g,d){for(var m=this._compare,y=this.root,v=[],T=[];y;){var w=m(g,y.key);v.push(y),T.push(w),y=w<=0?y.left:y.right}v.push(new t(0,g,d,null,null,1));for(var A=v.length-2;A>=0;--A)y=v[A],T[A]<=0?v[A]=new t(y._color,y.key,y.value,v[A+1],y.right,y._count+1):v[A]=new t(y._color,y.key,y.value,y.left,v[A+1],y._count+1);for(A=v.length-1;A>1;--A){var E=v[A-1];if(y=v[A],E._color===1||y._color===1)break;var M=v[A-2];if(M.left===E)if(E.left===y){if(!(b=M.right)||b._color!==0){M._color=0,M.left=E.right,E._color=1,E.right=M,v[A-2]=E,v[A-1]=y,l(M),l(E),A>=3&&((_=v[A-3]).left===M?_.left=E:_.right=E);break}E._color=1,M.right=p(1,b),M._color=0,A-=1}else{if(!(b=M.right)||b._color!==0){E.right=y.left,M._color=0,M.left=y.right,y._color=1,y.left=E,y.right=M,v[A-2]=y,v[A-1]=E,l(M),l(E),l(y),A>=3&&((_=v[A-3]).left===M?_.left=y:_.right=y);break}E._color=1,M.right=p(1,b),M._color=0,A-=1}else if(E.right===y){if(!(b=M.left)||b._color!==0){M._color=0,M.right=E.left,E._color=1,E.left=M,v[A-2]=E,v[A-1]=y,l(M),l(E),A>=3&&((_=v[A-3]).right===M?_.right=E:_.left=E);break}E._color=1,M.left=p(1,b),M._color=0,A-=1}else{var b;if(!(b=M.left)||b._color!==0){var _;E.left=y.right,M._color=0,M.right=y.left,y._color=1,y.right=E,y.left=M,v[A-2]=y,v[A-1]=E,l(M),l(E),l(y),A>=3&&((_=v[A-3]).right===M?_.right=y:_.left=y);break}E._color=1,M.left=p(1,b),M._color=0,A-=1}}return v[0]._color=1,new e(m,v[0])},o.forEach=function(g,d,m){if(this.root)switch(arguments.length){case 1:return r(g,this.root);case 2:return i(d,this._compare,g,this.root);case 3:return this._compare(d,m)>=0?void 0:u(d,m,this._compare,g,this.root)}},Object.defineProperty(o,"begin",{get:function(){for(var g=[],d=this.root;d;)g.push(d),d=d.left;return new s(this,g)}}),Object.defineProperty(o,"end",{get:function(){for(var g=[],d=this.root;d;)g.push(d),d=d.right;return new s(this,g)}}),o.at=function(g){if(g<0)return new s(this,[]);for(var d=this.root,m=[];;){if(m.push(d),d.left){if(g<d.left._count){d=d.left;continue}g-=d.left._count}if(!g)return new s(this,m);if(g-=1,!d.right||g>=d.right._count)break;d=d.right}return new s(this,[])},o.ge=function(g){for(var d=this._compare,m=this.root,y=[],v=0;m;){var T=d(g,m.key);y.push(m),T<=0&&(v=y.length),m=T<=0?m.left:m.right}return y.length=v,new s(this,y)},o.gt=function(g){for(var d=this._compare,m=this.root,y=[],v=0;m;){var T=d(g,m.key);y.push(m),T<0&&(v=y.length),m=T<0?m.left:m.right}return y.length=v,new s(this,y)},o.lt=function(g){for(var d=this._compare,m=this.root,y=[],v=0;m;){var T=d(g,m.key);y.push(m),T>0&&(v=y.length),m=T<=0?m.left:m.right}return y.length=v,new s(this,y)},o.le=function(g){for(var d=this._compare,m=this.root,y=[],v=0;m;){var T=d(g,m.key);y.push(m),T>=0&&(v=y.length),m=T<0?m.left:m.right}return y.length=v,new s(this,y)},o.find=function(g){for(var d=this._compare,m=this.root,y=[];m;){var v=d(g,m.key);if(y.push(m),v===0)return new s(this,y);m=v<=0?m.left:m.right}return new s(this,[])},o.remove=function(g){var d=this.find(g);return d?d.remove():this},o.get=function(g){for(var d=this._compare,m=this.root;m;){var y=d(g,m.key);if(y===0)return m.value;m=y<=0?m.left:m.right}};var a=s.prototype;function c(g,d){g.key=d.key,g.value=d.value,g.left=d.left,g.right=d.right,g._color=d._color,g._count=d._count}function f(g,d){return g<d?-1:g>d?1:0}Object.defineProperty(a,"valid",{get:function(){return this._stack.length>0}}),Object.defineProperty(a,"node",{get:function(){return this._stack.length>0?this._stack[this._stack.length-1]:null},enumerable:!0}),a.clone=function(){return new s(this.tree,this._stack.slice())},a.remove=function(){var g=this._stack;if(g.length===0)return this.tree;var d=new Array(g.length),m=g[g.length-1];d[d.length-1]=new t(m._color,m.key,m.value,m.left,m.right,m._count);for(var y=g.length-2;y>=0;--y)(m=g[y]).left===g[y+1]?d[y]=new t(m._color,m.key,m.value,d[y+1],m.right,m._count):d[y]=new t(m._color,m.key,m.value,m.left,d[y+1],m._count);if((m=d[d.length-1]).left&&m.right){var v=d.length;for(m=m.left;m.right;)d.push(m),m=m.right;var T=d[v-1];for(d.push(new t(m._color,T.key,T.value,m.left,m.right,m._count)),d[v-1].key=m.key,d[v-1].value=m.value,y=d.length-2;y>=v;--y)m=d[y],d[y]=new t(m._color,m.key,m.value,m.left,d[y+1],m._count);d[v-1].left=d[v]}if((m=d[d.length-1])._color===0){var w=d[d.length-2];for(w.left===m?w.left=null:w.right===m&&(w.right=null),d.pop(),y=0;y<d.length;++y)d[y]._count--;return new e(this.tree._compare,d[0])}if(m.left||m.right){for(m.left?c(m,m.left):m.right&&c(m,m.right),m._color=1,y=0;y<d.length-1;++y)d[y]._count--;return new e(this.tree._compare,d[0])}if(d.length===1)return new e(this.tree._compare,null);for(y=0;y<d.length;++y)d[y]._count--;var A=d[d.length-2];return function(E){for(var M,b,_,S,C=E.length-1;C>=0;--C){if(M=E[C],C===0)return void(M._color=1);if((b=E[C-1]).left===M){if((_=b.right).right&&_.right._color===0)return S=(_=b.right=h(_)).right=h(_.right),b.right=_.left,_.left=b,_.right=S,_._color=b._color,M._color=1,b._color=1,S._color=1,l(b),l(_),C>1&&((k=E[C-2]).left===b?k.left=_:k.right=_),void(E[C-1]=_);if(_.left&&_.left._color===0)return S=(_=b.right=h(_)).left=h(_.left),b.right=S.left,_.left=S.right,S.left=b,S.right=_,S._color=b._color,b._color=1,_._color=1,M._color=1,l(b),l(_),l(S),C>1&&((k=E[C-2]).left===b?k.left=S:k.right=S),void(E[C-1]=S);if(_._color===1){if(b._color===0)return b._color=1,void(b.right=p(0,_));b.right=p(0,_);continue}_=h(_),b.right=_.left,_.left=b,_._color=b._color,b._color=0,l(b),l(_),C>1&&((k=E[C-2]).left===b?k.left=_:k.right=_),E[C-1]=_,E[C]=b,C+1<E.length?E[C+1]=M:E.push(M),C+=2}else{if((_=b.left).left&&_.left._color===0)return S=(_=b.left=h(_)).left=h(_.left),b.left=_.right,_.right=b,_.left=S,_._color=b._color,M._color=1,b._color=1,S._color=1,l(b),l(_),C>1&&((k=E[C-2]).right===b?k.right=_:k.left=_),void(E[C-1]=_);if(_.right&&_.right._color===0)return S=(_=b.left=h(_)).right=h(_.right),b.left=S.right,_.right=S.left,S.right=b,S.left=_,S._color=b._color,b._color=1,_._color=1,M._color=1,l(b),l(_),l(S),C>1&&((k=E[C-2]).right===b?k.right=S:k.left=S),void(E[C-1]=S);if(_._color===1){if(b._color===0)return b._color=1,void(b.left=p(0,_));b.left=p(0,_);continue}var k;_=h(_),b.left=_.right,_.right=b,_._color=b._color,b._color=0,l(b),l(_),C>1&&((k=E[C-2]).right===b?k.right=_:k.left=_),E[C-1]=_,E[C]=b,C+1<E.length?E[C+1]=M:E.push(M),C+=2}}}(d),A.left===m?A.left=null:A.right=null,new e(this.tree._compare,d[0])},Object.defineProperty(a,"key",{get:function(){if(this._stack.length>0)return this._stack[this._stack.length-1].key},enumerable:!0}),Object.defineProperty(a,"value",{get:function(){if(this._stack.length>0)return this._stack[this._stack.length-1].value},enumerable:!0}),Object.defineProperty(a,"index",{get:function(){var g=0,d=this._stack;if(d.length===0){var m=this.tree.root;return m?m._count:0}d[d.length-1].left&&(g=d[d.length-1].left._count);for(var y=d.length-2;y>=0;--y)d[y+1]===d[y].right&&(++g,d[y].left&&(g+=d[y].left._count));return g},enumerable:!0}),a.next=function(){var g=this._stack;if(g.length!==0){var d=g[g.length-1];if(d.right)for(d=d.right;d;)g.push(d),d=d.left;else for(g.pop();g.length>0&&g[g.length-1].right===d;)d=g[g.length-1],g.pop()}},Object.defineProperty(a,"hasNext",{get:function(){var g=this._stack;if(g.length===0)return!1;if(g[g.length-1].right)return!0;for(var d=g.length-1;d>0;--d)if(g[d-1].left===g[d])return!0;return!1}}),a.update=function(g){var d=this._stack;if(d.length===0)throw new Error("Can't update empty node!");var m=new Array(d.length),y=d[d.length-1];m[m.length-1]=new t(y._color,y.key,g,y.left,y.right,y._count);for(var v=d.length-2;v>=0;--v)(y=d[v]).left===d[v+1]?m[v]=new t(y._color,y.key,y.value,m[v+1],y.right,y._count):m[v]=new t(y._color,y.key,y.value,y.left,m[v+1],y._count);return new e(this.tree._compare,m[0])},a.prev=function(){var g=this._stack;if(g.length!==0){var d=g[g.length-1];if(d.left)for(d=d.left;d;)g.push(d),d=d.right;else for(g.pop();g.length>0&&g[g.length-1].left===d;)d=g[g.length-1],g.pop()}},Object.defineProperty(a,"hasPrev",{get:function(){var g=this._stack;if(g.length===0)return!1;if(g[g.length-1].left)return!0;for(var d=g.length-1;d>0;--d)if(g[d-1].right===g[d])return!0;return!1}})},{}],248:[function(n,z,q){var t=[.9999999999998099,676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9984369578019572e-21,15056327351493116e-23],h=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22];function p(l){if(l<0)return+"0/0";for(var e=h[0],o=h.length-1;o>0;--o)e+=h[o]/(l+o);var r=l+607/128+.5;return .5*Math.log(2*Math.PI)+(l+.5)*Math.log(r)-r+Math.log(e)-Math.log(l)}z.exports=function l(e){if(e<.5)return Math.PI/(Math.sin(Math.PI*e)*l(1-e));if(e>100)return Math.exp(p(e));e-=1;for(var o=t[0],r=1;r<9;r++)o+=t[r]/(e+r);var i=e+7+.5;return Math.sqrt(2*Math.PI)*Math.pow(i,e+.5)*Math.exp(-i)*o},z.exports.log=p},{}],249:[function(n,z,q){z.exports=function(t,h){if(typeof t!="string")throw new TypeError("must specify type string");if(h=h||{},typeof document>"u"&&!h.canvas)return null;var p=h.canvas||document.createElement("canvas");typeof h.width=="number"&&(p.width=h.width),typeof h.height=="number"&&(p.height=h.height);var l,e=h;try{var o=[t];t.indexOf("webgl")===0&&o.push("experimental-"+t);for(var r=0;r<o.length;r++)if(l=p.getContext(o[r],e))return l}catch{l=null}return l||null}},{}],250:[function(n,z,q){"use strict";z.exports=function(v,T){var w=new i(v);return w.update(T),w};var t=n("./lib/text.js"),h=n("./lib/lines.js"),p=n("./lib/background.js"),l=n("./lib/cube.js"),e=n("./lib/ticks.js"),o=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);function r(v,T){return v[0]=T[0],v[1]=T[1],v[2]=T[2],v}function i(v){this.gl=v,this.pixelRatio=1,this.bounds=[[-10,-10,-10],[10,10,10]],this.ticks=[[],[],[]],this.autoTicks=!0,this.tickSpacing=[1,1,1],this.tickEnable=[!0,!0,!0],this.tickFont=["sans-serif","sans-serif","sans-serif"],this.tickSize=[12,12,12],this.tickAngle=[0,0,0],this.tickAlign=["auto","auto","auto"],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[10,10,10],this.lastCubeProps={cubeEdges:[0,0,0],axis:[0,0,0]},this.labels=["x","y","z"],this.labelEnable=[!0,!0,!0],this.labelFont="sans-serif",this.labelSize=[20,20,20],this.labelAngle=[0,0,0],this.labelAlign=["auto","auto","auto"],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[10,10,10],this.lineEnable=[!0,!0,!0],this.lineMirror=[!1,!1,!1],this.lineWidth=[1,1,1],this.lineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.lineTickEnable=[!0,!0,!0],this.lineTickMirror=[!1,!1,!1],this.lineTickLength=[0,0,0],this.lineTickWidth=[1,1,1],this.lineTickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.gridEnable=[!0,!0,!0],this.gridWidth=[1,1,1],this.gridColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroEnable=[!0,!0,!0],this.zeroLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroLineWidth=[2,2,2],this.backgroundEnable=[!1,!1,!1],this.backgroundColor=[[.8,.8,.8,.5],[.8,.8,.8,.5],[.8,.8,.8,.5]],this._firstInit=!0,this._text=null,this._lines=null,this._background=p(v)}var u=i.prototype;function s(){this.primalOffset=[0,0,0],this.primalMinor=[0,0,0],this.mirrorOffset=[0,0,0],this.mirrorMinor=[0,0,0]}u.update=function(v){function T(R,V,O){if(O in v){var J,D=v[O],B=this[O];(R?Array.isArray(D)&&Array.isArray(D[0]):Array.isArray(D))?this[O]=J=[V(D[0]),V(D[1]),V(D[2])]:this[O]=J=[V(D),V(D),V(D)];for(var N=0;N<3;++N)if(J[N]!==B[N])return!0}return!1}v=v||{};var w,A=T.bind(this,!1,Number),E=T.bind(this,!1,Boolean),M=T.bind(this,!1,String),b=T.bind(this,!0,function(R){if(Array.isArray(R)){if(R.length===3)return[+R[0],+R[1],+R[2],1];if(R.length===4)return[+R[0],+R[1],+R[2],+R[3]]}return[0,0,0,1]}),_=!1,S=!1;if("bounds"in v)for(var C=v.bounds,k=0;k<2;++k)for(var L=0;L<3;++L)C[k][L]!==this.bounds[k][L]&&(S=!0),this.bounds[k][L]=C[k][L];if("ticks"in v)for(w=v.ticks,_=!0,this.autoTicks=!1,k=0;k<3;++k)this.tickSpacing[k]=0;else A("tickSpacing")&&(this.autoTicks=!0,S=!0);if(this._firstInit&&("ticks"in v||"tickSpacing"in v||(this.autoTicks=!0),S=!0,_=!0,this._firstInit=!1),S&&this.autoTicks&&(w=e.create(this.bounds,this.tickSpacing),_=!0),_){for(k=0;k<3;++k)w[k].sort(function(R,V){return R.x-V.x});e.equal(w,this.ticks)?_=!1:this.ticks=w}E("tickEnable"),M("tickFont")&&(_=!0),A("tickSize"),A("tickAngle"),A("tickPad"),b("tickColor");var I=M("labels");M("labelFont")&&(I=!0),E("labelEnable"),A("labelSize"),A("labelPad"),b("labelColor"),E("lineEnable"),E("lineMirror"),A("lineWidth"),b("lineColor"),E("lineTickEnable"),E("lineTickMirror"),A("lineTickLength"),A("lineTickWidth"),b("lineTickColor"),E("gridEnable"),A("gridWidth"),b("gridColor"),E("zeroEnable"),b("zeroLineColor"),A("zeroLineWidth"),E("backgroundEnable"),b("backgroundColor"),this._text?this._text&&(I||_)&&this._text.update(this.bounds,this.labels,this.labelFont,this.ticks,this.tickFont):this._text=t(this.gl,this.bounds,this.labels,this.labelFont,this.ticks,this.tickFont),this._lines&&_&&(this._lines.dispose(),this._lines=null),this._lines||(this._lines=h(this.gl,this.bounds,this.ticks))};var a=[new s,new s,new s];function c(v,T,w,A,E){for(var M=v.primalOffset,b=v.primalMinor,_=v.mirrorOffset,S=v.mirrorMinor,C=A[T],k=0;k<3;++k)if(T!==k){var L=M,I=_,R=b,V=S;C&1<<k&&(L=_,I=M,R=S,V=b),L[k]=w[0][k],I[k]=w[1][k],E[k]>0?(R[k]=-1,V[k]=0):(R[k]=0,V[k]=1)}}var f=[0,0,0],g={model:o,view:o,projection:o,_ortho:!1};u.isOpaque=function(){return!0},u.isTransparent=function(){return!1},u.drawTransparent=function(v){};var d=[0,0,0],m=[0,0,0],y=[0,0,0];u.draw=function(v){v=v||g;for(var T=this.gl,w=v.model||o,A=v.view||o,E=v.projection||o,M=this.bounds,b=v._ortho||!1,_=l(w,A,E,M,b),S=_.cubeEdges,C=_.axis,k=A[12],L=A[13],I=A[14],R=A[15],V=(b?2:1)*this.pixelRatio*(E[3]*k+E[7]*L+E[11]*I+E[15]*R)/T.drawingBufferHeight,O=0;O<3;++O)this.lastCubeProps.cubeEdges[O]=S[O],this.lastCubeProps.axis[O]=C[O];var J=a;for(O=0;O<3;++O)c(a[O],O,this.bounds,S,C);T=this.gl;var D,B=f;for(O=0;O<3;++O)this.backgroundEnable[O]?B[O]=C[O]:B[O]=0;for(this._background.draw(w,A,E,M,B,this.backgroundColor),this._lines.bind(w,A,E,this),O=0;O<3;++O){var N=[0,0,0];C[O]>0?N[O]=M[1][O]:N[O]=M[0][O];for(var F=0;F<2;++F){var H=(O+1+F)%3,j=(O+1+(1^F))%3;this.gridEnable[H]&&this._lines.drawGrid(H,j,this.bounds,N,this.gridColor[H],this.gridWidth[H]*this.pixelRatio)}for(F=0;F<2;++F)H=(O+1+F)%3,j=(O+1+(1^F))%3,this.zeroEnable[j]&&Math.min(M[0][j],M[1][j])<=0&&Math.max(M[0][j],M[1][j])>=0&&this._lines.drawZero(H,j,this.bounds,N,this.zeroLineColor[j],this.zeroLineWidth[j]*this.pixelRatio)}for(O=0;O<3;++O){this.lineEnable[O]&&this._lines.drawAxisLine(O,this.bounds,J[O].primalOffset,this.lineColor[O],this.lineWidth[O]*this.pixelRatio),this.lineMirror[O]&&this._lines.drawAxisLine(O,this.bounds,J[O].mirrorOffset,this.lineColor[O],this.lineWidth[O]*this.pixelRatio);var G=r(d,J[O].primalMinor),W=r(m,J[O].mirrorMinor),Q=this.lineTickLength;for(F=0;F<3;++F){var $=V/w[5*F];G[F]*=Q[F]*$,W[F]*=Q[F]*$}this.lineTickEnable[O]&&this._lines.drawAxisTicks(O,J[O].primalOffset,G,this.lineTickColor[O],this.lineTickWidth[O]*this.pixelRatio),this.lineTickMirror[O]&&this._lines.drawAxisTicks(O,J[O].mirrorOffset,W,this.lineTickColor[O],this.lineTickWidth[O]*this.pixelRatio)}this._lines.unbind(),this._text.bind(w,A,E,this.pixelRatio);var ee,ie;function ae(we){(ie=[0,0,0])[we]=1}function oe(we,Ae,Se){var ke=(we+1)%3,Me=(we+2)%3,ve=Ae[ke],ge=Ae[Me],De=Se[ke],_e=Se[Me];ve>0&&_e>0||ve>0&&_e<0||ve<0&&_e>0||ve<0&&_e<0?ae(ke):(ge>0&&De>0||ge>0&&De<0||ge<0&&De>0||ge<0&&De<0)&&ae(Me)}for(O=0;O<3;++O){var de=J[O].primalMinor,le=J[O].mirrorMinor,fe=r(y,J[O].primalOffset);for(F=0;F<3;++F)this.lineTickEnable[O]&&(fe[F]+=V*de[F]*Math.max(this.lineTickLength[F],0)/w[5*F]);var ue=[0,0,0];if(ue[O]=1,this.tickEnable[O]){for(this.tickAngle[O]===-3600?(this.tickAngle[O]=0,this.tickAlign[O]="auto"):this.tickAlign[O]=-1,ee=1,(D=[this.tickAlign[O],.5,ee])[0]==="auto"?D[0]=0:D[0]=parseInt(""+D[0]),ie=[0,0,0],oe(O,de,le),F=0;F<3;++F)fe[F]+=V*de[F]*this.tickPad[F]/w[5*F];this._text.drawTicks(O,this.tickSize[O],this.tickAngle[O],fe,this.tickColor[O],ue,ie,D)}if(this.labelEnable[O]){for(ee=0,ie=[0,0,0],this.labels[O].length>4&&(ae(O),ee=1),(D=[this.labelAlign[O],.5,ee])[0]==="auto"?D[0]=0:D[0]=parseInt(""+D[0]),F=0;F<3;++F)fe[F]+=V*de[F]*this.labelPad[F]/w[5*F];fe[O]+=.5*(M[0][O]+M[1][O]),this._text.drawLabel(O,this.labelSize[O],this.labelAngle[O],fe,this.labelColor[O],[0,0,0],ie,D)}}this._text.unbind()},u.dispose=function(){this._text.dispose(),this._lines.dispose(),this._background.dispose(),this._lines=null,this._text=null,this._background=null,this.gl=null}},{"./lib/background.js":251,"./lib/cube.js":252,"./lib/lines.js":253,"./lib/text.js":255,"./lib/ticks.js":256}],251:[function(n,z,q){"use strict";z.exports=function(o){for(var r=[],i=[],u=0,s=0;s<3;++s)for(var a=(s+1)%3,c=(s+2)%3,f=[0,0,0],g=[0,0,0],d=-1;d<=1;d+=2){i.push(u,u+2,u+1,u+1,u+2,u+3),f[s]=d,g[s]=d;for(var m=-1;m<=1;m+=2){f[a]=m;for(var y=-1;y<=1;y+=2)f[c]=y,r.push(f[0],f[1],f[2],g[0],g[1],g[2]),u+=1}var v=a;a=c,c=v}var T=t(o,new Float32Array(r)),w=t(o,new Uint16Array(i),o.ELEMENT_ARRAY_BUFFER),A=h(o,[{buffer:T,type:o.FLOAT,size:3,offset:0,stride:24},{buffer:T,type:o.FLOAT,size:3,offset:12,stride:24}],w),E=p(o);return E.attributes.position.location=0,E.attributes.normal.location=1,new l(o,T,A,E)};var t=n("gl-buffer"),h=n("gl-vao"),p=n("./shaders").bg;function l(o,r,i,u){this.gl=o,this.buffer=r,this.vao=i,this.shader=u}var e=l.prototype;e.draw=function(o,r,i,u,s,a){for(var c=!1,f=0;f<3;++f)c=c||s[f];if(c){var g=this.gl;g.enable(g.POLYGON_OFFSET_FILL),g.polygonOffset(1,2),this.shader.bind(),this.shader.uniforms={model:o,view:r,projection:i,bounds:u,enable:s,colors:a},this.vao.bind(),this.vao.draw(this.gl.TRIANGLES,36),this.vao.unbind(),g.disable(g.POLYGON_OFFSET_FILL)}},e.dispose=function(){this.vao.dispose(),this.buffer.dispose(),this.shader.dispose()}},{"./shaders":254,"gl-buffer":259,"gl-vao":358}],252:[function(n,z,q){"use strict";z.exports=function(m,y,v,T,w){h(e,y,m),h(e,v,e);for(var A=0,E=0;E<2;++E){i[2]=T[E][2];for(var M=0;M<2;++M){i[1]=T[M][1];for(var b=0;b<2;++b)i[0]=T[b][0],s(o[A],i,e),A+=1}}var _=-1;for(E=0;E<8;++E){for(var S=o[E][3],C=0;C<3;++C)r[E][C]=o[E][C]/S;w&&(r[E][2]*=-1),S<0&&(_<0||r[E][2]<r[_][2])&&(_=E)}if(_<0){_=0;for(var k=0;k<3;++k){for(var L=(k+2)%3,I=(k+1)%3,R=-1,V=-1,O=0;O<2;++O){var J=(B=O<<k)+(O<<L)+(1-O<<I),D=B+(1-O<<L)+(O<<I);l(r[B],r[J],r[D],u)<0||(O?R=1:V=1)}if(R<0||V<0)V>R&&(_|=1<<k);else{for(O=0;O<2;++O){J=(B=O<<k)+(O<<L)+(1-O<<I),D=B+(1-O<<L)+(O<<I);var B,N=c([o[B],o[J],o[D],o[B+(1<<L)+(1<<I)]]);O?R=N:V=N}V>R&&(_|=1<<k)}}}var F=7^_,H=-1;for(E=0;E<8;++E)E!==_&&E!==F&&(H<0||r[H][1]>r[E][1])&&(H=E);var j=-1;for(E=0;E<3;++E)(W=H^1<<E)!==_&&W!==F&&(j<0&&(j=W),(I=r[W])[0]<r[j][0]&&(j=W));var G=-1;for(E=0;E<3;++E){var W;(W=H^1<<E)!==_&&W!==F&&W!==j&&(G<0&&(G=W),(I=r[W])[0]>r[G][0]&&(G=W))}var Q=f;Q[0]=Q[1]=Q[2]=0,Q[t.log2(j^H)]=H&j,Q[t.log2(H^G)]=H&G;var $=7^G;$===_||$===F?($=7^j,Q[t.log2(G^$)]=$&G):Q[t.log2(j^$)]=$&j;var ee=g,ie=_;for(k=0;k<3;++k)ee[k]=ie&1<<k?-1:1;return d};var t=n("bit-twiddle"),h=n("gl-mat4/multiply"),p=n("split-polygon"),l=n("robust-orientation"),e=new Array(16),o=new Array(8),r=new Array(8),i=new Array(3),u=[0,0,0];function s(m,y,v){for(var T=0;T<4;++T){m[T]=v[12+T];for(var w=0;w<3;++w)m[T]+=y[w]*v[4*w+T]}}(function(){for(var m=0;m<8;++m)o[m]=[1,1,1,1],r[m]=[1,1,1]})();var a=[[0,0,1,0,0],[0,0,-1,1,0],[0,-1,0,1,0],[0,1,0,1,0],[-1,0,0,1,0],[1,0,0,1,0]];function c(m){for(var y=0;y<a.length;++y)if((m=p.positive(m,a[y])).length<3)return 0;var v=m[0],T=v[0]/v[3],w=v[1]/v[3],A=0;for(y=1;y+1<m.length;++y){var E=m[y],M=m[y+1],b=E[0]/E[3]-T,_=E[1]/E[3]-w,S=M[0]/M[3]-T,C=M[1]/M[3]-w;A+=Math.abs(b*C-_*S)}return A}var f=[1,1,1],g=[0,0,0],d={cubeEdges:f,axis:g}},{"bit-twiddle":97,"gl-mat4/multiply":295,"robust-orientation":548,"split-polygon":566}],253:[function(n,z,q){"use strict";z.exports=function(f,g,d){var m=[],y=[0,0,0],v=[0,0,0],T=[0,0,0],w=[0,0,0];m.push(0,0,1,0,1,1,0,0,-1,0,0,-1,0,1,1,0,1,-1);for(var A=0;A<3;++A){for(var E=m.length/3|0,M=0;M<d[A].length;++M){var b=+d[A][M].x;m.push(b,0,1,b,1,1,b,0,-1,b,0,-1,b,1,1,b,1,-1)}var _=m.length/3|0;y[A]=E,v[A]=_-E,E=m.length/3|0;for(var S=0;S<d[A].length;++S)b=+d[A][S].x,m.push(b,0,1,b,1,1,b,0,-1,b,0,-1,b,1,1,b,1,-1);_=m.length/3|0,T[A]=E,w[A]=_-E}var C=t(f,new Float32Array(m)),k=h(f,[{buffer:C,type:f.FLOAT,size:3,stride:0,offset:0}]),L=p(f);return L.attributes.position.location=0,new a(f,C,k,L,v,y,w,T)};var t=n("gl-buffer"),h=n("gl-vao"),p=n("./shaders").line,l=[0,0,0],e=[0,0,0],o=[0,0,0],r=[0,0,0],i=[1,1];function u(f){return f[0]=f[1]=f[2]=0,f}function s(f,g){return f[0]=g[0],f[1]=g[1],f[2]=g[2],f}function a(f,g,d,m,y,v,T,w){this.gl=f,this.vertBuffer=g,this.vao=d,this.shader=m,this.tickCount=y,this.tickOffset=v,this.gridCount=T,this.gridOffset=w}var c=a.prototype;c.bind=function(f,g,d){this.shader.bind(),this.shader.uniforms.model=f,this.shader.uniforms.view=g,this.shader.uniforms.projection=d,i[0]=this.gl.drawingBufferWidth,i[1]=this.gl.drawingBufferHeight,this.shader.uniforms.screenShape=i,this.vao.bind()},c.unbind=function(){this.vao.unbind()},c.drawAxisLine=function(f,g,d,m,y){var v=u(e);this.shader.uniforms.majorAxis=e,v[f]=g[1][f]-g[0][f],this.shader.uniforms.minorAxis=v;var T,w=s(r,d);w[f]+=g[0][f],this.shader.uniforms.offset=w,this.shader.uniforms.lineWidth=y,this.shader.uniforms.color=m,(T=u(o))[(f+2)%3]=1,this.shader.uniforms.screenAxis=T,this.vao.draw(this.gl.TRIANGLES,6),(T=u(o))[(f+1)%3]=1,this.shader.uniforms.screenAxis=T,this.vao.draw(this.gl.TRIANGLES,6)},c.drawAxisTicks=function(f,g,d,m,y){if(this.tickCount[f]){var v=u(l);v[f]=1,this.shader.uniforms.majorAxis=v,this.shader.uniforms.offset=g,this.shader.uniforms.minorAxis=d,this.shader.uniforms.color=m,this.shader.uniforms.lineWidth=y;var T=u(o);T[f]=1,this.shader.uniforms.screenAxis=T,this.vao.draw(this.gl.TRIANGLES,this.tickCount[f],this.tickOffset[f])}},c.drawGrid=function(f,g,d,m,y,v){if(this.gridCount[f]){var T=u(e);T[g]=d[1][g]-d[0][g],this.shader.uniforms.minorAxis=T;var w=s(r,m);w[g]+=d[0][g],this.shader.uniforms.offset=w;var A=u(l);A[f]=1,this.shader.uniforms.majorAxis=A;var E=u(o);E[f]=1,this.shader.uniforms.screenAxis=E,this.shader.uniforms.lineWidth=v,this.shader.uniforms.color=y,this.vao.draw(this.gl.TRIANGLES,this.gridCount[f],this.gridOffset[f])}},c.drawZero=function(f,g,d,m,y,v){var T=u(e);this.shader.uniforms.majorAxis=T,T[f]=d[1][f]-d[0][f],this.shader.uniforms.minorAxis=T;var w=s(r,m);w[f]+=d[0][f],this.shader.uniforms.offset=w;var A=u(o);A[g]=1,this.shader.uniforms.screenAxis=A,this.shader.uniforms.lineWidth=v,this.shader.uniforms.color=y,this.vao.draw(this.gl.TRIANGLES,6)},c.dispose=function(){this.vao.dispose(),this.vertBuffer.dispose(),this.shader.dispose()}},{"./shaders":254,"gl-buffer":259,"gl-vao":358}],254:[function(n,z,q){"use strict";var t=n("glslify"),h=n("gl-shader"),p=t([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;

uniform mat4 model, view, projection;
uniform vec3 offset, majorAxis, minorAxis, screenAxis;
uniform float lineWidth;
uniform vec2 screenShape;

vec3 project(vec3 p) {
  vec4 pp = projection * view * model * vec4(p, 1.0);
  return pp.xyz / max(pp.w, 0.0001);
}

void main() {
  vec3 major = position.x * majorAxis;
  vec3 minor = position.y * minorAxis;

  vec3 vPosition = major + minor + offset;
  vec3 pPosition = project(vPosition);
  vec3 offset = project(vPosition + screenAxis * position.z);

  vec2 screen = normalize((offset - pPosition).xy * screenShape) / screenShape;

  gl_Position = vec4(pPosition + vec3(0.5 * screen * lineWidth, 0), 1.0);
}
`]),l=t([`precision highp float;
#define GLSLIFY 1

uniform vec4 color;
void main() {
  gl_FragColor = color;
}`]);q.line=function(u){return h(u,p,l,null,[{name:"position",type:"vec3"}])};var e=t([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;

uniform mat4 model, view, projection;
uniform vec3 offset, axis, alignDir, alignOpt;
uniform float scale, angle, pixelScale;
uniform vec2 resolution;

vec3 project(vec3 p) {
  vec4 pp = projection * view * model * vec4(p, 1.0);
  return pp.xyz / max(pp.w, 0.0001);
}

float computeViewAngle(vec3 a, vec3 b) {
  vec3 A = project(a);
  vec3 B = project(b);

  return atan(
    (B.y - A.y) * resolution.y,
    (B.x - A.x) * resolution.x
  );
}

const float PI = 3.141592;
const float TWO_PI = 2.0 * PI;
const float HALF_PI = 0.5 * PI;
const float ONE_AND_HALF_PI = 1.5 * PI;

int option = int(floor(alignOpt.x + 0.001));
float hv_ratio =       alignOpt.y;
bool enableAlign =    (alignOpt.z != 0.0);

float mod_angle(float a) {
  return mod(a, PI);
}

float positive_angle(float a) {
  return mod_angle((a < 0.0) ?
    a + TWO_PI :
    a
  );
}

float look_upwards(float a) {
  float b = positive_angle(a);
  return ((b > HALF_PI) && (b <= ONE_AND_HALF_PI)) ?
    b - PI :
    b;
}

float look_horizontal_or_vertical(float a, float ratio) {
  // ratio controls the ratio between being horizontal to (vertical + horizontal)
  // if ratio is set to 0.5 then it is 50%, 50%.
  // when using a higher ratio e.g. 0.75 the result would
  // likely be more horizontal than vertical.

  float b = positive_angle(a);

  return
    (b < (      ratio) * HALF_PI) ? 0.0 :
    (b < (2.0 - ratio) * HALF_PI) ? -HALF_PI :
    (b < (2.0 + ratio) * HALF_PI) ? 0.0 :
    (b < (4.0 - ratio) * HALF_PI) ? HALF_PI :
                                    0.0;
}

float roundTo(float a, float b) {
  return float(b * floor((a + 0.5 * b) / b));
}

float look_round_n_directions(float a, int n) {
  float b = positive_angle(a);
  float div = TWO_PI / float(n);
  float c = roundTo(b, div);
  return look_upwards(c);
}

float applyAlignOption(float rawAngle, float delta) {
  return
    (option >  2) ? look_round_n_directions(rawAngle + delta, option) :       // option 3-n: round to n directions
    (option == 2) ? look_horizontal_or_vertical(rawAngle + delta, hv_ratio) : // horizontal or vertical
    (option == 1) ? rawAngle + delta :       // use free angle, and flip to align with one direction of the axis
    (option == 0) ? look_upwards(rawAngle) : // use free angle, and stay upwards
    (option ==-1) ? 0.0 :                    // useful for backward compatibility, all texts remains horizontal
                    rawAngle;                // otherwise return back raw input angle
}

bool isAxisTitle = (axis.x == 0.0) &&
                   (axis.y == 0.0) &&
                   (axis.z == 0.0);

void main() {
  //Compute world offset
  float axisDistance = position.z;
  vec3 dataPosition = axisDistance * axis + offset;

  float beta = angle; // i.e. user defined attributes for each tick

  float axisAngle;
  float clipAngle;
  float flip;

  if (enableAlign) {
    axisAngle = (isAxisTitle) ? HALF_PI :
                      computeViewAngle(dataPosition, dataPosition + axis);
    clipAngle = computeViewAngle(dataPosition, dataPosition + alignDir);

    axisAngle += (sin(axisAngle) < 0.0) ? PI : 0.0;
    clipAngle += (sin(clipAngle) < 0.0) ? PI : 0.0;

    flip = (dot(vec2(cos(axisAngle), sin(axisAngle)),
                vec2(sin(clipAngle),-cos(clipAngle))) > 0.0) ? 1.0 : 0.0;

    beta += applyAlignOption(clipAngle, flip * PI);
  }

  //Compute plane offset
  vec2 planeCoord = position.xy * pixelScale;

  mat2 planeXform = scale * mat2(
     cos(beta), sin(beta),
    -sin(beta), cos(beta)
  );

  vec2 viewOffset = 2.0 * planeXform * planeCoord / resolution;

  //Compute clip position
  vec3 clipPosition = project(dataPosition);

  //Apply text offset in clip coordinates
  clipPosition += vec3(viewOffset, 0.0);

  //Done
  gl_Position = vec4(clipPosition, 1.0);
}`]),o=t([`precision highp float;
#define GLSLIFY 1

uniform vec4 color;
void main() {
  gl_FragColor = color;
}`]);q.text=function(u){return h(u,e,o,null,[{name:"position",type:"vec3"}])};var r=t([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;
attribute vec3 normal;

uniform mat4 model, view, projection;
uniform vec3 enable;
uniform vec3 bounds[2];

varying vec3 colorChannel;

void main() {

  vec3 signAxis = sign(bounds[1] - bounds[0]);

  vec3 realNormal = signAxis * normal;

  if(dot(realNormal, enable) > 0.0) {
    vec3 minRange = min(bounds[0], bounds[1]);
    vec3 maxRange = max(bounds[0], bounds[1]);
    vec3 nPosition = mix(minRange, maxRange, 0.5 * (position + 1.0));
    gl_Position = projection * view * model * vec4(nPosition, 1.0);
  } else {
    gl_Position = vec4(0,0,0,0);
  }

  colorChannel = abs(realNormal);
}`]),i=t([`precision highp float;
#define GLSLIFY 1

uniform vec4 colors[3];

varying vec3 colorChannel;

void main() {
  gl_FragColor = colorChannel.x * colors[0] +
                 colorChannel.y * colors[1] +
                 colorChannel.z * colors[2];
}`]);q.bg=function(u){return h(u,r,i,null,[{name:"position",type:"vec3"},{name:"normal",type:"vec3"}])}},{"gl-shader":335,glslify:257}],255:[function(n,z,q){(function(t){(function(){"use strict";z.exports=function(a,c,f,g,d,m){var y=h(a),v=p(a,[{buffer:y,size:3}]),T=e(a);T.attributes.position.location=0;var w=new i(a,T,y,v);return w.update(c,f,g,d,m),w};var h=n("gl-buffer"),p=n("gl-vao"),l=n("vectorize-text"),e=n("./shaders").text,o=window||t.global||{},r=o.__TEXT_CACHE||{};o.__TEXT_CACHE={};function i(a,c,f,g){this.gl=a,this.shader=c,this.buffer=f,this.vao=g,this.tickOffset=this.tickCount=this.labelOffset=this.labelCount=null}var u=i.prototype,s=[0,0];u.bind=function(a,c,f,g){this.vao.bind(),this.shader.bind();var d=this.shader.uniforms;d.model=a,d.view=c,d.projection=f,d.pixelScale=g,s[0]=this.gl.drawingBufferWidth,s[1]=this.gl.drawingBufferHeight,this.shader.uniforms.resolution=s},u.unbind=function(){this.vao.unbind()},u.update=function(a,c,f,g,d){var m=[];function y(_,S,C,k,L,I){var R=r[C];R||(R=r[C]={});var V=R[S];V||(V=R[S]=function(G,W){try{return l(G,W)}catch(Q){return console.warn('error vectorizing text:"'+G+'" error:',Q),{cells:[],positions:[]}}}(S,{triangles:!0,font:C,textAlign:"center",textBaseline:"middle",lineSpacing:L,styletags:I}));for(var O=(k||12)/12,J=V.positions,D=V.cells,B=0,N=D.length;B<N;++B)for(var F=D[B],H=2;H>=0;--H){var j=J[F[H]];m.push(O*j[0],-O*j[1],_)}}for(var v=[0,0,0],T=[0,0,0],w=[0,0,0],A=[0,0,0],E={breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0},M=0;M<3;++M){w[M]=m.length/3|0,y(.5*(a[0][M]+a[1][M]),c[M],f[M],12,1.25,E),A[M]=(m.length/3|0)-w[M],v[M]=m.length/3|0;for(var b=0;b<g[M].length;++b)g[M][b].text&&y(g[M][b].x,g[M][b].text,g[M][b].font||d,g[M][b].fontSize||12,1.25,E);T[M]=(m.length/3|0)-v[M]}this.buffer.update(m),this.tickOffset=v,this.tickCount=T,this.labelOffset=w,this.labelCount=A},u.drawTicks=function(a,c,f,g,d,m,y,v){this.tickCount[a]&&(this.shader.uniforms.axis=m,this.shader.uniforms.color=d,this.shader.uniforms.angle=f,this.shader.uniforms.scale=c,this.shader.uniforms.offset=g,this.shader.uniforms.alignDir=y,this.shader.uniforms.alignOpt=v,this.vao.draw(this.gl.TRIANGLES,this.tickCount[a],this.tickOffset[a]))},u.drawLabel=function(a,c,f,g,d,m,y,v){this.labelCount[a]&&(this.shader.uniforms.axis=m,this.shader.uniforms.color=d,this.shader.uniforms.angle=f,this.shader.uniforms.scale=c,this.shader.uniforms.offset=g,this.shader.uniforms.alignDir=y,this.shader.uniforms.alignOpt=v,this.vao.draw(this.gl.TRIANGLES,this.labelCount[a],this.labelOffset[a]))},u.dispose=function(){this.shader.dispose(),this.vao.dispose(),this.buffer.dispose()}}).call(this)}).call(this,n("_process"))},{"./shaders":254,_process:526,"gl-buffer":259,"gl-vao":358,"vectorize-text":600}],256:[function(n,z,q){"use strict";function t(h,p){var l=h+"",e=l.indexOf("."),o=0;e>=0&&(o=l.length-e-1);var r=Math.pow(10,o),i=Math.round(h*p*r),u=i+"";if(u.indexOf("e")>=0)return u;var s=i/r,a=i%r;i<0?(s=0|-Math.ceil(s),a=0|-a):(s=0|Math.floor(s),a|=0);var c=""+s;if(i<0&&(c="-"+c),o){for(var f=""+a;f.length<o;)f="0"+f;return c+"."+f}return c}q.create=function(h,p){for(var l=[],e=0;e<3;++e){for(var o=[],r=(h[0][e],h[1][e],0);r*p[e]<=h[1][e];++r)o.push({x:r*p[e],text:t(p[e],r)});for(r=-1;r*p[e]>=h[0][e];--r)o.push({x:r*p[e],text:t(p[e],r)});l.push(o)}return l},q.equal=function(h,p){for(var l=0;l<3;++l){if(h[l].length!==p[l].length)return!1;for(var e=0;e<h[l].length;++e){var o=h[l][e],r=p[l][e];if(o.x!==r.x||o.text!==r.text||o.font!==r.font||o.fontColor!==r.fontColor||o.fontSize!==r.fontSize||o.dx!==r.dx||o.dy!==r.dy)return!1}}return!0}},{}],257:[function(n,z,q){z.exports=function(t){typeof t=="string"&&(t=[t]);for(var h=[].slice.call(arguments,1),p=[],l=0;l<t.length-1;l++)p.push(t[l],h[l]||"");return p.push(t[l]),p.join("")}},{}],258:[function(n,z,q){"use strict";z.exports=function(d,m,y,v,T){var w=m.model||r,A=m.view||r,E=m.projection||r,M=m._ortho||!1,b=d.bounds,_=(T=T||p(w,A,E,b,M)).axis;l(i,A,w),l(i,E,i);for(var S=f,C=0;C<3;++C)S[C].lo=1/0,S[C].hi=-1/0,S[C].pixelsPerDataUnit=1/0;var k=t(e(i,i));e(i,i);for(var L=0;L<3;++L){var I=(L+1)%3,R=(L+2)%3,V=g;e:for(C=0;C<2;++C){var O=[];if(_[L]<0!=!!C){V[L]=b[C][L];for(var J=0;J<2;++J){V[I]=b[J^C][I];for(var D=0;D<2;++D)V[R]=b[D^J^C][R],O.push(V.slice())}var B=M?5:4;for(J=B;J===B;++J){if(O.length===0)continue e;O=h.positive(O,k[J])}for(J=0;J<O.length;++J){R=O[J];var N=c(g,i,R,y,v);for(D=0;D<3;++D)S[D].lo=Math.min(S[D].lo,R[D]),S[D].hi=Math.max(S[D].hi,R[D]),D!==L&&(S[D].pixelsPerDataUnit=Math.min(S[D].pixelsPerDataUnit,Math.abs(N[D])))}}}}return S};var t=n("extract-frustum-planes"),h=n("split-polygon"),p=n("./lib/cube.js"),l=n("gl-mat4/multiply"),e=n("gl-mat4/transpose"),o=n("gl-vec4/transformMat4"),r=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),i=new Float32Array(16);function u(d,m,y){this.lo=d,this.hi=m,this.pixelsPerDataUnit=y}var s=[0,0,0,1],a=[0,0,0,1];function c(d,m,y,v,T){for(var w=0;w<3;++w){for(var A=s,E=a,M=0;M<3;++M)E[M]=A[M]=y[M];E[3]=A[3]=1,E[w]+=1,o(E,E,m),E[3]<0&&(d[w]=1/0),A[w]-=1,o(A,A,m),A[3]<0&&(d[w]=1/0);var b=(A[0]/A[3]-E[0]/E[3])*v,_=(A[1]/A[3]-E[1]/E[3])*T;d[w]=.25*Math.sqrt(b*b+_*_)}return d}var f=[new u(1/0,-1/0,1/0),new u(1/0,-1/0,1/0),new u(1/0,-1/0,1/0)],g=[0,0,0]},{"./lib/cube.js":252,"extract-frustum-planes":240,"gl-mat4/multiply":295,"gl-mat4/transpose":306,"gl-vec4/transformMat4":429,"split-polygon":566}],259:[function(n,z,q){"use strict";var t=n("typedarray-pool"),h=n("ndarray-ops"),p=n("ndarray"),l=["uint8","uint8_clamped","uint16","uint32","int8","int16","int32","float32"];function e(u,s,a,c,f){this.gl=u,this.type=s,this.handle=a,this.length=c,this.usage=f}var o=e.prototype;function r(u,s,a,c,f,g){var d=f.length*f.BYTES_PER_ELEMENT;if(g<0)return u.bufferData(s,f,c),d;if(d+g>a)throw new Error("gl-buffer: If resizing buffer, must not specify offset");return u.bufferSubData(s,g,f),a}function i(u,s){for(var a=t.malloc(u.length,s),c=u.length,f=0;f<c;++f)a[f]=u[f];return a}o.bind=function(){this.gl.bindBuffer(this.type,this.handle)},o.unbind=function(){this.gl.bindBuffer(this.type,null)},o.dispose=function(){this.gl.deleteBuffer(this.handle)},o.update=function(u,s){if(typeof s!="number"&&(s=-1),this.bind(),typeof u=="object"&&typeof u.shape<"u"){var a=u.dtype;if(l.indexOf(a)<0&&(a="float32"),this.type===this.gl.ELEMENT_ARRAY_BUFFER&&(a=gl.getExtension("OES_element_index_uint")&&a!=="uint16"?"uint32":"uint16"),a===u.dtype&&function(d,m){for(var y=1,v=m.length-1;v>=0;--v){if(m[v]!==y)return!1;y*=d[v]}return!0}(u.shape,u.stride))u.offset===0&&u.data.length===u.shape[0]?this.length=r(this.gl,this.type,this.length,this.usage,u.data,s):this.length=r(this.gl,this.type,this.length,this.usage,u.data.subarray(u.offset,u.shape[0]),s);else{var c=t.malloc(u.size,a),f=p(c,u.shape);h.assign(f,u),this.length=r(this.gl,this.type,this.length,this.usage,s<0?c:c.subarray(0,u.size),s),t.free(c)}}else if(Array.isArray(u)){var g;g=this.type===this.gl.ELEMENT_ARRAY_BUFFER?i(u,"uint16"):i(u,"float32"),this.length=r(this.gl,this.type,this.length,this.usage,s<0?g:g.subarray(0,u.length),s),t.free(g)}else if(typeof u=="object"&&typeof u.length=="number")this.length=r(this.gl,this.type,this.length,this.usage,u,s);else{if(typeof u!="number"&&u!==void 0)throw new Error("gl-buffer: Invalid data type");if(s>=0)throw new Error("gl-buffer: Cannot specify offset when resizing buffer");(u|=0)<=0&&(u=1),this.gl.bufferData(this.type,0|u,this.usage),this.length=u}},z.exports=function(u,s,a,c){if(a=a||u.ARRAY_BUFFER,c=c||u.DYNAMIC_DRAW,a!==u.ARRAY_BUFFER&&a!==u.ELEMENT_ARRAY_BUFFER)throw new Error("gl-buffer: Invalid type for webgl buffer, must be either gl.ARRAY_BUFFER or gl.ELEMENT_ARRAY_BUFFER");if(c!==u.DYNAMIC_DRAW&&c!==u.STATIC_DRAW&&c!==u.STREAM_DRAW)throw new Error("gl-buffer: Invalid usage for buffer, must be either gl.DYNAMIC_DRAW, gl.STATIC_DRAW or gl.STREAM_DRAW");var f=u.createBuffer(),g=new e(u,a,f,0,c);return g.update(s),g}},{ndarray:495,"ndarray-ops":490,"typedarray-pool":595}],260:[function(n,z,q){"use strict";var t=n("gl-vec3");z.exports=function(p,l){var e=p.positions,o=p.vectors,r={positions:[],vertexIntensity:[],vertexIntensityBounds:p.vertexIntensityBounds,vectors:[],cells:[],coneOffset:p.coneOffset,colormap:p.colormap};if(p.positions.length===0)return l&&(l[0]=[0,0,0],l[1]=[0,0,0]),r;for(var i=0,u=1/0,s=-1/0,a=1/0,c=-1/0,f=1/0,g=-1/0,d=null,m=null,y=[],v=1/0,T=!1,w=0;w<e.length;w++){var A=e[w];u=Math.min(A[0],u),s=Math.max(A[0],s),a=Math.min(A[1],a),c=Math.max(A[1],c),f=Math.min(A[2],f),g=Math.max(A[2],g);var E=o[w];if(t.length(E)>i&&(i=t.length(E)),w){var M=2*t.distance(d,A)/(t.length(m)+t.length(E));M?(v=Math.min(v,M),T=!1):T=!0}T||(d=A,m=E),y.push(E)}var b=[u,a,f],_=[s,c,g];l&&(l[0]=b,l[1]=_),i===0&&(i=1);var S=1/i;isFinite(v)||(v=1),r.vectorScale=v;var C=p.coneSize||.5;p.absoluteConeSize&&(C=p.absoluteConeSize*S),r.coneScale=C,w=0;for(var k=0;w<e.length;w++)for(var L=(A=e[w])[0],I=A[1],R=A[2],V=y[w],O=t.length(V)*S,J=0;J<8;J++){r.positions.push([L,I,R,k++]),r.positions.push([L,I,R,k++]),r.positions.push([L,I,R,k++]),r.positions.push([L,I,R,k++]),r.positions.push([L,I,R,k++]),r.positions.push([L,I,R,k++]),r.vectors.push(V),r.vectors.push(V),r.vectors.push(V),r.vectors.push(V),r.vectors.push(V),r.vectors.push(V),r.vertexIntensity.push(O,O,O),r.vertexIntensity.push(O,O,O);var D=r.positions.length;r.cells.push([D-6,D-5,D-4],[D-3,D-2,D-1])}return r};var h=n("./lib/shaders");z.exports.createMesh=n("./create_mesh"),z.exports.createConeMesh=function(p,l){return z.exports.createMesh(p,l,{shaders:h,traceType:"cone"})}},{"./create_mesh":261,"./lib/shaders":262,"gl-vec3":377}],261:[function(n,z,q){"use strict";var t=n("gl-shader"),h=n("gl-buffer"),p=n("gl-vao"),l=n("gl-texture2d"),e=n("gl-mat4/multiply"),o=n("gl-mat4/invert"),r=n("ndarray"),i=n("colormap"),u=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function s(g,d,m,y,v,T,w,A,E,M,b){this.gl=g,this.pixelRatio=1,this.cells=[],this.positions=[],this.intensity=[],this.texture=d,this.dirty=!0,this.triShader=m,this.pickShader=y,this.trianglePositions=v,this.triangleVectors=T,this.triangleColors=A,this.triangleUVs=E,this.triangleIds=w,this.triangleVAO=M,this.triangleCount=0,this.pickId=1,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.lightPosition=[1e5,1e5,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.opacity=1,this.traceType=b,this.tubeScale=1,this.coneScale=2,this.vectorScale=1,this.coneOffset=.25,this._model=u,this._view=u,this._projection=u,this._resolution=[1,1]}var a=s.prototype;function c(g,d){var m=t(g,d.meshShader.vertex,d.meshShader.fragment,null,d.meshShader.attributes);return m.attributes.position.location=0,m.attributes.color.location=2,m.attributes.uv.location=3,m.attributes.vector.location=4,m}function f(g,d){var m=t(g,d.pickShader.vertex,d.pickShader.fragment,null,d.pickShader.attributes);return m.attributes.position.location=0,m.attributes.id.location=1,m.attributes.vector.location=4,m}a.isOpaque=function(){return this.opacity>=1},a.isTransparent=function(){return this.opacity<1},a.pickSlots=1,a.setPickBase=function(g){this.pickId=g},a.update=function(g){g=g||{};var d=this.gl;this.dirty=!0,"lightPosition"in g&&(this.lightPosition=g.lightPosition),"opacity"in g&&(this.opacity=g.opacity),"ambient"in g&&(this.ambientLight=g.ambient),"diffuse"in g&&(this.diffuseLight=g.diffuse),"specular"in g&&(this.specularLight=g.specular),"roughness"in g&&(this.roughness=g.roughness),"fresnel"in g&&(this.fresnel=g.fresnel),g.tubeScale!==void 0&&(this.tubeScale=g.tubeScale),g.vectorScale!==void 0&&(this.vectorScale=g.vectorScale),g.coneScale!==void 0&&(this.coneScale=g.coneScale),g.coneOffset!==void 0&&(this.coneOffset=g.coneOffset),g.colormap&&(this.texture.shape=[256,256],this.texture.minFilter=d.LINEAR_MIPMAP_LINEAR,this.texture.magFilter=d.LINEAR,this.texture.setPixels(function(H){for(var j=i({colormap:H,nshades:256,format:"rgba"}),G=new Uint8Array(1024),W=0;W<256;++W){for(var Q=j[W],$=0;$<3;++$)G[4*W+$]=Q[$];G[4*W+3]=255*Q[3]}return r(G,[256,256,4],[4,0,1])}(g.colormap)),this.texture.generateMipmap());var m=g.cells,y=g.positions,v=g.vectors;if(y&&m&&v){var T=[],w=[],A=[],E=[],M=[];this.cells=m,this.positions=y,this.vectors=v;var b=g.meshColor||[1,1,1,1],_=g.vertexIntensity,S=1/0,C=-1/0;if(_)if(g.vertexIntensityBounds)S=+g.vertexIntensityBounds[0],C=+g.vertexIntensityBounds[1];else for(var k=0;k<_.length;++k){var L=_[k];S=Math.min(S,L),C=Math.max(C,L)}else for(k=0;k<y.length;++k)L=y[k][2],S=Math.min(S,L),C=Math.max(C,L);for(this.intensity=_||function(H){for(var j=H.length,G=new Array(j),W=0;W<j;++W)G[W]=H[W][2];return G}(y),this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],k=0;k<y.length;++k)for(var I=y[k],R=0;R<3;++R)!isNaN(I[R])&&isFinite(I[R])&&(this.bounds[0][R]=Math.min(this.bounds[0][R],I[R]),this.bounds[1][R]=Math.max(this.bounds[1][R],I[R]));var V=0;e:for(k=0;k<m.length;++k){var O=m[k];switch(O.length){case 3:for(R=0;R<3;++R){I=y[D=O[R]];for(var J=0;J<3;++J)if(isNaN(I[J])||!isFinite(I[J]))continue e}for(R=0;R<3;++R){var D;I=y[D=O[2-R]],T.push(I[0],I[1],I[2],I[3]);var B=v[D];w.push(B[0],B[1],B[2],B[3]||0);var N,F=b;F.length===3?A.push(F[0],F[1],F[2],1):A.push(F[0],F[1],F[2],F[3]),N=_?[(_[D]-S)/(C-S),0]:[(I[2]-S)/(C-S),0],E.push(N[0],N[1]),M.push(k)}V+=1}}this.triangleCount=V,this.trianglePositions.update(T),this.triangleVectors.update(w),this.triangleColors.update(A),this.triangleUVs.update(E),this.triangleIds.update(new Uint32Array(M))}},a.drawTransparent=a.draw=function(g){g=g||{};for(var d=this.gl,m=g.model||u,y=g.view||u,v=g.projection||u,T=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],w=0;w<3;++w)T[0][w]=Math.max(T[0][w],this.clipBounds[0][w]),T[1][w]=Math.min(T[1][w],this.clipBounds[1][w]);var A={model:m,view:y,projection:v,inverseModel:u.slice(),clipBounds:T,kambient:this.ambientLight,kdiffuse:this.diffuseLight,kspecular:this.specularLight,roughness:this.roughness,fresnel:this.fresnel,eyePosition:[0,0,0],lightPosition:[0,0,0],opacity:this.opacity,tubeScale:this.tubeScale,vectorScale:this.vectorScale,coneScale:this.coneScale,coneOffset:this.coneOffset,texture:0};A.inverseModel=o(A.inverseModel,A.model),d.disable(d.CULL_FACE),this.texture.bind(0);var E=new Array(16);for(e(E,A.view,A.model),e(E,A.projection,E),o(E,E),w=0;w<3;++w)A.eyePosition[w]=E[12+w]/E[15];var M=E[15];for(w=0;w<3;++w)M+=this.lightPosition[w]*E[4*w+3];for(w=0;w<3;++w){for(var b=E[12+w],_=0;_<3;++_)b+=E[4*_+w]*this.lightPosition[_];A.lightPosition[w]=b/M}if(this.triangleCount>0){var S=this.triShader;S.bind(),S.uniforms=A,this.triangleVAO.bind(),d.drawArrays(d.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind()}},a.drawPick=function(g){g=g||{};for(var d=this.gl,m=g.model||u,y=g.view||u,v=g.projection||u,T=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],w=0;w<3;++w)T[0][w]=Math.max(T[0][w],this.clipBounds[0][w]),T[1][w]=Math.min(T[1][w],this.clipBounds[1][w]);this._model=[].slice.call(m),this._view=[].slice.call(y),this._projection=[].slice.call(v),this._resolution=[d.drawingBufferWidth,d.drawingBufferHeight];var A={model:m,view:y,projection:v,clipBounds:T,tubeScale:this.tubeScale,vectorScale:this.vectorScale,coneScale:this.coneScale,coneOffset:this.coneOffset,pickId:this.pickId/255},E=this.pickShader;E.bind(),E.uniforms=A,this.triangleCount>0&&(this.triangleVAO.bind(),d.drawArrays(d.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind())},a.pick=function(g){if(!g||g.id!==this.pickId)return null;var d=g.value[0]+256*g.value[1]+65536*g.value[2],m=this.cells[d],y=this.positions[m[1]].slice(0,3),v={position:y,dataCoordinate:y,index:Math.floor(m[1]/48)};return this.traceType==="cone"?v.index=Math.floor(m[1]/48):this.traceType==="streamtube"&&(v.intensity=this.intensity[m[1]],v.velocity=this.vectors[m[1]].slice(0,3),v.divergence=this.vectors[m[1]][3],v.index=d),v},a.dispose=function(){this.texture.dispose(),this.triShader.dispose(),this.pickShader.dispose(),this.triangleVAO.dispose(),this.trianglePositions.dispose(),this.triangleVectors.dispose(),this.triangleColors.dispose(),this.triangleUVs.dispose(),this.triangleIds.dispose()},z.exports=function(g,d,m){var y=m.shaders;arguments.length===1&&(g=(d=g).gl);var v=c(g,y),T=f(g,y),w=l(g,r(new Uint8Array([255,255,255,255]),[1,1,4]));w.generateMipmap(),w.minFilter=g.LINEAR_MIPMAP_LINEAR,w.magFilter=g.LINEAR;var A=h(g),E=h(g),M=h(g),b=h(g),_=h(g),S=p(g,[{buffer:A,type:g.FLOAT,size:4},{buffer:_,type:g.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:M,type:g.FLOAT,size:4},{buffer:b,type:g.FLOAT,size:2},{buffer:E,type:g.FLOAT,size:4}]),C=new s(g,w,v,T,A,E,_,M,b,S,m.traceType||"cone");return C.update(d),C}},{colormap:131,"gl-buffer":259,"gl-mat4/invert":293,"gl-mat4/multiply":295,"gl-shader":335,"gl-texture2d":353,"gl-vao":358,ndarray:495}],262:[function(n,z,q){var t=n("glslify"),h=t([`precision highp float;

precision highp float;
#define GLSLIFY 1

vec3 getOrthogonalVector(vec3 v) {
  // Return up-vector for only-z vector.
  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).
  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.
  // Assign z = 0, x = -b, y = a:
  // a*-b + b*a + c*0 = -ba + ba + 0 = 0
  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {
    return normalize(vec3(-v.y, v.x, 0.0));
  } else {
    return normalize(vec3(0.0, v.z, -v.y));
  }
}

// Calculate the cone vertex and normal at the given index.
//
// The returned vertex is for a cone with its top at origin and height of 1.0,
// pointing in the direction of the vector attribute.
//
// Each cone is made up of a top vertex, a center base vertex and base perimeter vertices.
// These vertices are used to make up the triangles of the cone by the following:
//   segment + 0 top vertex
//   segment + 1 perimeter vertex a+1
//   segment + 2 perimeter vertex a
//   segment + 3 center base vertex
//   segment + 4 perimeter vertex a
//   segment + 5 perimeter vertex a+1
// Where segment is the number of the radial segment * 6 and a is the angle at that radial segment.
// To go from index to segment, floor(index / 6)
// To go from segment to angle, 2*pi * (segment/segmentCount)
// To go from index to segment index, index - (segment*6)
//
vec3 getConePosition(vec3 d, float rawIndex, float coneOffset, out vec3 normal) {

  const float segmentCount = 8.0;

  float index = rawIndex - floor(rawIndex /
    (segmentCount * 6.0)) *
    (segmentCount * 6.0);

  float segment = floor(0.001 + index/6.0);
  float segmentIndex = index - (segment*6.0);

  normal = -normalize(d);

  if (segmentIndex > 2.99 && segmentIndex < 3.01) {
    return mix(vec3(0.0), -d, coneOffset);
  }

  float nextAngle = (
    (segmentIndex > 0.99 &&  segmentIndex < 1.01) ||
    (segmentIndex > 4.99 &&  segmentIndex < 5.01)
  ) ? 1.0 : 0.0;
  float angle = 2.0 * 3.14159 * ((segment + nextAngle) / segmentCount);

  vec3 v1 = mix(d, vec3(0.0), coneOffset);
  vec3 v2 = v1 - d;

  vec3 u = getOrthogonalVector(d);
  vec3 v = normalize(cross(u, d));

  vec3 x = u * cos(angle) * length(d)*0.25;
  vec3 y = v * sin(angle) * length(d)*0.25;
  vec3 v3 = v2 + x + y;
  if (segmentIndex < 3.0) {
    vec3 tx = u * sin(angle);
    vec3 ty = v * -cos(angle);
    vec3 tangent = tx + ty;
    normal = normalize(cross(v3 - v1, tangent));
  }

  if (segmentIndex == 0.0) {
    return mix(d, vec3(0.0), coneOffset);
  }
  return v3;
}

attribute vec3 vector;
attribute vec4 color, position;
attribute vec2 uv;

uniform float vectorScale, coneScale, coneOffset;
uniform mat4 model, view, projection, inverseModel;
uniform vec3 eyePosition, lightPosition;

varying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  // Scale the vector magnitude to stay constant with
  // model & view changes.
  vec3 normal;
  vec3 XYZ = getConePosition(mat3(model) * ((vectorScale * coneScale) * vector), position.w, coneOffset, normal);
  vec4 conePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);

  //Lighting geometry parameters
  vec4 cameraCoordinate = view * conePosition;
  cameraCoordinate.xyz /= cameraCoordinate.w;
  f_lightDirection = lightPosition - cameraCoordinate.xyz;
  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;
  f_normal = normalize((vec4(normal, 0.0) * inverseModel).xyz);

  // vec4 m_position  = model * vec4(conePosition, 1.0);
  vec4 t_position  = view * conePosition;
  gl_Position      = projection * t_position;

  f_color          = color;
  f_data           = conePosition.xyz;
  f_position       = position.xyz;
  f_uv             = uv;
}
`]),p=t([`#extension GL_OES_standard_derivatives : enable

precision highp float;
#define GLSLIFY 1

float beckmannDistribution(float x, float roughness) {
  float NdotH = max(x, 0.0001);
  float cos2Alpha = NdotH * NdotH;
  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;
  float roughness2 = roughness * roughness;
  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;
  return exp(tan2Alpha / roughness2) / denom;
}

float cookTorranceSpecular(
  vec3 lightDirection,
  vec3 viewDirection,
  vec3 surfaceNormal,
  float roughness,
  float fresnel) {

  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);
  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);

  //Half angle vector
  vec3 H = normalize(lightDirection + viewDirection);

  //Geometric term
  float NdotH = max(dot(surfaceNormal, H), 0.0);
  float VdotH = max(dot(viewDirection, H), 0.000001);
  float LdotH = max(dot(lightDirection, H), 0.000001);
  float G1 = (2.0 * NdotH * VdotN) / VdotH;
  float G2 = (2.0 * NdotH * LdotN) / LdotH;
  float G = min(1.0, min(G1, G2));
  
  //Distribution term
  float D = beckmannDistribution(NdotH, roughness);

  //Fresnel term
  float F = pow(1.0 - VdotN, fresnel);

  //Multiply terms and done
  return  G * F * D / max(3.14159265 * VdotN, 0.000001);
}

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;
uniform sampler2D texture;

varying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;
  vec3 N = normalize(f_normal);
  vec3 L = normalize(f_lightDirection);
  vec3 V = normalize(f_eyeDirection);

  if(gl_FrontFacing) {
    N = -N;
  }

  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));
  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);

  vec4 surfaceColor = f_color * texture2D(texture, f_uv);
  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);

  gl_FragColor = litColor * opacity;
}
`]),l=t([`precision highp float;

precision highp float;
#define GLSLIFY 1

vec3 getOrthogonalVector(vec3 v) {
  // Return up-vector for only-z vector.
  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).
  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.
  // Assign z = 0, x = -b, y = a:
  // a*-b + b*a + c*0 = -ba + ba + 0 = 0
  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {
    return normalize(vec3(-v.y, v.x, 0.0));
  } else {
    return normalize(vec3(0.0, v.z, -v.y));
  }
}

// Calculate the cone vertex and normal at the given index.
//
// The returned vertex is for a cone with its top at origin and height of 1.0,
// pointing in the direction of the vector attribute.
//
// Each cone is made up of a top vertex, a center base vertex and base perimeter vertices.
// These vertices are used to make up the triangles of the cone by the following:
//   segment + 0 top vertex
//   segment + 1 perimeter vertex a+1
//   segment + 2 perimeter vertex a
//   segment + 3 center base vertex
//   segment + 4 perimeter vertex a
//   segment + 5 perimeter vertex a+1
// Where segment is the number of the radial segment * 6 and a is the angle at that radial segment.
// To go from index to segment, floor(index / 6)
// To go from segment to angle, 2*pi * (segment/segmentCount)
// To go from index to segment index, index - (segment*6)
//
vec3 getConePosition(vec3 d, float rawIndex, float coneOffset, out vec3 normal) {

  const float segmentCount = 8.0;

  float index = rawIndex - floor(rawIndex /
    (segmentCount * 6.0)) *
    (segmentCount * 6.0);

  float segment = floor(0.001 + index/6.0);
  float segmentIndex = index - (segment*6.0);

  normal = -normalize(d);

  if (segmentIndex > 2.99 && segmentIndex < 3.01) {
    return mix(vec3(0.0), -d, coneOffset);
  }

  float nextAngle = (
    (segmentIndex > 0.99 &&  segmentIndex < 1.01) ||
    (segmentIndex > 4.99 &&  segmentIndex < 5.01)
  ) ? 1.0 : 0.0;
  float angle = 2.0 * 3.14159 * ((segment + nextAngle) / segmentCount);

  vec3 v1 = mix(d, vec3(0.0), coneOffset);
  vec3 v2 = v1 - d;

  vec3 u = getOrthogonalVector(d);
  vec3 v = normalize(cross(u, d));

  vec3 x = u * cos(angle) * length(d)*0.25;
  vec3 y = v * sin(angle) * length(d)*0.25;
  vec3 v3 = v2 + x + y;
  if (segmentIndex < 3.0) {
    vec3 tx = u * sin(angle);
    vec3 ty = v * -cos(angle);
    vec3 tangent = tx + ty;
    normal = normalize(cross(v3 - v1, tangent));
  }

  if (segmentIndex == 0.0) {
    return mix(d, vec3(0.0), coneOffset);
  }
  return v3;
}

attribute vec4 vector;
attribute vec4 position;
attribute vec4 id;

uniform mat4 model, view, projection;
uniform float vectorScale, coneScale, coneOffset;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  vec3 normal;
  vec3 XYZ = getConePosition(mat3(model) * ((vectorScale * coneScale) * vector.xyz), position.w, coneOffset, normal);
  vec4 conePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);
  gl_Position = projection * view * conePosition;
  f_id        = id;
  f_position  = position.xyz;
}
`]),e=t([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3  clipBounds[2];
uniform float pickId;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;

  gl_FragColor = vec4(pickId, f_id.xyz);
}`]);q.meshShader={vertex:h,fragment:p,attributes:[{name:"position",type:"vec4"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"vector",type:"vec3"}]},q.pickShader={vertex:l,fragment:e,attributes:[{name:"position",type:"vec4"},{name:"id",type:"vec4"},{name:"vector",type:"vec3"}]}},{glslify:263}],263:[function(n,z,q){arguments[4][257][0].apply(q,arguments)},{dup:257}],264:[function(n,z,q){z.exports={0:"NONE",1:"ONE",2:"LINE_LOOP",3:"LINE_STRIP",4:"TRIANGLES",5:"TRIANGLE_STRIP",6:"TRIANGLE_FAN",256:"DEPTH_BUFFER_BIT",512:"NEVER",513:"LESS",514:"EQUAL",515:"LEQUAL",516:"GREATER",517:"NOTEQUAL",518:"GEQUAL",519:"ALWAYS",768:"SRC_COLOR",769:"ONE_MINUS_SRC_COLOR",770:"SRC_ALPHA",771:"ONE_MINUS_SRC_ALPHA",772:"DST_ALPHA",773:"ONE_MINUS_DST_ALPHA",774:"DST_COLOR",775:"ONE_MINUS_DST_COLOR",776:"SRC_ALPHA_SATURATE",1024:"STENCIL_BUFFER_BIT",1028:"FRONT",1029:"BACK",1032:"FRONT_AND_BACK",1280:"INVALID_ENUM",1281:"INVALID_VALUE",1282:"INVALID_OPERATION",1285:"OUT_OF_MEMORY",1286:"INVALID_FRAMEBUFFER_OPERATION",2304:"CW",2305:"CCW",2849:"LINE_WIDTH",2884:"CULL_FACE",2885:"CULL_FACE_MODE",2886:"FRONT_FACE",2928:"DEPTH_RANGE",2929:"DEPTH_TEST",2930:"DEPTH_WRITEMASK",2931:"DEPTH_CLEAR_VALUE",2932:"DEPTH_FUNC",2960:"STENCIL_TEST",2961:"STENCIL_CLEAR_VALUE",2962:"STENCIL_FUNC",2963:"STENCIL_VALUE_MASK",2964:"STENCIL_FAIL",2965:"STENCIL_PASS_DEPTH_FAIL",2966:"STENCIL_PASS_DEPTH_PASS",2967:"STENCIL_REF",2968:"STENCIL_WRITEMASK",2978:"VIEWPORT",3024:"DITHER",3042:"BLEND",3088:"SCISSOR_BOX",3089:"SCISSOR_TEST",3106:"COLOR_CLEAR_VALUE",3107:"COLOR_WRITEMASK",3317:"UNPACK_ALIGNMENT",3333:"PACK_ALIGNMENT",3379:"MAX_TEXTURE_SIZE",3386:"MAX_VIEWPORT_DIMS",3408:"SUBPIXEL_BITS",3410:"RED_BITS",3411:"GREEN_BITS",3412:"BLUE_BITS",3413:"ALPHA_BITS",3414:"DEPTH_BITS",3415:"STENCIL_BITS",3553:"TEXTURE_2D",4352:"DONT_CARE",4353:"FASTEST",4354:"NICEST",5120:"BYTE",5121:"UNSIGNED_BYTE",5122:"SHORT",5123:"UNSIGNED_SHORT",5124:"INT",5125:"UNSIGNED_INT",5126:"FLOAT",5386:"INVERT",5890:"TEXTURE",6401:"STENCIL_INDEX",6402:"DEPTH_COMPONENT",6406:"ALPHA",6407:"RGB",6408:"RGBA",6409:"LUMINANCE",6410:"LUMINANCE_ALPHA",7680:"KEEP",7681:"REPLACE",7682:"INCR",7683:"DECR",7936:"VENDOR",7937:"RENDERER",7938:"VERSION",9728:"NEAREST",9729:"LINEAR",9984:"NEAREST_MIPMAP_NEAREST",9985:"LINEAR_MIPMAP_NEAREST",9986:"NEAREST_MIPMAP_LINEAR",9987:"LINEAR_MIPMAP_LINEAR",10240:"TEXTURE_MAG_FILTER",10241:"TEXTURE_MIN_FILTER",10242:"TEXTURE_WRAP_S",10243:"TEXTURE_WRAP_T",10497:"REPEAT",10752:"POLYGON_OFFSET_UNITS",16384:"COLOR_BUFFER_BIT",32769:"CONSTANT_COLOR",32770:"ONE_MINUS_CONSTANT_COLOR",32771:"CONSTANT_ALPHA",32772:"ONE_MINUS_CONSTANT_ALPHA",32773:"BLEND_COLOR",32774:"FUNC_ADD",32777:"BLEND_EQUATION_RGB",32778:"FUNC_SUBTRACT",32779:"FUNC_REVERSE_SUBTRACT",32819:"UNSIGNED_SHORT_4_4_4_4",32820:"UNSIGNED_SHORT_5_5_5_1",32823:"POLYGON_OFFSET_FILL",32824:"POLYGON_OFFSET_FACTOR",32854:"RGBA4",32855:"RGB5_A1",32873:"TEXTURE_BINDING_2D",32926:"SAMPLE_ALPHA_TO_COVERAGE",32928:"SAMPLE_COVERAGE",32936:"SAMPLE_BUFFERS",32937:"SAMPLES",32938:"SAMPLE_COVERAGE_VALUE",32939:"SAMPLE_COVERAGE_INVERT",32968:"BLEND_DST_RGB",32969:"BLEND_SRC_RGB",32970:"BLEND_DST_ALPHA",32971:"BLEND_SRC_ALPHA",33071:"CLAMP_TO_EDGE",33170:"GENERATE_MIPMAP_HINT",33189:"DEPTH_COMPONENT16",33306:"DEPTH_STENCIL_ATTACHMENT",33635:"UNSIGNED_SHORT_5_6_5",33648:"MIRRORED_REPEAT",33901:"ALIASED_POINT_SIZE_RANGE",33902:"ALIASED_LINE_WIDTH_RANGE",33984:"TEXTURE0",33985:"TEXTURE1",33986:"TEXTURE2",33987:"TEXTURE3",33988:"TEXTURE4",33989:"TEXTURE5",33990:"TEXTURE6",33991:"TEXTURE7",33992:"TEXTURE8",33993:"TEXTURE9",33994:"TEXTURE10",33995:"TEXTURE11",33996:"TEXTURE12",33997:"TEXTURE13",33998:"TEXTURE14",33999:"TEXTURE15",34e3:"TEXTURE16",34001:"TEXTURE17",34002:"TEXTURE18",34003:"TEXTURE19",34004:"TEXTURE20",34005:"TEXTURE21",34006:"TEXTURE22",34007:"TEXTURE23",34008:"TEXTURE24",34009:"TEXTURE25",34010:"TEXTURE26",34011:"TEXTURE27",34012:"TEXTURE28",34013:"TEXTURE29",34014:"TEXTURE30",34015:"TEXTURE31",34016:"ACTIVE_TEXTURE",34024:"MAX_RENDERBUFFER_SIZE",34041:"DEPTH_STENCIL",34055:"INCR_WRAP",34056:"DECR_WRAP",34067:"TEXTURE_CUBE_MAP",34068:"TEXTURE_BINDING_CUBE_MAP",34069:"TEXTURE_CUBE_MAP_POSITIVE_X",34070:"TEXTURE_CUBE_MAP_NEGATIVE_X",34071:"TEXTURE_CUBE_MAP_POSITIVE_Y",34072:"TEXTURE_CUBE_MAP_NEGATIVE_Y",34073:"TEXTURE_CUBE_MAP_POSITIVE_Z",34074:"TEXTURE_CUBE_MAP_NEGATIVE_Z",34076:"MAX_CUBE_MAP_TEXTURE_SIZE",34338:"VERTEX_ATTRIB_ARRAY_ENABLED",34339:"VERTEX_ATTRIB_ARRAY_SIZE",34340:"VERTEX_ATTRIB_ARRAY_STRIDE",34341:"VERTEX_ATTRIB_ARRAY_TYPE",34342:"CURRENT_VERTEX_ATTRIB",34373:"VERTEX_ATTRIB_ARRAY_POINTER",34466:"NUM_COMPRESSED_TEXTURE_FORMATS",34467:"COMPRESSED_TEXTURE_FORMATS",34660:"BUFFER_SIZE",34661:"BUFFER_USAGE",34816:"STENCIL_BACK_FUNC",34817:"STENCIL_BACK_FAIL",34818:"STENCIL_BACK_PASS_DEPTH_FAIL",34819:"STENCIL_BACK_PASS_DEPTH_PASS",34877:"BLEND_EQUATION_ALPHA",34921:"MAX_VERTEX_ATTRIBS",34922:"VERTEX_ATTRIB_ARRAY_NORMALIZED",34930:"MAX_TEXTURE_IMAGE_UNITS",34962:"ARRAY_BUFFER",34963:"ELEMENT_ARRAY_BUFFER",34964:"ARRAY_BUFFER_BINDING",34965:"ELEMENT_ARRAY_BUFFER_BINDING",34975:"VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",35040:"STREAM_DRAW",35044:"STATIC_DRAW",35048:"DYNAMIC_DRAW",35632:"FRAGMENT_SHADER",35633:"VERTEX_SHADER",35660:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",35661:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",35663:"SHADER_TYPE",35664:"FLOAT_VEC2",35665:"FLOAT_VEC3",35666:"FLOAT_VEC4",35667:"INT_VEC2",35668:"INT_VEC3",35669:"INT_VEC4",35670:"BOOL",35671:"BOOL_VEC2",35672:"BOOL_VEC3",35673:"BOOL_VEC4",35674:"FLOAT_MAT2",35675:"FLOAT_MAT3",35676:"FLOAT_MAT4",35678:"SAMPLER_2D",35680:"SAMPLER_CUBE",35712:"DELETE_STATUS",35713:"COMPILE_STATUS",35714:"LINK_STATUS",35715:"VALIDATE_STATUS",35716:"INFO_LOG_LENGTH",35717:"ATTACHED_SHADERS",35718:"ACTIVE_UNIFORMS",35719:"ACTIVE_UNIFORM_MAX_LENGTH",35720:"SHADER_SOURCE_LENGTH",35721:"ACTIVE_ATTRIBUTES",35722:"ACTIVE_ATTRIBUTE_MAX_LENGTH",35724:"SHADING_LANGUAGE_VERSION",35725:"CURRENT_PROGRAM",36003:"STENCIL_BACK_REF",36004:"STENCIL_BACK_VALUE_MASK",36005:"STENCIL_BACK_WRITEMASK",36006:"FRAMEBUFFER_BINDING",36007:"RENDERBUFFER_BINDING",36048:"FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",36049:"FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",36050:"FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",36051:"FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",36053:"FRAMEBUFFER_COMPLETE",36054:"FRAMEBUFFER_INCOMPLETE_ATTACHMENT",36055:"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",36057:"FRAMEBUFFER_INCOMPLETE_DIMENSIONS",36061:"FRAMEBUFFER_UNSUPPORTED",36064:"COLOR_ATTACHMENT0",36096:"DEPTH_ATTACHMENT",36128:"STENCIL_ATTACHMENT",36160:"FRAMEBUFFER",36161:"RENDERBUFFER",36162:"RENDERBUFFER_WIDTH",36163:"RENDERBUFFER_HEIGHT",36164:"RENDERBUFFER_INTERNAL_FORMAT",36168:"STENCIL_INDEX8",36176:"RENDERBUFFER_RED_SIZE",36177:"RENDERBUFFER_GREEN_SIZE",36178:"RENDERBUFFER_BLUE_SIZE",36179:"RENDERBUFFER_ALPHA_SIZE",36180:"RENDERBUFFER_DEPTH_SIZE",36181:"RENDERBUFFER_STENCIL_SIZE",36194:"RGB565",36336:"LOW_FLOAT",36337:"MEDIUM_FLOAT",36338:"HIGH_FLOAT",36339:"LOW_INT",36340:"MEDIUM_INT",36341:"HIGH_INT",36346:"SHADER_COMPILER",36347:"MAX_VERTEX_UNIFORM_VECTORS",36348:"MAX_VARYING_VECTORS",36349:"MAX_FRAGMENT_UNIFORM_VECTORS",37440:"UNPACK_FLIP_Y_WEBGL",37441:"UNPACK_PREMULTIPLY_ALPHA_WEBGL",37442:"CONTEXT_LOST_WEBGL",37443:"UNPACK_COLORSPACE_CONVERSION_WEBGL",37444:"BROWSER_DEFAULT_WEBGL"}},{}],265:[function(n,z,q){var t=n("./1.0/numbers");z.exports=function(h){return t[h]}},{"./1.0/numbers":264}],266:[function(n,z,q){"use strict";z.exports=function(s){var a=s.gl,c=t(a),f=h(a,[{buffer:c,type:a.FLOAT,size:3,offset:0,stride:40},{buffer:c,type:a.FLOAT,size:4,offset:12,stride:40},{buffer:c,type:a.FLOAT,size:3,offset:28,stride:40}]),g=p(a);g.attributes.position.location=0,g.attributes.color.location=1,g.attributes.offset.location=2;var d=new e(a,c,f,g);return d.update(s),d};var t=n("gl-buffer"),h=n("gl-vao"),p=n("./shaders/index"),l=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function e(s,a,c,f){this.gl=s,this.shader=f,this.buffer=a,this.vao=c,this.pixelRatio=1,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.lineWidth=[1,1,1],this.capSize=[10,10,10],this.lineCount=[0,0,0],this.lineOffset=[0,0,0],this.opacity=1,this.hasAlpha=!1}var o=e.prototype;function r(s,a){for(var c=0;c<3;++c)s[0][c]=Math.min(s[0][c],a[c]),s[1][c]=Math.max(s[1][c],a[c])}o.isOpaque=function(){return!this.hasAlpha},o.isTransparent=function(){return this.hasAlpha},o.drawTransparent=o.draw=function(s){var a=this.gl,c=this.shader.uniforms;this.shader.bind();var f=c.view=s.view||l,g=c.projection=s.projection||l;c.model=s.model||l,c.clipBounds=this.clipBounds,c.opacity=this.opacity;var d=f[12],m=f[13],y=f[14],v=f[15],T=(s._ortho?2:1)*this.pixelRatio*(g[3]*d+g[7]*m+g[11]*y+g[15]*v)/a.drawingBufferHeight;this.vao.bind();for(var w=0;w<3;++w)a.lineWidth(this.lineWidth[w]*this.pixelRatio),c.capSize=this.capSize[w]*T,this.lineCount[w]&&a.drawArrays(a.LINES,this.lineOffset[w],this.lineCount[w]);this.vao.unbind()};var i=function(){for(var s=new Array(3),a=0;a<3;++a){for(var c=[],f=1;f<=2;++f)for(var g=-1;g<=1;g+=2){var d=[0,0,0];d[(f+a)%3]=g,c.push(d)}s[a]=c}return s}();function u(s,a,c,f){for(var g=i[f],d=0;d<g.length;++d){var m=g[d];s.push(a[0],a[1],a[2],c[0],c[1],c[2],c[3],m[0],m[1],m[2])}return g.length}o.update=function(s){"lineWidth"in(s=s||{})&&(this.lineWidth=s.lineWidth,Array.isArray(this.lineWidth)||(this.lineWidth=[this.lineWidth,this.lineWidth,this.lineWidth])),"capSize"in s&&(this.capSize=s.capSize,Array.isArray(this.capSize)||(this.capSize=[this.capSize,this.capSize,this.capSize])),this.hasAlpha=!1,"opacity"in s&&(this.opacity=+s.opacity,this.opacity<1&&(this.hasAlpha=!0));var a=s.color||[[0,0,0],[0,0,0],[0,0,0]],c=s.position,f=s.error;if(Array.isArray(a[0])||(a=[a,a,a]),c&&f){var g=[],d=c.length,m=0;this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.lineCount=[0,0,0];for(var y=0;y<3;++y){this.lineOffset[y]=m;e:for(var v=0;v<d;++v){for(var T=c[v],w=0;w<3;++w)if(isNaN(T[w])||!isFinite(T[w]))continue e;var A=f[v],E=a[y];if(Array.isArray(E[0])&&(E=a[v]),E.length===3?E=[E[0],E[1],E[2],1]:E.length===4&&(E=[E[0],E[1],E[2],E[3]],!this.hasAlpha&&E[3]<1&&(this.hasAlpha=!0)),!isNaN(A[0][y])&&!isNaN(A[1][y])){var M;A[0][y]<0&&((M=T.slice())[y]+=A[0][y],g.push(T[0],T[1],T[2],E[0],E[1],E[2],E[3],0,0,0,M[0],M[1],M[2],E[0],E[1],E[2],E[3],0,0,0),r(this.bounds,M),m+=2+u(g,M,E,y)),A[1][y]>0&&((M=T.slice())[y]+=A[1][y],g.push(T[0],T[1],T[2],E[0],E[1],E[2],E[3],0,0,0,M[0],M[1],M[2],E[0],E[1],E[2],E[3],0,0,0),r(this.bounds,M),m+=2+u(g,M,E,y))}}this.lineCount[y]=m-this.lineOffset[y]}this.buffer.update(g)}},o.dispose=function(){this.shader.dispose(),this.buffer.dispose(),this.vao.dispose()}},{"./shaders/index":268,"gl-buffer":259,"gl-vao":358}],267:[function(n,z,q){arguments[4][257][0].apply(q,arguments)},{dup:257}],268:[function(n,z,q){"use strict";var t=n("glslify"),h=n("gl-shader"),p=t([`precision highp float;
#define GLSLIFY 1

attribute vec3 position, offset;
attribute vec4 color;
uniform mat4 model, view, projection;
uniform float capSize;
varying vec4 fragColor;
varying vec3 fragPosition;

void main() {
  vec4 worldPosition  = model * vec4(position, 1.0);
  worldPosition       = (worldPosition / worldPosition.w) + vec4(capSize * offset, 0.0);
  gl_Position         = projection * view * worldPosition;
  fragColor           = color;
  fragPosition        = position;
}`]),l=t([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform float opacity;
varying vec3 fragPosition;
varying vec4 fragColor;

void main() {
  if (
    outOfRange(clipBounds[0], clipBounds[1], fragPosition) ||
    fragColor.a * opacity == 0.
  ) discard;

  gl_FragColor = opacity * fragColor;
}`]);z.exports=function(e){return h(e,p,l,null,[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"offset",type:"vec3"}])}},{"gl-shader":335,glslify:267}],269:[function(n,z,q){"use strict";var t=n("gl-texture2d");z.exports=function(d,m,y,v){h||(h=d.FRAMEBUFFER_UNSUPPORTED,p=d.FRAMEBUFFER_INCOMPLETE_ATTACHMENT,l=d.FRAMEBUFFER_INCOMPLETE_DIMENSIONS,e=d.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT);var T=d.getExtension("WEBGL_draw_buffers");if(!o&&T&&function(S,C){var k=S.getParameter(C.MAX_COLOR_ATTACHMENTS_WEBGL);o=new Array(k+1);for(var L=0;L<=k;++L){for(var I=new Array(k),R=0;R<L;++R)I[R]=S.COLOR_ATTACHMENT0+R;for(R=L;R<k;++R)I[R]=S.NONE;o[L]=I}}(d,T),Array.isArray(m)&&(v=y,y=0|m[1],m=0|m[0]),typeof m!="number")throw new Error("gl-fbo: Missing shape parameter");var w=d.getParameter(d.MAX_RENDERBUFFER_SIZE);if(m<0||m>w||y<0||y>w)throw new Error("gl-fbo: Parameters are too large for FBO");var A=1;if("color"in(v=v||{})){if((A=Math.max(0|v.color,0))<0)throw new Error("gl-fbo: Must specify a nonnegative number of colors");if(A>1){if(!T)throw new Error("gl-fbo: Multiple draw buffer extension not supported");if(A>d.getParameter(T.MAX_COLOR_ATTACHMENTS_WEBGL))throw new Error("gl-fbo: Context does not support "+A+" draw buffers")}}var E=d.UNSIGNED_BYTE,M=d.getExtension("OES_texture_float");if(v.float&&A>0){if(!M)throw new Error("gl-fbo: Context does not support floating point textures");E=d.FLOAT}else v.preferFloat&&A>0&&M&&(E=d.FLOAT);var b=!0;"depth"in v&&(b=!!v.depth);var _=!1;return"stencil"in v&&(_=!!v.stencil),new c(d,m,y,E,A,b,_,T)};var h,p,l,e,o=null;function r(d){return[d.getParameter(d.FRAMEBUFFER_BINDING),d.getParameter(d.RENDERBUFFER_BINDING),d.getParameter(d.TEXTURE_BINDING_2D)]}function i(d,m){d.bindFramebuffer(d.FRAMEBUFFER,m[0]),d.bindRenderbuffer(d.RENDERBUFFER,m[1]),d.bindTexture(d.TEXTURE_2D,m[2])}function u(d){switch(d){case h:throw new Error("gl-fbo: Framebuffer unsupported");case p:throw new Error("gl-fbo: Framebuffer incomplete attachment");case l:throw new Error("gl-fbo: Framebuffer incomplete dimensions");case e:throw new Error("gl-fbo: Framebuffer incomplete missing attachment");default:throw new Error("gl-fbo: Framebuffer failed for unspecified reason")}}function s(d,m,y,v,T,w){if(!v)return null;var A=t(d,m,y,T,v);return A.magFilter=d.NEAREST,A.minFilter=d.NEAREST,A.mipSamples=1,A.bind(),d.framebufferTexture2D(d.FRAMEBUFFER,w,d.TEXTURE_2D,A.handle,0),A}function a(d,m,y,v,T){var w=d.createRenderbuffer();return d.bindRenderbuffer(d.RENDERBUFFER,w),d.renderbufferStorage(d.RENDERBUFFER,v,m,y),d.framebufferRenderbuffer(d.FRAMEBUFFER,T,d.RENDERBUFFER,w),w}function c(d,m,y,v,T,w,A,E){this.gl=d,this._shape=[0|m,0|y],this._destroyed=!1,this._ext=E,this.color=new Array(T);for(var M=0;M<T;++M)this.color[M]=null;this._color_rb=null,this.depth=null,this._depth_rb=null,this._colorType=v,this._useDepth=w,this._useStencil=A;var b=this,_=[0|m,0|y];Object.defineProperties(_,{0:{get:function(){return b._shape[0]},set:function(S){return b.width=S}},1:{get:function(){return b._shape[1]},set:function(S){return b.height=S}}}),this._shapeVector=_,function(S){var C=r(S.gl),k=S.gl,L=S.handle=k.createFramebuffer(),I=S._shape[0],R=S._shape[1],V=S.color.length,O=S._ext,J=S._useStencil,D=S._useDepth,B=S._colorType;k.bindFramebuffer(k.FRAMEBUFFER,L);for(var N=0;N<V;++N)S.color[N]=s(k,I,R,B,k.RGBA,k.COLOR_ATTACHMENT0+N);V===0?(S._color_rb=a(k,I,R,k.RGBA4,k.COLOR_ATTACHMENT0),O&&O.drawBuffersWEBGL(o[0])):V>1&&O.drawBuffersWEBGL(o[V]);var F=k.getExtension("WEBGL_depth_texture");F?J?S.depth=s(k,I,R,F.UNSIGNED_INT_24_8_WEBGL,k.DEPTH_STENCIL,k.DEPTH_STENCIL_ATTACHMENT):D&&(S.depth=s(k,I,R,k.UNSIGNED_SHORT,k.DEPTH_COMPONENT,k.DEPTH_ATTACHMENT)):D&&J?S._depth_rb=a(k,I,R,k.DEPTH_STENCIL,k.DEPTH_STENCIL_ATTACHMENT):D?S._depth_rb=a(k,I,R,k.DEPTH_COMPONENT16,k.DEPTH_ATTACHMENT):J&&(S._depth_rb=a(k,I,R,k.STENCIL_INDEX,k.STENCIL_ATTACHMENT));var H=k.checkFramebufferStatus(k.FRAMEBUFFER);if(H!==k.FRAMEBUFFER_COMPLETE){for(S._destroyed=!0,k.bindFramebuffer(k.FRAMEBUFFER,null),k.deleteFramebuffer(S.handle),S.handle=null,S.depth&&(S.depth.dispose(),S.depth=null),S._depth_rb&&(k.deleteRenderbuffer(S._depth_rb),S._depth_rb=null),N=0;N<S.color.length;++N)S.color[N].dispose(),S.color[N]=null;S._color_rb&&(k.deleteRenderbuffer(S._color_rb),S._color_rb=null),i(k,C),u(H)}i(k,C)}(this)}var f=c.prototype;function g(d,m,y){if(d._destroyed)throw new Error("gl-fbo: Can't resize destroyed FBO");if(d._shape[0]!==m||d._shape[1]!==y){var v=d.gl,T=v.getParameter(v.MAX_RENDERBUFFER_SIZE);if(m<0||m>T||y<0||y>T)throw new Error("gl-fbo: Can't resize FBO, invalid dimensions");d._shape[0]=m,d._shape[1]=y;for(var w=r(v),A=0;A<d.color.length;++A)d.color[A].shape=d._shape;d._color_rb&&(v.bindRenderbuffer(v.RENDERBUFFER,d._color_rb),v.renderbufferStorage(v.RENDERBUFFER,v.RGBA4,d._shape[0],d._shape[1])),d.depth&&(d.depth.shape=d._shape),d._depth_rb&&(v.bindRenderbuffer(v.RENDERBUFFER,d._depth_rb),d._useDepth&&d._useStencil?v.renderbufferStorage(v.RENDERBUFFER,v.DEPTH_STENCIL,d._shape[0],d._shape[1]):d._useDepth?v.renderbufferStorage(v.RENDERBUFFER,v.DEPTH_COMPONENT16,d._shape[0],d._shape[1]):d._useStencil&&v.renderbufferStorage(v.RENDERBUFFER,v.STENCIL_INDEX,d._shape[0],d._shape[1])),v.bindFramebuffer(v.FRAMEBUFFER,d.handle);var E=v.checkFramebufferStatus(v.FRAMEBUFFER);E!==v.FRAMEBUFFER_COMPLETE&&(d.dispose(),i(v,w),u(E)),i(v,w)}}Object.defineProperties(f,{shape:{get:function(){return this._destroyed?[0,0]:this._shapeVector},set:function(d){if(Array.isArray(d)||(d=[0|d,0|d]),d.length!==2)throw new Error("gl-fbo: Shape vector must be length 2");var m=0|d[0],y=0|d[1];return g(this,m,y),[m,y]},enumerable:!1},width:{get:function(){return this._destroyed?0:this._shape[0]},set:function(d){return g(this,d|=0,this._shape[1]),d},enumerable:!1},height:{get:function(){return this._destroyed?0:this._shape[1]},set:function(d){return d|=0,g(this,this._shape[0],d),d},enumerable:!1}}),f.bind=function(){if(!this._destroyed){var d=this.gl;d.bindFramebuffer(d.FRAMEBUFFER,this.handle),d.viewport(0,0,this._shape[0],this._shape[1])}},f.dispose=function(){if(!this._destroyed){this._destroyed=!0;var d=this.gl;d.deleteFramebuffer(this.handle),this.handle=null,this.depth&&(this.depth.dispose(),this.depth=null),this._depth_rb&&(d.deleteRenderbuffer(this._depth_rb),this._depth_rb=null);for(var m=0;m<this.color.length;++m)this.color[m].dispose(),this.color[m]=null;this._color_rb&&(d.deleteRenderbuffer(this._color_rb),this._color_rb=null)}}},{"gl-texture2d":353}],270:[function(n,z,q){var t=n("sprintf-js").sprintf,h=n("gl-constants/lookup"),p=n("glsl-shader-name"),l=n("add-line-numbers");z.exports=function(e,o,r){"use strict";var i=p(o)||"of unknown name (see npm glsl-shader-name)",u="unknown type";r!==void 0&&(u=r===h.FRAGMENT_SHADER?"fragment":"vertex");for(var s=t(`Error compiling %s shader %s:
`,u,i),a=t("%s%s",s,e),c=e.split(`
`),f={},g=0;g<c.length;g++){var d=c[g];if(d!==""&&d!=="\0"){var m=parseInt(d.split(":")[2]);if(isNaN(m))throw new Error(t("Could not parse error: %s",d));f[m]=d}}var y=l(o).split(`
`);for(g=0;g<y.length;g++)if(f[g+3]||f[g+2]||f[g+1]){var v=y[g];if(s+=v+`
`,f[g+1]){var T=f[g+1];T=T.substr(T.split(":",3).join(":").length+1).trim(),s+=t(`^^^ %s

`,T)}}return{long:s.trim(),short:a.trim()}}},{"add-line-numbers":66,"gl-constants/lookup":265,"glsl-shader-name":431,"sprintf-js":567}],271:[function(n,z,q){"use strict";z.exports=function(a,c){var f=a.gl,g=l(f,o.vertex,o.fragment),d=l(f,o.pickVertex,o.pickFragment),m=e(f),y=e(f),v=e(f),T=e(f),w=new r(a,g,d,m,y,v,T);return w.update(c),a.addObject(w),w};var t=n("binary-search-bounds"),h=n("iota-array"),p=n("typedarray-pool"),l=n("gl-shader"),e=n("gl-buffer"),o=n("./lib/shaders");function r(a,c,f,g,d,m,y){this.plot=a,this.shader=c,this.pickShader=f,this.positionBuffer=g,this.weightBuffer=d,this.colorBuffer=m,this.idBuffer=y,this.xData=[],this.yData=[],this.shape=[0,0],this.bounds=[1/0,1/0,-1/0,-1/0],this.pickOffset=0}var i,u=r.prototype,s=[0,0,1,0,0,1,1,0,1,1,0,1];u.draw=(i=[1,0,0,0,1,0,0,0,1],function(){var a=this.plot,c=this.shader,f=this.bounds,g=this.numVertices;if(!(g<=0)){var d=a.gl,m=a.dataBox,y=f[2]-f[0],v=f[3]-f[1],T=m[2]-m[0],w=m[3]-m[1];i[0]=2*y/T,i[4]=2*v/w,i[6]=2*(f[0]-m[0])/T-1,i[7]=2*(f[1]-m[1])/w-1,c.bind();var A=c.uniforms;A.viewTransform=i,A.shape=this.shape;var E=c.attributes;this.positionBuffer.bind(),E.position.pointer(),this.weightBuffer.bind(),E.weight.pointer(d.UNSIGNED_BYTE,!1),this.colorBuffer.bind(),E.color.pointer(d.UNSIGNED_BYTE,!0),d.drawArrays(d.TRIANGLES,0,g)}}),u.drawPick=function(){var a=[1,0,0,0,1,0,0,0,1],c=[0,0,0,0];return function(f){var g=this.plot,d=this.pickShader,m=this.bounds,y=this.numVertices;if(!(y<=0)){var v=g.gl,T=g.dataBox,w=m[2]-m[0],A=m[3]-m[1],E=T[2]-T[0],M=T[3]-T[1];a[0]=2*w/E,a[4]=2*A/M,a[6]=2*(m[0]-T[0])/E-1,a[7]=2*(m[1]-T[1])/M-1;for(var b=0;b<4;++b)c[b]=f>>8*b&255;this.pickOffset=f,d.bind();var _=d.uniforms;_.viewTransform=a,_.pickOffset=c,_.shape=this.shape;var S=d.attributes;return this.positionBuffer.bind(),S.position.pointer(),this.weightBuffer.bind(),S.weight.pointer(v.UNSIGNED_BYTE,!1),this.idBuffer.bind(),S.pickId.pointer(v.UNSIGNED_BYTE,!1),v.drawArrays(v.TRIANGLES,0,y),f+this.shape[0]*this.shape[1]}}}(),u.pick=function(a,c,f){var g=this.pickOffset,d=this.shape[0]*this.shape[1];if(f<g||f>=g+d)return null;var m=f-g,y=this.xData,v=this.yData;return{object:this,pointId:m,dataCoord:[y[m%this.shape[0]],v[m/this.shape[0]|0]]}},u.update=function(a){var c=(a=a||{}).shape||[0,0],f=a.x||h(c[0]),g=a.y||h(c[1]),d=a.z||new Float32Array(c[0]*c[1]),m=a.zsmooth!==!1;this.xData=f,this.yData=g;var y,v,T,w,A=a.colorLevels||[0],E=a.colorValues||[0,0,0,1],M=A.length,b=this.bounds;m?(y=b[0]=f[0],v=b[1]=g[0],T=b[2]=f[f.length-1],w=b[3]=g[g.length-1]):(y=b[0]=f[0]+(f[1]-f[0])/2,v=b[1]=g[0]+(g[1]-g[0])/2,T=b[2]=f[f.length-1]+(f[f.length-1]-f[f.length-2])/2,w=b[3]=g[g.length-1]+(g[g.length-1]-g[g.length-2])/2);var _=1/(T-y),S=1/(w-v),C=c[0],k=c[1];this.shape=[C,k];var L=(m?(C-1)*(k-1):C*k)*(s.length>>>1);this.numVertices=L;for(var I=p.mallocUint8(4*L),R=p.mallocFloat32(2*L),V=p.mallocUint8(2*L),O=p.mallocUint32(L),J=0,D=m?C-1:C,B=m?k-1:k,N=0;N<B;++N){var F,H;m?(F=S*(g[N]-v),H=S*(g[N+1]-v)):(F=N<k-1?S*(g[N]-(g[N+1]-g[N])/2-v):S*(g[N]-(g[N]-g[N-1])/2-v),H=N<k-1?S*(g[N]+(g[N+1]-g[N])/2-v):S*(g[N]+(g[N]-g[N-1])/2-v));for(var j=0;j<D;++j){var G,W;m?(G=_*(f[j]-y),W=_*(f[j+1]-y)):(G=j<C-1?_*(f[j]-(f[j+1]-f[j])/2-y):_*(f[j]-(f[j]-f[j-1])/2-y),W=j<C-1?_*(f[j]+(f[j+1]-f[j])/2-y):_*(f[j]+(f[j]-f[j-1])/2-y));for(var Q=0;Q<s.length;Q+=2){var $,ee,ie,ae,oe=s[Q],de=s[Q+1],le=d[m?(N+de)*C+(j+oe):N*C+j],fe=t.le(A,le);if(fe<0)$=E[0],ee=E[1],ie=E[2],ae=E[3];else if(fe===M-1)$=E[4*M-4],ee=E[4*M-3],ie=E[4*M-2],ae=E[4*M-1];else{var ue=(le-A[fe])/(A[fe+1]-A[fe]),we=1-ue,Ae=4*fe,Se=4*(fe+1);$=we*E[Ae]+ue*E[Se],ee=we*E[Ae+1]+ue*E[Se+1],ie=we*E[Ae+2]+ue*E[Se+2],ae=we*E[Ae+3]+ue*E[Se+3]}I[4*J]=255*$,I[4*J+1]=255*ee,I[4*J+2]=255*ie,I[4*J+3]=255*ae,R[2*J]=.5*G+.5*W,R[2*J+1]=.5*F+.5*H,V[2*J]=oe,V[2*J+1]=de,O[J]=N*C+j,J+=1}}}this.positionBuffer.update(R),this.weightBuffer.update(V),this.colorBuffer.update(I),this.idBuffer.update(O),p.free(R),p.free(I),p.free(V),p.free(O)},u.dispose=function(){this.shader.dispose(),this.pickShader.dispose(),this.positionBuffer.dispose(),this.weightBuffer.dispose(),this.colorBuffer.dispose(),this.idBuffer.dispose(),this.plot.removeObject(this)}},{"./lib/shaders":272,"binary-search-bounds":96,"gl-buffer":259,"gl-shader":335,"iota-array":463,"typedarray-pool":595}],272:[function(n,z,q){"use strict";var t=n("glslify");z.exports={fragment:t([`precision lowp float;
#define GLSLIFY 1
varying vec4 fragColor;
void main() {
  gl_FragColor = vec4(fragColor.rgb * fragColor.a, fragColor.a);
}
`]),vertex:t([`precision mediump float;
#define GLSLIFY 1

attribute vec2 position;
attribute vec4 color;
attribute vec2 weight;

uniform vec2 shape;
uniform mat3 viewTransform;

varying vec4 fragColor;

void main() {
  vec3 vPosition = viewTransform * vec3( position + (weight-.5)/(shape-1.) , 1.0);
  fragColor = color;
  gl_Position = vec4(vPosition.xy, 0, vPosition.z);
}
`]),pickFragment:t([`precision mediump float;
#define GLSLIFY 1

varying vec4 fragId;
varying vec2 vWeight;

uniform vec2 shape;
uniform vec4 pickOffset;

void main() {
  vec2 d = step(.5, vWeight);
  vec4 id = fragId + pickOffset;
  id.x += d.x + d.y*shape.x;

  id.y += floor(id.x / 256.0);
  id.x -= floor(id.x / 256.0) * 256.0;

  id.z += floor(id.y / 256.0);
  id.y -= floor(id.y / 256.0) * 256.0;

  id.w += floor(id.z / 256.0);
  id.z -= floor(id.z / 256.0) * 256.0;

  gl_FragColor = id/255.;
}
`]),pickVertex:t([`precision mediump float;
#define GLSLIFY 1

attribute vec2 position;
attribute vec4 pickId;
attribute vec2 weight;

uniform vec2 shape;
uniform mat3 viewTransform;

varying vec4 fragId;
varying vec2 vWeight;

void main() {
  vWeight = weight;

  fragId = pickId;

  vec3 vPosition = viewTransform * vec3( position + (weight-.5)/(shape-1.) , 1.0);
  gl_Position = vec4(vPosition.xy, 0, vPosition.z);
}
`])}},{glslify:273}],273:[function(n,z,q){arguments[4][257][0].apply(q,arguments)},{dup:257}],274:[function(n,z,q){var t=n("glslify"),h=n("gl-shader"),p=t([`precision highp float;
#define GLSLIFY 1

attribute vec3 position, nextPosition;
attribute float arcLength, lineWidth;
attribute vec4 color;

uniform vec2 screenShape;
uniform float pixelRatio;
uniform mat4 model, view, projection;

varying vec4 fragColor;
varying vec3 worldPosition;
varying float pixelArcLength;

vec4 project(vec3 p) {
  return projection * view * model * vec4(p, 1.0);
}

void main() {
  vec4 startPoint = project(position);
  vec4 endPoint   = project(nextPosition);

  vec2 A = startPoint.xy / startPoint.w;
  vec2 B =   endPoint.xy /   endPoint.w;

  float clipAngle = atan(
    (B.y - A.y) * screenShape.y,
    (B.x - A.x) * screenShape.x
  );

  vec2 offset = 0.5 * pixelRatio * lineWidth * vec2(
    sin(clipAngle),
    -cos(clipAngle)
  ) / screenShape;

  gl_Position = vec4(startPoint.xy + startPoint.w * offset, startPoint.zw);

  worldPosition = position;
  pixelArcLength = arcLength;
  fragColor = color;
}
`]),l=t([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3      clipBounds[2];
uniform sampler2D dashTexture;
uniform float     dashScale;
uniform float     opacity;

varying vec3    worldPosition;
varying float   pixelArcLength;
varying vec4    fragColor;

void main() {
  if (
    outOfRange(clipBounds[0], clipBounds[1], worldPosition) ||
    fragColor.a * opacity == 0.
  ) discard;

  float dashWeight = texture2D(dashTexture, vec2(dashScale * pixelArcLength, 0)).r;
  if(dashWeight < 0.5) {
    discard;
  }
  gl_FragColor = fragColor * opacity;
}
`]),e=t([`precision highp float;
#define GLSLIFY 1

#define FLOAT_MAX  1.70141184e38
#define FLOAT_MIN  1.17549435e-38

// https://github.com/mikolalysenko/glsl-read-float/blob/master/index.glsl
vec4 packFloat(float v) {
  float av = abs(v);

  //Handle special cases
  if(av < FLOAT_MIN) {
    return vec4(0.0, 0.0, 0.0, 0.0);
  } else if(v > FLOAT_MAX) {
    return vec4(127.0, 128.0, 0.0, 0.0) / 255.0;
  } else if(v < -FLOAT_MAX) {
    return vec4(255.0, 128.0, 0.0, 0.0) / 255.0;
  }

  vec4 c = vec4(0,0,0,0);

  //Compute exponent and mantissa
  float e = floor(log2(av));
  float m = av * pow(2.0, -e) - 1.0;

  //Unpack mantissa
  c[1] = floor(128.0 * m);
  m -= c[1] / 128.0;
  c[2] = floor(32768.0 * m);
  m -= c[2] / 32768.0;
  c[3] = floor(8388608.0 * m);

  //Unpack exponent
  float ebias = e + 127.0;
  c[0] = floor(ebias / 2.0);
  ebias -= c[0] * 2.0;
  c[1] += floor(ebias) * 128.0;

  //Unpack sign bit
  c[0] += 128.0 * step(0.0, -v);

  //Scale back to range
  return c / 255.0;
}

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform float pickId;
uniform vec3 clipBounds[2];

varying vec3 worldPosition;
varying float pixelArcLength;
varying vec4 fragColor;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], worldPosition)) discard;

  gl_FragColor = vec4(pickId/255.0, packFloat(pixelArcLength).xyz);
}`]),o=[{name:"position",type:"vec3"},{name:"nextPosition",type:"vec3"},{name:"arcLength",type:"float"},{name:"lineWidth",type:"float"},{name:"color",type:"vec4"}];q.createShader=function(r){return h(r,p,l,null,o)},q.createPickShader=function(r){return h(r,p,e,null,o)}},{"gl-shader":335,glslify:276}],275:[function(n,z,q){"use strict";z.exports=function(y){var v=y.gl||y.scene&&y.scene.gl,T=u(v);T.attributes.position.location=0,T.attributes.nextPosition.location=1,T.attributes.arcLength.location=2,T.attributes.lineWidth.location=3,T.attributes.color.location=4;var w=s(v);w.attributes.position.location=0,w.attributes.nextPosition.location=1,w.attributes.arcLength.location=2,w.attributes.lineWidth.location=3,w.attributes.color.location=4;for(var A=t(v),E=h(v,[{buffer:A,size:3,offset:0,stride:48},{buffer:A,size:3,offset:12,stride:48},{buffer:A,size:1,offset:24,stride:48},{buffer:A,size:1,offset:28,stride:48},{buffer:A,size:4,offset:32,stride:48}]),M=r(new Array(1024),[256,1,4]),b=0;b<1024;++b)M.data[b]=255;var _=p(v,M);_.wrap=v.REPEAT;var S=new d(v,T,w,A,E,_);return S.update(y),S};var t=n("gl-buffer"),h=n("gl-vao"),p=n("gl-texture2d"),l=new Uint8Array(4),e=new Float32Array(l.buffer),o=n("binary-search-bounds"),r=n("ndarray"),i=n("./lib/shaders"),u=i.createShader,s=i.createPickShader,a=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function c(y,v){for(var T=0,w=0;w<3;++w){var A=y[w]-v[w];T+=A*A}return Math.sqrt(T)}function f(y){for(var v=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],T=0;T<3;++T)v[0][T]=Math.max(y[0][T],v[0][T]),v[1][T]=Math.min(y[1][T],v[1][T]);return v}function g(y,v,T,w){this.arcLength=y,this.position=v,this.index=T,this.dataCoordinate=w}function d(y,v,T,w,A,E){this.gl=y,this.shader=v,this.pickShader=T,this.buffer=w,this.vao=A,this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.points=[],this.arcLength=[],this.vertexCount=0,this.bounds=[[0,0,0],[0,0,0]],this.pickId=0,this.lineWidth=1,this.texture=E,this.dashScale=1,this.opacity=1,this.hasAlpha=!1,this.dirty=!0,this.pixelRatio=1}var m=d.prototype;m.isTransparent=function(){return this.hasAlpha},m.isOpaque=function(){return!this.hasAlpha},m.pickSlots=1,m.setPickBase=function(y){this.pickId=y},m.drawTransparent=m.draw=function(y){if(this.vertexCount){var v=this.gl,T=this.shader,w=this.vao;T.bind(),T.uniforms={model:y.model||a,view:y.view||a,projection:y.projection||a,clipBounds:f(this.clipBounds),dashTexture:this.texture.bind(),dashScale:this.dashScale/this.arcLength[this.arcLength.length-1],opacity:this.opacity,screenShape:[v.drawingBufferWidth,v.drawingBufferHeight],pixelRatio:this.pixelRatio},w.bind(),w.draw(v.TRIANGLE_STRIP,this.vertexCount),w.unbind()}},m.drawPick=function(y){if(this.vertexCount){var v=this.gl,T=this.pickShader,w=this.vao;T.bind(),T.uniforms={model:y.model||a,view:y.view||a,projection:y.projection||a,pickId:this.pickId,clipBounds:f(this.clipBounds),screenShape:[v.drawingBufferWidth,v.drawingBufferHeight],pixelRatio:this.pixelRatio},w.bind(),w.draw(v.TRIANGLE_STRIP,this.vertexCount),w.unbind()}},m.update=function(y){var v,T;this.dirty=!0;var w=!!y.connectGaps;"dashScale"in y&&(this.dashScale=y.dashScale),this.hasAlpha=!1,"opacity"in y&&(this.opacity=+y.opacity,this.opacity<1&&(this.hasAlpha=!0));var A=[],E=[],M=[],b=0,_=0,S=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],C=y.position||y.positions;if(C){var k=y.color||y.colors||[0,0,0,1],L=y.lineWidth||1,I=!1;e:for(v=1;v<C.length;++v){var R,V,O,J=C[v-1],D=C[v];for(E.push(b),M.push(J.slice()),T=0;T<3;++T){if(isNaN(J[T])||isNaN(D[T])||!isFinite(J[T])||!isFinite(D[T])){if(!w&&A.length>0){for(var B=0;B<24;++B)A.push(A[A.length-12]);_+=2,I=!0}continue e}S[0][T]=Math.min(S[0][T],J[T],D[T]),S[1][T]=Math.max(S[1][T],J[T],D[T])}Array.isArray(k[0])?(R=k.length>v-1?k[v-1]:k.length>0?k[k.length-1]:[0,0,0,1],V=k.length>v?k[v]:k.length>0?k[k.length-1]:[0,0,0,1]):R=V=k,R.length===3&&(R=[R[0],R[1],R[2],1]),V.length===3&&(V=[V[0],V[1],V[2],1]),!this.hasAlpha&&R[3]<1&&(this.hasAlpha=!0),O=Array.isArray(L)?L.length>v-1?L[v-1]:L.length>0?L[L.length-1]:[0,0,0,1]:L;var N=b;if(b+=c(J,D),I){for(T=0;T<2;++T)A.push(J[0],J[1],J[2],D[0],D[1],D[2],N,O,R[0],R[1],R[2],R[3]);_+=2,I=!1}A.push(J[0],J[1],J[2],D[0],D[1],D[2],N,O,R[0],R[1],R[2],R[3],J[0],J[1],J[2],D[0],D[1],D[2],N,-O,R[0],R[1],R[2],R[3],D[0],D[1],D[2],J[0],J[1],J[2],b,-O,V[0],V[1],V[2],V[3],D[0],D[1],D[2],J[0],J[1],J[2],b,O,V[0],V[1],V[2],V[3]),_+=4}}if(this.buffer.update(A),E.push(b),M.push(C[C.length-1].slice()),this.bounds=S,this.vertexCount=_,this.points=M,this.arcLength=E,"dashes"in y){var F=y.dashes.slice();for(F.unshift(0),v=1;v<F.length;++v)F[v]=F[v-1]+F[v];var H=r(new Array(1024),[256,1,4]);for(v=0;v<256;++v){for(T=0;T<4;++T)H.set(v,0,T,0);1&o.le(F,F[F.length-1]*v/255)?H.set(v,0,0,0):H.set(v,0,0,255)}this.texture.setPixels(H)}},m.dispose=function(){this.shader.dispose(),this.vao.dispose(),this.buffer.dispose()},m.pick=function(y){if(!y||y.id!==this.pickId)return null;var v=function(C,k,L,I){return l[0]=I,l[1]=L,l[2]=k,l[3]=C,e[0]}(y.value[0],y.value[1],y.value[2],0),T=o.le(this.arcLength,v);if(T<0)return null;if(T===this.arcLength.length-1)return new g(this.arcLength[this.arcLength.length-1],this.points[this.points.length-1].slice(),T);for(var w=this.points[T],A=this.points[Math.min(T+1,this.points.length-1)],E=(v-this.arcLength[T])/(this.arcLength[T+1]-this.arcLength[T]),M=1-E,b=[0,0,0],_=0;_<3;++_)b[_]=M*w[_]+E*A[_];var S=Math.min(E<.5?T:T+1,this.points.length-1);return new g(v,b,S,this.points[S])}},{"./lib/shaders":274,"binary-search-bounds":96,"gl-buffer":259,"gl-texture2d":353,"gl-vao":358,ndarray:495}],276:[function(n,z,q){arguments[4][257][0].apply(q,arguments)},{dup:257}],277:[function(n,z,q){z.exports=function(t,h){var p=h[0],l=h[1],e=h[2],o=h[3],r=h[4],i=h[5],u=h[6],s=h[7],a=h[8],c=h[9],f=h[10],g=h[11],d=h[12],m=h[13],y=h[14],v=h[15];return t[0]=i*(f*v-g*y)-c*(u*v-s*y)+m*(u*g-s*f),t[1]=-(l*(f*v-g*y)-c*(e*v-o*y)+m*(e*g-o*f)),t[2]=l*(u*v-s*y)-i*(e*v-o*y)+m*(e*s-o*u),t[3]=-(l*(u*g-s*f)-i*(e*g-o*f)+c*(e*s-o*u)),t[4]=-(r*(f*v-g*y)-a*(u*v-s*y)+d*(u*g-s*f)),t[5]=p*(f*v-g*y)-a*(e*v-o*y)+d*(e*g-o*f),t[6]=-(p*(u*v-s*y)-r*(e*v-o*y)+d*(e*s-o*u)),t[7]=p*(u*g-s*f)-r*(e*g-o*f)+a*(e*s-o*u),t[8]=r*(c*v-g*m)-a*(i*v-s*m)+d*(i*g-s*c),t[9]=-(p*(c*v-g*m)-a*(l*v-o*m)+d*(l*g-o*c)),t[10]=p*(i*v-s*m)-r*(l*v-o*m)+d*(l*s-o*i),t[11]=-(p*(i*g-s*c)-r*(l*g-o*c)+a*(l*s-o*i)),t[12]=-(r*(c*y-f*m)-a*(i*y-u*m)+d*(i*f-u*c)),t[13]=p*(c*y-f*m)-a*(l*y-e*m)+d*(l*f-e*c),t[14]=-(p*(i*y-u*m)-r*(l*y-e*m)+d*(l*u-e*i)),t[15]=p*(i*f-u*c)-r*(l*f-e*c)+a*(l*u-e*i),t}},{}],278:[function(n,z,q){z.exports=function(t){var h=new Float32Array(16);return h[0]=t[0],h[1]=t[1],h[2]=t[2],h[3]=t[3],h[4]=t[4],h[5]=t[5],h[6]=t[6],h[7]=t[7],h[8]=t[8],h[9]=t[9],h[10]=t[10],h[11]=t[11],h[12]=t[12],h[13]=t[13],h[14]=t[14],h[15]=t[15],h}},{}],279:[function(n,z,q){z.exports=function(t,h){return t[0]=h[0],t[1]=h[1],t[2]=h[2],t[3]=h[3],t[4]=h[4],t[5]=h[5],t[6]=h[6],t[7]=h[7],t[8]=h[8],t[9]=h[9],t[10]=h[10],t[11]=h[11],t[12]=h[12],t[13]=h[13],t[14]=h[14],t[15]=h[15],t}},{}],280:[function(n,z,q){z.exports=function(){var t=new Float32Array(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},{}],281:[function(n,z,q){z.exports=function(t){var h=t[0],p=t[1],l=t[2],e=t[3],o=t[4],r=t[5],i=t[6],u=t[7],s=t[8],a=t[9],c=t[10],f=t[11],g=t[12],d=t[13],m=t[14],y=t[15];return(h*r-p*o)*(c*y-f*m)-(h*i-l*o)*(a*y-f*d)+(h*u-e*o)*(a*m-c*d)+(p*i-l*r)*(s*y-f*g)-(p*u-e*r)*(s*m-c*g)+(l*u-e*i)*(s*d-a*g)}},{}],282:[function(n,z,q){z.exports=function(t,h){var p=h[0],l=h[1],e=h[2],o=h[3],r=p+p,i=l+l,u=e+e,s=p*r,a=l*r,c=l*i,f=e*r,g=e*i,d=e*u,m=o*r,y=o*i,v=o*u;return t[0]=1-c-d,t[1]=a+v,t[2]=f-y,t[3]=0,t[4]=a-v,t[5]=1-s-d,t[6]=g+m,t[7]=0,t[8]=f+y,t[9]=g-m,t[10]=1-s-c,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},{}],283:[function(n,z,q){z.exports=function(t,h,p){var l,e,o,r=p[0],i=p[1],u=p[2],s=Math.sqrt(r*r+i*i+u*u);return Math.abs(s)<1e-6?null:(r*=s=1/s,i*=s,u*=s,l=Math.sin(h),e=Math.cos(h),o=1-e,t[0]=r*r*o+e,t[1]=i*r*o+u*l,t[2]=u*r*o-i*l,t[3]=0,t[4]=r*i*o-u*l,t[5]=i*i*o+e,t[6]=u*i*o+r*l,t[7]=0,t[8]=r*u*o+i*l,t[9]=i*u*o-r*l,t[10]=u*u*o+e,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}},{}],284:[function(n,z,q){z.exports=function(t,h,p){var l=h[0],e=h[1],o=h[2],r=h[3],i=l+l,u=e+e,s=o+o,a=l*i,c=l*u,f=l*s,g=e*u,d=e*s,m=o*s,y=r*i,v=r*u,T=r*s;return t[0]=1-(g+m),t[1]=c+T,t[2]=f-v,t[3]=0,t[4]=c-T,t[5]=1-(a+m),t[6]=d+y,t[7]=0,t[8]=f+v,t[9]=d-y,t[10]=1-(a+g),t[11]=0,t[12]=p[0],t[13]=p[1],t[14]=p[2],t[15]=1,t}},{}],285:[function(n,z,q){z.exports=function(t,h){return t[0]=h[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=h[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=h[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},{}],286:[function(n,z,q){z.exports=function(t,h){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=h[0],t[13]=h[1],t[14]=h[2],t[15]=1,t}},{}],287:[function(n,z,q){z.exports=function(t,h){var p=Math.sin(h),l=Math.cos(h);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=l,t[6]=p,t[7]=0,t[8]=0,t[9]=-p,t[10]=l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},{}],288:[function(n,z,q){z.exports=function(t,h){var p=Math.sin(h),l=Math.cos(h);return t[0]=l,t[1]=0,t[2]=-p,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=p,t[9]=0,t[10]=l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},{}],289:[function(n,z,q){z.exports=function(t,h){var p=Math.sin(h),l=Math.cos(h);return t[0]=l,t[1]=p,t[2]=0,t[3]=0,t[4]=-p,t[5]=l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},{}],290:[function(n,z,q){z.exports=function(t,h,p,l,e,o,r){var i=1/(p-h),u=1/(e-l),s=1/(o-r);return t[0]=2*o*i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*u,t[6]=0,t[7]=0,t[8]=(p+h)*i,t[9]=(e+l)*u,t[10]=(r+o)*s,t[11]=-1,t[12]=0,t[13]=0,t[14]=r*o*2*s,t[15]=0,t}},{}],291:[function(n,z,q){z.exports=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},{}],292:[function(n,z,q){z.exports={create:n("./create"),clone:n("./clone"),copy:n("./copy"),identity:n("./identity"),transpose:n("./transpose"),invert:n("./invert"),adjoint:n("./adjoint"),determinant:n("./determinant"),multiply:n("./multiply"),translate:n("./translate"),scale:n("./scale"),rotate:n("./rotate"),rotateX:n("./rotateX"),rotateY:n("./rotateY"),rotateZ:n("./rotateZ"),fromRotation:n("./fromRotation"),fromRotationTranslation:n("./fromRotationTranslation"),fromScaling:n("./fromScaling"),fromTranslation:n("./fromTranslation"),fromXRotation:n("./fromXRotation"),fromYRotation:n("./fromYRotation"),fromZRotation:n("./fromZRotation"),fromQuat:n("./fromQuat"),frustum:n("./frustum"),perspective:n("./perspective"),perspectiveFromFieldOfView:n("./perspectiveFromFieldOfView"),ortho:n("./ortho"),lookAt:n("./lookAt"),str:n("./str")}},{"./adjoint":277,"./clone":278,"./copy":279,"./create":280,"./determinant":281,"./fromQuat":282,"./fromRotation":283,"./fromRotationTranslation":284,"./fromScaling":285,"./fromTranslation":286,"./fromXRotation":287,"./fromYRotation":288,"./fromZRotation":289,"./frustum":290,"./identity":291,"./invert":293,"./lookAt":294,"./multiply":295,"./ortho":296,"./perspective":297,"./perspectiveFromFieldOfView":298,"./rotate":299,"./rotateX":300,"./rotateY":301,"./rotateZ":302,"./scale":303,"./str":304,"./translate":305,"./transpose":306}],293:[function(n,z,q){z.exports=function(t,h){var p=h[0],l=h[1],e=h[2],o=h[3],r=h[4],i=h[5],u=h[6],s=h[7],a=h[8],c=h[9],f=h[10],g=h[11],d=h[12],m=h[13],y=h[14],v=h[15],T=p*i-l*r,w=p*u-e*r,A=p*s-o*r,E=l*u-e*i,M=l*s-o*i,b=e*s-o*u,_=a*m-c*d,S=a*y-f*d,C=a*v-g*d,k=c*y-f*m,L=c*v-g*m,I=f*v-g*y,R=T*I-w*L+A*k+E*C-M*S+b*_;return R?(R=1/R,t[0]=(i*I-u*L+s*k)*R,t[1]=(e*L-l*I-o*k)*R,t[2]=(m*b-y*M+v*E)*R,t[3]=(f*M-c*b-g*E)*R,t[4]=(u*C-r*I-s*S)*R,t[5]=(p*I-e*C+o*S)*R,t[6]=(y*A-d*b-v*w)*R,t[7]=(a*b-f*A+g*w)*R,t[8]=(r*L-i*C+s*_)*R,t[9]=(l*C-p*L-o*_)*R,t[10]=(d*M-m*A+v*T)*R,t[11]=(c*A-a*M-g*T)*R,t[12]=(i*S-r*k-u*_)*R,t[13]=(p*k-l*S+e*_)*R,t[14]=(m*w-d*E-y*T)*R,t[15]=(a*E-c*w+f*T)*R,t):null}},{}],294:[function(n,z,q){var t=n("./identity");z.exports=function(h,p,l,e){var o,r,i,u,s,a,c,f,g,d,m=p[0],y=p[1],v=p[2],T=e[0],w=e[1],A=e[2],E=l[0],M=l[1],b=l[2];return Math.abs(m-E)<1e-6&&Math.abs(y-M)<1e-6&&Math.abs(v-b)<1e-6?t(h):(c=m-E,f=y-M,g=v-b,d=1/Math.sqrt(c*c+f*f+g*g),o=w*(g*=d)-A*(f*=d),r=A*(c*=d)-T*g,i=T*f-w*c,(d=Math.sqrt(o*o+r*r+i*i))?(o*=d=1/d,r*=d,i*=d):(o=0,r=0,i=0),u=f*i-g*r,s=g*o-c*i,a=c*r-f*o,(d=Math.sqrt(u*u+s*s+a*a))?(u*=d=1/d,s*=d,a*=d):(u=0,s=0,a=0),h[0]=o,h[1]=u,h[2]=c,h[3]=0,h[4]=r,h[5]=s,h[6]=f,h[7]=0,h[8]=i,h[9]=a,h[10]=g,h[11]=0,h[12]=-(o*m+r*y+i*v),h[13]=-(u*m+s*y+a*v),h[14]=-(c*m+f*y+g*v),h[15]=1,h)}},{"./identity":291}],295:[function(n,z,q){z.exports=function(t,h,p){var l=h[0],e=h[1],o=h[2],r=h[3],i=h[4],u=h[5],s=h[6],a=h[7],c=h[8],f=h[9],g=h[10],d=h[11],m=h[12],y=h[13],v=h[14],T=h[15],w=p[0],A=p[1],E=p[2],M=p[3];return t[0]=w*l+A*i+E*c+M*m,t[1]=w*e+A*u+E*f+M*y,t[2]=w*o+A*s+E*g+M*v,t[3]=w*r+A*a+E*d+M*T,w=p[4],A=p[5],E=p[6],M=p[7],t[4]=w*l+A*i+E*c+M*m,t[5]=w*e+A*u+E*f+M*y,t[6]=w*o+A*s+E*g+M*v,t[7]=w*r+A*a+E*d+M*T,w=p[8],A=p[9],E=p[10],M=p[11],t[8]=w*l+A*i+E*c+M*m,t[9]=w*e+A*u+E*f+M*y,t[10]=w*o+A*s+E*g+M*v,t[11]=w*r+A*a+E*d+M*T,w=p[12],A=p[13],E=p[14],M=p[15],t[12]=w*l+A*i+E*c+M*m,t[13]=w*e+A*u+E*f+M*y,t[14]=w*o+A*s+E*g+M*v,t[15]=w*r+A*a+E*d+M*T,t}},{}],296:[function(n,z,q){z.exports=function(t,h,p,l,e,o,r){var i=1/(h-p),u=1/(l-e),s=1/(o-r);return t[0]=-2*i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*s,t[11]=0,t[12]=(h+p)*i,t[13]=(e+l)*u,t[14]=(r+o)*s,t[15]=1,t}},{}],297:[function(n,z,q){z.exports=function(t,h,p,l,e){var o=1/Math.tan(h/2),r=1/(l-e);return t[0]=o/p,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(e+l)*r,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*e*l*r,t[15]=0,t}},{}],298:[function(n,z,q){z.exports=function(t,h,p,l){var e=Math.tan(h.upDegrees*Math.PI/180),o=Math.tan(h.downDegrees*Math.PI/180),r=Math.tan(h.leftDegrees*Math.PI/180),i=Math.tan(h.rightDegrees*Math.PI/180),u=2/(r+i),s=2/(e+o);return t[0]=u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=-(r-i)*u*.5,t[9]=(e-o)*s*.5,t[10]=l/(p-l),t[11]=-1,t[12]=0,t[13]=0,t[14]=l*p/(p-l),t[15]=0,t}},{}],299:[function(n,z,q){z.exports=function(t,h,p,l){var e,o,r,i,u,s,a,c,f,g,d,m,y,v,T,w,A,E,M,b,_,S,C,k,L=l[0],I=l[1],R=l[2],V=Math.sqrt(L*L+I*I+R*R);return Math.abs(V)<1e-6?null:(L*=V=1/V,I*=V,R*=V,e=Math.sin(p),o=Math.cos(p),r=1-o,i=h[0],u=h[1],s=h[2],a=h[3],c=h[4],f=h[5],g=h[6],d=h[7],m=h[8],y=h[9],v=h[10],T=h[11],w=L*L*r+o,A=I*L*r+R*e,E=R*L*r-I*e,M=L*I*r-R*e,b=I*I*r+o,_=R*I*r+L*e,S=L*R*r+I*e,C=I*R*r-L*e,k=R*R*r+o,t[0]=i*w+c*A+m*E,t[1]=u*w+f*A+y*E,t[2]=s*w+g*A+v*E,t[3]=a*w+d*A+T*E,t[4]=i*M+c*b+m*_,t[5]=u*M+f*b+y*_,t[6]=s*M+g*b+v*_,t[7]=a*M+d*b+T*_,t[8]=i*S+c*C+m*k,t[9]=u*S+f*C+y*k,t[10]=s*S+g*C+v*k,t[11]=a*S+d*C+T*k,h!==t&&(t[12]=h[12],t[13]=h[13],t[14]=h[14],t[15]=h[15]),t)}},{}],300:[function(n,z,q){z.exports=function(t,h,p){var l=Math.sin(p),e=Math.cos(p),o=h[4],r=h[5],i=h[6],u=h[7],s=h[8],a=h[9],c=h[10],f=h[11];return h!==t&&(t[0]=h[0],t[1]=h[1],t[2]=h[2],t[3]=h[3],t[12]=h[12],t[13]=h[13],t[14]=h[14],t[15]=h[15]),t[4]=o*e+s*l,t[5]=r*e+a*l,t[6]=i*e+c*l,t[7]=u*e+f*l,t[8]=s*e-o*l,t[9]=a*e-r*l,t[10]=c*e-i*l,t[11]=f*e-u*l,t}},{}],301:[function(n,z,q){z.exports=function(t,h,p){var l=Math.sin(p),e=Math.cos(p),o=h[0],r=h[1],i=h[2],u=h[3],s=h[8],a=h[9],c=h[10],f=h[11];return h!==t&&(t[4]=h[4],t[5]=h[5],t[6]=h[6],t[7]=h[7],t[12]=h[12],t[13]=h[13],t[14]=h[14],t[15]=h[15]),t[0]=o*e-s*l,t[1]=r*e-a*l,t[2]=i*e-c*l,t[3]=u*e-f*l,t[8]=o*l+s*e,t[9]=r*l+a*e,t[10]=i*l+c*e,t[11]=u*l+f*e,t}},{}],302:[function(n,z,q){z.exports=function(t,h,p){var l=Math.sin(p),e=Math.cos(p),o=h[0],r=h[1],i=h[2],u=h[3],s=h[4],a=h[5],c=h[6],f=h[7];return h!==t&&(t[8]=h[8],t[9]=h[9],t[10]=h[10],t[11]=h[11],t[12]=h[12],t[13]=h[13],t[14]=h[14],t[15]=h[15]),t[0]=o*e+s*l,t[1]=r*e+a*l,t[2]=i*e+c*l,t[3]=u*e+f*l,t[4]=s*e-o*l,t[5]=a*e-r*l,t[6]=c*e-i*l,t[7]=f*e-u*l,t}},{}],303:[function(n,z,q){z.exports=function(t,h,p){var l=p[0],e=p[1],o=p[2];return t[0]=h[0]*l,t[1]=h[1]*l,t[2]=h[2]*l,t[3]=h[3]*l,t[4]=h[4]*e,t[5]=h[5]*e,t[6]=h[6]*e,t[7]=h[7]*e,t[8]=h[8]*o,t[9]=h[9]*o,t[10]=h[10]*o,t[11]=h[11]*o,t[12]=h[12],t[13]=h[13],t[14]=h[14],t[15]=h[15],t}},{}],304:[function(n,z,q){z.exports=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}},{}],305:[function(n,z,q){z.exports=function(t,h,p){var l,e,o,r,i,u,s,a,c,f,g,d,m=p[0],y=p[1],v=p[2];return h===t?(t[12]=h[0]*m+h[4]*y+h[8]*v+h[12],t[13]=h[1]*m+h[5]*y+h[9]*v+h[13],t[14]=h[2]*m+h[6]*y+h[10]*v+h[14],t[15]=h[3]*m+h[7]*y+h[11]*v+h[15]):(l=h[0],e=h[1],o=h[2],r=h[3],i=h[4],u=h[5],s=h[6],a=h[7],c=h[8],f=h[9],g=h[10],d=h[11],t[0]=l,t[1]=e,t[2]=o,t[3]=r,t[4]=i,t[5]=u,t[6]=s,t[7]=a,t[8]=c,t[9]=f,t[10]=g,t[11]=d,t[12]=l*m+i*y+c*v+h[12],t[13]=e*m+u*y+f*v+h[13],t[14]=o*m+s*y+g*v+h[14],t[15]=r*m+a*y+d*v+h[15]),t}},{}],306:[function(n,z,q){z.exports=function(t,h){if(t===h){var p=h[1],l=h[2],e=h[3],o=h[6],r=h[7],i=h[11];t[1]=h[4],t[2]=h[8],t[3]=h[12],t[4]=p,t[6]=h[9],t[7]=h[13],t[8]=l,t[9]=o,t[11]=h[14],t[12]=e,t[13]=r,t[14]=i}else t[0]=h[0],t[1]=h[4],t[2]=h[8],t[3]=h[12],t[4]=h[1],t[5]=h[5],t[6]=h[9],t[7]=h[13],t[8]=h[2],t[9]=h[6],t[10]=h[10],t[11]=h[14],t[12]=h[3],t[13]=h[7],t[14]=h[11],t[15]=h[15];return t}},{}],307:[function(n,z,q){"use strict";var t=n("barycentric"),h=n("polytope-closest-point/lib/closest_point_2d.js");function p(o,r){for(var i=[0,0,0,0],u=0;u<4;++u)for(var s=0;s<4;++s)i[s]+=o[4*u+s]*r[u];return i}function l(o,r,i,u,s){for(var a=p(u,p(i,p(r,[o[0],o[1],o[2],1]))),c=0;c<3;++c)a[c]/=a[3];return[.5*s[0]*(1+a[0]),.5*s[1]*(1-a[1])]}function e(o,r){for(var i=[0,0,0],u=0;u<o.length;++u)for(var s=o[u],a=r[u],c=0;c<3;++c)i[c]+=a*s[c];return i}z.exports=function(o,r,i,u,s,a){if(o.length===1)return[0,o[0].slice()];for(var c=new Array(o.length),f=0;f<o.length;++f)c[f]=l(o[f],i,u,s,a);var g=0,d=1/0;for(f=0;f<c.length;++f){for(var m=0,y=0;y<2;++y)m+=Math.pow(c[f][y]-r[y],2);m<d&&(d=m,g=f)}var v=function(w,A){if(w.length===2){for(var E=0,M=0,b=0;b<2;++b)E+=Math.pow(A[b]-w[0][b],2),M+=Math.pow(A[b]-w[1][b],2);return E=Math.sqrt(E),M=Math.sqrt(M),E+M<1e-6?[1,0]:[M/(E+M),E/(M+E)]}if(w.length===3){var _=[0,0];return h(w[0],w[1],w[2],A,_),t(w,_)}return[]}(c,r),T=0;for(f=0;f<3;++f){if(v[f]<-.001||v[f]>1.0001)return null;T+=v[f]}return Math.abs(T-1)>.001?null:[g,e(o,v),v]}},{barycentric:78,"polytope-closest-point/lib/closest_point_2d.js":525}],308:[function(n,z,q){var t=n("glslify"),h=t([`precision highp float;
#define GLSLIFY 1

attribute vec3 position, normal;
attribute vec4 color;
attribute vec2 uv;

uniform mat4 model
           , view
           , projection
           , inverseModel;
uniform vec3 eyePosition
           , lightPosition;

varying vec3 f_normal
           , f_lightDirection
           , f_eyeDirection
           , f_data;
varying vec4 f_color;
varying vec2 f_uv;

vec4 project(vec3 p) {
  return projection * view * model * vec4(p, 1.0);
}

void main() {
  gl_Position      = project(position);

  //Lighting geometry parameters
  vec4 cameraCoordinate = view * vec4(position , 1.0);
  cameraCoordinate.xyz /= cameraCoordinate.w;
  f_lightDirection = lightPosition - cameraCoordinate.xyz;
  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;
  f_normal  = normalize((vec4(normal, 0.0) * inverseModel).xyz);

  f_color          = color;
  f_data           = position;
  f_uv             = uv;
}
`]),p=t([`#extension GL_OES_standard_derivatives : enable

precision highp float;
#define GLSLIFY 1

float beckmannDistribution(float x, float roughness) {
  float NdotH = max(x, 0.0001);
  float cos2Alpha = NdotH * NdotH;
  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;
  float roughness2 = roughness * roughness;
  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;
  return exp(tan2Alpha / roughness2) / denom;
}

float cookTorranceSpecular(
  vec3 lightDirection,
  vec3 viewDirection,
  vec3 surfaceNormal,
  float roughness,
  float fresnel) {

  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);
  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);

  //Half angle vector
  vec3 H = normalize(lightDirection + viewDirection);

  //Geometric term
  float NdotH = max(dot(surfaceNormal, H), 0.0);
  float VdotH = max(dot(viewDirection, H), 0.000001);
  float LdotH = max(dot(lightDirection, H), 0.000001);
  float G1 = (2.0 * NdotH * VdotN) / VdotH;
  float G2 = (2.0 * NdotH * LdotN) / LdotH;
  float G = min(1.0, min(G1, G2));
  
  //Distribution term
  float D = beckmannDistribution(NdotH, roughness);

  //Fresnel term
  float F = pow(1.0 - VdotN, fresnel);

  //Multiply terms and done
  return  G * F * D / max(3.14159265 * VdotN, 0.000001);
}

//#pragma glslify: beckmann = require(glsl-specular-beckmann) // used in gl-surface3d

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform float roughness
            , fresnel
            , kambient
            , kdiffuse
            , kspecular;
uniform sampler2D texture;

varying vec3 f_normal
           , f_lightDirection
           , f_eyeDirection
           , f_data;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  if (f_color.a == 0.0 ||
    outOfRange(clipBounds[0], clipBounds[1], f_data)
  ) discard;

  vec3 N = normalize(f_normal);
  vec3 L = normalize(f_lightDirection);
  vec3 V = normalize(f_eyeDirection);

  if(gl_FrontFacing) {
    N = -N;
  }

  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));
  //float specular = max(0.0, beckmann(L, V, N, roughness)); // used in gl-surface3d

  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);

  vec4 surfaceColor = vec4(f_color.rgb, 1.0) * texture2D(texture, f_uv);
  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);

  gl_FragColor = litColor * f_color.a;
}
`]),l=t([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;
attribute vec4 color;
attribute vec2 uv;

uniform mat4 model, view, projection;

varying vec4 f_color;
varying vec3 f_data;
varying vec2 f_uv;

void main() {
  gl_Position = projection * view * model * vec4(position, 1.0);
  f_color = color;
  f_data  = position;
  f_uv    = uv;
}`]),e=t([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform sampler2D texture;
uniform float opacity;

varying vec4 f_color;
varying vec3 f_data;
varying vec2 f_uv;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_data)) discard;

  gl_FragColor = f_color * texture2D(texture, f_uv) * opacity;
}`]),o=t([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3 position;
attribute vec4 color;
attribute vec2 uv;
attribute float pointSize;

uniform mat4 model, view, projection;
uniform vec3 clipBounds[2];

varying vec4 f_color;
varying vec2 f_uv;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0.0, 0.0 ,0.0 ,0.0);
  } else {
    gl_Position = projection * view * model * vec4(position, 1.0);
  }
  gl_PointSize = pointSize;
  f_color = color;
  f_uv = uv;
}`]),r=t([`precision highp float;
#define GLSLIFY 1

uniform sampler2D texture;
uniform float opacity;

varying vec4 f_color;
varying vec2 f_uv;

void main() {
  vec2 pointR = gl_PointCoord.xy - vec2(0.5, 0.5);
  if(dot(pointR, pointR) > 0.25) {
    discard;
  }
  gl_FragColor = f_color * texture2D(texture, f_uv) * opacity;
}`]),i=t([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;
attribute vec4 id;

uniform mat4 model, view, projection;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  gl_Position = projection * view * model * vec4(position, 1.0);
  f_id        = id;
  f_position  = position;
}`]),u=t([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3  clipBounds[2];
uniform float pickId;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;

  gl_FragColor = vec4(pickId, f_id.xyz);
}`]),s=t([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3  position;
attribute float pointSize;
attribute vec4  id;

uniform mat4 model, view, projection;
uniform vec3 clipBounds[2];

varying vec3 f_position;
varying vec4 f_id;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0.0, 0.0, 0.0, 0.0);
  } else {
    gl_Position  = projection * view * model * vec4(position, 1.0);
    gl_PointSize = pointSize;
  }
  f_id         = id;
  f_position   = position;
}`]),a=t([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;

uniform mat4 model, view, projection;

void main() {
  gl_Position = projection * view * model * vec4(position, 1.0);
}`]),c=t([`precision highp float;
#define GLSLIFY 1

uniform vec3 contourColor;

void main() {
  gl_FragColor = vec4(contourColor, 1.0);
}
`]);q.meshShader={vertex:h,fragment:p,attributes:[{name:"position",type:"vec3"},{name:"normal",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"}]},q.wireShader={vertex:l,fragment:e,attributes:[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"}]},q.pointShader={vertex:o,fragment:r,attributes:[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"pointSize",type:"float"}]},q.pickShader={vertex:i,fragment:u,attributes:[{name:"position",type:"vec3"},{name:"id",type:"vec4"}]},q.pointPickShader={vertex:s,fragment:u,attributes:[{name:"position",type:"vec3"},{name:"pointSize",type:"float"},{name:"id",type:"vec4"}]},q.contourShader={vertex:a,fragment:c,attributes:[{name:"position",type:"vec3"}]}},{glslify:310}],309:[function(n,z,q){"use strict";var t=n("gl-shader"),h=n("gl-buffer"),p=n("gl-vao"),l=n("gl-texture2d"),e=n("normals"),o=n("gl-mat4/multiply"),r=n("gl-mat4/invert"),i=n("ndarray"),u=n("colormap"),s=n("simplicial-complex-contour"),a=n("typedarray-pool"),c=n("./lib/shaders"),f=n("./lib/closest-point"),g=c.meshShader,d=c.wireShader,m=c.pointShader,y=c.pickShader,v=c.pointPickShader,T=c.contourShader,w=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function A(I,R,V,O,J,D,B,N,F,H,j,G,W,Q,$,ee,ie,ae,oe,de,le,fe,ue,we,Ae,Se,ke){this.gl=I,this.pixelRatio=1,this.cells=[],this.positions=[],this.intensity=[],this.texture=R,this.dirty=!0,this.triShader=V,this.lineShader=O,this.pointShader=J,this.pickShader=D,this.pointPickShader=B,this.contourShader=N,this.trianglePositions=F,this.triangleColors=j,this.triangleNormals=W,this.triangleUVs=G,this.triangleIds=H,this.triangleVAO=Q,this.triangleCount=0,this.lineWidth=1,this.edgePositions=$,this.edgeColors=ie,this.edgeUVs=ae,this.edgeIds=ee,this.edgeVAO=oe,this.edgeCount=0,this.pointPositions=de,this.pointColors=fe,this.pointUVs=ue,this.pointSizes=we,this.pointIds=le,this.pointVAO=Ae,this.pointCount=0,this.contourLineWidth=1,this.contourPositions=Se,this.contourVAO=ke,this.contourCount=0,this.contourColor=[0,0,0],this.contourEnable=!0,this.pickVertex=!0,this.pickId=1,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.lightPosition=[1e5,1e5,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.opacity=1,this.hasAlpha=!1,this.opacityscale=!1,this._model=w,this._view=w,this._projection=w,this._resolution=[1,1]}var E=A.prototype;function M(I,R){if(!R||!R.length)return 1;for(var V=0;V<R.length;++V){if(R.length<2)return 1;if(R[V][0]===I)return R[V][1];if(R[V][0]>I&&V>0){var O=(R[V][0]-I)/(R[V][0]-R[V-1][0]);return R[V][1]*(1-O)+O*R[V-1][1]}}return 1}function b(I){var R=t(I,g.vertex,g.fragment);return R.attributes.position.location=0,R.attributes.color.location=2,R.attributes.uv.location=3,R.attributes.normal.location=4,R}function _(I){var R=t(I,d.vertex,d.fragment);return R.attributes.position.location=0,R.attributes.color.location=2,R.attributes.uv.location=3,R}function S(I){var R=t(I,m.vertex,m.fragment);return R.attributes.position.location=0,R.attributes.color.location=2,R.attributes.uv.location=3,R.attributes.pointSize.location=4,R}function C(I){var R=t(I,y.vertex,y.fragment);return R.attributes.position.location=0,R.attributes.id.location=1,R}function k(I){var R=t(I,v.vertex,v.fragment);return R.attributes.position.location=0,R.attributes.id.location=1,R.attributes.pointSize.location=4,R}function L(I){var R=t(I,T.vertex,T.fragment);return R.attributes.position.location=0,R}E.isOpaque=function(){return!this.hasAlpha},E.isTransparent=function(){return this.hasAlpha},E.pickSlots=1,E.setPickBase=function(I){this.pickId=I},E.highlight=function(I){if(I&&this.contourEnable){for(var R=s(this.cells,this.intensity,I.intensity),V=R.cells,O=R.vertexIds,J=R.vertexWeights,D=V.length,B=a.mallocFloat32(6*D),N=0,F=0;F<D;++F)for(var H=V[F],j=0;j<2;++j){var G=H[0];H.length===2&&(G=H[j]);for(var W=O[G][0],Q=O[G][1],$=J[G],ee=1-$,ie=this.positions[W],ae=this.positions[Q],oe=0;oe<3;++oe)B[N++]=$*ie[oe]+ee*ae[oe]}this.contourCount=N/3|0,this.contourPositions.update(B.subarray(0,N)),a.free(B)}else this.contourCount=0},E.update=function(I){I=I||{};var R=this.gl;this.dirty=!0,"contourEnable"in I&&(this.contourEnable=I.contourEnable),"contourColor"in I&&(this.contourColor=I.contourColor),"lineWidth"in I&&(this.lineWidth=I.lineWidth),"lightPosition"in I&&(this.lightPosition=I.lightPosition),this.hasAlpha=!1,"opacity"in I&&(this.opacity=I.opacity,this.opacity<1&&(this.hasAlpha=!0)),"opacityscale"in I&&(this.opacityscale=I.opacityscale,this.hasAlpha=!0),"ambient"in I&&(this.ambientLight=I.ambient),"diffuse"in I&&(this.diffuseLight=I.diffuse),"specular"in I&&(this.specularLight=I.specular),"roughness"in I&&(this.roughness=I.roughness),"fresnel"in I&&(this.fresnel=I.fresnel),I.texture?(this.texture.dispose(),this.texture=l(R,I.texture)):I.colormap&&(this.texture.shape=[256,256],this.texture.minFilter=R.LINEAR_MIPMAP_LINEAR,this.texture.magFilter=R.LINEAR,this.texture.setPixels(function(be,We){for(var Ge=u({colormap:be,nshades:256,format:"rgba"}),st=new Uint8Array(1024),ot=0;ot<256;++ot){for(var Ce=Ge[ot],Ue=0;Ue<3;++Ue)st[4*ot+Ue]=Ce[Ue];st[4*ot+3]=We?255*M(ot/255,We):255*Ce[3]}return i(st,[256,256,4],[4,0,1])}(I.colormap,this.opacityscale)),this.texture.generateMipmap());var V=I.cells,O=I.positions;if(O&&V){var J=[],D=[],B=[],N=[],F=[],H=[],j=[],G=[],W=[],Q=[],$=[],ee=[],ie=[],ae=[];this.cells=V,this.positions=O;var oe=I.vertexNormals,de=I.cellNormals,le=I.vertexNormalsEpsilon===void 0?1e-6:I.vertexNormalsEpsilon,fe=I.faceNormalsEpsilon===void 0?1e-6:I.faceNormalsEpsilon;I.useFacetNormals&&!de&&(de=e.faceNormals(V,O,fe)),de||oe||(oe=e.vertexNormals(V,O,le));var ue=I.vertexColors,we=I.cellColors,Ae=I.meshColor||[1,1,1,1],Se=I.vertexUVs,ke=I.vertexIntensity,Me=I.cellUVs,ve=I.cellIntensity,ge=1/0,De=-1/0;if(!Se&&!Me)if(ke)if(I.vertexIntensityBounds)ge=+I.vertexIntensityBounds[0],De=+I.vertexIntensityBounds[1];else for(var _e=0;_e<ke.length;++_e){var Pe=ke[_e];ge=Math.min(ge,Pe),De=Math.max(De,Pe)}else if(ve)if(I.cellIntensityBounds)ge=+I.cellIntensityBounds[0],De=+I.cellIntensityBounds[1];else for(_e=0;_e<ve.length;++_e)Pe=ve[_e],ge=Math.min(ge,Pe),De=Math.max(De,Pe);else for(_e=0;_e<O.length;++_e)Pe=O[_e][2],ge=Math.min(ge,Pe),De=Math.max(De,Pe);this.intensity=ke||ve||function(be){for(var We=be.length,Ge=new Array(We),st=0;st<We;++st)Ge[st]=be[st][2];return Ge}(O),this.pickVertex=!(ve||we);var Fe=I.pointSizes,ze=I.pointSize||1;for(this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],_e=0;_e<O.length;++_e)for(var He=O[_e],et=0;et<3;++et)!isNaN(He[et])&&isFinite(He[et])&&(this.bounds[0][et]=Math.min(this.bounds[0][et],He[et]),this.bounds[1][et]=Math.max(this.bounds[1][et],He[et]));var Re=0,Ze=0,Ke=0;e:for(_e=0;_e<V.length;++_e){var $e=V[_e];switch($e.length){case 1:for(He=O[at=$e[0]],et=0;et<3;++et)if(isNaN(He[et])||!isFinite(He[et]))continue e;Q.push(He[0],He[1],He[2]),lt=ue?ue[at]:we?we[_e]:Ae,this.opacityscale&&ke?D.push(lt[0],lt[1],lt[2],this.opacity*M((ke[at]-ge)/(De-ge),this.opacityscale)):lt.length===3?$.push(lt[0],lt[1],lt[2],this.opacity):($.push(lt[0],lt[1],lt[2],lt[3]*this.opacity),lt[3]<1&&(this.hasAlpha=!0)),gt=Se?Se[at]:ke?[(ke[at]-ge)/(De-ge),0]:Me?Me[_e]:ve?[(ve[_e]-ge)/(De-ge),0]:[(He[2]-ge)/(De-ge),0],ee.push(gt[0],gt[1]),Fe?ie.push(Fe[at]):ie.push(ze),ae.push(_e),Ke+=1;break;case 2:for(et=0;et<2;++et){He=O[at=$e[et]];for(var rt=0;rt<3;++rt)if(isNaN(He[rt])||!isFinite(He[rt]))continue e}for(et=0;et<2;++et)He=O[at=$e[et]],H.push(He[0],He[1],He[2]),lt=ue?ue[at]:we?we[_e]:Ae,this.opacityscale&&ke?D.push(lt[0],lt[1],lt[2],this.opacity*M((ke[at]-ge)/(De-ge),this.opacityscale)):lt.length===3?j.push(lt[0],lt[1],lt[2],this.opacity):(j.push(lt[0],lt[1],lt[2],lt[3]*this.opacity),lt[3]<1&&(this.hasAlpha=!0)),gt=Se?Se[at]:ke?[(ke[at]-ge)/(De-ge),0]:Me?Me[_e]:ve?[(ve[_e]-ge)/(De-ge),0]:[(He[2]-ge)/(De-ge),0],G.push(gt[0],gt[1]),W.push(_e);Ze+=1;break;case 3:for(et=0;et<3;++et)for(He=O[at=$e[et]],rt=0;rt<3;++rt)if(isNaN(He[rt])||!isFinite(He[rt]))continue e;for(et=0;et<3;++et){var at,lt,gt,Ie;He=O[at=$e[2-et]],J.push(He[0],He[1],He[2]),(lt=ue?ue[at]:we?we[_e]:Ae)?this.opacityscale&&ke?D.push(lt[0],lt[1],lt[2],this.opacity*M((ke[at]-ge)/(De-ge),this.opacityscale)):lt.length===3?D.push(lt[0],lt[1],lt[2],this.opacity):(D.push(lt[0],lt[1],lt[2],lt[3]*this.opacity),lt[3]<1&&(this.hasAlpha=!0)):D.push(.5,.5,.5,1),gt=Se?Se[at]:ke?[(ke[at]-ge)/(De-ge),0]:Me?Me[_e]:ve?[(ve[_e]-ge)/(De-ge),0]:[(He[2]-ge)/(De-ge),0],N.push(gt[0],gt[1]),Ie=oe?oe[at]:de[_e],B.push(Ie[0],Ie[1],Ie[2]),F.push(_e)}Re+=1}}this.pointCount=Ke,this.edgeCount=Ze,this.triangleCount=Re,this.pointPositions.update(Q),this.pointColors.update($),this.pointUVs.update(ee),this.pointSizes.update(ie),this.pointIds.update(new Uint32Array(ae)),this.edgePositions.update(H),this.edgeColors.update(j),this.edgeUVs.update(G),this.edgeIds.update(new Uint32Array(W)),this.trianglePositions.update(J),this.triangleColors.update(D),this.triangleUVs.update(N),this.triangleNormals.update(B),this.triangleIds.update(new Uint32Array(F))}},E.drawTransparent=E.draw=function(I){I=I||{};for(var R=this.gl,V=I.model||w,O=I.view||w,J=I.projection||w,D=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],B=0;B<3;++B)D[0][B]=Math.max(D[0][B],this.clipBounds[0][B]),D[1][B]=Math.min(D[1][B],this.clipBounds[1][B]);var N={model:V,view:O,projection:J,inverseModel:w.slice(),clipBounds:D,kambient:this.ambientLight,kdiffuse:this.diffuseLight,kspecular:this.specularLight,roughness:this.roughness,fresnel:this.fresnel,eyePosition:[0,0,0],lightPosition:[0,0,0],contourColor:this.contourColor,texture:0};N.inverseModel=r(N.inverseModel,N.model),R.disable(R.CULL_FACE),this.texture.bind(0);var F=new Array(16);for(o(F,N.view,N.model),o(F,N.projection,F),r(F,F),B=0;B<3;++B)N.eyePosition[B]=F[12+B]/F[15];var H,j=F[15];for(B=0;B<3;++B)j+=this.lightPosition[B]*F[4*B+3];for(B=0;B<3;++B){for(var G=F[12+B],W=0;W<3;++W)G+=F[4*W+B]*this.lightPosition[W];N.lightPosition[B]=G/j}this.triangleCount>0&&((H=this.triShader).bind(),H.uniforms=N,this.triangleVAO.bind(),R.drawArrays(R.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind()),this.edgeCount>0&&this.lineWidth>0&&((H=this.lineShader).bind(),H.uniforms=N,this.edgeVAO.bind(),R.lineWidth(this.lineWidth*this.pixelRatio),R.drawArrays(R.LINES,0,2*this.edgeCount),this.edgeVAO.unbind()),this.pointCount>0&&((H=this.pointShader).bind(),H.uniforms=N,this.pointVAO.bind(),R.drawArrays(R.POINTS,0,this.pointCount),this.pointVAO.unbind()),this.contourEnable&&this.contourCount>0&&this.contourLineWidth>0&&((H=this.contourShader).bind(),H.uniforms=N,this.contourVAO.bind(),R.drawArrays(R.LINES,0,this.contourCount),this.contourVAO.unbind())},E.drawPick=function(I){I=I||{};for(var R=this.gl,V=I.model||w,O=I.view||w,J=I.projection||w,D=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],B=0;B<3;++B)D[0][B]=Math.max(D[0][B],this.clipBounds[0][B]),D[1][B]=Math.min(D[1][B],this.clipBounds[1][B]);this._model=[].slice.call(V),this._view=[].slice.call(O),this._projection=[].slice.call(J),this._resolution=[R.drawingBufferWidth,R.drawingBufferHeight];var N,F={model:V,view:O,projection:J,clipBounds:D,pickId:this.pickId/255};(N=this.pickShader).bind(),N.uniforms=F,this.triangleCount>0&&(this.triangleVAO.bind(),R.drawArrays(R.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind()),this.edgeCount>0&&(this.edgeVAO.bind(),R.lineWidth(this.lineWidth*this.pixelRatio),R.drawArrays(R.LINES,0,2*this.edgeCount),this.edgeVAO.unbind()),this.pointCount>0&&((N=this.pointPickShader).bind(),N.uniforms=F,this.pointVAO.bind(),R.drawArrays(R.POINTS,0,this.pointCount),this.pointVAO.unbind())},E.pick=function(I){if(!I||I.id!==this.pickId)return null;for(var R=I.value[0]+256*I.value[1]+65536*I.value[2],V=this.cells[R],O=this.positions,J=new Array(V.length),D=0;D<V.length;++D)J[D]=O[V[D]];var B=I.coord[0],N=I.coord[1];if(!this.pickVertex){var F=this.positions[V[0]],H=this.positions[V[1]],j=this.positions[V[2]],G=[(F[0]+H[0]+j[0])/3,(F[1]+H[1]+j[1])/3,(F[2]+H[2]+j[2])/3];return{_cellCenter:!0,position:[B,N],index:R,cell:V,cellId:R,intensity:this.intensity[R],dataCoordinate:G}}var W=f(J,[B*this.pixelRatio,this._resolution[1]-N*this.pixelRatio],this._model,this._view,this._projection,this._resolution);if(!W)return null;var Q=W[2],$=0;for(D=0;D<V.length;++D)$+=Q[D]*this.intensity[V[D]];return{position:W[1],index:V[W[0]],cell:V,cellId:R,intensity:$,dataCoordinate:this.positions[V[W[0]]]}},E.dispose=function(){this.texture.dispose(),this.triShader.dispose(),this.lineShader.dispose(),this.pointShader.dispose(),this.pickShader.dispose(),this.pointPickShader.dispose(),this.triangleVAO.dispose(),this.trianglePositions.dispose(),this.triangleColors.dispose(),this.triangleUVs.dispose(),this.triangleNormals.dispose(),this.triangleIds.dispose(),this.edgeVAO.dispose(),this.edgePositions.dispose(),this.edgeColors.dispose(),this.edgeUVs.dispose(),this.edgeIds.dispose(),this.pointVAO.dispose(),this.pointPositions.dispose(),this.pointColors.dispose(),this.pointUVs.dispose(),this.pointSizes.dispose(),this.pointIds.dispose(),this.contourVAO.dispose(),this.contourPositions.dispose(),this.contourShader.dispose()},z.exports=function(I,R){arguments.length===1&&(I=(R=I).gl);var V=I.getExtension("OES_standard_derivatives")||I.getExtension("MOZ_OES_standard_derivatives")||I.getExtension("WEBKIT_OES_standard_derivatives");if(!V)throw new Error("derivatives not supported");var O=b(I),J=_(I),D=S(I),B=C(I),N=k(I),F=L(I),H=l(I,i(new Uint8Array([255,255,255,255]),[1,1,4]));H.generateMipmap(),H.minFilter=I.LINEAR_MIPMAP_LINEAR,H.magFilter=I.LINEAR;var j=h(I),G=h(I),W=h(I),Q=h(I),$=h(I),ee=p(I,[{buffer:j,type:I.FLOAT,size:3},{buffer:$,type:I.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:G,type:I.FLOAT,size:4},{buffer:W,type:I.FLOAT,size:2},{buffer:Q,type:I.FLOAT,size:3}]),ie=h(I),ae=h(I),oe=h(I),de=h(I),le=p(I,[{buffer:ie,type:I.FLOAT,size:3},{buffer:de,type:I.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:ae,type:I.FLOAT,size:4},{buffer:oe,type:I.FLOAT,size:2}]),fe=h(I),ue=h(I),we=h(I),Ae=h(I),Se=h(I),ke=p(I,[{buffer:fe,type:I.FLOAT,size:3},{buffer:Se,type:I.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:ue,type:I.FLOAT,size:4},{buffer:we,type:I.FLOAT,size:2},{buffer:Ae,type:I.FLOAT,size:1}]),Me=h(I),ve=p(I,[{buffer:Me,type:I.FLOAT,size:3}]),ge=new A(I,H,O,J,D,B,N,F,j,$,G,W,Q,ee,ie,de,ae,oe,le,fe,Se,ue,we,Ae,ke,Me,ve);return ge.update(R),ge}},{"./lib/closest-point":307,"./lib/shaders":308,colormap:131,"gl-buffer":259,"gl-mat4/invert":293,"gl-mat4/multiply":295,"gl-shader":335,"gl-texture2d":353,"gl-vao":358,ndarray:495,normals:498,"simplicial-complex-contour":556,"typedarray-pool":595}],310:[function(n,z,q){arguments[4][257][0].apply(q,arguments)},{dup:257}],311:[function(n,z,q){"use strict";z.exports=function(i){var u=i.gl,s=t(u,[0,0,0,1,1,0,1,1]),a=h(u,p.boxVert,p.lineFrag);return new l(i,s,a)};var t=n("gl-buffer"),h=n("gl-shader"),p=n("./shaders");function l(i,u,s){this.plot=i,this.vbo=u,this.shader=s}var e,o,r=l.prototype;r.bind=function(){var i=this.shader;this.vbo.bind(),this.shader.bind(),i.attributes.coord.pointer(),i.uniforms.screenBox=this.plot.screenBox},r.drawBox=(e=[0,0],o=[0,0],function(i,u,s,a,c){var f=this.plot,g=this.shader,d=f.gl;e[0]=i,e[1]=u,o[0]=s,o[1]=a,g.uniforms.lo=e,g.uniforms.hi=o,g.uniforms.color=c,d.drawArrays(d.TRIANGLE_STRIP,0,4)}),r.dispose=function(){this.vbo.dispose(),this.shader.dispose()}},{"./shaders":314,"gl-buffer":259,"gl-shader":335}],312:[function(n,z,q){"use strict";z.exports=function(f){var g=f.gl,d=t(g),m=h(g,l.gridVert,l.gridFrag),y=h(g,l.tickVert,l.gridFrag);return new e(f,d,m,y)};var t=n("gl-buffer"),h=n("gl-shader"),p=n("binary-search-bounds"),l=n("./shaders");function e(f,g,d,m){this.plot=f,this.vbo=g,this.shader=d,this.tickShader=m,this.ticks=[[],[]]}function o(f,g){return f-g}var r,i,u,s,a,c=e.prototype;c.draw=(r=[0,0],i=[0,0],u=[0,0],function(){for(var f=this.plot,g=this.vbo,d=this.shader,m=this.ticks,y=f.gl,v=f._tickBounds,T=f.dataBox,w=f.viewBox,A=f.gridLineWidth,E=f.gridLineColor,M=f.gridLineEnable,b=f.pixelRatio,_=0;_<2;++_){var S=v[_],C=v[_+2]-S,k=.5*(T[_+2]+T[_]),L=T[_+2]-T[_];i[_]=2*C/L,r[_]=2*(S-k)/L}d.bind(),g.bind(),d.attributes.dataCoord.pointer(),d.uniforms.dataShift=r,d.uniforms.dataScale=i;var I=0;for(_=0;_<2;++_){u[0]=u[1]=0,u[_]=1,d.uniforms.dataAxis=u,d.uniforms.lineWidth=A[_]/(w[_+2]-w[_])*b,d.uniforms.color=E[_];var R=6*m[_].length;M[_]&&R&&y.drawArrays(y.TRIANGLES,I,R),I+=R}}),c.drawTickMarks=function(){var f=[0,0],g=[0,0],d=[1,0],m=[0,1],y=[0,0],v=[0,0];return function(){for(var T=this.plot,w=this.vbo,A=this.tickShader,E=this.ticks,M=T.gl,b=T._tickBounds,_=T.dataBox,S=T.viewBox,C=T.pixelRatio,k=T.screenBox,L=k[2]-k[0],I=k[3]-k[1],R=S[2]-S[0],V=S[3]-S[1],O=0;O<2;++O){var J=b[O],D=b[O+2]-J,B=.5*(_[O+2]+_[O]),N=_[O+2]-_[O];g[O]=2*D/N,f[O]=2*(J-B)/N}g[0]*=R/L,f[0]*=R/L,g[1]*=V/I,f[1]*=V/I,A.bind(),w.bind(),A.attributes.dataCoord.pointer();var F=A.uniforms;F.dataShift=f,F.dataScale=g;var H=T.tickMarkLength,j=T.tickMarkWidth,G=T.tickMarkColor,W=6*E[0].length,Q=Math.min(p.ge(E[0],(_[0]-b[0])/(b[2]-b[0]),o),E[0].length),$=Math.min(p.gt(E[0],(_[2]-b[0])/(b[2]-b[0]),o),E[0].length),ee=0+6*Q,ie=6*Math.max(0,$-Q),ae=Math.min(p.ge(E[1],(_[1]-b[1])/(b[3]-b[1]),o),E[1].length),oe=Math.min(p.gt(E[1],(_[3]-b[1])/(b[3]-b[1]),o),E[1].length),de=W+6*ae,le=6*Math.max(0,oe-ae);y[0]=2*(S[0]-H[1])/L-1,y[1]=(S[3]+S[1])/I-1,v[0]=H[1]*C/L,v[1]=j[1]*C/I,le&&(F.color=G[1],F.tickScale=v,F.dataAxis=m,F.screenOffset=y,M.drawArrays(M.TRIANGLES,de,le)),y[0]=(S[2]+S[0])/L-1,y[1]=2*(S[1]-H[0])/I-1,v[0]=j[0]*C/L,v[1]=H[0]*C/I,ie&&(F.color=G[0],F.tickScale=v,F.dataAxis=d,F.screenOffset=y,M.drawArrays(M.TRIANGLES,ee,ie)),y[0]=2*(S[2]+H[3])/L-1,y[1]=(S[3]+S[1])/I-1,v[0]=H[3]*C/L,v[1]=j[3]*C/I,le&&(F.color=G[3],F.tickScale=v,F.dataAxis=m,F.screenOffset=y,M.drawArrays(M.TRIANGLES,de,le)),y[0]=(S[2]+S[0])/L-1,y[1]=2*(S[3]+H[2])/I-1,v[0]=j[2]*C/L,v[1]=H[2]*C/I,ie&&(F.color=G[2],F.tickScale=v,F.dataAxis=d,F.screenOffset=y,M.drawArrays(M.TRIANGLES,ee,ie))}}(),c.update=(s=[1,1,-1,-1,1,-1],a=[1,-1,1,1,-1,-1],function(f){for(var g=f.ticks,d=f.bounds,m=new Float32Array(18*(g[0].length+g[1].length)),y=(this.plot.zeroLineEnable,0),v=[[],[]],T=0;T<2;++T)for(var w=v[T],A=g[T],E=d[T],M=d[T+2],b=0;b<A.length;++b){var _=(A[b].x-E)/(M-E);w.push(_);for(var S=0;S<6;++S)m[y++]=_,m[y++]=s[S],m[y++]=a[S]}this.ticks=v,this.vbo.update(m)}),c.dispose=function(){this.vbo.dispose(),this.shader.dispose(),this.tickShader.dispose()}},{"./shaders":314,"binary-search-bounds":96,"gl-buffer":259,"gl-shader":335}],313:[function(n,z,q){"use strict";z.exports=function(i){var u=i.gl,s=t(u,[-1,-1,-1,1,1,-1,1,1]),a=h(u,p.lineVert,p.lineFrag);return new l(i,s,a)};var t=n("gl-buffer"),h=n("gl-shader"),p=n("./shaders");function l(i,u,s){this.plot=i,this.vbo=u,this.shader=s}var e,o,r=l.prototype;r.bind=function(){var i=this.shader;this.vbo.bind(),this.shader.bind(),i.attributes.coord.pointer(),i.uniforms.screenBox=this.plot.screenBox},r.drawLine=(e=[0,0],o=[0,0],function(i,u,s,a,c,f){var g=this.plot,d=this.shader,m=g.gl;e[0]=i,e[1]=u,o[0]=s,o[1]=a,d.uniforms.start=e,d.uniforms.end=o,d.uniforms.width=c*g.pixelRatio,d.uniforms.color=f,m.drawArrays(m.TRIANGLE_STRIP,0,4)}),r.dispose=function(){this.vbo.dispose(),this.shader.dispose()}},{"./shaders":314,"gl-buffer":259,"gl-shader":335}],314:[function(n,z,q){"use strict";var t=n("glslify"),h=t([`precision lowp float;
#define GLSLIFY 1
uniform vec4 color;
void main() {
  gl_FragColor = vec4(color.xyz * color.w, color.w);
}
`]);z.exports={lineVert:t([`precision mediump float;
#define GLSLIFY 1

attribute vec2 coord;

uniform vec4 screenBox;
uniform vec2 start, end;
uniform float width;

vec2 perp(vec2 v) {
  return vec2(v.y, -v.x);
}

vec2 screen(vec2 v) {
  return 2.0 * (v - screenBox.xy) / (screenBox.zw - screenBox.xy) - 1.0;
}

void main() {
  vec2 delta = normalize(perp(start - end));
  vec2 offset = mix(start, end, 0.5 * (coord.y+1.0));
  gl_Position = vec4(screen(offset + 0.5 * width * delta * coord.x), 0, 1);
}
`]),lineFrag:h,textVert:t([`#define GLSLIFY 1
attribute vec3 textCoordinate;

uniform vec2 dataScale, dataShift, dataAxis, screenOffset, textScale;
uniform float angle;

void main() {
  float dataOffset  = textCoordinate.z;
  vec2 glyphOffset  = textCoordinate.xy;
  mat2 glyphMatrix = mat2(cos(angle), sin(angle), -sin(angle), cos(angle));
  vec2 screenCoordinate = dataAxis * (dataScale * dataOffset + dataShift) +
    glyphMatrix * glyphOffset * textScale + screenOffset;
  gl_Position = vec4(screenCoordinate, 0, 1);
}
`]),textFrag:h,gridVert:t([`precision mediump float;
#define GLSLIFY 1

attribute vec3 dataCoord;

uniform vec2 dataAxis, dataShift, dataScale;
uniform float lineWidth;

void main() {
  vec2 pos = dataAxis * (dataScale * dataCoord.x + dataShift);
  pos += 10.0 * dataCoord.y * vec2(dataAxis.y, -dataAxis.x) + dataCoord.z * lineWidth;
  gl_Position = vec4(pos, 0, 1);
}
`]),gridFrag:h,boxVert:t([`precision mediump float;
#define GLSLIFY 1

attribute vec2 coord;

uniform vec4 screenBox;
uniform vec2 lo, hi;

vec2 screen(vec2 v) {
  return 2.0 * (v - screenBox.xy) / (screenBox.zw - screenBox.xy) - 1.0;
}

void main() {
  gl_Position = vec4(screen(mix(lo, hi, coord)), 0, 1);
}
`]),tickVert:t([`precision mediump float;
#define GLSLIFY 1

attribute vec3 dataCoord;

uniform vec2 dataAxis, dataShift, dataScale, screenOffset, tickScale;

void main() {
  vec2 pos = dataAxis * (dataScale * dataCoord.x + dataShift);
  gl_Position = vec4(pos + tickScale*dataCoord.yz + screenOffset, 0, 1);
}
`])}},{glslify:316}],315:[function(n,z,q){"use strict";z.exports=function(g){var d=g.gl,m=t(d),y=h(d,e.textVert,e.textFrag);return new o(g,m,y)};var t=n("gl-buffer"),h=n("gl-shader"),p=n("text-cache"),l=n("binary-search-bounds"),e=n("./shaders");function o(g,d,m){this.plot=g,this.vbo=d,this.shader=m,this.tickOffset=[[],[]],this.tickX=[[],[]],this.labelOffset=[0,0],this.labelCount=[0,0]}var r,i,u,s,a,c,f=o.prototype;f.drawTicks=(r=[0,0],i=[0,0],u=[0,0],function(g){var d=this.plot,m=this.shader,y=this.tickX[g],v=this.tickOffset[g],T=d.gl,w=d.viewBox,A=d.dataBox,E=d.screenBox,M=d.pixelRatio,b=d.tickEnable,_=d.tickPad,S=d.tickColor,C=d.tickAngle,k=d.labelEnable,L=d.labelPad,I=d.labelColor,R=d.labelAngle,V=this.labelOffset[g],O=this.labelCount[g],J=l.lt(y,A[g]),D=l.le(y,A[g+2]);r[0]=r[1]=0,r[g]=1,i[g]=(w[2+g]+w[g])/(E[2+g]-E[g])-1;var B=2/E[2+(1^g)]-E[1^g];i[1^g]=B*w[1^g]-1,b[g]&&(i[1^g]-=B*M*_[g],J<D&&v[D]>v[J]&&(m.uniforms.dataAxis=r,m.uniforms.screenOffset=i,m.uniforms.color=S[g],m.uniforms.angle=C[g],T.drawArrays(T.TRIANGLES,v[J],v[D]-v[J]))),k[g]&&O&&(i[1^g]-=B*M*L[g],m.uniforms.dataAxis=u,m.uniforms.screenOffset=i,m.uniforms.color=I[g],m.uniforms.angle=R[g],T.drawArrays(T.TRIANGLES,V,O)),i[1^g]=B*w[2+(1^g)]-1,b[g+2]&&(i[1^g]+=B*M*_[g+2],J<D&&v[D]>v[J]&&(m.uniforms.dataAxis=r,m.uniforms.screenOffset=i,m.uniforms.color=S[g+2],m.uniforms.angle=C[g+2],T.drawArrays(T.TRIANGLES,v[J],v[D]-v[J]))),k[g+2]&&O&&(i[1^g]+=B*M*L[g+2],m.uniforms.dataAxis=u,m.uniforms.screenOffset=i,m.uniforms.color=I[g+2],m.uniforms.angle=R[g+2],T.drawArrays(T.TRIANGLES,V,O))}),f.drawTitle=function(){var g=[0,0],d=[0,0];return function(){var m=this.plot,y=this.shader,v=m.gl,T=m.screenBox,w=m.titleCenter,A=m.titleAngle,E=m.titleColor,M=m.pixelRatio;if(this.titleCount){for(var b=0;b<2;++b)d[b]=2*(w[b]*M-T[b])/(T[2+b]-T[b])-1;y.bind(),y.uniforms.dataAxis=g,y.uniforms.screenOffset=d,y.uniforms.angle=A,y.uniforms.color=E,v.drawArrays(v.TRIANGLES,this.titleOffset,this.titleCount)}}}(),f.bind=(s=[0,0],a=[0,0],c=[0,0],function(){var g=this.plot,d=this.shader,m=g._tickBounds,y=g.dataBox,v=g.screenBox,T=g.viewBox;d.bind();for(var w=0;w<2;++w){var A=m[w],E=m[w+2]-A,M=.5*(y[w+2]+y[w]),b=y[w+2]-y[w],_=T[w],S=T[w+2]-_,C=v[w],k=v[w+2]-C;a[w]=2*E/b*S/k,s[w]=2*(A-M)/b*S/k}c[1]=2*g.pixelRatio/(v[3]-v[1]),c[0]=c[1]*(v[3]-v[1])/(v[2]-v[0]),d.uniforms.dataScale=a,d.uniforms.dataShift=s,d.uniforms.textScale=c,this.vbo.bind(),d.attributes.textCoordinate.pointer()}),f.update=function(g){var d,m,y,v,T,w=[],A=g.ticks,E=g.bounds;for(T=0;T<2;++T){var M=[Math.floor(w.length/3)],b=[-1/0],_=A[T];for(d=0;d<_.length;++d){var S=_[d],C=S.x,k=S.text,L=S.font||"sans-serif";v=S.fontSize||12;for(var I=1/(E[T+2]-E[T]),R=E[T],V=k.split(`
`),O=0;O<V.length;O++)for(y=p(L,V[O]).data,m=0;m<y.length;m+=2)w.push(y[m]*v,-y[m+1]*v-O*v*1.2,(C-R)*I);M.push(Math.floor(w.length/3)),b.push(C)}this.tickOffset[T]=M,this.tickX[T]=b}for(T=0;T<2;++T){for(this.labelOffset[T]=Math.floor(w.length/3),y=p(g.labelFont[T],g.labels[T],{textAlign:"center"}).data,v=g.labelSize[T],d=0;d<y.length;d+=2)w.push(y[d]*v,-y[d+1]*v,0);this.labelCount[T]=Math.floor(w.length/3)-this.labelOffset[T]}for(this.titleOffset=Math.floor(w.length/3),y=p(g.titleFont,g.title).data,v=g.titleSize,d=0;d<y.length;d+=2)w.push(y[d]*v,-y[d+1]*v,0);this.titleCount=Math.floor(w.length/3)-this.titleOffset,this.vbo.update(w)},f.dispose=function(){this.vbo.dispose(),this.shader.dispose()}},{"./shaders":314,"binary-search-bounds":96,"gl-buffer":259,"gl-shader":335,"text-cache":575}],316:[function(n,z,q){arguments[4][257][0].apply(q,arguments)},{dup:257}],317:[function(n,z,q){"use strict";z.exports=function(s){var a=s.gl,c=t(a,[a.drawingBufferWidth,a.drawingBufferHeight]),f=new o(a,c);return f.grid=h(f),f.text=p(f),f.line=l(f),f.box=e(f),f.update(s),f};var t=n("gl-select-static"),h=n("./lib/grid"),p=n("./lib/text"),l=n("./lib/line"),e=n("./lib/box");function o(s,a){this.gl=s,this.pickBuffer=a,this.screenBox=[0,0,s.drawingBufferWidth,s.drawingBufferHeight],this.viewBox=[0,0,0,0],this.dataBox=[-10,-10,10,10],this.gridLineEnable=[!0,!0],this.gridLineWidth=[1,1],this.gridLineColor=[[0,0,0,1],[0,0,0,1]],this.pixelRatio=1,this.tickMarkLength=[0,0,0,0],this.tickMarkWidth=[0,0,0,0],this.tickMarkColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[15,15,15,15],this.tickAngle=[0,0,0,0],this.tickEnable=[!0,!0,!0,!0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[15,15,15,15],this.labelAngle=[0,Math.PI/2,0,3*Math.PI/2],this.labelEnable=[!0,!0,!0,!0],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.titleCenter=[0,0],this.titleEnable=!0,this.titleAngle=0,this.titleColor=[0,0,0,1],this.borderColor=[0,0,0,0],this.backgroundColor=[0,0,0,0],this.zeroLineEnable=[!0,!0],this.zeroLineWidth=[4,4],this.zeroLineColor=[[0,0,0,1],[0,0,0,1]],this.borderLineEnable=[!0,!0,!0,!0],this.borderLineWidth=[2,2,2,2],this.borderLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.grid=null,this.text=null,this.line=null,this.box=null,this.objects=[],this.overlays=[],this._tickBounds=[1/0,1/0,-1/0,-1/0],this.static=!1,this.dirty=!1,this.pickDirty=!1,this.pickDelay=120,this.pickRadius=10,this._pickTimeout=null,this._drawPick=this.drawPick.bind(this),this._depthCounter=0}var r=o.prototype;function i(s){for(var a=s.slice(),c=0;c<a.length;++c)a[c]=a[c].slice();return a}function u(s,a){return s.x-a.x}r.setDirty=function(){this.dirty=this.pickDirty=!0},r.setOverlayDirty=function(){this.dirty=!0},r.nextDepthValue=function(){return this._depthCounter++/65536},r.draw=function(){var s=this.gl,a=this.screenBox,c=this.viewBox,f=this.dataBox,g=this.pixelRatio,d=this.grid,m=this.line,y=this.text,v=this.objects;if(this._depthCounter=0,this.pickDirty&&(this._pickTimeout&&clearTimeout(this._pickTimeout),this.pickDirty=!1,this._pickTimeout=setTimeout(this._drawPick,this.pickDelay)),this.dirty){if(this.dirty=!1,s.bindFramebuffer(s.FRAMEBUFFER,null),s.enable(s.SCISSOR_TEST),s.disable(s.DEPTH_TEST),s.depthFunc(s.LESS),s.depthMask(!1),s.enable(s.BLEND),s.blendEquation(s.FUNC_ADD,s.FUNC_ADD),s.blendFunc(s.ONE,s.ONE_MINUS_SRC_ALPHA),this.borderColor){s.scissor(a[0],a[1],a[2]-a[0],a[3]-a[1]);var T=this.borderColor;s.clearColor(T[0]*T[3],T[1]*T[3],T[2]*T[3],T[3]),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT)}s.scissor(c[0],c[1],c[2]-c[0],c[3]-c[1]),s.viewport(c[0],c[1],c[2]-c[0],c[3]-c[1]);var w=this.backgroundColor;s.clearColor(w[0]*w[3],w[1]*w[3],w[2]*w[3],w[3]),s.clear(s.COLOR_BUFFER_BIT),d.draw();var A=this.zeroLineEnable,E=this.zeroLineColor,M=this.zeroLineWidth;if(A[0]||A[1]){m.bind();for(var b=0;b<2;++b)if(A[b]&&f[b]<=0&&f[b+2]>=0){var _=a[b]-f[b]*(a[b+2]-a[b])/(f[b+2]-f[b]);b===0?m.drawLine(_,a[1],_,a[3],M[b],E[b]):m.drawLine(a[0],_,a[2],_,M[b],E[b])}}for(b=0;b<v.length;++b)v[b].draw();s.viewport(a[0],a[1],a[2]-a[0],a[3]-a[1]),s.scissor(a[0],a[1],a[2]-a[0],a[3]-a[1]),this.grid.drawTickMarks(),m.bind();var S=this.borderLineEnable,C=this.borderLineWidth,k=this.borderLineColor;for(S[1]&&m.drawLine(c[0],c[1]-.5*C[1]*g,c[0],c[3]+.5*C[3]*g,C[1],k[1]),S[0]&&m.drawLine(c[0]-.5*C[0]*g,c[1],c[2]+.5*C[2]*g,c[1],C[0],k[0]),S[3]&&m.drawLine(c[2],c[1]-.5*C[1]*g,c[2],c[3]+.5*C[3]*g,C[3],k[3]),S[2]&&m.drawLine(c[0]-.5*C[0]*g,c[3],c[2]+.5*C[2]*g,c[3],C[2],k[2]),y.bind(),b=0;b<2;++b)y.drawTicks(b);this.titleEnable&&y.drawTitle();var L=this.overlays;for(b=0;b<L.length;++b)L[b].draw();s.disable(s.SCISSOR_TEST),s.disable(s.BLEND),s.depthMask(!0)}},r.drawPick=function(){if(!this.static){var s=this.pickBuffer;this.gl,this._pickTimeout=null,s.begin();for(var a=1,c=this.objects,f=0;f<c.length;++f)a=c[f].drawPick(a);s.end()}},r.pick=function(s,a){if(!this.static){var c=this.pixelRatio,f=this.pickPixelRatio,g=this.viewBox,d=0|Math.round((s-g[0]/c)*f),m=0|Math.round((a-g[1]/c)*f),y=this.pickBuffer.query(d,m,this.pickRadius);if(!y)return null;for(var v=y.id+(y.value[0]<<8)+(y.value[1]<<16)+(y.value[2]<<24),T=this.objects,w=0;w<T.length;++w){var A=T[w].pick(d,m,v);if(A)return A}return null}},r.setScreenBox=function(s){var a=this.screenBox,c=this.pixelRatio;a[0]=0|Math.round(s[0]*c),a[1]=0|Math.round(s[1]*c),a[2]=0|Math.round(s[2]*c),a[3]=0|Math.round(s[3]*c),this.setDirty()},r.setDataBox=function(s){var a=this.dataBox;(a[0]!==s[0]||a[1]!==s[1]||a[2]!==s[2]||a[3]!==s[3])&&(a[0]=s[0],a[1]=s[1],a[2]=s[2],a[3]=s[3],this.setDirty())},r.setViewBox=function(s){var a=this.pixelRatio,c=this.viewBox;c[0]=0|Math.round(s[0]*a),c[1]=0|Math.round(s[1]*a),c[2]=0|Math.round(s[2]*a),c[3]=0|Math.round(s[3]*a);var f=this.pickPixelRatio;this.pickBuffer.shape=[0|Math.round((s[2]-s[0])*f),0|Math.round((s[3]-s[1])*f)],this.setDirty()},r.update=function(s){s=s||{};var a=this.gl;this.pixelRatio=s.pixelRatio||1;var c=this.pixelRatio;this.pickPixelRatio=Math.max(c,1),this.setScreenBox(s.screenBox||[0,0,a.drawingBufferWidth/c,a.drawingBufferHeight/c]),this.screenBox,this.setViewBox(s.viewBox||[.125*(this.screenBox[2]-this.screenBox[0])/c,.125*(this.screenBox[3]-this.screenBox[1])/c,.875*(this.screenBox[2]-this.screenBox[0])/c,.875*(this.screenBox[3]-this.screenBox[1])/c]);var f=this.viewBox,g=(f[2]-f[0])/(f[3]-f[1]);this.setDataBox(s.dataBox||[-10,-10/g,10,10/g]),this.borderColor=s.borderColor!==!1&&(s.borderColor||[0,0,0,0]).slice(),this.backgroundColor=(s.backgroundColor||[0,0,0,0]).slice(),this.gridLineEnable=(s.gridLineEnable||[!0,!0]).slice(),this.gridLineWidth=(s.gridLineWidth||[1,1]).slice(),this.gridLineColor=i(s.gridLineColor||[[.5,.5,.5,1],[.5,.5,.5,1]]),this.zeroLineEnable=(s.zeroLineEnable||[!0,!0]).slice(),this.zeroLineWidth=(s.zeroLineWidth||[4,4]).slice(),this.zeroLineColor=i(s.zeroLineColor||[[0,0,0,1],[0,0,0,1]]),this.tickMarkLength=(s.tickMarkLength||[0,0,0,0]).slice(),this.tickMarkWidth=(s.tickMarkWidth||[0,0,0,0]).slice(),this.tickMarkColor=i(s.tickMarkColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.titleCenter=(s.titleCenter||[.5*(f[0]+f[2])/c,(f[3]+120)/c]).slice(),this.titleEnable=!("titleEnable"in s)||!!s.titleEnable,this.titleAngle=s.titleAngle||0,this.titleColor=(s.titleColor||[0,0,0,1]).slice(),this.labelPad=(s.labelPad||[15,15,15,15]).slice(),this.labelAngle=(s.labelAngle||[0,Math.PI/2,0,3*Math.PI/2]).slice(),this.labelEnable=(s.labelEnable||[!0,!0,!0,!0]).slice(),this.labelColor=i(s.labelColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.tickPad=(s.tickPad||[15,15,15,15]).slice(),this.tickAngle=(s.tickAngle||[0,0,0,0]).slice(),this.tickEnable=(s.tickEnable||[!0,!0,!0,!0]).slice(),this.tickColor=i(s.tickColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.borderLineEnable=(s.borderLineEnable||[!0,!0,!0,!0]).slice(),this.borderLineWidth=(s.borderLineWidth||[2,2,2,2]).slice(),this.borderLineColor=i(s.borderLineColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]);var d=s.ticks||[[],[]],m=this._tickBounds;m[0]=m[1]=1/0,m[2]=m[3]=-1/0;for(var y=0;y<2;++y){var v=d[y].slice(0);v.length!==0&&(v.sort(u),m[y]=Math.min(m[y],v[0].x),m[y+2]=Math.max(m[y+2],v[v.length-1].x))}this.grid.update({bounds:m,ticks:d}),this.text.update({bounds:m,ticks:d,labels:s.labels||["x","y"],labelSize:s.labelSize||[12,12],labelFont:s.labelFont||["sans-serif","sans-serif"],title:s.title||"",titleSize:s.titleSize||18,titleFont:s.titleFont||"sans-serif"}),this.static=!!s.static,this.setDirty()},r.dispose=function(){this.box.dispose(),this.grid.dispose(),this.text.dispose(),this.line.dispose();for(var s=this.objects.length-1;s>=0;--s)this.objects[s].dispose();for(this.objects.length=0,s=this.overlays.length-1;s>=0;--s)this.overlays[s].dispose();this.overlays.length=0,this.gl=null},r.addObject=function(s){this.objects.indexOf(s)<0&&(this.objects.push(s),this.setDirty())},r.removeObject=function(s){for(var a=this.objects,c=0;c<a.length;++c)if(a[c]===s){a.splice(c,1),this.setDirty();break}},r.addOverlay=function(s){this.overlays.indexOf(s)<0&&(this.overlays.push(s),this.setOverlayDirty())},r.removeOverlay=function(s){for(var a=this.overlays,c=0;c<a.length;++c)if(a[c]===s){a.splice(c,1),this.setOverlayDirty();break}}},{"./lib/box":311,"./lib/grid":312,"./lib/line":313,"./lib/text":315,"gl-select-static":334}],318:[function(n,z,q){"use strict";z.exports=function(r,i){r=r||document.body,i=i||{};var u=[.01,1/0];"distanceLimits"in i&&(u[0]=i.distanceLimits[0],u[1]=i.distanceLimits[1]),"zoomMin"in i&&(u[0]=i.zoomMin),"zoomMax"in i&&(u[1]=i.zoomMax);var s=h({center:i.center||[0,0,0],up:i.up||[0,1,0],eye:i.eye||[0,0,10],mode:i.mode||"orbit",distanceLimits:u}),a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],c=0,f=r.clientWidth,g=r.clientHeight,d={keyBindingMode:"rotate",enableWheel:!0,view:s,element:r,delay:i.delay||16,rotateSpeed:i.rotateSpeed||1,zoomSpeed:i.zoomSpeed||1,translateSpeed:i.translateSpeed||1,flipX:!!i.flipX,flipY:!!i.flipY,modes:s.modes,_ortho:i._ortho||i.projection&&i.projection.type==="orthographic"||!1,tick:function(){var m=t(),y=this.delay,v=m-2*y;s.idle(m-y),s.recalcMatrix(v),s.flush(m-(100+2*y));for(var T=!0,w=s.computedMatrix,A=0;A<16;++A)T=T&&a[A]===w[A],a[A]=w[A];var E=r.clientWidth===f&&r.clientHeight===g;return f=r.clientWidth,g=r.clientHeight,T?!E:(c=Math.exp(s.computedRadius[0]),!0)},lookAt:function(m,y,v){s.lookAt(s.lastT(),m,y,v)},rotate:function(m,y,v){s.rotate(s.lastT(),m,y,v)},pan:function(m,y,v){s.pan(s.lastT(),m,y,v)},translate:function(m,y,v){s.translate(s.lastT(),m,y,v)}};return Object.defineProperties(d,{matrix:{get:function(){return s.computedMatrix},set:function(m){return s.setMatrix(s.lastT(),m),s.computedMatrix},enumerable:!0},mode:{get:function(){return s.getMode()},set:function(m){var y=s.computedUp.slice(),v=s.computedEye.slice(),T=s.computedCenter.slice();if(s.setMode(m),m==="turntable"){var w=t();s._active.lookAt(w,v,T,y),s._active.lookAt(w+500,v,T,[0,0,1]),s._active.flush(w)}return s.getMode()},enumerable:!0},center:{get:function(){return s.computedCenter},set:function(m){return s.lookAt(s.lastT(),null,m),s.computedCenter},enumerable:!0},eye:{get:function(){return s.computedEye},set:function(m){return s.lookAt(s.lastT(),m),s.computedEye},enumerable:!0},up:{get:function(){return s.computedUp},set:function(m){return s.lookAt(s.lastT(),null,null,m),s.computedUp},enumerable:!0},distance:{get:function(){return c},set:function(m){return s.setDistance(s.lastT(),m),m},enumerable:!0},distanceLimits:{get:function(){return s.getDistanceLimits(u)},set:function(m){return s.setDistanceLimits(m),m},enumerable:!0}}),r.addEventListener("contextmenu",function(m){return m.preventDefault(),!1}),d._lastX=-1,d._lastY=-1,d._lastMods={shift:!1,control:!1,alt:!1,meta:!1},d.enableMouseListeners=function(){function m(y,v,T,w){var A=d.keyBindingMode;if(A!==!1){var E=A==="rotate",M=A==="pan",b=A==="zoom",_=!!w.control,S=!!w.alt,C=!!w.shift,k=!!(1&y),L=!!(2&y),I=!!(4&y),R=1/r.clientHeight,V=R*(v-d._lastX),O=R*(T-d._lastY),J=d.flipX?1:-1,D=d.flipY?1:-1,B=Math.PI*d.rotateSpeed,N=t();if(d._lastX!==-1&&d._lastY!==-1&&((E&&k&&!_&&!S&&!C||k&&!_&&!S&&C)&&s.rotate(N,J*B*V,-D*B*O,0),(M&&k&&!_&&!S&&!C||L||k&&_&&!S&&!C)&&s.pan(N,-d.translateSpeed*V*c,d.translateSpeed*O*c,0),b&&k&&!_&&!S&&!C||I||k&&!_&&S&&!C)){var F=-d.zoomSpeed*O/window.innerHeight*(N-s.lastT())*100;s.pan(N,0,0,c*(Math.exp(F)-1))}return d._lastX=v,d._lastY=T,d._lastMods=w,!0}}d.mouseListener=p(r,m),r.addEventListener("touchstart",function(y){var v=e(y.changedTouches[0],r);m(0,v[0],v[1],d._lastMods),m(1,v[0],v[1],d._lastMods)},!!o&&{passive:!0}),r.addEventListener("touchmove",function(y){var v=e(y.changedTouches[0],r);m(1,v[0],v[1],d._lastMods),y.preventDefault()},!!o&&{passive:!1}),r.addEventListener("touchend",function(y){m(0,d._lastX,d._lastY,d._lastMods)},!!o&&{passive:!0}),d.wheelListener=l(r,function(y,v){if(d.keyBindingMode!==!1&&d.enableWheel){var T=d.flipX?1:-1,w=d.flipY?1:-1,A=t();if(Math.abs(y)>Math.abs(v))s.rotate(A,0,0,-y*T*Math.PI*d.rotateSpeed/window.innerWidth);else if(!d._ortho){var E=-d.zoomSpeed*w*v/window.innerHeight*(A-s.lastT())/20;s.pan(A,0,0,c*(Math.exp(E)-1))}}},!0)},d.enableMouseListeners(),d};var t=n("right-now"),h=n("3d-view"),p=n("mouse-change"),l=n("mouse-wheel"),e=n("mouse-event-offset"),o=n("has-passive-events")},{"3d-view":54,"has-passive-events":441,"mouse-change":483,"mouse-event-offset":484,"mouse-wheel":486,"right-now":542}],319:[function(n,z,q){var t=n("glslify"),h=n("gl-shader"),p=t([`precision mediump float;
#define GLSLIFY 1
attribute vec2 position;
varying vec2 uv;
void main() {
  uv = position;
  gl_Position = vec4(position, 0, 1);
}`]),l=t([`precision mediump float;
#define GLSLIFY 1

uniform sampler2D accumBuffer;
varying vec2 uv;

void main() {
  vec4 accum = texture2D(accumBuffer, 0.5 * (uv + 1.0));
  gl_FragColor = min(vec4(1,1,1,1), accum);
}`]);z.exports=function(e){return h(e,p,l,null,[{name:"position",type:"vec2"}])}},{"gl-shader":335,glslify:320}],320:[function(n,z,q){arguments[4][257][0].apply(q,arguments)},{dup:257}],321:[function(n,z,q){"use strict";var t=n("./camera.js"),h=n("gl-axes3d"),p=n("gl-axes3d/properties"),l=n("gl-spikes3d"),e=n("gl-select-static"),o=n("gl-fbo"),r=n("a-big-triangle"),i=n("mouse-change"),u=n("gl-mat4/perspective"),s=n("gl-mat4/ortho"),a=n("./lib/shader"),c=n("is-mobile")({tablet:!0,featureDetect:!0});function f(){this.mouse=[-1,-1],this.screen=null,this.distance=1/0,this.index=null,this.dataCoordinate=null,this.dataPosition=null,this.object=null,this.data=null}function g(m){var y=Math.round(Math.log(Math.abs(m))/Math.log(10));if(y<0){var v=Math.round(Math.pow(10,-y));return Math.ceil(m*v)/v}return y>0?(v=Math.round(Math.pow(10,y)),Math.ceil(m/v)*v):Math.ceil(m)}function d(m){return typeof m!="boolean"||m}z.exports={createScene:function(m){(m=m||{}).camera=m.camera||{};var y=m.canvas;y||(y=document.createElement("canvas"),m.container?m.container.appendChild(y):document.body.appendChild(y));var v=m.gl;if(v||(m.glOptions&&(c=!!m.glOptions.preserveDrawingBuffer),v=function(oe,de){var le=null;try{(le=oe.getContext("webgl",de))||(le=oe.getContext("experimental-webgl",de))}catch{return null}return le}(y,m.glOptions||{premultipliedAlpha:!0,antialias:!0,preserveDrawingBuffer:c})),!v)throw new Error("webgl not supported");var T=m.bounds||[[-10,-10,-10],[10,10,10]],w=new f,A=o(v,v.drawingBufferWidth,v.drawingBufferHeight,{preferFloat:!c}),E=a(v),M=m.cameraObject&&m.cameraObject._ortho===!0||m.camera.projection&&m.camera.projection.type==="orthographic"||!1,b={eye:m.camera.eye||[2,0,0],center:m.camera.center||[0,0,0],up:m.camera.up||[0,1,0],zoomMin:m.camera.zoomMax||.1,zoomMax:m.camera.zoomMin||100,mode:m.camera.mode||"turntable",_ortho:M},_=m.axes||{},S=h(v,_);S.enable=!_.disable;var C=m.spikes||{},k=l(v,C),L=[],I=[],R=[],V=[],O=!0,J=!0,D=new Array(16),B=new Array(16),N={view:null,projection:D,model:B,_ortho:!1},F=(J=!0,[v.drawingBufferWidth,v.drawingBufferHeight]),H=m.cameraObject||t(y,b),j={gl:v,contextLost:!1,pixelRatio:m.pixelRatio||1,canvas:y,selection:w,camera:H,axes:S,axesPixels:null,spikes:k,bounds:T,objects:L,shape:F,aspect:m.aspectRatio||[1,1,1],pickRadius:m.pickRadius||10,zNear:m.zNear||.01,zFar:m.zFar||1e3,fovy:m.fovy||Math.PI/4,clearColor:m.clearColor||[0,0,0,0],autoResize:d(m.autoResize),autoBounds:d(m.autoBounds),autoScale:!!m.autoScale,autoCenter:d(m.autoCenter),clipToBounds:d(m.clipToBounds),snapToData:!!m.snapToData,onselect:m.onselect||null,onrender:m.onrender||null,onclick:m.onclick||null,cameraParams:N,oncontextloss:null,mouseListener:null,_stopped:!1,getAspectratio:function(){return{x:this.aspect[0],y:this.aspect[1],z:this.aspect[2]}},setAspectratio:function(oe){this.aspect[0]=oe.x,this.aspect[1]=oe.y,this.aspect[2]=oe.z,J=!0},setBounds:function(oe,de){this.bounds[0][oe]=de.min,this.bounds[1][oe]=de.max},setClearColor:function(oe){this.clearColor=oe},clearRGBA:function(){this.gl.clearColor(this.clearColor[0],this.clearColor[1],this.clearColor[2],this.clearColor[3]),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT)}},G=[v.drawingBufferWidth/j.pixelRatio|0,v.drawingBufferHeight/j.pixelRatio|0];function W(){if(!j._stopped&&j.autoResize){var oe=y.parentNode,de=1,le=1;oe&&oe!==document.body?(de=oe.clientWidth,le=oe.clientHeight):(de=window.innerWidth,le=window.innerHeight);var fe=0|Math.ceil(de*j.pixelRatio),ue=0|Math.ceil(le*j.pixelRatio);if(fe!==y.width||ue!==y.height){y.width=fe,y.height=ue;var we=y.style;we.position=we.position||"absolute",we.left="0px",we.top="0px",we.width=de+"px",we.height=le+"px",O=!0}}}j.autoResize&&W();function Q(){for(var oe=L.length,de=V.length,le=0;le<de;++le)R[le]=0;e:for(le=0;le<oe;++le){var fe=L[le],ue=fe.pickSlots;if(ue){for(var we=0;we<de;++we)if(R[we]+ue<255){I[le]=we,fe.setPickBase(R[we]+1),R[we]+=ue;continue e}var Ae=e(v,F);I[le]=de,V.push(Ae),R.push(ue),fe.setPickBase(1),de+=1}else I[le]=-1}for(;de>0&&R[de-1]===0;)R.pop(),V.pop().dispose()}function $(){if(j.contextLost)return!0;v.isContextLost()&&(j.contextLost=!0,j.mouseListener.enabled=!1,j.selection.object=null,j.oncontextloss&&j.oncontextloss())}window.addEventListener("resize",W),j.update=function(oe){j._stopped||(oe=oe||{},O=!0,J=!0)},j.add=function(oe){j._stopped||(oe.axes=S,L.push(oe),I.push(-1),O=!0,J=!0,Q())},j.remove=function(oe){if(!j._stopped){var de=L.indexOf(oe);de<0||(L.splice(de,1),I.pop(),O=!0,J=!0,Q())}},j.dispose=function(){if(!j._stopped&&(j._stopped=!0,window.removeEventListener("resize",W),y.removeEventListener("webglcontextlost",$),j.mouseListener.enabled=!1,!j.contextLost)){S.dispose(),k.dispose();for(var oe=0;oe<L.length;++oe)L[oe].dispose();for(A.dispose(),oe=0;oe<V.length;++oe)V[oe].dispose();E.dispose(),v=null,S=null,k=null,L=[]}},j._mouseRotating=!1,j._prevButtons=0,j.enableMouseListeners=function(){j.mouseListener=i(y,function(oe,de,le){if(!j._stopped){var fe=V.length,ue=L.length,we=w.object;w.distance=1/0,w.mouse[0]=de,w.mouse[1]=le,w.object=null,w.screen=null,w.dataCoordinate=w.dataPosition=null;var Ae=!1;if(oe&&j._prevButtons)j._mouseRotating=!0;else{j._mouseRotating&&(J=!0),j._mouseRotating=!1;for(var Se=0;Se<fe;++Se){var ke=V[Se].query(de,G[1]-le-1,j.pickRadius);if(ke){if(ke.distance>w.distance)continue;for(var Me=0;Me<ue;++Me){var ve=L[Me];if(I[Me]===Se){var ge=ve.pick(ke);ge&&(w.buttons=oe,w.screen=ke.coord,w.distance=ke.distance,w.object=ve,w.index=ge.distance,w.dataPosition=ge.position,w.dataCoordinate=ge.dataCoordinate,w.data=ge,Ae=!0)}}}}}we&&we!==w.object&&(we.highlight&&we.highlight(null),O=!0),w.object&&(w.object.highlight&&w.object.highlight(w.data),O=!0),(Ae=Ae||w.object!==we)&&j.onselect&&j.onselect(w),1&oe&&!(1&j._prevButtons)&&j.onclick&&j.onclick(w),j._prevButtons=oe}})},y.addEventListener("webglcontextlost",$);var ee=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],ie=[ee[0].slice(),ee[1].slice()];function ae(){if(!$()){W();var oe=j.camera.tick();N.view=j.camera.matrix,O=O||oe,J=J||oe,S.pixelRatio=j.pixelRatio,k.pixelRatio=j.pixelRatio;var de=L.length,le=ee[0],fe=ee[1];le[0]=le[1]=le[2]=1/0,fe[0]=fe[1]=fe[2]=-1/0;for(var ue=0;ue<de;++ue){(ze=L[ue]).pixelRatio=j.pixelRatio,ze.axes=j.axes,O=O||!!ze.dirty,J=J||!!ze.dirty;var we=ze.bounds;if(we)for(var Ae=we[0],Se=we[1],ke=0;ke<3;++ke)le[ke]=Math.min(le[ke],Ae[ke]),fe[ke]=Math.max(fe[ke],Se[ke])}var Me=j.bounds;if(j.autoBounds)for(ke=0;ke<3;++ke){if(fe[ke]<le[ke])le[ke]=-1,fe[ke]=1;else{le[ke]===fe[ke]&&(le[ke]-=1,fe[ke]+=1);var ve=.05*(fe[ke]-le[ke]);le[ke]=le[ke]-ve,fe[ke]=fe[ke]+ve}Me[0][ke]=le[ke],Me[1][ke]=fe[ke]}var ge=!1;for(ke=0;ke<3;++ke)ge=ge||ie[0][ke]!==Me[0][ke]||ie[1][ke]!==Me[1][ke],ie[0][ke]=Me[0][ke],ie[1][ke]=Me[1][ke];if(J=J||ge,O=O||ge){if(ge){var De=[0,0,0];for(ue=0;ue<3;++ue)De[ue]=g((Me[1][ue]-Me[0][ue])/10);S.autoTicks?S.update({bounds:Me,tickSpacing:De}):S.update({bounds:Me})}var _e=v.drawingBufferWidth,Pe=v.drawingBufferHeight;for(F[0]=_e,F[1]=Pe,G[0]=0|Math.max(_e/j.pixelRatio,1),G[1]=0|Math.max(Pe/j.pixelRatio,1),function(He,et){var Re=He.bounds,Ze=He.cameraParams,Ke=Ze.projection,$e=Ze.model,rt=He.gl.drawingBufferWidth,at=He.gl.drawingBufferHeight,lt=He.zNear,gt=He.zFar,Ie=He.fovy,be=rt/at;et?(s(Ke,-be,be,-1,1,lt,gt),Ze._ortho=!0):(u(Ke,Ie,be,lt,gt),Ze._ortho=!1);for(var We=0;We<16;++We)$e[We]=0;$e[15]=1;var Ge=0;for(We=0;We<3;++We)Ge=Math.max(Ge,Re[1][We]-Re[0][We]);for(We=0;We<3;++We)He.autoScale?$e[5*We]=He.aspect[We]/(Re[1][We]-Re[0][We]):$e[5*We]=1/Ge,He.autoCenter&&($e[12+We]=.5*-$e[5*We]*(Re[0][We]+Re[1][We]))}(j,M),ue=0;ue<de;++ue)(ze=L[ue]).axesBounds=Me,j.clipToBounds&&(ze.clipBounds=Me);w.object&&(j.snapToData?k.position=w.dataCoordinate:k.position=w.dataPosition,k.bounds=Me),J&&(J=!1,function(){if(!$()){v.colorMask(!0,!0,!0,!0),v.depthMask(!0),v.disable(v.BLEND),v.enable(v.DEPTH_TEST),v.depthFunc(v.LEQUAL);for(var He=L.length,et=V.length,Re=0;Re<et;++Re){var Ze=V[Re];Ze.shape=G,Ze.begin();for(var Ke=0;Ke<He;++Ke)if(I[Ke]===Re){var $e=L[Ke];$e.drawPick&&($e.pixelRatio=1,$e.drawPick(N))}Ze.end()}}}()),j.axesPixels=p(j.axes,N,_e,Pe),j.onrender&&j.onrender(),v.bindFramebuffer(v.FRAMEBUFFER,null),v.viewport(0,0,_e,Pe),j.clearRGBA(),v.depthMask(!0),v.colorMask(!0,!0,!0,!0),v.enable(v.DEPTH_TEST),v.depthFunc(v.LEQUAL),v.disable(v.BLEND),v.disable(v.CULL_FACE);var Fe=!1;for(S.enable&&(Fe=Fe||S.isTransparent(),S.draw(N)),k.axes=S,w.object&&k.draw(N),v.disable(v.CULL_FACE),ue=0;ue<de;++ue)(ze=L[ue]).axes=S,ze.pixelRatio=j.pixelRatio,ze.isOpaque&&ze.isOpaque()&&ze.draw(N),ze.isTransparent&&ze.isTransparent()&&(Fe=!0);if(Fe){for(A.shape=F,A.bind(),v.clear(v.DEPTH_BUFFER_BIT),v.colorMask(!1,!1,!1,!1),v.depthMask(!0),v.depthFunc(v.LESS),S.enable&&S.isTransparent()&&S.drawTransparent(N),ue=0;ue<de;++ue)(ze=L[ue]).isOpaque&&ze.isOpaque()&&ze.draw(N);for(v.enable(v.BLEND),v.blendEquation(v.FUNC_ADD),v.blendFunc(v.ONE,v.ONE_MINUS_SRC_ALPHA),v.colorMask(!0,!0,!0,!0),v.depthMask(!1),v.clearColor(0,0,0,0),v.clear(v.COLOR_BUFFER_BIT),S.isTransparent()&&S.drawTransparent(N),ue=0;ue<de;++ue){var ze;(ze=L[ue]).isTransparent&&ze.isTransparent()&&ze.drawTransparent(N)}v.bindFramebuffer(v.FRAMEBUFFER,null),v.blendFunc(v.ONE,v.ONE_MINUS_SRC_ALPHA),v.disable(v.DEPTH_TEST),E.bind(),A.color[0].bind(0),E.uniforms.accumBuffer=0,r(v),v.disable(v.BLEND)}for(O=!1,ue=0;ue<de;++ue)L[ue].dirty=!1}}}return j.enableMouseListeners(),function oe(){j._stopped||j.contextLost||(ae(),requestAnimationFrame(oe))}(),j.redraw=function(){j._stopped||(O=!0,ae())},j},createCamera:t}},{"./camera.js":318,"./lib/shader":319,"a-big-triangle":64,"gl-axes3d":250,"gl-axes3d/properties":258,"gl-fbo":269,"gl-mat4/ortho":296,"gl-mat4/perspective":297,"gl-select-static":334,"gl-spikes3d":345,"is-mobile":467,"mouse-change":483}],322:[function(n,z,q){var t=n("glslify");q.pointVertex=t([`precision mediump float;
#define GLSLIFY 1

attribute vec2 position;

uniform mat3 matrix;
uniform float pointSize;
uniform float pointCloud;

highp float rand(vec2 co) {
  highp float a = 12.9898;
  highp float b = 78.233;
  highp float c = 43758.5453;
  highp float d = dot(co.xy, vec2(a, b));
  highp float e = mod(d, 3.14);
  return fract(sin(e) * c);
}

void main() {
  vec3 hgPosition = matrix * vec3(position, 1);
  gl_Position  = vec4(hgPosition.xy, 0, hgPosition.z);
    // if we don't jitter the point size a bit, overall point cloud
    // saturation 'jumps' on zooming, which is disturbing and confusing
  gl_PointSize = pointSize * ((19.5 + rand(position)) / 20.0);
  if(pointCloud != 0.0) { // pointCloud is truthy
    // get the same square surface as circle would be
    gl_PointSize *= 0.886;
  }
}`]),q.pointFragment=t([`precision mediump float;
#define GLSLIFY 1

uniform vec4 color, borderColor;
uniform float centerFraction;
uniform float pointCloud;

void main() {
  float radius;
  vec4 baseColor;
  if(pointCloud != 0.0) { // pointCloud is truthy
    if(centerFraction == 1.0) {
      gl_FragColor = color;
    } else {
      gl_FragColor = mix(borderColor, color, centerFraction);
    }
  } else {
    radius = length(2.0 * gl_PointCoord.xy - 1.0);
    if(radius > 1.0) {
      discard;
    }
    baseColor = mix(borderColor, color, step(radius, centerFraction));
    gl_FragColor = vec4(baseColor.rgb * baseColor.a, baseColor.a);
  }
}
`]),q.pickVertex=t([`precision mediump float;
#define GLSLIFY 1

attribute vec2 position;
attribute vec4 pickId;

uniform mat3 matrix;
uniform float pointSize;
uniform vec4 pickOffset;

varying vec4 fragId;

void main() {
  vec3 hgPosition = matrix * vec3(position, 1);
  gl_Position  = vec4(hgPosition.xy, 0, hgPosition.z);
  gl_PointSize = pointSize;

  vec4 id = pickId + pickOffset;
  id.y += floor(id.x / 256.0);
  id.x -= floor(id.x / 256.0) * 256.0;

  id.z += floor(id.y / 256.0);
  id.y -= floor(id.y / 256.0) * 256.0;

  id.w += floor(id.z / 256.0);
  id.z -= floor(id.z / 256.0) * 256.0;

  fragId = id;
}
`]),q.pickFragment=t([`precision mediump float;
#define GLSLIFY 1

varying vec4 fragId;

void main() {
  float radius = length(2.0 * gl_PointCoord.xy - 1.0);
  if(radius > 1.0) {
    discard;
  }
  gl_FragColor = fragId / 255.0;
}
`])},{glslify:323}],323:[function(n,z,q){arguments[4][257][0].apply(q,arguments)},{dup:257}],324:[function(n,z,q){"use strict";var t=n("gl-shader"),h=n("gl-buffer"),p=n("typedarray-pool"),l=n("./lib/shader");function e(u,s,a,c,f){this.plot=u,this.offsetBuffer=s,this.pickBuffer=a,this.shader=c,this.pickShader=f,this.sizeMin=.5,this.sizeMinCap=2,this.sizeMax=20,this.areaRatio=1,this.pointCount=0,this.color=[1,0,0,1],this.borderColor=[0,0,0,1],this.blend=!1,this.pickOffset=0,this.points=null}z.exports=function(u,s){var a=u.gl,c=h(a),f=h(a),g=t(a,l.pointVertex,l.pointFragment),d=t(a,l.pickVertex,l.pickFragment),m=new e(u,c,f,g,d);return m.update(s),u.addObject(m),m};var o,r,i=e.prototype;i.dispose=function(){this.shader.dispose(),this.pickShader.dispose(),this.offsetBuffer.dispose(),this.pickBuffer.dispose(),this.plot.removeObject(this)},i.update=function(u){var s;function a(v,T){return v in u?u[v]:T}u=u||{},this.sizeMin=a("sizeMin",.5),this.sizeMax=a("sizeMax",20),this.color=a("color",[1,0,0,1]).slice(),this.areaRatio=a("areaRatio",1),this.borderColor=a("borderColor",[0,0,0,1]).slice(),this.blend=a("blend",!1);var c=u.positions.length>>>1,f=u.positions instanceof Float32Array,g=u.idToIndex instanceof Int32Array&&u.idToIndex.length>=c,d=u.positions,m=f?d:p.mallocFloat32(d.length),y=g?u.idToIndex:p.mallocInt32(c);if(f||m.set(d),!g)for(m.set(d),s=0;s<c;s++)y[s]=s;this.points=d,this.offsetBuffer.update(m),this.pickBuffer.update(y),f||p.free(m),g||p.free(y),this.pointCount=c,this.pickOffset=0},i.unifiedDraw=(o=[1,0,0,0,1,0,0,0,1],r=[0,0,0,0],function(u){var s=u!==void 0,a=s?this.pickShader:this.shader,c=this.plot.gl,f=this.plot.dataBox;if(this.pointCount===0)return u;var g=f[2]-f[0],d=f[3]-f[1],m=function(w,A){var E,M=0,b=w.length>>>1;for(E=0;E<b;E++){var _=w[2*E],S=w[2*E+1];_>=A[0]&&_<=A[2]&&S>=A[1]&&S<=A[3]&&M++}return M}(this.points,f),y=this.plot.pickPixelRatio*Math.max(Math.min(this.sizeMinCap,this.sizeMin),Math.min(this.sizeMax,this.sizeMax/Math.pow(m,.33333)));o[0]=2/g,o[4]=2/d,o[6]=-2*f[0]/g-1,o[7]=-2*f[1]/d-1,this.offsetBuffer.bind(),a.bind(),a.attributes.position.pointer(),a.uniforms.matrix=o,a.uniforms.color=this.color,a.uniforms.borderColor=this.borderColor,a.uniforms.pointCloud=y<5,a.uniforms.pointSize=y,a.uniforms.centerFraction=Math.min(1,Math.max(0,Math.sqrt(1-this.areaRatio))),s&&(r[0]=255&u,r[1]=u>>8&255,r[2]=u>>16&255,r[3]=u>>24&255,this.pickBuffer.bind(),a.attributes.pickId.pointer(c.UNSIGNED_BYTE),a.uniforms.pickOffset=r,this.pickOffset=u);var v=c.getParameter(c.BLEND),T=c.getParameter(c.DITHER);return v&&!this.blend&&c.disable(c.BLEND),T&&c.disable(c.DITHER),c.drawArrays(c.POINTS,0,this.pointCount),v&&!this.blend&&c.enable(c.BLEND),T&&c.enable(c.DITHER),u+this.pointCount}),i.draw=i.unifiedDraw,i.drawPick=i.unifiedDraw,i.pick=function(u,s,a){var c=this.pickOffset,f=this.pointCount;if(a<c||a>=c+f)return null;var g=a-c,d=this.points;return{object:this,pointId:g,dataCoord:[d[2*g],d[2*g+1]]}}},{"./lib/shader":322,"gl-buffer":259,"gl-shader":335,"typedarray-pool":595}],325:[function(n,z,q){z.exports=function(t,h,p,l){var e,o,r,i,u,s=h[0],a=h[1],c=h[2],f=h[3],g=p[0],d=p[1],m=p[2],y=p[3];return(o=s*g+a*d+c*m+f*y)<0&&(o=-o,g=-g,d=-d,m=-m,y=-y),1-o>1e-6?(e=Math.acos(o),r=Math.sin(e),i=Math.sin((1-l)*e)/r,u=Math.sin(l*e)/r):(i=1-l,u=l),t[0]=i*s+u*g,t[1]=i*a+u*d,t[2]=i*c+u*m,t[3]=i*f+u*y,t}},{}],326:[function(n,z,q){"use strict";z.exports=function(t){return t||t===0?t.toString():""}},{}],327:[function(n,z,q){"use strict";var t=n("vectorize-text");z.exports=function(p,l,e){var o=h[l];if(o||(o=h[l]={}),p in o)return o[p];var r={textAlign:"center",textBaseline:"middle",lineHeight:1,font:l,lineSpacing:1.25,styletags:{breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0},triangles:!0},i=t(p,r);r.triangles=!1;var u,s,a=t(p,r);if(e&&e!==1){for(u=0;u<i.positions.length;++u)for(s=0;s<i.positions[u].length;++s)i.positions[u][s]/=e;for(u=0;u<a.positions.length;++u)for(s=0;s<a.positions[u].length;++s)a.positions[u][s]/=e}var c=[[1/0,1/0],[-1/0,-1/0]],f=a.positions.length;for(u=0;u<f;++u){var g=a.positions[u];for(s=0;s<2;++s)c[0][s]=Math.min(c[0][s],g[s]),c[1][s]=Math.max(c[1][s],g[s])}return o[p]=[i,a,c]};var h={}},{"vectorize-text":600}],328:[function(n,z,q){var t=n("gl-shader"),h=n("glslify"),p=h([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3 position;
attribute vec4 color;
attribute vec2 glyph;
attribute vec4 id;

uniform vec4 highlightId;
uniform float highlightScale;
uniform mat4 model, view, projection;
uniform vec3 clipBounds[2];

varying vec4 interpColor;
varying vec4 pickId;
varying vec3 dataCoordinate;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0,0,0,0);
  } else {
    float scale = 1.0;
    if(distance(highlightId, id) < 0.0001) {
      scale = highlightScale;
    }

    vec4 worldPosition = model * vec4(position, 1);
    vec4 viewPosition = view * worldPosition;
    viewPosition = viewPosition / viewPosition.w;
    vec4 clipPosition = projection * (viewPosition + scale * vec4(glyph.x, -glyph.y, 0, 0));

    gl_Position = clipPosition;
    interpColor = color;
    pickId = id;
    dataCoordinate = position;
  }
}`]),l=h([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3 position;
attribute vec4 color;
attribute vec2 glyph;
attribute vec4 id;

uniform mat4 model, view, projection;
uniform vec2 screenSize;
uniform vec3 clipBounds[2];
uniform float highlightScale, pixelRatio;
uniform vec4 highlightId;

varying vec4 interpColor;
varying vec4 pickId;
varying vec3 dataCoordinate;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0,0,0,0);
  } else {
    float scale = pixelRatio;
    if(distance(highlightId.bgr, id.bgr) < 0.001) {
      scale *= highlightScale;
    }

    vec4 worldPosition = model * vec4(position, 1.0);
    vec4 viewPosition = view * worldPosition;
    vec4 clipPosition = projection * viewPosition;
    clipPosition /= clipPosition.w;

    gl_Position = clipPosition + vec4(screenSize * scale * vec2(glyph.x, -glyph.y), 0.0, 0.0);
    interpColor = color;
    pickId = id;
    dataCoordinate = position;
  }
}`]),e=h([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3 position;
attribute vec4 color;
attribute vec2 glyph;
attribute vec4 id;

uniform float highlightScale;
uniform vec4 highlightId;
uniform vec3 axes[2];
uniform mat4 model, view, projection;
uniform vec2 screenSize;
uniform vec3 clipBounds[2];
uniform float scale, pixelRatio;

varying vec4 interpColor;
varying vec4 pickId;
varying vec3 dataCoordinate;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0,0,0,0);
  } else {
    float lscale = pixelRatio * scale;
    if(distance(highlightId, id) < 0.0001) {
      lscale *= highlightScale;
    }

    vec4 clipCenter   = projection * view * model * vec4(position, 1);
    vec3 dataPosition = position + 0.5*lscale*(axes[0] * glyph.x + axes[1] * glyph.y) * clipCenter.w * screenSize.y;
    vec4 clipPosition = projection * view * model * vec4(dataPosition, 1);

    gl_Position = clipPosition;
    interpColor = color;
    pickId = id;
    dataCoordinate = dataPosition;
  }
}
`]),o=h([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 fragClipBounds[2];
uniform float opacity;

varying vec4 interpColor;
varying vec3 dataCoordinate;

void main() {
  if (
    outOfRange(fragClipBounds[0], fragClipBounds[1], dataCoordinate) ||
    interpColor.a * opacity == 0.
  ) discard;
  gl_FragColor = interpColor * opacity;
}
`]),r=h([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 fragClipBounds[2];
uniform float pickGroup;

varying vec4 pickId;
varying vec3 dataCoordinate;

void main() {
  if (outOfRange(fragClipBounds[0], fragClipBounds[1], dataCoordinate)) discard;

  gl_FragColor = vec4(pickGroup, pickId.bgr);
}`]),i=[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"glyph",type:"vec2"},{name:"id",type:"vec4"}],u={vertex:p,fragment:o,attributes:i},s={vertex:l,fragment:o,attributes:i},a={vertex:e,fragment:o,attributes:i},c={vertex:p,fragment:r,attributes:i},f={vertex:l,fragment:r,attributes:i},g={vertex:e,fragment:r,attributes:i};function d(m,y){var v=t(m,y),T=v.attributes;return T.position.location=0,T.color.location=1,T.glyph.location=2,T.id.location=3,v}q.createPerspective=function(m){return d(m,u)},q.createOrtho=function(m){return d(m,s)},q.createProject=function(m){return d(m,a)},q.createPickPerspective=function(m){return d(m,c)},q.createPickOrtho=function(m){return d(m,f)},q.createPickProject=function(m){return d(m,g)}},{"gl-shader":335,glslify:329}],329:[function(n,z,q){arguments[4][257][0].apply(q,arguments)},{dup:257}],330:[function(n,z,q){"use strict";var t=n("is-string-blank"),h=n("gl-buffer"),p=n("gl-vao"),l=n("typedarray-pool"),e=n("gl-mat4/multiply"),o=n("./lib/shaders"),r=n("./lib/glyphs"),i=n("./lib/get-simple-string"),u=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function s(R,V){var O=R[0],J=R[1],D=R[2],B=R[3];return R[0]=V[0]*O+V[4]*J+V[8]*D+V[12]*B,R[1]=V[1]*O+V[5]*J+V[9]*D+V[13]*B,R[2]=V[2]*O+V[6]*J+V[10]*D+V[14]*B,R[3]=V[3]*O+V[7]*J+V[11]*D+V[15]*B,R}function a(R,V,O,J){return s(J,J),s(J,J),s(J,J)}function c(R,V){this.index=R,this.dataCoordinate=this.position=V}function f(R){return R===!0||R>1?1:R}function g(R,V,O,J,D,B,N,F,H,j,G,W){this.gl=R,this.pixelRatio=1,this.shader=V,this.orthoShader=O,this.projectShader=J,this.pointBuffer=D,this.colorBuffer=B,this.glyphBuffer=N,this.idBuffer=F,this.vao=H,this.vertexCount=0,this.lineVertexCount=0,this.opacity=1,this.hasAlpha=!1,this.lineWidth=0,this.projectScale=[2/3,2/3,2/3],this.projectOpacity=[1,1,1],this.projectHasAlpha=!1,this.pickId=0,this.pickPerspectiveShader=j,this.pickOrthoShader=G,this.pickProjectShader=W,this.points=[],this._selectResult=new c(0,[0,0,0]),this.useOrtho=!0,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.axesProject=[!0,!0,!0],this.axesBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.highlightId=[1,1,1,1],this.highlightScale=2,this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.dirty=!0}z.exports=function(R){var V=R.gl,O=o.createPerspective(V),J=o.createOrtho(V),D=o.createProject(V),B=o.createPickPerspective(V),N=o.createPickOrtho(V),F=o.createPickProject(V),H=h(V),j=h(V),G=h(V),W=h(V),Q=p(V,[{buffer:H,size:3,type:V.FLOAT},{buffer:j,size:4,type:V.FLOAT},{buffer:G,size:2,type:V.FLOAT},{buffer:W,size:4,type:V.UNSIGNED_BYTE,normalized:!0}]),$=new g(V,O,J,D,H,j,G,W,Q,B,N,F);return $.update(R),$};var d=g.prototype;d.pickSlots=1,d.setPickBase=function(R){this.pickId=R},d.isTransparent=function(){if(this.hasAlpha)return!0;for(var R=0;R<3;++R)if(this.axesProject[R]&&this.projectHasAlpha)return!0;return!1},d.isOpaque=function(){if(!this.hasAlpha)return!0;for(var R=0;R<3;++R)if(this.axesProject[R]&&!this.projectHasAlpha)return!0;return!1};var m=[0,0],y=[0,0,0],v=[0,0,0],T=[0,0,0,1],w=[0,0,0,1],A=u.slice(),E=[0,0,0],M=[[0,0,0],[0,0,0]];function b(R){return R[0]=R[1]=R[2]=0,R}function _(R,V){return R[0]=V[0],R[1]=V[1],R[2]=V[2],R[3]=1,R}function S(R,V,O,J){return R[0]=V[0],R[1]=V[1],R[2]=V[2],R[O]=J,R}function C(R,V,O,J){var D,B=V.axesProject,N=V.gl,F=R.uniforms,H=O.model||u,j=O.view||u,G=O.projection||u,W=V.axesBounds,Q=function(Me){for(var ve=M,ge=0;ge<2;++ge)for(var De=0;De<3;++De)ve[ge][De]=Math.max(Math.min(Me[ge][De],1e8),-1e8);return ve}(V.clipBounds);D=V.axes&&V.axes.lastCubeProps?V.axes.lastCubeProps.axis:[1,1,1],m[0]=2/N.drawingBufferWidth,m[1]=2/N.drawingBufferHeight,R.bind(),F.view=j,F.projection=G,F.screenSize=m,F.highlightId=V.highlightId,F.highlightScale=V.highlightScale,F.clipBounds=Q,F.pickGroup=V.pickId/255,F.pixelRatio=J;for(var $=0;$<3;++$)if(B[$]){F.scale=V.projectScale[$],F.opacity=V.projectOpacity[$];for(var ee=A,ie=0;ie<16;++ie)ee[ie]=0;for(ie=0;ie<4;++ie)ee[5*ie]=1;ee[5*$]=0,D[$]<0?ee[12+$]=W[0][$]:ee[12+$]=W[1][$],e(ee,H,ee),F.model=ee;var ae=($+1)%3,oe=($+2)%3,de=b(y),le=b(v);de[ae]=1,le[oe]=1;var fe=a(0,0,0,_(T,de)),ue=a(0,0,0,_(w,le));if(Math.abs(fe[1])>Math.abs(ue[1])){var we=fe;fe=ue,ue=we,we=de,de=le,le=we;var Ae=ae;ae=oe,oe=Ae}fe[0]<0&&(de[ae]=-1),ue[1]>0&&(le[oe]=-1);var Se=0,ke=0;for(ie=0;ie<4;++ie)Se+=Math.pow(H[4*ae+ie],2),ke+=Math.pow(H[4*oe+ie],2);de[ae]/=Math.sqrt(Se),le[oe]/=Math.sqrt(ke),F.axes[0]=de,F.axes[1]=le,F.fragClipBounds[0]=S(E,Q[0],$,-1e8),F.fragClipBounds[1]=S(E,Q[1],$,1e8),V.vao.bind(),V.vao.draw(N.TRIANGLES,V.vertexCount),V.lineWidth>0&&(N.lineWidth(V.lineWidth*J),V.vao.draw(N.LINES,V.lineVertexCount,V.vertexCount)),V.vao.unbind()}}var k=[[-1e8,-1e8,-1e8],[1e8,1e8,1e8]];function L(R,V,O,J,D,B,N){var F=O.gl;if((B===O.projectHasAlpha||N)&&C(V,O,J,D),B===O.hasAlpha||N){R.bind();var H=R.uniforms;H.model=J.model||u,H.view=J.view||u,H.projection=J.projection||u,m[0]=2/F.drawingBufferWidth,m[1]=2/F.drawingBufferHeight,H.screenSize=m,H.highlightId=O.highlightId,H.highlightScale=O.highlightScale,H.fragClipBounds=k,H.clipBounds=O.axes.bounds,H.opacity=O.opacity,H.pickGroup=O.pickId/255,H.pixelRatio=D,O.vao.bind(),O.vao.draw(F.TRIANGLES,O.vertexCount),O.lineWidth>0&&(F.lineWidth(O.lineWidth*D),O.vao.draw(F.LINES,O.lineVertexCount,O.vertexCount)),O.vao.unbind()}}function I(R,V,O,J){var D;D=Array.isArray(R)?V<R.length?R[V]:void 0:R,D=i(D);var B=!0;t(D)&&(D="\u25BC",B=!1);var N=r(D,O,J);return{mesh:N[0],lines:N[1],bounds:N[2],visible:B}}d.draw=function(R){L(this.useOrtho?this.orthoShader:this.shader,this.projectShader,this,R,this.pixelRatio,!1,!1)},d.drawTransparent=function(R){L(this.useOrtho?this.orthoShader:this.shader,this.projectShader,this,R,this.pixelRatio,!0,!1)},d.drawPick=function(R){L(this.useOrtho?this.pickOrthoShader:this.pickPerspectiveShader,this.pickProjectShader,this,R,1,!0,!0)},d.pick=function(R){if(!R||R.id!==this.pickId)return null;var V=R.value[2]+(R.value[1]<<8)+(R.value[0]<<16);if(V>=this.pointCount||V<0)return null;var O=this.points[V],J=this._selectResult;J.index=V;for(var D=0;D<3;++D)J.position[D]=J.dataCoordinate[D]=O[D];return J},d.highlight=function(R){if(R){var V=R.index,O=255&V,J=V>>8&255,D=V>>16&255;this.highlightId=[O/255,J/255,D/255,0]}else this.highlightId=[1,1,1,1]},d.update=function(R){if("perspective"in(R=R||{})&&(this.useOrtho=!R.perspective),"orthographic"in R&&(this.useOrtho=!!R.orthographic),"lineWidth"in R&&(this.lineWidth=R.lineWidth),"project"in R)if(Array.isArray(R.project))this.axesProject=R.project;else{var V=!!R.project;this.axesProject=[V,V,V]}if("projectScale"in R)if(Array.isArray(R.projectScale))this.projectScale=R.projectScale.slice();else{var O=+R.projectScale;this.projectScale=[O,O,O]}if(this.projectHasAlpha=!1,"projectOpacity"in R){Array.isArray(R.projectOpacity)?this.projectOpacity=R.projectOpacity.slice():(O=+R.projectOpacity,this.projectOpacity=[O,O,O]);for(var J=0;J<3;++J)this.projectOpacity[J]=f(this.projectOpacity[J]),this.projectOpacity[J]<1&&(this.projectHasAlpha=!0)}this.hasAlpha=!1,"opacity"in R&&(this.opacity=f(R.opacity),this.opacity<1&&(this.hasAlpha=!0)),this.dirty=!0;var D,B,N=R.position,F=R.font||"normal",H=R.alignment||[0,0];if(H.length===2)D=H[0],B=H[1];else for(D=[],B=[],J=0;J<H.length;++J)D[J]=H[J][0],B[J]=H[J][1];var j=[1/0,1/0,1/0],G=[-1/0,-1/0,-1/0],W=R.glyph,Q=R.color,$=R.size,ee=R.angle,ie=R.lineColor,ae=-1,oe=0,de=0,le=0;if(N.length){le=N.length;e:for(J=0;J<le;++J){for(var fe=N[J],ue=0;ue<3;++ue)if(isNaN(fe[ue])||!isFinite(fe[ue]))continue e;var we=(Re=I(W,J,F,this.pixelRatio)).mesh,Ae=Re.lines,Se=Re.bounds;oe+=3*we.cells.length,de+=2*Ae.edges.length}}var ke=oe+de,Me=l.mallocFloat(3*ke),ve=l.mallocFloat(4*ke),ge=l.mallocFloat(2*ke),De=l.mallocUint32(ke);if(ke>0){var _e=0,Pe=oe,Fe=[0,0,0,1],ze=[0,0,0,1],He=Array.isArray(Q)&&Array.isArray(Q[0]),et=Array.isArray(ie)&&Array.isArray(ie[0]);e:for(J=0;J<le;++J){for(ae+=1,fe=N[J],ue=0;ue<3;++ue){if(isNaN(fe[ue])||!isFinite(fe[ue]))continue e;G[ue]=Math.max(G[ue],fe[ue]),j[ue]=Math.min(j[ue],fe[ue])}we=(Re=I(W,J,F,this.pixelRatio)).mesh,Ae=Re.lines,Se=Re.bounds;var Re,Ze=Re.visible;if(Ze)if(Array.isArray(Q)){if((Ke=He?J<Q.length?Q[J]:[0,0,0,0]:Q).length===3){for(ue=0;ue<3;++ue)Fe[ue]=Ke[ue];Fe[3]=1}else if(Ke.length===4){for(ue=0;ue<4;++ue)Fe[ue]=Ke[ue];!this.hasAlpha&&Ke[3]<1&&(this.hasAlpha=!0)}}else Fe[0]=Fe[1]=Fe[2]=0,Fe[3]=1;else Fe=[1,1,1,0];if(Ze)if(Array.isArray(ie)){var Ke;if((Ke=et?J<ie.length?ie[J]:[0,0,0,0]:ie).length===3){for(ue=0;ue<3;++ue)ze[ue]=Ke[ue];ze[ue]=1}else if(Ke.length===4){for(ue=0;ue<4;++ue)ze[ue]=Ke[ue];!this.hasAlpha&&Ke[3]<1&&(this.hasAlpha=!0)}}else ze[0]=ze[1]=ze[2]=0,ze[3]=1;else ze=[1,1,1,0];var $e=.5;Ze?Array.isArray($)?$e=J<$.length?+$[J]:12:$?$e=+$:this.useOrtho&&($e=12):$e=0;var rt=0;Array.isArray(ee)?rt=J<ee.length?+ee[J]:0:ee&&(rt=+ee);var at=Math.cos(rt),lt=Math.sin(rt);for(fe=N[J],ue=0;ue<3;++ue)G[ue]=Math.max(G[ue],fe[ue]),j[ue]=Math.min(j[ue],fe[ue]);var gt=D,Ie=B;gt=0,Array.isArray(D)?gt=J<D.length?D[J]:0:D&&(gt=D),Ie=0,Array.isArray(B)?Ie=J<B.length?B[J]:0:B&&(Ie=B);var be=[gt*=gt>0?1-Se[0][0]:gt<0?1+Se[1][0]:1,Ie*=Ie>0?1-Se[0][1]:Ie<0?1+Se[1][1]:1],We=we.cells||[],Ge=we.positions||[];for(ue=0;ue<We.length;++ue)for(var st=We[ue],ot=0;ot<3;++ot){for(var Ce=0;Ce<3;++Ce)Me[3*_e+Ce]=fe[Ce];for(Ce=0;Ce<4;++Ce)ve[4*_e+Ce]=Fe[Ce];De[_e]=ae;var Ue=Ge[st[ot]];ge[2*_e]=$e*(at*Ue[0]-lt*Ue[1]+be[0]),ge[2*_e+1]=$e*(lt*Ue[0]+at*Ue[1]+be[1]),_e+=1}for(We=Ae.edges,Ge=Ae.positions,ue=0;ue<We.length;++ue)for(st=We[ue],ot=0;ot<2;++ot){for(Ce=0;Ce<3;++Ce)Me[3*Pe+Ce]=fe[Ce];for(Ce=0;Ce<4;++Ce)ve[4*Pe+Ce]=ze[Ce];De[Pe]=ae,Ue=Ge[st[ot]],ge[2*Pe]=$e*(at*Ue[0]-lt*Ue[1]+be[0]),ge[2*Pe+1]=$e*(lt*Ue[0]+at*Ue[1]+be[1]),Pe+=1}}}this.bounds=[j,G],this.points=N,this.pointCount=N.length,this.vertexCount=oe,this.lineVertexCount=de,this.pointBuffer.update(Me),this.colorBuffer.update(ve),this.glyphBuffer.update(ge),this.idBuffer.update(De),l.free(Me),l.free(ve),l.free(ge),l.free(De)},d.dispose=function(){this.shader.dispose(),this.orthoShader.dispose(),this.pickPerspectiveShader.dispose(),this.pickOrthoShader.dispose(),this.vao.dispose(),this.pointBuffer.dispose(),this.colorBuffer.dispose(),this.glyphBuffer.dispose(),this.idBuffer.dispose()}},{"./lib/get-simple-string":326,"./lib/glyphs":327,"./lib/shaders":328,"gl-buffer":259,"gl-mat4/multiply":295,"gl-vao":358,"is-string-blank":470,"typedarray-pool":595}],331:[function(n,z,q){"use strict";var t=n("glslify");q.boxVertex=t([`precision mediump float;
#define GLSLIFY 1

attribute vec2 vertex;

uniform vec2 cornerA, cornerB;

void main() {
  gl_Position = vec4(mix(cornerA, cornerB, vertex), 0, 1);
}
`]),q.boxFragment=t([`precision mediump float;
#define GLSLIFY 1

uniform vec4 color;

void main() {
  gl_FragColor = color;
}
`])},{glslify:332}],332:[function(n,z,q){arguments[4][257][0].apply(q,arguments)},{dup:257}],333:[function(n,z,q){"use strict";var t=n("gl-shader"),h=n("gl-buffer"),p=n("./lib/shaders");function l(o,r,i){this.plot=o,this.boxBuffer=r,this.boxShader=i,this.enabled=!0,this.selectBox=[1/0,1/0,-1/0,-1/0],this.borderColor=[0,0,0,1],this.innerFill=!1,this.innerColor=[0,0,0,.25],this.outerFill=!0,this.outerColor=[0,0,0,.5],this.borderWidth=10}z.exports=function(o,r){var i=o.gl,u=h(i,[0,0,0,1,1,0,1,1]),s=t(i,p.boxVertex,p.boxFragment),a=new l(o,u,s);return a.update(r),o.addOverlay(a),a};var e=l.prototype;e.draw=function(){if(this.enabled){var o=this.plot,r=this.selectBox,i=this.borderWidth,u=(this.innerFill,this.innerColor),s=(this.outerFill,this.outerColor),a=this.borderColor,c=o.box,f=o.screenBox,g=o.dataBox,d=o.viewBox,m=o.pixelRatio,y=(r[0]-g[0])*(d[2]-d[0])/(g[2]-g[0])+d[0],v=(r[1]-g[1])*(d[3]-d[1])/(g[3]-g[1])+d[1],T=(r[2]-g[0])*(d[2]-d[0])/(g[2]-g[0])+d[0],w=(r[3]-g[1])*(d[3]-d[1])/(g[3]-g[1])+d[1];if(y=Math.max(y,d[0]),v=Math.max(v,d[1]),T=Math.min(T,d[2]),w=Math.min(w,d[3]),!(T<y||w<v)){c.bind();var A=f[2]-f[0],E=f[3]-f[1];if(this.outerFill&&(c.drawBox(0,0,A,v,s),c.drawBox(0,v,y,w,s),c.drawBox(0,w,A,E,s),c.drawBox(T,v,A,w,s)),this.innerFill&&c.drawBox(y,v,T,w,u),i>0){var M=i*m;c.drawBox(y-M,v-M,T+M,v+M,a),c.drawBox(y-M,w-M,T+M,w+M,a),c.drawBox(y-M,v-M,y+M,w+M,a),c.drawBox(T-M,v-M,T+M,w+M,a)}}}},e.update=function(o){o=o||{},this.innerFill=!!o.innerFill,this.outerFill=!!o.outerFill,this.innerColor=(o.innerColor||[0,0,0,.5]).slice(),this.outerColor=(o.outerColor||[0,0,0,.5]).slice(),this.borderColor=(o.borderColor||[0,0,0,1]).slice(),this.borderWidth=o.borderWidth||0,this.selectBox=(o.selectBox||this.selectBox).slice()},e.dispose=function(){this.boxBuffer.dispose(),this.boxShader.dispose(),this.plot.removeOverlay(this)}},{"./lib/shaders":331,"gl-buffer":259,"gl-shader":335}],334:[function(n,z,q){"use strict";z.exports=function(i,u){var s=u[0],a=u[1],c=t(i,s,a,{}),f=h.mallocUint8(s*a*4);return new o(i,c,f)};var t=n("gl-fbo"),h=n("typedarray-pool"),p=n("ndarray"),l=n("bit-twiddle").nextPow2;function e(i,u,s,a,c){this.coord=[i,u],this.id=s,this.value=a,this.distance=c}function o(i,u,s){this.gl=i,this.fbo=u,this.buffer=s,this._readTimeout=null;var a=this;this._readCallback=function(){a.gl&&(u.bind(),i.readPixels(0,0,u.shape[0],u.shape[1],i.RGBA,i.UNSIGNED_BYTE,a.buffer),a._readTimeout=null)}}var r=o.prototype;Object.defineProperty(r,"shape",{get:function(){return this.gl?this.fbo.shape.slice():[0,0]},set:function(i){if(this.gl){this.fbo.shape=i;var u=this.fbo.shape[0],s=this.fbo.shape[1];if(s*u*4>this.buffer.length){h.free(this.buffer);for(var a=this.buffer=h.mallocUint8(l(s*u*4)),c=0;c<s*u*4;++c)a[c]=255}return i}}}),r.begin=function(){var i=this.gl;this.shape,i&&(this.fbo.bind(),i.clearColor(1,1,1,1),i.clear(i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT))},r.end=function(){var i=this.gl;i&&(i.bindFramebuffer(i.FRAMEBUFFER,null),this._readTimeout||clearTimeout(this._readTimeout),this._readTimeout=setTimeout(this._readCallback,1))},r.query=function(i,u,s){if(!this.gl)return null;var a=this.fbo.shape.slice();i|=0,u|=0,typeof s!="number"&&(s=1);var c=0|Math.min(Math.max(i-s,0),a[0]),f=0|Math.min(Math.max(i+s,0),a[0]),g=0|Math.min(Math.max(u-s,0),a[1]),d=0|Math.min(Math.max(u+s,0),a[1]);if(f<=c||d<=g)return null;var m=[f-c,d-g],y=p(this.buffer,[m[0],m[1],4],[4,4*a[0],1],4*(c+a[0]*g)),v=function(A,E,M){for(var b=1e8,_=-1,S=-1,C=A.shape[0],k=A.shape[1],L=0;L<C;L++)for(var I=0;I<k;I++){var R=A.get(L,I,0),V=A.get(L,I,1),O=A.get(L,I,2),J=A.get(L,I,3);if(R<255||V<255||O<255||J<255){var D=E-L,B=M-I,N=D*D+B*B;N<b&&(b=N,_=L,S=I)}}return[_,S,b]}(y.hi(m[0],m[1],1),s,s),T=v[0],w=v[1];return T<0||Math.pow(this.radius,2)<v[2]?null:new e(T+c|0,w+g|0,y.get(T,w,0),[y.get(T,w,1),y.get(T,w,2),y.get(T,w,3)],Math.sqrt(v[2]))},r.dispose=function(){this.gl&&(this.fbo.dispose(),h.free(this.buffer),this.gl=null,this._readTimeout&&clearTimeout(this._readTimeout))}},{"bit-twiddle":97,"gl-fbo":269,ndarray:495,"typedarray-pool":595}],335:[function(n,z,q){"use strict";var t=n("./lib/create-uniforms"),h=n("./lib/create-attributes"),p=n("./lib/reflect"),l=n("./lib/shader-cache"),e=n("./lib/runtime-reflect"),o=n("./lib/GLError");function r(s){this.gl=s,this.gl.lastAttribCount=0,this._vref=this._fref=this._relink=this.vertShader=this.fragShader=this.program=this.attributes=this.uniforms=this.types=null}var i=r.prototype;function u(s,a){return s.name<a.name?-1:1}i.bind=function(){var s;this.program||this._relink();var a=this.gl.getProgramParameter(this.program,this.gl.ACTIVE_ATTRIBUTES),c=this.gl.lastAttribCount;if(a>c)for(s=c;s<a;s++)this.gl.enableVertexAttribArray(s);else if(c>a)for(s=a;s<c;s++)this.gl.disableVertexAttribArray(s);this.gl.lastAttribCount=a,this.gl.useProgram(this.program)},i.dispose=function(){for(var s=this.gl.lastAttribCount,a=0;a<s;a++)this.gl.disableVertexAttribArray(a);this.gl.lastAttribCount=0,this._fref&&this._fref.dispose(),this._vref&&this._vref.dispose(),this.attributes=this.types=this.vertShader=this.fragShader=this.program=this._relink=this._fref=this._vref=null},i.update=function(s,a,c,f){if(!a||arguments.length===1){var g=s;s=g.vertex,a=g.fragment,c=g.uniforms,f=g.attributes}var d=this,m=d.gl,y=d._vref;d._vref=l.shader(m,m.VERTEX_SHADER,s),y&&y.dispose(),d.vertShader=d._vref.shader;var v=this._fref;if(d._fref=l.shader(m,m.FRAGMENT_SHADER,a),v&&v.dispose(),d.fragShader=d._fref.shader,!c||!f){var T=m.createProgram();if(m.attachShader(T,d.fragShader),m.attachShader(T,d.vertShader),m.linkProgram(T),!m.getProgramParameter(T,m.LINK_STATUS)){var w=m.getProgramInfoLog(T);throw new o(w,"Error linking program:"+w)}c=c||e.uniforms(m,T),f=f||e.attributes(m,T),m.deleteProgram(T)}(f=f.slice()).sort(u);var A,E=[],M=[],b=[];for(A=0;A<f.length;++A){var _=f[A];if(_.type.indexOf("mat")>=0){for(var S=0|_.type.charAt(_.type.length-1),C=new Array(S),k=0;k<S;++k)C[k]=b.length,M.push(_.name+"["+k+"]"),typeof _.location=="number"?b.push(_.location+k):Array.isArray(_.location)&&_.location.length===S&&typeof _.location[k]=="number"?b.push(0|_.location[k]):b.push(-1);E.push({name:_.name,type:_.type,locations:C})}else E.push({name:_.name,type:_.type,locations:[b.length]}),M.push(_.name),typeof _.location=="number"?b.push(0|_.location):b.push(-1)}var L=0;for(A=0;A<b.length;++A)if(b[A]<0){for(;b.indexOf(L)>=0;)L+=1;b[A]=L}var I=new Array(c.length);function R(){d.program=l.program(m,d._vref,d._fref,M,b);for(var V=0;V<c.length;++V)I[V]=m.getUniformLocation(d.program,c[V].name)}R(),d._relink=R,d.types={uniforms:p(c),attributes:p(f)},d.attributes=h(m,d,E,b),Object.defineProperty(d,"uniforms",t(m,d,c,I))},z.exports=function(s,a,c,f,g){var d=new r(s);return d.update(a,c,f,g),d}},{"./lib/GLError":336,"./lib/create-attributes":337,"./lib/create-uniforms":338,"./lib/reflect":339,"./lib/runtime-reflect":340,"./lib/shader-cache":341}],336:[function(n,z,q){function t(h,p,l){this.shortMessage=p||"",this.longMessage=l||"",this.rawError=h||"",this.message="gl-shader: "+(p||h||"")+(l?`
`+l:""),this.stack=new Error().stack}t.prototype=new Error,t.prototype.name="GLError",t.prototype.constructor=t,z.exports=t},{}],337:[function(n,z,q){"use strict";z.exports=function(o,r,i,u){for(var s={},a=0,c=i.length;a<c;++a){var f=i[a],g=f.name,d=f.type,m=f.locations;switch(d){case"bool":case"int":case"float":l(o,r,m[0],u,1,s,g);break;default:if(d.indexOf("vec")>=0){if((y=d.charCodeAt(d.length-1)-48)<2||y>4)throw new t("","Invalid data type for attribute "+g+": "+d);l(o,r,m[0],u,y,s,g)}else{if(!(d.indexOf("mat")>=0))throw new t("","Unknown data type for attribute "+g+": "+d);var y;if((y=d.charCodeAt(d.length-1)-48)<2||y>4)throw new t("","Invalid data type for attribute "+g+": "+d);e(o,r,m,u,y,s,g)}}}return s};var t=n("./GLError");function h(o,r,i,u,s,a){this._gl=o,this._wrapper=r,this._index=i,this._locations=u,this._dimension=s,this._constFunc=a}var p=h.prototype;function l(o,r,i,u,s,a,c){for(var f=["gl","v"],g=[],d=0;d<s;++d)f.push("x"+d),g.push("x"+d);f.push("if(x0.length===void 0){return gl.vertexAttrib"+s+"f(v,"+g.join()+")}else{return gl.vertexAttrib"+s+"fv(v,x0)}");var m=Function.apply(null,f),y=new h(o,r,i,u,s,m);Object.defineProperty(a,c,{set:function(v){return o.disableVertexAttribArray(u[i]),m(o,u[i],v),v},get:function(){return y},enumerable:!0})}function e(o,r,i,u,s,a,c){for(var f=new Array(s),g=new Array(s),d=0;d<s;++d)l(o,r,i[d],u,s,f,d),g[d]=f[d];Object.defineProperty(f,"location",{set:function(v){if(Array.isArray(v))for(var T=0;T<s;++T)g[T].location=v[T];else for(T=0;T<s;++T)g[T].location=v+T;return v},get:function(){for(var v=new Array(s),T=0;T<s;++T)v[T]=u[i[T]];return v},enumerable:!0}),f.pointer=function(v,T,w,A){v=v||o.FLOAT,T=!!T,w=w||s*s,A=A||0;for(var E=0;E<s;++E){var M=u[i[E]];o.vertexAttribPointer(M,s,v,T,w,A+E*s),o.enableVertexAttribArray(M)}};var m=new Array(s),y=o["vertexAttrib"+s+"fv"];Object.defineProperty(a,c,{set:function(v){for(var T=0;T<s;++T){var w=u[i[T]];if(o.disableVertexAttribArray(w),Array.isArray(v[0]))y.call(o,w,v[T]);else{for(var A=0;A<s;++A)m[A]=v[s*T+A];y.call(o,w,m)}}return v},get:function(){return f},enumerable:!0})}p.pointer=function(o,r,i,u){var s=this._gl,a=this._locations[this._index];s.vertexAttribPointer(a,this._dimension,o||s.FLOAT,!!r,i||0,u||0),s.enableVertexAttribArray(a)},p.set=function(o,r,i,u){return this._constFunc(this._locations[this._index],o,r,i,u)},Object.defineProperty(p,"location",{get:function(){return this._locations[this._index]},set:function(o){return o!==this._locations[this._index]&&(this._locations[this._index]=0|o,this._wrapper.program=null),0|o}})},{"./GLError":336}],338:[function(n,z,q){"use strict";var t=n("./reflect"),h=n("./GLError");function p(e){return new Function("y","return function(){return y}")(e)}function l(e,o){for(var r=new Array(e),i=0;i<e;++i)r[i]=o;return r}z.exports=function(e,o,r,i){function u(g,d,m){switch(m){case"bool":case"int":case"sampler2D":case"samplerCube":return"gl.uniform1i(locations["+d+"],obj"+g+")";case"float":return"gl.uniform1f(locations["+d+"],obj"+g+")";default:var y=m.indexOf("vec");if(!(0<=y&&y<=1&&m.length===4+y)){if(m.indexOf("mat")===0&&m.length===4){var v;if((v=m.charCodeAt(m.length-1)-48)<2||v>4)throw new h("","Invalid uniform dimension type for matrix "+name+": "+m);return"gl.uniformMatrix"+v+"fv(locations["+d+"],false,obj"+g+")"}throw new h("","Unknown uniform data type for "+name+": "+m)}if((v=m.charCodeAt(m.length-1)-48)<2||v>4)throw new h("","Invalid data type");switch(m.charAt(0)){case"b":case"i":return"gl.uniform"+v+"iv(locations["+d+"],obj"+g+")";case"v":return"gl.uniform"+v+"fv(locations["+d+"],obj"+g+")";default:throw new h("","Unrecognized data type for vector "+name+": "+m)}}}function s(g){for(var d=["return function updateProperty(obj){"],m=function A(E,M){if(typeof M!="object")return[[E,M]];var b=[];for(var _ in M){var S=M[_],C=E;parseInt(_)+""===_?C+="["+_+"]":C+="."+_,typeof S=="object"?b.push.apply(b,A(C,S)):b.push([C,S])}return b}("",g),y=0;y<m.length;++y){var v=m[y],T=v[0],w=v[1];i[w]&&d.push(u(T,w,r[w].type))}return d.push("return obj}"),new Function("gl","locations",d.join(`
`))(e,i)}function a(g,d,m){if(typeof m=="object"){var y=c(m);Object.defineProperty(g,d,{get:p(y),set:s(m),enumerable:!0,configurable:!1})}else i[m]?Object.defineProperty(g,d,{get:(v=m,new Function("gl","wrapper","locations","return function(){return gl.getUniform(wrapper.program,locations["+v+"])}")(e,o,i)),set:s(m),enumerable:!0,configurable:!1}):g[d]=function(T){switch(T){case"bool":return!1;case"int":case"sampler2D":case"samplerCube":case"float":return 0;default:var w=T.indexOf("vec");if(0<=w&&w<=1&&T.length===4+w){if((A=T.charCodeAt(T.length-1)-48)<2||A>4)throw new h("","Invalid data type");return T.charAt(0)==="b"?l(A,!1):l(A,0)}if(T.indexOf("mat")===0&&T.length===4){var A;if((A=T.charCodeAt(T.length-1)-48)<2||A>4)throw new h("","Invalid uniform dimension type for matrix "+name+": "+T);return l(A*A,0)}throw new h("","Unknown uniform data type for "+name+": "+T)}}(r[m].type);var v}function c(g){var d;if(Array.isArray(g)){d=new Array(g.length);for(var m=0;m<g.length;++m)a(d,m,g[m])}else for(var y in d={},g)a(d,y,g[y]);return d}var f=t(r,!0);return{get:p(c(f)),set:s(f),enumerable:!0,configurable:!0}}},{"./GLError":336,"./reflect":339}],339:[function(n,z,q){"use strict";z.exports=function(t,h){for(var p={},l=0;l<t.length;++l)for(var e=t[l].name.split("."),o=p,r=0;r<e.length;++r){var i=e[r].split("[");if(i.length>1){i[0]in o||(o[i[0]]=[]),o=o[i[0]];for(var u=1;u<i.length;++u){var s=parseInt(i[u]);u<i.length-1||r<e.length-1?(s in o||(u<i.length-1?o[s]=[]:o[s]={}),o=o[s]):o[s]=h?l:t[l].type}}else r<e.length-1?(i[0]in o||(o[i[0]]={}),o=o[i[0]]):o[i[0]]=h?l:t[l].type}return p}},{}],340:[function(n,z,q){"use strict";q.uniforms=function(l,e){for(var o=l.getProgramParameter(e,l.ACTIVE_UNIFORMS),r=[],i=0;i<o;++i){var u=l.getActiveUniform(e,i);if(u){var s=p(l,u.type);if(u.size>1)for(var a=0;a<u.size;++a)r.push({name:u.name.replace("[0]","["+a+"]"),type:s});else r.push({name:u.name,type:s})}}return r},q.attributes=function(l,e){for(var o=l.getProgramParameter(e,l.ACTIVE_ATTRIBUTES),r=[],i=0;i<o;++i){var u=l.getActiveAttrib(e,i);u&&r.push({name:u.name,type:p(l,u.type)})}return r};var t={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube"},h=null;function p(l,e){if(!h){var o=Object.keys(t);h={};for(var r=0;r<o.length;++r){var i=o[r];h[l[i]]=t[i]}}return h[e]}},{}],341:[function(n,z,q){"use strict";q.shader=function(u,s,a){return i(u).getShaderReference(s,a)},q.program=function(u,s,a,c,f){return i(u).getProgram(s,a,c,f)};var t=n("./GLError"),h=n("gl-format-compiler-error"),p=new(typeof WeakMap>"u"?n("weakmap-shim"):WeakMap),l=0;function e(u,s,a,c,f,g,d){this.id=u,this.src=s,this.type=a,this.shader=c,this.count=g,this.programs=[],this.cache=d}function o(u){this.gl=u,this.shaders=[{},{}],this.programs={}}e.prototype.dispose=function(){if(--this.count==0){for(var u=this.cache,s=u.gl,a=this.programs,c=0,f=a.length;c<f;++c){var g=u.programs[a[c]];g&&(delete u.programs[c],s.deleteProgram(g))}s.deleteShader(this.shader),delete u.shaders[this.type===s.FRAGMENT_SHADER|0][this.src]}};var r=o.prototype;function i(u){var s=p.get(u);return s||(s=new o(u),p.set(u,s)),s}r.getShaderReference=function(u,s){var a=this.gl,c=this.shaders[u===a.FRAGMENT_SHADER|0],f=c[s];if(f&&a.isShader(f.shader))f.count+=1;else{var g=function(d,m,y){var v=d.createShader(m);if(d.shaderSource(v,y),d.compileShader(v),!d.getShaderParameter(v,d.COMPILE_STATUS)){var T=d.getShaderInfoLog(v);try{var w=h(T,y,m)}catch(A){throw console.warn("Failed to format compiler error: "+A),new t(T,`Error compiling shader:
`+T)}throw new t(T,w.short,w.long)}return v}(a,u,s);f=c[s]=new e(l++,s,u,g,[],1,this)}return f},r.getProgram=function(u,s,a,c){var f=[u.id,s.id,a.join(":"),c.join(":")].join("@"),g=this.programs[f];return g&&this.gl.isProgram(g)||(this.programs[f]=g=function(d,m,y,v,T){var w=d.createProgram();d.attachShader(w,m),d.attachShader(w,y);for(var A=0;A<v.length;++A)d.bindAttribLocation(w,T[A],v[A]);if(d.linkProgram(w),!d.getProgramParameter(w,d.LINK_STATUS)){var E=d.getProgramInfoLog(w);throw new t(E,"Error linking program: "+E)}return w}(this.gl,u.shader,s.shader,a,c),u.programs.push(f),s.programs.push(f)),g}},{"./GLError":336,"gl-format-compiler-error":270,"weakmap-shim":605}],342:[function(n,z,q){"use strict";function t(p){this.plot=p,this.enable=[!0,!0,!1,!1],this.width=[1,1,1,1],this.color=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.center=[1/0,1/0]}z.exports=function(p,l){var e=new t(p);return e.update(l),p.addOverlay(e),e};var h=t.prototype;h.update=function(p){p=p||{},this.enable=(p.enable||[!0,!0,!1,!1]).slice(),this.width=(p.width||[1,1,1,1]).slice(),this.color=(p.color||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]).map(function(l){return l.slice()}),this.center=(p.center||[1/0,1/0]).slice(),this.plot.setOverlayDirty()},h.draw=function(){var p=this.enable,l=this.width,e=this.color,o=this.center,r=this.plot,i=r.line,u=r.dataBox,s=r.viewBox;if(i.bind(),u[0]<=o[0]&&o[0]<=u[2]&&u[1]<=o[1]&&o[1]<=u[3]){var a=s[0]+(o[0]-u[0])/(u[2]-u[0])*(s[2]-s[0]),c=s[1]+(o[1]-u[1])/(u[3]-u[1])*(s[3]-s[1]);p[0]&&i.drawLine(a,c,s[0],c,l[0],e[0]),p[1]&&i.drawLine(a,c,a,s[1],l[1],e[1]),p[2]&&i.drawLine(a,c,s[2],c,l[2],e[2]),p[3]&&i.drawLine(a,c,a,s[3],l[3],e[3])}},h.dispose=function(){this.plot.removeOverlay(this)}},{}],343:[function(n,z,q){arguments[4][257][0].apply(q,arguments)},{dup:257}],344:[function(n,z,q){"use strict";var t=n("glslify"),h=n("gl-shader"),p=t([`precision mediump float;
#define GLSLIFY 1

attribute vec3 position, color;
attribute float weight;

uniform mat4 model, view, projection;
uniform vec3 coordinates[3];
uniform vec4 colors[3];
uniform vec2 screenShape;
uniform float lineWidth;

varying vec4 fragColor;

void main() {
  vec3 vertexPosition = mix(coordinates[0],
    mix(coordinates[2], coordinates[1], 0.5 * (position + 1.0)), abs(position));

  vec4 clipPos = projection * view * model * vec4(vertexPosition, 1.0);
  vec2 clipOffset = (projection * view * model * vec4(color, 0.0)).xy;
  vec2 delta = weight * clipOffset * screenShape;
  vec2 lineOffset = normalize(vec2(delta.y, -delta.x)) / screenShape;

  gl_Position   = vec4(clipPos.xy + clipPos.w * 0.5 * lineWidth * lineOffset, clipPos.z, clipPos.w);
  fragColor     = color.x * colors[0] + color.y * colors[1] + color.z * colors[2];
}
`]),l=t([`precision mediump float;
#define GLSLIFY 1

varying vec4 fragColor;

void main() {
  gl_FragColor = fragColor;
}`]);z.exports=function(e){return h(e,p,l,null,[{name:"position",type:"vec3"},{name:"color",type:"vec3"},{name:"weight",type:"float"}])}},{"gl-shader":335,glslify:343}],345:[function(n,z,q){"use strict";var t=n("gl-buffer"),h=n("gl-vao"),p=n("./shaders/index");z.exports=function(s,a){var c=[];function f(v,T,w,A,E,M){var b=[v,T,w,0,0,0,1];b[A+3]=1,b[A]=E,c.push.apply(c,b),b[6]=-1,c.push.apply(c,b),b[A]=M,c.push.apply(c,b),c.push.apply(c,b),b[6]=1,c.push.apply(c,b),b[A]=E,c.push.apply(c,b)}f(0,0,0,0,0,1),f(0,0,0,1,0,1),f(0,0,0,2,0,1),f(1,0,0,1,-1,1),f(1,0,0,2,-1,1),f(0,1,0,0,-1,1),f(0,1,0,2,-1,1),f(0,0,1,0,-1,1),f(0,0,1,1,-1,1);var g=t(s,c),d=h(s,[{type:s.FLOAT,buffer:g,size:3,offset:0,stride:28},{type:s.FLOAT,buffer:g,size:3,offset:12,stride:28},{type:s.FLOAT,buffer:g,size:1,offset:24,stride:28}]),m=p(s);m.attributes.position.location=0,m.attributes.color.location=1,m.attributes.weight.location=2;var y=new e(s,g,d,m);return y.update(a),y};var l=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function e(s,a,c,f){this.gl=s,this.buffer=a,this.vao=c,this.shader=f,this.pixelRatio=1,this.bounds=[[-1e3,-1e3,-1e3],[1e3,1e3,1e3]],this.position=[0,0,0],this.lineWidth=[2,2,2],this.colors=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.enabled=[!0,!0,!0],this.drawSides=[!0,!0,!0],this.axes=null}var o=e.prototype,r=[0,0,0],i=[0,0,0],u=[0,0];o.isTransparent=function(){return!1},o.drawTransparent=function(s){},o.draw=function(s){var a=this.gl,c=this.vao,f=this.shader;c.bind(),f.bind();var g,d=s.model||l,m=s.view||l,y=s.projection||l;this.axes&&(g=this.axes.lastCubeProps.axis);for(var v=r,T=i,w=0;w<3;++w)g&&g[w]<0?(v[w]=this.bounds[0][w],T[w]=this.bounds[1][w]):(v[w]=this.bounds[1][w],T[w]=this.bounds[0][w]);for(u[0]=a.drawingBufferWidth,u[1]=a.drawingBufferHeight,f.uniforms.model=d,f.uniforms.view=m,f.uniforms.projection=y,f.uniforms.coordinates=[this.position,v,T],f.uniforms.colors=this.colors,f.uniforms.screenShape=u,w=0;w<3;++w)f.uniforms.lineWidth=this.lineWidth[w]*this.pixelRatio,this.enabled[w]&&(c.draw(a.TRIANGLES,6,6*w),this.drawSides[w]&&c.draw(a.TRIANGLES,12,18+12*w));c.unbind()},o.update=function(s){s&&("bounds"in s&&(this.bounds=s.bounds),"position"in s&&(this.position=s.position),"lineWidth"in s&&(this.lineWidth=s.lineWidth),"colors"in s&&(this.colors=s.colors),"enabled"in s&&(this.enabled=s.enabled),"drawSides"in s&&(this.drawSides=s.drawSides))},o.dispose=function(){this.vao.dispose(),this.buffer.dispose(),this.shader.dispose()}},{"./shaders/index":344,"gl-buffer":259,"gl-vao":358}],346:[function(n,z,q){var t=n("glslify"),h=t([`precision highp float;

precision highp float;
#define GLSLIFY 1

vec3 getOrthogonalVector(vec3 v) {
  // Return up-vector for only-z vector.
  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).
  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.
  // Assign z = 0, x = -b, y = a:
  // a*-b + b*a + c*0 = -ba + ba + 0 = 0
  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {
    return normalize(vec3(-v.y, v.x, 0.0));
  } else {
    return normalize(vec3(0.0, v.z, -v.y));
  }
}

// Calculate the tube vertex and normal at the given index.
//
// The returned vertex is for a tube ring with its center at origin, radius of length(d), pointing in the direction of d.
//
// Each tube segment is made up of a ring of vertices.
// These vertices are used to make up the triangles of the tube by connecting them together in the vertex array.
// The indexes of tube segments run from 0 to 8.
//
vec3 getTubePosition(vec3 d, float index, out vec3 normal) {
  float segmentCount = 8.0;

  float angle = 2.0 * 3.14159 * (index / segmentCount);

  vec3 u = getOrthogonalVector(d);
  vec3 v = normalize(cross(u, d));

  vec3 x = u * cos(angle) * length(d);
  vec3 y = v * sin(angle) * length(d);
  vec3 v3 = x + y;

  normal = normalize(v3);

  return v3;
}

attribute vec4 vector;
attribute vec4 color, position;
attribute vec2 uv;

uniform float vectorScale, tubeScale;
uniform mat4 model, view, projection, inverseModel;
uniform vec3 eyePosition, lightPosition;

varying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  // Scale the vector magnitude to stay constant with
  // model & view changes.
  vec3 normal;
  vec3 XYZ = getTubePosition(mat3(model) * (tubeScale * vector.w * normalize(vector.xyz)), position.w, normal);
  vec4 tubePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);

  //Lighting geometry parameters
  vec4 cameraCoordinate = view * tubePosition;
  cameraCoordinate.xyz /= cameraCoordinate.w;
  f_lightDirection = lightPosition - cameraCoordinate.xyz;
  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;
  f_normal = normalize((vec4(normal, 0.0) * inverseModel).xyz);

  // vec4 m_position  = model * vec4(tubePosition, 1.0);
  vec4 t_position  = view * tubePosition;
  gl_Position      = projection * t_position;

  f_color          = color;
  f_data           = tubePosition.xyz;
  f_position       = position.xyz;
  f_uv             = uv;
}
`]),p=t([`#extension GL_OES_standard_derivatives : enable

precision highp float;
#define GLSLIFY 1

float beckmannDistribution(float x, float roughness) {
  float NdotH = max(x, 0.0001);
  float cos2Alpha = NdotH * NdotH;
  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;
  float roughness2 = roughness * roughness;
  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;
  return exp(tan2Alpha / roughness2) / denom;
}

float cookTorranceSpecular(
  vec3 lightDirection,
  vec3 viewDirection,
  vec3 surfaceNormal,
  float roughness,
  float fresnel) {

  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);
  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);

  //Half angle vector
  vec3 H = normalize(lightDirection + viewDirection);

  //Geometric term
  float NdotH = max(dot(surfaceNormal, H), 0.0);
  float VdotH = max(dot(viewDirection, H), 0.000001);
  float LdotH = max(dot(lightDirection, H), 0.000001);
  float G1 = (2.0 * NdotH * VdotN) / VdotH;
  float G2 = (2.0 * NdotH * LdotN) / LdotH;
  float G = min(1.0, min(G1, G2));
  
  //Distribution term
  float D = beckmannDistribution(NdotH, roughness);

  //Fresnel term
  float F = pow(1.0 - VdotN, fresnel);

  //Multiply terms and done
  return  G * F * D / max(3.14159265 * VdotN, 0.000001);
}

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;
uniform sampler2D texture;

varying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;
  vec3 N = normalize(f_normal);
  vec3 L = normalize(f_lightDirection);
  vec3 V = normalize(f_eyeDirection);

  if(gl_FrontFacing) {
    N = -N;
  }

  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));
  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);

  vec4 surfaceColor = f_color * texture2D(texture, f_uv);
  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);

  gl_FragColor = litColor * opacity;
}
`]),l=t([`precision highp float;

precision highp float;
#define GLSLIFY 1

vec3 getOrthogonalVector(vec3 v) {
  // Return up-vector for only-z vector.
  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).
  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.
  // Assign z = 0, x = -b, y = a:
  // a*-b + b*a + c*0 = -ba + ba + 0 = 0
  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {
    return normalize(vec3(-v.y, v.x, 0.0));
  } else {
    return normalize(vec3(0.0, v.z, -v.y));
  }
}

// Calculate the tube vertex and normal at the given index.
//
// The returned vertex is for a tube ring with its center at origin, radius of length(d), pointing in the direction of d.
//
// Each tube segment is made up of a ring of vertices.
// These vertices are used to make up the triangles of the tube by connecting them together in the vertex array.
// The indexes of tube segments run from 0 to 8.
//
vec3 getTubePosition(vec3 d, float index, out vec3 normal) {
  float segmentCount = 8.0;

  float angle = 2.0 * 3.14159 * (index / segmentCount);

  vec3 u = getOrthogonalVector(d);
  vec3 v = normalize(cross(u, d));

  vec3 x = u * cos(angle) * length(d);
  vec3 y = v * sin(angle) * length(d);
  vec3 v3 = x + y;

  normal = normalize(v3);

  return v3;
}

attribute vec4 vector;
attribute vec4 position;
attribute vec4 id;

uniform mat4 model, view, projection;
uniform float tubeScale;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  vec3 normal;
  vec3 XYZ = getTubePosition(mat3(model) * (tubeScale * vector.w * normalize(vector.xyz)), position.w, normal);
  vec4 tubePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);

  gl_Position = projection * view * tubePosition;
  f_id        = id;
  f_position  = position.xyz;
}
`]),e=t([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3  clipBounds[2];
uniform float pickId;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;

  gl_FragColor = vec4(pickId, f_id.xyz);
}`]);q.meshShader={vertex:h,fragment:p,attributes:[{name:"position",type:"vec4"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"vector",type:"vec4"}]},q.pickShader={vertex:l,fragment:e,attributes:[{name:"position",type:"vec4"},{name:"id",type:"vec4"},{name:"vector",type:"vec4"}]}},{glslify:347}],347:[function(n,z,q){arguments[4][257][0].apply(q,arguments)},{dup:257}],348:[function(n,z,q){"use strict";var t=n("gl-vec3"),h=n("gl-vec4"),p=["xyz","xzy","yxz","yzx","zxy","zyx"],l=function(s,a,c,f){for(var g=0,d=0;d<s.length;d++)for(var m=s[d].velocities,y=0;y<m.length;y++)g=Math.max(g,t.length(m[y]));var v=s.map(function(k){return function(L,I,R,V){for(var O=L.points,J=L.velocities,D=L.divergences,B=[],N=[],F=[],H=[],j=[],G=[],W=0,Q=0,$=h.create(),ee=h.create(),ie=0;ie<O.length;ie++){var ae=O[ie],oe=J[ie],de=D[ie];I===0&&(de=.05*R),Q=t.length(oe)/V,$=h.create(),t.copy($,oe),$[3]=de;for(var le=0;le<8;le++)j[le]=[ae[0],ae[1],ae[2],le];if(H.length>0)for(le=0;le<8;le++){var fe=(le+1)%8;B.push(H[le],j[le],j[fe],j[fe],H[fe],H[le]),F.push(ee,$,$,$,ee,ee),G.push(W,Q,Q,Q,W,W);var ue=B.length;N.push([ue-6,ue-5,ue-4],[ue-3,ue-2,ue-1])}var we=H;H=j,j=we;var Ae=ee;ee=$,$=Ae;var Se=W;W=Q,Q=Se}return{positions:B,cells:N,vectors:F,vertexIntensity:G}}(k,c,f,g)}),T=[],w=[],A=[],E=[];for(d=0;d<v.length;d++){var M=v[d],b=T.length;for(T=T.concat(M.positions),A=A.concat(M.vectors),E=E.concat(M.vertexIntensity),y=0;y<M.cells.length;y++){var _=M.cells[y],S=[];w.push(S);for(var C=0;C<_.length;C++)S.push(_[C]+b)}}return{positions:T,cells:w,vectors:A,vertexIntensity:E,colormap:a}},e=function(s,a){var c,f=s.length;for(c=0;c<f;c++){var g=s[c];if(g===a)return c;if(g>a)return c-1}return c},o=function(s,a,c){return s<a?a:s>c?c:s},r=function(s){var a=1/0;s.sort(function(d,m){return d-m});for(var c=s.length,f=1;f<c;f++){var g=Math.abs(s[f]-s[f-1]);g<a&&(a=g)}return a};z.exports=function(s,a){var c=s.startingPositions,f=s.maxLength||1e3,g=s.tubeSize||1,d=s.absoluteTubeSize,m=s.gridFill||"+x+y+z",y={};m.indexOf("-x")!==-1&&(y.reversedX=!0),m.indexOf("-y")!==-1&&(y.reversedY=!0),m.indexOf("-z")!==-1&&(y.reversedZ=!0),y.filled=p.indexOf(m.replace(/-/g,"").replace(/\+/g,""));var v=s.getVelocity||function(ie){return function(ae,oe,de){var le=oe.vectors,fe=oe.meshgrid,ue=ae[0],we=ae[1],Ae=ae[2],Se=fe[0].length,ke=fe[1].length,Me=fe[2].length,ve=e(fe[0],ue),ge=e(fe[1],we),De=e(fe[2],Ae),_e=ve+1,Pe=ge+1,Fe=De+1;if(ve=o(ve,0,Se-1),_e=o(_e,0,Se-1),ge=o(ge,0,ke-1),Pe=o(Pe,0,ke-1),De=o(De,0,Me-1),Fe=o(Fe,0,Me-1),ve<0||ge<0||De<0||_e>Se-1||Pe>ke-1||Fe>Me-1)return t.create();var ze,He,et,Re,Ze,Ke,$e=fe[0][ve],rt=fe[0][_e],at=fe[1][ge],lt=fe[1][Pe],gt=fe[2][De],Ie=(ue-$e)/(rt-$e),be=(we-at)/(lt-at),We=(Ae-gt)/(fe[2][Fe]-gt);switch(isFinite(Ie)||(Ie=.5),isFinite(be)||(be=.5),isFinite(We)||(We=.5),de.reversedX&&(ve=Se-1-ve,_e=Se-1-_e),de.reversedY&&(ge=ke-1-ge,Pe=ke-1-Pe),de.reversedZ&&(De=Me-1-De,Fe=Me-1-Fe),de.filled){case 5:Ze=De,Ke=Fe,et=ge*Me,Re=Pe*Me,ze=ve*Me*ke,He=_e*Me*ke;break;case 4:Ze=De,Ke=Fe,ze=ve*Me,He=_e*Me,et=ge*Me*Se,Re=Pe*Me*Se;break;case 3:et=ge,Re=Pe,Ze=De*ke,Ke=Fe*ke,ze=ve*ke*Me,He=_e*ke*Me;break;case 2:et=ge,Re=Pe,ze=ve*ke,He=_e*ke,Ze=De*ke*Se,Ke=Fe*ke*Se;break;case 1:ze=ve,He=_e,Ze=De*Se,Ke=Fe*Se,et=ge*Se*Me,Re=Pe*Se*Me;break;default:ze=ve,He=_e,et=ge*Se,Re=Pe*Se,Ze=De*Se*ke,Ke=Fe*Se*ke}var Ge=le[ze+et+Ze],st=le[ze+et+Ke],ot=le[ze+Re+Ze],Ce=le[ze+Re+Ke],Ue=le[He+et+Ze],Ye=le[He+et+Ke],xe=le[He+Re+Ze],Ee=le[He+Re+Ke],Je=t.create(),it=t.create(),ht=t.create(),ct=t.create();t.lerp(Je,Ge,Ue,Ie),t.lerp(it,st,Ye,Ie),t.lerp(ht,ot,xe,Ie),t.lerp(ct,Ce,Ee,Ie);var mt=t.create(),bt=t.create();t.lerp(mt,Je,ht,be),t.lerp(bt,it,ct,be);var Et=t.create();return t.lerp(Et,mt,bt,We),Et}(ie,s,y)},T=s.getDivergence||function(ie,ae){var oe=t.create(),de=1e-4;t.add(oe,ie,[de,0,0]);var le=v(oe);t.subtract(le,le,ae),t.scale(le,le,1/de),t.add(oe,ie,[0,de,0]);var fe=v(oe);t.subtract(fe,fe,ae),t.scale(fe,fe,1/de),t.add(oe,ie,[0,0,de]);var ue=v(oe);return t.subtract(ue,ue,ae),t.scale(ue,ue,1/de),t.add(oe,le,fe),t.add(oe,oe,ue),oe},w=[],A=a[0][0],E=a[0][1],M=a[0][2],b=a[1][0],_=a[1][1],S=a[1][2],C=function(ie){var ae=ie[0],oe=ie[1],de=ie[2];return!(ae<A||ae>b||oe<E||oe>_||de<M||de>S)},k=10*t.distance(a[0],a[1])/f,L=k*k,I=1,R=0,V=c.length;V>1&&(I=function(ie){for(var ae=[],oe=[],de=[],le={},fe={},ue={},we=ie.length,Ae=0;Ae<we;Ae++){var Se=ie[Ae],ke=Se[0],Me=Se[1],ve=Se[2];le[ke]||(ae.push(ke),le[ke]=!0),fe[Me]||(oe.push(Me),fe[Me]=!0),ue[ve]||(de.push(ve),ue[ve]=!0)}var ge=r(ae),De=r(oe),_e=r(de),Pe=Math.min(ge,De,_e);return isFinite(Pe)?Pe:1}(c));for(var O=0;O<V;O++){var J=t.create();t.copy(J,c[O]);var D=[J],B=[],N=v(J),F=J;B.push(N);var H=[],j=T(J,N),G=t.length(j);isFinite(G)&&G>R&&(R=G),H.push(G),w.push({points:D,velocities:B,divergences:H});for(var W=0;W<100*f&&D.length<f&&C(J);){W++;var Q=t.clone(N),$=t.squaredLength(Q);if($===0)break;$>L&&t.scale(Q,Q,k/Math.sqrt($)),t.add(Q,Q,J),N=v(Q),t.squaredDistance(F,Q)-L>-1e-4*L&&(D.push(Q),F=Q,B.push(N),j=T(Q,N),G=t.length(j),isFinite(G)&&G>R&&(R=G),H.push(G)),J=Q}}var ee=l(w,s.colormap,R,I);return d?ee.tubeScale=d:(R===0&&(R=1),ee.tubeScale=.5*g*I/R),ee};var i=n("./lib/shaders"),u=n("gl-cone3d").createMesh;z.exports.createTubeMesh=function(s,a){return u(s,a,{shaders:i,traceType:"streamtube"})}},{"./lib/shaders":346,"gl-cone3d":260,"gl-vec3":377,"gl-vec4":413}],349:[function(n,z,q){var t=n("gl-shader"),h=n("glslify"),p=h([`precision highp float;
#define GLSLIFY 1

attribute vec4 uv;
attribute vec3 f;
attribute vec3 normal;

uniform vec3 objectOffset;
uniform mat4 model, view, projection, inverseModel;
uniform vec3 lightPosition, eyePosition;
uniform sampler2D colormap;

varying float value, kill;
varying vec3 worldCoordinate;
varying vec2 planeCoordinate;
varying vec3 lightDirection, eyeDirection, surfaceNormal;
varying vec4 vColor;

void main() {
  vec3 localCoordinate = vec3(uv.zw, f.x);
  worldCoordinate = objectOffset + localCoordinate;
  vec4 worldPosition = model * vec4(worldCoordinate, 1.0);
  vec4 clipPosition = projection * view * worldPosition;
  gl_Position = clipPosition;
  kill = f.y;
  value = f.z;
  planeCoordinate = uv.xy;

  vColor = texture2D(colormap, vec2(value, value));

  //Lighting geometry parameters
  vec4 cameraCoordinate = view * worldPosition;
  cameraCoordinate.xyz /= cameraCoordinate.w;
  lightDirection = lightPosition - cameraCoordinate.xyz;
  eyeDirection   = eyePosition - cameraCoordinate.xyz;
  surfaceNormal  = normalize((vec4(normal,0) * inverseModel).xyz);
}
`]),l=h([`precision highp float;
#define GLSLIFY 1

float beckmannDistribution(float x, float roughness) {
  float NdotH = max(x, 0.0001);
  float cos2Alpha = NdotH * NdotH;
  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;
  float roughness2 = roughness * roughness;
  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;
  return exp(tan2Alpha / roughness2) / denom;
}

float beckmannSpecular(
  vec3 lightDirection,
  vec3 viewDirection,
  vec3 surfaceNormal,
  float roughness) {
  return beckmannDistribution(dot(surfaceNormal, normalize(lightDirection + viewDirection)), roughness);
}

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 lowerBound, upperBound;
uniform float contourTint;
uniform vec4 contourColor;
uniform sampler2D colormap;
uniform vec3 clipBounds[2];
uniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;
uniform float vertexColor;

varying float value, kill;
varying vec3 worldCoordinate;
varying vec3 lightDirection, eyeDirection, surfaceNormal;
varying vec4 vColor;

void main() {
  if (
    kill > 0.0 ||
    vColor.a == 0.0 ||
    outOfRange(clipBounds[0], clipBounds[1], worldCoordinate)
  ) discard;

  vec3 N = normalize(surfaceNormal);
  vec3 V = normalize(eyeDirection);
  vec3 L = normalize(lightDirection);

  if(gl_FrontFacing) {
    N = -N;
  }

  float specular = max(beckmannSpecular(L, V, N, roughness), 0.);
  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);

  //decide how to interpolate color \u2014 in vertex or in fragment
  vec4 surfaceColor =
    step(vertexColor, .5) * texture2D(colormap, vec2(value, value)) +
    step(.5, vertexColor) * vColor;

  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);

  gl_FragColor = mix(litColor, contourColor, contourTint) * opacity;
}
`]),e=h([`precision highp float;
#define GLSLIFY 1

attribute vec4 uv;
attribute float f;

uniform vec3 objectOffset;
uniform mat3 permutation;
uniform mat4 model, view, projection;
uniform float height, zOffset;
uniform sampler2D colormap;

varying float value, kill;
varying vec3 worldCoordinate;
varying vec2 planeCoordinate;
varying vec3 lightDirection, eyeDirection, surfaceNormal;
varying vec4 vColor;

void main() {
  vec3 dataCoordinate = permutation * vec3(uv.xy, height);
  worldCoordinate = objectOffset + dataCoordinate;
  vec4 worldPosition = model * vec4(worldCoordinate, 1.0);

  vec4 clipPosition = projection * view * worldPosition;
  clipPosition.z += zOffset;

  gl_Position = clipPosition;
  value = f + objectOffset.z;
  kill = -1.0;
  planeCoordinate = uv.zw;

  vColor = texture2D(colormap, vec2(value, value));

  //Don't do lighting for contours
  surfaceNormal   = vec3(1,0,0);
  eyeDirection    = vec3(0,1,0);
  lightDirection  = vec3(0,0,1);
}
`]),o=h([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec2 shape;
uniform vec3 clipBounds[2];
uniform float pickId;

varying float value, kill;
varying vec3 worldCoordinate;
varying vec2 planeCoordinate;
varying vec3 surfaceNormal;

vec2 splitFloat(float v) {
  float vh = 255.0 * v;
  float upper = floor(vh);
  float lower = fract(vh);
  return vec2(upper / 255.0, floor(lower * 16.0) / 16.0);
}

void main() {
  if ((kill > 0.0) ||
      (outOfRange(clipBounds[0], clipBounds[1], worldCoordinate))) discard;

  vec2 ux = splitFloat(planeCoordinate.x / shape.x);
  vec2 uy = splitFloat(planeCoordinate.y / shape.y);
  gl_FragColor = vec4(pickId, ux.x, uy.x, ux.y + (uy.y/16.0));
}
`]);q.createShader=function(r){var i=t(r,p,l,null,[{name:"uv",type:"vec4"},{name:"f",type:"vec3"},{name:"normal",type:"vec3"}]);return i.attributes.uv.location=0,i.attributes.f.location=1,i.attributes.normal.location=2,i},q.createPickShader=function(r){var i=t(r,p,o,null,[{name:"uv",type:"vec4"},{name:"f",type:"vec3"},{name:"normal",type:"vec3"}]);return i.attributes.uv.location=0,i.attributes.f.location=1,i.attributes.normal.location=2,i},q.createContourShader=function(r){var i=t(r,e,l,null,[{name:"uv",type:"vec4"},{name:"f",type:"float"}]);return i.attributes.uv.location=0,i.attributes.f.location=1,i},q.createPickContourShader=function(r){var i=t(r,e,o,null,[{name:"uv",type:"vec4"},{name:"f",type:"float"}]);return i.attributes.uv.location=0,i.attributes.f.location=1,i}},{"gl-shader":335,glslify:350}],350:[function(n,z,q){arguments[4][257][0].apply(q,arguments)},{dup:257}],351:[function(n,z,q){"use strict";z.exports=function(N){var F=N.gl,H=m(F),j=v(F),G=y(F),W=T(F),Q=h(F),$=p(F,[{buffer:Q,size:4,stride:40,offset:0},{buffer:Q,size:3,stride:40,offset:16},{buffer:Q,size:3,stride:40,offset:28}]),ee=h(F),ie=p(F,[{buffer:ee,size:4,stride:20,offset:0},{buffer:ee,size:1,stride:20,offset:16}]),ae=h(F),oe=p(F,[{buffer:ae,size:2,type:F.FLOAT}]),de=l(F,1,256,F.RGBA,F.UNSIGNED_BYTE);de.minFilter=F.LINEAR,de.magFilter=F.LINEAR;var le=new b(F,[0,0],[[0,0,0],[0,0,0]],H,j,Q,$,de,G,W,ee,ie,ae,oe,[0,0,0]),fe={levels:[[],[],[]]};for(var ue in N)fe[ue]=N[ue];return fe.colormap=fe.colormap||"jet",le.update(fe),le};var t=n("bit-twiddle"),h=n("gl-buffer"),p=n("gl-vao"),l=n("gl-texture2d"),e=n("typedarray-pool"),o=n("colormap"),r=n("ndarray-ops"),i=n("ndarray-pack"),u=n("ndarray"),s=n("surface-nets"),a=n("gl-mat4/multiply"),c=n("gl-mat4/invert"),f=n("binary-search-bounds"),g=n("ndarray-gradient"),d=n("./lib/shaders"),m=d.createShader,y=d.createContourShader,v=d.createPickShader,T=d.createPickContourShader,w=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],A=[[0,0],[0,1],[1,0],[1,1],[1,0],[0,1]],E=[[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0]];function M(N,F,H,j,G){this.position=N,this.index=F,this.uv=H,this.level=j,this.dataCoordinate=G}(function(){for(var N=0;N<3;++N){var F=E[N],H=(N+2)%3;F[(N+1)%3+0]=1,F[H+3]=1,F[N+6]=1}})();function b(N,F,H,j,G,W,Q,$,ee,ie,ae,oe,de,le,fe){this.gl=N,this.shape=F,this.bounds=H,this.objectOffset=fe,this.intensityBounds=[],this._shader=j,this._pickShader=G,this._coordinateBuffer=W,this._vao=Q,this._colorMap=$,this._contourShader=ee,this._contourPickShader=ie,this._contourBuffer=ae,this._contourVAO=oe,this._contourOffsets=[[],[],[]],this._contourCounts=[[],[],[]],this._vertexCount=0,this._pickResult=new M([0,0,0],[0,0],[0,0],[0,0,0],[0,0,0]),this._dynamicBuffer=de,this._dynamicVAO=le,this._dynamicOffsets=[0,0,0],this._dynamicCounts=[0,0,0],this.contourWidth=[1,1,1],this.contourLevels=[[1],[1],[1]],this.contourTint=[0,0,0],this.contourColor=[[.5,.5,.5,1],[.5,.5,.5,1],[.5,.5,.5,1]],this.showContour=!0,this.showSurface=!0,this.enableHighlight=[!0,!0,!0],this.highlightColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.highlightTint=[1,1,1],this.highlightLevel=[-1,-1,-1],this.enableDynamic=[!0,!0,!0],this.dynamicLevel=[NaN,NaN,NaN],this.dynamicColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.dynamicTint=[1,1,1],this.dynamicWidth=[1,1,1],this.axesBounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.surfaceProject=[!1,!1,!1],this.contourProject=[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1]],this.colorBounds=[!1,!1],this._field=[u(e.mallocFloat(1024),[0,0]),u(e.mallocFloat(1024),[0,0]),u(e.mallocFloat(1024),[0,0])],this.pickId=1,this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.snapToData=!1,this.pixelRatio=1,this.opacity=1,this.lightPosition=[10,1e4,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.vertexColor=0,this.dirty=!0}var _=b.prototype;_.genColormap=function(N,F){var H=!1,j=i([o({colormap:N,nshades:256,format:"rgba"}).map(function(G,W){var Q=F?function($,ee){if(!ee||!ee.length)return 1;for(var ie=0;ie<ee.length;++ie){if(ee.length<2)return 1;if(ee[ie][0]===$)return ee[ie][1];if(ee[ie][0]>$&&ie>0){var ae=(ee[ie][0]-$)/(ee[ie][0]-ee[ie-1][0]);return ee[ie][1]*(1-ae)+ae*ee[ie-1][1]}}return 1}(W/255,F):G[3];return Q<1&&(H=!0),[G[0],G[1],G[2],255*Q]})]);return r.divseq(j,255),this.hasAlphaScale=H,j},_.isTransparent=function(){return this.opacity<1||this.hasAlphaScale},_.isOpaque=function(){return!this.isTransparent()},_.pickSlots=1,_.setPickBase=function(N){this.pickId=N};var S=[0,0,0],C={showSurface:!1,showContour:!1,projections:[w.slice(),w.slice(),w.slice()],clipBounds:[[[0,0,0],[0,0,0]],[[0,0,0],[0,0,0]],[[0,0,0],[0,0,0]]]};function k(N,F){var H,j,G,W=F.axes&&F.axes.lastCubeProps.axis||S,Q=F.showSurface,$=F.showContour;for(H=0;H<3;++H)for(Q=Q||F.surfaceProject[H],j=0;j<3;++j)$=$||F.contourProject[H][j];for(H=0;H<3;++H){var ee=C.projections[H];for(j=0;j<16;++j)ee[j]=0;for(j=0;j<4;++j)ee[5*j]=1;ee[5*H]=0,ee[12+H]=F.axesBounds[+(W[H]>0)][H],a(ee,N.model,ee);var ie=C.clipBounds[H];for(G=0;G<2;++G)for(j=0;j<3;++j)ie[G][j]=N.clipBounds[G][j];ie[0][H]=-1e8,ie[1][H]=1e8}return C.showSurface=Q,C.showContour=$,C}var L={model:w,view:w,projection:w,inverseModel:w.slice(),lowerBound:[0,0,0],upperBound:[0,0,0],colorMap:0,clipBounds:[[0,0,0],[0,0,0]],height:0,contourTint:0,contourColor:[0,0,0,1],permutation:[1,0,0,0,1,0,0,0,1],zOffset:-1e-4,objectOffset:[0,0,0],kambient:1,kdiffuse:1,kspecular:1,lightPosition:[1e3,1e3,1e3],eyePosition:[0,0,0],roughness:1,fresnel:1,opacity:1,vertexColor:0},I=w.slice(),R=[1,0,0,0,1,0,0,0,1];function V(N,F){N=N||{};var H=this.gl;H.disable(H.CULL_FACE),this._colorMap.bind(0);var j=L;j.model=N.model||w,j.view=N.view||w,j.projection=N.projection||w,j.lowerBound=[this.bounds[0][0],this.bounds[0][1],this.colorBounds[0]||this.bounds[0][2]],j.upperBound=[this.bounds[1][0],this.bounds[1][1],this.colorBounds[1]||this.bounds[1][2]],j.objectOffset=this.objectOffset,j.contourColor=this.contourColor[0],j.inverseModel=c(j.inverseModel,j.model);for(var G=0;G<2;++G)for(var W=j.clipBounds[G],Q=0;Q<3;++Q)W[Q]=Math.min(Math.max(this.clipBounds[G][Q],-1e8),1e8);j.kambient=this.ambientLight,j.kdiffuse=this.diffuseLight,j.kspecular=this.specularLight,j.roughness=this.roughness,j.fresnel=this.fresnel,j.opacity=this.opacity,j.height=0,j.permutation=R,j.vertexColor=this.vertexColor;var $=I;for(a($,j.view,j.model),a($,j.projection,$),c($,$),G=0;G<3;++G)j.eyePosition[G]=$[12+G]/$[15];var ee=$[15];for(G=0;G<3;++G)ee+=this.lightPosition[G]*$[4*G+3];for(G=0;G<3;++G){var ie=$[12+G];for(Q=0;Q<3;++Q)ie+=$[4*Q+G]*this.lightPosition[Q];j.lightPosition[G]=ie/ee}var ae=k(j,this);if(ae.showSurface){for(this._shader.bind(),this._shader.uniforms=j,this._vao.bind(),this.showSurface&&this._vertexCount&&this._vao.draw(H.TRIANGLES,this._vertexCount),G=0;G<3;++G)this.surfaceProject[G]&&this.vertexCount&&(this._shader.uniforms.model=ae.projections[G],this._shader.uniforms.clipBounds=ae.clipBounds[G],this._vao.draw(H.TRIANGLES,this._vertexCount));this._vao.unbind()}if(ae.showContour){var oe=this._contourShader;j.kambient=1,j.kdiffuse=0,j.kspecular=0,j.opacity=1,oe.bind(),oe.uniforms=j;var de=this._contourVAO;for(de.bind(),G=0;G<3;++G)for(oe.uniforms.permutation=E[G],H.lineWidth(this.contourWidth[G]*this.pixelRatio),Q=0;Q<this.contourLevels[G].length;++Q)Q===this.highlightLevel[G]?(oe.uniforms.contourColor=this.highlightColor[G],oe.uniforms.contourTint=this.highlightTint[G]):Q!==0&&Q-1!==this.highlightLevel[G]||(oe.uniforms.contourColor=this.contourColor[G],oe.uniforms.contourTint=this.contourTint[G]),this._contourCounts[G][Q]&&(oe.uniforms.height=this.contourLevels[G][Q],de.draw(H.LINES,this._contourCounts[G][Q],this._contourOffsets[G][Q]));for(G=0;G<3;++G)for(oe.uniforms.model=ae.projections[G],oe.uniforms.clipBounds=ae.clipBounds[G],Q=0;Q<3;++Q)if(this.contourProject[G][Q]){oe.uniforms.permutation=E[Q],H.lineWidth(this.contourWidth[Q]*this.pixelRatio);for(var le=0;le<this.contourLevels[Q].length;++le)le===this.highlightLevel[Q]?(oe.uniforms.contourColor=this.highlightColor[Q],oe.uniforms.contourTint=this.highlightTint[Q]):le!==0&&le-1!==this.highlightLevel[Q]||(oe.uniforms.contourColor=this.contourColor[Q],oe.uniforms.contourTint=this.contourTint[Q]),this._contourCounts[Q][le]&&(oe.uniforms.height=this.contourLevels[Q][le],de.draw(H.LINES,this._contourCounts[Q][le],this._contourOffsets[Q][le]))}for(de.unbind(),(de=this._dynamicVAO).bind(),G=0;G<3;++G)if(this._dynamicCounts[G]!==0)for(oe.uniforms.model=j.model,oe.uniforms.clipBounds=j.clipBounds,oe.uniforms.permutation=E[G],H.lineWidth(this.dynamicWidth[G]*this.pixelRatio),oe.uniforms.contourColor=this.dynamicColor[G],oe.uniforms.contourTint=this.dynamicTint[G],oe.uniforms.height=this.dynamicLevel[G],de.draw(H.LINES,this._dynamicCounts[G],this._dynamicOffsets[G]),Q=0;Q<3;++Q)this.contourProject[Q][G]&&(oe.uniforms.model=ae.projections[Q],oe.uniforms.clipBounds=ae.clipBounds[Q],de.draw(H.LINES,this._dynamicCounts[G],this._dynamicOffsets[G]));de.unbind()}}_.draw=function(N){return V.call(this,N,!1)},_.drawTransparent=function(N){return V.call(this,N,!0)};var O={model:w,view:w,projection:w,inverseModel:w,clipBounds:[[0,0,0],[0,0,0]],height:0,shape:[0,0],pickId:0,lowerBound:[0,0,0],upperBound:[0,0,0],zOffset:0,objectOffset:[0,0,0],permutation:[1,0,0,0,1,0,0,0,1],lightPosition:[0,0,0],eyePosition:[0,0,0]};function J(N,F){return Array.isArray(N)?[F(N[0]),F(N[1]),F(N[2])]:[F(N),F(N),F(N)]}function D(N){return Array.isArray(N)?N.length===3?[N[0],N[1],N[2],1]:[N[0],N[1],N[2],N[3]]:[0,0,0,1]}function B(N){if(Array.isArray(N)){if(Array.isArray(N))return[D(N[0]),D(N[1]),D(N[2])];var F=D(N);return[F.slice(),F.slice(),F.slice()]}}_.drawPick=function(N){N=N||{};var F=this.gl;F.disable(F.CULL_FACE);var H=O;H.model=N.model||w,H.view=N.view||w,H.projection=N.projection||w,H.shape=this._field[2].shape,H.pickId=this.pickId/255,H.lowerBound=this.bounds[0],H.upperBound=this.bounds[1],H.objectOffset=this.objectOffset,H.permutation=R;for(var j=0;j<2;++j)for(var G=H.clipBounds[j],W=0;W<3;++W)G[W]=Math.min(Math.max(this.clipBounds[j][W],-1e8),1e8);var Q=k(H,this);if(Q.showSurface){for(this._pickShader.bind(),this._pickShader.uniforms=H,this._vao.bind(),this._vao.draw(F.TRIANGLES,this._vertexCount),j=0;j<3;++j)this.surfaceProject[j]&&(this._pickShader.uniforms.model=Q.projections[j],this._pickShader.uniforms.clipBounds=Q.clipBounds[j],this._vao.draw(F.TRIANGLES,this._vertexCount));this._vao.unbind()}if(Q.showContour){var $=this._contourPickShader;$.bind(),$.uniforms=H;var ee=this._contourVAO;for(ee.bind(),W=0;W<3;++W)for(F.lineWidth(this.contourWidth[W]*this.pixelRatio),$.uniforms.permutation=E[W],j=0;j<this.contourLevels[W].length;++j)this._contourCounts[W][j]&&($.uniforms.height=this.contourLevels[W][j],ee.draw(F.LINES,this._contourCounts[W][j],this._contourOffsets[W][j]));for(j=0;j<3;++j)for($.uniforms.model=Q.projections[j],$.uniforms.clipBounds=Q.clipBounds[j],W=0;W<3;++W)if(this.contourProject[j][W]){$.uniforms.permutation=E[W],F.lineWidth(this.contourWidth[W]*this.pixelRatio);for(var ie=0;ie<this.contourLevels[W].length;++ie)this._contourCounts[W][ie]&&($.uniforms.height=this.contourLevels[W][ie],ee.draw(F.LINES,this._contourCounts[W][ie],this._contourOffsets[W][ie]))}ee.unbind()}},_.pick=function(N){if(!N||N.id!==this.pickId)return null;var F=this._field[2].shape,H=this._pickResult,j=F[0]*(N.value[0]+(N.value[2]>>4)/16)/255,G=Math.floor(j),W=j-G,Q=F[1]*(N.value[1]+(15&N.value[2])/16)/255,$=Math.floor(Q),ee=Q-$;G+=1,$+=1;var ie=H.position;ie[0]=ie[1]=ie[2]=0;for(var ae=0;ae<2;++ae)for(var oe=ae?W:1-W,de=0;de<2;++de)for(var le=G+ae,fe=$+de,ue=oe*(de?ee:1-ee),we=0;we<3;++we)ie[we]+=this._field[we].get(le,fe)*ue;for(var Ae=this._pickResult.level,Se=0;Se<3;++Se)if(Ae[Se]=f.le(this.contourLevels[Se],ie[Se]),Ae[Se]<0)this.contourLevels[Se].length>0&&(Ae[Se]=0);else if(Ae[Se]<this.contourLevels[Se].length-1){var ke=this.contourLevels[Se][Ae[Se]],Me=this.contourLevels[Se][Ae[Se]+1];Math.abs(ke-ie[Se])>Math.abs(Me-ie[Se])&&(Ae[Se]+=1)}for(H.index[0]=W<.5?G:G+1,H.index[1]=ee<.5?$:$+1,H.uv[0]=j/F[0],H.uv[1]=Q/F[1],we=0;we<3;++we)H.dataCoordinate[we]=this._field[we].get(H.index[0],H.index[1]);return H},_.padField=function(N,F){var H=F.shape.slice(),j=N.shape.slice();r.assign(N.lo(1,1).hi(H[0],H[1]),F),r.assign(N.lo(1).hi(H[0],1),F.hi(H[0],1)),r.assign(N.lo(1,j[1]-1).hi(H[0],1),F.lo(0,H[1]-1).hi(H[0],1)),r.assign(N.lo(0,1).hi(1,H[1]),F.hi(1)),r.assign(N.lo(j[0]-1,1).hi(1,H[1]),F.lo(H[0]-1)),N.set(0,0,F.get(0,0)),N.set(0,j[1]-1,F.get(0,H[1]-1)),N.set(j[0]-1,0,F.get(H[0]-1,0)),N.set(j[0]-1,j[1]-1,F.get(H[0]-1,H[1]-1))},_.update=function(N){N=N||{},this.objectOffset=N.objectOffset||this.objectOffset,this.dirty=!0,"contourWidth"in N&&(this.contourWidth=J(N.contourWidth,Number)),"showContour"in N&&(this.showContour=J(N.showContour,Boolean)),"showSurface"in N&&(this.showSurface=!!N.showSurface),"contourTint"in N&&(this.contourTint=J(N.contourTint,Boolean)),"contourColor"in N&&(this.contourColor=B(N.contourColor)),"contourProject"in N&&(this.contourProject=J(N.contourProject,function(wt){return J(wt,Boolean)})),"surfaceProject"in N&&(this.surfaceProject=N.surfaceProject),"dynamicColor"in N&&(this.dynamicColor=B(N.dynamicColor)),"dynamicTint"in N&&(this.dynamicTint=J(N.dynamicTint,Number)),"dynamicWidth"in N&&(this.dynamicWidth=J(N.dynamicWidth,Number)),"opacity"in N&&(this.opacity=N.opacity),"opacityscale"in N&&(this.opacityscale=N.opacityscale),"colorBounds"in N&&(this.colorBounds=N.colorBounds),"vertexColor"in N&&(this.vertexColor=N.vertexColor?1:0),"colormap"in N&&this._colorMap.setPixels(this.genColormap(N.colormap,this.opacityscale));var F=N.field||N.coords&&N.coords[2]||null,H=!1;if(F||(F=this._field[2].shape[0]||this._field[2].shape[2]?this._field[2].lo(1,1).hi(this._field[2].shape[0]-2,this._field[2].shape[1]-2):this._field[2].hi(0,0)),"field"in N||"coords"in N){var j=(F.shape[0]+2)*(F.shape[1]+2);j>this._field[2].data.length&&(e.freeFloat(this._field[2].data),this._field[2].data=e.mallocFloat(t.nextPow2(j))),this._field[2]=u(this._field[2].data,[F.shape[0]+2,F.shape[1]+2]),this.padField(this._field[2],F),this.shape=F.shape.slice();for(var G=this.shape,W=0;W<2;++W)this._field[2].size>this._field[W].data.length&&(e.freeFloat(this._field[W].data),this._field[W].data=e.mallocFloat(this._field[2].size)),this._field[W]=u(this._field[W].data,[G[0]+2,G[1]+2]);if(N.coords){var Q=N.coords;if(!Array.isArray(Q)||Q.length!==3)throw new Error("gl-surface: invalid coordinates for x/y");for(W=0;W<2;++W){var $=Q[W];for(de=0;de<2;++de)if($.shape[de]!==G[de])throw new Error("gl-surface: coords have incorrect shape");this.padField(this._field[W],$)}}else if(N.ticks){var ee=N.ticks;if(!Array.isArray(ee)||ee.length!==2)throw new Error("gl-surface: invalid ticks");for(W=0;W<2;++W){var ie=ee[W];if((Array.isArray(ie)||ie.length)&&(ie=u(ie)),ie.shape[0]!==G[W])throw new Error("gl-surface: invalid tick length");var ae=u(ie.data,G);ae.stride[W]=ie.stride[0],ae.stride[1^W]=0,this.padField(this._field[W],ae)}}else{for(W=0;W<2;++W){var oe=[0,0];oe[W]=1,this._field[W]=u(this._field[W].data,[G[0]+2,G[1]+2],oe,0)}this._field[0].set(0,0,0);for(var de=0;de<G[0];++de)this._field[0].set(de+1,0,de);for(this._field[0].set(G[0]+1,0,G[0]-1),this._field[1].set(0,0,0),de=0;de<G[1];++de)this._field[1].set(0,de+1,de);this._field[1].set(0,G[1]+1,G[1]-1)}var le=this._field,fe=u(e.mallocFloat(3*le[2].size*2),[3,G[0]+2,G[1]+2,2]);for(W=0;W<3;++W)g(fe.pick(W),le[W],"mirror");var ue=u(e.mallocFloat(3*le[2].size),[G[0]+2,G[1]+2,3]);for(W=0;W<G[0]+2;++W)for(de=0;de<G[1]+2;++de){var we=fe.get(0,W,de,0),Ae=fe.get(0,W,de,1),Se=fe.get(1,W,de,0),ke=fe.get(1,W,de,1),Me=fe.get(2,W,de,0),ve=fe.get(2,W,de,1),ge=Se*ve-ke*Me,De=Me*Ae-ve*we,_e=we*ke-Ae*Se,Pe=Math.sqrt(ge*ge+De*De+_e*_e);Pe<1e-8?(Pe=Math.max(Math.abs(ge),Math.abs(De),Math.abs(_e)))<1e-8?(_e=1,De=ge=0,Pe=1):Pe=1/Pe:Pe=1/Math.sqrt(Pe),ue.set(W,de,0,ge*Pe),ue.set(W,de,1,De*Pe),ue.set(W,de,2,_e*Pe)}e.free(fe.data);var Fe=[1/0,1/0,1/0],ze=[-1/0,-1/0,-1/0],He=1/0,et=-1/0,Re=(G[0]-1)*(G[1]-1)*6,Ze=e.mallocFloat(t.nextPow2(10*Re)),Ke=0,$e=0;for(W=0;W<G[0]-1;++W)e:for(de=0;de<G[1]-1;++de){for(var rt=0;rt<2;++rt)for(var at=0;at<2;++at)for(var lt=0;lt<3;++lt){var gt=this._field[lt].get(1+W+rt,1+de+at);if(isNaN(gt)||!isFinite(gt))continue e}for(lt=0;lt<6;++lt){var Ie=W+A[lt][0],be=de+A[lt][1],We=this._field[0].get(Ie+1,be+1),Ge=this._field[1].get(Ie+1,be+1);gt=this._field[2].get(Ie+1,be+1),ge=ue.get(Ie+1,be+1,0),De=ue.get(Ie+1,be+1,1),_e=ue.get(Ie+1,be+1,2),N.intensity&&(st=N.intensity.get(Ie,be));var st=N.intensity?N.intensity.get(Ie,be):gt+this.objectOffset[2];Ze[Ke++]=Ie,Ze[Ke++]=be,Ze[Ke++]=We,Ze[Ke++]=Ge,Ze[Ke++]=gt,Ze[Ke++]=0,Ze[Ke++]=st,Ze[Ke++]=ge,Ze[Ke++]=De,Ze[Ke++]=_e,Fe[0]=Math.min(Fe[0],We+this.objectOffset[0]),Fe[1]=Math.min(Fe[1],Ge+this.objectOffset[1]),Fe[2]=Math.min(Fe[2],gt+this.objectOffset[2]),He=Math.min(He,st),ze[0]=Math.max(ze[0],We+this.objectOffset[0]),ze[1]=Math.max(ze[1],Ge+this.objectOffset[1]),ze[2]=Math.max(ze[2],gt+this.objectOffset[2]),et=Math.max(et,st),$e+=1}}for(N.intensityBounds&&(He=+N.intensityBounds[0],et=+N.intensityBounds[1]),W=6;W<Ke;W+=10)Ze[W]=(Ze[W]-He)/(et-He);this._vertexCount=$e,this._coordinateBuffer.update(Ze.subarray(0,Ke)),e.freeFloat(Ze),e.free(ue.data),this.bounds=[Fe,ze],this.intensity=N.intensity||this._field[2],this.intensityBounds[0]===He&&this.intensityBounds[1]===et||(H=!0),this.intensityBounds=[He,et]}if("levels"in N){var ot=N.levels;for(ot=Array.isArray(ot[0])?ot.slice():[[],[],ot],W=0;W<3;++W)ot[W]=ot[W].slice(),ot[W].sort(function(wt,Bt){return wt-Bt});for(W=0;W<3;++W)for(de=0;de<ot[W].length;++de)ot[W][de]-=this.objectOffset[W];e:for(W=0;W<3;++W){if(ot[W].length!==this.contourLevels[W].length){H=!0;break}for(de=0;de<ot[W].length;++de)if(ot[W][de]!==this.contourLevels[W][de]){H=!0;break e}}this.contourLevels=ot}if(H){le=this._field,G=this.shape;for(var Ce=[],Ue=0;Ue<3;++Ue){var Ye=this.contourLevels[Ue],xe=[],Ee=[],Je=[0,0,0];for(W=0;W<Ye.length;++W){var it=s(this._field[Ue],Ye[W]);xe.push(Ce.length/5|0),$e=0;e:for(de=0;de<it.cells.length;++de){var ht=it.cells[de];for(lt=0;lt<2;++lt){var ct=it.positions[ht[lt]],mt=ct[0],bt=0|Math.floor(mt),Et=mt-bt,Mt=ct[1],_t=0|Math.floor(Mt),xt=Mt-_t,At=!1;t:for(var It=0;It<3;++It){Je[It]=0;var Nt=(Ue+It+1)%3;for(rt=0;rt<2;++rt){var Ot=rt?Et:1-Et;for(Ie=0|Math.min(Math.max(bt+rt,0),G[0]),at=0;at<2;++at){var Yt=at?xt:1-xt;if(be=0|Math.min(Math.max(_t+at,0),G[1]),gt=It<2?this._field[Nt].get(Ie,be):(this.intensity.get(Ie,be)-this.intensityBounds[0])/(this.intensityBounds[1]-this.intensityBounds[0]),!isFinite(gt)||isNaN(gt)){At=!0;break t}var Pt=Ot*Yt;Je[It]+=Pt*gt}}}if(At){if(lt>0){for(var Ne=0;Ne<5;++Ne)Ce.pop();$e-=1}continue e}Ce.push(Je[0],Je[1],ct[0],ct[1],Je[2]),$e+=1}}Ee.push($e)}this._contourOffsets[Ue]=xe,this._contourCounts[Ue]=Ee}var ut=e.mallocFloat(Ce.length);for(W=0;W<Ce.length;++W)ut[W]=Ce[W];this._contourBuffer.update(ut),e.freeFloat(ut)}},_.dispose=function(){this._shader.dispose(),this._vao.dispose(),this._coordinateBuffer.dispose(),this._colorMap.dispose(),this._contourBuffer.dispose(),this._contourVAO.dispose(),this._contourShader.dispose(),this._contourPickShader.dispose(),this._dynamicBuffer.dispose(),this._dynamicVAO.dispose();for(var N=0;N<3;++N)e.freeFloat(this._field[N].data)},_.highlight=function(N){var F,H;if(!N)return this._dynamicCounts=[0,0,0],this.dyanamicLevel=[NaN,NaN,NaN],void(this.highlightLevel=[-1,-1,-1]);for(F=0;F<3;++F)this.enableHighlight[F]?this.highlightLevel[F]=N.level[F]:this.highlightLevel[F]=-1;for(H=this.snapToData?N.dataCoordinate:N.position,F=0;F<3;++F)H[F]-=this.objectOffset[F];if(this.enableDynamic[0]&&H[0]!==this.dynamicLevel[0]||this.enableDynamic[1]&&H[1]!==this.dynamicLevel[1]||this.enableDynamic[2]&&H[2]!==this.dynamicLevel[2]){for(var j=0,G=this.shape,W=e.mallocFloat(12*G[0]*G[1]),Q=0;Q<3;++Q)if(this.enableDynamic[Q]){this.dynamicLevel[Q]=H[Q];var $=(Q+1)%3,ee=(Q+2)%3,ie=this._field[Q],ae=this._field[$],oe=this._field[ee],de=s(ie,H[Q]),le=de.cells,fe=de.positions;for(this._dynamicOffsets[Q]=j,F=0;F<le.length;++F)for(var ue=le[F],we=0;we<2;++we){var Ae=fe[ue[we]],Se=+Ae[0],ke=0|Se,Me=0|Math.min(ke+1,G[0]),ve=Se-ke,ge=1-ve,De=+Ae[1],_e=0|De,Pe=0|Math.min(_e+1,G[1]),Fe=De-_e,ze=1-Fe,He=ge*ze,et=ge*Fe,Re=ve*ze,Ze=ve*Fe,Ke=He*ae.get(ke,_e)+et*ae.get(ke,Pe)+Re*ae.get(Me,_e)+Ze*ae.get(Me,Pe),$e=He*oe.get(ke,_e)+et*oe.get(ke,Pe)+Re*oe.get(Me,_e)+Ze*oe.get(Me,Pe);if(isNaN(Ke)||isNaN($e)){we&&(j-=1);break}W[2*j+0]=Ke,W[2*j+1]=$e,j+=1}this._dynamicCounts[Q]=j-this._dynamicOffsets[Q]}else this.dynamicLevel[Q]=NaN,this._dynamicCounts[Q]=0;this._dynamicBuffer.update(W.subarray(0,2*j)),e.freeFloat(W)}}},{"./lib/shaders":349,"binary-search-bounds":96,"bit-twiddle":97,colormap:131,"gl-buffer":259,"gl-mat4/invert":293,"gl-mat4/multiply":295,"gl-texture2d":353,"gl-vao":358,ndarray:495,"ndarray-gradient":488,"ndarray-ops":490,"ndarray-pack":491,"surface-nets":570,"typedarray-pool":595}],352:[function(n,z,q){"use strict";var t=n("css-font"),h=n("pick-by-alias"),p=n("regl"),l=n("gl-util/context"),e=n("es6-weak-map"),o=n("color-normalize"),r=n("font-atlas"),i=n("typedarray-pool"),u=n("parse-rect"),s=n("is-plain-obj"),a=n("parse-unit"),c=n("to-px"),f=n("detect-kerning"),g=n("object-assign"),d=n("font-measure"),m=n("flatten-vertex-data"),y=n("bit-twiddle").nextPow2,v=new e,T=!1;if(document.body){var w=document.body.appendChild(document.createElement("div"));w.style.font="italic small-caps bold condensed 16px/2 cursive",getComputedStyle(w).fontStretch&&(T=!0),document.body.removeChild(w)}var A=function(E){(function(M){return typeof M=="function"&&M._gl&&M.prop&&M.texture&&M.buffer})(E)?(E={regl:E},this.gl=E.regl._gl):this.gl=l(E),this.shader=v.get(this.gl),this.shader?this.regl=this.shader.regl:this.regl=E.regl||p({gl:this.gl}),this.charBuffer=this.regl.buffer({type:"uint8",usage:"stream"}),this.sizeBuffer=this.regl.buffer({type:"float",usage:"stream"}),this.shader||(this.shader=this.createShader(),v.set(this.gl,this.shader)),this.batch=[],this.fontSize=[],this.font=[],this.fontAtlas=[],this.draw=this.shader.draw.bind(this),this.render=function(){this.regl._refresh(),this.draw(this.batch)},this.canvas=this.gl.canvas,this.update(s(E)?E:{})};A.prototype.createShader=function(){var E=this.regl,M=E({blend:{enable:!0,color:[0,0,0,1],func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},stencil:{enable:!1},depth:{enable:!1},count:E.prop("count"),offset:E.prop("offset"),attributes:{charOffset:{offset:4,stride:8,buffer:E.this("sizeBuffer")},width:{offset:0,stride:8,buffer:E.this("sizeBuffer")},char:E.this("charBuffer"),position:E.this("position")},uniforms:{atlasSize:function(b,_){return[_.atlas.width,_.atlas.height]},atlasDim:function(b,_){return[_.atlas.cols,_.atlas.rows]},atlas:function(b,_){return _.atlas.texture},charStep:function(b,_){return _.atlas.step},em:function(b,_){return _.atlas.em},color:E.prop("color"),opacity:E.prop("opacity"),viewport:E.this("viewportArray"),scale:E.this("scale"),align:E.prop("align"),baseline:E.prop("baseline"),translate:E.this("translate"),positionOffset:E.prop("positionOffset")},primitive:"points",viewport:E.this("viewport"),vert:`
			precision highp float;
			attribute float width, charOffset, char;
			attribute vec2 position;
			uniform float fontSize, charStep, em, align, baseline;
			uniform vec4 viewport;
			uniform vec4 color;
			uniform vec2 atlasSize, atlasDim, scale, translate, positionOffset;
			varying vec2 charCoord, charId;
			varying float charWidth;
			varying vec4 fontColor;
			void main () {
				`+(A.normalViewport?"":"vec2 positionOffset = vec2(positionOffset.x,- positionOffset.y);")+`

				vec2 offset = floor(em * (vec2(align + charOffset, baseline)
					+ positionOffset))
					/ (viewport.zw * scale.xy);

				vec2 position = (position + translate) * scale;
				position += offset * scale;

				`+(A.normalViewport?"position.y = 1. - position.y;":"")+`

				charCoord = position * viewport.zw + viewport.xy;

				gl_Position = vec4(position * 2. - 1., 0, 1);

				gl_PointSize = charStep;

				charId.x = mod(char, atlasDim.x);
				charId.y = floor(char / atlasDim.x);

				charWidth = width * em;

				fontColor = color / 255.;
			}`,frag:`
			precision highp float;
			uniform sampler2D atlas;
			uniform float fontSize, charStep, opacity;
			uniform vec2 atlasSize;
			uniform vec4 viewport;
			varying vec4 fontColor;
			varying vec2 charCoord, charId;
			varying float charWidth;

			float lightness(vec4 color) {
				return color.r * 0.299 + color.g * 0.587 + color.b * 0.114;
			}

			void main () {
				vec2 uv = gl_FragCoord.xy - charCoord + charStep * .5;
				float halfCharStep = floor(charStep * .5 + .5);

				// invert y and shift by 1px (FF expecially needs that)
				uv.y = charStep - uv.y;

				// ignore points outside of character bounding box
				float halfCharWidth = ceil(charWidth * .5);
				if (floor(uv.x) > halfCharStep + halfCharWidth ||
					floor(uv.x) < halfCharStep - halfCharWidth) return;

				uv += charId * charStep;
				uv = uv / atlasSize;

				vec4 color = fontColor;
				vec4 mask = texture2D(atlas, uv);

				float maskY = lightness(mask);
				// float colorY = lightness(color);
				color.a *= maskY;
				color.a *= opacity;

				// color.a += .1;

				// antialiasing, see yiq color space y-channel formula
				// color.rgb += (1. - color.rgb) * (1. - mask.rgb);

				gl_FragColor = color;
			}`});return{regl:E,draw:M,atlas:{}}},A.prototype.update=function(E){var M=this;if(typeof E=="string")E={text:E};else if(!E)return;(E=h(E,{position:"position positions coord coords coordinates",font:"font fontFace fontface typeface cssFont css-font family fontFamily",fontSize:"fontSize fontsize size font-size",text:"text texts chars characters value values symbols",align:"align alignment textAlign textbaseline",baseline:"baseline textBaseline textbaseline",direction:"dir direction textDirection",color:"color colour fill fill-color fillColor textColor textcolor",kerning:"kerning kern",range:"range dataBox",viewport:"vp viewport viewBox viewbox viewPort",opacity:"opacity alpha transparency visible visibility opaque",offset:"offset positionOffset padding shift indent indentation"},!0)).opacity!=null&&(Array.isArray(E.opacity)?this.opacity=E.opacity.map(function(ge){return parseFloat(ge)}):this.opacity=parseFloat(E.opacity)),E.viewport!=null&&(this.viewport=u(E.viewport),A.normalViewport&&(this.viewport.y=this.canvas.height-this.viewport.y-this.viewport.height),this.viewportArray=[this.viewport.x,this.viewport.y,this.viewport.width,this.viewport.height]),this.viewport==null&&(this.viewport={x:0,y:0,width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight},this.viewportArray=[this.viewport.x,this.viewport.y,this.viewport.width,this.viewport.height]),E.kerning!=null&&(this.kerning=E.kerning),E.offset!=null&&(typeof E.offset=="number"&&(E.offset=[E.offset,0]),this.positionOffset=m(E.offset)),E.direction&&(this.direction=E.direction),E.range&&(this.range=E.range,this.scale=[1/(E.range[2]-E.range[0]),1/(E.range[3]-E.range[1])],this.translate=[-E.range[0],-E.range[1]]),E.scale&&(this.scale=E.scale),E.translate&&(this.translate=E.translate),this.scale||(this.scale=[1/this.viewport.width,1/this.viewport.height]),this.translate||(this.translate=[0,0]),this.font.length||E.font||(E.font=A.baseFontSize+"px sans-serif");var b,_=!1,S=!1;if(E.font&&(Array.isArray(E.font)?E.font:[E.font]).forEach(function(ge,De){if(typeof ge=="string")try{ge=t.parse(ge)}catch{ge=t.parse(A.baseFontSize+"px "+ge)}else ge=t.parse(t.stringify(ge));var _e=t.stringify({size:A.baseFontSize,family:ge.family,stretch:T?ge.stretch:void 0,variant:ge.variant,weight:ge.weight,style:ge.style}),Pe=a(ge.size),Fe=Math.round(Pe[0]*c(Pe[1]));if(Fe!==M.fontSize[De]&&(S=!0,M.fontSize[De]=Fe),!(M.font[De]&&_e==M.font[De].baseString||(_=!0,M.font[De]=A.fonts[_e],M.font[De]))){var ze=ge.family.join(", "),He=[ge.style];ge.style!=ge.variant&&He.push(ge.variant),ge.variant!=ge.weight&&He.push(ge.weight),T&&ge.weight!=ge.stretch&&He.push(ge.stretch),M.font[De]={baseString:_e,family:ze,weight:ge.weight,stretch:ge.stretch,style:ge.style,variant:ge.variant,width:{},kerning:{},metrics:d(ze,{origin:"top",fontSize:A.baseFontSize,fontStyle:He.join(" ")})},A.fonts[_e]=M.font[De]}}),(_||S)&&this.font.forEach(function(ge,De){var _e=t.stringify({size:M.fontSize[De],family:ge.family,stretch:T?ge.stretch:void 0,variant:ge.variant,weight:ge.weight,style:ge.style});if(M.fontAtlas[De]=M.shader.atlas[_e],!M.fontAtlas[De]){var Pe=ge.metrics;M.shader.atlas[_e]=M.fontAtlas[De]={fontString:_e,step:2*Math.ceil(M.fontSize[De]*Pe.bottom*.5),em:M.fontSize[De],cols:0,rows:0,height:0,width:0,chars:[],ids:{},texture:M.regl.texture()}}E.text==null&&(E.text=M.text)}),typeof E.text=="string"&&E.position&&E.position.length>2){for(var C=Array(.5*E.position.length),k=0;k<C.length;k++)C[k]=E.text;E.text=C}if(E.text!=null||_){if(this.textOffsets=[0],Array.isArray(E.text)){this.count=E.text[0].length,this.counts=[this.count];for(var L=1;L<E.text.length;L++)this.textOffsets[L]=this.textOffsets[L-1]+E.text[L-1].length,this.count+=E.text[L].length,this.counts.push(E.text[L].length);this.text=E.text.join("")}else this.text=E.text,this.count=this.text.length,this.counts=[this.count];b=[],this.font.forEach(function(ge,De){A.atlasContext.font=ge.baseString;for(var _e=M.fontAtlas[De],Pe=0;Pe<M.text.length;Pe++){var Fe=M.text.charAt(Pe);if(_e.ids[Fe]==null&&(_e.ids[Fe]=_e.chars.length,_e.chars.push(Fe),b.push(Fe)),ge.width[Fe]==null&&(ge.width[Fe]=A.atlasContext.measureText(Fe).width/A.baseFontSize,M.kerning)){var ze=[];for(var He in ge.width)ze.push(He+Fe,Fe+He);g(ge.kerning,f(ge.family,{pairs:ze}))}}})}if(E.position)if(E.position.length>2){for(var I=!E.position[0].length,R=i.mallocFloat(2*this.count),V=0,O=0;V<this.counts.length;V++){var J=this.counts[V];if(I)for(var D=0;D<J;D++)R[O++]=E.position[2*V],R[O++]=E.position[2*V+1];else for(var B=0;B<J;B++)R[O++]=E.position[V][0],R[O++]=E.position[V][1]}this.position.call?this.position({type:"float",data:R}):this.position=this.regl.buffer({type:"float",data:R}),i.freeFloat(R)}else this.position.destroy&&this.position.destroy(),this.position={constant:E.position};if(E.text||_){var N=i.mallocUint8(this.count),F=i.mallocFloat(2*this.count);this.textWidth=[];for(var H=0,j=0;H<this.counts.length;H++){for(var G=this.counts[H],W=this.font[H]||this.font[0],Q=this.fontAtlas[H]||this.fontAtlas[0],$=0;$<G;$++){var ee=this.text.charAt(j),ie=this.text.charAt(j-1);if(N[j]=Q.ids[ee],F[2*j]=W.width[ee],$){var ae=F[2*j-2],oe=F[2*j],de=F[2*j-1]+.5*ae+.5*oe;if(this.kerning){var le=W.kerning[ie+ee];le&&(de+=.001*le)}F[2*j+1]=de}else F[2*j+1]=.5*F[2*j];j++}this.textWidth.push(F.length?.5*F[2*j-2]+F[2*j-1]:0)}E.align||(E.align=this.align),this.charBuffer({data:N,type:"uint8",usage:"stream"}),this.sizeBuffer({data:F,type:"float",usage:"stream"}),i.freeUint8(N),i.freeFloat(F),b.length&&this.font.forEach(function(ge,De){var _e=M.fontAtlas[De],Pe=_e.step,Fe=Math.floor(A.maxAtlasSize/Pe),ze=Math.min(Fe,_e.chars.length),He=Math.ceil(_e.chars.length/ze),et=y(ze*Pe),Re=y(He*Pe);_e.width=et,_e.height=Re,_e.rows=He,_e.cols=ze,_e.em&&_e.texture({data:r({canvas:A.atlasCanvas,font:_e.fontString,chars:_e.chars,shape:[et,Re],step:[Pe,Pe]})})})}if(E.align&&(this.align=E.align,this.alignOffset=this.textWidth.map(function(ge,De){var _e=Array.isArray(M.align)?M.align.length>1?M.align[De]:M.align[0]:M.align;if(typeof _e=="number")return _e;switch(_e){case"right":case"end":return-ge;case"center":case"centre":case"middle":return .5*-ge}return 0})),this.baseline==null&&E.baseline==null&&(E.baseline=0),E.baseline!=null&&(this.baseline=E.baseline,Array.isArray(this.baseline)||(this.baseline=[this.baseline]),this.baselineOffset=this.baseline.map(function(ge,De){var _e=(M.font[De]||M.font[0]).metrics,Pe=0;return Pe+=.5*_e.bottom,Pe+=typeof ge=="number"?ge-_e.baseline:-_e[ge],A.normalViewport||(Pe*=-1),Pe})),E.color!=null)if(E.color||(E.color="transparent"),typeof E.color!="string"&&isNaN(E.color)){var fe;if(typeof E.color[0]=="number"&&E.color.length>this.counts.length){var ue=E.color.length;fe=i.mallocUint8(ue);for(var we=(E.color.subarray||E.color.slice).bind(E.color),Ae=0;Ae<ue;Ae+=4)fe.set(o(we(Ae,Ae+4),"uint8"),Ae)}else{var Se=E.color.length;fe=i.mallocUint8(4*Se);for(var ke=0;ke<Se;ke++)fe.set(o(E.color[ke]||0,"uint8"),4*ke)}this.color=fe}else this.color=o(E.color,"uint8");if(E.position||E.text||E.color||E.baseline||E.align||E.font||E.offset||E.opacity)if(this.color.length>4||this.baselineOffset.length>1||this.align&&this.align.length>1||this.fontAtlas.length>1||this.positionOffset.length>2){var Me=Math.max(.5*this.position.length||0,.25*this.color.length||0,this.baselineOffset.length||0,this.alignOffset.length||0,this.font.length||0,this.opacity.length||0,.5*this.positionOffset.length||0);this.batch=Array(Me);for(var ve=0;ve<this.batch.length;ve++)this.batch[ve]={count:this.counts.length>1?this.counts[ve]:this.counts[0],offset:this.textOffsets.length>1?this.textOffsets[ve]:this.textOffsets[0],color:this.color?this.color.length<=4?this.color:this.color.subarray(4*ve,4*ve+4):[0,0,0,255],opacity:Array.isArray(this.opacity)?this.opacity[ve]:this.opacity,baseline:this.baselineOffset[ve]!=null?this.baselineOffset[ve]:this.baselineOffset[0],align:this.align?this.alignOffset[ve]!=null?this.alignOffset[ve]:this.alignOffset[0]:0,atlas:this.fontAtlas[ve]||this.fontAtlas[0],positionOffset:this.positionOffset.length>2?this.positionOffset.subarray(2*ve,2*ve+2):this.positionOffset}}else this.count?this.batch=[{count:this.count,offset:0,color:this.color||[0,0,0,255],opacity:Array.isArray(this.opacity)?this.opacity[0]:this.opacity,baseline:this.baselineOffset[0],align:this.alignOffset?this.alignOffset[0]:0,atlas:this.fontAtlas[0],positionOffset:this.positionOffset}]:this.batch=[]},A.prototype.destroy=function(){},A.prototype.kerning=!0,A.prototype.position={constant:new Float32Array(2)},A.prototype.translate=null,A.prototype.scale=null,A.prototype.font=null,A.prototype.text="",A.prototype.positionOffset=[0,0],A.prototype.opacity=1,A.prototype.color=new Uint8Array([0,0,0,255]),A.prototype.alignOffset=[0,0],A.normalViewport=!1,A.maxAtlasSize=1024,A.atlasCanvas=document.createElement("canvas"),A.atlasContext=A.atlasCanvas.getContext("2d",{alpha:!1}),A.baseFontSize=64,A.fonts={},z.exports=A},{"bit-twiddle":97,"color-normalize":125,"css-font":144,"detect-kerning":172,"es6-weak-map":233,"flatten-vertex-data":244,"font-atlas":245,"font-measure":246,"gl-util/context":354,"is-plain-obj":469,"object-assign":499,"parse-rect":504,"parse-unit":506,"pick-by-alias":511,regl:540,"to-px":578,"typedarray-pool":595}],353:[function(n,z,q){"use strict";var t=n("ndarray"),h=n("ndarray-ops"),p=n("typedarray-pool");z.exports=function(v){if(arguments.length<=1)throw new Error("gl-texture2d: Missing arguments for texture2d constructor");if(l||r(v),typeof arguments[1]=="number")return d(v,arguments[1],arguments[2],arguments[3]||v.RGBA,arguments[4]||v.UNSIGNED_BYTE);if(Array.isArray(arguments[1]))return d(v,0|arguments[1][0],0|arguments[1][1],arguments[2]||v.RGBA,arguments[3]||v.UNSIGNED_BYTE);if(typeof arguments[1]=="object"){var T=arguments[1],w=i(T)?T:T.raw;if(w)return m(v,w,0|T.width,0|T.height,arguments[2]||v.RGBA,arguments[3]||v.UNSIGNED_BYTE);if(T.shape&&T.data&&T.stride)return y(v,T)}throw new Error("gl-texture2d: Invalid arguments for texture2d constructor")};var l=null,e=null,o=null;function r(v){l=[v.LINEAR,v.NEAREST_MIPMAP_LINEAR,v.LINEAR_MIPMAP_NEAREST,v.LINEAR_MIPMAP_NEAREST],e=[v.NEAREST,v.LINEAR,v.NEAREST_MIPMAP_NEAREST,v.NEAREST_MIPMAP_LINEAR,v.LINEAR_MIPMAP_NEAREST,v.LINEAR_MIPMAP_LINEAR],o=[v.REPEAT,v.CLAMP_TO_EDGE,v.MIRRORED_REPEAT]}function i(v){return typeof HTMLCanvasElement<"u"&&v instanceof HTMLCanvasElement||typeof HTMLImageElement<"u"&&v instanceof HTMLImageElement||typeof HTMLVideoElement<"u"&&v instanceof HTMLVideoElement||typeof ImageData<"u"&&v instanceof ImageData}var u=function(v,T){h.muls(v,T,255)};function s(v,T,w){var A=v.gl,E=A.getParameter(A.MAX_TEXTURE_SIZE);if(T<0||T>E||w<0||w>E)throw new Error("gl-texture2d: Invalid texture size");return v._shape=[T,w],v.bind(),A.texImage2D(A.TEXTURE_2D,0,v.format,T,w,0,v.format,v.type,null),v._mipLevels=[0],v}function a(v,T,w,A,E,M){this.gl=v,this.handle=T,this.format=E,this.type=M,this._shape=[w,A],this._mipLevels=[0],this._magFilter=v.NEAREST,this._minFilter=v.NEAREST,this._wrapS=v.CLAMP_TO_EDGE,this._wrapT=v.CLAMP_TO_EDGE,this._anisoSamples=1;var b=this,_=[this._wrapS,this._wrapT];Object.defineProperties(_,[{get:function(){return b._wrapS},set:function(C){return b.wrapS=C}},{get:function(){return b._wrapT},set:function(C){return b.wrapT=C}}]),this._wrapVector=_;var S=[this._shape[0],this._shape[1]];Object.defineProperties(S,[{get:function(){return b._shape[0]},set:function(C){return b.width=C}},{get:function(){return b._shape[1]},set:function(C){return b.height=C}}]),this._shapeVector=S}var c=a.prototype;function f(v,T){return v.length===3?T[2]===1&&T[1]===v[0]*v[2]&&T[0]===v[2]:T[0]===1&&T[1]===v[0]}function g(v){var T=v.createTexture();return v.bindTexture(v.TEXTURE_2D,T),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MIN_FILTER,v.NEAREST),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MAG_FILTER,v.NEAREST),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_S,v.CLAMP_TO_EDGE),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_T,v.CLAMP_TO_EDGE),T}function d(v,T,w,A,E){var M=v.getParameter(v.MAX_TEXTURE_SIZE);if(T<0||T>M||w<0||w>M)throw new Error("gl-texture2d: Invalid texture shape");if(E===v.FLOAT&&!v.getExtension("OES_texture_float"))throw new Error("gl-texture2d: Floating point textures not supported on this platform");var b=g(v);return v.texImage2D(v.TEXTURE_2D,0,A,T,w,0,A,E,null),new a(v,b,T,w,A,E)}function m(v,T,w,A,E,M){var b=g(v);return v.texImage2D(v.TEXTURE_2D,0,E,E,M,T),new a(v,b,w,A,E,M)}function y(v,T){var w=T.dtype,A=T.shape.slice(),E=v.getParameter(v.MAX_TEXTURE_SIZE);if(A[0]<0||A[0]>E||A[1]<0||A[1]>E)throw new Error("gl-texture2d: Invalid texture size");var M=f(A,T.stride.slice()),b=0;w==="float32"?b=v.FLOAT:w==="float64"?(b=v.FLOAT,M=!1,w="float32"):w==="uint8"?b=v.UNSIGNED_BYTE:(b=v.UNSIGNED_BYTE,M=!1,w="uint8");var _,S,C=0;if(A.length===2)C=v.LUMINANCE,A=[A[0],A[1],1],T=t(T.data,A,[T.stride[0],T.stride[1],1],T.offset);else{if(A.length!==3)throw new Error("gl-texture2d: Invalid shape for texture");if(A[2]===1)C=v.ALPHA;else if(A[2]===2)C=v.LUMINANCE_ALPHA;else if(A[2]===3)C=v.RGB;else{if(A[2]!==4)throw new Error("gl-texture2d: Invalid shape for pixel coords");C=v.RGBA}}b!==v.FLOAT||v.getExtension("OES_texture_float")||(b=v.UNSIGNED_BYTE,M=!1);var k=T.size;if(M)_=T.offset===0&&T.data.length===k?T.data:T.data.subarray(T.offset,T.offset+k);else{var L=[A[2],A[2]*A[0],1];S=p.malloc(k,w);var I=t(S,A,L,0);w!=="float32"&&w!=="float64"||b!==v.UNSIGNED_BYTE?h.assign(I,T):u(I,T),_=S.subarray(0,k)}var R=g(v);return v.texImage2D(v.TEXTURE_2D,0,C,A[0],A[1],0,C,b,_),M||p.free(S),new a(v,R,A[0],A[1],C,b)}Object.defineProperties(c,{minFilter:{get:function(){return this._minFilter},set:function(v){this.bind();var T=this.gl;if(this.type===T.FLOAT&&l.indexOf(v)>=0&&(T.getExtension("OES_texture_float_linear")||(v=T.NEAREST)),e.indexOf(v)<0)throw new Error("gl-texture2d: Unknown filter mode "+v);return T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MIN_FILTER,v),this._minFilter=v}},magFilter:{get:function(){return this._magFilter},set:function(v){this.bind();var T=this.gl;if(this.type===T.FLOAT&&l.indexOf(v)>=0&&(T.getExtension("OES_texture_float_linear")||(v=T.NEAREST)),e.indexOf(v)<0)throw new Error("gl-texture2d: Unknown filter mode "+v);return T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MAG_FILTER,v),this._magFilter=v}},mipSamples:{get:function(){return this._anisoSamples},set:function(v){var T=this._anisoSamples;if(this._anisoSamples=0|Math.max(v,1),T!==this._anisoSamples){var w=this.gl.getExtension("EXT_texture_filter_anisotropic");w&&this.gl.texParameterf(this.gl.TEXTURE_2D,w.TEXTURE_MAX_ANISOTROPY_EXT,this._anisoSamples)}return this._anisoSamples}},wrapS:{get:function(){return this._wrapS},set:function(v){if(this.bind(),o.indexOf(v)<0)throw new Error("gl-texture2d: Unknown wrap mode "+v);return this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,v),this._wrapS=v}},wrapT:{get:function(){return this._wrapT},set:function(v){if(this.bind(),o.indexOf(v)<0)throw new Error("gl-texture2d: Unknown wrap mode "+v);return this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,v),this._wrapT=v}},wrap:{get:function(){return this._wrapVector},set:function(v){if(Array.isArray(v)||(v=[v,v]),v.length!==2)throw new Error("gl-texture2d: Must specify wrap mode for rows and columns");for(var T=0;T<2;++T)if(o.indexOf(v[T])<0)throw new Error("gl-texture2d: Unknown wrap mode "+v);this._wrapS=v[0],this._wrapT=v[1];var w=this.gl;return this.bind(),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_S,this._wrapS),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_T,this._wrapT),v}},shape:{get:function(){return this._shapeVector},set:function(v){if(Array.isArray(v)){if(v.length!==2)throw new Error("gl-texture2d: Invalid texture shape")}else v=[0|v,0|v];return s(this,0|v[0],0|v[1]),[0|v[0],0|v[1]]}},width:{get:function(){return this._shape[0]},set:function(v){return s(this,v|=0,this._shape[1]),v}},height:{get:function(){return this._shape[1]},set:function(v){return v|=0,s(this,this._shape[0],v),v}}}),c.bind=function(v){var T=this.gl;return v!==void 0&&T.activeTexture(T.TEXTURE0+(0|v)),T.bindTexture(T.TEXTURE_2D,this.handle),v!==void 0?0|v:T.getParameter(T.ACTIVE_TEXTURE)-T.TEXTURE0},c.dispose=function(){this.gl.deleteTexture(this.handle)},c.generateMipmap=function(){this.bind(),this.gl.generateMipmap(this.gl.TEXTURE_2D);for(var v=Math.min(this._shape[0],this._shape[1]),T=0;v>0;++T,v>>>=1)this._mipLevels.indexOf(T)<0&&this._mipLevels.push(T)},c.setPixels=function(v,T,w,A){var E=this.gl;this.bind(),Array.isArray(T)?(A=w,w=0|T[1],T=0|T[0]):(T=T||0,w=w||0),A=A||0;var M=i(v)?v:v.raw;if(M)this._mipLevels.indexOf(A)<0?(E.texImage2D(E.TEXTURE_2D,0,this.format,this.format,this.type,M),this._mipLevels.push(A)):E.texSubImage2D(E.TEXTURE_2D,A,T,w,this.format,this.type,M);else{if(!(v.shape&&v.stride&&v.data))throw new Error("gl-texture2d: Unsupported data type");if(v.shape.length<2||T+v.shape[1]>this._shape[1]>>>A||w+v.shape[0]>this._shape[0]>>>A||T<0||w<0)throw new Error("gl-texture2d: Texture dimensions are out of bounds");(function(b,_,S,C,k,L,I,R){var V=R.dtype,O=R.shape.slice();if(O.length<2||O.length>3)throw new Error("gl-texture2d: Invalid ndarray, must be 2d or 3d");var J=0,D=0,B=f(O,R.stride.slice());if(V==="float32"?J=b.FLOAT:V==="float64"?(J=b.FLOAT,B=!1,V="float32"):V==="uint8"?J=b.UNSIGNED_BYTE:(J=b.UNSIGNED_BYTE,B=!1,V="uint8"),O.length===2)D=b.LUMINANCE,O=[O[0],O[1],1],R=t(R.data,O,[R.stride[0],R.stride[1],1],R.offset);else{if(O.length!==3)throw new Error("gl-texture2d: Invalid shape for texture");if(O[2]===1)D=b.ALPHA;else if(O[2]===2)D=b.LUMINANCE_ALPHA;else if(O[2]===3)D=b.RGB;else{if(O[2]!==4)throw new Error("gl-texture2d: Invalid shape for pixel coords");D=b.RGBA}O[2]}if(D!==b.LUMINANCE&&D!==b.ALPHA||k!==b.LUMINANCE&&k!==b.ALPHA||(D=k),D!==k)throw new Error("gl-texture2d: Incompatible texture format for setPixels");var N=R.size,F=I.indexOf(C)<0;if(F&&I.push(C),J===L&&B)R.offset===0&&R.data.length===N?F?b.texImage2D(b.TEXTURE_2D,C,k,O[0],O[1],0,k,L,R.data):b.texSubImage2D(b.TEXTURE_2D,C,_,S,O[0],O[1],k,L,R.data):F?b.texImage2D(b.TEXTURE_2D,C,k,O[0],O[1],0,k,L,R.data.subarray(R.offset,R.offset+N)):b.texSubImage2D(b.TEXTURE_2D,C,_,S,O[0],O[1],k,L,R.data.subarray(R.offset,R.offset+N));else{var H;H=L===b.FLOAT?p.mallocFloat32(N):p.mallocUint8(N);var j=t(H,O,[O[2],O[2]*O[0],1]);J===b.FLOAT&&L===b.UNSIGNED_BYTE?u(j,R):h.assign(j,R),F?b.texImage2D(b.TEXTURE_2D,C,k,O[0],O[1],0,k,L,H.subarray(0,N)):b.texSubImage2D(b.TEXTURE_2D,C,_,S,O[0],O[1],k,L,H.subarray(0,N)),L===b.FLOAT?p.freeFloat32(H):p.freeUint8(H)}})(E,T,w,A,this.format,this.type,this._mipLevels,v)}}},{ndarray:495,"ndarray-ops":490,"typedarray-pool":595}],354:[function(n,z,q){(function(t){(function(){"use strict";var h=n("pick-by-alias");function p(o){if(o.container)if(o.container==document.body)document.body.style.width||(o.canvas.width=o.width||o.pixelRatio*t.innerWidth),document.body.style.height||(o.canvas.height=o.height||o.pixelRatio*t.innerHeight);else{var r=o.container.getBoundingClientRect();o.canvas.width=o.width||r.right-r.left,o.canvas.height=o.height||r.bottom-r.top}}function l(o){return typeof o.getContext=="function"&&"width"in o&&"height"in o}function e(){var o=document.createElement("canvas");return o.style.position="absolute",o.style.top=0,o.style.left=0,o}z.exports=function(o){var r;if(o?typeof o=="string"&&(o={container:o}):o={},l(o)?o={container:o}:o=typeof(r=o).nodeName=="string"&&typeof r.appendChild=="function"&&typeof r.getBoundingClientRect=="function"?{container:o}:function(u){return typeof u.drawArrays=="function"||typeof u.drawElements=="function"}(o)?{gl:o}:h(o,{container:"container target element el canvas holder parent parentNode wrapper use ref root node",gl:"gl context webgl glContext",attrs:"attributes attrs contextAttributes",pixelRatio:"pixelRatio pxRatio px ratio pxratio pixelratio",width:"w width",height:"h height"},!0),o.pixelRatio||(o.pixelRatio=t.pixelRatio||1),o.gl)return o.gl;if(o.canvas&&(o.container=o.canvas.parentNode),o.container){if(typeof o.container=="string"){var i=document.querySelector(o.container);if(!i)throw Error("Element "+o.container+" is not found");o.container=i}l(o.container)?(o.canvas=o.container,o.container=o.canvas.parentNode):o.canvas||(o.canvas=e(),o.container.appendChild(o.canvas),p(o))}else if(!o.canvas){if(typeof document>"u")throw Error("Not DOM environment. Use headless-gl.");o.container=document.body||document.documentElement,o.canvas=e(),o.container.appendChild(o.canvas),p(o)}if(!o.gl)try{o.gl=o.canvas.getContext("webgl",o.attrs)}catch{try{o.gl=o.canvas.getContext("experimental-webgl",o.attrs)}catch{o.gl=o.canvas.getContext("webgl-experimental",o.attrs)}}return o.gl}}).call(this)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{"pick-by-alias":511}],355:[function(n,z,q){"use strict";z.exports=function(t,h,p){h?h.bind():t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null);var l=0|t.getParameter(t.MAX_VERTEX_ATTRIBS);if(p){if(p.length>l)throw new Error("gl-vao: Too many vertex attributes");for(var e=0;e<p.length;++e){var o=p[e];if(o.buffer){var r=o.buffer,i=o.size||4,u=o.type||t.FLOAT,s=!!o.normalized,a=o.stride||0,c=o.offset||0;r.bind(),t.enableVertexAttribArray(e),t.vertexAttribPointer(e,i,u,s,a,c)}else{if(typeof o=="number")t.vertexAttrib1f(e,o);else if(o.length===1)t.vertexAttrib1f(e,o[0]);else if(o.length===2)t.vertexAttrib2f(e,o[0],o[1]);else if(o.length===3)t.vertexAttrib3f(e,o[0],o[1],o[2]);else{if(o.length!==4)throw new Error("gl-vao: Invalid vertex attribute");t.vertexAttrib4f(e,o[0],o[1],o[2],o[3])}t.disableVertexAttribArray(e)}}for(;e<l;++e)t.disableVertexAttribArray(e)}else for(t.bindBuffer(t.ARRAY_BUFFER,null),e=0;e<l;++e)t.disableVertexAttribArray(e)}},{}],356:[function(n,z,q){"use strict";var t=n("./do-bind.js");function h(p){this.gl=p,this._elements=null,this._attributes=null,this._elementsType=p.UNSIGNED_SHORT}h.prototype.bind=function(){t(this.gl,this._elements,this._attributes)},h.prototype.update=function(p,l,e){this._elements=l,this._attributes=p,this._elementsType=e||this.gl.UNSIGNED_SHORT},h.prototype.dispose=function(){},h.prototype.unbind=function(){},h.prototype.draw=function(p,l,e){e=e||0;var o=this.gl;this._elements?o.drawElements(p,l,this._elementsType,e):o.drawArrays(p,e,l)},z.exports=function(p){return new h(p)}},{"./do-bind.js":355}],357:[function(n,z,q){"use strict";var t=n("./do-bind.js");function h(l,e,o,r,i,u){this.location=l,this.dimension=e,this.a=o,this.b=r,this.c=i,this.d=u}function p(l,e,o){this.gl=l,this._ext=e,this.handle=o,this._attribs=[],this._useElements=!1,this._elementsType=l.UNSIGNED_SHORT}h.prototype.bind=function(l){switch(this.dimension){case 1:l.vertexAttrib1f(this.location,this.a);break;case 2:l.vertexAttrib2f(this.location,this.a,this.b);break;case 3:l.vertexAttrib3f(this.location,this.a,this.b,this.c);break;case 4:l.vertexAttrib4f(this.location,this.a,this.b,this.c,this.d)}},p.prototype.bind=function(){this._ext.bindVertexArrayOES(this.handle);for(var l=0;l<this._attribs.length;++l)this._attribs[l].bind(this.gl)},p.prototype.unbind=function(){this._ext.bindVertexArrayOES(null)},p.prototype.dispose=function(){this._ext.deleteVertexArrayOES(this.handle)},p.prototype.update=function(l,e,o){if(this.bind(),t(this.gl,e,l),this.unbind(),this._attribs.length=0,l)for(var r=0;r<l.length;++r){var i=l[r];typeof i=="number"?this._attribs.push(new h(r,1,i)):Array.isArray(i)&&this._attribs.push(new h(r,i.length,i[0],i[1],i[2],i[3]))}this._useElements=!!e,this._elementsType=o||this.gl.UNSIGNED_SHORT},p.prototype.draw=function(l,e,o){o=o||0;var r=this.gl;this._useElements?r.drawElements(l,e,this._elementsType,o):r.drawArrays(l,o,e)},z.exports=function(l,e){return new p(l,e,e.createVertexArrayOES())}},{"./do-bind.js":355}],358:[function(n,z,q){"use strict";var t=n("./lib/vao-native.js"),h=n("./lib/vao-emulated.js");function p(l){this.bindVertexArrayOES=l.bindVertexArray.bind(l),this.createVertexArrayOES=l.createVertexArray.bind(l),this.deleteVertexArrayOES=l.deleteVertexArray.bind(l)}z.exports=function(l,e,o,r){var i,u=l.createVertexArray?new p(l):l.getExtension("OES_vertex_array_object");return(i=u?t(l,u):h(l)).update(e,o,r),i}},{"./lib/vao-emulated.js":356,"./lib/vao-native.js":357}],359:[function(n,z,q){z.exports=function(t,h,p){return t[0]=h[0]+p[0],t[1]=h[1]+p[1],t[2]=h[2]+p[2],t}},{}],360:[function(n,z,q){z.exports=function(l,e){var o=t(l[0],l[1],l[2]),r=t(e[0],e[1],e[2]);h(o,o),h(r,r);var i=p(o,r);return i>1?0:Math.acos(i)};var t=n("./fromValues"),h=n("./normalize"),p=n("./dot")},{"./dot":370,"./fromValues":376,"./normalize":387}],361:[function(n,z,q){z.exports=function(t,h){return t[0]=Math.ceil(h[0]),t[1]=Math.ceil(h[1]),t[2]=Math.ceil(h[2]),t}},{}],362:[function(n,z,q){z.exports=function(t){var h=new Float32Array(3);return h[0]=t[0],h[1]=t[1],h[2]=t[2],h}},{}],363:[function(n,z,q){z.exports=function(t,h){return t[0]=h[0],t[1]=h[1],t[2]=h[2],t}},{}],364:[function(n,z,q){z.exports=function(){var t=new Float32Array(3);return t[0]=0,t[1]=0,t[2]=0,t}},{}],365:[function(n,z,q){z.exports=function(t,h,p){var l=h[0],e=h[1],o=h[2],r=p[0],i=p[1],u=p[2];return t[0]=e*u-o*i,t[1]=o*r-l*u,t[2]=l*i-e*r,t}},{}],366:[function(n,z,q){z.exports=n("./distance")},{"./distance":367}],367:[function(n,z,q){z.exports=function(t,h){var p=h[0]-t[0],l=h[1]-t[1],e=h[2]-t[2];return Math.sqrt(p*p+l*l+e*e)}},{}],368:[function(n,z,q){z.exports=n("./divide")},{"./divide":369}],369:[function(n,z,q){z.exports=function(t,h,p){return t[0]=h[0]/p[0],t[1]=h[1]/p[1],t[2]=h[2]/p[2],t}},{}],370:[function(n,z,q){z.exports=function(t,h){return t[0]*h[0]+t[1]*h[1]+t[2]*h[2]}},{}],371:[function(n,z,q){z.exports=1e-6},{}],372:[function(n,z,q){z.exports=function(h,p){var l=h[0],e=h[1],o=h[2],r=p[0],i=p[1],u=p[2];return Math.abs(l-r)<=t*Math.max(1,Math.abs(l),Math.abs(r))&&Math.abs(e-i)<=t*Math.max(1,Math.abs(e),Math.abs(i))&&Math.abs(o-u)<=t*Math.max(1,Math.abs(o),Math.abs(u))};var t=n("./epsilon")},{"./epsilon":371}],373:[function(n,z,q){z.exports=function(t,h){return t[0]===h[0]&&t[1]===h[1]&&t[2]===h[2]}},{}],374:[function(n,z,q){z.exports=function(t,h){return t[0]=Math.floor(h[0]),t[1]=Math.floor(h[1]),t[2]=Math.floor(h[2]),t}},{}],375:[function(n,z,q){z.exports=function(h,p,l,e,o,r){var i,u;for(p||(p=3),l||(l=0),u=e?Math.min(e*p+l,h.length):h.length,i=l;i<u;i+=p)t[0]=h[i],t[1]=h[i+1],t[2]=h[i+2],o(t,t,r),h[i]=t[0],h[i+1]=t[1],h[i+2]=t[2];return h};var t=n("./create")()},{"./create":364}],376:[function(n,z,q){z.exports=function(t,h,p){var l=new Float32Array(3);return l[0]=t,l[1]=h,l[2]=p,l}},{}],377:[function(n,z,q){z.exports={EPSILON:n("./epsilon"),create:n("./create"),clone:n("./clone"),angle:n("./angle"),fromValues:n("./fromValues"),copy:n("./copy"),set:n("./set"),equals:n("./equals"),exactEquals:n("./exactEquals"),add:n("./add"),subtract:n("./subtract"),sub:n("./sub"),multiply:n("./multiply"),mul:n("./mul"),divide:n("./divide"),div:n("./div"),min:n("./min"),max:n("./max"),floor:n("./floor"),ceil:n("./ceil"),round:n("./round"),scale:n("./scale"),scaleAndAdd:n("./scaleAndAdd"),distance:n("./distance"),dist:n("./dist"),squaredDistance:n("./squaredDistance"),sqrDist:n("./sqrDist"),length:n("./length"),len:n("./len"),squaredLength:n("./squaredLength"),sqrLen:n("./sqrLen"),negate:n("./negate"),inverse:n("./inverse"),normalize:n("./normalize"),dot:n("./dot"),cross:n("./cross"),lerp:n("./lerp"),random:n("./random"),transformMat4:n("./transformMat4"),transformMat3:n("./transformMat3"),transformQuat:n("./transformQuat"),rotateX:n("./rotateX"),rotateY:n("./rotateY"),rotateZ:n("./rotateZ"),forEach:n("./forEach")}},{"./add":359,"./angle":360,"./ceil":361,"./clone":362,"./copy":363,"./create":364,"./cross":365,"./dist":366,"./distance":367,"./div":368,"./divide":369,"./dot":370,"./epsilon":371,"./equals":372,"./exactEquals":373,"./floor":374,"./forEach":375,"./fromValues":376,"./inverse":378,"./len":379,"./length":380,"./lerp":381,"./max":382,"./min":383,"./mul":384,"./multiply":385,"./negate":386,"./normalize":387,"./random":388,"./rotateX":389,"./rotateY":390,"./rotateZ":391,"./round":392,"./scale":393,"./scaleAndAdd":394,"./set":395,"./sqrDist":396,"./sqrLen":397,"./squaredDistance":398,"./squaredLength":399,"./sub":400,"./subtract":401,"./transformMat3":402,"./transformMat4":403,"./transformQuat":404}],378:[function(n,z,q){z.exports=function(t,h){return t[0]=1/h[0],t[1]=1/h[1],t[2]=1/h[2],t}},{}],379:[function(n,z,q){z.exports=n("./length")},{"./length":380}],380:[function(n,z,q){z.exports=function(t){var h=t[0],p=t[1],l=t[2];return Math.sqrt(h*h+p*p+l*l)}},{}],381:[function(n,z,q){z.exports=function(t,h,p,l){var e=h[0],o=h[1],r=h[2];return t[0]=e+l*(p[0]-e),t[1]=o+l*(p[1]-o),t[2]=r+l*(p[2]-r),t}},{}],382:[function(n,z,q){z.exports=function(t,h,p){return t[0]=Math.max(h[0],p[0]),t[1]=Math.max(h[1],p[1]),t[2]=Math.max(h[2],p[2]),t}},{}],383:[function(n,z,q){z.exports=function(t,h,p){return t[0]=Math.min(h[0],p[0]),t[1]=Math.min(h[1],p[1]),t[2]=Math.min(h[2],p[2]),t}},{}],384:[function(n,z,q){z.exports=n("./multiply")},{"./multiply":385}],385:[function(n,z,q){z.exports=function(t,h,p){return t[0]=h[0]*p[0],t[1]=h[1]*p[1],t[2]=h[2]*p[2],t}},{}],386:[function(n,z,q){z.exports=function(t,h){return t[0]=-h[0],t[1]=-h[1],t[2]=-h[2],t}},{}],387:[function(n,z,q){z.exports=function(t,h){var p=h[0],l=h[1],e=h[2],o=p*p+l*l+e*e;return o>0&&(o=1/Math.sqrt(o),t[0]=h[0]*o,t[1]=h[1]*o,t[2]=h[2]*o),t}},{}],388:[function(n,z,q){z.exports=function(t,h){h=h||1;var p=2*Math.random()*Math.PI,l=2*Math.random()-1,e=Math.sqrt(1-l*l)*h;return t[0]=Math.cos(p)*e,t[1]=Math.sin(p)*e,t[2]=l*h,t}},{}],389:[function(n,z,q){z.exports=function(t,h,p,l){var e=p[1],o=p[2],r=h[1]-e,i=h[2]-o,u=Math.sin(l),s=Math.cos(l);return t[0]=h[0],t[1]=e+r*s-i*u,t[2]=o+r*u+i*s,t}},{}],390:[function(n,z,q){z.exports=function(t,h,p,l){var e=p[0],o=p[2],r=h[0]-e,i=h[2]-o,u=Math.sin(l),s=Math.cos(l);return t[0]=e+i*u+r*s,t[1]=h[1],t[2]=o+i*s-r*u,t}},{}],391:[function(n,z,q){z.exports=function(t,h,p,l){var e=p[0],o=p[1],r=h[0]-e,i=h[1]-o,u=Math.sin(l),s=Math.cos(l);return t[0]=e+r*s-i*u,t[1]=o+r*u+i*s,t[2]=h[2],t}},{}],392:[function(n,z,q){z.exports=function(t,h){return t[0]=Math.round(h[0]),t[1]=Math.round(h[1]),t[2]=Math.round(h[2]),t}},{}],393:[function(n,z,q){z.exports=function(t,h,p){return t[0]=h[0]*p,t[1]=h[1]*p,t[2]=h[2]*p,t}},{}],394:[function(n,z,q){z.exports=function(t,h,p,l){return t[0]=h[0]+p[0]*l,t[1]=h[1]+p[1]*l,t[2]=h[2]+p[2]*l,t}},{}],395:[function(n,z,q){z.exports=function(t,h,p,l){return t[0]=h,t[1]=p,t[2]=l,t}},{}],396:[function(n,z,q){z.exports=n("./squaredDistance")},{"./squaredDistance":398}],397:[function(n,z,q){z.exports=n("./squaredLength")},{"./squaredLength":399}],398:[function(n,z,q){z.exports=function(t,h){var p=h[0]-t[0],l=h[1]-t[1],e=h[2]-t[2];return p*p+l*l+e*e}},{}],399:[function(n,z,q){z.exports=function(t){var h=t[0],p=t[1],l=t[2];return h*h+p*p+l*l}},{}],400:[function(n,z,q){z.exports=n("./subtract")},{"./subtract":401}],401:[function(n,z,q){z.exports=function(t,h,p){return t[0]=h[0]-p[0],t[1]=h[1]-p[1],t[2]=h[2]-p[2],t}},{}],402:[function(n,z,q){z.exports=function(t,h,p){var l=h[0],e=h[1],o=h[2];return t[0]=l*p[0]+e*p[3]+o*p[6],t[1]=l*p[1]+e*p[4]+o*p[7],t[2]=l*p[2]+e*p[5]+o*p[8],t}},{}],403:[function(n,z,q){z.exports=function(t,h,p){var l=h[0],e=h[1],o=h[2],r=p[3]*l+p[7]*e+p[11]*o+p[15];return r=r||1,t[0]=(p[0]*l+p[4]*e+p[8]*o+p[12])/r,t[1]=(p[1]*l+p[5]*e+p[9]*o+p[13])/r,t[2]=(p[2]*l+p[6]*e+p[10]*o+p[14])/r,t}},{}],404:[function(n,z,q){z.exports=function(t,h,p){var l=h[0],e=h[1],o=h[2],r=p[0],i=p[1],u=p[2],s=p[3],a=s*l+i*o-u*e,c=s*e+u*l-r*o,f=s*o+r*e-i*l,g=-r*l-i*e-u*o;return t[0]=a*s+g*-r+c*-u-f*-i,t[1]=c*s+g*-i+f*-r-a*-u,t[2]=f*s+g*-u+a*-i-c*-r,t}},{}],405:[function(n,z,q){z.exports=function(t,h,p){return t[0]=h[0]+p[0],t[1]=h[1]+p[1],t[2]=h[2]+p[2],t[3]=h[3]+p[3],t}},{}],406:[function(n,z,q){z.exports=function(t){var h=new Float32Array(4);return h[0]=t[0],h[1]=t[1],h[2]=t[2],h[3]=t[3],h}},{}],407:[function(n,z,q){z.exports=function(t,h){return t[0]=h[0],t[1]=h[1],t[2]=h[2],t[3]=h[3],t}},{}],408:[function(n,z,q){z.exports=function(){var t=new Float32Array(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}},{}],409:[function(n,z,q){z.exports=function(t,h){var p=h[0]-t[0],l=h[1]-t[1],e=h[2]-t[2],o=h[3]-t[3];return Math.sqrt(p*p+l*l+e*e+o*o)}},{}],410:[function(n,z,q){z.exports=function(t,h,p){return t[0]=h[0]/p[0],t[1]=h[1]/p[1],t[2]=h[2]/p[2],t[3]=h[3]/p[3],t}},{}],411:[function(n,z,q){z.exports=function(t,h){return t[0]*h[0]+t[1]*h[1]+t[2]*h[2]+t[3]*h[3]}},{}],412:[function(n,z,q){z.exports=function(t,h,p,l){var e=new Float32Array(4);return e[0]=t,e[1]=h,e[2]=p,e[3]=l,e}},{}],413:[function(n,z,q){z.exports={create:n("./create"),clone:n("./clone"),fromValues:n("./fromValues"),copy:n("./copy"),set:n("./set"),add:n("./add"),subtract:n("./subtract"),multiply:n("./multiply"),divide:n("./divide"),min:n("./min"),max:n("./max"),scale:n("./scale"),scaleAndAdd:n("./scaleAndAdd"),distance:n("./distance"),squaredDistance:n("./squaredDistance"),length:n("./length"),squaredLength:n("./squaredLength"),negate:n("./negate"),inverse:n("./inverse"),normalize:n("./normalize"),dot:n("./dot"),lerp:n("./lerp"),random:n("./random"),transformMat4:n("./transformMat4"),transformQuat:n("./transformQuat")}},{"./add":405,"./clone":406,"./copy":407,"./create":408,"./distance":409,"./divide":410,"./dot":411,"./fromValues":412,"./inverse":414,"./length":415,"./lerp":416,"./max":417,"./min":418,"./multiply":419,"./negate":420,"./normalize":421,"./random":422,"./scale":423,"./scaleAndAdd":424,"./set":425,"./squaredDistance":426,"./squaredLength":427,"./subtract":428,"./transformMat4":429,"./transformQuat":430}],414:[function(n,z,q){z.exports=function(t,h){return t[0]=1/h[0],t[1]=1/h[1],t[2]=1/h[2],t[3]=1/h[3],t}},{}],415:[function(n,z,q){z.exports=function(t){var h=t[0],p=t[1],l=t[2],e=t[3];return Math.sqrt(h*h+p*p+l*l+e*e)}},{}],416:[function(n,z,q){z.exports=function(t,h,p,l){var e=h[0],o=h[1],r=h[2],i=h[3];return t[0]=e+l*(p[0]-e),t[1]=o+l*(p[1]-o),t[2]=r+l*(p[2]-r),t[3]=i+l*(p[3]-i),t}},{}],417:[function(n,z,q){z.exports=function(t,h,p){return t[0]=Math.max(h[0],p[0]),t[1]=Math.max(h[1],p[1]),t[2]=Math.max(h[2],p[2]),t[3]=Math.max(h[3],p[3]),t}},{}],418:[function(n,z,q){z.exports=function(t,h,p){return t[0]=Math.min(h[0],p[0]),t[1]=Math.min(h[1],p[1]),t[2]=Math.min(h[2],p[2]),t[3]=Math.min(h[3],p[3]),t}},{}],419:[function(n,z,q){z.exports=function(t,h,p){return t[0]=h[0]*p[0],t[1]=h[1]*p[1],t[2]=h[2]*p[2],t[3]=h[3]*p[3],t}},{}],420:[function(n,z,q){z.exports=function(t,h){return t[0]=-h[0],t[1]=-h[1],t[2]=-h[2],t[3]=-h[3],t}},{}],421:[function(n,z,q){z.exports=function(t,h){var p=h[0],l=h[1],e=h[2],o=h[3],r=p*p+l*l+e*e+o*o;return r>0&&(r=1/Math.sqrt(r),t[0]=p*r,t[1]=l*r,t[2]=e*r,t[3]=o*r),t}},{}],422:[function(n,z,q){var t=n("./normalize"),h=n("./scale");z.exports=function(p,l){return l=l||1,p[0]=Math.random(),p[1]=Math.random(),p[2]=Math.random(),p[3]=Math.random(),t(p,p),h(p,p,l),p}},{"./normalize":421,"./scale":423}],423:[function(n,z,q){z.exports=function(t,h,p){return t[0]=h[0]*p,t[1]=h[1]*p,t[2]=h[2]*p,t[3]=h[3]*p,t}},{}],424:[function(n,z,q){z.exports=function(t,h,p,l){return t[0]=h[0]+p[0]*l,t[1]=h[1]+p[1]*l,t[2]=h[2]+p[2]*l,t[3]=h[3]+p[3]*l,t}},{}],425:[function(n,z,q){z.exports=function(t,h,p,l,e){return t[0]=h,t[1]=p,t[2]=l,t[3]=e,t}},{}],426:[function(n,z,q){z.exports=function(t,h){var p=h[0]-t[0],l=h[1]-t[1],e=h[2]-t[2],o=h[3]-t[3];return p*p+l*l+e*e+o*o}},{}],427:[function(n,z,q){z.exports=function(t){var h=t[0],p=t[1],l=t[2],e=t[3];return h*h+p*p+l*l+e*e}},{}],428:[function(n,z,q){z.exports=function(t,h,p){return t[0]=h[0]-p[0],t[1]=h[1]-p[1],t[2]=h[2]-p[2],t[3]=h[3]-p[3],t}},{}],429:[function(n,z,q){z.exports=function(t,h,p){var l=h[0],e=h[1],o=h[2],r=h[3];return t[0]=p[0]*l+p[4]*e+p[8]*o+p[12]*r,t[1]=p[1]*l+p[5]*e+p[9]*o+p[13]*r,t[2]=p[2]*l+p[6]*e+p[10]*o+p[14]*r,t[3]=p[3]*l+p[7]*e+p[11]*o+p[15]*r,t}},{}],430:[function(n,z,q){z.exports=function(t,h,p){var l=h[0],e=h[1],o=h[2],r=p[0],i=p[1],u=p[2],s=p[3],a=s*l+i*o-u*e,c=s*e+u*l-r*o,f=s*o+r*e-i*l,g=-r*l-i*e-u*o;return t[0]=a*s+g*-r+c*-u-f*-i,t[1]=c*s+g*-i+f*-r-a*-u,t[2]=f*s+g*-u+a*-i-c*-r,t[3]=h[3],t}},{}],431:[function(n,z,q){var t=n("glsl-tokenizer"),h=n("atob-lite");z.exports=function(p){for(var l=Array.isArray(p)?p:t(p),e=0;e<l.length;e++){var o=l[e];if(o.type==="preprocessor"){var r=o.data.match(/\#define\s+SHADER_NAME(_B64)?\s+(.+)$/);if(r&&r[2]){var i=r[1],u=r[2];return(i?h(u):u).trim()}}}}},{"atob-lite":77,"glsl-tokenizer":438}],432:[function(n,z,q){z.exports=function(r){var i,u,s,a=0,c=0,f=999,g=[],d=[],m=1,y=0,v=0,T=!1,w=!1,A="",E=p,M=t;(r=r||{}).version==="300 es"&&(E=e,M=l);var b={},_={};for(a=0;a<E.length;a++)b[E[a]]=!0;for(a=0;a<M.length;a++)_[M[a]]=!0;return function(N){return d=[],N!==null?function(F){a=0,F.toString&&(F=F.toString());var H;for(A+=F.replace(/\r\n/g,`
`),s=A.length;i=A[a],a<s;){switch(H=a,f){case 0:a=I();break;case 1:case 2:a=L();break;case 3:a=R();break;case 4:a=J();break;case 11:a=O();break;case 5:a=D();break;case 9999:a=B();break;case 9:a=k();break;case 999:a=C()}if(H!==a)switch(A[H]){case`
`:y=0,++m;break;default:++y}}return c+=a,A=A.slice(a),d}(N):function(F){return g.length&&S(g.join("")),f=10,S("(eof)"),d}()};function S(N){N.length&&d.push({type:o[f],data:N,position:v,line:m,column:y})}function C(){return g=g.length?[]:g,u==="/"&&i==="*"?(v=c+a-1,f=0,u=i,a+1):u==="/"&&i==="/"?(v=c+a-1,f=1,u=i,a+1):i==="#"?(f=2,v=c+a,a):/\s/.test(i)?(f=9,v=c+a,a):(T=/\d/.test(i),w=/[^\w_]/.test(i),v=c+a,f=T?4:w?3:9999,a)}function k(){return/[^\s]/g.test(i)?(S(g.join("")),f=999,a):(g.push(i),u=i,a+1)}function L(){return i!=="\r"&&i!==`
`||u==="\\"?(g.push(i),u=i,a+1):(S(g.join("")),f=999,a)}function I(){return i==="/"&&u==="*"?(g.push(i),S(g.join("")),f=999,a+1):(g.push(i),u=i,a+1)}function R(){if(u==="."&&/\d/.test(i))return f=5,a;if(u==="/"&&i==="*")return f=0,a;if(u==="/"&&i==="/")return f=1,a;if(i==="."&&g.length){for(;V(g););return f=5,a}if(i===";"||i===")"||i==="("){if(g.length)for(;V(g););return S(i),f=999,a+1}var N=g.length===2&&i!=="=";if(/[\w_\d\s]/.test(i)||N){for(;V(g););return f=999,a}return g.push(i),u=i,a+1}function V(N){for(var F,H,j=0;;){if(F=h.indexOf(N.slice(0,N.length+j).join("")),H=h[F],F===-1){if(j--+N.length>0)continue;H=N.slice(0,1).join("")}return S(H),v+=H.length,(g=g.slice(H.length)).length}}function O(){return/[^a-fA-F0-9]/.test(i)?(S(g.join("")),f=999,a):(g.push(i),u=i,a+1)}function J(){return i==="."||/[eE]/.test(i)?(g.push(i),f=5,u=i,a+1):i==="x"&&g.length===1&&g[0]==="0"?(f=11,g.push(i),u=i,a+1):/[^\d]/.test(i)?(S(g.join("")),f=999,a):(g.push(i),u=i,a+1)}function D(){return i==="f"&&(g.push(i),u=i,a+=1),/[eE]/.test(i)?(g.push(i),u=i,a+1):(i!=="-"&&i!=="+"||!/[eE]/.test(u))&&/[^\d]/.test(i)?(S(g.join("")),f=999,a):(g.push(i),u=i,a+1)}function B(){if(/[^\d\w_]/.test(i)){var N=g.join("");return f=_[N]?8:b[N]?7:6,S(g.join("")),f=999,a}return g.push(i),u=i,a+1}};var t=n("./lib/literals"),h=n("./lib/operators"),p=n("./lib/builtins"),l=n("./lib/literals-300es"),e=n("./lib/builtins-300es"),o=["block-comment","line-comment","preprocessor","operator","integer","float","ident","builtin","keyword","whitespace","eof","integer"]},{"./lib/builtins":434,"./lib/builtins-300es":433,"./lib/literals":436,"./lib/literals-300es":435,"./lib/operators":437}],433:[function(n,z,q){var t=n("./builtins");t=t.slice().filter(function(h){return!/^(gl\_|texture)/.test(h)}),z.exports=t.concat(["gl_VertexID","gl_InstanceID","gl_Position","gl_PointSize","gl_FragCoord","gl_FrontFacing","gl_FragDepth","gl_PointCoord","gl_MaxVertexAttribs","gl_MaxVertexUniformVectors","gl_MaxVertexOutputVectors","gl_MaxFragmentInputVectors","gl_MaxVertexTextureImageUnits","gl_MaxCombinedTextureImageUnits","gl_MaxTextureImageUnits","gl_MaxFragmentUniformVectors","gl_MaxDrawBuffers","gl_MinProgramTexelOffset","gl_MaxProgramTexelOffset","gl_DepthRangeParameters","gl_DepthRange","trunc","round","roundEven","isnan","isinf","floatBitsToInt","floatBitsToUint","intBitsToFloat","uintBitsToFloat","packSnorm2x16","unpackSnorm2x16","packUnorm2x16","unpackUnorm2x16","packHalf2x16","unpackHalf2x16","outerProduct","transpose","determinant","inverse","texture","textureSize","textureProj","textureLod","textureOffset","texelFetch","texelFetchOffset","textureProjOffset","textureLodOffset","textureProjLod","textureProjLodOffset","textureGrad","textureGradOffset","textureProjGrad","textureProjGradOffset"])},{"./builtins":434}],434:[function(n,z,q){z.exports=["abs","acos","all","any","asin","atan","ceil","clamp","cos","cross","dFdx","dFdy","degrees","distance","dot","equal","exp","exp2","faceforward","floor","fract","gl_BackColor","gl_BackLightModelProduct","gl_BackLightProduct","gl_BackMaterial","gl_BackSecondaryColor","gl_ClipPlane","gl_ClipVertex","gl_Color","gl_DepthRange","gl_DepthRangeParameters","gl_EyePlaneQ","gl_EyePlaneR","gl_EyePlaneS","gl_EyePlaneT","gl_Fog","gl_FogCoord","gl_FogFragCoord","gl_FogParameters","gl_FragColor","gl_FragCoord","gl_FragData","gl_FragDepth","gl_FragDepthEXT","gl_FrontColor","gl_FrontFacing","gl_FrontLightModelProduct","gl_FrontLightProduct","gl_FrontMaterial","gl_FrontSecondaryColor","gl_LightModel","gl_LightModelParameters","gl_LightModelProducts","gl_LightProducts","gl_LightSource","gl_LightSourceParameters","gl_MaterialParameters","gl_MaxClipPlanes","gl_MaxCombinedTextureImageUnits","gl_MaxDrawBuffers","gl_MaxFragmentUniformComponents","gl_MaxLights","gl_MaxTextureCoords","gl_MaxTextureImageUnits","gl_MaxTextureUnits","gl_MaxVaryingFloats","gl_MaxVertexAttribs","gl_MaxVertexTextureImageUnits","gl_MaxVertexUniformComponents","gl_ModelViewMatrix","gl_ModelViewMatrixInverse","gl_ModelViewMatrixInverseTranspose","gl_ModelViewMatrixTranspose","gl_ModelViewProjectionMatrix","gl_ModelViewProjectionMatrixInverse","gl_ModelViewProjectionMatrixInverseTranspose","gl_ModelViewProjectionMatrixTranspose","gl_MultiTexCoord0","gl_MultiTexCoord1","gl_MultiTexCoord2","gl_MultiTexCoord3","gl_MultiTexCoord4","gl_MultiTexCoord5","gl_MultiTexCoord6","gl_MultiTexCoord7","gl_Normal","gl_NormalMatrix","gl_NormalScale","gl_ObjectPlaneQ","gl_ObjectPlaneR","gl_ObjectPlaneS","gl_ObjectPlaneT","gl_Point","gl_PointCoord","gl_PointParameters","gl_PointSize","gl_Position","gl_ProjectionMatrix","gl_ProjectionMatrixInverse","gl_ProjectionMatrixInverseTranspose","gl_ProjectionMatrixTranspose","gl_SecondaryColor","gl_TexCoord","gl_TextureEnvColor","gl_TextureMatrix","gl_TextureMatrixInverse","gl_TextureMatrixInverseTranspose","gl_TextureMatrixTranspose","gl_Vertex","greaterThan","greaterThanEqual","inversesqrt","length","lessThan","lessThanEqual","log","log2","matrixCompMult","max","min","mix","mod","normalize","not","notEqual","pow","radians","reflect","refract","sign","sin","smoothstep","sqrt","step","tan","texture2D","texture2DLod","texture2DProj","texture2DProjLod","textureCube","textureCubeLod","texture2DLodEXT","texture2DProjLodEXT","textureCubeLodEXT","texture2DGradEXT","texture2DProjGradEXT","textureCubeGradEXT"]},{}],435:[function(n,z,q){var t=n("./literals");z.exports=t.slice().concat(["layout","centroid","smooth","case","mat2x2","mat2x3","mat2x4","mat3x2","mat3x3","mat3x4","mat4x2","mat4x3","mat4x4","uvec2","uvec3","uvec4","samplerCubeShadow","sampler2DArray","sampler2DArrayShadow","isampler2D","isampler3D","isamplerCube","isampler2DArray","usampler2D","usampler3D","usamplerCube","usampler2DArray","coherent","restrict","readonly","writeonly","resource","atomic_uint","noperspective","patch","sample","subroutine","common","partition","active","filter","image1D","image2D","image3D","imageCube","iimage1D","iimage2D","iimage3D","iimageCube","uimage1D","uimage2D","uimage3D","uimageCube","image1DArray","image2DArray","iimage1DArray","iimage2DArray","uimage1DArray","uimage2DArray","image1DShadow","image2DShadow","image1DArrayShadow","image2DArrayShadow","imageBuffer","iimageBuffer","uimageBuffer","sampler1DArray","sampler1DArrayShadow","isampler1D","isampler1DArray","usampler1D","usampler1DArray","isampler2DRect","usampler2DRect","samplerBuffer","isamplerBuffer","usamplerBuffer","sampler2DMS","isampler2DMS","usampler2DMS","sampler2DMSArray","isampler2DMSArray","usampler2DMSArray"])},{"./literals":436}],436:[function(n,z,q){z.exports=["precision","highp","mediump","lowp","attribute","const","uniform","varying","break","continue","do","for","while","if","else","in","out","inout","float","int","uint","void","bool","true","false","discard","return","mat2","mat3","mat4","vec2","vec3","vec4","ivec2","ivec3","ivec4","bvec2","bvec3","bvec4","sampler1D","sampler2D","sampler3D","samplerCube","sampler1DShadow","sampler2DShadow","struct","asm","class","union","enum","typedef","template","this","packed","goto","switch","default","inline","noinline","volatile","public","static","extern","external","interface","long","short","double","half","fixed","unsigned","input","output","hvec2","hvec3","hvec4","dvec2","dvec3","dvec4","fvec2","fvec3","fvec4","sampler2DRect","sampler3DRect","sampler2DRectShadow","sizeof","cast","namespace","using"]},{}],437:[function(n,z,q){z.exports=["<<=",">>=","++","--","<<",">>","<=",">=","==","!=","&&","||","+=","-=","*=","/=","%=","&=","^^","^=","|=","(",")","[","]",".","!","~","*","/","%","+","-","<",">","&","^","|","?",":","=",",",";","{","}"]},{}],438:[function(n,z,q){var t=n("./index");z.exports=function(h,p){var l=t(p),e=[];return e=(e=e.concat(l(h))).concat(l(null))}},{"./index":432}],439:[function(n,z,q){arguments[4][257][0].apply(q,arguments)},{dup:257}],440:[function(n,z,q){(function(t){(function(){"use strict";var h,p=n("is-browser");h=typeof t.matchMedia=="function"?!t.matchMedia("(hover: none)").matches:p,z.exports=h}).call(this)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{"is-browser":464}],441:[function(n,z,q){"use strict";var t=n("is-browser");z.exports=t&&function(){var h=!1;try{var p=Object.defineProperty({},"passive",{get:function(){h=!0}});window.addEventListener("test",null,p),window.removeEventListener("test",null,p)}catch{h=!1}return h}()},{"is-browser":464}],442:[function(n,z,q){q.read=function(t,h,p,l,e){var o,r,i=8*e-l-1,u=(1<<i)-1,s=u>>1,a=-7,c=p?e-1:0,f=p?-1:1,g=t[h+c];for(c+=f,o=g&(1<<-a)-1,g>>=-a,a+=i;a>0;o=256*o+t[h+c],c+=f,a-=8);for(r=o&(1<<-a)-1,o>>=-a,a+=l;a>0;r=256*r+t[h+c],c+=f,a-=8);if(o===0)o=1-s;else{if(o===u)return r?NaN:1/0*(g?-1:1);r+=Math.pow(2,l),o-=s}return(g?-1:1)*r*Math.pow(2,o-l)},q.write=function(t,h,p,l,e,o){var r,i,u,s=8*o-e-1,a=(1<<s)-1,c=a>>1,f=e===23?Math.pow(2,-24)-Math.pow(2,-77):0,g=l?0:o-1,d=l?1:-1,m=h<0||h===0&&1/h<0?1:0;for(h=Math.abs(h),isNaN(h)||h===1/0?(i=isNaN(h)?1:0,r=a):(r=Math.floor(Math.log(h)/Math.LN2),h*(u=Math.pow(2,-r))<1&&(r--,u*=2),(h+=r+c>=1?f/u:f*Math.pow(2,1-c))*u>=2&&(r++,u/=2),r+c>=a?(i=0,r=a):r+c>=1?(i=(h*u-1)*Math.pow(2,e),r+=c):(i=h*Math.pow(2,c-1)*Math.pow(2,e),r=0));e>=8;t[p+g]=255&i,g+=d,i/=256,e-=8);for(r=r<<e|i,s+=e;s>0;t[p+g]=255&r,g+=d,r/=256,s-=8);t[p+g-d]|=128*m}},{}],443:[function(n,z,q){"use strict";var t=n("./types");z.exports=function(h,p){var l;for(l in t)if(t[l].detect(h,p))return l}},{"./types":446}],444:[function(n,z,q){(function(t){(function(){"use strict";var h=n("fs"),p=n("path"),l=n("./types"),e=n("./detector");function o(r,i){var u=e(r,i);if(u in l){var s=l[u].calculate(r,i);if(s!==!1)return s.type=u,s}throw new TypeError("unsupported file type: "+u+" (file: "+i+")")}z.exports=function(r,i){if(t.isBuffer(r))return o(r);if(typeof r!="string")throw new TypeError("invalid invocation");var u=p.resolve(r);if(typeof i!="function")return o(function(s){var a=h.openSync(s,"r"),c=h.fstatSync(a).size,f=Math.min(c,524288),g=t.alloc(f);return h.readSync(a,g,0,f,0),h.closeSync(a),g}(u),u);(function(s,a){h.open(s,"r",function(c,f){if(c)return a(c);h.fstat(f,function(g,d){if(g)return a(g);var m=d.size;if(m<=0)return a(new Error("File size is not greater than 0 \u2014\u2014 "+s));var y=Math.min(m,524288),v=t.alloc(y);h.read(f,v,0,y,0,function(T){if(T)return a(T);h.close(f,function(w){a(w,v)})})})})})(u,function(s,a){if(s)return i(s);var c;try{c=o(a,u)}catch(f){s=f}i(s,c)})},z.exports.types=Object.keys(l)}).call(this)}).call(this,n("buffer").Buffer)},{"./detector":443,"./types":446,buffer:111,fs:109,path:507}],445:[function(n,z,q){"use strict";z.exports=function(t,h,p,l){return p=p||0,t["readUInt"+h+(l?"BE":"LE")].call(t,p)}},{}],446:[function(n,z,q){"use strict";var t={bmp:n("./types/bmp"),cur:n("./types/cur"),dds:n("./types/dds"),gif:n("./types/gif"),icns:n("./types/icns"),ico:n("./types/ico"),jpg:n("./types/jpg"),png:n("./types/png"),psd:n("./types/psd"),svg:n("./types/svg"),tiff:n("./types/tiff"),webp:n("./types/webp")};z.exports=t},{"./types/bmp":447,"./types/cur":448,"./types/dds":449,"./types/gif":450,"./types/icns":451,"./types/ico":452,"./types/jpg":453,"./types/png":454,"./types/psd":455,"./types/svg":456,"./types/tiff":457,"./types/webp":458}],447:[function(n,z,q){"use strict";z.exports={detect:function(t){return t.toString("ascii",0,2)==="BM"},calculate:function(t){return{width:t.readUInt32LE(18),height:Math.abs(t.readInt32LE(22))}}}},{}],448:[function(n,z,q){"use strict";z.exports={detect:function(t){return t.readUInt16LE(0)===0&&t.readUInt16LE(2)===2},calculate:n("./ico").calculate}},{"./ico":452}],449:[function(n,z,q){"use strict";z.exports={detect:function(t){return t.readUInt32LE(0)===542327876},calculate:function(t){return{height:t.readUInt32LE(12),width:t.readUInt32LE(16)}}}},{}],450:[function(n,z,q){"use strict";var t=/^GIF8[79]a/;z.exports={detect:function(h){var p=h.toString("ascii",0,6);return t.test(p)},calculate:function(h){return{width:h.readUInt16LE(6),height:h.readUInt16LE(8)}}}},{}],451:[function(n,z,q){"use strict";var t={ICON:32,"ICN#":32,"icm#":16,icm4:16,icm8:16,"ics#":16,ics4:16,ics8:16,is32:16,s8mk:16,icp4:16,icl4:32,icl8:32,il32:32,l8mk:32,icp5:32,ic11:32,ich4:48,ich8:48,ih32:48,h8mk:48,icp6:64,ic12:32,it32:128,t8mk:128,ic07:128,ic08:256,ic13:256,ic09:512,ic14:512,ic10:1024};function h(l,e){var o=e+4;return[l.toString("ascii",e,o),l.readUInt32BE(o)]}function p(l){var e=t[l];return{width:e,height:e,type:l}}z.exports={detect:function(l){return l.toString("ascii",0,4)==="icns"},calculate:function(l){var e,o,r,i=l.length,u=8,s=l.readUInt32BE(4);if(o=p((e=h(l,u))[0]),(u+=e[1])===s)return o;for(r={width:o.width,height:o.height,images:[o]};u<s&&u<i;)o=p((e=h(l,u))[0]),u+=e[1],r.images.push(o);return r}}},{}],452:[function(n,z,q){"use strict";function t(p,l){var e=p.readUInt8(l);return e===0?256:e}function h(p,l){var e=6+16*l;return{width:t(p,e),height:t(p,e+1)}}z.exports={detect:function(p){return p.readUInt16LE(0)===0&&p.readUInt16LE(2)===1},calculate:function(p){var l,e=p.readUInt16LE(4),o=h(p,0);if(e===1)return o;for(o.images=[{width:o.width,height:o.height}],l=1;l<e;l+=1)o.images.push(h(p,l));return o}}},{}],453:[function(n,z,q){"use strict";var t=n("../readUInt");function h(o){return o.toString("hex",2,6)==="45786966"}function p(o,r){return{height:o.readUInt16BE(r),width:o.readUInt16BE(r+2)}}function l(o,r){var i=o.slice(2,r),u=i.toString("hex",6,8),s=u==="4d4d";if(s||u==="4949")return function(a,c){for(var f,g,d=t(a,16,14,c),m=0;m<d;m++){if(g=(f=16+12*m)+12,f>a.length)return;var y=a.slice(f,g);if(t(y,16,0,c)===274)return t(y,16,2,c)!==3||t(y,32,4,c)!==1?void 0:t(y,16,8,c)}}(i,s)}function e(o,r){if(r>o.length)throw new TypeError("Corrupt JPG, exceeded buffer limits");if(o[r]!==255)throw new TypeError("Invalid JPG, marker table corrupted")}z.exports={detect:function(o){return o.toString("hex",0,2)==="ffd8"},calculate:function(o){var r,i,u;for(o=o.slice(4);o.length;){if(i=o.readUInt16BE(0),h(o)&&(r=l(o,i)),e(o,i),(u=o[i+1])===192||u===193||u===194){var s=p(o,i+5);return r?{width:s.width,height:s.height,orientation:r}:s}o=o.slice(i+2)}throw new TypeError("Invalid JPG, no size found")}}},{"../readUInt":445}],454:[function(n,z,q){"use strict";z.exports={detect:function(t){if(t.toString("ascii",1,8)===`PNG\r

`){var h=t.toString("ascii",12,16);if(h==="CgBI"&&(h=t.toString("ascii",28,32)),h!=="IHDR")throw new TypeError("invalid png");return!0}},calculate:function(t){return t.toString("ascii",12,16)==="CgBI"?{width:t.readUInt32BE(32),height:t.readUInt32BE(36)}:{width:t.readUInt32BE(16),height:t.readUInt32BE(20)}}}},{}],455:[function(n,z,q){"use strict";z.exports={detect:function(t){return t.toString("ascii",0,4)==="8BPS"},calculate:function(t){return{width:t.readUInt32BE(18),height:t.readUInt32BE(14)}}}},{}],456:[function(n,z,q){"use strict";var t=/<svg\s([^>"']|"[^"]*"|'[^']*')*>/,h={root:t,width:/\swidth=(['"])([^%]+?)\1/,height:/\sheight=(['"])([^%]+?)\1/,viewbox:/\sviewBox=(['"])(.+?)\1/},p={cm:96/2.54,mm:96/2.54/10,m:96/2.54*100,pt:96/72,pc:96/72/12,em:16,ex:8};function l(o){var r=/([0-9.]+)([a-z]*)/.exec(o);if(r)return Math.round(parseFloat(r[1])*(p[r[2]]||1))}function e(o){var r=o.split(" ");return{width:l(r[2]),height:l(r[3])}}z.exports={detect:function(o){return t.test(o)},calculate:function(o){var r=o.toString("utf8").match(h.root);if(r){var i=function(u){var s=u.match(h.width),a=u.match(h.height),c=u.match(h.viewbox);return{width:s&&l(s[2]),height:a&&l(a[2]),viewbox:c&&e(c[2])}}(r[0]);if(i.width&&i.height)return function(u){return{width:u.width,height:u.height}}(i);if(i.viewbox)return function(u){var s=u.viewbox.width/u.viewbox.height;return u.width?{width:u.width,height:Math.floor(u.width/s)}:u.height?{width:Math.floor(u.height*s),height:u.height}:{width:u.viewbox.width,height:u.viewbox.height}}(i)}throw new TypeError("invalid svg")}}},{}],457:[function(n,z,q){(function(t){(function(){"use strict";var h=n("fs"),p=n("../readUInt");function l(o,r){var i=p(o,16,8,r);return(p(o,16,10,r)<<16)+i}function e(o){if(o.length>24)return o.slice(12)}z.exports={detect:function(o){var r=o.toString("hex",0,4);return r==="49492a00"||r==="4d4d002a"},calculate:function(o,r){if(!r)throw new TypeError("Tiff doesn't support buffer");var i=function(c){var f=c.toString("ascii",0,2);return f==="II"?"LE":f==="MM"?"BE":void 0}(o)==="BE",u=function(c,f){for(var g,d,m,y={};c&&c.length&&(g=p(c,16,0,f),d=p(c,16,2,f),m=p(c,32,4,f),g!==0);)m!==1||d!==3&&d!==4||(y[g]=l(c,f)),c=e(c);return y}(function(c,f,g){var d=p(c,32,4,g),m=1024,y=h.statSync(f).size;d+m>y&&(m=y-d-10);var v=t.alloc(m),T=h.openSync(f,"r");return h.readSync(T,v,0,m,d),v.slice(2)}(o,r,i),i),s=u[256],a=u[257];if(!s||!a)throw new TypeError("Invalid Tiff, missing tags");return{width:s,height:a}}}}).call(this)}).call(this,n("buffer").Buffer)},{"../readUInt":445,buffer:111,fs:109}],458:[function(n,z,q){"use strict";z.exports={detect:function(t){var h=t.toString("ascii",0,4)==="RIFF",p=t.toString("ascii",8,12)==="WEBP",l=t.toString("ascii",12,15)==="VP8";return h&&p&&l},calculate:function(t){var h=t.toString("ascii",12,16);if(t=t.slice(20,30),h==="VP8X"){var p=t[0];return!(192&p||1&p)&&function(e){return{width:1+e.readUIntLE(4,3),height:1+e.readUIntLE(7,3)}}(t)}if(h==="VP8 "&&t[0]!==47)return function(e){return{width:16383&e.readInt16LE(6),height:16383&e.readInt16LE(8)}}(t);var l=t.toString("hex",3,6);return h==="VP8L"&&l!=="9d012a"&&function(e){return{width:1+((63&e[2])<<8|e[1]),height:1+((15&e[4])<<10|e[3]<<2|(192&e[2])>>6)}}(t)}}},{}],459:[function(n,z,q){"use strict";z.exports=function(u,s){var a=u.length;if(a===0)throw new Error("Must have at least d+1 points");var c=u[0].length;if(a<=c)throw new Error("Must input at least d+1 points");var f=u.slice(0,c+1),g=t.apply(void 0,f);if(g===0)throw new Error("Input not in general position");for(var d=new Array(c+1),m=0;m<=c;++m)d[m]=m;g<0&&(d[0]=1,d[1]=0);var y=new p(d,new Array(c+1),!1),v=y.adjacent,T=new Array(c+2);for(m=0;m<=c;++m){for(var w=d.slice(),A=0;A<=c;++A)A===m&&(w[A]=-1);var E=w[0];w[0]=w[1],w[1]=E;var M=new p(w,new Array(c+1),!0);v[m]=M,T[m]=M}for(T[c+1]=y,m=0;m<=c;++m){w=v[m].vertices;var b=v[m].adjacent;for(A=0;A<=c;++A){var _=w[A];if(_<0)b[A]=y;else for(var S=0;S<=c;++S)v[S].vertices.indexOf(_)<0&&(b[A]=v[S])}}var C=new r(c,f,T),k=!!s;for(m=c+1;m<a;++m)C.insert(u[m],k);return C.boundary()};var t=n("robust-orientation"),h=n("simplicial-complex").compareCells;function p(u,s,a){this.vertices=u,this.adjacent=s,this.boundary=a,this.lastVisited=-1}function l(u,s,a){this.vertices=u,this.cell=s,this.index=a}function e(u,s){return h(u.vertices,s.vertices)}p.prototype.flip=function(){var u=this.vertices[0];this.vertices[0]=this.vertices[1],this.vertices[1]=u;var s=this.adjacent[0];this.adjacent[0]=this.adjacent[1],this.adjacent[1]=s};var o=[];function r(u,s,a){this.dimension=u,this.vertices=s,this.simplices=a,this.interior=a.filter(function(g){return!g.boundary}),this.tuple=new Array(u+1);for(var c=0;c<=u;++c)this.tuple[c]=this.vertices[c];var f=o[u];f||(f=o[u]=function(g){for(var d=["function orient(){var tuple=this.tuple;return test("],m=0;m<=g;++m)m>0&&d.push(","),d.push("tuple[",m,"]");d.push(")}return orient");var y=new Function("test",d.join("")),v=t[g+1];return v||(v=t),y(v)}(u)),this.orient=f}var i=r.prototype;i.handleBoundaryDegeneracy=function(u,s){var a=this.dimension,c=this.vertices.length-1,f=this.tuple,g=this.vertices,d=[u];for(u.lastVisited=-c;d.length>0;){(u=d.pop()).vertices;for(var m=u.adjacent,y=0;y<=a;++y){var v=m[y];if(v.boundary&&!(v.lastVisited<=-c)){for(var T=v.vertices,w=0;w<=a;++w){var A=T[w];f[w]=A<0?s:g[A]}var E=this.orient();if(E>0)return v;v.lastVisited=-c,E===0&&d.push(v)}}}return null},i.walk=function(u,s){var a=this.vertices.length-1,c=this.dimension,f=this.vertices,g=this.tuple,d=s?this.interior.length*Math.random()|0:this.interior.length-1,m=this.interior[d];e:for(;!m.boundary;){for(var y=m.vertices,v=m.adjacent,T=0;T<=c;++T)g[T]=f[y[T]];for(m.lastVisited=a,T=0;T<=c;++T){var w=v[T];if(!(w.lastVisited>=a)){var A=g[T];g[T]=u;var E=this.orient();if(g[T]=A,E<0){m=w;continue e}w.boundary?w.lastVisited=-a:w.lastVisited=a}}return}return m},i.addPeaks=function(u,s){var a=this.vertices.length-1,c=this.dimension,f=this.vertices,g=this.tuple,d=this.interior,m=this.simplices,y=[s];s.lastVisited=a,s.vertices[s.vertices.indexOf(-1)]=a,s.boundary=!1,d.push(s);for(var v=[];y.length>0;){var T=(s=y.pop()).vertices,w=s.adjacent,A=T.indexOf(a);if(!(A<0)){for(var E=0;E<=c;++E)if(E!==A){var M=w[E];if(M.boundary&&!(M.lastVisited>=a)){var b=M.vertices;if(M.lastVisited!==-a){for(var _=0,S=0;S<=c;++S)b[S]<0?(_=S,g[S]=u):g[S]=f[b[S]];if(this.orient()>0){b[_]=a,M.boundary=!1,d.push(M),y.push(M),M.lastVisited=a;continue}M.lastVisited=-a}var C=M.adjacent,k=T.slice(),L=w.slice(),I=new p(k,L,!0);m.push(I);var R=C.indexOf(s);if(!(R<0))for(C[R]=I,L[A]=M,k[E]=-1,L[E]=s,w[E]=I,I.flip(),S=0;S<=c;++S){var V=k[S];if(!(V<0||V===a)){for(var O=new Array(c-1),J=0,D=0;D<=c;++D){var B=k[D];B<0||D===S||(O[J++]=B)}v.push(new l(O,I,S))}}}}}}for(v.sort(e),E=0;E+1<v.length;E+=2){var N=v[E],F=v[E+1],H=N.index,j=F.index;H<0||j<0||(N.cell.adjacent[N.index]=F.cell,F.cell.adjacent[F.index]=N.cell)}},i.insert=function(u,s){var a=this.vertices;a.push(u);var c=this.walk(u,s);if(c){for(var f=this.dimension,g=this.tuple,d=0;d<=f;++d){var m=c.vertices[d];g[d]=m<0?u:a[m]}var y=this.orient(g);y<0||(y!==0||(c=this.handleBoundaryDegeneracy(c,u)))&&this.addPeaks(u,c)}},i.boundary=function(){for(var u=this.dimension,s=[],a=this.simplices,c=a.length,f=0;f<c;++f){var g=a[f];if(g.boundary){for(var d=new Array(u),m=g.vertices,y=0,v=0,T=0;T<=u;++T)m[T]>=0?d[y++]=m[T]:v=1&T;if(v===(1&u)){var w=d[0];d[0]=d[1],d[1]=w}s.push(d)}}return s}},{"robust-orientation":548,"simplicial-complex":558}],460:[function(n,z,q){"use strict";var t=n("binary-search-bounds");function h(y,v,T,w,A){this.mid=y,this.left=v,this.right=T,this.leftPoints=w,this.rightPoints=A,this.count=(v?v.count:0)+(T?T.count:0)+w.length}z.exports=function(y){return!y||y.length===0?new d(null):new d(g(y))};var p=h.prototype;function l(y,v){y.mid=v.mid,y.left=v.left,y.right=v.right,y.leftPoints=v.leftPoints,y.rightPoints=v.rightPoints,y.count=v.count}function e(y,v){var T=g(v);y.mid=T.mid,y.left=T.left,y.right=T.right,y.leftPoints=T.leftPoints,y.rightPoints=T.rightPoints,y.count=T.count}function o(y,v){var T=y.intervals([]);T.push(v),e(y,T)}function r(y,v){var T=y.intervals([]),w=T.indexOf(v);return w<0?0:(T.splice(w,1),e(y,T),1)}function i(y,v,T){for(var w=0;w<y.length&&y[w][0]<=v;++w){var A=T(y[w]);if(A)return A}}function u(y,v,T){for(var w=y.length-1;w>=0&&y[w][1]>=v;--w){var A=T(y[w]);if(A)return A}}function s(y,v){for(var T=0;T<y.length;++T){var w=v(y[T]);if(w)return w}}function a(y,v){return y-v}function c(y,v){var T=y[0]-v[0];return T||y[1]-v[1]}function f(y,v){var T=y[1]-v[1];return T||y[0]-v[0]}function g(y){if(y.length===0)return null;for(var v=[],T=0;T<y.length;++T)v.push(y[T][0],y[T][1]);v.sort(a);var w=v[v.length>>1],A=[],E=[],M=[];for(T=0;T<y.length;++T){var b=y[T];b[1]<w?A.push(b):w<b[0]?E.push(b):M.push(b)}var _=M,S=M.slice();return _.sort(c),S.sort(f),new h(w,g(A),g(E),_,S)}function d(y){this.root=y}p.intervals=function(y){return y.push.apply(y,this.leftPoints),this.left&&this.left.intervals(y),this.right&&this.right.intervals(y),y},p.insert=function(y){var v=this.count-this.leftPoints.length;if(this.count+=1,y[1]<this.mid)this.left?4*(this.left.count+1)>3*(v+1)?o(this,y):this.left.insert(y):this.left=g([y]);else if(y[0]>this.mid)this.right?4*(this.right.count+1)>3*(v+1)?o(this,y):this.right.insert(y):this.right=g([y]);else{var T=t.ge(this.leftPoints,y,c),w=t.ge(this.rightPoints,y,f);this.leftPoints.splice(T,0,y),this.rightPoints.splice(w,0,y)}},p.remove=function(y){var v=this.count-this.leftPoints;if(y[1]<this.mid)return this.left?4*(this.right?this.right.count:0)>3*(v-1)?r(this,y):(E=this.left.remove(y))===2?(this.left=null,this.count-=1,1):(E===1&&(this.count-=1),E):0;if(y[0]>this.mid)return this.right?4*(this.left?this.left.count:0)>3*(v-1)?r(this,y):(E=this.right.remove(y))===2?(this.right=null,this.count-=1,1):(E===1&&(this.count-=1),E):0;if(this.count===1)return this.leftPoints[0]===y?2:0;if(this.leftPoints.length===1&&this.leftPoints[0]===y){if(this.left&&this.right){for(var T=this,w=this.left;w.right;)T=w,w=w.right;if(T===this)w.right=this.right;else{var A=this.left,E=this.right;T.count-=w.count,T.right=w.left,w.left=A,w.right=E}l(this,w),this.count=(this.left?this.left.count:0)+(this.right?this.right.count:0)+this.leftPoints.length}else this.left?l(this,this.left):l(this,this.right);return 1}for(A=t.ge(this.leftPoints,y,c);A<this.leftPoints.length&&this.leftPoints[A][0]===y[0];++A)if(this.leftPoints[A]===y){for(this.count-=1,this.leftPoints.splice(A,1),E=t.ge(this.rightPoints,y,f);E<this.rightPoints.length&&this.rightPoints[E][1]===y[1];++E)if(this.rightPoints[E]===y)return this.rightPoints.splice(E,1),1}return 0},p.queryPoint=function(y,v){if(y<this.mid)return this.left&&(T=this.left.queryPoint(y,v))?T:i(this.leftPoints,y,v);if(y>this.mid){var T;return this.right&&(T=this.right.queryPoint(y,v))?T:u(this.rightPoints,y,v)}return s(this.leftPoints,v)},p.queryInterval=function(y,v,T){var w;return y<this.mid&&this.left&&(w=this.left.queryInterval(y,v,T))||v>this.mid&&this.right&&(w=this.right.queryInterval(y,v,T))?w:v<this.mid?i(this.leftPoints,v,T):y>this.mid?u(this.rightPoints,y,T):s(this.leftPoints,T)};var m=d.prototype;m.insert=function(y){this.root?this.root.insert(y):this.root=new h(y[0],null,null,[y],[y])},m.remove=function(y){if(this.root){var v=this.root.remove(y);return v===2&&(this.root=null),v!==0}return!1},m.queryPoint=function(y,v){if(this.root)return this.root.queryPoint(y,v)},m.queryInterval=function(y,v,T){if(y<=v&&this.root)return this.root.queryInterval(y,v,T)},Object.defineProperty(m,"count",{get:function(){return this.root?this.root.count:0}}),Object.defineProperty(m,"intervals",{get:function(){return this.root?this.root.intervals([]):[]}})},{"binary-search-bounds":461}],461:[function(n,z,q){arguments[4][243][0].apply(q,arguments)},{dup:243}],462:[function(n,z,q){"use strict";z.exports=function(t,h){h=h||new Array(t.length);for(var p=0;p<t.length;++p)h[t[p]]=p;return h}},{}],463:[function(n,z,q){"use strict";z.exports=function(t){for(var h=new Array(t),p=0;p<t;++p)h[p]=p;return h}},{}],464:[function(n,z,q){z.exports=!0},{}],465:[function(n,z,q){function t(h){return!!h.constructor&&typeof h.constructor.isBuffer=="function"&&h.constructor.isBuffer(h)}z.exports=function(h){return h!=null&&(t(h)||function(p){return typeof p.readFloatLE=="function"&&typeof p.slice=="function"&&t(p.slice(0,0))}(h)||!!h._isBuffer)}},{}],466:[function(n,z,q){"use strict";z.exports=typeof navigator<"u"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion))},{}],467:[function(n,z,q){"use strict";z.exports=p,z.exports.isMobile=p,z.exports.default=p;var t=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,h=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino|android|ipad|playbook|silk/i;function p(l){l||(l={});var e=l.ua;if(e||typeof navigator>"u"||(e=navigator.userAgent),e&&e.headers&&typeof e.headers["user-agent"]=="string"&&(e=e.headers["user-agent"]),typeof e!="string")return!1;var o=l.tablet?h.test(e):t.test(e);return!o&&l.tablet&&l.featureDetect&&navigator&&navigator.maxTouchPoints>1&&e.indexOf("Macintosh")!==-1&&e.indexOf("Safari")!==-1&&(o=!0),o}},{}],468:[function(n,z,q){"use strict";z.exports=function(t){var h=typeof t;return t!==null&&(h==="object"||h==="function")}},{}],469:[function(n,z,q){"use strict";var t=Object.prototype.toString;z.exports=function(h){var p;return t.call(h)==="[object Object]"&&((p=Object.getPrototypeOf(h))===null||p===Object.getPrototypeOf({}))}},{}],470:[function(n,z,q){"use strict";z.exports=function(t){for(var h,p=t.length,l=0;l<p;l++)if(((h=t.charCodeAt(l))<9||h>13)&&h!==32&&h!==133&&h!==160&&h!==5760&&h!==6158&&(h<8192||h>8205)&&h!==8232&&h!==8233&&h!==8239&&h!==8287&&h!==8288&&h!==12288&&h!==65279)return!1;return!0}},{}],471:[function(n,z,q){"use strict";z.exports=function(t){return typeof t=="string"&&(t=t.trim(),!!(/^[mzlhvcsqta]\s*[-+.0-9][^mlhvzcsqta]+/i.test(t)&&/[\dz]$/i.test(t)&&t.length>4))}},{}],472:[function(n,z,q){z.exports=function(t,h,p){return t*(1-p)+h*p}},{}],473:[function(n,z,q){(function(t,h){typeof q=="object"&&typeof z<"u"?z.exports=h():(t=t||self).mapboxgl=h()})(this,function(){"use strict";var t,h,p;function l(e,o){if(t)if(h){var r="var sharedChunk = {}; ("+t+")(sharedChunk); ("+h+")(sharedChunk);",i={};t(i),(p=o(i)).workerUrl=window.URL.createObjectURL(new Blob([r],{type:"text/javascript"}))}else h=o;else t=o}return l(0,function(e){function o(x,P){return x(P={exports:{}},P.exports),P.exports}var r=i;function i(x,P,U,te){this.cx=3*x,this.bx=3*(U-x)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*P,this.by=3*(te-P)-this.cy,this.ay=1-this.cy-this.by,this.p1x=x,this.p1y=te,this.p2x=U,this.p2y=te}i.prototype.sampleCurveX=function(x){return((this.ax*x+this.bx)*x+this.cx)*x},i.prototype.sampleCurveY=function(x){return((this.ay*x+this.by)*x+this.cy)*x},i.prototype.sampleCurveDerivativeX=function(x){return(3*this.ax*x+2*this.bx)*x+this.cx},i.prototype.solveCurveX=function(x,P){var U,te,ce,pe,Te;for(P===void 0&&(P=1e-6),ce=x,Te=0;Te<8;Te++){if(pe=this.sampleCurveX(ce)-x,Math.abs(pe)<P)return ce;var je=this.sampleCurveDerivativeX(ce);if(Math.abs(je)<1e-6)break;ce-=pe/je}if((ce=x)<(U=0))return U;if(ce>(te=1))return te;for(;U<te;){if(pe=this.sampleCurveX(ce),Math.abs(pe-x)<P)return ce;x>pe?U=ce:te=ce,ce=.5*(te-U)+U}return ce},i.prototype.solve=function(x,P){return this.sampleCurveY(this.solveCurveX(x,P))};var u=s;function s(x,P){this.x=x,this.y=P}function a(x,P,U,te){var ce=new r(x,P,U,te);return function(pe){return ce.solve(pe)}}s.prototype={clone:function(){return new s(this.x,this.y)},add:function(x){return this.clone()._add(x)},sub:function(x){return this.clone()._sub(x)},multByPoint:function(x){return this.clone()._multByPoint(x)},divByPoint:function(x){return this.clone()._divByPoint(x)},mult:function(x){return this.clone()._mult(x)},div:function(x){return this.clone()._div(x)},rotate:function(x){return this.clone()._rotate(x)},rotateAround:function(x,P){return this.clone()._rotateAround(x,P)},matMult:function(x){return this.clone()._matMult(x)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(x){return this.x===x.x&&this.y===x.y},dist:function(x){return Math.sqrt(this.distSqr(x))},distSqr:function(x){var P=x.x-this.x,U=x.y-this.y;return P*P+U*U},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(x){return Math.atan2(this.y-x.y,this.x-x.x)},angleWith:function(x){return this.angleWithSep(x.x,x.y)},angleWithSep:function(x,P){return Math.atan2(this.x*P-this.y*x,this.x*x+this.y*P)},_matMult:function(x){var P=x[2]*this.x+x[3]*this.y;return this.x=x[0]*this.x+x[1]*this.y,this.y=P,this},_add:function(x){return this.x+=x.x,this.y+=x.y,this},_sub:function(x){return this.x-=x.x,this.y-=x.y,this},_mult:function(x){return this.x*=x,this.y*=x,this},_div:function(x){return this.x/=x,this.y/=x,this},_multByPoint:function(x){return this.x*=x.x,this.y*=x.y,this},_divByPoint:function(x){return this.x/=x.x,this.y/=x.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var x=this.y;return this.y=this.x,this.x=-x,this},_rotate:function(x){var P=Math.cos(x),U=Math.sin(x),te=U*this.x+P*this.y;return this.x=P*this.x-U*this.y,this.y=te,this},_rotateAround:function(x,P){var U=Math.cos(x),te=Math.sin(x),ce=P.y+te*(this.x-P.x)+U*(this.y-P.y);return this.x=P.x+U*(this.x-P.x)-te*(this.y-P.y),this.y=ce,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},s.convert=function(x){return x instanceof s?x:Array.isArray(x)?new s(x[0],x[1]):x};var c=a(.25,.1,.25,1);function f(x,P,U){return Math.min(U,Math.max(P,x))}function g(x,P,U){var te=U-P,ce=((x-P)%te+te)%te+P;return ce===P?U:ce}function d(x){for(var P=[],U=arguments.length-1;U-- >0;)P[U]=arguments[U+1];for(var te=0,ce=P;te<ce.length;te+=1){var pe=ce[te];for(var Te in pe)x[Te]=pe[Te]}return x}var m=1;function y(){return m++}function v(){return function x(P){return P?(P^16*Math.random()>>P/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,x)}()}function T(x){return!!x&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(x)}function w(x,P){x.forEach(function(U){P[U]&&(P[U]=P[U].bind(P))})}function A(x,P){return x.indexOf(P,x.length-P.length)!==-1}function E(x,P,U){var te={};for(var ce in x)te[ce]=P.call(U||this,x[ce],ce,x);return te}function M(x,P,U){var te={};for(var ce in x)P.call(U||this,x[ce],ce,x)&&(te[ce]=x[ce]);return te}function b(x){return Array.isArray(x)?x.map(b):typeof x=="object"&&x?E(x,b):x}var _={};function S(x){_[x]||(typeof console<"u"&&console.warn(x),_[x]=!0)}function C(x,P,U){return(U.y-x.y)*(P.x-x.x)>(P.y-x.y)*(U.x-x.x)}function k(x){for(var P=0,U=0,te=x.length,ce=te-1,pe=void 0,Te=void 0;U<te;ce=U++)P+=((Te=x[ce]).x-(pe=x[U]).x)*(pe.y+Te.y);return P}function L(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function I(x){var P={};if(x.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(te,ce,pe,Te){var je=pe||Te;return P[ce]=!je||je.toLowerCase(),""}),P["max-age"]){var U=parseInt(P["max-age"],10);isNaN(U)?delete P["max-age"]:P["max-age"]=U}return P}var R=null;function V(x){if(R==null){var P=x.navigator?x.navigator.userAgent:null;R=!!x.safari||!(!P||!(/\b(iPad|iPhone|iPod)\b/.test(P)||P.match("Safari")&&!P.match("Chrome")))}return R}function O(x){try{var P=self[x];return P.setItem("_mapbox_test_",1),P.removeItem("_mapbox_test_"),!0}catch{return!1}}var J,D,B,N,F=self.performance&&self.performance.now?self.performance.now.bind(self.performance):Date.now.bind(Date),H=self.requestAnimationFrame||self.mozRequestAnimationFrame||self.webkitRequestAnimationFrame||self.msRequestAnimationFrame,j=self.cancelAnimationFrame||self.mozCancelAnimationFrame||self.webkitCancelAnimationFrame||self.msCancelAnimationFrame,G={now:F,frame:function(x){var P=H(x);return{cancel:function(){return j(P)}}},getImageData:function(x,P){P===void 0&&(P=0);var U=self.document.createElement("canvas"),te=U.getContext("2d");if(!te)throw new Error("failed to create canvas 2d context");return U.width=x.width,U.height=x.height,te.drawImage(x,0,0,x.width,x.height),te.getImageData(-P,-P,x.width+2*P,x.height+2*P)},resolveURL:function(x){return J||(J=self.document.createElement("a")),J.href=x,J.href},hardwareConcurrency:self.navigator.hardwareConcurrency||4,get devicePixelRatio(){return self.devicePixelRatio},get prefersReducedMotion(){return!!self.matchMedia&&(D==null&&(D=self.matchMedia("(prefers-reduced-motion: reduce)")),D.matches)}},W={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},Q={supported:!1,testSupport:function(x){!$&&N&&(ee?ie(x):B=x)}},$=!1,ee=!1;function ie(x){var P=x.createTexture();x.bindTexture(x.TEXTURE_2D,P);try{if(x.texImage2D(x.TEXTURE_2D,0,x.RGBA,x.RGBA,x.UNSIGNED_BYTE,N),x.isContextLost())return;Q.supported=!0}catch{}x.deleteTexture(P),$=!0}self.document&&((N=self.document.createElement("img")).onload=function(){B&&ie(B),B=null,ee=!0},N.onerror=function(){$=!0,B=null},N.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var ae="01",oe=function(x,P){this._transformRequestFn=x,this._customAccessToken=P,this._createSkuToken()};function de(x){return x.indexOf("mapbox:")===0}oe.prototype._createSkuToken=function(){var x=function(){for(var P="",U=0;U<10;U++)P+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",ae,P].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=x.token,this._skuTokenExpiresAt=x.tokenExpiresAt},oe.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},oe.prototype.transformRequest=function(x,P){return this._transformRequestFn&&this._transformRequestFn(x,P)||{url:x}},oe.prototype.normalizeStyleURL=function(x,P){if(!de(x))return x;var U=we(x);return U.path="/styles/v1"+U.path,this._makeAPIURL(U,this._customAccessToken||P)},oe.prototype.normalizeGlyphsURL=function(x,P){if(!de(x))return x;var U=we(x);return U.path="/fonts/v1"+U.path,this._makeAPIURL(U,this._customAccessToken||P)},oe.prototype.normalizeSourceURL=function(x,P){if(!de(x))return x;var U=we(x);return U.path="/v4/"+U.authority+".json",U.params.push("secure"),this._makeAPIURL(U,this._customAccessToken||P)},oe.prototype.normalizeSpriteURL=function(x,P,U,te){var ce=we(x);return de(x)?(ce.path="/styles/v1"+ce.path+"/sprite"+P+U,this._makeAPIURL(ce,this._customAccessToken||te)):(ce.path+=""+P+U,Ae(ce))},oe.prototype.normalizeTileURL=function(x,P){if(this._isSkuTokenExpired()&&this._createSkuToken(),x&&!de(x))return x;var U=we(x);U.path=U.path.replace(/(\.(png|jpg)\d*)(?=$)/,(G.devicePixelRatio>=2||P===512?"@2x":"")+(Q.supported?".webp":"$1")),U.path=U.path.replace(/^.+\/v4\//,"/"),U.path="/v4"+U.path;var te=this._customAccessToken||function(ce){for(var pe=0,Te=ce;pe<Te.length;pe+=1){var je=Te[pe].match(/^access_token=(.*)$/);if(je)return je[1]}return null}(U.params)||W.ACCESS_TOKEN;return W.REQUIRE_ACCESS_TOKEN&&te&&this._skuToken&&U.params.push("sku="+this._skuToken),this._makeAPIURL(U,te)},oe.prototype.canonicalizeTileURL=function(x,P){var U=we(x);if(!U.path.match(/(^\/v4\/)/)||!U.path.match(/\.[\w]+$/))return x;var te="mapbox://tiles/";te+=U.path.replace("/v4/","");var ce=U.params;return P&&(ce=ce.filter(function(pe){return!pe.match(/^access_token=/)})),ce.length&&(te+="?"+ce.join("&")),te},oe.prototype.canonicalizeTileset=function(x,P){for(var U=!!P&&de(P),te=[],ce=0,pe=x.tiles||[];ce<pe.length;ce+=1){var Te=pe[ce];fe(Te)?te.push(this.canonicalizeTileURL(Te,U)):te.push(Te)}return te},oe.prototype._makeAPIURL=function(x,P){var U="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",te=we(W.API_URL);if(x.protocol=te.protocol,x.authority=te.authority,te.path!=="/"&&(x.path=""+te.path+x.path),!W.REQUIRE_ACCESS_TOKEN)return Ae(x);if(!(P=P||W.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+U);if(P[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+U);return x.params=x.params.filter(function(ce){return ce.indexOf("access_token")===-1}),x.params.push("access_token="+P),Ae(x)};var le=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function fe(x){return le.test(x)}var ue=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function we(x){var P=x.match(ue);if(!P)throw new Error("Unable to parse URL object");return{protocol:P[1],authority:P[2],path:P[3]||"/",params:P[4]?P[4].split("&"):[]}}function Ae(x){var P=x.params.length?"?"+x.params.join("&"):"";return x.protocol+"://"+x.authority+x.path+P}function Se(x){if(!x)return null;var P=x.split(".");if(!P||P.length!==3)return null;try{return JSON.parse(decodeURIComponent(self.atob(P[1]).split("").map(function(U){return"%"+("00"+U.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch{return null}}var ke=function(x){this.type=x,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};ke.prototype.getStorageKey=function(x){var P,U=Se(W.ACCESS_TOKEN);return P=U&&U.u?self.btoa(encodeURIComponent(U.u).replace(/%([0-9A-F]{2})/g,function(te,ce){return String.fromCharCode(+("0x"+ce))})):W.ACCESS_TOKEN||"",x?"mapbox.eventData."+x+":"+P:"mapbox.eventData:"+P},ke.prototype.fetchEventData=function(){var x=O("localStorage"),P=this.getStorageKey(),U=this.getStorageKey("uuid");if(x)try{var te=self.localStorage.getItem(P);te&&(this.eventData=JSON.parse(te));var ce=self.localStorage.getItem(U);ce&&(this.anonId=ce)}catch{S("Unable to read from LocalStorage")}},ke.prototype.saveEventData=function(){var x=O("localStorage"),P=this.getStorageKey(),U=this.getStorageKey("uuid");if(x)try{self.localStorage.setItem(U,this.anonId),Object.keys(this.eventData).length>=1&&self.localStorage.setItem(P,JSON.stringify(this.eventData))}catch{S("Unable to write to LocalStorage")}},ke.prototype.processRequests=function(x){},ke.prototype.postEvent=function(x,P,U,te){var ce=this;if(W.EVENTS_URL){var pe=we(W.EVENTS_URL);pe.params.push("access_token="+(te||W.ACCESS_TOKEN||""));var Te={event:this.type,created:new Date(x).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.10.1",skuId:ae,userId:this.anonId},je=P?d(Te,P):Te,nt={url:Ae(pe),headers:{"Content-Type":"text/plain"},body:JSON.stringify([je])};this.pendingRequest=Ge(nt,function(dt){ce.pendingRequest=null,U(dt),ce.saveEventData(),ce.processRequests(te)})}},ke.prototype.queueRequest=function(x,P){this.queue.push(x),this.processRequests(P)};var Me,ve,ge=function(x){function P(){x.call(this,"map.load"),this.success={},this.skuToken=""}return x&&(P.__proto__=x),(P.prototype=Object.create(x&&x.prototype)).constructor=P,P.prototype.postMapLoadEvent=function(U,te,ce,pe){this.skuToken=ce,(W.EVENTS_URL&&pe||W.ACCESS_TOKEN&&Array.isArray(U)&&U.some(function(Te){return de(Te)||fe(Te)}))&&this.queueRequest({id:te,timestamp:Date.now()},pe)},P.prototype.processRequests=function(U){var te=this;if(!this.pendingRequest&&this.queue.length!==0){var ce=this.queue.shift(),pe=ce.id,Te=ce.timestamp;pe&&this.success[pe]||(this.anonId||this.fetchEventData(),T(this.anonId)||(this.anonId=v()),this.postEvent(Te,{skuToken:this.skuToken},function(je){je||pe&&(te.success[pe]=!0)},U))}},P}(ke),De=new(function(x){function P(U){x.call(this,"appUserTurnstile"),this._customAccessToken=U}return x&&(P.__proto__=x),(P.prototype=Object.create(x&&x.prototype)).constructor=P,P.prototype.postTurnstileEvent=function(U,te){W.EVENTS_URL&&W.ACCESS_TOKEN&&Array.isArray(U)&&U.some(function(ce){return de(ce)||fe(ce)})&&this.queueRequest(Date.now(),te)},P.prototype.processRequests=function(U){var te=this;if(!this.pendingRequest&&this.queue.length!==0){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var ce=Se(W.ACCESS_TOKEN),pe=ce?ce.u:W.ACCESS_TOKEN,Te=pe!==this.eventData.tokenU;T(this.anonId)||(this.anonId=v(),Te=!0);var je=this.queue.shift();if(this.eventData.lastSuccess){var nt=new Date(this.eventData.lastSuccess),dt=new Date(je),yt=(je-this.eventData.lastSuccess)/864e5;Te=Te||yt>=1||yt<-1||nt.getDate()!==dt.getDate()}else Te=!0;if(!Te)return this.processRequests();this.postEvent(je,{"enabled.telemetry":!1},function(kt){kt||(te.eventData.lastSuccess=je,te.eventData.tokenU=pe)},U)}},P}(ke)),_e=De.postTurnstileEvent.bind(De),Pe=new ge,Fe=Pe.postMapLoadEvent.bind(Pe),ze=500,He=50;function et(){self.caches&&!Me&&(Me=self.caches.open("mapbox-tiles"))}function Re(x){var P=x.indexOf("?");return P<0?x:x.slice(0,P)}var Ze,Ke=1/0;function $e(){return Ze==null&&(Ze=self.OffscreenCanvas&&new self.OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),Ze}var rt={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(rt);var at,lt,gt=function(x){function P(U,te,ce){te===401&&fe(ce)&&(U+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),x.call(this,U),this.status=te,this.url=ce,this.name=this.constructor.name,this.message=U}return x&&(P.__proto__=x),(P.prototype=Object.create(x&&x.prototype)).constructor=P,P.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},P}(Error),Ie=L()?function(){return self.worker&&self.worker.referrer}:function(){return(self.location.protocol==="blob:"?self.parent:self).location.href},be=function(x,P){if(!(/^file:/.test(U=x.url)||/^file:/.test(Ie())&&!/^\w+:/.test(U))){if(self.fetch&&self.Request&&self.AbortController&&self.Request.prototype.hasOwnProperty("signal"))return function(te,ce){var pe,Te=new self.AbortController,je=new self.Request(te.url,{method:te.method||"GET",body:te.body,credentials:te.credentials,headers:te.headers,referrer:Ie(),signal:Te.signal}),nt=!1,dt=!1,yt=(pe=je.url).indexOf("sku=")>0&&fe(pe);te.type==="json"&&je.headers.set("Accept","application/json");var kt=function(Rt,rr,ar){if(!dt){if(Rt&&Rt.message!=="SecurityError"&&S(Rt),rr&&ar)return Lt(rr);var _r=Date.now();self.fetch(je).then(function(dr){if(dr.ok){var Er=yt?dr.clone():null;return Lt(dr,Er,_r)}return ce(new gt(dr.statusText,dr.status,te.url))}).catch(function(dr){dr.code!==20&&ce(new Error(dr.message))})}},Lt=function(Rt,rr,ar){(te.type==="arrayBuffer"?Rt.arrayBuffer():te.type==="json"?Rt.json():Rt.text()).then(function(_r){dt||(rr&&ar&&function(dr,Er,zr){if(et(),Me){var Ur={status:Er.status,statusText:Er.statusText,headers:new self.Headers};Er.headers.forEach(function(en,hn){return Ur.headers.set(hn,en)});var Vr=I(Er.headers.get("Cache-Control")||"");Vr["no-store"]||(Vr["max-age"]&&Ur.headers.set("Expires",new Date(zr+1e3*Vr["max-age"]).toUTCString()),new Date(Ur.headers.get("Expires")).getTime()-zr<42e4||function(en,hn){if(ve===void 0)try{new Response(new ReadableStream),ve=!0}catch{ve=!1}ve?hn(en.body):en.blob().then(hn)}(Er,function(en){var hn=new self.Response(en,Ur);et(),Me&&Me.then(function(_n){return _n.put(Re(dr.url),hn)}).catch(function(_n){return S(_n.message)})}))}}(je,rr,ar),nt=!0,ce(null,_r,Rt.headers.get("Cache-Control"),Rt.headers.get("Expires")))}).catch(function(_r){dt||ce(new Error(_r.message))})};return yt?function(Rt,rr){if(et(),!Me)return rr(null);var ar=Re(Rt.url);Me.then(function(_r){_r.match(ar).then(function(dr){var Er=function(zr){if(!zr)return!1;var Ur=new Date(zr.headers.get("Expires")||0),Vr=I(zr.headers.get("Cache-Control")||"");return Ur>Date.now()&&!Vr["no-cache"]}(dr);_r.delete(ar),Er&&_r.put(ar,dr.clone()),rr(null,dr,Er)}).catch(rr)}).catch(rr)}(je,kt):kt(null,null),{cancel:function(){dt=!0,nt||Te.abort()}}}(x,P);if(L()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",x,P,void 0,!0)}var U;return function(te,ce){var pe=new self.XMLHttpRequest;for(var Te in pe.open(te.method||"GET",te.url,!0),te.type==="arrayBuffer"&&(pe.responseType="arraybuffer"),te.headers)pe.setRequestHeader(Te,te.headers[Te]);return te.type==="json"&&(pe.responseType="text",pe.setRequestHeader("Accept","application/json")),pe.withCredentials=te.credentials==="include",pe.onerror=function(){ce(new Error(pe.statusText))},pe.onload=function(){if((pe.status>=200&&pe.status<300||pe.status===0)&&pe.response!==null){var je=pe.response;if(te.type==="json")try{je=JSON.parse(pe.response)}catch(nt){return ce(nt)}ce(null,je,pe.getResponseHeader("Cache-Control"),pe.getResponseHeader("Expires"))}else ce(new gt(pe.statusText,pe.status,te.url))},pe.send(te.body),{cancel:function(){return pe.abort()}}}(x,P)},We=function(x,P){return be(d(x,{type:"arrayBuffer"}),P)},Ge=function(x,P){return be(d(x,{method:"POST"}),P)};at=[],lt=0;var st=function(x,P){if(Q.supported&&(x.headers||(x.headers={}),x.headers.accept="image/webp,*/*"),lt>=W.MAX_PARALLEL_IMAGE_REQUESTS){var U={requestParameters:x,callback:P,cancelled:!1,cancel:function(){this.cancelled=!0}};return at.push(U),U}lt++;var te=!1,ce=function(){if(!te)for(te=!0,lt--;at.length&&lt<W.MAX_PARALLEL_IMAGE_REQUESTS;){var Te=at.shift();Te.cancelled||(Te.cancel=st(Te.requestParameters,Te.callback).cancel)}},pe=We(x,function(Te,je,nt,dt){ce(),Te?P(Te):je&&($e()?function(yt,kt){var Lt=new self.Blob([new Uint8Array(yt)],{type:"image/png"});self.createImageBitmap(Lt).then(function(Rt){kt(null,Rt)}).catch(function(Rt){kt(new Error("Could not load image because of "+Rt.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}(je,P):function(yt,kt,Lt,Rt){var rr=new self.Image,ar=self.URL;rr.onload=function(){kt(null,rr),ar.revokeObjectURL(rr.src)},rr.onerror=function(){return kt(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var _r=new self.Blob([new Uint8Array(yt)],{type:"image/png"});rr.cacheControl=Lt,rr.expires=Rt,rr.src=yt.byteLength?ar.createObjectURL(_r):"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII="}(je,P,nt,dt))});return{cancel:function(){pe.cancel(),ce()}}};function ot(x,P,U){U[x]&&U[x].indexOf(P)!==-1||(U[x]=U[x]||[],U[x].push(P))}function Ce(x,P,U){if(U&&U[x]){var te=U[x].indexOf(P);te!==-1&&U[x].splice(te,1)}}var Ue=function(x,P){P===void 0&&(P={}),d(this,P),this.type=x},Ye=function(x){function P(U,te){te===void 0&&(te={}),x.call(this,"error",d({error:U},te))}return x&&(P.__proto__=x),(P.prototype=Object.create(x&&x.prototype)).constructor=P,P}(Ue),xe=function(){};xe.prototype.on=function(x,P){return this._listeners=this._listeners||{},ot(x,P,this._listeners),this},xe.prototype.off=function(x,P){return Ce(x,P,this._listeners),Ce(x,P,this._oneTimeListeners),this},xe.prototype.once=function(x,P){return this._oneTimeListeners=this._oneTimeListeners||{},ot(x,P,this._oneTimeListeners),this},xe.prototype.fire=function(x,P){typeof x=="string"&&(x=new Ue(x,P||{}));var U=x.type;if(this.listens(U)){x.target=this;for(var te=0,ce=this._listeners&&this._listeners[U]?this._listeners[U].slice():[];te<ce.length;te+=1)ce[te].call(this,x);for(var pe=0,Te=this._oneTimeListeners&&this._oneTimeListeners[U]?this._oneTimeListeners[U].slice():[];pe<Te.length;pe+=1){var je=Te[pe];Ce(U,je,this._oneTimeListeners),je.call(this,x)}var nt=this._eventedParent;nt&&(d(x,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),nt.fire(x))}else x instanceof Ye&&console.error(x.error);return this},xe.prototype.listens=function(x){return this._listeners&&this._listeners[x]&&this._listeners[x].length>0||this._oneTimeListeners&&this._oneTimeListeners[x]&&this._oneTimeListeners[x].length>0||this._eventedParent&&this._eventedParent.listens(x)},xe.prototype.setEventedParent=function(x,P){return this._eventedParent=x,this._eventedParentData=P,this};var Ee={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},expression_name:{type:"enum",values:{let:{group:"Variable binding"},var:{group:"Variable binding"},literal:{group:"Types"},array:{group:"Types"},at:{group:"Lookup"},in:{group:"Lookup"},"index-of":{group:"Lookup"},slice:{group:"Lookup"},case:{group:"Decision"},match:{group:"Decision"},coalesce:{group:"Decision"},step:{group:"Ramps, scales, curves"},interpolate:{group:"Ramps, scales, curves"},"interpolate-hcl":{group:"Ramps, scales, curves"},"interpolate-lab":{group:"Ramps, scales, curves"},ln2:{group:"Math"},pi:{group:"Math"},e:{group:"Math"},typeof:{group:"Types"},string:{group:"Types"},number:{group:"Types"},boolean:{group:"Types"},object:{group:"Types"},collator:{group:"Types"},format:{group:"Types"},image:{group:"Types"},"number-format":{group:"Types"},"to-string":{group:"Types"},"to-number":{group:"Types"},"to-boolean":{group:"Types"},"to-rgba":{group:"Color"},"to-color":{group:"Types"},rgb:{group:"Color"},rgba:{group:"Color"},get:{group:"Lookup"},has:{group:"Lookup"},length:{group:"Lookup"},properties:{group:"Feature data"},"feature-state":{group:"Feature data"},"geometry-type":{group:"Feature data"},id:{group:"Feature data"},zoom:{group:"Zoom"},"heatmap-density":{group:"Heatmap"},"line-progress":{group:"Feature data"},accumulated:{group:"Feature data"},"+":{group:"Math"},"*":{group:"Math"},"-":{group:"Math"},"/":{group:"Math"},"%":{group:"Math"},"^":{group:"Math"},sqrt:{group:"Math"},log10:{group:"Math"},ln:{group:"Math"},log2:{group:"Math"},sin:{group:"Math"},cos:{group:"Math"},tan:{group:"Math"},asin:{group:"Math"},acos:{group:"Math"},atan:{group:"Math"},min:{group:"Math"},max:{group:"Math"},round:{group:"Math"},abs:{group:"Math"},ceil:{group:"Math"},floor:{group:"Math"},distance:{group:"Math"},"==":{group:"Decision"},"!=":{group:"Decision"},">":{group:"Decision"},"<":{group:"Decision"},">=":{group:"Decision"},"<=":{group:"Decision"},all:{group:"Decision"},any:{group:"Decision"},"!":{group:"Decision"},within:{group:"Decision"},"is-supported-script":{group:"String"},upcase:{group:"String"},downcase:{group:"String"},concat:{group:"String"},"resolved-locale":{group:"String"}}},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},Je=function(x,P,U,te){this.message=(x?x+": ":"")+U,te&&(this.identifier=te),P!=null&&P.__line__&&(this.line=P.__line__)};function it(x){var P=x.value;return P?[new Je(x.key,P,"constants have been deprecated as of v8")]:[]}function ht(x){for(var P=[],U=arguments.length-1;U-- >0;)P[U]=arguments[U+1];for(var te=0,ce=P;te<ce.length;te+=1){var pe=ce[te];for(var Te in pe)x[Te]=pe[Te]}return x}function ct(x){return x instanceof Number||x instanceof String||x instanceof Boolean?x.valueOf():x}function mt(x){if(Array.isArray(x))return x.map(mt);if(x instanceof Object&&!(x instanceof Number||x instanceof String||x instanceof Boolean)){var P={};for(var U in x)P[U]=mt(x[U]);return P}return ct(x)}var bt=function(x){function P(U,te){x.call(this,te),this.message=te,this.key=U}return x&&(P.__proto__=x),(P.prototype=Object.create(x&&x.prototype)).constructor=P,P}(Error),Et=function(x,P){P===void 0&&(P=[]),this.parent=x,this.bindings={};for(var U=0,te=P;U<te.length;U+=1){var ce=te[U];this.bindings[ce[0]]=ce[1]}};Et.prototype.concat=function(x){return new Et(this,x)},Et.prototype.get=function(x){if(this.bindings[x])return this.bindings[x];if(this.parent)return this.parent.get(x);throw new Error(x+" not found in scope.")},Et.prototype.has=function(x){return!!this.bindings[x]||!!this.parent&&this.parent.has(x)};var Mt={kind:"null"},_t={kind:"number"},xt={kind:"string"},At={kind:"boolean"},It={kind:"color"},Nt={kind:"object"},Ot={kind:"value"},Yt={kind:"collator"},Pt={kind:"formatted"},Ne={kind:"resolvedImage"};function ut(x,P){return{kind:"array",itemType:x,N:P}}function wt(x){if(x.kind==="array"){var P=wt(x.itemType);return typeof x.N=="number"?"array<"+P+", "+x.N+">":x.itemType.kind==="value"?"array":"array<"+P+">"}return x.kind}var Bt=[Mt,_t,xt,At,It,Pt,Nt,ut(Ot),Ne];function Jt(x,P){if(P.kind==="error")return null;if(x.kind==="array"){if(P.kind==="array"&&(P.N===0&&P.itemType.kind==="value"||!Jt(x.itemType,P.itemType))&&(typeof x.N!="number"||x.N===P.N))return null}else{if(x.kind===P.kind)return null;if(x.kind==="value"){for(var U=0,te=Bt;U<te.length;U+=1)if(!Jt(te[U],P))return null}}return"Expected "+wt(x)+" but found "+wt(P)+" instead."}function er(x,P){return P.some(function(U){return U.kind===x.kind})}function or(x,P){return P.some(function(U){return U==="null"?x===null:U==="array"?Array.isArray(x):U==="object"?x&&!Array.isArray(x)&&typeof x=="object":U===typeof x})}var zt=o(function(x,P){var U={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function te(je){return(je=Math.round(je))<0?0:je>255?255:je}function ce(je){return te(je[je.length-1]==="%"?parseFloat(je)/100*255:parseInt(je))}function pe(je){return(nt=je[je.length-1]==="%"?parseFloat(je)/100:parseFloat(je))<0?0:nt>1?1:nt;var nt}function Te(je,nt,dt){return dt<0?dt+=1:dt>1&&(dt-=1),6*dt<1?je+(nt-je)*dt*6:2*dt<1?nt:3*dt<2?je+(nt-je)*(2/3-dt)*6:je}try{P.parseCSSColor=function(je){var nt,dt=je.replace(/ /g,"").toLowerCase();if(dt in U)return U[dt].slice();if(dt[0]==="#")return dt.length===4?(nt=parseInt(dt.substr(1),16))>=0&&nt<=4095?[(3840&nt)>>4|(3840&nt)>>8,240&nt|(240&nt)>>4,15&nt|(15&nt)<<4,1]:null:dt.length===7&&(nt=parseInt(dt.substr(1),16))>=0&&nt<=16777215?[(16711680&nt)>>16,(65280&nt)>>8,255&nt,1]:null;var yt=dt.indexOf("("),kt=dt.indexOf(")");if(yt!==-1&&kt+1===dt.length){var Lt=dt.substr(0,yt),Rt=dt.substr(yt+1,kt-(yt+1)).split(","),rr=1;switch(Lt){case"rgba":if(Rt.length!==4)return null;rr=pe(Rt.pop());case"rgb":return Rt.length!==3?null:[ce(Rt[0]),ce(Rt[1]),ce(Rt[2]),rr];case"hsla":if(Rt.length!==4)return null;rr=pe(Rt.pop());case"hsl":if(Rt.length!==3)return null;var ar=(parseFloat(Rt[0])%360+360)%360/360,_r=pe(Rt[1]),dr=pe(Rt[2]),Er=dr<=.5?dr*(_r+1):dr+_r-dr*_r,zr=2*dr-Er;return[te(255*Te(zr,Er,ar+1/3)),te(255*Te(zr,Er,ar)),te(255*Te(zr,Er,ar-1/3)),rr];default:return null}}return null}}catch{}}).parseCSSColor,Qt=function(x,P,U,te){te===void 0&&(te=1),this.r=x,this.g=P,this.b=U,this.a=te};Qt.parse=function(x){if(x){if(x instanceof Qt)return x;if(typeof x=="string"){var P=zt(x);if(P)return new Qt(P[0]/255*P[3],P[1]/255*P[3],P[2]/255*P[3],P[3])}}},Qt.prototype.toString=function(){var x=this.toArray(),P=x[1],U=x[2],te=x[3];return"rgba("+Math.round(x[0])+","+Math.round(P)+","+Math.round(U)+","+te+")"},Qt.prototype.toArray=function(){var x=this.a;return x===0?[0,0,0,0]:[255*this.r/x,255*this.g/x,255*this.b/x,x]},Qt.black=new Qt(0,0,0,1),Qt.white=new Qt(1,1,1,1),Qt.transparent=new Qt(0,0,0,0),Qt.red=new Qt(1,0,0,1);var cr=function(x,P,U){this.sensitivity=x?P?"variant":"case":P?"accent":"base",this.locale=U,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};cr.prototype.compare=function(x,P){return this.collator.compare(x,P)},cr.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var Dt=function(x,P,U,te,ce){this.text=x,this.image=P,this.scale=U,this.fontStack=te,this.textColor=ce},Ut=function(x){this.sections=x};Ut.fromString=function(x){return new Ut([new Dt(x,null,null,null,null)])},Ut.prototype.isEmpty=function(){return this.sections.length===0||!this.sections.some(function(x){return x.text.length!==0||x.image&&x.image.name.length!==0})},Ut.factory=function(x){return x instanceof Ut?x:Ut.fromString(x)},Ut.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(x){return x.text}).join("")},Ut.prototype.serialize=function(){for(var x=["format"],P=0,U=this.sections;P<U.length;P+=1){var te=U[P];if(te.image)x.push(["image",te.image.name]);else{x.push(te.text);var ce={};te.fontStack&&(ce["text-font"]=["literal",te.fontStack.split(",")]),te.scale&&(ce["font-scale"]=te.scale),te.textColor&&(ce["text-color"]=["rgba"].concat(te.textColor.toArray())),x.push(ce)}}return x};var ur=function(x){this.name=x.name,this.available=x.available};function Sr(x,P,U,te){return typeof x=="number"&&x>=0&&x<=255&&typeof P=="number"&&P>=0&&P<=255&&typeof U=="number"&&U>=0&&U<=255?te===void 0||typeof te=="number"&&te>=0&&te<=1?null:"Invalid rgba value ["+[x,P,U,te].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+(typeof te=="number"?[x,P,U,te]:[x,P,U]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function Lr(x){if(x===null||typeof x=="string"||typeof x=="boolean"||typeof x=="number"||x instanceof Qt||x instanceof cr||x instanceof Ut||x instanceof ur)return!0;if(Array.isArray(x)){for(var P=0,U=x;P<U.length;P+=1)if(!Lr(U[P]))return!1;return!0}if(typeof x=="object"){for(var te in x)if(!Lr(x[te]))return!1;return!0}return!1}function Hr(x){if(x===null)return Mt;if(typeof x=="string")return xt;if(typeof x=="boolean")return At;if(typeof x=="number")return _t;if(x instanceof Qt)return It;if(x instanceof cr)return Yt;if(x instanceof Ut)return Pt;if(x instanceof ur)return Ne;if(Array.isArray(x)){for(var P,U=x.length,te=0,ce=x;te<ce.length;te+=1){var pe=Hr(ce[te]);if(P){if(P===pe)continue;P=Ot;break}P=pe}return ut(P||Ot,U)}return Nt}function Kr(x){var P=typeof x;return x===null?"":P==="string"||P==="number"||P==="boolean"?String(x):x instanceof Qt||x instanceof Ut||x instanceof ur?x.toString():JSON.stringify(x)}ur.prototype.toString=function(){return this.name},ur.fromString=function(x){return x?new ur({name:x,available:!1}):null},ur.prototype.serialize=function(){return["image",this.name]};var Ir=function(x,P){this.type=x,this.value=P};Ir.parse=function(x,P){if(x.length!==2)return P.error("'literal' expression requires exactly one argument, but found "+(x.length-1)+" instead.");if(!Lr(x[1]))return P.error("invalid value");var U=x[1],te=Hr(U),ce=P.expectedType;return te.kind!=="array"||te.N!==0||!ce||ce.kind!=="array"||typeof ce.N=="number"&&ce.N!==0||(te=ce),new Ir(te,U)},Ir.prototype.evaluate=function(){return this.value},Ir.prototype.eachChild=function(){},Ir.prototype.outputDefined=function(){return!0},Ir.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Qt?["rgba"].concat(this.value.toArray()):this.value instanceof Ut?this.value.serialize():this.value};var kr=function(x){this.name="ExpressionEvaluationError",this.message=x};kr.prototype.toJSON=function(){return this.message};var rn={string:xt,number:_t,boolean:At,object:Nt},Qr=function(x,P){this.type=x,this.args=P};Qr.parse=function(x,P){if(x.length<2)return P.error("Expected at least one argument.");var U,te=1,ce=x[0];if(ce==="array"){var pe,Te;if(x.length>2){var je=x[1];if(typeof je!="string"||!(je in rn)||je==="object")return P.error('The item type argument of "array" must be one of string, number, boolean',1);pe=rn[je],te++}else pe=Ot;if(x.length>3){if(x[2]!==null&&(typeof x[2]!="number"||x[2]<0||x[2]!==Math.floor(x[2])))return P.error('The length argument to "array" must be a positive integer literal',2);Te=x[2],te++}U=ut(pe,Te)}else U=rn[ce];for(var nt=[];te<x.length;te++){var dt=P.parse(x[te],te,Ot);if(!dt)return null;nt.push(dt)}return new Qr(U,nt)},Qr.prototype.evaluate=function(x){for(var P=0;P<this.args.length;P++){var U=this.args[P].evaluate(x);if(!Jt(this.type,Hr(U)))return U;if(P===this.args.length-1)throw new kr("Expected value to be of type "+wt(this.type)+", but found "+wt(Hr(U))+" instead.")}return null},Qr.prototype.eachChild=function(x){this.args.forEach(x)},Qr.prototype.outputDefined=function(){return this.args.every(function(x){return x.outputDefined()})},Qr.prototype.serialize=function(){var x=this.type,P=[x.kind];if(x.kind==="array"){var U=x.itemType;if(U.kind==="string"||U.kind==="number"||U.kind==="boolean"){P.push(U.kind);var te=x.N;(typeof te=="number"||this.args.length>1)&&P.push(te)}}return P.concat(this.args.map(function(ce){return ce.serialize()}))};var nn=function(x){this.type=Pt,this.sections=x};nn.parse=function(x,P){if(x.length<2)return P.error("Expected at least one argument.");var U=x[1];if(!Array.isArray(U)&&typeof U=="object")return P.error("First argument must be an image or text section.");for(var te=[],ce=!1,pe=1;pe<=x.length-1;++pe){var Te=x[pe];if(ce&&typeof Te=="object"&&!Array.isArray(Te)){ce=!1;var je=null;if(Te["font-scale"]&&!(je=P.parse(Te["font-scale"],1,_t)))return null;var nt=null;if(Te["text-font"]&&!(nt=P.parse(Te["text-font"],1,ut(xt))))return null;var dt=null;if(Te["text-color"]&&!(dt=P.parse(Te["text-color"],1,It)))return null;var yt=te[te.length-1];yt.scale=je,yt.font=nt,yt.textColor=dt}else{var kt=P.parse(x[pe],1,Ot);if(!kt)return null;var Lt=kt.type.kind;if(Lt!=="string"&&Lt!=="value"&&Lt!=="null"&&Lt!=="resolvedImage")return P.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");ce=!0,te.push({content:kt,scale:null,font:null,textColor:null})}}return new nn(te)},nn.prototype.evaluate=function(x){return new Ut(this.sections.map(function(P){var U=P.content.evaluate(x);return Hr(U)===Ne?new Dt("",U,null,null,null):new Dt(Kr(U),null,P.scale?P.scale.evaluate(x):null,P.font?P.font.evaluate(x).join(","):null,P.textColor?P.textColor.evaluate(x):null)}))},nn.prototype.eachChild=function(x){for(var P=0,U=this.sections;P<U.length;P+=1){var te=U[P];x(te.content),te.scale&&x(te.scale),te.font&&x(te.font),te.textColor&&x(te.textColor)}},nn.prototype.outputDefined=function(){return!1},nn.prototype.serialize=function(){for(var x=["format"],P=0,U=this.sections;P<U.length;P+=1){var te=U[P];x.push(te.content.serialize());var ce={};te.scale&&(ce["font-scale"]=te.scale.serialize()),te.font&&(ce["text-font"]=te.font.serialize()),te.textColor&&(ce["text-color"]=te.textColor.serialize()),x.push(ce)}return x};var Xr=function(x){this.type=Ne,this.input=x};Xr.parse=function(x,P){if(x.length!==2)return P.error("Expected two arguments.");var U=P.parse(x[1],1,xt);return U?new Xr(U):P.error("No image name provided.")},Xr.prototype.evaluate=function(x){var P=this.input.evaluate(x),U=ur.fromString(P);return U&&x.availableImages&&(U.available=x.availableImages.indexOf(P)>-1),U},Xr.prototype.eachChild=function(x){x(this.input)},Xr.prototype.outputDefined=function(){return!1},Xr.prototype.serialize=function(){return["image",this.input.serialize()]};var Nr={"to-boolean":At,"to-color":It,"to-number":_t,"to-string":xt},Br=function(x,P){this.type=x,this.args=P};Br.parse=function(x,P){if(x.length<2)return P.error("Expected at least one argument.");var U=x[0];if((U==="to-boolean"||U==="to-string")&&x.length!==2)return P.error("Expected one argument.");for(var te=Nr[U],ce=[],pe=1;pe<x.length;pe++){var Te=P.parse(x[pe],pe,Ot);if(!Te)return null;ce.push(Te)}return new Br(te,ce)},Br.prototype.evaluate=function(x){if(this.type.kind==="boolean")return!!this.args[0].evaluate(x);if(this.type.kind==="color"){for(var P,U,te=0,ce=this.args;te<ce.length;te+=1){if(U=null,(P=ce[te].evaluate(x))instanceof Qt)return P;if(typeof P=="string"){var pe=x.parseColor(P);if(pe)return pe}else if(Array.isArray(P)&&!(U=P.length<3||P.length>4?"Invalid rbga value "+JSON.stringify(P)+": expected an array containing either three or four numeric values.":Sr(P[0],P[1],P[2],P[3])))return new Qt(P[0]/255,P[1]/255,P[2]/255,P[3])}throw new kr(U||"Could not parse color from value '"+(typeof P=="string"?P:String(JSON.stringify(P)))+"'")}if(this.type.kind==="number"){for(var Te=null,je=0,nt=this.args;je<nt.length;je+=1){if((Te=nt[je].evaluate(x))===null)return 0;var dt=Number(Te);if(!isNaN(dt))return dt}throw new kr("Could not convert "+JSON.stringify(Te)+" to number.")}return this.type.kind==="formatted"?Ut.fromString(Kr(this.args[0].evaluate(x))):this.type.kind==="resolvedImage"?ur.fromString(Kr(this.args[0].evaluate(x))):Kr(this.args[0].evaluate(x))},Br.prototype.eachChild=function(x){this.args.forEach(x)},Br.prototype.outputDefined=function(){return this.args.every(function(x){return x.outputDefined()})},Br.prototype.serialize=function(){if(this.type.kind==="formatted")return new nn([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Xr(this.args[0]).serialize();var x=["to-"+this.type.kind];return this.eachChild(function(P){x.push(P.serialize())}),x};var on=["Unknown","Point","LineString","Polygon"],cn=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};cn.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},cn.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?on[this.feature.type]:this.feature.type:null},cn.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},cn.prototype.canonicalID=function(){return this.canonical},cn.prototype.properties=function(){return this.feature&&this.feature.properties||{}},cn.prototype.parseColor=function(x){var P=this._parseColorCache[x];return P||(P=this._parseColorCache[x]=Qt.parse(x)),P};var un=function(x,P,U,te){this.name=x,this.type=P,this._evaluate=U,this.args=te};un.prototype.evaluate=function(x){return this._evaluate(x,this.args)},un.prototype.eachChild=function(x){this.args.forEach(x)},un.prototype.outputDefined=function(){return!1},un.prototype.serialize=function(){return[this.name].concat(this.args.map(function(x){return x.serialize()}))},un.parse=function(x,P){var U,te=x[0],ce=un.definitions[te];if(!ce)return P.error('Unknown expression "'+te+'". If you wanted a literal array, use ["literal", [...]].',0);for(var pe=Array.isArray(ce)?ce[0]:ce.type,Te=Array.isArray(ce)?[[ce[1],ce[2]]]:ce.overloads,je=Te.filter(function(Fn){var wn=Fn[0];return!Array.isArray(wn)||wn.length===x.length-1}),nt=null,dt=0,yt=je;dt<yt.length;dt+=1){var kt=yt[dt],Lt=kt[0],Rt=kt[1];nt=new bn(P.registry,P.path,null,P.scope);for(var rr=[],ar=!1,_r=1;_r<x.length;_r++){var dr=x[_r],Er=Array.isArray(Lt)?Lt[_r-1]:Lt.type,zr=nt.parse(dr,1+rr.length,Er);if(!zr){ar=!0;break}rr.push(zr)}if(!ar)if(Array.isArray(Lt)&&Lt.length!==rr.length)nt.error("Expected "+Lt.length+" arguments, but found "+rr.length+" instead.");else{for(var Ur=0;Ur<rr.length;Ur++){var Vr=Array.isArray(Lt)?Lt[Ur]:Lt.type,en=rr[Ur];nt.concat(Ur+1).checkSubtype(Vr,en.type)}if(nt.errors.length===0)return new un(te,pe,Rt,rr)}}if(je.length===1)(U=P.errors).push.apply(U,nt.errors);else{for(var hn=(je.length?je:Te).map(function(Fn){var wn;return wn=Fn[0],Array.isArray(wn)?"("+wn.map(wt).join(", ")+")":"("+wt(wn.type)+"...)"}).join(" | "),_n=[],On=1;On<x.length;On++){var kn=P.parse(x[On],1+_n.length);if(!kn)return null;_n.push(wt(kn.type))}P.error("Expected arguments of type "+hn+", but found ("+_n.join(", ")+") instead.")}return null},un.register=function(x,P){for(var U in un.definitions=P,P)x[U]=un};var Zr=function(x,P,U){this.type=Yt,this.locale=U,this.caseSensitive=x,this.diacriticSensitive=P};function yn(x,P){x[0]=Math.min(x[0],P[0]),x[1]=Math.min(x[1],P[1]),x[2]=Math.max(x[2],P[0]),x[3]=Math.max(x[3],P[1])}function In(x,P){return!(x[0]<=P[0]||x[2]>=P[2]||x[1]<=P[1]||x[3]>=P[3])}function Un(x,P){var U=(180+x[0])/360,te=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+x[1]*Math.PI/360)))/360,ce=Math.pow(2,P.z);return[Math.round(U*ce*8192),Math.round(te*ce*8192)]}function Kn(x,P,U){return P[1]>x[1]!=U[1]>x[1]&&x[0]<(U[0]-P[0])*(x[1]-P[1])/(U[1]-P[1])+P[0]}function vt(x,P){for(var U,te,ce,pe,Te,je,nt,dt=!1,yt=0,kt=P.length;yt<kt;yt++)for(var Lt=P[yt],Rt=0,rr=Lt.length;Rt<rr-1;Rt++){if((pe=(U=x)[0]-(te=Lt[Rt])[0])*(nt=U[1]-(ce=Lt[Rt+1])[1])-(je=U[0]-ce[0])*(Te=U[1]-te[1])==0&&pe*je<=0&&Te*nt<=0)return!1;Kn(x,Lt[Rt],Lt[Rt+1])&&(dt=!dt)}return dt}function Zt(x,P){for(var U=0;U<P.length;U++)if(vt(x,P[U]))return!0;return!1}function qt(x,P,U,te){var ce=te[0]-U[0],pe=te[1]-U[1],Te=(x[0]-U[0])*pe-ce*(x[1]-U[1]),je=(P[0]-U[0])*pe-ce*(P[1]-U[1]);return Te>0&&je<0||Te<0&&je>0}function yr(x,P,U){for(var te=0,ce=U;te<ce.length;te+=1)for(var pe=ce[te],Te=0;Te<pe.length-1;++Te)if((kt=[(yt=pe[Te+1])[0]-(dt=pe[Te])[0],yt[1]-dt[1]])[0]*(Lt=[(nt=P)[0]-(je=x)[0],nt[1]-je[1]])[1]-kt[1]*Lt[0]!=0&&qt(je,nt,dt,yt)&&qt(dt,yt,je,nt))return!0;var je,nt,dt,yt,kt,Lt;return!1}function Dr(x,P){for(var U=0;U<x.length;++U)if(!vt(x[U],P))return!1;for(var te=0;te<x.length-1;++te)if(yr(x[te],x[te+1],P))return!1;return!0}function Mr(x,P){for(var U=0;U<P.length;U++)if(Dr(x,P[U]))return!0;return!1}function xr(x,P,U){for(var te=[],ce=0;ce<x.length;ce++){for(var pe=[],Te=0;Te<x[ce].length;Te++){var je=Un(x[ce][Te],U);yn(P,je),pe.push(je)}te.push(pe)}return te}function hr(x,P,U){for(var te=[],ce=0;ce<x.length;ce++){var pe=xr(x[ce],P,U);te.push(pe)}return te}function Tr(x,P,U,te){if(x[0]<U[0]||x[0]>U[2]){var ce=.5*te,pe=x[0]-U[0]>ce?-te:U[0]-x[0]>ce?te:0;pe===0&&(pe=x[0]-U[2]>ce?-te:U[2]-x[0]>ce?te:0),x[0]+=pe}yn(P,x)}function fr(x,P,U,te){for(var ce=8192*Math.pow(2,te.z),pe=[8192*te.x,8192*te.y],Te=[],je=0,nt=x;je<nt.length;je+=1)for(var dt=0,yt=nt[je];dt<yt.length;dt+=1){var kt=yt[dt],Lt=[kt.x+pe[0],kt.y+pe[1]];Tr(Lt,P,U,ce),Te.push(Lt)}return Te}function br(x,P,U,te){for(var ce,pe=8192*Math.pow(2,te.z),Te=[8192*te.x,8192*te.y],je=[],nt=0,dt=x;nt<dt.length;nt+=1){for(var yt=[],kt=0,Lt=dt[nt];kt<Lt.length;kt+=1){var Rt=Lt[kt],rr=[Rt.x+Te[0],Rt.y+Te[1]];yn(P,rr),yt.push(rr)}je.push(yt)}if(P[2]-P[0]<=pe/2){(ce=P)[0]=ce[1]=1/0,ce[2]=ce[3]=-1/0;for(var ar=0,_r=je;ar<_r.length;ar+=1)for(var dr=0,Er=_r[ar];dr<Er.length;dr+=1)Tr(Er[dr],P,U,pe)}return je}Zr.parse=function(x,P){if(x.length!==2)return P.error("Expected one argument.");var U=x[1];if(typeof U!="object"||Array.isArray(U))return P.error("Collator options argument must be an object.");var te=P.parse(U["case-sensitive"]!==void 0&&U["case-sensitive"],1,At);if(!te)return null;var ce=P.parse(U["diacritic-sensitive"]!==void 0&&U["diacritic-sensitive"],1,At);if(!ce)return null;var pe=null;return U.locale&&!(pe=P.parse(U.locale,1,xt))?null:new Zr(te,ce,pe)},Zr.prototype.evaluate=function(x){return new cr(this.caseSensitive.evaluate(x),this.diacriticSensitive.evaluate(x),this.locale?this.locale.evaluate(x):null)},Zr.prototype.eachChild=function(x){x(this.caseSensitive),x(this.diacriticSensitive),this.locale&&x(this.locale)},Zr.prototype.outputDefined=function(){return!1},Zr.prototype.serialize=function(){var x={};return x["case-sensitive"]=this.caseSensitive.serialize(),x["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(x.locale=this.locale.serialize()),["collator",x]};var Or=function(x,P){this.type=At,this.geojson=x,this.geometries=P};function sn(x){if(x instanceof un&&(x.name==="get"&&x.args.length===1||x.name==="feature-state"||x.name==="has"&&x.args.length===1||x.name==="properties"||x.name==="geometry-type"||x.name==="id"||/^filter-/.test(x.name))||x instanceof Or)return!1;var P=!0;return x.eachChild(function(U){P&&!sn(U)&&(P=!1)}),P}function Jr(x){if(x instanceof un&&x.name==="feature-state")return!1;var P=!0;return x.eachChild(function(U){P&&!Jr(U)&&(P=!1)}),P}function dn(x,P){if(x instanceof un&&P.indexOf(x.name)>=0)return!1;var U=!0;return x.eachChild(function(te){U&&!dn(te,P)&&(U=!1)}),U}Or.parse=function(x,P){if(x.length!==2)return P.error("'within' expression requires exactly one argument, but found "+(x.length-1)+" instead.");if(Lr(x[1])){var U=x[1];if(U.type==="FeatureCollection")for(var te=0;te<U.features.length;++te){var ce=U.features[te].geometry.type;if(ce==="Polygon"||ce==="MultiPolygon")return new Or(U,U.features[te].geometry)}else if(U.type==="Feature"){var pe=U.geometry.type;if(pe==="Polygon"||pe==="MultiPolygon")return new Or(U,U.geometry)}else if(U.type==="Polygon"||U.type==="MultiPolygon")return new Or(U,U)}return P.error("'within' expression requires valid geojson object that contains polygon geometry type.")},Or.prototype.evaluate=function(x){if(x.geometry()!=null&&x.canonicalID()!=null){if(x.geometryType()==="Point")return function(P,U){var te=[1/0,1/0,-1/0,-1/0],ce=[1/0,1/0,-1/0,-1/0],pe=P.canonicalID();if(U.type==="Polygon"){var Te=xr(U.coordinates,ce,pe),je=fr(P.geometry(),te,ce,pe);if(!In(te,ce))return!1;for(var nt=0,dt=je;nt<dt.length;nt+=1)if(!vt(dt[nt],Te))return!1}if(U.type==="MultiPolygon"){var yt=hr(U.coordinates,ce,pe),kt=fr(P.geometry(),te,ce,pe);if(!In(te,ce))return!1;for(var Lt=0,Rt=kt;Lt<Rt.length;Lt+=1)if(!Zt(Rt[Lt],yt))return!1}return!0}(x,this.geometries);if(x.geometryType()==="LineString")return function(P,U){var te=[1/0,1/0,-1/0,-1/0],ce=[1/0,1/0,-1/0,-1/0],pe=P.canonicalID();if(U.type==="Polygon"){var Te=xr(U.coordinates,ce,pe),je=br(P.geometry(),te,ce,pe);if(!In(te,ce))return!1;for(var nt=0,dt=je;nt<dt.length;nt+=1)if(!Dr(dt[nt],Te))return!1}if(U.type==="MultiPolygon"){var yt=hr(U.coordinates,ce,pe),kt=br(P.geometry(),te,ce,pe);if(!In(te,ce))return!1;for(var Lt=0,Rt=kt;Lt<Rt.length;Lt+=1)if(!Mr(Rt[Lt],yt))return!1}return!0}(x,this.geometries)}return!1},Or.prototype.eachChild=function(){},Or.prototype.outputDefined=function(){return!0},Or.prototype.serialize=function(){return["within",this.geojson]};var qr=function(x,P){this.type=P.type,this.name=x,this.boundExpression=P};qr.parse=function(x,P){if(x.length!==2||typeof x[1]!="string")return P.error("'var' expression requires exactly one string literal argument.");var U=x[1];return P.scope.has(U)?new qr(U,P.scope.get(U)):P.error('Unknown variable "'+U+'". Make sure "'+U+'" has been bound in an enclosing "let" expression before using it.',1)},qr.prototype.evaluate=function(x){return this.boundExpression.evaluate(x)},qr.prototype.eachChild=function(){},qr.prototype.outputDefined=function(){return!1},qr.prototype.serialize=function(){return["var",this.name]};var bn=function(x,P,U,te,ce){P===void 0&&(P=[]),te===void 0&&(te=new Et),ce===void 0&&(ce=[]),this.registry=x,this.path=P,this.key=P.map(function(pe){return"["+pe+"]"}).join(""),this.scope=te,this.errors=ce,this.expectedType=U};function Qn(x,P){for(var U,te=x.length-1,ce=0,pe=te,Te=0;ce<=pe;)if((U=x[Te=Math.floor((ce+pe)/2)])<=P){if(Te===te||P<x[Te+1])return Te;ce=Te+1}else{if(!(U>P))throw new kr("Input is not a number.");pe=Te-1}return 0}bn.prototype.parse=function(x,P,U,te,ce){return ce===void 0&&(ce={}),P?this.concat(P,U,te)._parse(x,ce):this._parse(x,ce)},bn.prototype._parse=function(x,P){function U(dt,yt,kt){return kt==="assert"?new Qr(yt,[dt]):kt==="coerce"?new Br(yt,[dt]):dt}if(x!==null&&typeof x!="string"&&typeof x!="boolean"&&typeof x!="number"||(x=["literal",x]),Array.isArray(x)){if(x.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var te=x[0];if(typeof te!="string")return this.error("Expression name must be a string, but found "+typeof te+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var ce=this.registry[te];if(ce){var pe=ce.parse(x,this);if(!pe)return null;if(this.expectedType){var Te=this.expectedType,je=pe.type;if(Te.kind!=="string"&&Te.kind!=="number"&&Te.kind!=="boolean"&&Te.kind!=="object"&&Te.kind!=="array"||je.kind!=="value")if(Te.kind!=="color"&&Te.kind!=="formatted"&&Te.kind!=="resolvedImage"||je.kind!=="value"&&je.kind!=="string"){if(this.checkSubtype(Te,je))return null}else pe=U(pe,Te,P.typeAnnotation||"coerce");else pe=U(pe,Te,P.typeAnnotation||"assert")}if(!(pe instanceof Ir)&&pe.type.kind!=="resolvedImage"&&function dt(yt){if(yt instanceof qr)return dt(yt.boundExpression);if(yt instanceof un&&yt.name==="error"||yt instanceof Zr||yt instanceof Or)return!1;var kt=yt instanceof Br||yt instanceof Qr,Lt=!0;return yt.eachChild(function(Rt){Lt=kt?Lt&&dt(Rt):Lt&&Rt instanceof Ir}),!!Lt&&sn(yt)&&dn(yt,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(pe)){var nt=new cn;try{pe=new Ir(pe.type,pe.evaluate(nt))}catch(dt){return this.error(dt.message),null}}return pe}return this.error('Unknown expression "'+te+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(x===void 0?"'undefined' value invalid. Use null instead.":typeof x=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof x+" instead.")},bn.prototype.concat=function(x,P,U){var te=typeof x=="number"?this.path.concat(x):this.path,ce=U?this.scope.concat(U):this.scope;return new bn(this.registry,te,P||null,ce,this.errors)},bn.prototype.error=function(x){for(var P=[],U=arguments.length-1;U-- >0;)P[U]=arguments[U+1];var te=""+this.key+P.map(function(ce){return"["+ce+"]"}).join("");this.errors.push(new bt(te,x))},bn.prototype.checkSubtype=function(x,P){var U=Jt(x,P);return U&&this.error(U),U};var Dn=function(x,P,U){this.type=x,this.input=P,this.labels=[],this.outputs=[];for(var te=0,ce=U;te<ce.length;te+=1){var pe=ce[te],Te=pe[1];this.labels.push(pe[0]),this.outputs.push(Te)}};function gn(x,P,U){return x*(1-U)+P*U}Dn.parse=function(x,P){if(x.length-1<4)return P.error("Expected at least 4 arguments, but found only "+(x.length-1)+".");if((x.length-1)%2!=0)return P.error("Expected an even number of arguments.");var U=P.parse(x[1],1,_t);if(!U)return null;var te=[],ce=null;P.expectedType&&P.expectedType.kind!=="value"&&(ce=P.expectedType);for(var pe=1;pe<x.length;pe+=2){var Te=pe===1?-1/0:x[pe],je=x[pe+1],nt=pe,dt=pe+1;if(typeof Te!="number")return P.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',nt);if(te.length&&te[te.length-1][0]>=Te)return P.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',nt);var yt=P.parse(je,dt,ce);if(!yt)return null;ce=ce||yt.type,te.push([Te,yt])}return new Dn(ce,U,te)},Dn.prototype.evaluate=function(x){var P=this.labels,U=this.outputs;if(P.length===1)return U[0].evaluate(x);var te=this.input.evaluate(x);if(te<=P[0])return U[0].evaluate(x);var ce=P.length;return te>=P[ce-1]?U[ce-1].evaluate(x):U[Qn(P,te)].evaluate(x)},Dn.prototype.eachChild=function(x){x(this.input);for(var P=0,U=this.outputs;P<U.length;P+=1)x(U[P])},Dn.prototype.outputDefined=function(){return this.outputs.every(function(x){return x.outputDefined()})},Dn.prototype.serialize=function(){for(var x=["step",this.input.serialize()],P=0;P<this.labels.length;P++)P>0&&x.push(this.labels[P]),x.push(this.outputs[P].serialize());return x};var Pn=Object.freeze({__proto__:null,number:gn,color:function(x,P,U){return new Qt(gn(x.r,P.r,U),gn(x.g,P.g,U),gn(x.b,P.b,U),gn(x.a,P.a,U))},array:function(x,P,U){return x.map(function(te,ce){return gn(te,P[ce],U)})}}),na=6/29*3*(6/29),ta=Math.PI/180,fn=180/Math.PI;function zn(x){return x>.008856451679035631?Math.pow(x,1/3):x/na+4/29}function Wn(x){return x>6/29?x*x*x:na*(x-4/29)}function Sa(x){return 255*(x<=.0031308?12.92*x:1.055*Math.pow(x,1/2.4)-.055)}function ti(x){return(x/=255)<=.04045?x/12.92:Math.pow((x+.055)/1.055,2.4)}function yi(x){var P=ti(x.r),U=ti(x.g),te=ti(x.b),ce=zn((.4124564*P+.3575761*U+.1804375*te)/.95047),pe=zn((.2126729*P+.7151522*U+.072175*te)/1);return{l:116*pe-16,a:500*(ce-pe),b:200*(pe-zn((.0193339*P+.119192*U+.9503041*te)/1.08883)),alpha:x.a}}function xo(x){var P=(x.l+16)/116,U=isNaN(x.a)?P:P+x.a/500,te=isNaN(x.b)?P:P-x.b/200;return P=1*Wn(P),U=.95047*Wn(U),te=1.08883*Wn(te),new Qt(Sa(3.2404542*U-1.5371385*P-.4985314*te),Sa(-.969266*U+1.8760108*P+.041556*te),Sa(.0556434*U-.2040259*P+1.0572252*te),x.alpha)}function ki(x,P,U){var te=P-x;return x+U*(te>180||te<-180?te-360*Math.round(te/360):te)}var ja={forward:yi,reverse:xo,interpolate:function(x,P,U){return{l:gn(x.l,P.l,U),a:gn(x.a,P.a,U),b:gn(x.b,P.b,U),alpha:gn(x.alpha,P.alpha,U)}}},bo={forward:function(x){var P=yi(x),U=P.l,te=P.a,ce=P.b,pe=Math.atan2(ce,te)*fn;return{h:pe<0?pe+360:pe,c:Math.sqrt(te*te+ce*ce),l:U,alpha:x.a}},reverse:function(x){var P=x.h*ta,U=x.c;return xo({l:x.l,a:Math.cos(P)*U,b:Math.sin(P)*U,alpha:x.alpha})},interpolate:function(x,P,U){return{h:ki(x.h,P.h,U),c:gn(x.c,P.c,U),l:gn(x.l,P.l,U),alpha:gn(x.alpha,P.alpha,U)}}},ss=Object.freeze({__proto__:null,lab:ja,hcl:bo}),Ua=function(x,P,U,te,ce){this.type=x,this.operator=P,this.interpolation=U,this.input=te,this.labels=[],this.outputs=[];for(var pe=0,Te=ce;pe<Te.length;pe+=1){var je=Te[pe],nt=je[1];this.labels.push(je[0]),this.outputs.push(nt)}};function hl(x,P,U,te){var ce=te-U,pe=x-U;return ce===0?0:P===1?pe/ce:(Math.pow(P,pe)-1)/(Math.pow(P,ce)-1)}Ua.interpolationFactor=function(x,P,U,te){var ce=0;if(x.name==="exponential")ce=hl(P,x.base,U,te);else if(x.name==="linear")ce=hl(P,1,U,te);else if(x.name==="cubic-bezier"){var pe=x.controlPoints;ce=new r(pe[0],pe[1],pe[2],pe[3]).solve(hl(P,1,U,te))}return ce},Ua.parse=function(x,P){var U=x[0],te=x[1],ce=x[2],pe=x.slice(3);if(!Array.isArray(te)||te.length===0)return P.error("Expected an interpolation type expression.",1);if(te[0]==="linear")te={name:"linear"};else if(te[0]==="exponential"){var Te=te[1];if(typeof Te!="number")return P.error("Exponential interpolation requires a numeric base.",1,1);te={name:"exponential",base:Te}}else{if(te[0]!=="cubic-bezier")return P.error("Unknown interpolation type "+String(te[0]),1,0);var je=te.slice(1);if(je.length!==4||je.some(function(_r){return typeof _r!="number"||_r<0||_r>1}))return P.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);te={name:"cubic-bezier",controlPoints:je}}if(x.length-1<4)return P.error("Expected at least 4 arguments, but found only "+(x.length-1)+".");if((x.length-1)%2!=0)return P.error("Expected an even number of arguments.");if(!(ce=P.parse(ce,2,_t)))return null;var nt=[],dt=null;U==="interpolate-hcl"||U==="interpolate-lab"?dt=It:P.expectedType&&P.expectedType.kind!=="value"&&(dt=P.expectedType);for(var yt=0;yt<pe.length;yt+=2){var kt=pe[yt],Lt=pe[yt+1],Rt=yt+3,rr=yt+4;if(typeof kt!="number")return P.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Rt);if(nt.length&&nt[nt.length-1][0]>=kt)return P.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',Rt);var ar=P.parse(Lt,rr,dt);if(!ar)return null;dt=dt||ar.type,nt.push([kt,ar])}return dt.kind==="number"||dt.kind==="color"||dt.kind==="array"&&dt.itemType.kind==="number"&&typeof dt.N=="number"?new Ua(dt,U,te,ce,nt):P.error("Type "+wt(dt)+" is not interpolatable.")},Ua.prototype.evaluate=function(x){var P=this.labels,U=this.outputs;if(P.length===1)return U[0].evaluate(x);var te=this.input.evaluate(x);if(te<=P[0])return U[0].evaluate(x);var ce=P.length;if(te>=P[ce-1])return U[ce-1].evaluate(x);var pe=Qn(P,te),Te=Ua.interpolationFactor(this.interpolation,te,P[pe],P[pe+1]),je=U[pe].evaluate(x),nt=U[pe+1].evaluate(x);return this.operator==="interpolate"?Pn[this.type.kind.toLowerCase()](je,nt,Te):this.operator==="interpolate-hcl"?bo.reverse(bo.interpolate(bo.forward(je),bo.forward(nt),Te)):ja.reverse(ja.interpolate(ja.forward(je),ja.forward(nt),Te))},Ua.prototype.eachChild=function(x){x(this.input);for(var P=0,U=this.outputs;P<U.length;P+=1)x(U[P])},Ua.prototype.outputDefined=function(){return this.outputs.every(function(x){return x.outputDefined()})},Ua.prototype.serialize=function(){var x;x=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var P=[this.operator,x,this.input.serialize()],U=0;U<this.labels.length;U++)P.push(this.labels[U],this.outputs[U].serialize());return P};var _o=function(x,P){this.type=x,this.args=P};_o.parse=function(x,P){if(x.length<2)return P.error("Expectected at least one argument.");var U=null,te=P.expectedType;te&&te.kind!=="value"&&(U=te);for(var ce=[],pe=0,Te=x.slice(1);pe<Te.length;pe+=1){var je=P.parse(Te[pe],1+ce.length,U,void 0,{typeAnnotation:"omit"});if(!je)return null;U=U||je.type,ce.push(je)}var nt=te&&ce.some(function(dt){return Jt(te,dt.type)});return new _o(nt?Ot:U,ce)},_o.prototype.evaluate=function(x){for(var P,U=null,te=0,ce=0,pe=this.args;ce<pe.length&&(te++,(U=pe[ce].evaluate(x))&&U instanceof ur&&!U.available&&(P||(P=U.name),U=null,te===this.args.length&&(U=P)),U===null);ce+=1);return U},_o.prototype.eachChild=function(x){this.args.forEach(x)},_o.prototype.outputDefined=function(){return this.args.every(function(x){return x.outputDefined()})},_o.prototype.serialize=function(){var x=["coalesce"];return this.eachChild(function(P){x.push(P.serialize())}),x};var Zo=function(x,P){this.type=P.type,this.bindings=[].concat(x),this.result=P};Zo.prototype.evaluate=function(x){return this.result.evaluate(x)},Zo.prototype.eachChild=function(x){for(var P=0,U=this.bindings;P<U.length;P+=1)x(U[P][1]);x(this.result)},Zo.parse=function(x,P){if(x.length<4)return P.error("Expected at least 3 arguments, but found "+(x.length-1)+" instead.");for(var U=[],te=1;te<x.length-1;te+=2){var ce=x[te];if(typeof ce!="string")return P.error("Expected string, but found "+typeof ce+" instead.",te);if(/[^a-zA-Z0-9_]/.test(ce))return P.error("Variable names must contain only alphanumeric characters or '_'.",te);var pe=P.parse(x[te+1],te+1);if(!pe)return null;U.push([ce,pe])}var Te=P.parse(x[x.length-1],x.length-1,P.expectedType,U);return Te?new Zo(U,Te):null},Zo.prototype.outputDefined=function(){return this.result.outputDefined()},Zo.prototype.serialize=function(){for(var x=["let"],P=0,U=this.bindings;P<U.length;P+=1){var te=U[P];x.push(te[0],te[1].serialize())}return x.push(this.result.serialize()),x};var Co=function(x,P,U){this.type=x,this.index=P,this.input=U};Co.parse=function(x,P){if(x.length!==3)return P.error("Expected 2 arguments, but found "+(x.length-1)+" instead.");var U=P.parse(x[1],1,_t),te=P.parse(x[2],2,ut(P.expectedType||Ot));return U&&te?new Co(te.type.itemType,U,te):null},Co.prototype.evaluate=function(x){var P=this.index.evaluate(x),U=this.input.evaluate(x);if(P<0)throw new kr("Array index out of bounds: "+P+" < 0.");if(P>=U.length)throw new kr("Array index out of bounds: "+P+" > "+(U.length-1)+".");if(P!==Math.floor(P))throw new kr("Array index must be an integer, but found "+P+" instead.");return U[P]},Co.prototype.eachChild=function(x){x(this.index),x(this.input)},Co.prototype.outputDefined=function(){return!1},Co.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var ls=function(x,P){this.type=At,this.needle=x,this.haystack=P};ls.parse=function(x,P){if(x.length!==3)return P.error("Expected 2 arguments, but found "+(x.length-1)+" instead.");var U=P.parse(x[1],1,Ot),te=P.parse(x[2],2,Ot);return U&&te?er(U.type,[At,xt,_t,Mt,Ot])?new ls(U,te):P.error("Expected first argument to be of type boolean, string, number or null, but found "+wt(U.type)+" instead"):null},ls.prototype.evaluate=function(x){var P=this.needle.evaluate(x),U=this.haystack.evaluate(x);if(!U)return!1;if(!or(P,["boolean","string","number","null"]))throw new kr("Expected first argument to be of type boolean, string, number or null, but found "+wt(Hr(P))+" instead.");if(!or(U,["string","array"]))throw new kr("Expected second argument to be of type array or string, but found "+wt(Hr(U))+" instead.");return U.indexOf(P)>=0},ls.prototype.eachChild=function(x){x(this.needle),x(this.haystack)},ls.prototype.outputDefined=function(){return!0},ls.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var Xo=function(x,P,U){this.type=_t,this.needle=x,this.haystack=P,this.fromIndex=U};Xo.parse=function(x,P){if(x.length<=2||x.length>=5)return P.error("Expected 3 or 4 arguments, but found "+(x.length-1)+" instead.");var U=P.parse(x[1],1,Ot),te=P.parse(x[2],2,Ot);if(!U||!te)return null;if(!er(U.type,[At,xt,_t,Mt,Ot]))return P.error("Expected first argument to be of type boolean, string, number or null, but found "+wt(U.type)+" instead");if(x.length===4){var ce=P.parse(x[3],3,_t);return ce?new Xo(U,te,ce):null}return new Xo(U,te)},Xo.prototype.evaluate=function(x){var P=this.needle.evaluate(x),U=this.haystack.evaluate(x);if(!or(P,["boolean","string","number","null"]))throw new kr("Expected first argument to be of type boolean, string, number or null, but found "+wt(Hr(P))+" instead.");if(!or(U,["string","array"]))throw new kr("Expected second argument to be of type array or string, but found "+wt(Hr(U))+" instead.");if(this.fromIndex){var te=this.fromIndex.evaluate(x);return U.indexOf(P,te)}return U.indexOf(P)},Xo.prototype.eachChild=function(x){x(this.needle),x(this.haystack),this.fromIndex&&x(this.fromIndex)},Xo.prototype.outputDefined=function(){return!1},Xo.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var x=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),x]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var Jo=function(x,P,U,te,ce,pe){this.inputType=x,this.type=P,this.input=U,this.cases=te,this.outputs=ce,this.otherwise=pe};Jo.parse=function(x,P){if(x.length<5)return P.error("Expected at least 4 arguments, but found only "+(x.length-1)+".");if(x.length%2!=1)return P.error("Expected an even number of arguments.");var U,te;P.expectedType&&P.expectedType.kind!=="value"&&(te=P.expectedType);for(var ce={},pe=[],Te=2;Te<x.length-1;Te+=2){var je=x[Te],nt=x[Te+1];Array.isArray(je)||(je=[je]);var dt=P.concat(Te);if(je.length===0)return dt.error("Expected at least one branch label.");for(var yt=0,kt=je;yt<kt.length;yt+=1){var Lt=kt[yt];if(typeof Lt!="number"&&typeof Lt!="string")return dt.error("Branch labels must be numbers or strings.");if(typeof Lt=="number"&&Math.abs(Lt)>Number.MAX_SAFE_INTEGER)return dt.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof Lt=="number"&&Math.floor(Lt)!==Lt)return dt.error("Numeric branch labels must be integer values.");if(U){if(dt.checkSubtype(U,Hr(Lt)))return null}else U=Hr(Lt);if(ce[String(Lt)]!==void 0)return dt.error("Branch labels must be unique.");ce[String(Lt)]=pe.length}var Rt=P.parse(nt,Te,te);if(!Rt)return null;te=te||Rt.type,pe.push(Rt)}var rr=P.parse(x[1],1,Ot);if(!rr)return null;var ar=P.parse(x[x.length-1],x.length-1,te);return ar?rr.type.kind!=="value"&&P.concat(1).checkSubtype(U,rr.type)?null:new Jo(U,te,rr,ce,pe,ar):null},Jo.prototype.evaluate=function(x){var P=this.input.evaluate(x);return(Hr(P)===this.inputType&&this.outputs[this.cases[P]]||this.otherwise).evaluate(x)},Jo.prototype.eachChild=function(x){x(this.input),this.outputs.forEach(x),x(this.otherwise)},Jo.prototype.outputDefined=function(){return this.outputs.every(function(x){return x.outputDefined()})&&this.otherwise.outputDefined()},Jo.prototype.serialize=function(){for(var x=this,P=["match",this.input.serialize()],U=[],te={},ce=0,pe=Object.keys(this.cases).sort();ce<pe.length;ce+=1){var Te=pe[ce];(kt=te[this.cases[Te]])===void 0?(te[this.cases[Te]]=U.length,U.push([this.cases[Te],[Te]])):U[kt][1].push(Te)}for(var je=function(Rt){return x.inputType.kind==="number"?Number(Rt):Rt},nt=0,dt=U;nt<dt.length;nt+=1){var yt=dt[nt],kt=yt[0],Lt=yt[1];P.push(Lt.length===1?je(Lt[0]):Lt.map(je)),P.push(this.outputs[outputIndex$1].serialize())}return P.push(this.otherwise.serialize()),P};var cs=function(x,P,U){this.type=x,this.branches=P,this.otherwise=U};cs.parse=function(x,P){if(x.length<4)return P.error("Expected at least 3 arguments, but found only "+(x.length-1)+".");if(x.length%2!=0)return P.error("Expected an odd number of arguments.");var U;P.expectedType&&P.expectedType.kind!=="value"&&(U=P.expectedType);for(var te=[],ce=1;ce<x.length-1;ce+=2){var pe=P.parse(x[ce],ce,At);if(!pe)return null;var Te=P.parse(x[ce+1],ce+1,U);if(!Te)return null;te.push([pe,Te]),U=U||Te.type}var je=P.parse(x[x.length-1],x.length-1,U);return je?new cs(U,te,je):null},cs.prototype.evaluate=function(x){for(var P=0,U=this.branches;P<U.length;P+=1){var te=U[P],ce=te[1];if(te[0].evaluate(x))return ce.evaluate(x)}return this.otherwise.evaluate(x)},cs.prototype.eachChild=function(x){for(var P=0,U=this.branches;P<U.length;P+=1){var te=U[P],ce=te[1];x(te[0]),x(ce)}x(this.otherwise)},cs.prototype.outputDefined=function(){return this.branches.every(function(x){return x[1].outputDefined()})&&this.otherwise.outputDefined()},cs.prototype.serialize=function(){var x=["case"];return this.eachChild(function(P){x.push(P.serialize())}),x};var wo=function(x,P,U,te){this.type=x,this.input=P,this.beginIndex=U,this.endIndex=te};function js(x,P){return x==="=="||x==="!="?P.kind==="boolean"||P.kind==="string"||P.kind==="number"||P.kind==="null"||P.kind==="value":P.kind==="string"||P.kind==="number"||P.kind==="value"}function pl(x,P,U,te){return te.compare(P,U)===0}function lo(x,P,U){var te=x!=="=="&&x!=="!=";return function(){function ce(pe,Te,je){this.type=At,this.lhs=pe,this.rhs=Te,this.collator=je,this.hasUntypedArgument=pe.type.kind==="value"||Te.type.kind==="value"}return ce.parse=function(pe,Te){if(pe.length!==3&&pe.length!==4)return Te.error("Expected two or three arguments.");var je=pe[0],nt=Te.parse(pe[1],1,Ot);if(!nt)return null;if(!js(je,nt.type))return Te.concat(1).error('"'+je+`" comparisons are not supported for type '`+wt(nt.type)+"'.");var dt=Te.parse(pe[2],2,Ot);if(!dt)return null;if(!js(je,dt.type))return Te.concat(2).error('"'+je+`" comparisons are not supported for type '`+wt(dt.type)+"'.");if(nt.type.kind!==dt.type.kind&&nt.type.kind!=="value"&&dt.type.kind!=="value")return Te.error("Cannot compare types '"+wt(nt.type)+"' and '"+wt(dt.type)+"'.");te&&(nt.type.kind==="value"&&dt.type.kind!=="value"?nt=new Qr(dt.type,[nt]):nt.type.kind!=="value"&&dt.type.kind==="value"&&(dt=new Qr(nt.type,[dt])));var yt=null;if(pe.length===4){if(nt.type.kind!=="string"&&dt.type.kind!=="string"&&nt.type.kind!=="value"&&dt.type.kind!=="value")return Te.error("Cannot use collator to compare non-string types.");if(!(yt=Te.parse(pe[3],3,Yt)))return null}return new ce(nt,dt,yt)},ce.prototype.evaluate=function(pe){var Te=this.lhs.evaluate(pe),je=this.rhs.evaluate(pe);if(te&&this.hasUntypedArgument){var nt=Hr(Te),dt=Hr(je);if(nt.kind!==dt.kind||nt.kind!=="string"&&nt.kind!=="number")throw new kr('Expected arguments for "'+x+'" to be (string, string) or (number, number), but found ('+nt.kind+", "+dt.kind+") instead.")}if(this.collator&&!te&&this.hasUntypedArgument){var yt=Hr(Te),kt=Hr(je);if(yt.kind!=="string"||kt.kind!=="string")return P(pe,Te,je)}return this.collator?U(pe,Te,je,this.collator.evaluate(pe)):P(pe,Te,je)},ce.prototype.eachChild=function(pe){pe(this.lhs),pe(this.rhs),this.collator&&pe(this.collator)},ce.prototype.outputDefined=function(){return!0},ce.prototype.serialize=function(){var pe=[x];return this.eachChild(function(Te){pe.push(Te.serialize())}),pe},ce}()}wo.parse=function(x,P){if(x.length<=2||x.length>=5)return P.error("Expected 3 or 4 arguments, but found "+(x.length-1)+" instead.");var U=P.parse(x[1],1,Ot),te=P.parse(x[2],2,_t);if(!U||!te)return null;if(!er(U.type,[ut(Ot),xt,Ot]))return P.error("Expected first argument to be of type array or string, but found "+wt(U.type)+" instead");if(x.length===4){var ce=P.parse(x[3],3,_t);return ce?new wo(U.type,U,te,ce):null}return new wo(U.type,U,te)},wo.prototype.evaluate=function(x){var P=this.input.evaluate(x),U=this.beginIndex.evaluate(x);if(!or(P,["string","array"]))throw new kr("Expected first argument to be of type array or string, but found "+wt(Hr(P))+" instead.");if(this.endIndex){var te=this.endIndex.evaluate(x);return P.slice(U,te)}return P.slice(U)},wo.prototype.eachChild=function(x){x(this.input),x(this.beginIndex),this.endIndex&&x(this.endIndex)},wo.prototype.outputDefined=function(){return!1},wo.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var x=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),x]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var _s=lo("==",function(x,P,U){return P===U},pl),Ko=lo("!=",function(x,P,U){return P!==U},function(x,P,U,te){return!pl(0,P,U,te)}),ma=lo("<",function(x,P,U){return P<U},function(x,P,U,te){return te.compare(P,U)<0}),us=lo(">",function(x,P,U){return P>U},function(x,P,U,te){return te.compare(P,U)>0}),$i=lo("<=",function(x,P,U){return P<=U},function(x,P,U,te){return te.compare(P,U)<=0}),ws=lo(">=",function(x,P,U){return P>=U},function(x,P,U,te){return te.compare(P,U)>=0}),eo=function(x,P,U,te,ce){this.type=xt,this.number=x,this.locale=P,this.currency=U,this.minFractionDigits=te,this.maxFractionDigits=ce};eo.parse=function(x,P){if(x.length!==3)return P.error("Expected two arguments.");var U=P.parse(x[1],1,_t);if(!U)return null;var te=x[2];if(typeof te!="object"||Array.isArray(te))return P.error("NumberFormat options argument must be an object.");var ce=null;if(te.locale&&!(ce=P.parse(te.locale,1,xt)))return null;var pe=null;if(te.currency&&!(pe=P.parse(te.currency,1,xt)))return null;var Te=null;if(te["min-fraction-digits"]&&!(Te=P.parse(te["min-fraction-digits"],1,_t)))return null;var je=null;return te["max-fraction-digits"]&&!(je=P.parse(te["max-fraction-digits"],1,_t))?null:new eo(U,ce,pe,Te,je)},eo.prototype.evaluate=function(x){return new Intl.NumberFormat(this.locale?this.locale.evaluate(x):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(x):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(x):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(x):void 0}).format(this.number.evaluate(x))},eo.prototype.eachChild=function(x){x(this.number),this.locale&&x(this.locale),this.currency&&x(this.currency),this.minFractionDigits&&x(this.minFractionDigits),this.maxFractionDigits&&x(this.maxFractionDigits)},eo.prototype.outputDefined=function(){return!1},eo.prototype.serialize=function(){var x={};return this.locale&&(x.locale=this.locale.serialize()),this.currency&&(x.currency=this.currency.serialize()),this.minFractionDigits&&(x["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(x["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),x]};var Ri=function(x){this.type=_t,this.input=x};Ri.parse=function(x,P){if(x.length!==2)return P.error("Expected 1 argument, but found "+(x.length-1)+" instead.");var U=P.parse(x[1],1);return U?U.type.kind!=="array"&&U.type.kind!=="string"&&U.type.kind!=="value"?P.error("Expected argument of type string or array, but found "+wt(U.type)+" instead."):new Ri(U):null},Ri.prototype.evaluate=function(x){var P=this.input.evaluate(x);if(typeof P=="string"||Array.isArray(P))return P.length;throw new kr("Expected value to be of type string or array, but found "+wt(Hr(P))+" instead.")},Ri.prototype.eachChild=function(x){x(this.input)},Ri.prototype.outputDefined=function(){return!1},Ri.prototype.serialize=function(){var x=["length"];return this.eachChild(function(P){x.push(P.serialize())}),x};var co={"==":_s,"!=":Ko,">":us,"<":ma,">=":ws,"<=":$i,array:Qr,at:Co,boolean:Qr,case:cs,coalesce:_o,collator:Zr,format:nn,image:Xr,in:ls,"index-of":Xo,interpolate:Ua,"interpolate-hcl":Ua,"interpolate-lab":Ua,length:Ri,let:Zo,literal:Ir,match:Jo,number:Qr,"number-format":eo,object:Qr,slice:wo,step:Dn,string:Qr,"to-boolean":Br,"to-color":Br,"to-number":Br,"to-string":Br,var:qr,within:Or};function Fi(x,P){var U=P[0],te=P[1],ce=P[2],pe=P[3];U=U.evaluate(x),te=te.evaluate(x),ce=ce.evaluate(x);var Te=pe?pe.evaluate(x):1,je=Sr(U,te,ce,Te);if(je)throw new kr(je);return new Qt(U/255*Te,te/255*Te,ce/255*Te,Te)}function oc(x,P){return x in P}function Qo(x,P){var U=P[x];return U===void 0?null:U}function Lo(x){return{type:x}}function Ts(x){return{result:"success",value:x}}function fs(x){return{result:"error",value:x}}function $o(x){return x["property-type"]==="data-driven"||x["property-type"]==="cross-faded-data-driven"}function Us(x){return!!x.expression&&x.expression.parameters.indexOf("zoom")>-1}function ks(x){return!!x.expression&&x.expression.interpolated}function va(x){return x instanceof Number?"number":x instanceof String?"string":x instanceof Boolean?"boolean":Array.isArray(x)?"array":x===null?"null":typeof x}function Li(x){return typeof x=="object"&&x!==null&&!Array.isArray(x)}function sc(x){return x}function es(x,P,U){return x!==void 0?x:P!==void 0?P:U!==void 0?U:void 0}function Ic(x,P,U,te,ce){return es(typeof U===ce?te[U]:void 0,x.default,P.default)}function lc(x,P,U){if(va(U)!=="number")return es(x.default,P.default);var te=x.stops.length;if(te===1||U<=x.stops[0][0])return x.stops[0][1];if(U>=x.stops[te-1][0])return x.stops[te-1][1];var ce=Qn(x.stops.map(function(pe){return pe[0]}),U);return x.stops[ce][1]}function cc(x,P,U){var te=x.base!==void 0?x.base:1;if(va(U)!=="number")return es(x.default,P.default);var ce=x.stops.length;if(ce===1||U<=x.stops[0][0])return x.stops[0][1];if(U>=x.stops[ce-1][0])return x.stops[ce-1][1];var pe=Qn(x.stops.map(function(kt){return kt[0]}),U),Te=function(kt,Lt,Rt,rr){var ar=rr-Rt,_r=kt-Rt;return ar===0?0:Lt===1?_r/ar:(Math.pow(Lt,_r)-1)/(Math.pow(Lt,ar)-1)}(U,te,x.stops[pe][0],x.stops[pe+1][0]),je=x.stops[pe][1],nt=x.stops[pe+1][1],dt=Pn[P.type]||sc;if(x.colorSpace&&x.colorSpace!=="rgb"){var yt=ss[x.colorSpace];dt=function(kt,Lt){return yt.reverse(yt.interpolate(yt.forward(kt),yt.forward(Lt),Te))}}return typeof je.evaluate=="function"?{evaluate:function(){for(var kt=[],Lt=arguments.length;Lt--;)kt[Lt]=arguments[Lt];var Rt=je.evaluate.apply(void 0,kt),rr=nt.evaluate.apply(void 0,kt);if(Rt!==void 0&&rr!==void 0)return dt(Rt,rr,Te)}}:dt(je,nt,Te)}function Oc(x,P,U){return P.type==="color"?U=Qt.parse(U):P.type==="formatted"?U=Ut.fromString(U.toString()):P.type==="resolvedImage"?U=ur.fromString(U.toString()):va(U)===P.type||P.type==="enum"&&P.values[U]||(U=void 0),es(U,x.default,P.default)}un.register(co,{error:[{kind:"error"},[xt],function(x,P){throw new kr(P[0].evaluate(x))}],typeof:[xt,[Ot],function(x,P){return wt(Hr(P[0].evaluate(x)))}],"to-rgba":[ut(_t,4),[It],function(x,P){return P[0].evaluate(x).toArray()}],rgb:[It,[_t,_t,_t],Fi],rgba:[It,[_t,_t,_t,_t],Fi],has:{type:At,overloads:[[[xt],function(x,P){return oc(P[0].evaluate(x),x.properties())}],[[xt,Nt],function(x,P){var U=P[1];return oc(P[0].evaluate(x),U.evaluate(x))}]]},get:{type:Ot,overloads:[[[xt],function(x,P){return Qo(P[0].evaluate(x),x.properties())}],[[xt,Nt],function(x,P){var U=P[1];return Qo(P[0].evaluate(x),U.evaluate(x))}]]},"feature-state":[Ot,[xt],function(x,P){return Qo(P[0].evaluate(x),x.featureState||{})}],properties:[Nt,[],function(x){return x.properties()}],"geometry-type":[xt,[],function(x){return x.geometryType()}],id:[Ot,[],function(x){return x.id()}],zoom:[_t,[],function(x){return x.globals.zoom}],"heatmap-density":[_t,[],function(x){return x.globals.heatmapDensity||0}],"line-progress":[_t,[],function(x){return x.globals.lineProgress||0}],accumulated:[Ot,[],function(x){return x.globals.accumulated===void 0?null:x.globals.accumulated}],"+":[_t,Lo(_t),function(x,P){for(var U=0,te=0,ce=P;te<ce.length;te+=1)U+=ce[te].evaluate(x);return U}],"*":[_t,Lo(_t),function(x,P){for(var U=1,te=0,ce=P;te<ce.length;te+=1)U*=ce[te].evaluate(x);return U}],"-":{type:_t,overloads:[[[_t,_t],function(x,P){var U=P[1];return P[0].evaluate(x)-U.evaluate(x)}],[[_t],function(x,P){return-P[0].evaluate(x)}]]},"/":[_t,[_t,_t],function(x,P){var U=P[1];return P[0].evaluate(x)/U.evaluate(x)}],"%":[_t,[_t,_t],function(x,P){var U=P[1];return P[0].evaluate(x)%U.evaluate(x)}],ln2:[_t,[],function(){return Math.LN2}],pi:[_t,[],function(){return Math.PI}],e:[_t,[],function(){return Math.E}],"^":[_t,[_t,_t],function(x,P){var U=P[1];return Math.pow(P[0].evaluate(x),U.evaluate(x))}],sqrt:[_t,[_t],function(x,P){return Math.sqrt(P[0].evaluate(x))}],log10:[_t,[_t],function(x,P){return Math.log(P[0].evaluate(x))/Math.LN10}],ln:[_t,[_t],function(x,P){return Math.log(P[0].evaluate(x))}],log2:[_t,[_t],function(x,P){return Math.log(P[0].evaluate(x))/Math.LN2}],sin:[_t,[_t],function(x,P){return Math.sin(P[0].evaluate(x))}],cos:[_t,[_t],function(x,P){return Math.cos(P[0].evaluate(x))}],tan:[_t,[_t],function(x,P){return Math.tan(P[0].evaluate(x))}],asin:[_t,[_t],function(x,P){return Math.asin(P[0].evaluate(x))}],acos:[_t,[_t],function(x,P){return Math.acos(P[0].evaluate(x))}],atan:[_t,[_t],function(x,P){return Math.atan(P[0].evaluate(x))}],min:[_t,Lo(_t),function(x,P){return Math.min.apply(Math,P.map(function(U){return U.evaluate(x)}))}],max:[_t,Lo(_t),function(x,P){return Math.max.apply(Math,P.map(function(U){return U.evaluate(x)}))}],abs:[_t,[_t],function(x,P){return Math.abs(P[0].evaluate(x))}],round:[_t,[_t],function(x,P){var U=P[0].evaluate(x);return U<0?-Math.round(-U):Math.round(U)}],floor:[_t,[_t],function(x,P){return Math.floor(P[0].evaluate(x))}],ceil:[_t,[_t],function(x,P){return Math.ceil(P[0].evaluate(x))}],"filter-==":[At,[xt,Ot],function(x,P){var U=P[0],te=P[1];return x.properties()[U.value]===te.value}],"filter-id-==":[At,[Ot],function(x,P){var U=P[0];return x.id()===U.value}],"filter-type-==":[At,[xt],function(x,P){var U=P[0];return x.geometryType()===U.value}],"filter-<":[At,[xt,Ot],function(x,P){var U=P[0],te=P[1],ce=x.properties()[U.value],pe=te.value;return typeof ce==typeof pe&&ce<pe}],"filter-id-<":[At,[Ot],function(x,P){var U=P[0],te=x.id(),ce=U.value;return typeof te==typeof ce&&te<ce}],"filter->":[At,[xt,Ot],function(x,P){var U=P[0],te=P[1],ce=x.properties()[U.value],pe=te.value;return typeof ce==typeof pe&&ce>pe}],"filter-id->":[At,[Ot],function(x,P){var U=P[0],te=x.id(),ce=U.value;return typeof te==typeof ce&&te>ce}],"filter-<=":[At,[xt,Ot],function(x,P){var U=P[0],te=P[1],ce=x.properties()[U.value],pe=te.value;return typeof ce==typeof pe&&ce<=pe}],"filter-id-<=":[At,[Ot],function(x,P){var U=P[0],te=x.id(),ce=U.value;return typeof te==typeof ce&&te<=ce}],"filter->=":[At,[xt,Ot],function(x,P){var U=P[0],te=P[1],ce=x.properties()[U.value],pe=te.value;return typeof ce==typeof pe&&ce>=pe}],"filter-id->=":[At,[Ot],function(x,P){var U=P[0],te=x.id(),ce=U.value;return typeof te==typeof ce&&te>=ce}],"filter-has":[At,[Ot],function(x,P){return P[0].value in x.properties()}],"filter-has-id":[At,[],function(x){return x.id()!==null&&x.id()!==void 0}],"filter-type-in":[At,[ut(xt)],function(x,P){return P[0].value.indexOf(x.geometryType())>=0}],"filter-id-in":[At,[ut(Ot)],function(x,P){return P[0].value.indexOf(x.id())>=0}],"filter-in-small":[At,[xt,ut(Ot)],function(x,P){var U=P[0];return P[1].value.indexOf(x.properties()[U.value])>=0}],"filter-in-large":[At,[xt,ut(Ot)],function(x,P){var U=P[0],te=P[1];return function(ce,pe,Te,je){for(;Te<=je;){var nt=Te+je>>1;if(pe[nt]===ce)return!0;pe[nt]>ce?je=nt-1:Te=nt+1}return!1}(x.properties()[U.value],te.value,0,te.value.length-1)}],all:{type:At,overloads:[[[At,At],function(x,P){var U=P[1];return P[0].evaluate(x)&&U.evaluate(x)}],[Lo(At),function(x,P){for(var U=0,te=P;U<te.length;U+=1)if(!te[U].evaluate(x))return!1;return!0}]]},any:{type:At,overloads:[[[At,At],function(x,P){var U=P[1];return P[0].evaluate(x)||U.evaluate(x)}],[Lo(At),function(x,P){for(var U=0,te=P;U<te.length;U+=1)if(te[U].evaluate(x))return!0;return!1}]]},"!":[At,[At],function(x,P){return!P[0].evaluate(x)}],"is-supported-script":[At,[xt],function(x,P){var U=x.globals&&x.globals.isSupportedScript;return!U||U(P[0].evaluate(x))}],upcase:[xt,[xt],function(x,P){return P[0].evaluate(x).toUpperCase()}],downcase:[xt,[xt],function(x,P){return P[0].evaluate(x).toLowerCase()}],concat:[xt,Lo(Ot),function(x,P){return P.map(function(U){return Kr(U.evaluate(x))}).join("")}],"resolved-locale":[xt,[Yt],function(x,P){return P[0].evaluate(x).resolvedLocale()}]});var ts=function(x,P){this.expression=x,this._warningHistory={},this._evaluator=new cn,this._defaultValue=P?function(U){return U.type==="color"&&Li(U.default)?new Qt(0,0,0,0):U.type==="color"?Qt.parse(U.default)||null:U.default===void 0?null:U.default}(P):null,this._enumValues=P&&P.type==="enum"?P.values:null};function hs(x){return Array.isArray(x)&&x.length>0&&typeof x[0]=="string"&&x[0]in co}function Vs(x,P){var U=new bn(co,[],P?function(ce){var pe={color:It,string:xt,number:_t,enum:xt,boolean:At,formatted:Pt,resolvedImage:Ne};return ce.type==="array"?ut(pe[ce.value]||Ot,ce.length):pe[ce.type]}(P):void 0),te=U.parse(x,void 0,void 0,void 0,P&&P.type==="string"?{typeAnnotation:"coerce"}:void 0);return te?Ts(new ts(te,P)):fs(U.errors)}ts.prototype.evaluateWithoutErrorHandling=function(x,P,U,te,ce,pe){return this._evaluator.globals=x,this._evaluator.feature=P,this._evaluator.featureState=U,this._evaluator.canonical=te,this._evaluator.availableImages=ce||null,this._evaluator.formattedSection=pe,this.expression.evaluate(this._evaluator)},ts.prototype.evaluate=function(x,P,U,te,ce,pe){this._evaluator.globals=x,this._evaluator.feature=P||null,this._evaluator.featureState=U||null,this._evaluator.canonical=te,this._evaluator.availableImages=ce||null,this._evaluator.formattedSection=pe||null;try{var Te=this.expression.evaluate(this._evaluator);if(Te==null||typeof Te=="number"&&Te!=Te)return this._defaultValue;if(this._enumValues&&!(Te in this._enumValues))throw new kr("Expected value to be one of "+Object.keys(this._enumValues).map(function(je){return JSON.stringify(je)}).join(", ")+", but found "+JSON.stringify(Te)+" instead.");return Te}catch(je){return this._warningHistory[je.message]||(this._warningHistory[je.message]=!0,typeof console<"u"&&console.warn(je.message)),this._defaultValue}};var rs=function(x,P){this.kind=x,this._styleExpression=P,this.isStateDependent=x!=="constant"&&!Jr(P.expression)};rs.prototype.evaluateWithoutErrorHandling=function(x,P,U,te,ce,pe){return this._styleExpression.evaluateWithoutErrorHandling(x,P,U,te,ce,pe)},rs.prototype.evaluate=function(x,P,U,te,ce,pe){return this._styleExpression.evaluate(x,P,U,te,ce,pe)};var Ms=function(x,P,U,te){this.kind=x,this.zoomStops=U,this._styleExpression=P,this.isStateDependent=x!=="camera"&&!Jr(P.expression),this.interpolationType=te};function zc(x,P){if((x=Vs(x,P)).result==="error")return x;var U=x.value.expression,te=sn(U);if(!te&&!$o(P))return fs([new bt("","data expressions not supported")]);var ce=dn(U,["zoom"]);if(!ce&&!Us(P))return fs([new bt("","zoom expressions not supported")]);var pe=function Te(je){var nt=null;if(je instanceof Zo)nt=Te(je.result);else if(je instanceof _o)for(var dt=0,yt=je.args;dt<yt.length&&!(nt=Te(yt[dt]));dt+=1);else(je instanceof Dn||je instanceof Ua)&&je.input instanceof un&&je.input.name==="zoom"&&(nt=je);return nt instanceof bt||je.eachChild(function(kt){var Lt=Te(kt);Lt instanceof bt?nt=Lt:!nt&&Lt?nt=new bt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):nt&&Lt&&nt!==Lt&&(nt=new bt("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),nt}(U);return pe||ce?pe instanceof bt?fs([pe]):pe instanceof Ua&&!ks(P)?fs([new bt("",'"interpolate" expressions cannot be used with this property')]):Ts(pe?new Ms(te?"camera":"composite",x.value,pe.labels,pe instanceof Ua?pe.interpolation:void 0):new rs(te?"constant":"source",x.value)):fs([new bt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}Ms.prototype.evaluateWithoutErrorHandling=function(x,P,U,te,ce,pe){return this._styleExpression.evaluateWithoutErrorHandling(x,P,U,te,ce,pe)},Ms.prototype.evaluate=function(x,P,U,te,ce,pe){return this._styleExpression.evaluate(x,P,U,te,ce,pe)},Ms.prototype.interpolationFactor=function(x,P,U){return this.interpolationType?Ua.interpolationFactor(this.interpolationType,x,P,U):0};var qs=function(x,P){this._parameters=x,this._specification=P,ht(this,function U(te,ce){var pe,Te,je,nt=ce.type==="color",dt=te.stops&&typeof te.stops[0][0]=="object",yt=dt||!(dt||te.property!==void 0),kt=te.type||(ks(ce)?"exponential":"interval");if(nt&&((te=ht({},te)).stops&&(te.stops=te.stops.map(function(kn){return[kn[0],Qt.parse(kn[1])]})),te.default=Qt.parse(te.default?te.default:ce.default)),te.colorSpace&&te.colorSpace!=="rgb"&&!ss[te.colorSpace])throw new Error("Unknown color space: "+te.colorSpace);if(kt==="exponential")pe=cc;else if(kt==="interval")pe=lc;else if(kt==="categorical"){pe=Ic,Te=Object.create(null);for(var Lt=0,Rt=te.stops;Lt<Rt.length;Lt+=1){var rr=Rt[Lt];Te[rr[0]]=rr[1]}je=typeof te.stops[0][0]}else{if(kt!=="identity")throw new Error('Unknown function type "'+kt+'"');pe=Oc}if(dt){for(var ar={},_r=[],dr=0;dr<te.stops.length;dr++){var Er=te.stops[dr],zr=Er[0].zoom;ar[zr]===void 0&&(ar[zr]={zoom:zr,type:te.type,property:te.property,default:te.default,stops:[]},_r.push(zr)),ar[zr].stops.push([Er[0].value,Er[1]])}for(var Ur=[],Vr=0,en=_r;Vr<en.length;Vr+=1){var hn=en[Vr];Ur.push([ar[hn].zoom,U(ar[hn],ce)])}var _n={name:"linear"};return{kind:"composite",interpolationType:_n,interpolationFactor:Ua.interpolationFactor.bind(void 0,_n),zoomStops:Ur.map(function(kn){return kn[0]}),evaluate:function(kn,Fn){var wn=kn.zoom;return cc({stops:Ur,base:te.base},ce,wn).evaluate(wn,Fn)}}}if(yt){var On=kt==="exponential"?{name:"exponential",base:te.base!==void 0?te.base:1}:null;return{kind:"camera",interpolationType:On,interpolationFactor:Ua.interpolationFactor.bind(void 0,On),zoomStops:te.stops.map(function(kn){return kn[0]}),evaluate:function(kn){return pe(te,ce,kn.zoom,Te,je)}}}return{kind:"source",evaluate:function(kn,Fn){var wn=Fn&&Fn.properties?Fn.properties[te.property]:void 0;return wn===void 0?es(te.default,ce.default):pe(te,ce,wn,Te,je)}}}(this._parameters,this._specification))};function To(x){var P=x.key,U=x.value,te=x.valueSpec||{},ce=x.objectElementValidators||{},pe=x.style,Te=x.styleSpec,je=[],nt=va(U);if(nt!=="object")return[new Je(P,U,"object expected, "+nt+" found")];for(var dt in U){var yt=dt.split(".")[0],kt=te[yt]||te["*"],Lt=void 0;if(ce[yt])Lt=ce[yt];else if(te[yt])Lt=Mi;else if(ce["*"])Lt=ce["*"];else{if(!te["*"]){je.push(new Je(P,U[dt],'unknown property "'+dt+'"'));continue}Lt=Mi}je=je.concat(Lt({key:(P&&P+".")+dt,value:U[dt],valueSpec:kt,style:pe,styleSpec:Te,object:U,objectKey:dt},U))}for(var Rt in te)ce[Rt]||te[Rt].required&&te[Rt].default===void 0&&U[Rt]===void 0&&je.push(new Je(P,U,'missing required property "'+Rt+'"'));return je}function Fl(x){var P=x.value,U=x.valueSpec,te=x.style,ce=x.styleSpec,pe=x.key,Te=x.arrayElementValidator||Mi;if(va(P)!=="array")return[new Je(pe,P,"array expected, "+va(P)+" found")];if(U.length&&P.length!==U.length)return[new Je(pe,P,"array length "+U.length+" expected, length "+P.length+" found")];if(U["min-length"]&&P.length<U["min-length"])return[new Je(pe,P,"array length at least "+U["min-length"]+" expected, length "+P.length+" found")];var je={type:U.value,values:U.values};ce.$version<7&&(je.function=U.function),va(U.value)==="object"&&(je=U.value);for(var nt=[],dt=0;dt<P.length;dt++)nt=nt.concat(Te({array:P,arrayIndex:dt,value:P[dt],valueSpec:je,style:te,styleSpec:ce,key:pe+"["+dt+"]"}));return nt}function Dc(x){var P=x.key,U=x.value,te=x.valueSpec,ce=va(U);return ce==="number"&&U!=U&&(ce="NaN"),ce!=="number"?[new Je(P,U,"number expected, "+ce+" found")]:"minimum"in te&&U<te.minimum?[new Je(P,U,U+" is less than the minimum value "+te.minimum)]:"maximum"in te&&U>te.maximum?[new Je(P,U,U+" is greater than the maximum value "+te.maximum)]:[]}function uc(x){var P,U,te,ce=x.valueSpec,pe=ct(x.value.type),Te={},je=pe!=="categorical"&&x.value.property===void 0,nt=!je,dt=va(x.value.stops)==="array"&&va(x.value.stops[0])==="array"&&va(x.value.stops[0][0])==="object",yt=To({key:x.key,value:x.value,valueSpec:x.styleSpec.function,style:x.style,styleSpec:x.styleSpec,objectElementValidators:{stops:function(Rt){if(pe==="identity")return[new Je(Rt.key,Rt.value,'identity function may not have a "stops" property')];var rr=[],ar=Rt.value;return rr=rr.concat(Fl({key:Rt.key,value:ar,valueSpec:Rt.valueSpec,style:Rt.style,styleSpec:Rt.styleSpec,arrayElementValidator:kt})),va(ar)==="array"&&ar.length===0&&rr.push(new Je(Rt.key,ar,"array must have at least one stop")),rr},default:function(Rt){return Mi({key:Rt.key,value:Rt.value,valueSpec:ce,style:Rt.style,styleSpec:Rt.styleSpec})}}});return pe==="identity"&&je&&yt.push(new Je(x.key,x.value,'missing required property "property"')),pe==="identity"||x.value.stops||yt.push(new Je(x.key,x.value,'missing required property "stops"')),pe==="exponential"&&x.valueSpec.expression&&!ks(x.valueSpec)&&yt.push(new Je(x.key,x.value,"exponential functions not supported")),x.styleSpec.$version>=8&&(nt&&!$o(x.valueSpec)?yt.push(new Je(x.key,x.value,"property functions not supported")):je&&!Us(x.valueSpec)&&yt.push(new Je(x.key,x.value,"zoom functions not supported"))),pe!=="categorical"&&!dt||x.value.property!==void 0||yt.push(new Je(x.key,x.value,'"property" property is required')),yt;function kt(Rt){var rr=[],ar=Rt.value,_r=Rt.key;if(va(ar)!=="array")return[new Je(_r,ar,"array expected, "+va(ar)+" found")];if(ar.length!==2)return[new Je(_r,ar,"array length 2 expected, length "+ar.length+" found")];if(dt){if(va(ar[0])!=="object")return[new Je(_r,ar,"object expected, "+va(ar[0])+" found")];if(ar[0].zoom===void 0)return[new Je(_r,ar,"object stop key must have zoom")];if(ar[0].value===void 0)return[new Je(_r,ar,"object stop key must have value")];if(te&&te>ct(ar[0].zoom))return[new Je(_r,ar[0].zoom,"stop zoom values must appear in ascending order")];ct(ar[0].zoom)!==te&&(te=ct(ar[0].zoom),U=void 0,Te={}),rr=rr.concat(To({key:_r+"[0]",value:ar[0],valueSpec:{zoom:{}},style:Rt.style,styleSpec:Rt.styleSpec,objectElementValidators:{zoom:Dc,value:Lt}}))}else rr=rr.concat(Lt({key:_r+"[0]",value:ar[0],valueSpec:{},style:Rt.style,styleSpec:Rt.styleSpec},ar));return hs(mt(ar[1]))?rr.concat([new Je(_r+"[1]",ar[1],"expressions are not allowed in function stops.")]):rr.concat(Mi({key:_r+"[1]",value:ar[1],valueSpec:ce,style:Rt.style,styleSpec:Rt.styleSpec}))}function Lt(Rt,rr){var ar=va(Rt.value),_r=ct(Rt.value),dr=Rt.value!==null?Rt.value:rr;if(P){if(ar!==P)return[new Je(Rt.key,dr,ar+" stop domain type must match previous stop domain type "+P)]}else P=ar;if(ar!=="number"&&ar!=="string"&&ar!=="boolean")return[new Je(Rt.key,dr,"stop domain value must be a number, string, or boolean")];if(ar!=="number"&&pe!=="categorical"){var Er="number expected, "+ar+" found";return $o(ce)&&pe===void 0&&(Er+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Je(Rt.key,dr,Er)]}return pe!=="categorical"||ar!=="number"||isFinite(_r)&&Math.floor(_r)===_r?pe!=="categorical"&&ar==="number"&&U!==void 0&&_r<U?[new Je(Rt.key,dr,"stop domain values must appear in ascending order")]:(U=_r,pe==="categorical"&&_r in Te?[new Je(Rt.key,dr,"stop domain values must be unique")]:(Te[_r]=!0,[])):[new Je(Rt.key,dr,"integer expected, found "+_r)]}}function As(x){var P=(x.expressionContext==="property"?zc:Vs)(mt(x.value),x.valueSpec);if(P.result==="error")return P.value.map(function(te){return new Je(""+x.key+te.key,x.value,te.message)});var U=P.value.expression||P.value._styleExpression.expression;if(x.expressionContext==="property"&&x.propertyKey==="text-font"&&!U.outputDefined())return[new Je(x.key,x.value,'Invalid data expression for "'+x.propertyKey+'". Output values must be contained as literals within the expression.')];if(x.expressionContext==="property"&&x.propertyType==="layout"&&!Jr(U))return[new Je(x.key,x.value,'"feature-state" data expressions are not supported with layout properties.')];if(x.expressionContext==="filter"&&!Jr(U))return[new Je(x.key,x.value,'"feature-state" data expressions are not supported with filters.')];if(x.expressionContext&&x.expressionContext.indexOf("cluster")===0){if(!dn(U,["zoom","feature-state"]))return[new Je(x.key,x.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(x.expressionContext==="cluster-initial"&&!sn(U))return[new Je(x.key,x.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Hs(x){var P=x.key,U=x.value,te=x.valueSpec,ce=[];return Array.isArray(te.values)?te.values.indexOf(ct(U))===-1&&ce.push(new Je(P,U,"expected one of ["+te.values.join(", ")+"], "+JSON.stringify(U)+" found")):Object.keys(te.values).indexOf(ct(U))===-1&&ce.push(new Je(P,U,"expected one of ["+Object.keys(te.values).join(", ")+"], "+JSON.stringify(U)+" found")),ce}function dl(x){if(x===!0||x===!1)return!0;if(!Array.isArray(x)||x.length===0)return!1;switch(x[0]){case"has":return x.length>=2&&x[1]!=="$id"&&x[1]!=="$type";case"in":return x.length>=3&&(typeof x[1]!="string"||Array.isArray(x[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return x.length!==3||Array.isArray(x[1])||Array.isArray(x[2]);case"any":case"all":for(var P=0,U=x.slice(1);P<U.length;P+=1){var te=U[P];if(!dl(te)&&typeof te!="boolean")return!1}return!0;default:return!0}}qs.deserialize=function(x){return new qs(x._parameters,x._specification)},qs.serialize=function(x){return{_parameters:x._parameters,_specification:x._specification}};var Bl={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Ss(x){if(x==null)return{filter:function(){return!0},needGeometry:!1};dl(x)||(x=Es(x));var P=Vs(x,Bl);if(P.result==="error")throw new Error(P.value.map(function(U){return U.key+": "+U.message}).join(", "));return{filter:function(U,te,ce){return P.value.evaluate(U,te,{},ce)},needGeometry:function U(te){if(!Array.isArray(te))return!1;if(te[0]==="within")return!0;for(var ce=1;ce<te.length;ce++)if(U(te[ce]))return!0;return!1}(x)}}function Gs(x,P){return x<P?-1:x>P?1:0}function Es(x){if(!x)return!0;var P,U=x[0];return x.length<=1?U!=="any":U==="=="?Ys(x[1],x[2],"=="):U==="!="?Nl(Ys(x[1],x[2],"==")):U==="<"||U===">"||U==="<="||U===">="?Ys(x[1],x[2],U):U==="any"?(P=x.slice(1),["any"].concat(P.map(Es))):U==="all"?["all"].concat(x.slice(1).map(Es)):U==="none"?["all"].concat(x.slice(1).map(Es).map(Nl)):U==="in"?ml(x[1],x.slice(2)):U==="!in"?Nl(ml(x[1],x.slice(2))):U==="has"?ns(x[1]):U==="!has"?Nl(ns(x[1])):U!=="within"||x}function Ys(x,P,U){switch(x){case"$type":return["filter-type-"+U,P];case"$id":return["filter-id-"+U,P];default:return["filter-"+U,x,P]}}function ml(x,P){if(P.length===0)return!1;switch(x){case"$type":return["filter-type-in",["literal",P]];case"$id":return["filter-id-in",["literal",P]];default:return P.length>200&&!P.some(function(U){return typeof U!=typeof P[0]})?["filter-in-large",x,["literal",P.sort(Gs)]]:["filter-in-small",x,["literal",P]]}}function ns(x){switch(x){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",x]}}function Nl(x){return["!",x]}function fc(x){return dl(mt(x.value))?As(ht({},x,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function P(U){var te=U.value,ce=U.key;if(va(te)!=="array")return[new Je(ce,te,"array expected, "+va(te)+" found")];var pe,Te=U.styleSpec,je=[];if(te.length<1)return[new Je(ce,te,"filter array must have at least 1 element")];switch(je=je.concat(Hs({key:ce+"[0]",value:te[0],valueSpec:Te.filter_operator,style:U.style,styleSpec:U.styleSpec})),ct(te[0])){case"<":case"<=":case">":case">=":te.length>=2&&ct(te[1])==="$type"&&je.push(new Je(ce,te,'"$type" cannot be use with operator "'+te[0]+'"'));case"==":case"!=":te.length!==3&&je.push(new Je(ce,te,'filter array for operator "'+te[0]+'" must have 3 elements'));case"in":case"!in":te.length>=2&&(pe=va(te[1]))!=="string"&&je.push(new Je(ce+"[1]",te[1],"string expected, "+pe+" found"));for(var nt=2;nt<te.length;nt++)pe=va(te[nt]),ct(te[1])==="$type"?je=je.concat(Hs({key:ce+"["+nt+"]",value:te[nt],valueSpec:Te.geometry_type,style:U.style,styleSpec:U.styleSpec})):pe!=="string"&&pe!=="number"&&pe!=="boolean"&&je.push(new Je(ce+"["+nt+"]",te[nt],"string, number, or boolean expected, "+pe+" found"));break;case"any":case"all":case"none":for(var dt=1;dt<te.length;dt++)je=je.concat(P({key:ce+"["+dt+"]",value:te[dt],style:U.style,styleSpec:U.styleSpec}));break;case"has":case"!has":pe=va(te[1]),te.length!==2?je.push(new Je(ce,te,'filter array for "'+te[0]+'" operator must have 2 elements')):pe!=="string"&&je.push(new Je(ce+"[1]",te[1],"string expected, "+pe+" found"));break;case"within":pe=va(te[1]),te.length!==2?je.push(new Je(ce,te,'filter array for "'+te[0]+'" operator must have 2 elements')):pe!=="object"&&je.push(new Je(ce+"[1]",te[1],"object expected, "+pe+" found"))}return je}(x)}function Rc(x,P){var U=x.key,te=x.style,ce=x.styleSpec,pe=x.value,Te=x.objectKey,je=ce[P+"_"+x.layerType];if(!je)return[];var nt=Te.match(/^(.*)-transition$/);if(P==="paint"&&nt&&je[nt[1]]&&je[nt[1]].transition)return Mi({key:U,value:pe,valueSpec:ce.transition,style:te,styleSpec:ce});var dt,yt=x.valueSpec||je[Te];if(!yt)return[new Je(U,pe,'unknown property "'+Te+'"')];if(va(pe)==="string"&&$o(yt)&&!yt.tokens&&(dt=/^{([^}]+)}$/.exec(pe)))return[new Je(U,pe,'"'+Te+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(dt[1])+" }`.")];var kt=[];return x.layerType==="symbol"&&(Te==="text-field"&&te&&!te.glyphs&&kt.push(new Je(U,pe,'use of "text-field" requires a style "glyphs" property')),Te==="text-font"&&Li(mt(pe))&&ct(pe.type)==="identity"&&kt.push(new Je(U,pe,'"text-font" does not support identity functions'))),kt.concat(Mi({key:x.key,value:pe,valueSpec:yt,style:te,styleSpec:ce,expressionContext:"property",propertyType:P,propertyKey:Te}))}function hc(x){return Rc(x,"paint")}function vl(x){return Rc(x,"layout")}function to(x){var P=[],U=x.value,te=x.key,ce=x.style,pe=x.styleSpec;U.type||U.ref||P.push(new Je(te,U,'either "type" or "ref" is required'));var Te,je=ct(U.type),nt=ct(U.ref);if(U.id)for(var dt=ct(U.id),yt=0;yt<x.arrayIndex;yt++){var kt=ce.layers[yt];ct(kt.id)===dt&&P.push(new Je(te,U.id,'duplicate layer id "'+U.id+'", previously used at line '+kt.id.__line__))}if("ref"in U)["type","source","source-layer","filter","layout"].forEach(function(rr){rr in U&&P.push(new Je(te,U[rr],'"'+rr+'" is prohibited for ref layers'))}),ce.layers.forEach(function(rr){ct(rr.id)===nt&&(Te=rr)}),Te?Te.ref?P.push(new Je(te,U.ref,"ref cannot reference another ref layer")):je=ct(Te.type):P.push(new Je(te,U.ref,'ref layer "'+nt+'" not found'));else if(je!=="background")if(U.source){var Lt=ce.sources&&ce.sources[U.source],Rt=Lt&&ct(Lt.type);Lt?Rt==="vector"&&je==="raster"?P.push(new Je(te,U.source,'layer "'+U.id+'" requires a raster source')):Rt==="raster"&&je!=="raster"?P.push(new Je(te,U.source,'layer "'+U.id+'" requires a vector source')):Rt!=="vector"||U["source-layer"]?Rt==="raster-dem"&&je!=="hillshade"?P.push(new Je(te,U.source,"raster-dem source can only be used with layer type 'hillshade'.")):je!=="line"||!U.paint||!U.paint["line-gradient"]||Rt==="geojson"&&Lt.lineMetrics||P.push(new Je(te,U,'layer "'+U.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):P.push(new Je(te,U,'layer "'+U.id+'" must specify a "source-layer"')):P.push(new Je(te,U.source,'source "'+U.source+'" not found'))}else P.push(new Je(te,U,'missing required property "source"'));return P=P.concat(To({key:te,value:U,valueSpec:pe.layer,style:x.style,styleSpec:x.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return Mi({key:te+".type",value:U.type,valueSpec:pe.layer.type,style:x.style,styleSpec:x.styleSpec,object:U,objectKey:"type"})},filter:fc,layout:function(rr){return To({layer:U,key:rr.key,value:rr.value,style:rr.style,styleSpec:rr.styleSpec,objectElementValidators:{"*":function(ar){return vl(ht({layerType:je},ar))}}})},paint:function(rr){return To({layer:U,key:rr.key,value:rr.value,style:rr.style,styleSpec:rr.styleSpec,objectElementValidators:{"*":function(ar){return hc(ht({layerType:je},ar))}}})}}}))}function Bi(x){var P=x.value,U=x.key,te=va(P);return te!=="string"?[new Je(U,P,"string expected, "+te+" found")]:[]}var pc={promoteId:function(x){var P=x.key,U=x.value;if(va(U)==="string")return Bi({key:P,value:U});var te=[];for(var ce in U)te.push.apply(te,Bi({key:P+"."+ce,value:U[ce]}));return te}};function jl(x){var P=x.value,U=x.key,te=x.styleSpec,ce=x.style;if(!P.type)return[new Je(U,P,'"type" is required')];var pe,Te=ct(P.type);switch(Te){case"vector":case"raster":case"raster-dem":return To({key:U,value:P,valueSpec:te["source_"+Te.replace("-","_")],style:x.style,styleSpec:te,objectElementValidators:pc});case"geojson":if(pe=To({key:U,value:P,valueSpec:te.source_geojson,style:ce,styleSpec:te,objectElementValidators:pc}),P.cluster)for(var je in P.clusterProperties){var nt=P.clusterProperties[je],dt=nt[0],yt=typeof dt=="string"?[dt,["accumulated"],["get",je]]:dt;pe.push.apply(pe,As({key:U+"."+je+".map",value:nt[1],expressionContext:"cluster-map"})),pe.push.apply(pe,As({key:U+"."+je+".reduce",value:yt,expressionContext:"cluster-reduce"}))}return pe;case"video":return To({key:U,value:P,valueSpec:te.source_video,style:ce,styleSpec:te});case"image":return To({key:U,value:P,valueSpec:te.source_image,style:ce,styleSpec:te});case"canvas":return[new Je(U,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Hs({key:U+".type",value:P.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:ce,styleSpec:te})}}function Aa(x){var P=x.value,U=x.styleSpec,te=U.light,ce=x.style,pe=[],Te=va(P);if(P===void 0)return pe;if(Te!=="object")return pe.concat([new Je("light",P,"object expected, "+Te+" found")]);for(var je in P){var nt=je.match(/^(.*)-transition$/);pe=pe.concat(nt&&te[nt[1]]&&te[nt[1]].transition?Mi({key:je,value:P[je],valueSpec:U.transition,style:ce,styleSpec:U}):te[je]?Mi({key:je,value:P[je],valueSpec:te[je],style:ce,styleSpec:U}):[new Je(je,P[je],'unknown property "'+je+'"')])}return pe}var Ul={"*":function(){return[]},array:Fl,boolean:function(x){var P=x.value,U=x.key,te=va(P);return te!=="boolean"?[new Je(U,P,"boolean expected, "+te+" found")]:[]},number:Dc,color:function(x){var P=x.key,U=x.value,te=va(U);return te!=="string"?[new Je(P,U,"color expected, "+te+" found")]:zt(U)===null?[new Je(P,U,'color expected, "'+U+'" found')]:[]},constants:it,enum:Hs,filter:fc,function:uc,layer:to,object:To,source:jl,light:Aa,string:Bi,formatted:function(x){return Bi(x).length===0?[]:As(x)},resolvedImage:function(x){return Bi(x).length===0?[]:As(x)}};function Mi(x){var P=x.value,U=x.valueSpec,te=x.styleSpec;return U.expression&&Li(ct(P))?uc(x):U.expression&&hs(mt(P))?As(x):U.type&&Ul[U.type]?Ul[U.type](x):To(ht({},x,{valueSpec:U.type?te[U.type]:U}))}function Cs(x){var P=x.value,U=x.key,te=Bi(x);return te.length||(P.indexOf("{fontstack}")===-1&&te.push(new Je(U,P,'"glyphs" url must include a "{fontstack}" token')),P.indexOf("{range}")===-1&&te.push(new Je(U,P,'"glyphs" url must include a "{range}" token'))),te}function fa(x,P){P===void 0&&(P=Ee);var U=[];return U=U.concat(Mi({key:"",value:x,valueSpec:P.$root,styleSpec:P,style:x,objectElementValidators:{glyphs:Cs,"*":function(){return[]}}})),x.constants&&(U=U.concat(it({key:"constants",value:x.constants,style:x,styleSpec:P}))),ya(U)}function ya(x){return[].concat(x).sort(function(P,U){return P.line-U.line})}function ui(x){return function(){for(var P=[],U=arguments.length;U--;)P[U]=arguments[U];return ya(x.apply(this,P))}}fa.source=ui(jl),fa.light=ui(Aa),fa.layer=ui(to),fa.filter=ui(fc),fa.paintProperty=ui(hc),fa.layoutProperty=ui(vl);var Po=fa,Fc=Po.light,yl=Po.paintProperty,Bc=Po.layoutProperty;function Vl(x,P){var U=!1;if(P&&P.length)for(var te=0,ce=P;te<ce.length;te+=1)x.fire(new Ye(new Error(ce[te].message))),U=!0;return U}var ko=Wi;function Wi(x,P,U){var te=this.cells=[];if(x instanceof ArrayBuffer){this.arrayBuffer=x;var ce=new Int32Array(this.arrayBuffer);x=ce[0],this.d=(P=ce[1])+2*(U=ce[2]);for(var pe=0;pe<this.d*this.d;pe++){var Te=ce[3+pe],je=ce[3+pe+1];te.push(Te===je?null:ce.subarray(Te,je))}var nt=ce[3+te.length+1];this.keys=ce.subarray(ce[3+te.length],nt),this.bboxes=ce.subarray(nt),this.insert=this._insertReadonly}else{this.d=P+2*U;for(var dt=0;dt<this.d*this.d;dt++)te.push([]);this.keys=[],this.bboxes=[]}this.n=P,this.extent=x,this.padding=U,this.scale=P/x,this.uid=0;var yt=U/P*x;this.min=-yt,this.max=x+yt}Wi.prototype.insert=function(x,P,U,te,ce){this._forEachCell(P,U,te,ce,this._insertCell,this.uid++),this.keys.push(x),this.bboxes.push(P),this.bboxes.push(U),this.bboxes.push(te),this.bboxes.push(ce)},Wi.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Wi.prototype._insertCell=function(x,P,U,te,ce,pe){this.cells[ce].push(pe)},Wi.prototype.query=function(x,P,U,te,ce){var pe=this.min,Te=this.max;if(x<=pe&&P<=pe&&Te<=U&&Te<=te&&!ce)return Array.prototype.slice.call(this.keys);var je=[];return this._forEachCell(x,P,U,te,this._queryCell,je,{},ce),je},Wi.prototype._queryCell=function(x,P,U,te,ce,pe,Te,je){var nt=this.cells[ce];if(nt!==null)for(var dt=this.keys,yt=this.bboxes,kt=0;kt<nt.length;kt++){var Lt=nt[kt];if(Te[Lt]===void 0){var Rt=4*Lt;(je?je(yt[Rt+0],yt[Rt+1],yt[Rt+2],yt[Rt+3]):x<=yt[Rt+2]&&P<=yt[Rt+3]&&U>=yt[Rt+0]&&te>=yt[Rt+1])?(Te[Lt]=!0,pe.push(dt[Lt])):Te[Lt]=!1}}},Wi.prototype._forEachCell=function(x,P,U,te,ce,pe,Te,je){for(var nt=this._convertToCellCoord(x),dt=this._convertToCellCoord(P),yt=this._convertToCellCoord(U),kt=this._convertToCellCoord(te),Lt=nt;Lt<=yt;Lt++)for(var Rt=dt;Rt<=kt;Rt++){var rr=this.d*Rt+Lt;if((!je||je(this._convertFromCellCoord(Lt),this._convertFromCellCoord(Rt),this._convertFromCellCoord(Lt+1),this._convertFromCellCoord(Rt+1)))&&ce.call(this,x,P,U,te,rr,pe,Te,je))return}},Wi.prototype._convertFromCellCoord=function(x){return(x-this.padding)/this.scale},Wi.prototype._convertToCellCoord=function(x){return Math.max(0,Math.min(this.d-1,Math.floor(x*this.scale)+this.padding))},Wi.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var x=this.cells,P=3+this.cells.length+1+1,U=0,te=0;te<this.cells.length;te++)U+=this.cells[te].length;var ce=new Int32Array(P+U+this.keys.length+this.bboxes.length);ce[0]=this.extent,ce[1]=this.n,ce[2]=this.padding;for(var pe=P,Te=0;Te<x.length;Te++){var je=x[Te];ce[3+Te]=pe,ce.set(je,pe),pe+=je.length}return ce[3+x.length]=pe,ce.set(this.keys,pe),ce[3+x.length+1]=pe+=this.keys.length,ce.set(this.bboxes,pe),pe+=this.bboxes.length,ce.buffer};var Ws=self.ImageData,Ni=self.ImageBitmap,as={};function En(x,P,U){U===void 0&&(U={}),Object.defineProperty(P,"_classRegistryKey",{value:x,writeable:!1}),as[x]={klass:P,omit:U.omit||[],shallow:U.shallow||[]}}for(var Wa in En("Object",Object),ko.serialize=function(x,P){var U=x.toArrayBuffer();return P&&P.push(U),{buffer:U}},ko.deserialize=function(x){return new ko(x.buffer)},En("Grid",ko),En("Color",Qt),En("Error",Error),En("ResolvedImage",ur),En("StylePropertyFunction",qs),En("StyleExpression",ts,{omit:["_evaluator"]}),En("ZoomDependentExpression",Ms),En("ZoomConstantExpression",rs),En("CompoundExpression",un,{omit:["_evaluate"]}),co)co[Wa]._classRegistryKey||En("Expression_"+Wa,co[Wa]);function ro(x){return x&&typeof ArrayBuffer<"u"&&(x instanceof ArrayBuffer||x.constructor&&x.constructor.name==="ArrayBuffer")}function Zi(x){return Ni&&x instanceof Ni}function uo(x,P){if(x==null||typeof x=="boolean"||typeof x=="number"||typeof x=="string"||x instanceof Boolean||x instanceof Number||x instanceof String||x instanceof Date||x instanceof RegExp)return x;if(ro(x)||Zi(x))return P&&P.push(x),x;if(ArrayBuffer.isView(x)){var U=x;return P&&P.push(U.buffer),U}if(x instanceof Ws)return P&&P.push(x.data.buffer),x;if(Array.isArray(x)){for(var te=[],ce=0,pe=x;ce<pe.length;ce+=1)te.push(uo(pe[ce],P));return te}if(typeof x=="object"){var Te=x.constructor,je=Te._classRegistryKey;if(!je)throw new Error("can't serialize object of unregistered class");var nt=Te.serialize?Te.serialize(x,P):{};if(!Te.serialize){for(var dt in x)if(x.hasOwnProperty(dt)&&!(as[je].omit.indexOf(dt)>=0)){var yt=x[dt];nt[dt]=as[je].shallow.indexOf(dt)>=0?yt:uo(yt,P)}x instanceof Error&&(nt.message=x.message)}if(nt.$name)throw new Error("$name property is reserved for worker serialization logic.");return je!=="Object"&&(nt.$name=je),nt}throw new Error("can't serialize object of type "+typeof x)}function no(x){if(x==null||typeof x=="boolean"||typeof x=="number"||typeof x=="string"||x instanceof Boolean||x instanceof Number||x instanceof String||x instanceof Date||x instanceof RegExp||ro(x)||Zi(x)||ArrayBuffer.isView(x)||x instanceof Ws)return x;if(Array.isArray(x))return x.map(no);if(typeof x=="object"){var P=x.$name||"Object",U=as[P].klass;if(!U)throw new Error("can't deserialize unregistered class "+P);if(U.deserialize)return U.deserialize(x);for(var te=Object.create(U.prototype),ce=0,pe=Object.keys(x);ce<pe.length;ce+=1){var Te=pe[ce];if(Te!=="$name"){var je=x[Te];te[Te]=as[P].shallow.indexOf(Te)>=0?je:no(je)}}return te}throw new Error("can't deserialize object of type "+typeof x)}var Io=function(){this.first=!0};Io.prototype.update=function(x,P){var U=Math.floor(x);return this.first?(this.first=!1,this.lastIntegerZoom=U,this.lastIntegerZoomTime=0,this.lastZoom=x,this.lastFloorZoom=U,!0):(this.lastFloorZoom>U?(this.lastIntegerZoom=U+1,this.lastIntegerZoomTime=P):this.lastFloorZoom<U&&(this.lastIntegerZoom=U,this.lastIntegerZoomTime=P),x!==this.lastZoom&&(this.lastZoom=x,this.lastFloorZoom=U,!0))};var vn={"Latin-1 Supplement":function(x){return x>=128&&x<=255},Arabic:function(x){return x>=1536&&x<=1791},"Arabic Supplement":function(x){return x>=1872&&x<=1919},"Arabic Extended-A":function(x){return x>=2208&&x<=2303},"Hangul Jamo":function(x){return x>=4352&&x<=4607},"Unified Canadian Aboriginal Syllabics":function(x){return x>=5120&&x<=5759},Khmer:function(x){return x>=6016&&x<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(x){return x>=6320&&x<=6399},"General Punctuation":function(x){return x>=8192&&x<=8303},"Letterlike Symbols":function(x){return x>=8448&&x<=8527},"Number Forms":function(x){return x>=8528&&x<=8591},"Miscellaneous Technical":function(x){return x>=8960&&x<=9215},"Control Pictures":function(x){return x>=9216&&x<=9279},"Optical Character Recognition":function(x){return x>=9280&&x<=9311},"Enclosed Alphanumerics":function(x){return x>=9312&&x<=9471},"Geometric Shapes":function(x){return x>=9632&&x<=9727},"Miscellaneous Symbols":function(x){return x>=9728&&x<=9983},"Miscellaneous Symbols and Arrows":function(x){return x>=11008&&x<=11263},"CJK Radicals Supplement":function(x){return x>=11904&&x<=12031},"Kangxi Radicals":function(x){return x>=12032&&x<=12255},"Ideographic Description Characters":function(x){return x>=12272&&x<=12287},"CJK Symbols and Punctuation":function(x){return x>=12288&&x<=12351},Hiragana:function(x){return x>=12352&&x<=12447},Katakana:function(x){return x>=12448&&x<=12543},Bopomofo:function(x){return x>=12544&&x<=12591},"Hangul Compatibility Jamo":function(x){return x>=12592&&x<=12687},Kanbun:function(x){return x>=12688&&x<=12703},"Bopomofo Extended":function(x){return x>=12704&&x<=12735},"CJK Strokes":function(x){return x>=12736&&x<=12783},"Katakana Phonetic Extensions":function(x){return x>=12784&&x<=12799},"Enclosed CJK Letters and Months":function(x){return x>=12800&&x<=13055},"CJK Compatibility":function(x){return x>=13056&&x<=13311},"CJK Unified Ideographs Extension A":function(x){return x>=13312&&x<=19903},"Yijing Hexagram Symbols":function(x){return x>=19904&&x<=19967},"CJK Unified Ideographs":function(x){return x>=19968&&x<=40959},"Yi Syllables":function(x){return x>=40960&&x<=42127},"Yi Radicals":function(x){return x>=42128&&x<=42191},"Hangul Jamo Extended-A":function(x){return x>=43360&&x<=43391},"Hangul Syllables":function(x){return x>=44032&&x<=55215},"Hangul Jamo Extended-B":function(x){return x>=55216&&x<=55295},"Private Use Area":function(x){return x>=57344&&x<=63743},"CJK Compatibility Ideographs":function(x){return x>=63744&&x<=64255},"Arabic Presentation Forms-A":function(x){return x>=64336&&x<=65023},"Vertical Forms":function(x){return x>=65040&&x<=65055},"CJK Compatibility Forms":function(x){return x>=65072&&x<=65103},"Small Form Variants":function(x){return x>=65104&&x<=65135},"Arabic Presentation Forms-B":function(x){return x>=65136&&x<=65279},"Halfwidth and Fullwidth Forms":function(x){return x>=65280&&x<=65519}};function Pi(x){for(var P=0,U=x;P<U.length;P+=1)if(ql(U[P].charCodeAt(0)))return!0;return!1}function ql(x){return!(x!==746&&x!==747&&(x<4352||!(vn["Bopomofo Extended"](x)||vn.Bopomofo(x)||vn["CJK Compatibility Forms"](x)&&!(x>=65097&&x<=65103)||vn["CJK Compatibility Ideographs"](x)||vn["CJK Compatibility"](x)||vn["CJK Radicals Supplement"](x)||vn["CJK Strokes"](x)||!(!vn["CJK Symbols and Punctuation"](x)||x>=12296&&x<=12305||x>=12308&&x<=12319||x===12336)||vn["CJK Unified Ideographs Extension A"](x)||vn["CJK Unified Ideographs"](x)||vn["Enclosed CJK Letters and Months"](x)||vn["Hangul Compatibility Jamo"](x)||vn["Hangul Jamo Extended-A"](x)||vn["Hangul Jamo Extended-B"](x)||vn["Hangul Jamo"](x)||vn["Hangul Syllables"](x)||vn.Hiragana(x)||vn["Ideographic Description Characters"](x)||vn.Kanbun(x)||vn["Kangxi Radicals"](x)||vn["Katakana Phonetic Extensions"](x)||vn.Katakana(x)&&x!==12540||!(!vn["Halfwidth and Fullwidth Forms"](x)||x===65288||x===65289||x===65293||x>=65306&&x<=65310||x===65339||x===65341||x===65343||x>=65371&&x<=65503||x===65507||x>=65512&&x<=65519)||!(!vn["Small Form Variants"](x)||x>=65112&&x<=65118||x>=65123&&x<=65126)||vn["Unified Canadian Aboriginal Syllabics"](x)||vn["Unified Canadian Aboriginal Syllabics Extended"](x)||vn["Vertical Forms"](x)||vn["Yijing Hexagram Symbols"](x)||vn["Yi Syllables"](x)||vn["Yi Radicals"](x))))}function Hl(x){return!(ql(x)||function(P){return!!(vn["Latin-1 Supplement"](P)&&(P===167||P===169||P===174||P===177||P===188||P===189||P===190||P===215||P===247)||vn["General Punctuation"](P)&&(P===8214||P===8224||P===8225||P===8240||P===8241||P===8251||P===8252||P===8258||P===8263||P===8264||P===8265||P===8273)||vn["Letterlike Symbols"](P)||vn["Number Forms"](P)||vn["Miscellaneous Technical"](P)&&(P>=8960&&P<=8967||P>=8972&&P<=8991||P>=8996&&P<=9e3||P===9003||P>=9085&&P<=9114||P>=9150&&P<=9165||P===9167||P>=9169&&P<=9179||P>=9186&&P<=9215)||vn["Control Pictures"](P)&&P!==9251||vn["Optical Character Recognition"](P)||vn["Enclosed Alphanumerics"](P)||vn["Geometric Shapes"](P)||vn["Miscellaneous Symbols"](P)&&!(P>=9754&&P<=9759)||vn["Miscellaneous Symbols and Arrows"](P)&&(P>=11026&&P<=11055||P>=11088&&P<=11097||P>=11192&&P<=11243)||vn["CJK Symbols and Punctuation"](P)||vn.Katakana(P)||vn["Private Use Area"](P)||vn["CJK Compatibility Forms"](P)||vn["Small Form Variants"](P)||vn["Halfwidth and Fullwidth Forms"](P)||P===8734||P===8756||P===8757||P>=9984&&P<=10087||P>=10102&&P<=10131||P===65532||P===65533)}(x))}function Zs(x){return x>=1424&&x<=2303||vn["Arabic Presentation Forms-A"](x)||vn["Arabic Presentation Forms-B"](x)}function fo(x,P){return!(!P&&Zs(x)||x>=2304&&x<=3583||x>=3840&&x<=4255||vn.Khmer(x))}function ji(x){for(var P=0,U=x;P<U.length;P+=1)if(Zs(U[P].charCodeAt(0)))return!0;return!1}var Ls=null,Ai="unavailable",ao=null,Ps=function(x){x&&typeof x=="string"&&x.indexOf("NetworkError")>-1&&(Ai="error"),Ls&&Ls(x)};function Gl(){xl.fire(new Ue("pluginStateChange",{pluginStatus:Ai,pluginURL:ao}))}var xl=new xe,Xs=function(){return Ai},Yl=function(){if(Ai!=="deferred"||!ao)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Ai="loading",Gl(),ao&&We({url:ao},function(x){x?Ps(x):(Ai="loaded",Gl())})},Za={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return Ai==="loaded"||Za.applyArabicShaping!=null},isLoading:function(){return Ai==="loading"},setState:function(x){Ai=x.pluginStatus,ao=x.pluginURL},isParsed:function(){return Za.applyArabicShaping!=null&&Za.processBidirectionalText!=null&&Za.processStyledBidirectionalText!=null},getPluginURL:function(){return ao}},Ta=function(x,P){this.zoom=x,P?(this.now=P.now,this.fadeDuration=P.fadeDuration,this.zoomHistory=P.zoomHistory,this.transition=P.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Io,this.transition={})};Ta.prototype.isSupportedScript=function(x){return function(P,U){for(var te=0,ce=P;te<ce.length;te+=1)if(!fo(ce[te].charCodeAt(0),U))return!1;return!0}(x,Za.isLoaded())},Ta.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},Ta.prototype.getCrossfadeParameters=function(){var x=this.zoom,P=x-Math.floor(x),U=this.crossFadingFactor();return x>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:P+(1-P)*U}:{fromScale:.5,toScale:1,t:1-(1-U)*P}};var za=function(x,P){this.property=x,this.value=P,this.expression=function(U,te){if(Li(U))return new qs(U,te);if(hs(U)){var ce=zc(U,te);if(ce.result==="error")throw new Error(ce.value.map(function(Te){return Te.key+": "+Te.message}).join(", "));return ce.value}var pe=U;return typeof U=="string"&&te.type==="color"&&(pe=Qt.parse(U)),{kind:"constant",evaluate:function(){return pe}}}(P===void 0?x.specification.default:P,x.specification)};za.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},za.prototype.possiblyEvaluate=function(x,P,U){return this.property.possiblyEvaluate(this,x,P,U)};var Ui=function(x){this.property=x,this.value=new za(x,void 0)};Ui.prototype.transitioned=function(x,P){return new Xi(this.property,this.value,P,d({},x.transition,this.transition),x.now)},Ui.prototype.untransitioned=function(){return new Xi(this.property,this.value,null,{},0)};var ri=function(x){this._properties=x,this._values=Object.create(x.defaultTransitionablePropertyValues)};ri.prototype.getValue=function(x){return b(this._values[x].value.value)},ri.prototype.setValue=function(x,P){this._values.hasOwnProperty(x)||(this._values[x]=new Ui(this._values[x].property)),this._values[x].value=new za(this._values[x].property,P===null?void 0:b(P))},ri.prototype.getTransition=function(x){return b(this._values[x].transition)},ri.prototype.setTransition=function(x,P){this._values.hasOwnProperty(x)||(this._values[x]=new Ui(this._values[x].property)),this._values[x].transition=b(P)||void 0},ri.prototype.serialize=function(){for(var x={},P=0,U=Object.keys(this._values);P<U.length;P+=1){var te=U[P],ce=this.getValue(te);ce!==void 0&&(x[te]=ce);var pe=this.getTransition(te);pe!==void 0&&(x[te+"-transition"]=pe)}return x},ri.prototype.transitioned=function(x,P){for(var U=new ho(this._properties),te=0,ce=Object.keys(this._values);te<ce.length;te+=1){var pe=ce[te];U._values[pe]=this._values[pe].transitioned(x,P._values[pe])}return U},ri.prototype.untransitioned=function(){for(var x=new ho(this._properties),P=0,U=Object.keys(this._values);P<U.length;P+=1){var te=U[P];x._values[te]=this._values[te].untransitioned()}return x};var Xi=function(x,P,U,te,ce){this.property=x,this.value=P,this.begin=ce+te.delay||0,this.end=this.begin+te.duration||0,x.specification.transition&&(te.delay||te.duration)&&(this.prior=U)};Xi.prototype.possiblyEvaluate=function(x,P,U){var te=x.now||0,ce=this.value.possiblyEvaluate(x,P,U),pe=this.prior;if(pe){if(te>this.end)return this.prior=null,ce;if(this.value.isDataDriven())return this.prior=null,ce;if(te<this.begin)return pe.possiblyEvaluate(x,P,U);var Te=(te-this.begin)/(this.end-this.begin);return this.property.interpolate(pe.possiblyEvaluate(x,P,U),ce,function(je){if(je<=0)return 0;if(je>=1)return 1;var nt=je*je,dt=nt*je;return 4*(je<.5?dt:3*(je-nt)+dt-.75)}(Te))}return ce};var ho=function(x){this._properties=x,this._values=Object.create(x.defaultTransitioningPropertyValues)};ho.prototype.possiblyEvaluate=function(x,P,U){for(var te=new ps(this._properties),ce=0,pe=Object.keys(this._values);ce<pe.length;ce+=1){var Te=pe[ce];te._values[Te]=this._values[Te].possiblyEvaluate(x,P,U)}return te},ho.prototype.hasTransition=function(){for(var x=0,P=Object.keys(this._values);x<P.length;x+=1)if(this._values[P[x]].prior)return!0;return!1};var Oo=function(x){this._properties=x,this._values=Object.create(x.defaultPropertyValues)};Oo.prototype.getValue=function(x){return b(this._values[x].value)},Oo.prototype.setValue=function(x,P){this._values[x]=new za(this._values[x].property,P===null?void 0:b(P))},Oo.prototype.serialize=function(){for(var x={},P=0,U=Object.keys(this._values);P<U.length;P+=1){var te=U[P],ce=this.getValue(te);ce!==void 0&&(x[te]=ce)}return x},Oo.prototype.possiblyEvaluate=function(x,P,U){for(var te=new ps(this._properties),ce=0,pe=Object.keys(this._values);ce<pe.length;ce+=1){var Te=pe[ce];te._values[Te]=this._values[Te].possiblyEvaluate(x,P,U)}return te};var ni=function(x,P,U){this.property=x,this.value=P,this.parameters=U};ni.prototype.isConstant=function(){return this.value.kind==="constant"},ni.prototype.constantOr=function(x){return this.value.kind==="constant"?this.value.value:x},ni.prototype.evaluate=function(x,P,U,te){return this.property.evaluate(this.value,this.parameters,x,P,U,te)};var ps=function(x){this._properties=x,this._values=Object.create(x.defaultPossiblyEvaluatedValues)};ps.prototype.get=function(x){return this._values[x]};var Rn=function(x){this.specification=x};Rn.prototype.possiblyEvaluate=function(x,P){return x.expression.evaluate(P)},Rn.prototype.interpolate=function(x,P,U){var te=Pn[this.specification.type];return te?te(x,P,U):x};var jn=function(x,P){this.specification=x,this.overrides=P};jn.prototype.possiblyEvaluate=function(x,P,U,te){return new ni(this,x.expression.kind==="constant"||x.expression.kind==="camera"?{kind:"constant",value:x.expression.evaluate(P,null,{},U,te)}:x.expression,P)},jn.prototype.interpolate=function(x,P,U){if(x.value.kind!=="constant"||P.value.kind!=="constant")return x;if(x.value.value===void 0||P.value.value===void 0)return new ni(this,{kind:"constant",value:void 0},x.parameters);var te=Pn[this.specification.type];return te?new ni(this,{kind:"constant",value:te(x.value.value,P.value.value,U)},x.parameters):x},jn.prototype.evaluate=function(x,P,U,te,ce,pe){return x.kind==="constant"?x.value:x.evaluate(P,U,te,ce,pe)};var Va=function(x){function P(){x.apply(this,arguments)}return x&&(P.__proto__=x),(P.prototype=Object.create(x&&x.prototype)).constructor=P,P.prototype.possiblyEvaluate=function(U,te,ce,pe){if(U.value===void 0)return new ni(this,{kind:"constant",value:void 0},te);if(U.expression.kind==="constant"){var Te=U.expression.evaluate(te,null,{},ce,pe),je=U.property.specification.type==="resolvedImage"&&typeof Te!="string"?Te.name:Te,nt=this._calculate(je,je,je,te);return new ni(this,{kind:"constant",value:nt},te)}if(U.expression.kind==="camera"){var dt=this._calculate(U.expression.evaluate({zoom:te.zoom-1}),U.expression.evaluate({zoom:te.zoom}),U.expression.evaluate({zoom:te.zoom+1}),te);return new ni(this,{kind:"constant",value:dt},te)}return new ni(this,U.expression,te)},P.prototype.evaluate=function(U,te,ce,pe,Te,je){if(U.kind==="source"){var nt=U.evaluate(te,ce,pe,Te,je);return this._calculate(nt,nt,nt,te)}return U.kind==="composite"?this._calculate(U.evaluate({zoom:Math.floor(te.zoom)-1},ce,pe),U.evaluate({zoom:Math.floor(te.zoom)},ce,pe),U.evaluate({zoom:Math.floor(te.zoom)+1},ce,pe),te):U.value},P.prototype._calculate=function(U,te,ce,pe){return pe.zoom>pe.zoomHistory.lastIntegerZoom?{from:U,to:te}:{from:ce,to:te}},P.prototype.interpolate=function(U){return U},P}(jn),Js=function(x){this.specification=x};Js.prototype.possiblyEvaluate=function(x,P,U,te){if(x.value!==void 0){if(x.expression.kind==="constant"){var ce=x.expression.evaluate(P,null,{},U,te);return this._calculate(ce,ce,ce,P)}return this._calculate(x.expression.evaluate(new Ta(Math.floor(P.zoom-1),P)),x.expression.evaluate(new Ta(Math.floor(P.zoom),P)),x.expression.evaluate(new Ta(Math.floor(P.zoom+1),P)),P)}},Js.prototype._calculate=function(x,P,U,te){return te.zoom>te.zoomHistory.lastIntegerZoom?{from:x,to:P}:{from:U,to:P}},Js.prototype.interpolate=function(x){return x};var Ji=function(x){this.specification=x};Ji.prototype.possiblyEvaluate=function(x,P,U,te){return!!x.expression.evaluate(P,null,{},U,te)},Ji.prototype.interpolate=function(){return!1};var ai=function(x){for(var P in this.properties=x,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],x){var U=x[P];U.specification.overridable&&this.overridableProperties.push(P);var te=this.defaultPropertyValues[P]=new za(U,void 0),ce=this.defaultTransitionablePropertyValues[P]=new Ui(U);this.defaultTransitioningPropertyValues[P]=ce.untransitioned(),this.defaultPossiblyEvaluatedValues[P]=te.possiblyEvaluate({})}};En("DataDrivenProperty",jn),En("DataConstantProperty",Rn),En("CrossFadedDataDrivenProperty",Va),En("CrossFadedProperty",Js),En("ColorRampProperty",Ji);var Vi=function(x){function P(U,te){if(x.call(this),this.id=U.id,this.type=U.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},U.type!=="custom"&&(this.metadata=(U=U).metadata,this.minzoom=U.minzoom,this.maxzoom=U.maxzoom,U.type!=="background"&&(this.source=U.source,this.sourceLayer=U["source-layer"],this.filter=U.filter),te.layout&&(this._unevaluatedLayout=new Oo(te.layout)),te.paint)){for(var ce in this._transitionablePaint=new ri(te.paint),U.paint)this.setPaintProperty(ce,U.paint[ce],{validate:!1});for(var pe in U.layout)this.setLayoutProperty(pe,U.layout[pe],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new ps(te.paint)}}return x&&(P.__proto__=x),(P.prototype=Object.create(x&&x.prototype)).constructor=P,P.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},P.prototype.getLayoutProperty=function(U){return U==="visibility"?this.visibility:this._unevaluatedLayout.getValue(U)},P.prototype.setLayoutProperty=function(U,te,ce){ce===void 0&&(ce={}),te!=null&&this._validate(Bc,"layers."+this.id+".layout."+U,U,te,ce)||(U!=="visibility"?this._unevaluatedLayout.setValue(U,te):this.visibility=te)},P.prototype.getPaintProperty=function(U){return A(U,"-transition")?this._transitionablePaint.getTransition(U.slice(0,-11)):this._transitionablePaint.getValue(U)},P.prototype.setPaintProperty=function(U,te,ce){if(ce===void 0&&(ce={}),te!=null&&this._validate(yl,"layers."+this.id+".paint."+U,U,te,ce))return!1;if(A(U,"-transition"))return this._transitionablePaint.setTransition(U.slice(0,-11),te||void 0),!1;var pe=this._transitionablePaint._values[U],Te=pe.property.specification["property-type"]==="cross-faded-data-driven",je=pe.value.isDataDriven(),nt=pe.value;this._transitionablePaint.setValue(U,te),this._handleSpecialPaintPropertyUpdate(U);var dt=this._transitionablePaint._values[U].value;return dt.isDataDriven()||je||Te||this._handleOverridablePaintPropertyUpdate(U,nt,dt)},P.prototype._handleSpecialPaintPropertyUpdate=function(U){},P.prototype._handleOverridablePaintPropertyUpdate=function(U,te,ce){return!1},P.prototype.isHidden=function(U){return!!(this.minzoom&&U<this.minzoom)||!!(this.maxzoom&&U>=this.maxzoom)||this.visibility==="none"},P.prototype.updateTransitions=function(U){this._transitioningPaint=this._transitionablePaint.transitioned(U,this._transitioningPaint)},P.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},P.prototype.recalculate=function(U,te){U.getCrossfadeParameters&&(this._crossfadeParameters=U.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(U,void 0,te)),this.paint=this._transitioningPaint.possiblyEvaluate(U,void 0,te)},P.prototype.serialize=function(){var U={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(U.layout=U.layout||{},U.layout.visibility=this.visibility),M(U,function(te,ce){return!(te===void 0||ce==="layout"&&!Object.keys(te).length||ce==="paint"&&!Object.keys(te).length)})},P.prototype._validate=function(U,te,ce,pe,Te){return Te===void 0&&(Te={}),(!Te||Te.validate!==!1)&&Vl(this,U.call(Po,{key:te,layerType:this.type,objectKey:ce,value:pe,styleSpec:Ee,style:{glyphs:!0,sprite:!0}}))},P.prototype.is3D=function(){return!1},P.prototype.isTileClipped=function(){return!1},P.prototype.hasOffscreenPass=function(){return!1},P.prototype.resize=function(){},P.prototype.isStateDependent=function(){for(var U in this.paint._values){var te=this.paint.get(U);if(te instanceof ni&&$o(te.property.specification)&&(te.value.kind==="source"||te.value.kind==="composite")&&te.value.isStateDependent)return!0}return!1},P}(xe),Nc={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},Ks=function(x,P){this._structArray=x,this._pos1=P*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},da=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function Ma(x,P){P===void 0&&(P=1);var U=0,te=0;return{members:x.map(function(ce){var pe=Nc[ce.type].BYTES_PER_ELEMENT,Te=U=jc(U,Math.max(P,pe)),je=ce.components||1;return te=Math.max(te,pe),U+=pe*je,{name:ce.name,type:ce.type,components:je,offset:Te}}),size:jc(U,Math.max(te,P)),alignment:P}}function jc(x,P){return Math.ceil(x/P)*P}da.serialize=function(x,P){return x._trim(),P&&(x.isTransferred=!0,P.push(x.arrayBuffer)),{length:x.length,arrayBuffer:x.arrayBuffer}},da.deserialize=function(x){var P=Object.create(this.prototype);return P.arrayBuffer=x.arrayBuffer,P.length=x.length,P.capacity=x.arrayBuffer.byteLength/P.bytesPerElement,P._refreshViews(),P},da.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},da.prototype.clear=function(){this.length=0},da.prototype.resize=function(x){this.reserve(x),this.length=x},da.prototype.reserve=function(x){if(x>this.capacity){this.capacity=Math.max(x,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var P=this.uint8;this._refreshViews(),P&&this.uint8.set(P)}},da.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var Qs=function(x){function P(){x.apply(this,arguments)}return x&&(P.__proto__=x),(P.prototype=Object.create(x&&x.prototype)).constructor=P,P.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},P.prototype.emplaceBack=function(U,te){var ce=this.length;return this.resize(ce+1),this.emplace(ce,U,te)},P.prototype.emplace=function(U,te,ce){var pe=2*U;return this.int16[pe+0]=te,this.int16[pe+1]=ce,U},P}(da);Qs.prototype.bytesPerElement=4,En("StructArrayLayout2i4",Qs);var is=function(x){function P(){x.apply(this,arguments)}return x&&(P.__proto__=x),(P.prototype=Object.create(x&&x.prototype)).constructor=P,P.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},P.prototype.emplaceBack=function(U,te,ce,pe){var Te=this.length;return this.resize(Te+1),this.emplace(Te,U,te,ce,pe)},P.prototype.emplace=function(U,te,ce,pe,Te){var je=4*U;return this.int16[je+0]=te,this.int16[je+1]=ce,this.int16[je+2]=pe,this.int16[je+3]=Te,U},P}(da);is.prototype.bytesPerElement=8,En("StructArrayLayout4i8",is);var dc=function(x){function P(){x.apply(this,arguments)}return x&&(P.__proto__=x),(P.prototype=Object.create(x&&x.prototype)).constructor=P,P.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},P.prototype.emplaceBack=function(U,te,ce,pe,Te,je){var nt=this.length;return this.resize(nt+1),this.emplace(nt,U,te,ce,pe,Te,je)},P.prototype.emplace=function(U,te,ce,pe,Te,je,nt){var dt=6*U;return this.int16[dt+0]=te,this.int16[dt+1]=ce,this.int16[dt+2]=pe,this.int16[dt+3]=Te,this.int16[dt+4]=je,this.int16[dt+5]=nt,U},P}(da);dc.prototype.bytesPerElement=12,En("StructArrayLayout2i4i12",dc);var po=function(x){function P(){x.apply(this,arguments)}return x&&(P.__proto__=x),(P.prototype=Object.create(x&&x.prototype)).constructor=P,P.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},P.prototype.emplaceBack=function(U,te,ce,pe,Te,je){var nt=this.length;return this.resize(nt+1),this.emplace(nt,U,te,ce,pe,Te,je)},P.prototype.emplace=function(U,te,ce,pe,Te,je,nt){var dt=4*U,yt=8*U;return this.int16[dt+0]=te,this.int16[dt+1]=ce,this.uint8[yt+4]=pe,this.uint8[yt+5]=Te,this.uint8[yt+6]=je,this.uint8[yt+7]=nt,U},P}(da);po.prototype.bytesPerElement=8,En("StructArrayLayout2i4ub8",po);var qa=function(x){function P(){x.apply(this,arguments)}return x&&(P.__proto__=x),(P.prototype=Object.create(x&&x.prototype)).constructor=P,P.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},P.prototype.emplaceBack=function(U,te,ce,pe,Te,je,nt,dt,yt,kt){var Lt=this.length;return this.resize(Lt+1),this.emplace(Lt,U,te,ce,pe,Te,je,nt,dt,yt,kt)},P.prototype.emplace=function(U,te,ce,pe,Te,je,nt,dt,yt,kt,Lt){var Rt=9*U,rr=18*U;return this.uint16[Rt+0]=te,this.uint16[Rt+1]=ce,this.uint16[Rt+2]=pe,this.uint16[Rt+3]=Te,this.uint16[Rt+4]=je,this.uint16[Rt+5]=nt,this.uint16[Rt+6]=dt,this.uint16[Rt+7]=yt,this.uint8[rr+16]=kt,this.uint8[rr+17]=Lt,U},P}(da);qa.prototype.bytesPerElement=18,En("StructArrayLayout8ui2ub18",qa);var $s=function(x){function P(){x.apply(this,arguments)}return x&&(P.__proto__=x),(P.prototype=Object.create(x&&x.prototype)).constructor=P,P.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},P.prototype.emplaceBack=function(U,te,ce,pe,Te,je,nt,dt,yt,kt,Lt,Rt){var rr=this.length;return this.resize(rr+1),this.emplace(rr,U,te,ce,pe,Te,je,nt,dt,yt,kt,Lt,Rt)},P.prototype.emplace=function(U,te,ce,pe,Te,je,nt,dt,yt,kt,Lt,Rt,rr){var ar=12*U;return this.int16[ar+0]=te,this.int16[ar+1]=ce,this.int16[ar+2]=pe,this.int16[ar+3]=Te,this.uint16[ar+4]=je,this.uint16[ar+5]=nt,this.uint16[ar+6]=dt,this.uint16[ar+7]=yt,this.int16[ar+8]=kt,this.int16[ar+9]=Lt,this.int16[ar+10]=Rt,this.int16[ar+11]=rr,U},P}(da);$s.prototype.bytesPerElement=24,En("StructArrayLayout4i4ui4i24",$s);var ds=function(x){function P(){x.apply(this,arguments)}return x&&(P.__proto__=x),(P.prototype=Object.create(x&&x.prototype)).constructor=P,P.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},P.prototype.emplaceBack=function(U,te,ce){var pe=this.length;return this.resize(pe+1),this.emplace(pe,U,te,ce)},P.prototype.emplace=function(U,te,ce,pe){var Te=3*U;return this.float32[Te+0]=te,this.float32[Te+1]=ce,this.float32[Te+2]=pe,U},P}(da);ds.prototype.bytesPerElement=12,En("StructArrayLayout3f12",ds);var gs=function(x){function P(){x.apply(this,arguments)}return x&&(P.__proto__=x),(P.prototype=Object.create(x&&x.prototype)).constructor=P,P.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},P.prototype.emplaceBack=function(U){var te=this.length;return this.resize(te+1),this.emplace(te,U)},P.prototype.emplace=function(U,te){return this.uint32[1*U+0]=te,U},P}(da);gs.prototype.bytesPerElement=4,En("StructArrayLayout1ul4",gs);var zo=function(x){function P(){x.apply(this,arguments)}return x&&(P.__proto__=x),(P.prototype=Object.create(x&&x.prototype)).constructor=P,P.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},P.prototype.emplaceBack=function(U,te,ce,pe,Te,je,nt,dt,yt){var kt=this.length;return this.resize(kt+1),this.emplace(kt,U,te,ce,pe,Te,je,nt,dt,yt)},P.prototype.emplace=function(U,te,ce,pe,Te,je,nt,dt,yt,kt){var Lt=10*U,Rt=5*U;return this.int16[Lt+0]=te,this.int16[Lt+1]=ce,this.int16[Lt+2]=pe,this.int16[Lt+3]=Te,this.int16[Lt+4]=je,this.int16[Lt+5]=nt,this.uint32[Rt+3]=dt,this.uint16[Lt+8]=yt,this.uint16[Lt+9]=kt,U},P}(da);zo.prototype.bytesPerElement=20,En("StructArrayLayout6i1ul2ui20",zo);var Is=function(x){function P(){x.apply(this,arguments)}return x&&(P.__proto__=x),(P.prototype=Object.create(x&&x.prototype)).constructor=P,P.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},P.prototype.emplaceBack=function(U,te,ce,pe,Te,je){var nt=this.length;return this.resize(nt+1),this.emplace(nt,U,te,ce,pe,Te,je)},P.prototype.emplace=function(U,te,ce,pe,Te,je,nt){var dt=6*U;return this.int16[dt+0]=te,this.int16[dt+1]=ce,this.int16[dt+2]=pe,this.int16[dt+3]=Te,this.int16[dt+4]=je,this.int16[dt+5]=nt,U},P}(da);Is.prototype.bytesPerElement=12,En("StructArrayLayout2i2i2i12",Is);var bl=function(x){function P(){x.apply(this,arguments)}return x&&(P.__proto__=x),(P.prototype=Object.create(x&&x.prototype)).constructor=P,P.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},P.prototype.emplaceBack=function(U,te,ce,pe,Te){var je=this.length;return this.resize(je+1),this.emplace(je,U,te,ce,pe,Te)},P.prototype.emplace=function(U,te,ce,pe,Te,je){var nt=4*U,dt=8*U;return this.float32[nt+0]=te,this.float32[nt+1]=ce,this.float32[nt+2]=pe,this.int16[dt+6]=Te,this.int16[dt+7]=je,U},P}(da);bl.prototype.bytesPerElement=16,En("StructArrayLayout2f1f2i16",bl);var _l=function(x){function P(){x.apply(this,arguments)}return x&&(P.__proto__=x),(P.prototype=Object.create(x&&x.prototype)).constructor=P,P.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},P.prototype.emplaceBack=function(U,te,ce,pe){var Te=this.length;return this.resize(Te+1),this.emplace(Te,U,te,ce,pe)},P.prototype.emplace=function(U,te,ce,pe,Te){var je=12*U,nt=3*U;return this.uint8[je+0]=te,this.uint8[je+1]=ce,this.float32[nt+1]=pe,this.float32[nt+2]=Te,U},P}(da);_l.prototype.bytesPerElement=12,En("StructArrayLayout2ub2f12",_l);var qi=function(x){function P(){x.apply(this,arguments)}return x&&(P.__proto__=x),(P.prototype=Object.create(x&&x.prototype)).constructor=P,P.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},P.prototype.emplaceBack=function(U,te,ce){var pe=this.length;return this.resize(pe+1),this.emplace(pe,U,te,ce)},P.prototype.emplace=function(U,te,ce,pe){var Te=3*U;return this.uint16[Te+0]=te,this.uint16[Te+1]=ce,this.uint16[Te+2]=pe,U},P}(da);qi.prototype.bytesPerElement=6,En("StructArrayLayout3ui6",qi);var gc=function(x){function P(){x.apply(this,arguments)}return x&&(P.__proto__=x),(P.prototype=Object.create(x&&x.prototype)).constructor=P,P.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},P.prototype.emplaceBack=function(U,te,ce,pe,Te,je,nt,dt,yt,kt,Lt,Rt,rr,ar,_r,dr,Er){var zr=this.length;return this.resize(zr+1),this.emplace(zr,U,te,ce,pe,Te,je,nt,dt,yt,kt,Lt,Rt,rr,ar,_r,dr,Er)},P.prototype.emplace=function(U,te,ce,pe,Te,je,nt,dt,yt,kt,Lt,Rt,rr,ar,_r,dr,Er,zr){var Ur=24*U,Vr=12*U,en=48*U;return this.int16[Ur+0]=te,this.int16[Ur+1]=ce,this.uint16[Ur+2]=pe,this.uint16[Ur+3]=Te,this.uint32[Vr+2]=je,this.uint32[Vr+3]=nt,this.uint32[Vr+4]=dt,this.uint16[Ur+10]=yt,this.uint16[Ur+11]=kt,this.uint16[Ur+12]=Lt,this.float32[Vr+7]=Rt,this.float32[Vr+8]=rr,this.uint8[en+36]=ar,this.uint8[en+37]=_r,this.uint8[en+38]=dr,this.uint32[Vr+10]=Er,this.int16[Ur+22]=zr,U},P}(da);gc.prototype.bytesPerElement=48,En("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",gc);var mc=function(x){function P(){x.apply(this,arguments)}return x&&(P.__proto__=x),(P.prototype=Object.create(x&&x.prototype)).constructor=P,P.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},P.prototype.emplaceBack=function(U,te,ce,pe,Te,je,nt,dt,yt,kt,Lt,Rt,rr,ar,_r,dr,Er,zr,Ur,Vr,en,hn,_n,On,kn,Fn,wn,ia){var Yn=this.length;return this.resize(Yn+1),this.emplace(Yn,U,te,ce,pe,Te,je,nt,dt,yt,kt,Lt,Rt,rr,ar,_r,dr,Er,zr,Ur,Vr,en,hn,_n,On,kn,Fn,wn,ia)},P.prototype.emplace=function(U,te,ce,pe,Te,je,nt,dt,yt,kt,Lt,Rt,rr,ar,_r,dr,Er,zr,Ur,Vr,en,hn,_n,On,kn,Fn,wn,ia,Yn){var Cn=34*U,ca=17*U;return this.int16[Cn+0]=te,this.int16[Cn+1]=ce,this.int16[Cn+2]=pe,this.int16[Cn+3]=Te,this.int16[Cn+4]=je,this.int16[Cn+5]=nt,this.int16[Cn+6]=dt,this.int16[Cn+7]=yt,this.uint16[Cn+8]=kt,this.uint16[Cn+9]=Lt,this.uint16[Cn+10]=Rt,this.uint16[Cn+11]=rr,this.uint16[Cn+12]=ar,this.uint16[Cn+13]=_r,this.uint16[Cn+14]=dr,this.uint16[Cn+15]=Er,this.uint16[Cn+16]=zr,this.uint16[Cn+17]=Ur,this.uint16[Cn+18]=Vr,this.uint16[Cn+19]=en,this.uint16[Cn+20]=hn,this.uint16[Cn+21]=_n,this.uint16[Cn+22]=On,this.uint32[ca+12]=kn,this.float32[ca+13]=Fn,this.float32[ca+14]=wn,this.float32[ca+15]=ia,this.float32[ca+16]=Yn,U},P}(da);mc.prototype.bytesPerElement=68,En("StructArrayLayout8i15ui1ul4f68",mc);var io=function(x){function P(){x.apply(this,arguments)}return x&&(P.__proto__=x),(P.prototype=Object.create(x&&x.prototype)).constructor=P,P.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},P.prototype.emplaceBack=function(U){var te=this.length;return this.resize(te+1),this.emplace(te,U)},P.prototype.emplace=function(U,te){return this.float32[1*U+0]=te,U},P}(da);io.prototype.bytesPerElement=4,En("StructArrayLayout1f4",io);var Wl=function(x){function P(){x.apply(this,arguments)}return x&&(P.__proto__=x),(P.prototype=Object.create(x&&x.prototype)).constructor=P,P.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},P.prototype.emplaceBack=function(U,te,ce){var pe=this.length;return this.resize(pe+1),this.emplace(pe,U,te,ce)},P.prototype.emplace=function(U,te,ce,pe){var Te=3*U;return this.int16[Te+0]=te,this.int16[Te+1]=ce,this.int16[Te+2]=pe,U},P}(da);Wl.prototype.bytesPerElement=6,En("StructArrayLayout3i6",Wl);var os=function(x){function P(){x.apply(this,arguments)}return x&&(P.__proto__=x),(P.prototype=Object.create(x&&x.prototype)).constructor=P,P.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},P.prototype.emplaceBack=function(U,te,ce){var pe=this.length;return this.resize(pe+1),this.emplace(pe,U,te,ce)},P.prototype.emplace=function(U,te,ce,pe){var Te=4*U;return this.uint32[2*U+0]=te,this.uint16[Te+2]=ce,this.uint16[Te+3]=pe,U},P}(da);os.prototype.bytesPerElement=8,En("StructArrayLayout1ul2ui8",os);var Hi=function(x){function P(){x.apply(this,arguments)}return x&&(P.__proto__=x),(P.prototype=Object.create(x&&x.prototype)).constructor=P,P.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},P.prototype.emplaceBack=function(U,te){var ce=this.length;return this.resize(ce+1),this.emplace(ce,U,te)},P.prototype.emplace=function(U,te,ce){var pe=2*U;return this.uint16[pe+0]=te,this.uint16[pe+1]=ce,U},P}(da);Hi.prototype.bytesPerElement=4,En("StructArrayLayout2ui4",Hi);var Mo=function(x){function P(){x.apply(this,arguments)}return x&&(P.__proto__=x),(P.prototype=Object.create(x&&x.prototype)).constructor=P,P.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},P.prototype.emplaceBack=function(U){var te=this.length;return this.resize(te+1),this.emplace(te,U)},P.prototype.emplace=function(U,te){return this.uint16[1*U+0]=te,U},P}(da);Mo.prototype.bytesPerElement=2,En("StructArrayLayout1ui2",Mo);var wl=function(x){function P(){x.apply(this,arguments)}return x&&(P.__proto__=x),(P.prototype=Object.create(x&&x.prototype)).constructor=P,P.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},P.prototype.emplaceBack=function(U,te){var ce=this.length;return this.resize(ce+1),this.emplace(ce,U,te)},P.prototype.emplace=function(U,te,ce){var pe=2*U;return this.float32[pe+0]=te,this.float32[pe+1]=ce,U},P}(da);wl.prototype.bytesPerElement=8,En("StructArrayLayout2f8",wl);var el=function(x){function P(){x.apply(this,arguments)}return x&&(P.__proto__=x),(P.prototype=Object.create(x&&x.prototype)).constructor=P,P.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},P.prototype.emplaceBack=function(U,te,ce,pe){var Te=this.length;return this.resize(Te+1),this.emplace(Te,U,te,ce,pe)},P.prototype.emplace=function(U,te,ce,pe,Te){var je=4*U;return this.float32[je+0]=te,this.float32[je+1]=ce,this.float32[je+2]=pe,this.float32[je+3]=Te,U},P}(da);el.prototype.bytesPerElement=16,En("StructArrayLayout4f16",el);var Y=function(x){function P(){x.apply(this,arguments)}x&&(P.__proto__=x),(P.prototype=Object.create(x&&x.prototype)).constructor=P;var U={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return U.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},U.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},U.x1.get=function(){return this._structArray.int16[this._pos2+2]},U.y1.get=function(){return this._structArray.int16[this._pos2+3]},U.x2.get=function(){return this._structArray.int16[this._pos2+4]},U.y2.get=function(){return this._structArray.int16[this._pos2+5]},U.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},U.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},U.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},U.anchorPoint.get=function(){return new u(this.anchorPointX,this.anchorPointY)},Object.defineProperties(P.prototype,U),P}(Ks);Y.prototype.size=20;var K=function(x){function P(){x.apply(this,arguments)}return x&&(P.__proto__=x),(P.prototype=Object.create(x&&x.prototype)).constructor=P,P.prototype.get=function(U){return new Y(this,U)},P}(zo);En("CollisionBoxArray",K);var X=function(x){function P(){x.apply(this,arguments)}x&&(P.__proto__=x),(P.prototype=Object.create(x&&x.prototype)).constructor=P;var U={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return U.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},U.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},U.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},U.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},U.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},U.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},U.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},U.segment.get=function(){return this._structArray.uint16[this._pos2+10]},U.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},U.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},U.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},U.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},U.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},U.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},U.placedOrientation.set=function(te){this._structArray.uint8[this._pos1+37]=te},U.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},U.hidden.set=function(te){this._structArray.uint8[this._pos1+38]=te},U.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},U.crossTileID.set=function(te){this._structArray.uint32[this._pos4+10]=te},U.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(P.prototype,U),P}(Ks);X.prototype.size=48;var re=function(x){function P(){x.apply(this,arguments)}return x&&(P.__proto__=x),(P.prototype=Object.create(x&&x.prototype)).constructor=P,P.prototype.get=function(U){return new X(this,U)},P}(gc);En("PlacedSymbolArray",re);var me=function(x){function P(){x.apply(this,arguments)}x&&(P.__proto__=x),(P.prototype=Object.create(x&&x.prototype)).constructor=P;var U={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return U.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},U.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},U.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},U.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},U.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},U.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},U.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},U.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},U.key.get=function(){return this._structArray.uint16[this._pos2+8]},U.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},U.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},U.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},U.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},U.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},U.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},U.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},U.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},U.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},U.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},U.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},U.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},U.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},U.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},U.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},U.crossTileID.set=function(te){this._structArray.uint32[this._pos4+12]=te},U.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},U.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},U.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},U.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(P.prototype,U),P}(Ks);me.prototype.size=68;var Oe=function(x){function P(){x.apply(this,arguments)}return x&&(P.__proto__=x),(P.prototype=Object.create(x&&x.prototype)).constructor=P,P.prototype.get=function(U){return new me(this,U)},P}(mc);En("SymbolInstanceArray",Oe);var Be=function(x){function P(){x.apply(this,arguments)}return x&&(P.__proto__=x),(P.prototype=Object.create(x&&x.prototype)).constructor=P,P.prototype.getoffsetX=function(U){return this.float32[1*U+0]},P}(io);En("GlyphOffsetArray",Be);var tt=function(x){function P(){x.apply(this,arguments)}return x&&(P.__proto__=x),(P.prototype=Object.create(x&&x.prototype)).constructor=P,P.prototype.getx=function(U){return this.int16[3*U+0]},P.prototype.gety=function(U){return this.int16[3*U+1]},P.prototype.gettileUnitDistanceFromAnchor=function(U){return this.int16[3*U+2]},P}(Wl);En("SymbolLineVertexArray",tt);var ft=function(x){function P(){x.apply(this,arguments)}x&&(P.__proto__=x),(P.prototype=Object.create(x&&x.prototype)).constructor=P;var U={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return U.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},U.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},U.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(P.prototype,U),P}(Ks);ft.prototype.size=8;var St=function(x){function P(){x.apply(this,arguments)}return x&&(P.__proto__=x),(P.prototype=Object.create(x&&x.prototype)).constructor=P,P.prototype.get=function(U){return new ft(this,U)},P}(os);En("FeatureIndexArray",St);var Ft=Ma([{name:"a_pos",components:2,type:"Int16"}],4).members,Gt=function(x){x===void 0&&(x=[]),this.segments=x};function $t(x,P){return 256*(x=f(Math.floor(x),0,255))+f(Math.floor(P),0,255)}Gt.prototype.prepareSegment=function(x,P,U,te){var ce=this.segments[this.segments.length-1];return x>Gt.MAX_VERTEX_ARRAY_LENGTH&&S("Max vertices per segment is "+Gt.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+x),(!ce||ce.vertexLength+x>Gt.MAX_VERTEX_ARRAY_LENGTH||ce.sortKey!==te)&&(ce={vertexOffset:P.length,primitiveOffset:U.length,vertexLength:0,primitiveLength:0},te!==void 0&&(ce.sortKey=te),this.segments.push(ce)),ce},Gt.prototype.get=function(){return this.segments},Gt.prototype.destroy=function(){for(var x=0,P=this.segments;x<P.length;x+=1){var U=P[x];for(var te in U.vaos)U.vaos[te].destroy()}},Gt.simpleSegment=function(x,P,U,te){return new Gt([{vertexOffset:x,primitiveOffset:P,vertexLength:U,primitiveLength:te,vaos:{},sortKey:0}])},Gt.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,En("SegmentVector",Gt);var sr=Ma([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint8"},{name:"a_pixel_ratio_to",components:1,type:"Uint8"}]),lr=o(function(x){x.exports=function(P,U){var te,ce,pe,Te,je,nt,dt,yt;for(ce=P.length-(te=3&P.length),pe=U,je=3432918353,nt=461845907,yt=0;yt<ce;)dt=255&P.charCodeAt(yt)|(255&P.charCodeAt(++yt))<<8|(255&P.charCodeAt(++yt))<<16|(255&P.charCodeAt(++yt))<<24,++yt,pe=27492+(65535&(Te=5*(65535&(pe=(pe^=dt=(65535&(dt=(dt=(65535&dt)*je+(((dt>>>16)*je&65535)<<16)&4294967295)<<15|dt>>>17))*nt+(((dt>>>16)*nt&65535)<<16)&4294967295)<<13|pe>>>19))+((5*(pe>>>16)&65535)<<16)&4294967295))+((58964+(Te>>>16)&65535)<<16);switch(dt=0,te){case 3:dt^=(255&P.charCodeAt(yt+2))<<16;case 2:dt^=(255&P.charCodeAt(yt+1))<<8;case 1:pe^=dt=(65535&(dt=(dt=(65535&(dt^=255&P.charCodeAt(yt)))*je+(((dt>>>16)*je&65535)<<16)&4294967295)<<15|dt>>>17))*nt+(((dt>>>16)*nt&65535)<<16)&4294967295}return pe^=P.length,pe=2246822507*(65535&(pe^=pe>>>16))+((2246822507*(pe>>>16)&65535)<<16)&4294967295,pe=3266489909*(65535&(pe^=pe>>>13))+((3266489909*(pe>>>16)&65535)<<16)&4294967295,(pe^=pe>>>16)>>>0}}),vr=o(function(x){x.exports=function(P,U){for(var te,ce=P.length,pe=U^ce,Te=0;ce>=4;)te=1540483477*(65535&(te=255&P.charCodeAt(Te)|(255&P.charCodeAt(++Te))<<8|(255&P.charCodeAt(++Te))<<16|(255&P.charCodeAt(++Te))<<24))+((1540483477*(te>>>16)&65535)<<16),pe=1540483477*(65535&pe)+((1540483477*(pe>>>16)&65535)<<16)^(te=1540483477*(65535&(te^=te>>>24))+((1540483477*(te>>>16)&65535)<<16)),ce-=4,++Te;switch(ce){case 3:pe^=(255&P.charCodeAt(Te+2))<<16;case 2:pe^=(255&P.charCodeAt(Te+1))<<8;case 1:pe=1540483477*(65535&(pe^=255&P.charCodeAt(Te)))+((1540483477*(pe>>>16)&65535)<<16)}return pe=1540483477*(65535&(pe^=pe>>>13))+((1540483477*(pe>>>16)&65535)<<16),(pe^=pe>>>15)>>>0}}),ir=lr,gr=vr;ir.murmur3=lr,ir.murmur2=gr;var Ar=function(){this.ids=[],this.positions=[],this.indexed=!1};Ar.prototype.add=function(x,P,U,te){this.ids.push(Gr(x)),this.positions.push(P,U,te)},Ar.prototype.getPositions=function(x){for(var P=Gr(x),U=0,te=this.ids.length-1;U<te;){var ce=U+te>>1;this.ids[ce]>=P?te=ce:U=ce+1}for(var pe=[];this.ids[U]===P;)pe.push({index:this.positions[3*U],start:this.positions[3*U+1],end:this.positions[3*U+2]}),U++;return pe},Ar.serialize=function(x,P){var U=new Float64Array(x.ids),te=new Uint32Array(x.positions);return function ce(pe,Te,je,nt){for(;je<nt;){for(var dt=pe[je+nt>>1],yt=je-1,kt=nt+1;;){do yt++;while(pe[yt]<dt);do kt--;while(pe[kt]>dt);if(yt>=kt)break;Fr(pe,yt,kt),Fr(Te,3*yt,3*kt),Fr(Te,3*yt+1,3*kt+1),Fr(Te,3*yt+2,3*kt+2)}kt-je<nt-kt?(ce(pe,Te,je,kt),je=kt+1):(ce(pe,Te,kt+1,nt),nt=kt)}}(U,te,0,U.length-1),P&&P.push(U.buffer,te.buffer),{ids:U,positions:te}},Ar.deserialize=function(x){var P=new Ar;return P.ids=x.ids,P.positions=x.positions,P.indexed=!0,P};var Pr=Math.pow(2,53)-1;function Gr(x){var P=+x;return!isNaN(P)&&P<=Pr?P:ir(String(x))}function Fr(x,P,U){var te=x[P];x[P]=x[U],x[U]=te}En("FeaturePositionMap",Ar);var Yr=function(x,P){this.gl=x.gl,this.location=P},an=function(x){function P(U,te){x.call(this,U,te),this.current=0}return x&&(P.__proto__=x),(P.prototype=Object.create(x&&x.prototype)).constructor=P,P.prototype.set=function(U){this.current!==U&&(this.current=U,this.gl.uniform1i(this.location,U))},P}(Yr),mn=function(x){function P(U,te){x.call(this,U,te),this.current=0}return x&&(P.__proto__=x),(P.prototype=Object.create(x&&x.prototype)).constructor=P,P.prototype.set=function(U){this.current!==U&&(this.current=U,this.gl.uniform1f(this.location,U))},P}(Yr),pn=function(x){function P(U,te){x.call(this,U,te),this.current=[0,0]}return x&&(P.__proto__=x),(P.prototype=Object.create(x&&x.prototype)).constructor=P,P.prototype.set=function(U){U[0]===this.current[0]&&U[1]===this.current[1]||(this.current=U,this.gl.uniform2f(this.location,U[0],U[1]))},P}(Yr),xn=function(x){function P(U,te){x.call(this,U,te),this.current=[0,0,0]}return x&&(P.__proto__=x),(P.prototype=Object.create(x&&x.prototype)).constructor=P,P.prototype.set=function(U){U[0]===this.current[0]&&U[1]===this.current[1]&&U[2]===this.current[2]||(this.current=U,this.gl.uniform3f(this.location,U[0],U[1],U[2]))},P}(Yr),Ln=function(x){function P(U,te){x.call(this,U,te),this.current=[0,0,0,0]}return x&&(P.__proto__=x),(P.prototype=Object.create(x&&x.prototype)).constructor=P,P.prototype.set=function(U){U[0]===this.current[0]&&U[1]===this.current[1]&&U[2]===this.current[2]&&U[3]===this.current[3]||(this.current=U,this.gl.uniform4f(this.location,U[0],U[1],U[2],U[3]))},P}(Yr),Jn=function(x){function P(U,te){x.call(this,U,te),this.current=Qt.transparent}return x&&(P.__proto__=x),(P.prototype=Object.create(x&&x.prototype)).constructor=P,P.prototype.set=function(U){U.r===this.current.r&&U.g===this.current.g&&U.b===this.current.b&&U.a===this.current.a||(this.current=U,this.gl.uniform4f(this.location,U.r,U.g,U.b,U.a))},P}(Yr),Vn=new Float32Array(16),oa=function(x){function P(U,te){x.call(this,U,te),this.current=Vn}return x&&(P.__proto__=x),(P.prototype=Object.create(x&&x.prototype)).constructor=P,P.prototype.set=function(U){if(U[12]!==this.current[12]||U[0]!==this.current[0])return this.current=U,void this.gl.uniformMatrix4fv(this.location,!1,U);for(var te=1;te<16;te++)if(U[te]!==this.current[te]){this.current=U,this.gl.uniformMatrix4fv(this.location,!1,U);break}},P}(Yr);function Sn(x){return[$t(255*x.r,255*x.g),$t(255*x.b,255*x.a)]}var ra=function(x,P,U){this.value=x,this.uniformNames=P.map(function(te){return"u_"+te}),this.type=U};ra.prototype.setUniform=function(x,P,U){x.set(U.constantOr(this.value))},ra.prototype.getBinding=function(x,P,U){return this.type==="color"?new Jn(x,P):new mn(x,P)};var sa=function(x,P){this.uniformNames=P.map(function(U){return"u_"+U}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};sa.prototype.setConstantPatternPositions=function(x,P){this.pixelRatioFrom=P.pixelRatio,this.pixelRatioTo=x.pixelRatio,this.patternFrom=P.tlbr,this.patternTo=x.tlbr},sa.prototype.setUniform=function(x,P,U,te){var ce=te==="u_pattern_to"?this.patternTo:te==="u_pattern_from"?this.patternFrom:te==="u_pixel_ratio_to"?this.pixelRatioTo:te==="u_pixel_ratio_from"?this.pixelRatioFrom:null;ce&&x.set(ce)},sa.prototype.getBinding=function(x,P,U){return U.substr(0,9)==="u_pattern"?new Ln(x,P):new mn(x,P)};var Hn=function(x,P,U,te){this.expression=x,this.type=U,this.maxValue=0,this.paintVertexAttributes=P.map(function(ce){return{name:"a_"+ce,type:"Float32",components:U==="color"?2:1,offset:0}}),this.paintVertexArray=new te};Hn.prototype.populatePaintArray=function(x,P,U,te,ce){var pe=this.paintVertexArray.length,Te=this.expression.evaluate(new Ta(0),P,{},te,[],ce);this.paintVertexArray.resize(x),this._setPaintValue(pe,x,Te)},Hn.prototype.updatePaintArray=function(x,P,U,te){var ce=this.expression.evaluate({zoom:0},U,te);this._setPaintValue(x,P,ce)},Hn.prototype._setPaintValue=function(x,P,U){if(this.type==="color")for(var te=Sn(U),ce=x;ce<P;ce++)this.paintVertexArray.emplace(ce,te[0],te[1]);else{for(var pe=x;pe<P;pe++)this.paintVertexArray.emplace(pe,U);this.maxValue=Math.max(this.maxValue,Math.abs(U))}},Hn.prototype.upload=function(x){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=x.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Hn.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var Gn=function(x,P,U,te,ce,pe){this.expression=x,this.uniformNames=P.map(function(Te){return"u_"+Te+"_t"}),this.type=U,this.useIntegerZoom=te,this.zoom=ce,this.maxValue=0,this.paintVertexAttributes=P.map(function(Te){return{name:"a_"+Te,type:"Float32",components:U==="color"?4:2,offset:0}}),this.paintVertexArray=new pe};Gn.prototype.populatePaintArray=function(x,P,U,te,ce){var pe=this.expression.evaluate(new Ta(this.zoom),P,{},te,[],ce),Te=this.expression.evaluate(new Ta(this.zoom+1),P,{},te,[],ce),je=this.paintVertexArray.length;this.paintVertexArray.resize(x),this._setPaintValue(je,x,pe,Te)},Gn.prototype.updatePaintArray=function(x,P,U,te){var ce=this.expression.evaluate({zoom:this.zoom},U,te),pe=this.expression.evaluate({zoom:this.zoom+1},U,te);this._setPaintValue(x,P,ce,pe)},Gn.prototype._setPaintValue=function(x,P,U,te){if(this.type==="color")for(var ce=Sn(U),pe=Sn(te),Te=x;Te<P;Te++)this.paintVertexArray.emplace(Te,ce[0],ce[1],pe[0],pe[1]);else{for(var je=x;je<P;je++)this.paintVertexArray.emplace(je,U,te);this.maxValue=Math.max(this.maxValue,Math.abs(U),Math.abs(te))}},Gn.prototype.upload=function(x){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=x.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Gn.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Gn.prototype.setUniform=function(x,P){var U=this.useIntegerZoom?Math.floor(P.zoom):P.zoom,te=f(this.expression.interpolationFactor(U,this.zoom,this.zoom+1),0,1);x.set(te)},Gn.prototype.getBinding=function(x,P,U){return new mn(x,P)};var $n=function(x,P,U,te,ce,pe){this.expression=x,this.type=P,this.useIntegerZoom=U,this.zoom=te,this.layerId=pe,this.zoomInPaintVertexArray=new ce,this.zoomOutPaintVertexArray=new ce};$n.prototype.populatePaintArray=function(x,P,U){var te=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(x),this.zoomOutPaintVertexArray.resize(x),this._setPaintValues(te,x,P.patterns&&P.patterns[this.layerId],U)},$n.prototype.updatePaintArray=function(x,P,U,te,ce){this._setPaintValues(x,P,U.patterns&&U.patterns[this.layerId],ce)},$n.prototype._setPaintValues=function(x,P,U,te){if(te&&U){var ce=te[U.min],pe=te[U.mid],Te=te[U.max];if(ce&&pe&&Te)for(var je=x;je<P;je++)this.zoomInPaintVertexArray.emplace(je,pe.tl[0],pe.tl[1],pe.br[0],pe.br[1],ce.tl[0],ce.tl[1],ce.br[0],ce.br[1],pe.pixelRatio,ce.pixelRatio),this.zoomOutPaintVertexArray.emplace(je,pe.tl[0],pe.tl[1],pe.br[0],pe.br[1],Te.tl[0],Te.tl[1],Te.br[0],Te.br[1],pe.pixelRatio,Te.pixelRatio)}},$n.prototype.upload=function(x){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=x.createVertexBuffer(this.zoomInPaintVertexArray,sr.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=x.createVertexBuffer(this.zoomOutPaintVertexArray,sr.members,this.expression.isStateDependent))},$n.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var Zn=function(x,P,U,te){this.binders={},this.layoutAttributes=te,this._buffers=[];var ce=[];for(var pe in x.paint._values)if(U(pe)){var Te=x.paint.get(pe);if(Te instanceof ni&&$o(Te.property.specification)){var je=fi(pe,x.type),nt=Te.value,dt=Te.property.specification.type,yt=Te.property.useIntegerZoom,kt=Te.property.specification["property-type"],Lt=kt==="cross-faded"||kt==="cross-faded-data-driven";if(nt.kind==="constant")this.binders[pe]=Lt?new sa(nt.value,je):new ra(nt.value,je,dt),ce.push("/u_"+pe);else if(nt.kind==="source"||Lt){var Rt=Fa(pe,dt,"source");this.binders[pe]=Lt?new $n(nt,dt,yt,P,Rt,x.id):new Hn(nt,je,dt,Rt),ce.push("/a_"+pe)}else{var rr=Fa(pe,dt,"composite");this.binders[pe]=new Gn(nt,je,dt,yt,P,rr),ce.push("/z_"+pe)}}}this.cacheKey=ce.sort().join("")};Zn.prototype.getMaxValue=function(x){var P=this.binders[x];return P instanceof Hn||P instanceof Gn?P.maxValue:0},Zn.prototype.populatePaintArrays=function(x,P,U,te,ce){for(var pe in this.binders){var Te=this.binders[pe];(Te instanceof Hn||Te instanceof Gn||Te instanceof $n)&&Te.populatePaintArray(x,P,U,te,ce)}},Zn.prototype.setConstantPatternPositions=function(x,P){for(var U in this.binders){var te=this.binders[U];te instanceof sa&&te.setConstantPatternPositions(x,P)}},Zn.prototype.updatePaintArrays=function(x,P,U,te,ce){var pe=!1;for(var Te in x)for(var je=0,nt=P.getPositions(Te);je<nt.length;je+=1){var dt=nt[je],yt=U.feature(dt.index);for(var kt in this.binders){var Lt=this.binders[kt];if((Lt instanceof Hn||Lt instanceof Gn||Lt instanceof $n)&&Lt.expression.isStateDependent===!0){var Rt=te.paint.get(kt);Lt.expression=Rt.value,Lt.updatePaintArray(dt.start,dt.end,yt,x[Te],ce),pe=!0}}}return pe},Zn.prototype.defines=function(){var x=[];for(var P in this.binders){var U=this.binders[P];(U instanceof ra||U instanceof sa)&&x.push.apply(x,U.uniformNames.map(function(te){return"#define HAS_UNIFORM_"+te}))}return x},Zn.prototype.getPaintVertexBuffers=function(){return this._buffers},Zn.prototype.getUniforms=function(x,P){var U=[];for(var te in this.binders){var ce=this.binders[te];if(ce instanceof ra||ce instanceof sa||ce instanceof Gn)for(var pe=0,Te=ce.uniformNames;pe<Te.length;pe+=1){var je=Te[pe];if(P[je]){var nt=ce.getBinding(x,P[je],je);U.push({name:je,property:te,binding:nt})}}}return U},Zn.prototype.setUniforms=function(x,P,U,te){for(var ce=0,pe=P;ce<pe.length;ce+=1){var Te=pe[ce],je=Te.name,nt=Te.property;this.binders[nt].setUniform(Te.binding,te,U.get(nt),je)}},Zn.prototype.updatePaintBuffers=function(x){for(var P in this._buffers=[],this.binders){var U=this.binders[P];if(x&&U instanceof $n){var te=x.fromScale===2?U.zoomInPaintVertexBuffer:U.zoomOutPaintVertexBuffer;te&&this._buffers.push(te)}else(U instanceof Hn||U instanceof Gn)&&U.paintVertexBuffer&&this._buffers.push(U.paintVertexBuffer)}},Zn.prototype.upload=function(x){for(var P in this.binders){var U=this.binders[P];(U instanceof Hn||U instanceof Gn||U instanceof $n)&&U.upload(x)}this.updatePaintBuffers()},Zn.prototype.destroy=function(){for(var x in this.binders){var P=this.binders[x];(P instanceof Hn||P instanceof Gn||P instanceof $n)&&P.destroy()}};var qn=function(x,P,U,te){te===void 0&&(te=function(){return!0}),this.programConfigurations={};for(var ce=0,pe=P;ce<pe.length;ce+=1){var Te=pe[ce];this.programConfigurations[Te.id]=new Zn(Te,U,te,x)}this.needsUpload=!1,this._featureMap=new Ar,this._bufferOffset=0};function fi(x,P){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[x]||[x.replace(P+"-","").replace(/-/g,"_")]}function Fa(x,P,U){var te={color:{source:wl,composite:el},number:{source:io,composite:wl}},ce=function(pe){return{"line-pattern":{source:qa,composite:qa},"fill-pattern":{source:qa,composite:qa},"fill-extrusion-pattern":{source:qa,composite:qa}}[pe]}(x);return ce&&ce[U]||te[P][U]}qn.prototype.populatePaintArrays=function(x,P,U,te,ce,pe){for(var Te in this.programConfigurations)this.programConfigurations[Te].populatePaintArrays(x,P,te,ce,pe);P.id!==void 0&&this._featureMap.add(P.id,U,this._bufferOffset,x),this._bufferOffset=x,this.needsUpload=!0},qn.prototype.updatePaintArrays=function(x,P,U,te){for(var ce=0,pe=U;ce<pe.length;ce+=1){var Te=pe[ce];this.needsUpload=this.programConfigurations[Te.id].updatePaintArrays(x,this._featureMap,P,Te,te)||this.needsUpload}},qn.prototype.get=function(x){return this.programConfigurations[x]},qn.prototype.upload=function(x){if(this.needsUpload){for(var P in this.programConfigurations)this.programConfigurations[P].upload(x);this.needsUpload=!1}},qn.prototype.destroy=function(){for(var x in this.programConfigurations)this.programConfigurations[x].destroy()},En("ConstantBinder",ra),En("CrossFadedConstantBinder",sa),En("SourceExpressionBinder",Hn),En("CrossFadedCompositeBinder",$n),En("CompositeExpressionBinder",Gn),En("ProgramConfiguration",Zn,{omit:["_buffers"]}),En("ProgramConfigurationSet",qn);var Ha={min:-1*Math.pow(2,14),max:Math.pow(2,14)-1};function ba(x){for(var P=8192/x.extent,U=x.loadGeometry(),te=0;te<U.length;te++)for(var ce=U[te],pe=0;pe<ce.length;pe++){var Te=ce[pe];Te.x=Math.round(Te.x*P),Te.y=Math.round(Te.y*P),(Te.x<Ha.min||Te.x>Ha.max||Te.y<Ha.min||Te.y>Ha.max)&&(S("Geometry exceeds allowed extent, reduce your vector tile buffer size"),Te.x=f(Te.x,Ha.min,Ha.max),Te.y=f(Te.y,Ha.min,Ha.max))}return U}function Ga(x,P,U,te,ce){x.emplaceBack(2*P+(te+1)/2,2*U+(ce+1)/2)}var Ea=function(x){this.zoom=x.zoom,this.overscaling=x.overscaling,this.layers=x.layers,this.layerIds=this.layers.map(function(P){return P.id}),this.index=x.index,this.hasPattern=!1,this.layoutVertexArray=new Qs,this.indexArray=new qi,this.segments=new Gt,this.programConfigurations=new qn(Ft,x.layers,x.zoom),this.stateDependentLayerIds=this.layers.filter(function(P){return P.isStateDependent()}).map(function(P){return P.id})};function Ao(x,P){for(var U=0;U<x.length;U++)if(Ro(P,x[U]))return!0;for(var te=0;te<P.length;te++)if(Ro(x,P[te]))return!0;return!!mo(x,P)}function Os(x,P,U){return!!Ro(x,P)||!!tl(P,x,U)}function go(x,P){if(x.length===1)return zs(P,x[0]);for(var U=0;U<P.length;U++)for(var te=P[U],ce=0;ce<te.length;ce++)if(Ro(x,te[ce]))return!0;for(var pe=0;pe<x.length;pe++)if(zs(P,x[pe]))return!0;for(var Te=0;Te<P.length;Te++)if(mo(x,P[Te]))return!0;return!1}function Si(x,P,U){if(x.length>1){if(mo(x,P))return!0;for(var te=0;te<P.length;te++)if(tl(P[te],x,U))return!0}for(var ce=0;ce<x.length;ce++)if(tl(x[ce],P,U))return!0;return!1}function mo(x,P){if(x.length===0||P.length===0)return!1;for(var U=0;U<x.length-1;U++)for(var te=x[U],ce=x[U+1],pe=0;pe<P.length-1;pe++)if(Do(te,ce,P[pe],P[pe+1]))return!0;return!1}function Do(x,P,U,te){return C(x,U,te)!==C(P,U,te)&&C(x,P,U)!==C(x,P,te)}function tl(x,P,U){var te=U*U;if(P.length===1)return x.distSqr(P[0])<te;for(var ce=1;ce<P.length;ce++)if(ms(x,P[ce-1],P[ce])<te)return!0;return!1}function ms(x,P,U){var te=P.distSqr(U);if(te===0)return x.distSqr(P);var ce=((x.x-P.x)*(U.x-P.x)+(x.y-P.y)*(U.y-P.y))/te;return x.distSqr(ce<0?P:ce>1?U:U.sub(P)._mult(ce)._add(P))}function zs(x,P){for(var U,te,ce,pe=!1,Te=0;Te<x.length;Te++)for(var je=0,nt=(U=x[Te]).length-1;je<U.length;nt=je++)(te=U[je]).y>P.y!=(ce=U[nt]).y>P.y&&P.x<(ce.x-te.x)*(P.y-te.y)/(ce.y-te.y)+te.x&&(pe=!pe);return pe}function Ro(x,P){for(var U=!1,te=0,ce=x.length-1;te<x.length;ce=te++){var pe=x[te],Te=x[ce];pe.y>P.y!=Te.y>P.y&&P.x<(Te.x-pe.x)*(P.y-pe.y)/(Te.y-pe.y)+pe.x&&(U=!U)}return U}function Tl(x,P,U){var te=U[0],ce=U[2];if(x.x<te.x&&P.x<te.x||x.x>ce.x&&P.x>ce.x||x.y<te.y&&P.y<te.y||x.y>ce.y&&P.y>ce.y)return!1;var pe=C(x,P,U[0]);return pe!==C(x,P,U[1])||pe!==C(x,P,U[2])||pe!==C(x,P,U[3])}function Fo(x,P,U){var te=P.paint.get(x).value;return te.kind==="constant"?te.value:U.programConfigurations.get(P.id).getMaxValue(x)}function Bo(x){return Math.sqrt(x[0]*x[0]+x[1]*x[1])}function Xa(x,P,U,te,ce){if(!P[0]&&!P[1])return x;var pe=u.convert(P)._mult(ce);U==="viewport"&&pe._rotate(-te);for(var Te=[],je=0;je<x.length;je++)Te.push(x[je].sub(pe));return Te}Ea.prototype.populate=function(x,P,U){var te=this.layers[0],ce=[],pe=null;te.type==="circle"&&(pe=te.layout.get("circle-sort-key"));for(var Te=0,je=x;Te<je.length;Te+=1){var nt=je[Te],dt=nt.feature,yt=nt.id,kt=nt.index,Lt=nt.sourceLayerIndex,Rt=this.layers[0]._featureFilter.needGeometry,rr={type:dt.type,id:yt,properties:dt.properties,geometry:Rt?ba(dt):[]};if(this.layers[0]._featureFilter.filter(new Ta(this.zoom),rr,U)){Rt||(rr.geometry=ba(dt));var ar=pe?pe.evaluate(rr,{},U):void 0;ce.push({id:yt,properties:dt.properties,type:dt.type,sourceLayerIndex:Lt,index:kt,geometry:rr.geometry,patterns:{},sortKey:ar})}}pe&&ce.sort(function(hn,_n){return hn.sortKey-_n.sortKey});for(var _r=0,dr=ce;_r<dr.length;_r+=1){var Er=dr[_r],zr=Er.geometry,Ur=Er.index,Vr=Er.sourceLayerIndex,en=x[Ur].feature;this.addFeature(Er,zr,Ur,U),P.featureIndex.insert(en,zr,Ur,Vr,this.index)}},Ea.prototype.update=function(x,P,U){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(x,P,this.stateDependentLayers,U)},Ea.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Ea.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Ea.prototype.upload=function(x){this.uploaded||(this.layoutVertexBuffer=x.createVertexBuffer(this.layoutVertexArray,Ft),this.indexBuffer=x.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(x),this.uploaded=!0},Ea.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Ea.prototype.addFeature=function(x,P,U,te){for(var ce=0,pe=P;ce<pe.length;ce+=1)for(var Te=0,je=pe[ce];Te<je.length;Te+=1){var nt=je[Te],dt=nt.x,yt=nt.y;if(!(dt<0||dt>=8192||yt<0||yt>=8192)){var kt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,x.sortKey),Lt=kt.vertexLength;Ga(this.layoutVertexArray,dt,yt,-1,-1),Ga(this.layoutVertexArray,dt,yt,1,-1),Ga(this.layoutVertexArray,dt,yt,1,1),Ga(this.layoutVertexArray,dt,yt,-1,1),this.indexArray.emplaceBack(Lt,Lt+1,Lt+2),this.indexArray.emplaceBack(Lt,Lt+3,Lt+2),kt.vertexLength+=4,kt.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,x,U,{},te)},En("CircleBucket",Ea,{omit:["layers"]});var Ds=new ai({"circle-sort-key":new jn(Ee.layout_circle["circle-sort-key"])}),Zl={paint:new ai({"circle-radius":new jn(Ee.paint_circle["circle-radius"]),"circle-color":new jn(Ee.paint_circle["circle-color"]),"circle-blur":new jn(Ee.paint_circle["circle-blur"]),"circle-opacity":new jn(Ee.paint_circle["circle-opacity"]),"circle-translate":new Rn(Ee.paint_circle["circle-translate"]),"circle-translate-anchor":new Rn(Ee.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Rn(Ee.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Rn(Ee.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new jn(Ee.paint_circle["circle-stroke-width"]),"circle-stroke-color":new jn(Ee.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new jn(Ee.paint_circle["circle-stroke-opacity"])}),layout:Ds},Ja=typeof Float32Array<"u"?Float32Array:Array;function vs(x){return x[0]=1,x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[5]=1,x[6]=0,x[7]=0,x[8]=0,x[9]=0,x[10]=1,x[11]=0,x[12]=0,x[13]=0,x[14]=0,x[15]=1,x}function Da(x,P,U){var te=P[0],ce=P[1],pe=P[2],Te=P[3],je=P[4],nt=P[5],dt=P[6],yt=P[7],kt=P[8],Lt=P[9],Rt=P[10],rr=P[11],ar=P[12],_r=P[13],dr=P[14],Er=P[15],zr=U[0],Ur=U[1],Vr=U[2],en=U[3];return x[0]=zr*te+Ur*je+Vr*kt+en*ar,x[1]=zr*ce+Ur*nt+Vr*Lt+en*_r,x[2]=zr*pe+Ur*dt+Vr*Rt+en*dr,x[3]=zr*Te+Ur*yt+Vr*rr+en*Er,x[4]=(zr=U[4])*te+(Ur=U[5])*je+(Vr=U[6])*kt+(en=U[7])*ar,x[5]=zr*ce+Ur*nt+Vr*Lt+en*_r,x[6]=zr*pe+Ur*dt+Vr*Rt+en*dr,x[7]=zr*Te+Ur*yt+Vr*rr+en*Er,x[8]=(zr=U[8])*te+(Ur=U[9])*je+(Vr=U[10])*kt+(en=U[11])*ar,x[9]=zr*ce+Ur*nt+Vr*Lt+en*_r,x[10]=zr*pe+Ur*dt+Vr*Rt+en*dr,x[11]=zr*Te+Ur*yt+Vr*rr+en*Er,x[12]=(zr=U[12])*te+(Ur=U[13])*je+(Vr=U[14])*kt+(en=U[15])*ar,x[13]=zr*ce+Ur*nt+Vr*Lt+en*_r,x[14]=zr*pe+Ur*dt+Vr*Rt+en*dr,x[15]=zr*Te+Ur*yt+Vr*rr+en*Er,x}Math.hypot||(Math.hypot=function(){for(var x=arguments,P=0,U=arguments.length;U--;)P+=x[U]*x[U];return Math.sqrt(P)});var Ii,Oi=Da;function Rs(x,P,U){var te=P[0],ce=P[1],pe=P[2],Te=P[3];return x[0]=U[0]*te+U[4]*ce+U[8]*pe+U[12]*Te,x[1]=U[1]*te+U[5]*ce+U[9]*pe+U[13]*Te,x[2]=U[2]*te+U[6]*ce+U[10]*pe+U[14]*Te,x[3]=U[3]*te+U[7]*ce+U[11]*pe+U[15]*Te,x}Ii=new Ja(3),Ja!=Float32Array&&(Ii[0]=0,Ii[1]=0,Ii[2]=0),function(){var x=new Ja(4);Ja!=Float32Array&&(x[0]=0,x[1]=0,x[2]=0,x[3]=0)}();var vu=(function(){var x=new Ja(2);Ja!=Float32Array&&(x[0]=0,x[1]=0)}(),function(x){function P(U){x.call(this,U,Zl)}return x&&(P.__proto__=x),(P.prototype=Object.create(x&&x.prototype)).constructor=P,P.prototype.createBucket=function(U){return new Ea(U)},P.prototype.queryRadius=function(U){var te=U;return Fo("circle-radius",this,te)+Fo("circle-stroke-width",this,te)+Bo(this.paint.get("circle-translate"))},P.prototype.queryIntersectsFeature=function(U,te,ce,pe,Te,je,nt,dt){for(var yt=Xa(U,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),je.angle,nt),kt=this.paint.get("circle-radius").evaluate(te,ce)+this.paint.get("circle-stroke-width").evaluate(te,ce),Lt=this.paint.get("circle-pitch-alignment")==="map",Rt=Lt?yt:function(hn,_n){return hn.map(function(On){return Xl(On,_n)})}(yt,dt),rr=Lt?kt*nt:kt,ar=0,_r=pe;ar<_r.length;ar+=1)for(var dr=0,Er=_r[ar];dr<Er.length;dr+=1){var zr=Er[dr],Ur=Lt?zr:Xl(zr,dt),Vr=rr,en=Rs([],[zr.x,zr.y,0,1],dt);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Vr*=en[3]/je.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Vr*=je.cameraToCenterDistance/en[3]),Os(Rt,Ur,Vr))return!0}return!1},P}(Vi));function Xl(x,P){var U=Rs([],[x.x,x.y,0,1],P);return new u(U[0]/U[3],U[1]/U[3])}var vc=function(x){function P(){x.apply(this,arguments)}return x&&(P.__proto__=x),(P.prototype=Object.create(x&&x.prototype)).constructor=P,P}(Ea);function So(x,P,U,te){var ce=P.width,pe=P.height;if(te){if(te instanceof Uint8ClampedArray)te=new Uint8Array(te.buffer);else if(te.length!==ce*pe*U)throw new RangeError("mismatched image size")}else te=new Uint8Array(ce*pe*U);return x.width=ce,x.height=pe,x.data=te,x}function kl(x,P,U){var te=P.width,ce=P.height;if(te!==x.width||ce!==x.height){var pe=So({},{width:te,height:ce},U);rl(x,pe,{x:0,y:0},{x:0,y:0},{width:Math.min(x.width,te),height:Math.min(x.height,ce)},U),x.width=te,x.height=ce,x.data=pe.data}}function rl(x,P,U,te,ce,pe){if(ce.width===0||ce.height===0)return P;if(ce.width>x.width||ce.height>x.height||U.x>x.width-ce.width||U.y>x.height-ce.height)throw new RangeError("out of range source coordinates for image copy");if(ce.width>P.width||ce.height>P.height||te.x>P.width-ce.width||te.y>P.height-ce.height)throw new RangeError("out of range destination coordinates for image copy");for(var Te=x.data,je=P.data,nt=0;nt<ce.height;nt++)for(var dt=((U.y+nt)*x.width+U.x)*pe,yt=((te.y+nt)*P.width+te.x)*pe,kt=0;kt<ce.width*pe;kt++)je[yt+kt]=Te[dt+kt];return P}En("HeatmapBucket",vc,{omit:["layers"]});var vo=function(x,P){So(this,x,1,P)};vo.prototype.resize=function(x){kl(this,x,1)},vo.prototype.clone=function(){return new vo({width:this.width,height:this.height},new Uint8Array(this.data))},vo.copy=function(x,P,U,te,ce){rl(x,P,U,te,ce,1)};var Gi=function(x,P){So(this,x,4,P)};Gi.prototype.resize=function(x){kl(this,x,4)},Gi.prototype.replace=function(x,P){P?this.data.set(x):this.data=x instanceof Uint8ClampedArray?new Uint8Array(x.buffer):x},Gi.prototype.clone=function(){return new Gi({width:this.width,height:this.height},new Uint8Array(this.data))},Gi.copy=function(x,P,U,te,ce){rl(x,P,U,te,ce,4)},En("AlphaImage",vo),En("RGBAImage",Gi);var Of={paint:new ai({"heatmap-radius":new jn(Ee.paint_heatmap["heatmap-radius"]),"heatmap-weight":new jn(Ee.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Rn(Ee.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Ji(Ee.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Rn(Ee.paint_heatmap["heatmap-opacity"])})};function Wu(x,P){for(var U=new Uint8Array(1024),te={},ce=0,pe=0;ce<256;ce++,pe+=4){te[P]=ce/255;var Te=x.evaluate(te);U[pe+0]=Math.floor(255*Te.r/Te.a),U[pe+1]=Math.floor(255*Te.g/Te.a),U[pe+2]=Math.floor(255*Te.b/Te.a),U[pe+3]=Math.floor(255*Te.a)}return new Gi({width:256,height:1},U)}var yu=function(x){function P(U){x.call(this,U,Of),this._updateColorRamp()}return x&&(P.__proto__=x),(P.prototype=Object.create(x&&x.prototype)).constructor=P,P.prototype.createBucket=function(U){return new vc(U)},P.prototype._handleSpecialPaintPropertyUpdate=function(U){U==="heatmap-color"&&this._updateColorRamp()},P.prototype._updateColorRamp=function(){this.colorRamp=Wu(this._transitionablePaint._values["heatmap-color"].value.expression,"heatmapDensity"),this.colorRampTexture=null},P.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},P.prototype.queryRadius=function(){return 0},P.prototype.queryIntersectsFeature=function(){return!1},P.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},P}(Vi),Zu={paint:new ai({"hillshade-illumination-direction":new Rn(Ee.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Rn(Ee.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Rn(Ee.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Rn(Ee.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Rn(Ee.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Rn(Ee.paint_hillshade["hillshade-accent-color"])})},Jl=function(x){function P(U){x.call(this,U,Zu)}return x&&(P.__proto__=x),(P.prototype=Object.create(x&&x.prototype)).constructor=P,P.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},P}(Vi),Uc=Ma([{name:"a_pos",components:2,type:"Int16"}],4).members,yc=Ml,zf=Ml;function Ml(x,P,U){U=U||2;var te,ce,pe,Te,je,nt,dt,yt=P&&P.length,kt=yt?P[0]*U:x.length,Lt=xu(x,0,kt,U,!0),Rt=[];if(!Lt||Lt.next===Lt.prev)return Rt;if(yt&&(Lt=function(ar,_r,dr,Er){var zr,Ur,Vr,en=[];for(zr=0,Ur=_r.length;zr<Ur;zr++)(Vr=xu(ar,_r[zr]*Er,zr<Ur-1?_r[zr+1]*Er:ar.length,Er,!1))===Vr.next&&(Vr.steiner=!0),en.push(Xu(Vr));for(en.sort(Nf),zr=0;zr<en.length;zr++)Vc(en[zr],dr),dr=nl(dr,dr.next);return dr}(x,P,Lt,U)),x.length>80*U){te=pe=x[0],ce=Te=x[1];for(var rr=U;rr<kt;rr+=U)(je=x[rr])<te&&(te=je),(nt=x[rr+1])<ce&&(ce=nt),je>pe&&(pe=je),nt>Te&&(Te=nt);dt=(dt=Math.max(pe-te,Te-ce))!==0?1/dt:0}return al(Lt,Rt,U,te,ce,dt),Rt}function xu(x,P,U,te,ce){var pe,Te;if(ce===Gc(x,P,U,te)>0)for(pe=P;pe<U;pe+=te)Te=Hc(pe,x[pe],x[pe+1],Te);else for(pe=U-te;pe>=P;pe-=te)Te=Hc(pe,x[pe],x[pe+1],Te);return Te&&Sl(Te,Te.next)&&(il(Te),Te=Te.next),Te}function nl(x,P){if(!x)return x;P||(P=x);var U,te=x;do if(U=!1,te.steiner||!Sl(te,te.next)&&Ba(te.prev,te,te.next)!==0)te=te.next;else{if(il(te),(te=P=te.prev)===te.next)break;U=!0}while(U||te!==P);return P}function al(x,P,U,te,ce,pe,Te){if(x){!Te&&pe&&function(yt,kt,Lt,Rt){var rr=yt;do rr.z===null&&(rr.z=bu(rr.x,rr.y,kt,Lt,Rt)),rr.prevZ=rr.prev,rr.nextZ=rr.next,rr=rr.next;while(rr!==yt);rr.prevZ.nextZ=null,rr.prevZ=null,function(ar){var _r,dr,Er,zr,Ur,Vr,en,hn,_n=1;do{for(dr=ar,ar=null,Ur=null,Vr=0;dr;){for(Vr++,Er=dr,en=0,_r=0;_r<_n&&(en++,Er=Er.nextZ);_r++);for(hn=_n;en>0||hn>0&&Er;)en!==0&&(hn===0||!Er||dr.z<=Er.z)?(zr=dr,dr=dr.nextZ,en--):(zr=Er,Er=Er.nextZ,hn--),Ur?Ur.nextZ=zr:ar=zr,zr.prevZ=Ur,Ur=zr;dr=Er}Ur.nextZ=null,_n*=2}while(Vr>1)}(rr)}(x,te,ce,pe);for(var je,nt,dt=x;x.prev!==x.next;)if(je=x.prev,nt=x.next,pe?Rf(x,te,ce,pe):Df(x))P.push(je.i/U),P.push(x.i/U),P.push(nt.i/U),il(x),x=nt.next,dt=nt.next;else if((x=nt)===dt){Te?Te===1?al(x=Ff(nl(x),P,U),P,U,te,ce,pe,2):Te===2&&Bf(x,P,U,te,ce,pe):al(nl(x),P,U,te,ce,pe,1);break}}}function Df(x){var P=x.prev,U=x,te=x.next;if(Ba(P,U,te)>=0)return!1;for(var ce=x.next.next;ce!==x.prev;){if(Al(P.x,P.y,U.x,U.y,te.x,te.y,ce.x,ce.y)&&Ba(ce.prev,ce,ce.next)>=0)return!1;ce=ce.next}return!0}function Rf(x,P,U,te){var ce=x.prev,pe=x,Te=x.next;if(Ba(ce,pe,Te)>=0)return!1;for(var je=ce.x>pe.x?ce.x>Te.x?ce.x:Te.x:pe.x>Te.x?pe.x:Te.x,nt=ce.y>pe.y?ce.y>Te.y?ce.y:Te.y:pe.y>Te.y?pe.y:Te.y,dt=bu(ce.x<pe.x?ce.x<Te.x?ce.x:Te.x:pe.x<Te.x?pe.x:Te.x,ce.y<pe.y?ce.y<Te.y?ce.y:Te.y:pe.y<Te.y?pe.y:Te.y,P,U,te),yt=bu(je,nt,P,U,te),kt=x.prevZ,Lt=x.nextZ;kt&&kt.z>=dt&&Lt&&Lt.z<=yt;){if(kt!==x.prev&&kt!==x.next&&Al(ce.x,ce.y,pe.x,pe.y,Te.x,Te.y,kt.x,kt.y)&&Ba(kt.prev,kt,kt.next)>=0||(kt=kt.prevZ,Lt!==x.prev&&Lt!==x.next&&Al(ce.x,ce.y,pe.x,pe.y,Te.x,Te.y,Lt.x,Lt.y)&&Ba(Lt.prev,Lt,Lt.next)>=0))return!1;Lt=Lt.nextZ}for(;kt&&kt.z>=dt;){if(kt!==x.prev&&kt!==x.next&&Al(ce.x,ce.y,pe.x,pe.y,Te.x,Te.y,kt.x,kt.y)&&Ba(kt.prev,kt,kt.next)>=0)return!1;kt=kt.prevZ}for(;Lt&&Lt.z<=yt;){if(Lt!==x.prev&&Lt!==x.next&&Al(ce.x,ce.y,pe.x,pe.y,Te.x,Te.y,Lt.x,Lt.y)&&Ba(Lt.prev,Lt,Lt.next)>=0)return!1;Lt=Lt.nextZ}return!0}function Ff(x,P,U){var te=x;do{var ce=te.prev,pe=te.next.next;!Sl(ce,pe)&&_u(ce,te,te.next,pe)&&Ql(ce,pe)&&Ql(pe,ce)&&(P.push(ce.i/U),P.push(te.i/U),P.push(pe.i/U),il(te),il(te.next),te=x=pe),te=te.next}while(te!==x);return nl(te)}function Bf(x,P,U,te,ce,pe){var Te=x;do{for(var je=Te.next.next;je!==Te.prev;){if(Te.i!==je.i&&Uf(Te,je)){var nt=qc(Te,je);return Te=nl(Te,Te.next),nt=nl(nt,nt.next),al(Te,P,U,te,ce,pe),void al(nt,P,U,te,ce,pe)}je=je.next}Te=Te.next}while(Te!==x)}function Nf(x,P){return x.x-P.x}function Vc(x,P){if(P=function(te,ce){var pe,Te=ce,je=te.x,nt=te.y,dt=-1/0;do{if(nt<=Te.y&&nt>=Te.next.y&&Te.next.y!==Te.y){var yt=Te.x+(nt-Te.y)*(Te.next.x-Te.x)/(Te.next.y-Te.y);if(yt<=je&&yt>dt){if(dt=yt,yt===je){if(nt===Te.y)return Te;if(nt===Te.next.y)return Te.next}pe=Te.x<Te.next.x?Te:Te.next}}Te=Te.next}while(Te!==ce);if(!pe)return null;if(je===dt)return pe;var kt,Lt=pe,Rt=pe.x,rr=pe.y,ar=1/0;Te=pe;do je>=Te.x&&Te.x>=Rt&&je!==Te.x&&Al(nt<rr?je:dt,nt,Rt,rr,nt<rr?dt:je,nt,Te.x,Te.y)&&(kt=Math.abs(nt-Te.y)/(je-Te.x),Ql(Te,te)&&(kt<ar||kt===ar&&(Te.x>pe.x||Te.x===pe.x&&jf(pe,Te)))&&(pe=Te,ar=kt)),Te=Te.next;while(Te!==Lt);return pe}(x,P)){var U=qc(P,x);nl(P,P.next),nl(U,U.next)}}function jf(x,P){return Ba(x.prev,x,P.prev)<0&&Ba(P.next,x,x.next)<0}function bu(x,P,U,te,ce){return(x=1431655765&((x=858993459&((x=252645135&((x=16711935&((x=32767*(x-U)*ce)|x<<8))|x<<4))|x<<2))|x<<1))|(P=1431655765&((P=858993459&((P=252645135&((P=16711935&((P=32767*(P-te)*ce)|P<<8))|P<<4))|P<<2))|P<<1))<<1}function Xu(x){var P=x,U=x;do(P.x<U.x||P.x===U.x&&P.y<U.y)&&(U=P),P=P.next;while(P!==x);return U}function Al(x,P,U,te,ce,pe,Te,je){return(ce-Te)*(P-je)-(x-Te)*(pe-je)>=0&&(x-Te)*(te-je)-(U-Te)*(P-je)>=0&&(U-Te)*(pe-je)-(ce-Te)*(te-je)>=0}function Uf(x,P){return x.next.i!==P.i&&x.prev.i!==P.i&&!function(U,te){var ce=U;do{if(ce.i!==U.i&&ce.next.i!==U.i&&ce.i!==te.i&&ce.next.i!==te.i&&_u(ce,ce.next,U,te))return!0;ce=ce.next}while(ce!==U);return!1}(x,P)&&(Ql(x,P)&&Ql(P,x)&&function(U,te){var ce=U,pe=!1,Te=(U.x+te.x)/2,je=(U.y+te.y)/2;do ce.y>je!=ce.next.y>je&&ce.next.y!==ce.y&&Te<(ce.next.x-ce.x)*(je-ce.y)/(ce.next.y-ce.y)+ce.x&&(pe=!pe),ce=ce.next;while(ce!==U);return pe}(x,P)&&(Ba(x.prev,x,P.prev)||Ba(x,P.prev,P))||Sl(x,P)&&Ba(x.prev,x,x.next)>0&&Ba(P.prev,P,P.next)>0)}function Ba(x,P,U){return(P.y-x.y)*(U.x-P.x)-(P.x-x.x)*(U.y-P.y)}function Sl(x,P){return x.x===P.x&&x.y===P.y}function _u(x,P,U,te){var ce=yo(Ba(x,P,U)),pe=yo(Ba(x,P,te)),Te=yo(Ba(U,te,x)),je=yo(Ba(U,te,P));return ce!==pe&&Te!==je||!(ce!==0||!Kl(x,U,P))||!(pe!==0||!Kl(x,te,P))||!(Te!==0||!Kl(U,x,te))||!(je!==0||!Kl(U,P,te))}function Kl(x,P,U){return P.x<=Math.max(x.x,U.x)&&P.x>=Math.min(x.x,U.x)&&P.y<=Math.max(x.y,U.y)&&P.y>=Math.min(x.y,U.y)}function yo(x){return x>0?1:x<0?-1:0}function Ql(x,P){return Ba(x.prev,x,x.next)<0?Ba(x,P,x.next)>=0&&Ba(x,x.prev,P)>=0:Ba(x,P,x.prev)<0||Ba(x,x.next,P)<0}function qc(x,P){var U=new xc(x.i,x.x,x.y),te=new xc(P.i,P.x,P.y),ce=x.next,pe=P.prev;return x.next=P,P.prev=x,U.next=ce,ce.prev=U,te.next=U,U.prev=te,pe.next=te,te.prev=pe,te}function Hc(x,P,U,te){var ce=new xc(x,P,U);return te?(ce.next=te.next,ce.prev=te,te.next.prev=ce,te.next=ce):(ce.prev=ce,ce.next=ce),ce}function il(x){x.next.prev=x.prev,x.prev.next=x.next,x.prevZ&&(x.prevZ.nextZ=x.nextZ),x.nextZ&&(x.nextZ.prevZ=x.prevZ)}function xc(x,P,U){this.i=x,this.x=P,this.y=U,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Gc(x,P,U,te){for(var ce=0,pe=P,Te=U-te;pe<U;pe+=te)ce+=(x[Te]-x[pe])*(x[pe+1]+x[Te+1]),Te=pe;return ce}function No(x,P,U,te,ce){(function pe(Te,je,nt,dt,yt){for(;dt>nt;){if(dt-nt>600){var kt=dt-nt+1,Lt=je-nt+1,Rt=Math.log(kt),rr=.5*Math.exp(2*Rt/3),ar=.5*Math.sqrt(Rt*rr*(kt-rr)/kt)*(Lt-kt/2<0?-1:1);pe(Te,je,Math.max(nt,Math.floor(je-Lt*rr/kt+ar)),Math.min(dt,Math.floor(je+(kt-Lt)*rr/kt+ar)),yt)}var _r=Te[je],dr=nt,Er=dt;for($l(Te,nt,je),yt(Te[dt],_r)>0&&$l(Te,nt,dt);dr<Er;){for($l(Te,dr,Er),dr++,Er--;yt(Te[dr],_r)<0;)dr++;for(;yt(Te[Er],_r)>0;)Er--}yt(Te[nt],_r)===0?$l(Te,nt,Er):$l(Te,++Er,dt),Er<=je&&(nt=Er+1),je<=Er&&(dt=Er-1)}})(x,P,U||0,te||x.length-1,ce||Ju)}function $l(x,P,U){var te=x[P];x[P]=x[U],x[U]=te}function Ju(x,P){return x<P?-1:x>P?1:0}function ys(x,P){var U=x.length;if(U<=1)return[x];for(var te,ce,pe=[],Te=0;Te<U;Te++){var je=k(x[Te]);je!==0&&(x[Te].area=Math.abs(je),ce===void 0&&(ce=je<0),ce===je<0?(te&&pe.push(te),te=[x[Te]]):te.push(x[Te]))}if(te&&pe.push(te),P>1)for(var nt=0;nt<pe.length;nt++)pe[nt].length<=P||(No(pe[nt],P,1,pe[nt].length-1,wu),pe[nt]=pe[nt].slice(0,P));return pe}function wu(x,P){return P.area-x.area}function bc(x,P,U){for(var te=U.patternDependencies,ce=!1,pe=0,Te=P;pe<Te.length;pe+=1){var je=Te[pe].paint.get(x+"-pattern");je.isConstant()||(ce=!0);var nt=je.constantOr(null);nt&&(ce=!0,te[nt.to]=!0,te[nt.from]=!0)}return ce}function Yc(x,P,U,te,ce){for(var pe=ce.patternDependencies,Te=0,je=P;Te<je.length;Te+=1){var nt=je[Te],dt=nt.paint.get(x+"-pattern").value;if(dt.kind!=="constant"){var yt=dt.evaluate({zoom:te-1},U,{},ce.availableImages),kt=dt.evaluate({zoom:te},U,{},ce.availableImages),Lt=dt.evaluate({zoom:te+1},U,{},ce.availableImages);kt=kt&&kt.name?kt.name:kt,Lt=Lt&&Lt.name?Lt.name:Lt,pe[yt=yt&&yt.name?yt.name:yt]=!0,pe[kt]=!0,pe[Lt]=!0,U.patterns[nt.id]={min:yt,mid:kt,max:Lt}}}return U}Ml.deviation=function(x,P,U,te){var ce=P&&P.length,pe=Math.abs(Gc(x,0,ce?P[0]*U:x.length,U));if(ce)for(var Te=0,je=P.length;Te<je;Te++)pe-=Math.abs(Gc(x,P[Te]*U,Te<je-1?P[Te+1]*U:x.length,U));var nt=0;for(Te=0;Te<te.length;Te+=3){var dt=te[Te]*U,yt=te[Te+1]*U,kt=te[Te+2]*U;nt+=Math.abs((x[dt]-x[kt])*(x[yt+1]-x[dt+1])-(x[dt]-x[yt])*(x[kt+1]-x[dt+1]))}return pe===0&&nt===0?0:Math.abs((nt-pe)/pe)},Ml.flatten=function(x){for(var P=x[0][0].length,U={vertices:[],holes:[],dimensions:P},te=0,ce=0;ce<x.length;ce++){for(var pe=0;pe<x[ce].length;pe++)for(var Te=0;Te<P;Te++)U.vertices.push(x[ce][pe][Te]);ce>0&&U.holes.push(te+=x[ce-1].length)}return U},yc.default=zf;var jo=function(x){this.zoom=x.zoom,this.overscaling=x.overscaling,this.layers=x.layers,this.layerIds=this.layers.map(function(P){return P.id}),this.index=x.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Qs,this.indexArray=new qi,this.indexArray2=new Hi,this.programConfigurations=new qn(Uc,x.layers,x.zoom),this.segments=new Gt,this.segments2=new Gt,this.stateDependentLayerIds=this.layers.filter(function(P){return P.isStateDependent()}).map(function(P){return P.id})};jo.prototype.populate=function(x,P,U){this.hasPattern=bc("fill",this.layers,P);for(var te=this.layers[0].layout.get("fill-sort-key"),ce=[],pe=0,Te=x;pe<Te.length;pe+=1){var je=Te[pe],nt=je.feature,dt=je.id,yt=je.index,kt=je.sourceLayerIndex,Lt=this.layers[0]._featureFilter.needGeometry,Rt={type:nt.type,id:dt,properties:nt.properties,geometry:Lt?ba(nt):[]};if(this.layers[0]._featureFilter.filter(new Ta(this.zoom),Rt,U)){Lt||(Rt.geometry=ba(nt));var rr=te?te.evaluate(Rt,{},U,P.availableImages):void 0;ce.push({id:dt,properties:nt.properties,type:nt.type,sourceLayerIndex:kt,index:yt,geometry:Rt.geometry,patterns:{},sortKey:rr})}}te&&ce.sort(function(en,hn){return en.sortKey-hn.sortKey});for(var ar=0,_r=ce;ar<_r.length;ar+=1){var dr=_r[ar],Er=dr.geometry,zr=dr.index,Ur=dr.sourceLayerIndex;if(this.hasPattern){var Vr=Yc("fill",this.layers,dr,this.zoom,P);this.patternFeatures.push(Vr)}else this.addFeature(dr,Er,zr,U,{});P.featureIndex.insert(x[zr].feature,Er,zr,Ur,this.index)}},jo.prototype.update=function(x,P,U){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(x,P,this.stateDependentLayers,U)},jo.prototype.addFeatures=function(x,P,U){for(var te=0,ce=this.patternFeatures;te<ce.length;te+=1){var pe=ce[te];this.addFeature(pe,pe.geometry,pe.index,P,U)}},jo.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},jo.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},jo.prototype.upload=function(x){this.uploaded||(this.layoutVertexBuffer=x.createVertexBuffer(this.layoutVertexArray,Uc),this.indexBuffer=x.createIndexBuffer(this.indexArray),this.indexBuffer2=x.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(x),this.uploaded=!0},jo.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},jo.prototype.addFeature=function(x,P,U,te,ce){for(var pe=0,Te=ys(P,500);pe<Te.length;pe+=1){for(var je=Te[pe],nt=0,dt=0,yt=je;dt<yt.length;dt+=1)nt+=yt[dt].length;for(var kt=this.segments.prepareSegment(nt,this.layoutVertexArray,this.indexArray),Lt=kt.vertexLength,Rt=[],rr=[],ar=0,_r=je;ar<_r.length;ar+=1){var dr=_r[ar];if(dr.length!==0){dr!==je[0]&&rr.push(Rt.length/2);var Er=this.segments2.prepareSegment(dr.length,this.layoutVertexArray,this.indexArray2),zr=Er.vertexLength;this.layoutVertexArray.emplaceBack(dr[0].x,dr[0].y),this.indexArray2.emplaceBack(zr+dr.length-1,zr),Rt.push(dr[0].x),Rt.push(dr[0].y);for(var Ur=1;Ur<dr.length;Ur++)this.layoutVertexArray.emplaceBack(dr[Ur].x,dr[Ur].y),this.indexArray2.emplaceBack(zr+Ur-1,zr+Ur),Rt.push(dr[Ur].x),Rt.push(dr[Ur].y);Er.vertexLength+=dr.length,Er.primitiveLength+=dr.length}}for(var Vr=yc(Rt,rr),en=0;en<Vr.length;en+=3)this.indexArray.emplaceBack(Lt+Vr[en],Lt+Vr[en+1],Lt+Vr[en+2]);kt.vertexLength+=nt,kt.primitiveLength+=Vr.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,x,U,ce,te)},En("FillBucket",jo,{omit:["layers","patternFeatures"]});var Vf=new ai({"fill-sort-key":new jn(Ee.layout_fill["fill-sort-key"])}),Ku={paint:new ai({"fill-antialias":new Rn(Ee.paint_fill["fill-antialias"]),"fill-opacity":new jn(Ee.paint_fill["fill-opacity"]),"fill-color":new jn(Ee.paint_fill["fill-color"]),"fill-outline-color":new jn(Ee.paint_fill["fill-outline-color"]),"fill-translate":new Rn(Ee.paint_fill["fill-translate"]),"fill-translate-anchor":new Rn(Ee.paint_fill["fill-translate-anchor"]),"fill-pattern":new Va(Ee.paint_fill["fill-pattern"])}),layout:Vf},qf=function(x){function P(U){x.call(this,U,Ku)}return x&&(P.__proto__=x),(P.prototype=Object.create(x&&x.prototype)).constructor=P,P.prototype.recalculate=function(U,te){x.prototype.recalculate.call(this,U,te);var ce=this.paint._values["fill-outline-color"];ce.value.kind==="constant"&&ce.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},P.prototype.createBucket=function(U){return new jo(U)},P.prototype.queryRadius=function(){return Bo(this.paint.get("fill-translate"))},P.prototype.queryIntersectsFeature=function(U,te,ce,pe,Te,je,nt){return go(Xa(U,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),je.angle,nt),pe)},P.prototype.isTileClipped=function(){return!0},P}(Vi),Qu=Ma([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,$u=El;function El(x,P,U,te,ce){this.properties={},this.extent=U,this.type=0,this._pbf=x,this._geometry=-1,this._keys=te,this._values=ce,x.readFields(ef,this,P)}function ef(x,P,U){x==1?P.id=U.readVarint():x==2?function(te,ce){for(var pe=te.readVarint()+te.pos;te.pos<pe;){var Te=ce._keys[te.readVarint()],je=ce._values[te.readVarint()];ce.properties[Te]=je}}(U,P):x==3?P.type=U.readVarint():x==4&&(P._geometry=U.pos)}function Wc(x){for(var P,U,te=0,ce=0,pe=x.length,Te=pe-1;ce<pe;Te=ce++)te+=((U=x[Te]).x-(P=x[ce]).x)*(P.y+U.y);return te}El.types=["Unknown","Point","LineString","Polygon"],El.prototype.loadGeometry=function(){var x=this._pbf;x.pos=this._geometry;for(var P,U=x.readVarint()+x.pos,te=1,ce=0,pe=0,Te=0,je=[];x.pos<U;){if(ce<=0){var nt=x.readVarint();te=7&nt,ce=nt>>3}if(ce--,te===1||te===2)pe+=x.readSVarint(),Te+=x.readSVarint(),te===1&&(P&&je.push(P),P=[]),P.push(new u(pe,Te));else{if(te!==7)throw new Error("unknown command "+te);P&&P.push(P[0].clone())}}return P&&je.push(P),je},El.prototype.bbox=function(){var x=this._pbf;x.pos=this._geometry;for(var P=x.readVarint()+x.pos,U=1,te=0,ce=0,pe=0,Te=1/0,je=-1/0,nt=1/0,dt=-1/0;x.pos<P;){if(te<=0){var yt=x.readVarint();U=7&yt,te=yt>>3}if(te--,U===1||U===2)(ce+=x.readSVarint())<Te&&(Te=ce),ce>je&&(je=ce),(pe+=x.readSVarint())<nt&&(nt=pe),pe>dt&&(dt=pe);else if(U!==7)throw new Error("unknown command "+U)}return[Te,nt,je,dt]},El.prototype.toGeoJSON=function(x,P,U){var te,ce,pe=this.extent*Math.pow(2,U),Te=this.extent*x,je=this.extent*P,nt=this.loadGeometry(),dt=El.types[this.type];function yt(Rt){for(var rr=0;rr<Rt.length;rr++){var ar=Rt[rr];Rt[rr]=[360*(ar.x+Te)/pe-180,360/Math.PI*Math.atan(Math.exp((180-360*(ar.y+je)/pe)*Math.PI/180))-90]}}switch(this.type){case 1:var kt=[];for(te=0;te<nt.length;te++)kt[te]=nt[te][0];yt(nt=kt);break;case 2:for(te=0;te<nt.length;te++)yt(nt[te]);break;case 3:for(nt=function(Rt){var rr=Rt.length;if(rr<=1)return[Rt];for(var ar,_r,dr=[],Er=0;Er<rr;Er++){var zr=Wc(Rt[Er]);zr!==0&&(_r===void 0&&(_r=zr<0),_r===zr<0?(ar&&dr.push(ar),ar=[Rt[Er]]):ar.push(Rt[Er]))}return ar&&dr.push(ar),dr}(nt),te=0;te<nt.length;te++)for(ce=0;ce<nt[te].length;ce++)yt(nt[te][ce])}nt.length===1?nt=nt[0]:dt="Multi"+dt;var Lt={type:"Feature",geometry:{type:dt,coordinates:nt},properties:this.properties};return"id"in this&&(Lt.id=this.id),Lt};var Tu=_c;function _c(x,P){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=x,this._keys=[],this._values=[],this._features=[],x.readFields(tf,this,P),this.length=this._features.length}function tf(x,P,U){x===15?P.version=U.readVarint():x===1?P.name=U.readString():x===5?P.extent=U.readVarint():x===2?P._features.push(U.pos):x===3?P._keys.push(U.readString()):x===4&&P._values.push(function(te){for(var ce=null,pe=te.readVarint()+te.pos;te.pos<pe;){var Te=te.readVarint()>>3;ce=Te===1?te.readString():Te===2?te.readFloat():Te===3?te.readDouble():Te===4?te.readVarint64():Te===5?te.readVarint():Te===6?te.readSVarint():Te===7?te.readBoolean():null}return ce}(U))}function wc(x,P,U){if(x===3){var te=new Tu(U,U.readVarint()+U.pos);te.length&&(P[te.name]=te)}}_c.prototype.feature=function(x){if(x<0||x>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[x];var P=this._pbf.readVarint()+this._pbf.pos;return new $u(this._pbf,P,this.extent,this._keys,this._values)};var Uo={VectorTile:function(x,P){this.layers=x.readFields(wc,{},P)},VectorTileFeature:$u,VectorTileLayer:Tu},Zc=Uo.VectorTileFeature.types,Ka=Math.pow(2,13);function ec(x,P,U,te,ce,pe,Te,je){x.emplaceBack(P,U,2*Math.floor(te*Ka)+Te,ce*Ka*2,pe*Ka*2,Math.round(je))}var Eo=function(x){this.zoom=x.zoom,this.overscaling=x.overscaling,this.layers=x.layers,this.layerIds=this.layers.map(function(P){return P.id}),this.index=x.index,this.hasPattern=!1,this.layoutVertexArray=new dc,this.indexArray=new qi,this.programConfigurations=new qn(Qu,x.layers,x.zoom),this.segments=new Gt,this.stateDependentLayerIds=this.layers.filter(function(P){return P.isStateDependent()}).map(function(P){return P.id})};function Hf(x,P){return x.x===P.x&&(x.x<0||x.x>8192)||x.y===P.y&&(x.y<0||x.y>8192)}Eo.prototype.populate=function(x,P,U){this.features=[],this.hasPattern=bc("fill-extrusion",this.layers,P);for(var te=0,ce=x;te<ce.length;te+=1){var pe=ce[te],Te=pe.feature,je=pe.id,nt=pe.index,dt=pe.sourceLayerIndex,yt=this.layers[0]._featureFilter.needGeometry,kt={type:Te.type,id:je,properties:Te.properties,geometry:yt?ba(Te):[]};if(this.layers[0]._featureFilter.filter(new Ta(this.zoom),kt,U)){var Lt={id:je,sourceLayerIndex:dt,index:nt,geometry:yt?kt.geometry:ba(Te),properties:Te.properties,type:Te.type,patterns:{}};Te.id!==void 0&&(Lt.id=Te.id),this.hasPattern?this.features.push(Yc("fill-extrusion",this.layers,Lt,this.zoom,P)):this.addFeature(Lt,Lt.geometry,nt,U,{}),P.featureIndex.insert(Te,Lt.geometry,nt,dt,this.index,!0)}}},Eo.prototype.addFeatures=function(x,P,U){for(var te=0,ce=this.features;te<ce.length;te+=1){var pe=ce[te];this.addFeature(pe,pe.geometry,pe.index,P,U)}},Eo.prototype.update=function(x,P,U){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(x,P,this.stateDependentLayers,U)},Eo.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Eo.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Eo.prototype.upload=function(x){this.uploaded||(this.layoutVertexBuffer=x.createVertexBuffer(this.layoutVertexArray,Qu),this.indexBuffer=x.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(x),this.uploaded=!0},Eo.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Eo.prototype.addFeature=function(x,P,U,te,ce){for(var pe=0,Te=ys(P,500);pe<Te.length;pe+=1){for(var je=Te[pe],nt=0,dt=0,yt=je;dt<yt.length;dt+=1)nt+=yt[dt].length;for(var kt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),Lt=0,Rt=je;Lt<Rt.length;Lt+=1){var rr=Rt[Lt];if(rr.length!==0&&!((ca=rr).every(function(ea){return ea.x<0})||ca.every(function(ea){return ea.x>8192})||ca.every(function(ea){return ea.y<0})||ca.every(function(ea){return ea.y>8192})))for(var ar=0,_r=0;_r<rr.length;_r++){var dr=rr[_r];if(_r>=1){var Er=rr[_r-1];if(!Hf(dr,Er)){kt.vertexLength+4>Gt.MAX_VERTEX_ARRAY_LENGTH&&(kt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var zr=dr.sub(Er)._perp()._unit(),Ur=Er.dist(dr);ar+Ur>32768&&(ar=0),ec(this.layoutVertexArray,dr.x,dr.y,zr.x,zr.y,0,0,ar),ec(this.layoutVertexArray,dr.x,dr.y,zr.x,zr.y,0,1,ar),ec(this.layoutVertexArray,Er.x,Er.y,zr.x,zr.y,0,0,ar+=Ur),ec(this.layoutVertexArray,Er.x,Er.y,zr.x,zr.y,0,1,ar);var Vr=kt.vertexLength;this.indexArray.emplaceBack(Vr,Vr+2,Vr+1),this.indexArray.emplaceBack(Vr+1,Vr+2,Vr+3),kt.vertexLength+=4,kt.primitiveLength+=2}}}}if(kt.vertexLength+nt>Gt.MAX_VERTEX_ARRAY_LENGTH&&(kt=this.segments.prepareSegment(nt,this.layoutVertexArray,this.indexArray)),Zc[x.type]==="Polygon"){for(var en=[],hn=[],_n=kt.vertexLength,On=0,kn=je;On<kn.length;On+=1){var Fn=kn[On];if(Fn.length!==0){Fn!==je[0]&&hn.push(en.length/2);for(var wn=0;wn<Fn.length;wn++){var ia=Fn[wn];ec(this.layoutVertexArray,ia.x,ia.y,0,0,1,1,0),en.push(ia.x),en.push(ia.y)}}}for(var Yn=yc(en,hn),Cn=0;Cn<Yn.length;Cn+=3)this.indexArray.emplaceBack(_n+Yn[Cn],_n+Yn[Cn+2],_n+Yn[Cn+1]);kt.primitiveLength+=Yn.length/3,kt.vertexLength+=nt}}var ca;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,x,U,ce,te)},En("FillExtrusionBucket",Eo,{omit:["layers","features"]});var ku={paint:new ai({"fill-extrusion-opacity":new Rn(Ee["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new jn(Ee["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Rn(Ee["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Rn(Ee["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Va(Ee["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new jn(Ee["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new jn(Ee["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Rn(Ee["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},Xc=function(x){function P(U){x.call(this,U,ku)}return x&&(P.__proto__=x),(P.prototype=Object.create(x&&x.prototype)).constructor=P,P.prototype.createBucket=function(U){return new Eo(U)},P.prototype.queryRadius=function(){return Bo(this.paint.get("fill-extrusion-translate"))},P.prototype.is3D=function(){return!0},P.prototype.queryIntersectsFeature=function(U,te,ce,pe,Te,je,nt,dt){var yt=Xa(U,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),je.angle,nt),kt=this.paint.get("fill-extrusion-height").evaluate(te,ce),Lt=this.paint.get("fill-extrusion-base").evaluate(te,ce),Rt=function(ar,_r,dr,Er){for(var zr=[],Ur=0,Vr=ar;Ur<Vr.length;Ur+=1){var en=Vr[Ur],hn=[en.x,en.y,0,1];Rs(hn,hn,_r),zr.push(new u(hn[0]/hn[3],hn[1]/hn[3]))}return zr}(yt,dt),rr=function(ar,_r,dr,Er){for(var zr=[],Ur=[],Vr=Er[8]*_r,en=Er[9]*_r,hn=Er[10]*_r,_n=Er[11]*_r,On=Er[8]*dr,kn=Er[9]*dr,Fn=Er[10]*dr,wn=Er[11]*dr,ia=0,Yn=ar;ia<Yn.length;ia+=1){for(var Cn=[],ca=[],ea=0,ha=Yn[ia];ea<ha.length;ea+=1){var Nn=ha[ea],ga=Nn.x,Ca=Nn.y,bi=Er[0]*ga+Er[4]*Ca+Er[12],_i=Er[1]*ga+Er[5]*Ca+Er[13],La=Er[2]*ga+Er[6]*Ca+Er[14],li=Er[3]*ga+Er[7]*Ca+Er[15],Pa=La+hn,gi=li+_n,Qi=bi+On,Ci=_i+kn,so=La+Fn,mi=li+wn,vi=new u((bi+Vr)/gi,(_i+en)/gi);vi.z=Pa/gi,Cn.push(vi);var ua=new u(Qi/mi,Ci/mi);ua.z=so/mi,ca.push(ua)}zr.push(Cn),Ur.push(ca)}return[zr,Ur]}(pe,Lt,kt,dt);return function(ar,_r,dr){var Er=1/0;go(dr,_r)&&(Er=rf(dr,_r[0]));for(var zr=0;zr<_r.length;zr++)for(var Ur=_r[zr],Vr=ar[zr],en=0;en<Ur.length-1;en++){var hn=Ur[en],_n=[hn,Ur[en+1],Vr[en+1],Vr[en],hn];Ao(dr,_n)&&(Er=Math.min(Er,rf(dr,_n)))}return Er!==1/0&&Er}(rr[0],rr[1],Rt)},P}(Vi);function tc(x,P){return x.x*P.x+x.y*P.y}function rf(x,P){if(x.length===1){for(var U,te=0,ce=P[te++];!U||ce.equals(U);)if(!(U=P[te++]))return 1/0;for(;te<P.length;te++){var pe=P[te],Te=x[0],je=U.sub(ce),nt=pe.sub(ce),dt=Te.sub(ce),yt=tc(je,je),kt=tc(je,nt),Lt=tc(nt,nt),Rt=tc(dt,je),rr=tc(dt,nt),ar=yt*Lt-kt*kt,_r=(Lt*Rt-kt*rr)/ar,dr=(yt*rr-kt*Rt)/ar,Er=ce.z*(1-_r-dr)+U.z*_r+pe.z*dr;if(isFinite(Er))return Er}return 1/0}for(var zr=1/0,Ur=0,Vr=P;Ur<Vr.length;Ur+=1)zr=Math.min(zr,Vr[Ur].z);return zr}var nf=Ma([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,Gf=Uo.VectorTileFeature.types,Yf=Math.cos(Math.PI/180*37.5),Jc=Math.pow(2,14)/.5,zi=function(x){this.zoom=x.zoom,this.overscaling=x.overscaling,this.layers=x.layers,this.layerIds=this.layers.map(function(P){return P.id}),this.index=x.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new po,this.indexArray=new qi,this.programConfigurations=new qn(nf,x.layers,x.zoom),this.segments=new Gt,this.stateDependentLayerIds=this.layers.filter(function(P){return P.isStateDependent()}).map(function(P){return P.id})};zi.prototype.populate=function(x,P,U){this.hasPattern=bc("line",this.layers,P);for(var te=this.layers[0].layout.get("line-sort-key"),ce=[],pe=0,Te=x;pe<Te.length;pe+=1){var je=Te[pe],nt=je.feature,dt=je.id,yt=je.index,kt=je.sourceLayerIndex,Lt=this.layers[0]._featureFilter.needGeometry,Rt={type:nt.type,id:dt,properties:nt.properties,geometry:Lt?ba(nt):[]};if(this.layers[0]._featureFilter.filter(new Ta(this.zoom),Rt,U)){Lt||(Rt.geometry=ba(nt));var rr=te?te.evaluate(Rt,{},U):void 0;ce.push({id:dt,properties:nt.properties,type:nt.type,sourceLayerIndex:kt,index:yt,geometry:Rt.geometry,patterns:{},sortKey:rr})}}te&&ce.sort(function(en,hn){return en.sortKey-hn.sortKey});for(var ar=0,_r=ce;ar<_r.length;ar+=1){var dr=_r[ar],Er=dr.geometry,zr=dr.index,Ur=dr.sourceLayerIndex;if(this.hasPattern){var Vr=Yc("line",this.layers,dr,this.zoom,P);this.patternFeatures.push(Vr)}else this.addFeature(dr,Er,zr,U,{});P.featureIndex.insert(x[zr].feature,Er,zr,Ur,this.index)}},zi.prototype.update=function(x,P,U){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(x,P,this.stateDependentLayers,U)},zi.prototype.addFeatures=function(x,P,U){for(var te=0,ce=this.patternFeatures;te<ce.length;te+=1){var pe=ce[te];this.addFeature(pe,pe.geometry,pe.index,P,U)}},zi.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},zi.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},zi.prototype.upload=function(x){this.uploaded||(this.layoutVertexBuffer=x.createVertexBuffer(this.layoutVertexArray,nf),this.indexBuffer=x.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(x),this.uploaded=!0},zi.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},zi.prototype.addFeature=function(x,P,U,te,ce){for(var pe=this.layers[0].layout,Te=pe.get("line-join").evaluate(x,{}),je=pe.get("line-cap"),nt=pe.get("line-miter-limit"),dt=pe.get("line-round-limit"),yt=0,kt=P;yt<kt.length;yt+=1)this.addLine(kt[yt],x,Te,je,nt,dt);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,x,U,ce,te)},zi.prototype.addLine=function(x,P,U,te,ce,pe){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,P.properties&&P.properties.hasOwnProperty("mapbox_clip_start")&&P.properties.hasOwnProperty("mapbox_clip_end")){this.clipStart=+P.properties.mapbox_clip_start,this.clipEnd=+P.properties.mapbox_clip_end;for(var Te=0;Te<x.length-1;Te++)this.totalDistance+=x[Te].dist(x[Te+1]);this.updateScaledDistance()}for(var je=Gf[P.type]==="Polygon",nt=x.length;nt>=2&&x[nt-1].equals(x[nt-2]);)nt--;for(var dt=0;dt<nt-1&&x[dt].equals(x[dt+1]);)dt++;if(!(nt<(je?3:2))){U==="bevel"&&(ce=1.05);var yt,kt=this.overscaling<=16?122880/(512*this.overscaling):0,Lt=this.segments.prepareSegment(10*nt,this.layoutVertexArray,this.indexArray),Rt=void 0,rr=void 0,ar=void 0,_r=void 0;this.e1=this.e2=-1,je&&(_r=x[dt].sub(yt=x[nt-2])._unit()._perp());for(var dr=dt;dr<nt;dr++)if(!(rr=dr===nt-1?je?x[dt+1]:void 0:x[dr+1])||!x[dr].equals(rr)){_r&&(ar=_r),yt&&(Rt=yt),yt=x[dr],_r=rr?rr.sub(yt)._unit()._perp():ar;var Er=(ar=ar||_r).add(_r);Er.x===0&&Er.y===0||Er._unit();var zr=ar.x*_r.x+ar.y*_r.y,Ur=Er.x*_r.x+Er.y*_r.y,Vr=Ur!==0?1/Ur:1/0,en=2*Math.sqrt(2-2*Ur),hn=Ur<Yf&&Rt&&rr,_n=ar.x*_r.y-ar.y*_r.x>0;if(hn&&dr>dt){var On=yt.dist(Rt);if(On>2*kt){var kn=yt.sub(yt.sub(Rt)._mult(kt/On)._round());this.updateDistance(Rt,kn),this.addCurrentVertex(kn,ar,0,0,Lt),Rt=kn}}var Fn=Rt&&rr,wn=Fn?U:je?"butt":te;if(Fn&&wn==="round"&&(Vr<pe?wn="miter":Vr<=2&&(wn="fakeround")),wn==="miter"&&Vr>ce&&(wn="bevel"),wn==="bevel"&&(Vr>2&&(wn="flipbevel"),Vr<ce&&(wn="miter")),Rt&&this.updateDistance(Rt,yt),wn==="miter")Er._mult(Vr),this.addCurrentVertex(yt,Er,0,0,Lt);else if(wn==="flipbevel"){if(Vr>100)Er=_r.mult(-1);else{var ia=Vr*ar.add(_r).mag()/ar.sub(_r).mag();Er._perp()._mult(ia*(_n?-1:1))}this.addCurrentVertex(yt,Er,0,0,Lt),this.addCurrentVertex(yt,Er.mult(-1),0,0,Lt)}else if(wn==="bevel"||wn==="fakeround"){var Yn=-Math.sqrt(Vr*Vr-1),Cn=_n?Yn:0,ca=_n?0:Yn;if(Rt&&this.addCurrentVertex(yt,ar,Cn,ca,Lt),wn==="fakeround")for(var ea=Math.round(180*en/Math.PI/20),ha=1;ha<ea;ha++){var Nn=ha/ea;if(Nn!==.5){var ga=Nn-.5;Nn+=Nn*ga*(Nn-1)*((1.0904+zr*(zr*(3.55645-1.43519*zr)-3.2452))*ga*ga+(.848013+zr*(.215638*zr-1.06021)))}var Ca=_r.sub(ar)._mult(Nn)._add(ar)._unit()._mult(_n?-1:1);this.addHalfVertex(yt,Ca.x,Ca.y,!1,_n,0,Lt)}rr&&this.addCurrentVertex(yt,_r,-Cn,-ca,Lt)}else if(wn==="butt")this.addCurrentVertex(yt,Er,0,0,Lt);else if(wn==="square"){var bi=Rt?1:-1;this.addCurrentVertex(yt,Er,bi,bi,Lt)}else wn==="round"&&(Rt&&(this.addCurrentVertex(yt,ar,0,0,Lt),this.addCurrentVertex(yt,ar,1,1,Lt,!0)),rr&&(this.addCurrentVertex(yt,_r,-1,-1,Lt,!0),this.addCurrentVertex(yt,_r,0,0,Lt)));if(hn&&dr<nt-1){var _i=yt.dist(rr);if(_i>2*kt){var La=yt.add(rr.sub(yt)._mult(kt/_i)._round());this.updateDistance(yt,La),this.addCurrentVertex(La,_r,0,0,Lt),yt=La}}}}},zi.prototype.addCurrentVertex=function(x,P,U,te,ce,pe){pe===void 0&&(pe=!1);var Te=P.y*te-P.x,je=-P.y-P.x*te;this.addHalfVertex(x,P.x+P.y*U,P.y-P.x*U,pe,!1,U,ce),this.addHalfVertex(x,Te,je,pe,!0,-te,ce),this.distance>Jc/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(x,P,U,te,ce,pe))},zi.prototype.addHalfVertex=function(x,P,U,te,ce,pe,Te){var je=.5*this.scaledDistance;this.layoutVertexArray.emplaceBack((x.x<<1)+(te?1:0),(x.y<<1)+(ce?1:0),Math.round(63*P)+128,Math.round(63*U)+128,1+(pe===0?0:pe<0?-1:1)|(63&je)<<2,je>>6);var nt=Te.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,nt),Te.primitiveLength++),ce?this.e2=nt:this.e1=nt},zi.prototype.updateScaledDistance=function(){this.scaledDistance=this.totalDistance>0?(this.clipStart+(this.clipEnd-this.clipStart)*this.distance/this.totalDistance)*(Jc-1):this.distance},zi.prototype.updateDistance=function(x,P){this.distance+=x.dist(P),this.updateScaledDistance()},En("LineBucket",zi,{omit:["layers","patternFeatures"]});var af=new ai({"line-cap":new Rn(Ee.layout_line["line-cap"]),"line-join":new jn(Ee.layout_line["line-join"]),"line-miter-limit":new Rn(Ee.layout_line["line-miter-limit"]),"line-round-limit":new Rn(Ee.layout_line["line-round-limit"]),"line-sort-key":new jn(Ee.layout_line["line-sort-key"])}),Mu={paint:new ai({"line-opacity":new jn(Ee.paint_line["line-opacity"]),"line-color":new jn(Ee.paint_line["line-color"]),"line-translate":new Rn(Ee.paint_line["line-translate"]),"line-translate-anchor":new Rn(Ee.paint_line["line-translate-anchor"]),"line-width":new jn(Ee.paint_line["line-width"]),"line-gap-width":new jn(Ee.paint_line["line-gap-width"]),"line-offset":new jn(Ee.paint_line["line-offset"]),"line-blur":new jn(Ee.paint_line["line-blur"]),"line-dasharray":new Js(Ee.paint_line["line-dasharray"]),"line-pattern":new Va(Ee.paint_line["line-pattern"]),"line-gradient":new Ji(Ee.paint_line["line-gradient"])}),layout:af},Kc=new(function(x){function P(){x.apply(this,arguments)}return x&&(P.__proto__=x),(P.prototype=Object.create(x&&x.prototype)).constructor=P,P.prototype.possiblyEvaluate=function(U,te){return te=new Ta(Math.floor(te.zoom),{now:te.now,fadeDuration:te.fadeDuration,zoomHistory:te.zoomHistory,transition:te.transition}),x.prototype.possiblyEvaluate.call(this,U,te)},P.prototype.evaluate=function(U,te,ce,pe){return te=d({},te,{zoom:Math.floor(te.zoom)}),x.prototype.evaluate.call(this,U,te,ce,pe)},P}(jn))(Mu.paint.properties["line-width"].specification);Kc.useIntegerZoom=!0;var Au=function(x){function P(U){x.call(this,U,Mu)}return x&&(P.__proto__=x),(P.prototype=Object.create(x&&x.prototype)).constructor=P,P.prototype._handleSpecialPaintPropertyUpdate=function(U){U==="line-gradient"&&this._updateGradient()},P.prototype._updateGradient=function(){this.gradient=Wu(this._transitionablePaint._values["line-gradient"].value.expression,"lineProgress"),this.gradientTexture=null},P.prototype.recalculate=function(U,te){x.prototype.recalculate.call(this,U,te),this.paint._values["line-floorwidth"]=Kc.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,U)},P.prototype.createBucket=function(U){return new zi(U)},P.prototype.queryRadius=function(U){var te=U,ce=ol(Fo("line-width",this,te),Fo("line-gap-width",this,te)),pe=Fo("line-offset",this,te);return ce/2+Math.abs(pe)+Bo(this.paint.get("line-translate"))},P.prototype.queryIntersectsFeature=function(U,te,ce,pe,Te,je,nt){var dt=Xa(U,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),je.angle,nt),yt=nt/2*ol(this.paint.get("line-width").evaluate(te,ce),this.paint.get("line-gap-width").evaluate(te,ce)),kt=this.paint.get("line-offset").evaluate(te,ce);return kt&&(pe=function(Lt,Rt){for(var rr=[],ar=new u(0,0),_r=0;_r<Lt.length;_r++){for(var dr=Lt[_r],Er=[],zr=0;zr<dr.length;zr++){var Ur=dr[zr],Vr=dr[zr+1],en=zr===0?ar:Ur.sub(dr[zr-1])._unit()._perp(),hn=zr===dr.length-1?ar:Vr.sub(Ur)._unit()._perp(),_n=en._add(hn)._unit();_n._mult(1/(_n.x*hn.x+_n.y*hn.y)),Er.push(_n._mult(Rt)._add(Ur))}rr.push(Er)}return rr}(pe,kt*nt)),function(Lt,Rt,rr){for(var ar=0;ar<Rt.length;ar++){var _r=Rt[ar];if(Lt.length>=3){for(var dr=0;dr<_r.length;dr++)if(Ro(Lt,_r[dr]))return!0}if(Si(Lt,_r,rr))return!0}return!1}(dt,pe,yt)},P.prototype.isTileClipped=function(){return!0},P}(Vi);function ol(x,P){return P>0?P+2*x:x}var rc=Ma([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Su=Ma([{name:"a_projected_pos",components:3,type:"Float32"}],4),Wf=(Ma([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),Ma([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),of=(Ma([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),Ma([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),sf=Ma([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Zf(x,P,U){return x.sections.forEach(function(te){te.text=function(ce,pe,Te){var je=pe.layout.get("text-transform").evaluate(Te,{});return je==="uppercase"?ce=ce.toLocaleUpperCase():je==="lowercase"&&(ce=ce.toLocaleLowerCase()),Za.applyArabicShaping&&(ce=Za.applyArabicShaping(ce)),ce}(te.text,P,U)}),x}Ma([{name:"triangle",components:3,type:"Uint16"}]),Ma([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Ma([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Ma([{type:"Float32",name:"offsetX"}]),Ma([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var Tc={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"},lf=function(x,P,U,te,ce){var pe,Te,je=8*ce-te-1,nt=(1<<je)-1,dt=nt>>1,yt=-7,kt=U?ce-1:0,Lt=U?-1:1,Rt=x[P+kt];for(kt+=Lt,pe=Rt&(1<<-yt)-1,Rt>>=-yt,yt+=je;yt>0;pe=256*pe+x[P+kt],kt+=Lt,yt-=8);for(Te=pe&(1<<-yt)-1,pe>>=-yt,yt+=te;yt>0;Te=256*Te+x[P+kt],kt+=Lt,yt-=8);if(pe===0)pe=1-dt;else{if(pe===nt)return Te?NaN:1/0*(Rt?-1:1);Te+=Math.pow(2,te),pe-=dt}return(Rt?-1:1)*Te*Math.pow(2,pe-te)},Z=function(x,P,U,te,ce,pe){var Te,je,nt,dt=8*pe-ce-1,yt=(1<<dt)-1,kt=yt>>1,Lt=ce===23?Math.pow(2,-24)-Math.pow(2,-77):0,Rt=te?0:pe-1,rr=te?1:-1,ar=P<0||P===0&&1/P<0?1:0;for(P=Math.abs(P),isNaN(P)||P===1/0?(je=isNaN(P)?1:0,Te=yt):(Te=Math.floor(Math.log(P)/Math.LN2),P*(nt=Math.pow(2,-Te))<1&&(Te--,nt*=2),(P+=Te+kt>=1?Lt/nt:Lt*Math.pow(2,1-kt))*nt>=2&&(Te++,nt/=2),Te+kt>=yt?(je=0,Te=yt):Te+kt>=1?(je=(P*nt-1)*Math.pow(2,ce),Te+=kt):(je=P*Math.pow(2,kt-1)*Math.pow(2,ce),Te=0));ce>=8;x[U+Rt]=255&je,Rt+=rr,je/=256,ce-=8);for(Te=Te<<ce|je,dt+=ce;dt>0;x[U+Rt]=255&Te,Rt+=rr,Te/=256,dt-=8);x[U+Rt-rr]|=128*ar},ne=se;function se(x){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(x)?x:new Uint8Array(x||0),this.pos=0,this.type=0,this.length=this.buf.length}se.Varint=0,se.Fixed64=1,se.Bytes=2,se.Fixed32=5;var he=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function ye(x){return x.type===se.Bytes?x.readVarint()+x.pos:x.pos+1}function Le(x,P,U){return U?4294967296*P+(x>>>0):4294967296*(P>>>0)+(x>>>0)}function Ve(x,P,U){var te=P<=16383?1:P<=2097151?2:P<=268435455?3:Math.floor(Math.log(P)/(7*Math.LN2));U.realloc(te);for(var ce=U.pos-1;ce>=x;ce--)U.buf[ce+te]=U.buf[ce]}function Xe(x,P){for(var U=0;U<x.length;U++)P.writeVarint(x[U])}function qe(x,P){for(var U=0;U<x.length;U++)P.writeSVarint(x[U])}function Qe(x,P){for(var U=0;U<x.length;U++)P.writeFloat(x[U])}function pt(x,P){for(var U=0;U<x.length;U++)P.writeDouble(x[U])}function Tt(x,P){for(var U=0;U<x.length;U++)P.writeBoolean(x[U])}function Ct(x,P){for(var U=0;U<x.length;U++)P.writeFixed32(x[U])}function jt(x,P){for(var U=0;U<x.length;U++)P.writeSFixed32(x[U])}function nr(x,P){for(var U=0;U<x.length;U++)P.writeFixed64(x[U])}function Vt(x,P){for(var U=0;U<x.length;U++)P.writeSFixed64(x[U])}function Xt(x,P){return(x[P]|x[P+1]<<8|x[P+2]<<16)+16777216*x[P+3]}function Ht(x,P,U){x[U]=P,x[U+1]=P>>>8,x[U+2]=P>>>16,x[U+3]=P>>>24}function pr(x,P){return(x[P]|x[P+1]<<8|x[P+2]<<16)+(x[P+3]<<24)}function Wt(x,P,U){x===1&&U.readMessage(Kt,P)}function Kt(x,P,U){if(x===3){var te=U.readMessage(Cr,{}),ce=te.width,pe=te.height,Te=te.left,je=te.top,nt=te.advance;P.push({id:te.id,bitmap:new vo({width:ce+6,height:pe+6},te.bitmap),metrics:{width:ce,height:pe,left:Te,top:je,advance:nt}})}}function Cr(x,P,U){x===1?P.id=U.readVarint():x===2?P.bitmap=U.readBytes():x===3?P.width=U.readVarint():x===4?P.height=U.readVarint():x===5?P.left=U.readSVarint():x===6?P.top=U.readSVarint():x===7&&(P.advance=U.readVarint())}function tr(x){for(var P=0,U=0,te=0,ce=x;te<ce.length;te+=1){var pe=ce[te];P+=pe.w*pe.h,U=Math.max(U,pe.w)}x.sort(function(ar,_r){return _r.h-ar.h});for(var Te=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(P/.95)),U),h:1/0}],je=0,nt=0,dt=0,yt=x;dt<yt.length;dt+=1)for(var kt=yt[dt],Lt=Te.length-1;Lt>=0;Lt--){var Rt=Te[Lt];if(!(kt.w>Rt.w||kt.h>Rt.h)){if(kt.x=Rt.x,kt.y=Rt.y,nt=Math.max(nt,kt.y+kt.h),je=Math.max(je,kt.x+kt.w),kt.w===Rt.w&&kt.h===Rt.h){var rr=Te.pop();Lt<Te.length&&(Te[Lt]=rr)}else kt.h===Rt.h?(Rt.x+=kt.w,Rt.w-=kt.w):kt.w===Rt.w?(Rt.y+=kt.h,Rt.h-=kt.h):(Te.push({x:Rt.x+kt.w,y:Rt.y,w:Rt.w-kt.w,h:kt.h}),Rt.y+=kt.h,Rt.h-=kt.h);break}}return{w:je,h:nt,fill:P/(je*nt)||0}}se.prototype={destroy:function(){this.buf=null},readFields:function(x,P,U){for(U=U||this.length;this.pos<U;){var te=this.readVarint(),ce=te>>3,pe=this.pos;this.type=7&te,x(ce,P,this),this.pos===pe&&this.skip(te)}return P},readMessage:function(x,P){return this.readFields(x,P,this.readVarint()+this.pos)},readFixed32:function(){var x=Xt(this.buf,this.pos);return this.pos+=4,x},readSFixed32:function(){var x=pr(this.buf,this.pos);return this.pos+=4,x},readFixed64:function(){var x=Xt(this.buf,this.pos)+4294967296*Xt(this.buf,this.pos+4);return this.pos+=8,x},readSFixed64:function(){var x=Xt(this.buf,this.pos)+4294967296*pr(this.buf,this.pos+4);return this.pos+=8,x},readFloat:function(){var x=lf(this.buf,this.pos,!0,23,4);return this.pos+=4,x},readDouble:function(){var x=lf(this.buf,this.pos,!0,52,8);return this.pos+=8,x},readVarint:function(x){var P,U,te=this.buf;return P=127&(U=te[this.pos++]),U<128?P:(P|=(127&(U=te[this.pos++]))<<7,U<128?P:(P|=(127&(U=te[this.pos++]))<<14,U<128?P:(P|=(127&(U=te[this.pos++]))<<21,U<128?P:function(ce,pe,Te){var je,nt,dt=Te.buf;if(je=(112&(nt=dt[Te.pos++]))>>4,nt<128||(je|=(127&(nt=dt[Te.pos++]))<<3,nt<128)||(je|=(127&(nt=dt[Te.pos++]))<<10,nt<128)||(je|=(127&(nt=dt[Te.pos++]))<<17,nt<128)||(je|=(127&(nt=dt[Te.pos++]))<<24,nt<128)||(je|=(1&(nt=dt[Te.pos++]))<<31,nt<128))return Le(ce,je,pe);throw new Error("Expected varint not more than 10 bytes")}(P|=(15&(U=te[this.pos]))<<28,x,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var x=this.readVarint();return x%2==1?(x+1)/-2:x/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var x=this.readVarint()+this.pos,P=this.pos;return this.pos=x,x-P>=12&&he?function(U,te,ce){return he.decode(U.subarray(te,ce))}(this.buf,P,x):function(U,te,ce){for(var pe="",Te=te;Te<ce;){var je,nt,dt,yt=U[Te],kt=null,Lt=yt>239?4:yt>223?3:yt>191?2:1;if(Te+Lt>ce)break;Lt===1?yt<128&&(kt=yt):Lt===2?(192&(je=U[Te+1]))==128&&(kt=(31&yt)<<6|63&je)<=127&&(kt=null):Lt===3?(nt=U[Te+2],(192&(je=U[Te+1]))==128&&(192&nt)==128&&((kt=(15&yt)<<12|(63&je)<<6|63&nt)<=2047||kt>=55296&&kt<=57343)&&(kt=null)):Lt===4&&(nt=U[Te+2],dt=U[Te+3],(192&(je=U[Te+1]))==128&&(192&nt)==128&&(192&dt)==128&&((kt=(15&yt)<<18|(63&je)<<12|(63&nt)<<6|63&dt)<=65535||kt>=1114112)&&(kt=null)),kt===null?(kt=65533,Lt=1):kt>65535&&(kt-=65536,pe+=String.fromCharCode(kt>>>10&1023|55296),kt=56320|1023&kt),pe+=String.fromCharCode(kt),Te+=Lt}return pe}(this.buf,P,x)},readBytes:function(){var x=this.readVarint()+this.pos,P=this.buf.subarray(this.pos,x);return this.pos=x,P},readPackedVarint:function(x,P){if(this.type!==se.Bytes)return x.push(this.readVarint(P));var U=ye(this);for(x=x||[];this.pos<U;)x.push(this.readVarint(P));return x},readPackedSVarint:function(x){if(this.type!==se.Bytes)return x.push(this.readSVarint());var P=ye(this);for(x=x||[];this.pos<P;)x.push(this.readSVarint());return x},readPackedBoolean:function(x){if(this.type!==se.Bytes)return x.push(this.readBoolean());var P=ye(this);for(x=x||[];this.pos<P;)x.push(this.readBoolean());return x},readPackedFloat:function(x){if(this.type!==se.Bytes)return x.push(this.readFloat());var P=ye(this);for(x=x||[];this.pos<P;)x.push(this.readFloat());return x},readPackedDouble:function(x){if(this.type!==se.Bytes)return x.push(this.readDouble());var P=ye(this);for(x=x||[];this.pos<P;)x.push(this.readDouble());return x},readPackedFixed32:function(x){if(this.type!==se.Bytes)return x.push(this.readFixed32());var P=ye(this);for(x=x||[];this.pos<P;)x.push(this.readFixed32());return x},readPackedSFixed32:function(x){if(this.type!==se.Bytes)return x.push(this.readSFixed32());var P=ye(this);for(x=x||[];this.pos<P;)x.push(this.readSFixed32());return x},readPackedFixed64:function(x){if(this.type!==se.Bytes)return x.push(this.readFixed64());var P=ye(this);for(x=x||[];this.pos<P;)x.push(this.readFixed64());return x},readPackedSFixed64:function(x){if(this.type!==se.Bytes)return x.push(this.readSFixed64());var P=ye(this);for(x=x||[];this.pos<P;)x.push(this.readSFixed64());return x},skip:function(x){var P=7&x;if(P===se.Varint)for(;this.buf[this.pos++]>127;);else if(P===se.Bytes)this.pos=this.readVarint()+this.pos;else if(P===se.Fixed32)this.pos+=4;else{if(P!==se.Fixed64)throw new Error("Unimplemented type: "+P);this.pos+=8}},writeTag:function(x,P){this.writeVarint(x<<3|P)},realloc:function(x){for(var P=this.length||16;P<this.pos+x;)P*=2;if(P!==this.length){var U=new Uint8Array(P);U.set(this.buf),this.buf=U,this.length=P}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(x){this.realloc(4),Ht(this.buf,x,this.pos),this.pos+=4},writeSFixed32:function(x){this.realloc(4),Ht(this.buf,x,this.pos),this.pos+=4},writeFixed64:function(x){this.realloc(8),Ht(this.buf,-1&x,this.pos),Ht(this.buf,Math.floor(x*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(x){this.realloc(8),Ht(this.buf,-1&x,this.pos),Ht(this.buf,Math.floor(x*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(x){(x=+x||0)>268435455||x<0?function(P,U){var te,ce;if(P>=0?(te=P%4294967296|0,ce=P/4294967296|0):(ce=~(-P/4294967296),4294967295^(te=~(-P%4294967296))?te=te+1|0:(te=0,ce=ce+1|0)),P>=18446744073709552e3||P<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");U.realloc(10),function(pe,Te,je){je.buf[je.pos++]=127&pe|128,pe>>>=7,je.buf[je.pos++]=127&pe|128,pe>>>=7,je.buf[je.pos++]=127&pe|128,pe>>>=7,je.buf[je.pos++]=127&pe|128,je.buf[je.pos]=127&(pe>>>=7)}(te,0,U),function(pe,Te){var je=(7&pe)<<4;Te.buf[Te.pos++]|=je|((pe>>>=3)?128:0),pe&&(Te.buf[Te.pos++]=127&pe|((pe>>>=7)?128:0),pe&&(Te.buf[Te.pos++]=127&pe|((pe>>>=7)?128:0),pe&&(Te.buf[Te.pos++]=127&pe|((pe>>>=7)?128:0),pe&&(Te.buf[Te.pos++]=127&pe|((pe>>>=7)?128:0),pe&&(Te.buf[Te.pos++]=127&pe)))))}(ce,U)}(x,this):(this.realloc(4),this.buf[this.pos++]=127&x|(x>127?128:0),x<=127||(this.buf[this.pos++]=127&(x>>>=7)|(x>127?128:0),x<=127||(this.buf[this.pos++]=127&(x>>>=7)|(x>127?128:0),x<=127||(this.buf[this.pos++]=x>>>7&127))))},writeSVarint:function(x){this.writeVarint(x<0?2*-x-1:2*x)},writeBoolean:function(x){this.writeVarint(!!x)},writeString:function(x){x=String(x),this.realloc(4*x.length),this.pos++;var P=this.pos;this.pos=function(te,ce,pe){for(var Te,je,nt=0;nt<ce.length;nt++){if((Te=ce.charCodeAt(nt))>55295&&Te<57344){if(!je){Te>56319||nt+1===ce.length?(te[pe++]=239,te[pe++]=191,te[pe++]=189):je=Te;continue}if(Te<56320){te[pe++]=239,te[pe++]=191,te[pe++]=189,je=Te;continue}Te=je-55296<<10|Te-56320|65536,je=null}else je&&(te[pe++]=239,te[pe++]=191,te[pe++]=189,je=null);Te<128?te[pe++]=Te:(Te<2048?te[pe++]=Te>>6|192:(Te<65536?te[pe++]=Te>>12|224:(te[pe++]=Te>>18|240,te[pe++]=Te>>12&63|128),te[pe++]=Te>>6&63|128),te[pe++]=63&Te|128)}return pe}(this.buf,x,this.pos);var U=this.pos-P;U>=128&&Ve(P,U,this),this.pos=P-1,this.writeVarint(U),this.pos+=U},writeFloat:function(x){this.realloc(4),Z(this.buf,x,this.pos,!0,23,4),this.pos+=4},writeDouble:function(x){this.realloc(8),Z(this.buf,x,this.pos,!0,52,8),this.pos+=8},writeBytes:function(x){var P=x.length;this.writeVarint(P),this.realloc(P);for(var U=0;U<P;U++)this.buf[this.pos++]=x[U]},writeRawMessage:function(x,P){this.pos++;var U=this.pos;x(P,this);var te=this.pos-U;te>=128&&Ve(U,te,this),this.pos=U-1,this.writeVarint(te),this.pos+=te},writeMessage:function(x,P,U){this.writeTag(x,se.Bytes),this.writeRawMessage(P,U)},writePackedVarint:function(x,P){P.length&&this.writeMessage(x,Xe,P)},writePackedSVarint:function(x,P){P.length&&this.writeMessage(x,qe,P)},writePackedBoolean:function(x,P){P.length&&this.writeMessage(x,Tt,P)},writePackedFloat:function(x,P){P.length&&this.writeMessage(x,Qe,P)},writePackedDouble:function(x,P){P.length&&this.writeMessage(x,pt,P)},writePackedFixed32:function(x,P){P.length&&this.writeMessage(x,Ct,P)},writePackedSFixed32:function(x,P){P.length&&this.writeMessage(x,jt,P)},writePackedFixed64:function(x,P){P.length&&this.writeMessage(x,nr,P)},writePackedSFixed64:function(x,P){P.length&&this.writeMessage(x,Vt,P)},writeBytesField:function(x,P){this.writeTag(x,se.Bytes),this.writeBytes(P)},writeFixed32Field:function(x,P){this.writeTag(x,se.Fixed32),this.writeFixed32(P)},writeSFixed32Field:function(x,P){this.writeTag(x,se.Fixed32),this.writeSFixed32(P)},writeFixed64Field:function(x,P){this.writeTag(x,se.Fixed64),this.writeFixed64(P)},writeSFixed64Field:function(x,P){this.writeTag(x,se.Fixed64),this.writeSFixed64(P)},writeVarintField:function(x,P){this.writeTag(x,se.Varint),this.writeVarint(P)},writeSVarintField:function(x,P){this.writeTag(x,se.Varint),this.writeSVarint(P)},writeStringField:function(x,P){this.writeTag(x,se.Bytes),this.writeString(P)},writeFloatField:function(x,P){this.writeTag(x,se.Fixed32),this.writeFloat(P)},writeDoubleField:function(x,P){this.writeTag(x,se.Fixed64),this.writeDouble(P)},writeBooleanField:function(x,P){this.writeVarintField(x,!!P)}};var mr=function(x,P){var U=P.pixelRatio,te=P.version,ce=P.stretchX,pe=P.stretchY,Te=P.content;this.paddedRect=x,this.pixelRatio=U,this.stretchX=ce,this.stretchY=pe,this.content=Te,this.version=te},wr={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};wr.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},wr.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},wr.tlbr.get=function(){return this.tl.concat(this.br)},wr.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(mr.prototype,wr);var Wr=function(x,P){var U={},te={};this.haveRenderCallbacks=[];var ce=[];this.addImages(x,U,ce),this.addImages(P,te,ce);var pe=tr(ce),Te=new Gi({width:pe.w||1,height:pe.h||1});for(var je in x){var nt=x[je],dt=U[je].paddedRect;Gi.copy(nt.data,Te,{x:0,y:0},{x:dt.x+1,y:dt.y+1},nt.data)}for(var yt in P){var kt=P[yt],Lt=te[yt].paddedRect,Rt=Lt.x+1,rr=Lt.y+1,ar=kt.data.width,_r=kt.data.height;Gi.copy(kt.data,Te,{x:0,y:0},{x:Rt,y:rr},kt.data),Gi.copy(kt.data,Te,{x:0,y:_r-1},{x:Rt,y:rr-1},{width:ar,height:1}),Gi.copy(kt.data,Te,{x:0,y:0},{x:Rt,y:rr+_r},{width:ar,height:1}),Gi.copy(kt.data,Te,{x:ar-1,y:0},{x:Rt-1,y:rr},{width:1,height:_r}),Gi.copy(kt.data,Te,{x:0,y:0},{x:Rt+ar,y:rr},{width:1,height:_r})}this.image=Te,this.iconPositions=U,this.patternPositions=te};Wr.prototype.addImages=function(x,P,U){for(var te in x){var ce=x[te],pe={x:0,y:0,w:ce.data.width+2,h:ce.data.height+2};U.push(pe),P[te]=new mr(pe,ce),ce.hasRenderCallback&&this.haveRenderCallbacks.push(te)}},Wr.prototype.patchUpdatedImages=function(x,P){for(var U in x.dispatchRenderCallbacks(this.haveRenderCallbacks),x.updatedImages)this.patchUpdatedImage(this.iconPositions[U],x.getImage(U),P),this.patchUpdatedImage(this.patternPositions[U],x.getImage(U),P)},Wr.prototype.patchUpdatedImage=function(x,P,U){if(x&&P&&x.version!==P.version){x.version=P.version;var te=x.tl;U.update(P.data,void 0,{x:te[0],y:te[1]})}},En("ImagePosition",mr),En("ImageAtlas",Wr);var Rr={horizontal:1,vertical:2,horizontalOnly:3},tn=function(){this.scale=1,this.fontStack="",this.imageName=null};tn.forText=function(x,P){var U=new tn;return U.scale=x||1,U.fontStack=P,U},tn.forImage=function(x){var P=new tn;return P.imageName=x,P};var jr=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function ln(x,P,U,te,ce,pe,Te,je,nt,dt,yt,kt,Lt,Rt,rr,ar){var _r,dr=jr.fromFeature(x,ce);kt===Rr.vertical&&dr.verticalizePunctuation();var Er=Za.processBidirectionalText,zr=Za.processStyledBidirectionalText;if(Er&&dr.sections.length===1){_r=[];for(var Ur=0,Vr=Er(dr.toString(),aa(dr,dt,pe,P,te,Rt,rr));Ur<Vr.length;Ur+=1){var en=Vr[Ur],hn=new jr;hn.text=en,hn.sections=dr.sections;for(var _n=0;_n<en.length;_n++)hn.sectionIndex.push(0);_r.push(hn)}}else if(zr){_r=[];for(var On=0,kn=zr(dr.text,dr.sectionIndex,aa(dr,dt,pe,P,te,Rt,rr));On<kn.length;On+=1){var Fn=kn[On],wn=new jr;wn.text=Fn[0],wn.sectionIndex=Fn[1],wn.sections=dr.sections,_r.push(wn)}}else _r=function(Cn,ca){for(var ea=[],ha=Cn.text,Nn=0,ga=0,Ca=ca;ga<Ca.length;ga+=1){var bi=Ca[ga];ea.push(Cn.substring(Nn,bi)),Nn=bi}return Nn<ha.length&&ea.push(Cn.substring(Nn,ha.length)),ea}(dr,aa(dr,dt,pe,P,te,Rt,rr));var ia=[],Yn={positionedLines:ia,text:dr.toString(),top:yt[1],bottom:yt[1],left:yt[0],right:yt[0],writingMode:kt,iconsInText:!1,verticalizable:!1};return function(Cn,ca,ea,ha,Nn,ga,Ca,bi,_i,La,li,Pa){for(var gi=0,Qi=-17,Ci=0,so=0,mi=bi==="right"?1:bi==="left"?0:.5,vi=0,ua=0,wa=Nn;ua<wa.length;ua+=1){var Ia=wa[ua];Ia.trim();var pa=Ia.getMaxScale(),ci=24*(pa-1),Yi={positionedGlyphs:[],lineOffset:0};Cn.positionedLines[vi]=Yi;var wi=Yi.positionedGlyphs,Ya=0;if(Ia.length()){for(var Ti=0;Ti<Ia.length();Ti++){var Oa=Ia.getSection(Ti),Qa=Ia.getSectionIndex(Ti),Go=Ia.getCharCode(Ti),sl=0,$a=null,ll=null,bs=null,au=24,Ec=!(_i===Rr.horizontal||!li&&!ql(Go)||li&&(Mn[Go]||(zl=Go,vn.Arabic(zl)||vn["Arabic Supplement"](zl)||vn["Arabic Extended-A"](zl)||vn["Arabic Presentation Forms-A"](zl)||vn["Arabic Presentation Forms-B"](zl))));if(Oa.imageName){var iu=ha[Oa.imageName];if(!iu)continue;bs=Oa.imageName,Cn.iconsInText=Cn.iconsInText||!0,ll=iu.paddedRect;var Ol=iu.displaySize;Oa.scale=24*Oa.scale/Pa,sl=ci+(24-Ol[1]*Oa.scale),au=($a={width:Ol[0],height:Ol[1],left:1,top:-3,advance:Ec?Ol[1]:Ol[0]}).advance;var ou=Ec?Ol[0]*Oa.scale-24*pa:Ol[1]*Oa.scale-24*pa;ou>0&&ou>Ya&&(Ya=ou)}else{var df=ea[Oa.fontStack],su=df&&df[Go];if(su&&su.rect)ll=su.rect,$a=su.metrics;else{var Lu=ca[Oa.fontStack],gf=Lu&&Lu[Go];if(!gf)continue;$a=gf.metrics}sl=24*(pa-Oa.scale)}Ec?(Cn.verticalizable=!0,wi.push({glyph:Go,imageName:bs,x:gi,y:Qi+sl,vertical:Ec,scale:Oa.scale,fontStack:Oa.fontStack,sectionIndex:Qa,metrics:$a,rect:ll}),gi+=au*Oa.scale+La):(wi.push({glyph:Go,imageName:bs,x:gi,y:Qi+sl,vertical:Ec,scale:Oa.scale,fontStack:Oa.fontStack,sectionIndex:Qa,metrics:$a,rect:ll}),gi+=$a.advance*Oa.scale+La)}wi.length!==0&&(Ci=Math.max(gi-La,Ci),xa(wi,0,wi.length-1,mi,Ya)),gi=0;var mf=ga*pa+Ya;Yi.lineOffset=Math.max(Ya,ci),Qi+=mf,so=Math.max(mf,so),++vi}else Qi+=ga,++vi}var zl,Pu=Qi- -17,lu=la(Ca),ac=lu.horizontalAlign,cu=lu.verticalAlign;(function(vf,yf,Iu,Ou,xf,zu,Du,Ru,bf){var uu,_f=(yf-Iu)*xf;uu=zu!==Du?-Ru*Ou- -17:(-Ou*bf+.5)*Du;for(var fu=0,Fu=vf;fu<Fu.length;fu+=1)for(var Cc=0,Bu=Fu[fu].positionedGlyphs;Cc<Bu.length;Cc+=1){var hu=Bu[Cc];hu.x+=_f,hu.y+=uu}})(Cn.positionedLines,mi,ac,cu,Ci,so,ga,Pu,Nn.length),Cn.top+=-cu*Pu,Cn.bottom=Cn.top+Pu,Cn.left+=-ac*Ci,Cn.right=Cn.left+Ci}(Yn,P,U,te,_r,Te,je,nt,kt,dt,Lt,ar),!function(Cn){for(var ca=0,ea=Cn;ca<ea.length;ca+=1)if(ea[ca].positionedGlyphs.length!==0)return!1;return!0}(ia)&&Yn}jr.fromFeature=function(x,P){for(var U=new jr,te=0;te<x.sections.length;te++){var ce=x.sections[te];ce.image?U.addImageSection(ce):U.addTextSection(ce,P)}return U},jr.prototype.length=function(){return this.text.length},jr.prototype.getSection=function(x){return this.sections[this.sectionIndex[x]]},jr.prototype.getSectionIndex=function(x){return this.sectionIndex[x]},jr.prototype.getCharCode=function(x){return this.text.charCodeAt(x)},jr.prototype.verticalizePunctuation=function(){this.text=function(x){for(var P="",U=0;U<x.length;U++){var te=x.charCodeAt(U+1)||null,ce=x.charCodeAt(U-1)||null;P+=te&&Hl(te)&&!Tc[x[U+1]]||ce&&Hl(ce)&&!Tc[x[U-1]]||!Tc[x[U]]?x[U]:Tc[x[U]]}return P}(this.text)},jr.prototype.trim=function(){for(var x=0,P=0;P<this.text.length&&Mn[this.text.charCodeAt(P)];P++)x++;for(var U=this.text.length,te=this.text.length-1;te>=0&&te>=x&&Mn[this.text.charCodeAt(te)];te--)U--;this.text=this.text.substring(x,U),this.sectionIndex=this.sectionIndex.slice(x,U)},jr.prototype.substring=function(x,P){var U=new jr;return U.text=this.text.substring(x,P),U.sectionIndex=this.sectionIndex.slice(x,P),U.sections=this.sections,U},jr.prototype.toString=function(){return this.text},jr.prototype.getMaxScale=function(){var x=this;return this.sectionIndex.reduce(function(P,U){return Math.max(P,x.sections[U].scale)},0)},jr.prototype.addTextSection=function(x,P){this.text+=x.text,this.sections.push(tn.forText(x.scale,x.fontStack||P));for(var U=this.sections.length-1,te=0;te<x.text.length;++te)this.sectionIndex.push(U)},jr.prototype.addImageSection=function(x){var P=x.image?x.image.name:"";if(P.length!==0){var U=this.getNextImageSectionCharCode();U?(this.text+=String.fromCharCode(U),this.sections.push(tn.forImage(P)),this.sectionIndex.push(this.sections.length-1)):S("Reached maximum number of images 6401")}else S("Can't add FormattedSection with an empty image.")},jr.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var Mn={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},An={};function $r(x,P,U,te,ce,pe){if(P.imageName){var Te=te[P.imageName];return Te?Te.displaySize[0]*P.scale*24/pe+ce:0}var je=U[P.fontStack],nt=je&&je[x];return nt?nt.metrics.advance*P.scale+ce:0}function Tn(x,P,U,te){var ce=Math.pow(x-P,2);return te?x<P?ce/2:2*ce:ce+Math.abs(U)*U}function Xn(x,P,U){var te=0;return x===10&&(te-=1e4),U&&(te+=150),x!==40&&x!==65288||(te+=50),P!==41&&P!==65289||(te+=50),te}function Bn(x,P,U,te,ce,pe){for(var Te=null,je=Tn(P,U,ce,pe),nt=0,dt=te;nt<dt.length;nt+=1){var yt=dt[nt],kt=Tn(P-yt.x,U,ce,pe)+yt.badness;kt<=je&&(Te=yt,je=kt)}return{index:x,x:P,priorBreak:Te,badness:je}}function aa(x,P,U,te,ce,pe,Te){if(pe!=="point")return[];if(!x)return[];for(var je,nt=[],dt=function(_r,dr,Er,zr,Ur,Vr){for(var en=0,hn=0;hn<_r.length();hn++){var _n=_r.getSection(hn);en+=$r(_r.getCharCode(hn),_n,zr,Ur,dr,Vr)}return en/Math.max(1,Math.ceil(en/Er))}(x,P,U,te,ce,Te),yt=x.text.indexOf("\u200B")>=0,kt=0,Lt=0;Lt<x.length();Lt++){var Rt=x.getSection(Lt),rr=x.getCharCode(Lt);if(Mn[rr]||(kt+=$r(rr,Rt,te,ce,P,Te)),Lt<x.length()-1){var ar=!((je=rr)<11904||!(vn["Bopomofo Extended"](je)||vn.Bopomofo(je)||vn["CJK Compatibility Forms"](je)||vn["CJK Compatibility Ideographs"](je)||vn["CJK Compatibility"](je)||vn["CJK Radicals Supplement"](je)||vn["CJK Strokes"](je)||vn["CJK Symbols and Punctuation"](je)||vn["CJK Unified Ideographs Extension A"](je)||vn["CJK Unified Ideographs"](je)||vn["Enclosed CJK Letters and Months"](je)||vn["Halfwidth and Fullwidth Forms"](je)||vn.Hiragana(je)||vn["Ideographic Description Characters"](je)||vn["Kangxi Radicals"](je)||vn["Katakana Phonetic Extensions"](je)||vn.Katakana(je)||vn["Vertical Forms"](je)||vn["Yi Radicals"](je)||vn["Yi Syllables"](je)));(An[rr]||ar||Rt.imageName)&&nt.push(Bn(Lt+1,kt,dt,nt,Xn(rr,x.getCharCode(Lt+1),ar&&yt),!1))}}return function _r(dr){return dr?_r(dr.priorBreak).concat(dr.index):[]}(Bn(x.length(),kt,dt,nt,0,!0))}function la(x){var P=.5,U=.5;switch(x){case"right":case"top-right":case"bottom-right":P=1;break;case"left":case"top-left":case"bottom-left":P=0}switch(x){case"bottom":case"bottom-right":case"bottom-left":U=1;break;case"top":case"top-right":case"top-left":U=0}return{horizontalAlign:P,verticalAlign:U}}function xa(x,P,U,te,ce){if(te||ce)for(var pe=x[U],Te=(x[U].x+pe.metrics.advance*pe.scale)*te,je=P;je<=U;je++)x[je].x-=Te,x[je].y+=ce}function ka(x,P,U,te,ce,pe){var Te,je=x.image;if(je.content){var nt=je.content,dt=je.pixelRatio||1;Te=[nt[0]/dt,nt[1]/dt,je.displaySize[0]-nt[2]/dt,je.displaySize[1]-nt[3]/dt]}var yt,kt,Lt,Rt,rr=P.left*pe,ar=P.right*pe;U==="width"||U==="both"?(Rt=ce[0]+rr-te[3],kt=ce[0]+ar+te[1]):kt=(Rt=ce[0]+(rr+ar-je.displaySize[0])/2)+je.displaySize[0];var _r=P.top*pe,dr=P.bottom*pe;return U==="height"||U==="both"?(yt=ce[1]+_r-te[0],Lt=ce[1]+dr+te[2]):Lt=(yt=ce[1]+(_r+dr-je.displaySize[1])/2)+je.displaySize[1],{image:je,top:yt,right:kt,bottom:Lt,left:Rt,collisionPadding:Te}}An[10]=!0,An[32]=!0,An[38]=!0,An[40]=!0,An[41]=!0,An[43]=!0,An[45]=!0,An[47]=!0,An[173]=!0,An[183]=!0,An[8203]=!0,An[8208]=!0,An[8211]=!0,An[8231]=!0;var Na=function(x){function P(U,te,ce,pe){x.call(this,U,te),this.angle=ce,pe!==void 0&&(this.segment=pe)}return x&&(P.__proto__=x),(P.prototype=Object.create(x&&x.prototype)).constructor=P,P.prototype.clone=function(){return new P(this.x,this.y,this.angle,this.segment)},P}(u);function ii(x,P){var U=P.expression;if(U.kind==="constant")return{kind:"constant",layoutSize:U.evaluate(new Ta(x+1))};if(U.kind==="source")return{kind:"source"};for(var te=U.zoomStops,ce=U.interpolationType,pe=0;pe<te.length&&te[pe]<=x;)pe++;for(var Te=pe=Math.max(0,pe-1);Te<te.length&&te[Te]<x+1;)Te++;Te=Math.min(te.length-1,Te);var je=te[pe],nt=te[Te];return U.kind==="composite"?{kind:"composite",minZoom:je,maxZoom:nt,interpolationType:ce}:{kind:"camera",minZoom:je,maxZoom:nt,minSize:U.evaluate(new Ta(je)),maxSize:U.evaluate(new Ta(nt)),interpolationType:ce}}function Ki(x,P,U){var te=P.uSize,ce=U.lowerSize;return x.kind==="source"?ce/128:x.kind==="composite"?gn(ce/128,U.upperSize/128,P.uSizeT):te}function xi(x,P){var U=0,te=0;if(x.kind==="constant")te=x.layoutSize;else if(x.kind!=="source"){var ce=x.interpolationType,pe=ce?f(Ua.interpolationFactor(ce,P,x.minZoom,x.maxZoom),0,1):0;x.kind==="camera"?te=gn(x.minSize,x.maxSize,pe):U=pe}return{uSizeT:U,uSize:te}}En("Anchor",Na);var oi=Object.freeze({__proto__:null,getSizeData:ii,evaluateSizeForFeature:Ki,evaluateSizeForZoom:xi,SIZE_PACK_FACTOR:128});function oo(x,P,U,te,ce){if(P.segment===void 0)return!0;for(var pe=P,Te=P.segment+1,je=0;je>-U/2;){if(--Te<0)return!1;je-=x[Te].dist(pe),pe=x[Te]}je+=x[Te].dist(x[Te+1]),Te++;for(var nt=[],dt=0;je<U/2;){var yt=x[Te],kt=x[Te+1];if(!kt)return!1;var Lt=x[Te-1].angleTo(yt)-yt.angleTo(kt);for(Lt=Math.abs((Lt+3*Math.PI)%(2*Math.PI)-Math.PI),nt.push({distance:je,angleDelta:Lt}),dt+=Lt;je-nt[0].distance>te;)dt-=nt.shift().angleDelta;if(dt>ce)return!1;Te++,je+=yt.dist(kt)}return!0}function Vo(x){for(var P=0,U=0;U<x.length-1;U++)P+=x[U].dist(x[U+1]);return P}function si(x,P,U){return x?.6*P*U:0}function hi(x,P){return Math.max(x?x.right-x.left:0,P?P.right-P.left:0)}function Di(x,P,U,te,ce,pe){for(var Te=si(U,ce,pe),je=hi(U,te)*pe,nt=0,dt=Vo(x)/2,yt=0;yt<x.length-1;yt++){var kt=x[yt],Lt=x[yt+1],Rt=kt.dist(Lt);if(nt+Rt>dt){var rr=(dt-nt)/Rt,ar=gn(kt.x,Lt.x,rr),_r=gn(kt.y,Lt.y,rr),dr=new Na(ar,_r,Lt.angleTo(kt),yt);return dr._round(),!Te||oo(x,dr,je,Te,P)?dr:void 0}nt+=Rt}}function qo(x,P,U,te,ce,pe,Te,je,nt){var dt=si(te,pe,Te),yt=hi(te,ce),kt=yt*Te,Lt=x[0].x===0||x[0].x===nt||x[0].y===0||x[0].y===nt;return P-kt<P/4&&(P=kt+P/4),function Rt(rr,ar,_r,dr,Er,zr,Ur,Vr,en){for(var hn=zr/2,_n=Vo(rr),On=0,kn=ar-_r,Fn=[],wn=0;wn<rr.length-1;wn++){for(var ia=rr[wn],Yn=rr[wn+1],Cn=ia.dist(Yn),ca=Yn.angleTo(ia);kn+_r<On+Cn;){var ea=((kn+=_r)-On)/Cn,ha=gn(ia.x,Yn.x,ea),Nn=gn(ia.y,Yn.y,ea);if(ha>=0&&ha<en&&Nn>=0&&Nn<en&&kn-hn>=0&&kn+hn<=_n){var ga=new Na(ha,Nn,ca,wn);ga._round(),dr&&!oo(rr,ga,zr,dr,Er)||Fn.push(ga)}}On+=Cn}return Vr||Fn.length||Ur||(Fn=Rt(rr,On/2,_r,dr,Er,zr,Ur,!0,en)),Fn}(x,Lt?P/2*je%P:(yt/2+2*pe)*Te*je%P,P,dt,U,kt,Lt,!1,nt)}function Ho(x,P,U,te,ce){for(var pe=[],Te=0;Te<x.length;Te++)for(var je=x[Te],nt=void 0,dt=0;dt<je.length-1;dt++){var yt=je[dt],kt=je[dt+1];yt.x<P&&kt.x<P||(yt.x<P?yt=new u(P,yt.y+(P-yt.x)/(kt.x-yt.x)*(kt.y-yt.y))._round():kt.x<P&&(kt=new u(P,yt.y+(P-yt.x)/(kt.x-yt.x)*(kt.y-yt.y))._round()),yt.y<U&&kt.y<U||(yt.y<U?yt=new u(yt.x+(U-yt.y)/(kt.y-yt.y)*(kt.x-yt.x),U)._round():kt.y<U&&(kt=new u(yt.x+(U-yt.y)/(kt.y-yt.y)*(kt.x-yt.x),U)._round()),yt.x>=te&&kt.x>=te||(yt.x>=te?yt=new u(te,yt.y+(te-yt.x)/(kt.x-yt.x)*(kt.y-yt.y))._round():kt.x>=te&&(kt=new u(te,yt.y+(te-yt.x)/(kt.x-yt.x)*(kt.y-yt.y))._round()),yt.y>=ce&&kt.y>=ce||(yt.y>=ce?yt=new u(yt.x+(ce-yt.y)/(kt.y-yt.y)*(kt.x-yt.x),ce)._round():kt.y>=ce&&(kt=new u(yt.x+(ce-yt.y)/(kt.y-yt.y)*(kt.x-yt.x),ce)._round()),nt&&yt.equals(nt[nt.length-1])||pe.push(nt=[yt]),nt.push(kt)))))}return pe}function Cl(x,P,U,te){var ce=[],pe=x.image,Te=pe.pixelRatio,je=pe.paddedRect.w-2,nt=pe.paddedRect.h-2,dt=x.right-x.left,yt=x.bottom-x.top,kt=pe.stretchX||[[0,je]],Lt=pe.stretchY||[[0,nt]],Rt=function(ha,Nn){return ha+Nn[1]-Nn[0]},rr=kt.reduce(Rt,0),ar=Lt.reduce(Rt,0),_r=je-rr,dr=nt-ar,Er=0,zr=rr,Ur=0,Vr=ar,en=0,hn=_r,_n=0,On=dr;if(pe.content&&te){var kn=pe.content;Er=xs(kt,0,kn[0]),Ur=xs(Lt,0,kn[1]),zr=xs(kt,kn[0],kn[2]),Vr=xs(Lt,kn[1],kn[3]),en=kn[0]-Er,_n=kn[1]-Ur,hn=kn[2]-kn[0]-zr,On=kn[3]-kn[1]-Vr}var Fn=function(ha,Nn,ga,Ca){var bi=Ll(ha.stretch-Er,zr,dt,x.left),_i=kc(ha.fixed-en,hn,ha.stretch,rr),La=Ll(Nn.stretch-Ur,Vr,yt,x.top),li=kc(Nn.fixed-_n,On,Nn.stretch,ar),Pa=Ll(ga.stretch-Er,zr,dt,x.left),gi=kc(ga.fixed-en,hn,ga.stretch,rr),Qi=Ll(Ca.stretch-Ur,Vr,yt,x.top),Ci=kc(Ca.fixed-_n,On,Ca.stretch,ar),so=new u(bi,La),mi=new u(Pa,La),vi=new u(Pa,Qi),ua=new u(bi,Qi),wa=new u(_i/Te,li/Te),Ia=new u(gi/Te,Ci/Te),pa=P*Math.PI/180;if(pa){var ci=Math.sin(pa),Yi=Math.cos(pa),wi=[Yi,-ci,ci,Yi];so._matMult(wi),mi._matMult(wi),ua._matMult(wi),vi._matMult(wi)}var Ya=ha.stretch+ha.fixed,Ti=Nn.stretch+Nn.fixed;return{tl:so,tr:mi,bl:ua,br:vi,tex:{x:pe.paddedRect.x+1+Ya,y:pe.paddedRect.y+1+Ti,w:ga.stretch+ga.fixed-Ya,h:Ca.stretch+Ca.fixed-Ti},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:wa,pixelOffsetBR:Ia,minFontScaleX:hn/Te/dt,minFontScaleY:On/Te/yt,isSDF:U}};if(te&&(pe.stretchX||pe.stretchY))for(var wn=Fs(kt,_r,rr),ia=Fs(Lt,dr,ar),Yn=0;Yn<wn.length-1;Yn++)for(var Cn=wn[Yn],ca=wn[Yn+1],ea=0;ea<ia.length-1;ea++)ce.push(Fn(Cn,ia[ea],ca,ia[ea+1]));else ce.push(Fn({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:je+1},{fixed:0,stretch:nt+1}));return ce}function xs(x,P,U){for(var te=0,ce=0,pe=x;ce<pe.length;ce+=1){var Te=pe[ce];te+=Math.max(P,Math.min(U,Te[1]))-Math.max(P,Math.min(U,Te[0]))}return te}function Fs(x,P,U){for(var te=[{fixed:-1,stretch:0}],ce=0,pe=x;ce<pe.length;ce+=1){var Te=pe[ce],je=Te[0],nt=Te[1],dt=te[te.length-1];te.push({fixed:je-dt.stretch,stretch:dt.stretch}),te.push({fixed:je-dt.stretch,stretch:dt.stretch+(nt-je)})}return te.push({fixed:P+1,stretch:U}),te}function Ll(x,P,U,te){return x/P*U+te}function kc(x,P,U,te){return x-P*U/te}var cf=function(x,P,U,te,ce,pe,Te,je,nt,dt){if(this.boxStartIndex=x.length,nt){var yt=pe.top,kt=pe.bottom,Lt=pe.collisionPadding;Lt&&(yt-=Lt[1],kt+=Lt[3]);var Rt=kt-yt;Rt>0&&(Rt=Math.max(10,Rt),this.circleDiameter=Rt)}else{var rr=pe.top*Te-je,ar=pe.bottom*Te+je,_r=pe.left*Te-je,dr=pe.right*Te+je,Er=pe.collisionPadding;if(Er&&(_r-=Er[0]*Te,rr-=Er[1]*Te,dr+=Er[2]*Te,ar+=Er[3]*Te),dt){var zr=new u(_r,rr),Ur=new u(dr,rr),Vr=new u(_r,ar),en=new u(dr,ar),hn=dt*Math.PI/180;zr._rotate(hn),Ur._rotate(hn),Vr._rotate(hn),en._rotate(hn),_r=Math.min(zr.x,Ur.x,Vr.x,en.x),dr=Math.max(zr.x,Ur.x,Vr.x,en.x),rr=Math.min(zr.y,Ur.y,Vr.y,en.y),ar=Math.max(zr.y,Ur.y,Vr.y,en.y)}x.emplaceBack(P.x,P.y,_r,rr,dr,ar,U,te,ce)}this.boxEndIndex=x.length},Qc=function(x,P){if(x===void 0&&(x=[]),P===void 0&&(P=fp),this.data=x,this.length=this.data.length,this.compare=P,this.length>0)for(var U=(this.length>>1)-1;U>=0;U--)this._down(U)};function fp(x,P){return x<P?-1:x>P?1:0}function hp(x,P,U){P===void 0&&(P=1),U===void 0&&(U=!1);for(var te=1/0,ce=1/0,pe=-1/0,Te=-1/0,je=x[0],nt=0;nt<je.length;nt++){var dt=je[nt];(!nt||dt.x<te)&&(te=dt.x),(!nt||dt.y<ce)&&(ce=dt.y),(!nt||dt.x>pe)&&(pe=dt.x),(!nt||dt.y>Te)&&(Te=dt.y)}var yt=Math.min(pe-te,Te-ce),kt=yt/2,Lt=new Qc([],pp);if(yt===0)return new u(te,ce);for(var Rt=te;Rt<pe;Rt+=yt)for(var rr=ce;rr<Te;rr+=yt)Lt.push(new $c(Rt+kt,rr+kt,kt,x));for(var ar=function(Er){for(var zr=0,Ur=0,Vr=0,en=Er[0],hn=0,_n=en.length,On=_n-1;hn<_n;On=hn++){var kn=en[hn],Fn=en[On],wn=kn.x*Fn.y-Fn.x*kn.y;Ur+=(kn.x+Fn.x)*wn,Vr+=(kn.y+Fn.y)*wn,zr+=3*wn}return new $c(Ur/zr,Vr/zr,0,Er)}(x),_r=Lt.length;Lt.length;){var dr=Lt.pop();(dr.d>ar.d||!ar.d)&&(ar=dr,U&&console.log("found best %d after %d probes",Math.round(1e4*dr.d)/1e4,_r)),dr.max-ar.d<=P||(Lt.push(new $c(dr.p.x-(kt=dr.h/2),dr.p.y-kt,kt,x)),Lt.push(new $c(dr.p.x+kt,dr.p.y-kt,kt,x)),Lt.push(new $c(dr.p.x-kt,dr.p.y+kt,kt,x)),Lt.push(new $c(dr.p.x+kt,dr.p.y+kt,kt,x)),_r+=4)}return U&&(console.log("num probes: "+_r),console.log("best distance: "+ar.d)),ar.p}function pp(x,P){return P.max-x.max}function $c(x,P,U,te){this.p=new u(x,P),this.h=U,this.d=function(ce,pe){for(var Te=!1,je=1/0,nt=0;nt<pe.length;nt++)for(var dt=pe[nt],yt=0,kt=dt.length,Lt=kt-1;yt<kt;Lt=yt++){var Rt=dt[yt],rr=dt[Lt];Rt.y>ce.y!=rr.y>ce.y&&ce.x<(rr.x-Rt.x)*(ce.y-Rt.y)/(rr.y-Rt.y)+Rt.x&&(Te=!Te),je=Math.min(je,ms(ce,Rt,rr))}return(Te?1:-1)*Math.sqrt(je)}(this.p,te),this.max=this.d+this.h*Math.SQRT2}Qc.prototype.push=function(x){this.data.push(x),this.length++,this._up(this.length-1)},Qc.prototype.pop=function(){if(this.length!==0){var x=this.data[0],P=this.data.pop();return this.length--,this.length>0&&(this.data[0]=P,this._down(0)),x}},Qc.prototype.peek=function(){return this.data[0]},Qc.prototype._up=function(x){for(var P=this.data,U=this.compare,te=P[x];x>0;){var ce=x-1>>1,pe=P[ce];if(U(te,pe)>=0)break;P[x]=pe,x=ce}P[x]=te},Qc.prototype._down=function(x){for(var P=this.data,U=this.compare,te=this.length>>1,ce=P[x];x<te;){var pe=1+(x<<1),Te=P[pe],je=pe+1;if(je<this.length&&U(P[je],Te)<0&&(pe=je,Te=P[je]),U(Te,ce)>=0)break;P[x]=Te,x=pe}P[x]=ce};var Xf=Number.POSITIVE_INFINITY;function gh(x,P){return P[1]!==Xf?function(U,te,ce){var pe=0,Te=0;switch(te=Math.abs(te),ce=Math.abs(ce),U){case"top-right":case"top-left":case"top":Te=ce-7;break;case"bottom-right":case"bottom-left":case"bottom":Te=7-ce}switch(U){case"top-right":case"bottom-right":case"right":pe=-te;break;case"top-left":case"bottom-left":case"left":pe=te}return[pe,Te]}(x,P[0],P[1]):function(U,te){var ce=0,pe=0;te<0&&(te=0);var Te=te/Math.sqrt(2);switch(U){case"top-right":case"top-left":pe=Te-7;break;case"bottom-right":case"bottom-left":pe=7-Te;break;case"bottom":pe=7-te;break;case"top":pe=te-7}switch(U){case"top-right":case"bottom-right":ce=-Te;break;case"top-left":case"bottom-left":ce=Te;break;case"left":ce=te;break;case"right":ce=-te}return[ce,pe]}(x,P[0])}function Jf(x){switch(x){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function mh(x,P,U,te,ce,pe,Te,je,nt,dt,yt,kt,Lt,Rt,rr){var ar=function(Ur,Vr,en,hn,_n,On,kn,Fn){for(var wn=hn.layout.get("text-rotate").evaluate(On,{})*Math.PI/180,ia=[],Yn=0,Cn=Vr.positionedLines;Yn<Cn.length;Yn+=1)for(var ca=Cn[Yn],ea=0,ha=ca.positionedGlyphs;ea<ha.length;ea+=1){var Nn=ha[ea];if(Nn.rect){var ga=Nn.rect||{},Ca=4,bi=!0,_i=1,La=0,li=(_n||Fn)&&Nn.vertical,Pa=Nn.metrics.advance*Nn.scale/2;if(Fn&&Vr.verticalizable&&(La=ca.lineOffset/2-(Nn.imageName?-(24-Nn.metrics.width*Nn.scale)/2:24*(Nn.scale-1))),Nn.imageName){var gi=kn[Nn.imageName];bi=gi.sdf,Ca=1/(_i=gi.pixelRatio)}var Qi=_n?[Nn.x+Pa,Nn.y]:[0,0],Ci=_n?[0,0]:[Nn.x+Pa+en[0],Nn.y+en[1]-La],so=[0,0];li&&(so=Ci,Ci=[0,0]);var mi=(Nn.metrics.left-Ca)*Nn.scale-Pa+Ci[0],vi=(-Nn.metrics.top-Ca)*Nn.scale+Ci[1],ua=mi+ga.w*Nn.scale/_i,wa=vi+ga.h*Nn.scale/_i,Ia=new u(mi,vi),pa=new u(ua,vi),ci=new u(mi,wa),Yi=new u(ua,wa);if(li){var wi=new u(-Pa,Pa- -17),Ya=-Math.PI/2,Ti=12-Pa,Oa=new u(22-Ti,-(Nn.imageName?Ti:0)),Qa=new(Function.prototype.bind.apply(u,[null].concat(so)));Ia._rotateAround(Ya,wi)._add(Oa)._add(Qa),pa._rotateAround(Ya,wi)._add(Oa)._add(Qa),ci._rotateAround(Ya,wi)._add(Oa)._add(Qa),Yi._rotateAround(Ya,wi)._add(Oa)._add(Qa)}if(wn){var Go=Math.sin(wn),sl=Math.cos(wn),$a=[sl,-Go,Go,sl];Ia._matMult($a),pa._matMult($a),ci._matMult($a),Yi._matMult($a)}var ll=new u(0,0),bs=new u(0,0);ia.push({tl:Ia,tr:pa,bl:ci,br:Yi,tex:ga,writingMode:Vr.writingMode,glyphOffset:Qi,sectionIndex:Nn.sectionIndex,isSDF:bi,pixelOffsetTL:ll,pixelOffsetBR:bs,minFontScaleX:0,minFontScaleY:0})}}return ia}(0,U,je,ce,pe,Te,te,x.allowVerticalPlacement),_r=x.textSizeData,dr=null;_r.kind==="source"?(dr=[128*ce.layout.get("text-size").evaluate(Te,{})])[0]>32640&&S(x.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):_r.kind==="composite"&&((dr=[128*Rt.compositeTextSizes[0].evaluate(Te,{},rr),128*Rt.compositeTextSizes[1].evaluate(Te,{},rr)])[0]>32640||dr[1]>32640)&&S(x.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),x.addSymbols(x.text,ar,dr,je,pe,Te,dt,P,nt.lineStartIndex,nt.lineLength,Lt,rr);for(var Er=0,zr=yt;Er<zr.length;Er+=1)kt[zr[Er]]=x.text.placedSymbolArray.length-1;return 4*ar.length}function vh(x){for(var P in x)return x[P];return null}function dp(x,P,U,te){var ce=x.compareText;if(P in ce){for(var pe=ce[P],Te=pe.length-1;Te>=0;Te--)if(te.dist(pe[Te])<U)return!0}else ce[P]=[];return ce[P].push(te),!1}var gp=Uo.VectorTileFeature.types,mp=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function uf(x,P,U,te,ce,pe,Te,je,nt,dt,yt,kt,Lt){var Rt=je?Math.min(32640,Math.round(je[0])):0,rr=je?Math.min(32640,Math.round(je[1])):0;x.emplaceBack(P,U,Math.round(32*te),Math.round(32*ce),pe,Te,(Rt<<1)+(nt?1:0),rr,16*dt,16*yt,256*kt,256*Lt)}function Kf(x,P,U){x.emplaceBack(P.x,P.y,U),x.emplaceBack(P.x,P.y,U),x.emplaceBack(P.x,P.y,U),x.emplaceBack(P.x,P.y,U)}function vp(x){for(var P=0,U=x.sections;P<U.length;P+=1)if(ji(U[P].text))return!0;return!1}var eu=function(x){this.layoutVertexArray=new $s,this.indexArray=new qi,this.programConfigurations=x,this.segments=new Gt,this.dynamicLayoutVertexArray=new ds,this.opacityVertexArray=new gs,this.placedSymbolArray=new re};eu.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},eu.prototype.upload=function(x,P,U,te){this.isEmpty()||(U&&(this.layoutVertexBuffer=x.createVertexBuffer(this.layoutVertexArray,rc.members),this.indexBuffer=x.createIndexBuffer(this.indexArray,P),this.dynamicLayoutVertexBuffer=x.createVertexBuffer(this.dynamicLayoutVertexArray,Su.members,!0),this.opacityVertexBuffer=x.createVertexBuffer(this.opacityVertexArray,mp,!0),this.opacityVertexBuffer.itemSize=1),(U||te)&&this.programConfigurations.upload(x))},eu.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},En("SymbolBuffers",eu);var Eu=function(x,P,U){this.layoutVertexArray=new x,this.layoutAttributes=P,this.indexArray=new U,this.segments=new Gt,this.collisionVertexArray=new _l};Eu.prototype.upload=function(x){this.layoutVertexBuffer=x.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=x.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=x.createVertexBuffer(this.collisionVertexArray,Wf.members,!0)},Eu.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},En("CollisionBuffers",Eu);var _a=function(x){this.collisionBoxArray=x.collisionBoxArray,this.zoom=x.zoom,this.overscaling=x.overscaling,this.layers=x.layers,this.layerIds=this.layers.map(function(pe){return pe.id}),this.index=x.index,this.pixelRatio=x.pixelRatio,this.sourceLayerIndex=x.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=vs([]),this.placementViewportMatrix=vs([]);var P=this.layers[0]._unevaluatedLayout._values;this.textSizeData=ii(this.zoom,P["text-size"]),this.iconSizeData=ii(this.zoom,P["icon-size"]);var U=this.layers[0].layout,te=U.get("symbol-sort-key"),ce=U.get("symbol-z-order");this.sortFeaturesByKey=ce!=="viewport-y"&&te.constantOr(1)!==void 0,this.sortFeaturesByY=(ce==="viewport-y"||ce==="auto"&&!this.sortFeaturesByKey)&&(U.get("text-allow-overlap")||U.get("icon-allow-overlap")||U.get("text-ignore-placement")||U.get("icon-ignore-placement")),U.get("symbol-placement")==="point"&&(this.writingModes=U.get("text-writing-mode").map(function(pe){return Rr[pe]})),this.stateDependentLayerIds=this.layers.filter(function(pe){return pe.isStateDependent()}).map(function(pe){return pe.id}),this.sourceID=x.sourceID};_a.prototype.createArrays=function(){this.text=new eu(new qn(rc.members,this.layers,this.zoom,function(x){return/^text/.test(x)})),this.icon=new eu(new qn(rc.members,this.layers,this.zoom,function(x){return/^icon/.test(x)})),this.glyphOffsetArray=new Be,this.lineVertexArray=new tt,this.symbolInstances=new Oe},_a.prototype.calculateGlyphDependencies=function(x,P,U,te,ce){for(var pe=0;pe<x.length;pe++)if(P[x.charCodeAt(pe)]=!0,(U||te)&&ce){var Te=Tc[x.charAt(pe)];Te&&(P[Te.charCodeAt(0)]=!0)}},_a.prototype.populate=function(x,P,U){var te=this.layers[0],ce=te.layout,pe=ce.get("text-font"),Te=ce.get("text-field"),je=ce.get("icon-image"),nt=(Te.value.kind!=="constant"||Te.value.value instanceof Ut&&!Te.value.value.isEmpty()||Te.value.value.toString().length>0)&&(pe.value.kind!=="constant"||pe.value.value.length>0),dt=je.value.kind!=="constant"||!!je.value.value||Object.keys(je.parameters).length>0,yt=ce.get("symbol-sort-key");if(this.features=[],nt||dt){for(var kt=P.iconDependencies,Lt=P.glyphDependencies,Rt=P.availableImages,rr=new Ta(this.zoom),ar=0,_r=x;ar<_r.length;ar+=1){var dr=_r[ar],Er=dr.feature,zr=dr.id,Ur=dr.index,Vr=dr.sourceLayerIndex,en=te._featureFilter.needGeometry,hn={type:Er.type,id:zr,properties:Er.properties,geometry:en?ba(Er):[]};if(te._featureFilter.filter(rr,hn,U)){en||(hn.geometry=ba(Er));var _n=void 0;if(nt){var On=te.getValueAndResolveTokens("text-field",hn,U,Rt),kn=Ut.factory(On);vp(kn)&&(this.hasRTLText=!0),(!this.hasRTLText||Xs()==="unavailable"||this.hasRTLText&&Za.isParsed())&&(_n=Zf(kn,te,hn))}var Fn=void 0;if(dt){var wn=te.getValueAndResolveTokens("icon-image",hn,U,Rt);Fn=wn instanceof ur?wn:ur.fromString(wn)}if(_n||Fn){var ia=this.sortFeaturesByKey?yt.evaluate(hn,{},U):void 0,Yn={id:zr,text:_n,icon:Fn,index:Ur,sourceLayerIndex:Vr,geometry:ba(Er),properties:Er.properties,type:gp[Er.type],sortKey:ia};if(this.features.push(Yn),Fn&&(kt[Fn.name]=!0),_n){var Cn=pe.evaluate(hn,{},U).join(","),ca=ce.get("text-rotation-alignment")==="map"&&ce.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Rr.vertical)>=0;for(var ea=0,ha=_n.sections;ea<ha.length;ea+=1){var Nn=ha[ea];if(Nn.image)kt[Nn.image.name]=!0;else{var ga=Pi(_n.toString()),Ca=Nn.fontStack||Cn,bi=Lt[Ca]=Lt[Ca]||{};this.calculateGlyphDependencies(Nn.text,bi,ca,this.allowVerticalPlacement,ga)}}}}}}ce.get("symbol-placement")==="line"&&(this.features=function(_i){var La={},li={},Pa=[],gi=0;function Qi(Ya){Pa.push(_i[Ya]),gi++}function Ci(Ya,Ti,Oa){var Qa=li[Ya];return delete li[Ya],li[Ti]=Qa,Pa[Qa].geometry[0].pop(),Pa[Qa].geometry[0]=Pa[Qa].geometry[0].concat(Oa[0]),Qa}function so(Ya,Ti,Oa){var Qa=La[Ti];return delete La[Ti],La[Ya]=Qa,Pa[Qa].geometry[0].shift(),Pa[Qa].geometry[0]=Oa[0].concat(Pa[Qa].geometry[0]),Qa}function mi(Ya,Ti,Oa){var Qa=Oa?Ti[0][Ti[0].length-1]:Ti[0][0];return Ya+":"+Qa.x+":"+Qa.y}for(var vi=0;vi<_i.length;vi++){var ua=_i[vi],wa=ua.geometry,Ia=ua.text?ua.text.toString():null;if(Ia){var pa=mi(Ia,wa),ci=mi(Ia,wa,!0);if(pa in li&&ci in La&&li[pa]!==La[ci]){var Yi=so(pa,ci,wa),wi=Ci(pa,ci,Pa[Yi].geometry);delete La[pa],delete li[ci],li[mi(Ia,Pa[wi].geometry,!0)]=wi,Pa[Yi].geometry=null}else pa in li?Ci(pa,ci,wa):ci in La?so(pa,ci,wa):(Qi(vi),La[pa]=gi-1,li[ci]=gi-1)}else Qi(vi)}return Pa.filter(function(Ya){return Ya.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(_i,La){return _i.sortKey-La.sortKey})}},_a.prototype.update=function(x,P,U){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(x,P,this.layers,U),this.icon.programConfigurations.updatePaintArrays(x,P,this.layers,U))},_a.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},_a.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},_a.prototype.upload=function(x){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(x),this.iconCollisionBox.upload(x)),this.text.upload(x,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(x,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},_a.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},_a.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},_a.prototype.addToLineVertexArray=function(x,P){var U=this.lineVertexArray.length;if(x.segment!==void 0){for(var te=x.dist(P[x.segment+1]),ce=x.dist(P[x.segment]),pe={},Te=x.segment+1;Te<P.length;Te++)pe[Te]={x:P[Te].x,y:P[Te].y,tileUnitDistanceFromAnchor:te},Te<P.length-1&&(te+=P[Te+1].dist(P[Te]));for(var je=x.segment||0;je>=0;je--)pe[je]={x:P[je].x,y:P[je].y,tileUnitDistanceFromAnchor:ce},je>0&&(ce+=P[je-1].dist(P[je]));for(var nt=0;nt<P.length;nt++){var dt=pe[nt];this.lineVertexArray.emplaceBack(dt.x,dt.y,dt.tileUnitDistanceFromAnchor)}}return{lineStartIndex:U,lineLength:this.lineVertexArray.length-U}},_a.prototype.addSymbols=function(x,P,U,te,ce,pe,Te,je,nt,dt,yt,kt){for(var Lt=x.indexArray,Rt=x.layoutVertexArray,rr=x.segments.prepareSegment(4*P.length,Rt,Lt,pe.sortKey),ar=this.glyphOffsetArray.length,_r=rr.vertexLength,dr=this.allowVerticalPlacement&&Te===Rr.vertical?Math.PI/2:0,Er=pe.text&&pe.text.sections,zr=0;zr<P.length;zr++){var Ur=P[zr],Vr=Ur.tl,en=Ur.tr,hn=Ur.bl,_n=Ur.br,On=Ur.tex,kn=Ur.pixelOffsetTL,Fn=Ur.pixelOffsetBR,wn=Ur.minFontScaleX,ia=Ur.minFontScaleY,Yn=Ur.glyphOffset,Cn=Ur.isSDF,ca=Ur.sectionIndex,ea=rr.vertexLength,ha=Yn[1];uf(Rt,je.x,je.y,Vr.x,ha+Vr.y,On.x,On.y,U,Cn,kn.x,kn.y,wn,ia),uf(Rt,je.x,je.y,en.x,ha+en.y,On.x+On.w,On.y,U,Cn,Fn.x,kn.y,wn,ia),uf(Rt,je.x,je.y,hn.x,ha+hn.y,On.x,On.y+On.h,U,Cn,kn.x,Fn.y,wn,ia),uf(Rt,je.x,je.y,_n.x,ha+_n.y,On.x+On.w,On.y+On.h,U,Cn,Fn.x,Fn.y,wn,ia),Kf(x.dynamicLayoutVertexArray,je,dr),Lt.emplaceBack(ea,ea+1,ea+2),Lt.emplaceBack(ea+1,ea+2,ea+3),rr.vertexLength+=4,rr.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Yn[0]),zr!==P.length-1&&ca===P[zr+1].sectionIndex||x.programConfigurations.populatePaintArrays(Rt.length,pe,pe.index,{},kt,Er&&Er[ca])}x.placedSymbolArray.emplaceBack(je.x,je.y,ar,this.glyphOffsetArray.length-ar,_r,nt,dt,je.segment,U?U[0]:0,U?U[1]:0,te[0],te[1],Te,0,!1,0,yt)},_a.prototype._addCollisionDebugVertex=function(x,P,U,te,ce,pe){return P.emplaceBack(0,0),x.emplaceBack(U.x,U.y,te,ce,Math.round(pe.x),Math.round(pe.y))},_a.prototype.addCollisionDebugVertices=function(x,P,U,te,ce,pe,Te){var je=ce.segments.prepareSegment(4,ce.layoutVertexArray,ce.indexArray),nt=je.vertexLength,dt=ce.layoutVertexArray,yt=ce.collisionVertexArray,kt=Te.anchorX,Lt=Te.anchorY;this._addCollisionDebugVertex(dt,yt,pe,kt,Lt,new u(x,P)),this._addCollisionDebugVertex(dt,yt,pe,kt,Lt,new u(U,P)),this._addCollisionDebugVertex(dt,yt,pe,kt,Lt,new u(U,te)),this._addCollisionDebugVertex(dt,yt,pe,kt,Lt,new u(x,te)),je.vertexLength+=4;var Rt=ce.indexArray;Rt.emplaceBack(nt,nt+1),Rt.emplaceBack(nt+1,nt+2),Rt.emplaceBack(nt+2,nt+3),Rt.emplaceBack(nt+3,nt),je.primitiveLength+=4},_a.prototype.addDebugCollisionBoxes=function(x,P,U,te){for(var ce=x;ce<P;ce++){var pe=this.collisionBoxArray.get(ce);this.addCollisionDebugVertices(pe.x1,pe.y1,pe.x2,pe.y2,te?this.textCollisionBox:this.iconCollisionBox,pe.anchorPoint,U)}},_a.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Eu(Is,of.members,Hi),this.iconCollisionBox=new Eu(Is,of.members,Hi);for(var x=0;x<this.symbolInstances.length;x++){var P=this.symbolInstances.get(x);this.addDebugCollisionBoxes(P.textBoxStartIndex,P.textBoxEndIndex,P,!0),this.addDebugCollisionBoxes(P.verticalTextBoxStartIndex,P.verticalTextBoxEndIndex,P,!0),this.addDebugCollisionBoxes(P.iconBoxStartIndex,P.iconBoxEndIndex,P,!1),this.addDebugCollisionBoxes(P.verticalIconBoxStartIndex,P.verticalIconBoxEndIndex,P,!1)}},_a.prototype._deserializeCollisionBoxesForSymbol=function(x,P,U,te,ce,pe,Te,je,nt){for(var dt={},yt=P;yt<U;yt++){var kt=x.get(yt);dt.textBox={x1:kt.x1,y1:kt.y1,x2:kt.x2,y2:kt.y2,anchorPointX:kt.anchorPointX,anchorPointY:kt.anchorPointY},dt.textFeatureIndex=kt.featureIndex;break}for(var Lt=te;Lt<ce;Lt++){var Rt=x.get(Lt);dt.verticalTextBox={x1:Rt.x1,y1:Rt.y1,x2:Rt.x2,y2:Rt.y2,anchorPointX:Rt.anchorPointX,anchorPointY:Rt.anchorPointY},dt.verticalTextFeatureIndex=Rt.featureIndex;break}for(var rr=pe;rr<Te;rr++){var ar=x.get(rr);dt.iconBox={x1:ar.x1,y1:ar.y1,x2:ar.x2,y2:ar.y2,anchorPointX:ar.anchorPointX,anchorPointY:ar.anchorPointY},dt.iconFeatureIndex=ar.featureIndex;break}for(var _r=je;_r<nt;_r++){var dr=x.get(_r);dt.verticalIconBox={x1:dr.x1,y1:dr.y1,x2:dr.x2,y2:dr.y2,anchorPointX:dr.anchorPointX,anchorPointY:dr.anchorPointY},dt.verticalIconFeatureIndex=dr.featureIndex;break}return dt},_a.prototype.deserializeCollisionBoxes=function(x){this.collisionArrays=[];for(var P=0;P<this.symbolInstances.length;P++){var U=this.symbolInstances.get(P);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(x,U.textBoxStartIndex,U.textBoxEndIndex,U.verticalTextBoxStartIndex,U.verticalTextBoxEndIndex,U.iconBoxStartIndex,U.iconBoxEndIndex,U.verticalIconBoxStartIndex,U.verticalIconBoxEndIndex))}},_a.prototype.hasTextData=function(){return this.text.segments.get().length>0},_a.prototype.hasIconData=function(){return this.icon.segments.get().length>0},_a.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},_a.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},_a.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},_a.prototype.addIndicesForPlacedSymbol=function(x,P){for(var U=x.placedSymbolArray.get(P),te=U.vertexStartIndex+4*U.numGlyphs,ce=U.vertexStartIndex;ce<te;ce+=4)x.indexArray.emplaceBack(ce,ce+1,ce+2),x.indexArray.emplaceBack(ce+1,ce+2,ce+3)},_a.prototype.getSortedSymbolIndexes=function(x){if(this.sortedAngle===x&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var P=Math.sin(x),U=Math.cos(x),te=[],ce=[],pe=[],Te=0;Te<this.symbolInstances.length;++Te){pe.push(Te);var je=this.symbolInstances.get(Te);te.push(0|Math.round(P*je.anchorX+U*je.anchorY)),ce.push(je.featureIndex)}return pe.sort(function(nt,dt){return te[nt]-te[dt]||ce[dt]-ce[nt]}),pe},_a.prototype.addToSortKeyRanges=function(x,P){var U=this.sortKeyRanges[this.sortKeyRanges.length-1];U&&U.sortKey===P?U.symbolInstanceEnd=x+1:this.sortKeyRanges.push({sortKey:P,symbolInstanceStart:x,symbolInstanceEnd:x+1})},_a.prototype.sortFeatures=function(x){var P=this;if(this.sortFeaturesByY&&this.sortedAngle!==x&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(x),this.sortedAngle=x,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var U=0,te=this.symbolInstanceIndexes;U<te.length;U+=1){var ce=this.symbolInstances.get(te[U]);this.featureSortOrder.push(ce.featureIndex),[ce.rightJustifiedTextSymbolIndex,ce.centerJustifiedTextSymbolIndex,ce.leftJustifiedTextSymbolIndex].forEach(function(pe,Te,je){pe>=0&&je.indexOf(pe)===Te&&P.addIndicesForPlacedSymbol(P.text,pe)}),ce.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,ce.verticalPlacedTextSymbolIndex),ce.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,ce.placedIconSymbolIndex),ce.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,ce.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},En("SymbolBucket",_a,{omit:["layers","collisionBoxArray","features","compareText"]}),_a.MAX_GLYPHS=65535,_a.addDynamicAttributes=Kf;var yp=new ai({"symbol-placement":new Rn(Ee.layout_symbol["symbol-placement"]),"symbol-spacing":new Rn(Ee.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Rn(Ee.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new jn(Ee.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Rn(Ee.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Rn(Ee.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Rn(Ee.layout_symbol["icon-ignore-placement"]),"icon-optional":new Rn(Ee.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Rn(Ee.layout_symbol["icon-rotation-alignment"]),"icon-size":new jn(Ee.layout_symbol["icon-size"]),"icon-text-fit":new Rn(Ee.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Rn(Ee.layout_symbol["icon-text-fit-padding"]),"icon-image":new jn(Ee.layout_symbol["icon-image"]),"icon-rotate":new jn(Ee.layout_symbol["icon-rotate"]),"icon-padding":new Rn(Ee.layout_symbol["icon-padding"]),"icon-keep-upright":new Rn(Ee.layout_symbol["icon-keep-upright"]),"icon-offset":new jn(Ee.layout_symbol["icon-offset"]),"icon-anchor":new jn(Ee.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Rn(Ee.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Rn(Ee.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Rn(Ee.layout_symbol["text-rotation-alignment"]),"text-field":new jn(Ee.layout_symbol["text-field"]),"text-font":new jn(Ee.layout_symbol["text-font"]),"text-size":new jn(Ee.layout_symbol["text-size"]),"text-max-width":new jn(Ee.layout_symbol["text-max-width"]),"text-line-height":new Rn(Ee.layout_symbol["text-line-height"]),"text-letter-spacing":new jn(Ee.layout_symbol["text-letter-spacing"]),"text-justify":new jn(Ee.layout_symbol["text-justify"]),"text-radial-offset":new jn(Ee.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Rn(Ee.layout_symbol["text-variable-anchor"]),"text-anchor":new jn(Ee.layout_symbol["text-anchor"]),"text-max-angle":new Rn(Ee.layout_symbol["text-max-angle"]),"text-writing-mode":new Rn(Ee.layout_symbol["text-writing-mode"]),"text-rotate":new jn(Ee.layout_symbol["text-rotate"]),"text-padding":new Rn(Ee.layout_symbol["text-padding"]),"text-keep-upright":new Rn(Ee.layout_symbol["text-keep-upright"]),"text-transform":new jn(Ee.layout_symbol["text-transform"]),"text-offset":new jn(Ee.layout_symbol["text-offset"]),"text-allow-overlap":new Rn(Ee.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Rn(Ee.layout_symbol["text-ignore-placement"]),"text-optional":new Rn(Ee.layout_symbol["text-optional"])}),Qf={paint:new ai({"icon-opacity":new jn(Ee.paint_symbol["icon-opacity"]),"icon-color":new jn(Ee.paint_symbol["icon-color"]),"icon-halo-color":new jn(Ee.paint_symbol["icon-halo-color"]),"icon-halo-width":new jn(Ee.paint_symbol["icon-halo-width"]),"icon-halo-blur":new jn(Ee.paint_symbol["icon-halo-blur"]),"icon-translate":new Rn(Ee.paint_symbol["icon-translate"]),"icon-translate-anchor":new Rn(Ee.paint_symbol["icon-translate-anchor"]),"text-opacity":new jn(Ee.paint_symbol["text-opacity"]),"text-color":new jn(Ee.paint_symbol["text-color"],{runtimeType:It,getOverride:function(x){return x.textColor},hasOverride:function(x){return!!x.textColor}}),"text-halo-color":new jn(Ee.paint_symbol["text-halo-color"]),"text-halo-width":new jn(Ee.paint_symbol["text-halo-width"]),"text-halo-blur":new jn(Ee.paint_symbol["text-halo-blur"]),"text-translate":new Rn(Ee.paint_symbol["text-translate"]),"text-translate-anchor":new Rn(Ee.paint_symbol["text-translate-anchor"])}),layout:yp},tu=function(x){this.type=x.property.overrides?x.property.overrides.runtimeType:Mt,this.defaultValue=x};tu.prototype.evaluate=function(x){if(x.formattedSection){var P=this.defaultValue.property.overrides;if(P&&P.hasOverride(x.formattedSection))return P.getOverride(x.formattedSection)}return x.feature&&x.featureState?this.defaultValue.evaluate(x.feature,x.featureState):this.defaultValue.property.specification.default},tu.prototype.eachChild=function(x){this.defaultValue.isConstant()||x(this.defaultValue.value._styleExpression.expression)},tu.prototype.outputDefined=function(){return!1},tu.prototype.serialize=function(){return null},En("FormatSectionOverride",tu,{omit:["defaultValue"]});var xp=function(x){function P(U){x.call(this,U,Qf)}return x&&(P.__proto__=x),(P.prototype=Object.create(x&&x.prototype)).constructor=P,P.prototype.recalculate=function(U,te){if(x.prototype.recalculate.call(this,U,te),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var ce=this.layout.get("text-writing-mode");if(ce){for(var pe=[],Te=0,je=ce;Te<je.length;Te+=1){var nt=je[Te];pe.indexOf(nt)<0&&pe.push(nt)}this.layout._values["text-writing-mode"]=pe}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},P.prototype.getValueAndResolveTokens=function(U,te,ce,pe){var Te=this.layout.get(U).evaluate(te,{},ce,pe),je=this._unevaluatedLayout._values[U];return je.isDataDriven()||hs(je.value)||!Te?Te:function(nt,dt){return dt.replace(/{([^{}]+)}/g,function(yt,kt){return kt in nt?String(nt[kt]):""})}(te.properties,Te)},P.prototype.createBucket=function(U){return new _a(U)},P.prototype.queryRadius=function(){return 0},P.prototype.queryIntersectsFeature=function(){return!1},P.prototype._setPaintOverrides=function(){for(var U=0,te=Qf.paint.overridableProperties;U<te.length;U+=1){var ce=te[U];if(P.hasPaintOverride(this.layout,ce)){var pe,Te=this.paint.get(ce),je=new tu(Te),nt=new ts(je,Te.property.specification);pe=Te.value.kind==="constant"||Te.value.kind==="source"?new rs("source",nt):new Ms("composite",nt,Te.value.zoomStops,Te.value._interpolationType),this.paint._values[ce]=new ni(Te.property,pe,Te.parameters)}}},P.prototype._handleOverridablePaintPropertyUpdate=function(U,te,ce){return!(!this.layout||te.isDataDriven()||ce.isDataDriven())&&P.hasPaintOverride(this.layout,U)},P.hasPaintOverride=function(U,te){var ce=U.get("text-field"),pe=Qf.paint.properties[te],Te=!1,je=function(yt){for(var kt=0,Lt=yt;kt<Lt.length;kt+=1)if(pe.overrides&&pe.overrides.hasOverride(Lt[kt]))return void(Te=!0)};if(ce.value.kind==="constant"&&ce.value.value instanceof Ut)je(ce.value.value.sections);else if(ce.value.kind==="source"){var nt=function(yt){Te||(yt instanceof Ir&&Hr(yt.value)===Pt?je(yt.value.sections):yt instanceof nn?je(yt.sections):yt.eachChild(nt))},dt=ce.value;dt._styleExpression&&nt(dt._styleExpression.expression)}return Te},P}(Vi),bp={paint:new ai({"background-color":new Rn(Ee.paint_background["background-color"]),"background-pattern":new Js(Ee.paint_background["background-pattern"]),"background-opacity":new Rn(Ee.paint_background["background-opacity"])})},_p=function(x){function P(U){x.call(this,U,bp)}return x&&(P.__proto__=x),(P.prototype=Object.create(x&&x.prototype)).constructor=P,P}(Vi),wp={paint:new ai({"raster-opacity":new Rn(Ee.paint_raster["raster-opacity"]),"raster-hue-rotate":new Rn(Ee.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Rn(Ee.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Rn(Ee.paint_raster["raster-brightness-max"]),"raster-saturation":new Rn(Ee.paint_raster["raster-saturation"]),"raster-contrast":new Rn(Ee.paint_raster["raster-contrast"]),"raster-resampling":new Rn(Ee.paint_raster["raster-resampling"]),"raster-fade-duration":new Rn(Ee.paint_raster["raster-fade-duration"])})},Tp=function(x){function P(U){x.call(this,U,wp)}return x&&(P.__proto__=x),(P.prototype=Object.create(x&&x.prototype)).constructor=P,P}(Vi),kp=function(x){function P(U){x.call(this,U,{}),this.implementation=U}return x&&(P.__proto__=x),(P.prototype=Object.create(x&&x.prototype)).constructor=P,P.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},P.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},P.prototype.recalculate=function(){},P.prototype.updateTransitions=function(){},P.prototype.hasTransition=function(){},P.prototype.serialize=function(){},P.prototype.onAdd=function(U){this.implementation.onAdd&&this.implementation.onAdd(U,U.painter.context.gl)},P.prototype.onRemove=function(U){this.implementation.onRemove&&this.implementation.onRemove(U,U.painter.context.gl)},P}(Vi),Mp={circle:vu,heatmap:yu,hillshade:Jl,fill:qf,"fill-extrusion":Xc,line:Au,symbol:xp,background:_p,raster:Tp},yh=self.HTMLImageElement,xh=self.HTMLCanvasElement,bh=self.HTMLVideoElement,_h=self.ImageData,ff=self.ImageBitmap,Mc=function(x,P,U,te){this.context=x,this.format=U,this.texture=x.gl.createTexture(),this.update(P,te)};Mc.prototype.update=function(x,P,U){var te=x.width,ce=x.height,pe=!(this.size&&this.size[0]===te&&this.size[1]===ce||U),Te=this.context,je=Te.gl;if(this.useMipmap=!!(P&&P.useMipmap),je.bindTexture(je.TEXTURE_2D,this.texture),Te.pixelStoreUnpackFlipY.set(!1),Te.pixelStoreUnpack.set(1),Te.pixelStoreUnpackPremultiplyAlpha.set(this.format===je.RGBA&&(!P||P.premultiply!==!1)),pe)this.size=[te,ce],x instanceof yh||x instanceof xh||x instanceof bh||x instanceof _h||ff&&x instanceof ff?je.texImage2D(je.TEXTURE_2D,0,this.format,this.format,je.UNSIGNED_BYTE,x):je.texImage2D(je.TEXTURE_2D,0,this.format,te,ce,0,this.format,je.UNSIGNED_BYTE,x.data);else{var nt=U||{x:0,y:0},dt=nt.x,yt=nt.y;x instanceof yh||x instanceof xh||x instanceof bh||x instanceof _h||ff&&x instanceof ff?je.texSubImage2D(je.TEXTURE_2D,0,dt,yt,je.RGBA,je.UNSIGNED_BYTE,x):je.texSubImage2D(je.TEXTURE_2D,0,dt,yt,te,ce,je.RGBA,je.UNSIGNED_BYTE,x.data)}this.useMipmap&&this.isSizePowerOfTwo()&&je.generateMipmap(je.TEXTURE_2D)},Mc.prototype.bind=function(x,P,U){var te=this.context.gl;te.bindTexture(te.TEXTURE_2D,this.texture),U!==te.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(U=te.LINEAR),x!==this.filter&&(te.texParameteri(te.TEXTURE_2D,te.TEXTURE_MAG_FILTER,x),te.texParameteri(te.TEXTURE_2D,te.TEXTURE_MIN_FILTER,U||x),this.filter=x),P!==this.wrap&&(te.texParameteri(te.TEXTURE_2D,te.TEXTURE_WRAP_S,P),te.texParameteri(te.TEXTURE_2D,te.TEXTURE_WRAP_T,P),this.wrap=P)},Mc.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},Mc.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var $f=function(x){var P=this;this._callback=x,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){P._triggered=!1,P._callback()})};$f.prototype.trigger=function(){var x=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){x._triggered=!1,x._callback()},0))},$f.prototype.remove=function(){delete this._channel,this._callback=function(){}};var ru=function(x,P,U){this.target=x,this.parent=P,this.mapId=U,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},w(["receive","process"],this),this.invoker=new $f(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=L()?x:self};function wh(x,P,U){var te=2*Math.PI*6378137/256/Math.pow(2,U);return[x*te-2*Math.PI*6378137/2,P*te-2*Math.PI*6378137/2]}ru.prototype.send=function(x,P,U,te,ce){var pe=this;ce===void 0&&(ce=!1);var Te=Math.round(1e18*Math.random()).toString(36).substring(0,10);U&&(this.callbacks[Te]=U);var je=V(this.globalScope)?void 0:[];return this.target.postMessage({id:Te,type:x,hasCallback:!!U,targetMapId:te,mustQueue:ce,sourceMapId:this.mapId,data:uo(P,je)},je),{cancel:function(){U&&delete pe.callbacks[Te],pe.target.postMessage({id:Te,type:"<cancel>",targetMapId:te,sourceMapId:pe.mapId})}}},ru.prototype.receive=function(x){var P=x.data,U=P.id;if(U&&(!P.targetMapId||this.mapId===P.targetMapId))if(P.type==="<cancel>"){delete this.tasks[U];var te=this.cancelCallbacks[U];delete this.cancelCallbacks[U],te&&te()}else L()||P.mustQueue?(this.tasks[U]=P,this.taskQueue.push(U),this.invoker.trigger()):this.processTask(U,P)},ru.prototype.process=function(){if(this.taskQueue.length){var x=this.taskQueue.shift(),P=this.tasks[x];delete this.tasks[x],this.taskQueue.length&&this.invoker.trigger(),P&&this.processTask(x,P)}},ru.prototype.processTask=function(x,P){var U=this;if(P.type==="<response>"){var te=this.callbacks[x];delete this.callbacks[x],te&&(P.error?te(no(P.error)):te(null,no(P.data)))}else{var ce=!1,pe=V(this.globalScope)?void 0:[],Te=P.hasCallback?function(yt,kt){ce=!0,delete U.cancelCallbacks[x],U.target.postMessage({id:x,type:"<response>",sourceMapId:U.mapId,error:yt?uo(yt):null,data:uo(kt,pe)},pe)}:function(yt){ce=!0},je=null,nt=no(P.data);if(this.parent[P.type])je=this.parent[P.type](P.sourceMapId,nt,Te);else if(this.parent.getWorkerSource){var dt=P.type.split(".");je=this.parent.getWorkerSource(P.sourceMapId,dt[0],nt.source)[dt[1]](nt,Te)}else Te(new Error("Could not find function "+P.type));!ce&&je&&je.cancel&&(this.cancelCallbacks[x]=je.cancel)}},ru.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var pi=function(x,P){x&&(P?this.setSouthWest(x).setNorthEast(P):x.length===4?this.setSouthWest([x[0],x[1]]).setNorthEast([x[2],x[3]]):this.setSouthWest(x[0]).setNorthEast(x[1]))};pi.prototype.setNorthEast=function(x){return this._ne=x instanceof Ra?new Ra(x.lng,x.lat):Ra.convert(x),this},pi.prototype.setSouthWest=function(x){return this._sw=x instanceof Ra?new Ra(x.lng,x.lat):Ra.convert(x),this},pi.prototype.extend=function(x){var P,U,te=this._sw,ce=this._ne;if(x instanceof Ra)P=x,U=x;else{if(!(x instanceof pi))return Array.isArray(x)?x.length===4||x.every(Array.isArray)?this.extend(pi.convert(x)):this.extend(Ra.convert(x)):this;if(U=x._ne,!(P=x._sw)||!U)return this}return te||ce?(te.lng=Math.min(P.lng,te.lng),te.lat=Math.min(P.lat,te.lat),ce.lng=Math.max(U.lng,ce.lng),ce.lat=Math.max(U.lat,ce.lat)):(this._sw=new Ra(P.lng,P.lat),this._ne=new Ra(U.lng,U.lat)),this},pi.prototype.getCenter=function(){return new Ra((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},pi.prototype.getSouthWest=function(){return this._sw},pi.prototype.getNorthEast=function(){return this._ne},pi.prototype.getNorthWest=function(){return new Ra(this.getWest(),this.getNorth())},pi.prototype.getSouthEast=function(){return new Ra(this.getEast(),this.getSouth())},pi.prototype.getWest=function(){return this._sw.lng},pi.prototype.getSouth=function(){return this._sw.lat},pi.prototype.getEast=function(){return this._ne.lng},pi.prototype.getNorth=function(){return this._ne.lat},pi.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},pi.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},pi.prototype.isEmpty=function(){return!(this._sw&&this._ne)},pi.prototype.contains=function(x){var P=Ra.convert(x),U=P.lng,te=P.lat,ce=this._sw.lng<=U&&U<=this._ne.lng;return this._sw.lng>this._ne.lng&&(ce=this._sw.lng>=U&&U>=this._ne.lng),this._sw.lat<=te&&te<=this._ne.lat&&ce},pi.convert=function(x){return!x||x instanceof pi?x:new pi(x)};var Ra=function(x,P){if(isNaN(x)||isNaN(P))throw new Error("Invalid LngLat object: ("+x+", "+P+")");if(this.lng=+x,this.lat=+P,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};Ra.prototype.wrap=function(){return new Ra(g(this.lng,-180,180),this.lat)},Ra.prototype.toArray=function(){return[this.lng,this.lat]},Ra.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},Ra.prototype.distanceTo=function(x){var P=Math.PI/180,U=this.lat*P,te=x.lat*P,ce=Math.sin(U)*Math.sin(te)+Math.cos(U)*Math.cos(te)*Math.cos((x.lng-this.lng)*P);return 63710088e-1*Math.acos(Math.min(ce,1))},Ra.prototype.toBounds=function(x){x===void 0&&(x=0);var P=360*x/40075017,U=P/Math.cos(Math.PI/180*this.lat);return new pi(new Ra(this.lng-U,this.lat-P),new Ra(this.lng+U,this.lat+P))},Ra.convert=function(x){if(x instanceof Ra)return x;if(Array.isArray(x)&&(x.length===2||x.length===3))return new Ra(Number(x[0]),Number(x[1]));if(!Array.isArray(x)&&typeof x=="object"&&x!==null)return new Ra(Number("lng"in x?x.lng:x.lon),Number(x.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var Th=2*Math.PI*63710088e-1;function kh(x){return Th*Math.cos(x*Math.PI/180)}function Mh(x){return(180+x)/360}function Ah(x){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+x*Math.PI/360)))/360}function Sh(x,P){return x/kh(P)}function eh(x){return 360/Math.PI*Math.atan(Math.exp((180-360*x)*Math.PI/180))-90}var Ac=function(x,P,U){U===void 0&&(U=0),this.x=+x,this.y=+P,this.z=+U};Ac.fromLngLat=function(x,P){P===void 0&&(P=0);var U=Ra.convert(x);return new Ac(Mh(U.lng),Ah(U.lat),Sh(P,U.lat))},Ac.prototype.toLngLat=function(){return new Ra(360*this.x-180,eh(this.y))},Ac.prototype.toAltitude=function(){return this.z*kh(eh(this.y))},Ac.prototype.meterInMercatorCoordinateUnits=function(){return 1/Th*(x=eh(this.y),1/Math.cos(x*Math.PI/180));var x};var Sc=function(x,P,U){this.z=x,this.x=P,this.y=U,this.key=Cu(0,x,x,P,U)};Sc.prototype.equals=function(x){return this.z===x.z&&this.x===x.x&&this.y===x.y},Sc.prototype.url=function(x,P){var U,te,ce,pe,Te,je=(te=this.y,ce=this.z,pe=wh(256*(U=this.x),256*(te=Math.pow(2,ce)-te-1),ce),Te=wh(256*(U+1),256*(te+1),ce),pe[0]+","+pe[1]+","+Te[0]+","+Te[1]),nt=function(dt,yt,kt){for(var Lt,Rt="",rr=dt;rr>0;rr--)Rt+=(yt&(Lt=1<<rr-1)?1:0)+(kt&Lt?2:0);return Rt}(this.z,this.x,this.y);return x[(this.x+this.y)%x.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(P==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",nt).replace("{bbox-epsg-3857}",je)},Sc.prototype.getTilePoint=function(x){var P=Math.pow(2,this.z);return new u(8192*(x.x*P-this.x),8192*(x.y*P-this.y))},Sc.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var Eh=function(x,P){this.wrap=x,this.canonical=P,this.key=Cu(x,P.z,P.z,P.x,P.y)},di=function(x,P,U,te,ce){this.overscaledZ=x,this.wrap=P,this.canonical=new Sc(U,+te,+ce),this.key=Cu(P,x,U,te,ce)};function Cu(x,P,U,te,ce){(x*=2)<0&&(x=-1*x-1);var pe=1<<U;return(pe*pe*x+pe*ce+te).toString(36)+U.toString(36)+P.toString(36)}di.prototype.equals=function(x){return this.overscaledZ===x.overscaledZ&&this.wrap===x.wrap&&this.canonical.equals(x.canonical)},di.prototype.scaledTo=function(x){var P=this.canonical.z-x;return x>this.canonical.z?new di(x,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new di(x,this.wrap,x,this.canonical.x>>P,this.canonical.y>>P)},di.prototype.calculateScaledKey=function(x,P){var U=this.canonical.z-x;return x>this.canonical.z?Cu(this.wrap*+P,x,this.canonical.z,this.canonical.x,this.canonical.y):Cu(this.wrap*+P,x,x,this.canonical.x>>U,this.canonical.y>>U)},di.prototype.isChildOf=function(x){if(x.wrap!==this.wrap)return!1;var P=this.canonical.z-x.canonical.z;return x.overscaledZ===0||x.overscaledZ<this.overscaledZ&&x.canonical.x===this.canonical.x>>P&&x.canonical.y===this.canonical.y>>P},di.prototype.children=function(x){if(this.overscaledZ>=x)return[new di(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var P=this.canonical.z+1,U=2*this.canonical.x,te=2*this.canonical.y;return[new di(P,this.wrap,P,U,te),new di(P,this.wrap,P,U+1,te),new di(P,this.wrap,P,U,te+1),new di(P,this.wrap,P,U+1,te+1)]},di.prototype.isLessThan=function(x){return this.wrap<x.wrap||!(this.wrap>x.wrap)&&(this.overscaledZ<x.overscaledZ||!(this.overscaledZ>x.overscaledZ)&&(this.canonical.x<x.canonical.x||!(this.canonical.x>x.canonical.x)&&this.canonical.y<x.canonical.y))},di.prototype.wrapped=function(){return new di(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},di.prototype.unwrapTo=function(x){return new di(this.overscaledZ,x,this.canonical.z,this.canonical.x,this.canonical.y)},di.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},di.prototype.toUnwrapped=function(){return new Eh(this.wrap,this.canonical)},di.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},di.prototype.getTilePoint=function(x){return this.canonical.getTilePoint(new Ac(x.x-this.wrap,x.y))},En("CanonicalTileID",Sc),En("OverscaledTileID",di,{omit:["posMatrix"]});var Pl=function(x,P,U){if(this.uid=x,P.height!==P.width)throw new RangeError("DEM tiles must be square");if(U&&U!=="mapbox"&&U!=="terrarium")return S('"'+U+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=P.height;var te=this.dim=P.height-2;this.data=new Uint32Array(P.data.buffer),this.encoding=U||"mapbox";for(var ce=0;ce<te;ce++)this.data[this._idx(-1,ce)]=this.data[this._idx(0,ce)],this.data[this._idx(te,ce)]=this.data[this._idx(te-1,ce)],this.data[this._idx(ce,-1)]=this.data[this._idx(ce,0)],this.data[this._idx(ce,te)]=this.data[this._idx(ce,te-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(te,-1)]=this.data[this._idx(te-1,0)],this.data[this._idx(-1,te)]=this.data[this._idx(0,te-1)],this.data[this._idx(te,te)]=this.data[this._idx(te-1,te-1)]};Pl.prototype.get=function(x,P){var U=new Uint8Array(this.data.buffer),te=4*this._idx(x,P);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(U[te],U[te+1],U[te+2])},Pl.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},Pl.prototype._idx=function(x,P){if(x<-1||x>=this.dim+1||P<-1||P>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(P+1)*this.stride+(x+1)},Pl.prototype._unpackMapbox=function(x,P,U){return(256*x*256+256*P+U)/10-1e4},Pl.prototype._unpackTerrarium=function(x,P,U){return 256*x+P+U/256-32768},Pl.prototype.getPixels=function(){return new Gi({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},Pl.prototype.backfillBorder=function(x,P,U){if(this.dim!==x.dim)throw new Error("dem dimension mismatch");var te=P*this.dim,ce=P*this.dim+this.dim,pe=U*this.dim,Te=U*this.dim+this.dim;switch(P){case-1:te=ce-1;break;case 1:ce=te+1}switch(U){case-1:pe=Te-1;break;case 1:Te=pe+1}for(var je=-P*this.dim,nt=-U*this.dim,dt=pe;dt<Te;dt++)for(var yt=te;yt<ce;yt++)this.data[this._idx(yt,dt)]=x.data[this._idx(yt+je,dt+nt)]},En("DEMData",Pl);var hf=function(x){this._stringToNumber={},this._numberToString=[];for(var P=0;P<x.length;P++){var U=x[P];this._stringToNumber[U]=P,this._numberToString[P]=U}};hf.prototype.encode=function(x){return this._stringToNumber[x]},hf.prototype.decode=function(x){return this._numberToString[x]};var pf=function(x,P,U,te,ce){this.type="Feature",this._vectorTileFeature=x,x._z=P,x._x=U,x._y=te,this.properties=x.properties,this.id=ce},th={geometry:{configurable:!0}};th.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},th.geometry.set=function(x){this._geometry=x},pf.prototype.toJSON=function(){var x={geometry:this.geometry};for(var P in this)P!=="_geometry"&&P!=="_vectorTileFeature"&&(x[P]=this[P]);return x},Object.defineProperties(pf.prototype,th);var nu=function(){this.state={},this.stateChanges={},this.deletedStates={}};nu.prototype.updateState=function(x,P,U){var te=String(P);if(this.stateChanges[x]=this.stateChanges[x]||{},this.stateChanges[x][te]=this.stateChanges[x][te]||{},d(this.stateChanges[x][te],U),this.deletedStates[x]===null)for(var ce in this.deletedStates[x]={},this.state[x])ce!==te&&(this.deletedStates[x][ce]=null);else if(this.deletedStates[x]&&this.deletedStates[x][te]===null)for(var pe in this.deletedStates[x][te]={},this.state[x][te])U[pe]||(this.deletedStates[x][te][pe]=null);else for(var Te in U)this.deletedStates[x]&&this.deletedStates[x][te]&&this.deletedStates[x][te][Te]===null&&delete this.deletedStates[x][te][Te]},nu.prototype.removeFeatureState=function(x,P,U){if(this.deletedStates[x]!==null){var te=String(P);if(this.deletedStates[x]=this.deletedStates[x]||{},U&&P!==void 0)this.deletedStates[x][te]!==null&&(this.deletedStates[x][te]=this.deletedStates[x][te]||{},this.deletedStates[x][te][U]=null);else if(P!==void 0)if(this.stateChanges[x]&&this.stateChanges[x][te])for(U in this.deletedStates[x][te]={},this.stateChanges[x][te])this.deletedStates[x][te][U]=null;else this.deletedStates[x][te]=null;else this.deletedStates[x]=null}},nu.prototype.getState=function(x,P){var U=String(P),te=d({},(this.state[x]||{})[U],(this.stateChanges[x]||{})[U]);if(this.deletedStates[x]===null)return{};if(this.deletedStates[x]){var ce=this.deletedStates[x][P];if(ce===null)return{};for(var pe in ce)delete te[pe]}return te},nu.prototype.initializeTileState=function(x,P){x.setFeatureState(this.state,P)},nu.prototype.coalesceChanges=function(x,P){var U={};for(var te in this.stateChanges){this.state[te]=this.state[te]||{};var ce={};for(var pe in this.stateChanges[te])this.state[te][pe]||(this.state[te][pe]={}),d(this.state[te][pe],this.stateChanges[te][pe]),ce[pe]=this.state[te][pe];U[te]=ce}for(var Te in this.deletedStates){this.state[Te]=this.state[Te]||{};var je={};if(this.deletedStates[Te]===null)for(var nt in this.state[Te])je[nt]={},this.state[Te][nt]={};else for(var dt in this.deletedStates[Te]){if(this.deletedStates[Te][dt]===null)this.state[Te][dt]={};else for(var yt=0,kt=Object.keys(this.deletedStates[Te][dt]);yt<kt.length;yt+=1)delete this.state[Te][dt][kt[yt]];je[dt]=this.state[Te][dt]}U[Te]=U[Te]||{},d(U[Te],je)}if(this.stateChanges={},this.deletedStates={},Object.keys(U).length!==0)for(var Lt in x)x[Lt].setFeatureState(U,P)};var Il=function(x,P){this.tileID=x,this.x=x.canonical.x,this.y=x.canonical.y,this.z=x.canonical.z,this.grid=new ko(8192,16,0),this.grid3D=new ko(8192,16,0),this.featureIndexArray=new St,this.promoteId=P};function Ch(x,P,U,te,ce){return E(x,function(pe,Te){var je=P instanceof ps?P.get(Te):null;return je&&je.evaluate?je.evaluate(U,te,ce):je})}function Lh(x){for(var P=1/0,U=1/0,te=-1/0,ce=-1/0,pe=0,Te=x;pe<Te.length;pe+=1){var je=Te[pe];P=Math.min(P,je.x),U=Math.min(U,je.y),te=Math.max(te,je.x),ce=Math.max(ce,je.y)}return{minX:P,minY:U,maxX:te,maxY:ce}}function Ap(x,P){return P-x}Il.prototype.insert=function(x,P,U,te,ce,pe){var Te=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(U,te,ce);for(var je=pe?this.grid3D:this.grid,nt=0;nt<P.length;nt++){for(var dt=P[nt],yt=[1/0,1/0,-1/0,-1/0],kt=0;kt<dt.length;kt++){var Lt=dt[kt];yt[0]=Math.min(yt[0],Lt.x),yt[1]=Math.min(yt[1],Lt.y),yt[2]=Math.max(yt[2],Lt.x),yt[3]=Math.max(yt[3],Lt.y)}yt[0]<8192&&yt[1]<8192&&yt[2]>=0&&yt[3]>=0&&je.insert(Te,yt[0],yt[1],yt[2],yt[3])}},Il.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new Uo.VectorTile(new ne(this.rawTileData)).layers,this.sourceLayerCoder=new hf(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},Il.prototype.query=function(x,P,U,te){var ce=this;this.loadVTLayers();for(var pe=x.params||{},Te=8192/x.tileSize/x.scale,je=Ss(pe.filter),nt=x.queryGeometry,dt=x.queryPadding*Te,yt=Lh(nt),kt=this.grid.query(yt.minX-dt,yt.minY-dt,yt.maxX+dt,yt.maxY+dt),Lt=Lh(x.cameraQueryGeometry),Rt=0,rr=this.grid3D.query(Lt.minX-dt,Lt.minY-dt,Lt.maxX+dt,Lt.maxY+dt,function(zr,Ur,Vr,en){return function(hn,_n,On,kn,Fn){for(var wn=0,ia=hn;wn<ia.length;wn+=1){var Yn=ia[wn];if(_n<=Yn.x&&On<=Yn.y&&kn>=Yn.x&&Fn>=Yn.y)return!0}var Cn=[new u(_n,On),new u(_n,Fn),new u(kn,Fn),new u(kn,On)];if(hn.length>2){for(var ca=0,ea=Cn;ca<ea.length;ca+=1)if(Ro(hn,ea[ca]))return!0}for(var ha=0;ha<hn.length-1;ha++)if(Tl(hn[ha],hn[ha+1],Cn))return!0;return!1}(x.cameraQueryGeometry,zr-dt,Ur-dt,Vr+dt,en+dt)});Rt<rr.length;Rt+=1)kt.push(rr[Rt]);kt.sort(Ap);for(var ar,_r={},dr=function(zr){var Ur=kt[zr];if(Ur!==ar){ar=Ur;var Vr=ce.featureIndexArray.get(Ur),en=null;ce.loadMatchingFeature(_r,Vr.bucketIndex,Vr.sourceLayerIndex,Vr.featureIndex,je,pe.layers,pe.availableImages,P,U,te,function(hn,_n,On){return en||(en=ba(hn)),_n.queryIntersectsFeature(nt,hn,On,en,ce.z,x.transform,Te,x.pixelPosMatrix)})}},Er=0;Er<kt.length;Er++)dr(Er);return _r},Il.prototype.loadMatchingFeature=function(x,P,U,te,ce,pe,Te,je,nt,dt,yt){var kt=this.bucketLayerIDs[P];if(!pe||function(hn,_n){for(var On=0;On<hn.length;On++)if(_n.indexOf(hn[On])>=0)return!0;return!1}(pe,kt)){var Lt=this.sourceLayerCoder.decode(U),Rt=this.vtLayers[Lt].feature(te);if(ce.filter(new Ta(this.tileID.overscaledZ),Rt))for(var rr=this.getId(Rt,Lt),ar=0;ar<kt.length;ar++){var _r=kt[ar];if(!(pe&&pe.indexOf(_r)<0)){var dr=je[_r];if(dr){var Er={};rr!==void 0&&dt&&(Er=dt.getState(dr.sourceLayer||"_geojsonTileLayer",rr));var zr=nt[_r];zr.paint=Ch(zr.paint,dr.paint,Rt,Er,Te),zr.layout=Ch(zr.layout,dr.layout,Rt,Er,Te);var Ur=!yt||yt(Rt,dr,Er);if(Ur){var Vr=new pf(Rt,this.z,this.x,this.y,rr);Vr.layer=zr;var en=x[_r];en===void 0&&(en=x[_r]=[]),en.push({featureIndex:te,feature:Vr,intersectionZ:Ur})}}}}}},Il.prototype.lookupSymbolFeatures=function(x,P,U,te,ce,pe,Te,je){var nt={};this.loadVTLayers();for(var dt=Ss(ce),yt=0,kt=x;yt<kt.length;yt+=1)this.loadMatchingFeature(nt,U,te,kt[yt],dt,pe,Te,je,P);return nt},Il.prototype.hasLayer=function(x){for(var P=0,U=this.bucketLayerIDs;P<U.length;P+=1)for(var te=0,ce=U[P];te<ce.length;te+=1)if(x===ce[te])return!0;return!1},Il.prototype.getId=function(x,P){var U=x.id;return this.promoteId&&typeof(U=x.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[P]])=="boolean"&&(U=Number(U)),U},En("FeatureIndex",Il,{omit:["rawTileData","sourceLayerCoder"]});var Ei=function(x,P){this.tileID=x,this.uid=y(),this.uses=0,this.tileSize=P,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};Ei.prototype.registerFadeDuration=function(x){var P=x+this.timeAdded;P<G.now()||this.fadeEndTime&&P<this.fadeEndTime||(this.fadeEndTime=P)},Ei.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},Ei.prototype.loadVectorData=function(x,P,U){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",x){for(var te in x.featureIndex&&(this.latestFeatureIndex=x.featureIndex,x.rawTileData?(this.latestRawTileData=x.rawTileData,this.latestFeatureIndex.rawTileData=x.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=x.collisionBoxArray,this.buckets=function(dt,yt){var kt={};if(!yt)return kt;for(var Lt=function(){var ar=rr[Rt],_r=ar.layerIds.map(function(zr){return yt.getLayer(zr)}).filter(Boolean);if(_r.length!==0){ar.layers=_r,ar.stateDependentLayerIds&&(ar.stateDependentLayers=ar.stateDependentLayerIds.map(function(zr){return _r.filter(function(Ur){return Ur.id===zr})[0]}));for(var dr=0,Er=_r;dr<Er.length;dr+=1)kt[Er[dr].id]=ar}},Rt=0,rr=dt;Rt<rr.length;Rt+=1)Lt();return kt}(x.buckets,P.style),this.hasSymbolBuckets=!1,this.buckets){var ce=this.buckets[te];if(ce instanceof _a){if(this.hasSymbolBuckets=!0,!U)break;ce.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var pe in this.buckets){var Te=this.buckets[pe];if(Te instanceof _a&&Te.hasRTLText){this.hasRTLText=!0,Za.isLoading()||Za.isLoaded()||Xs()!=="deferred"||Yl();break}}for(var je in this.queryPadding=0,this.buckets){var nt=this.buckets[je];this.queryPadding=Math.max(this.queryPadding,P.style.getLayer(je).queryRadius(nt))}x.imageAtlas&&(this.imageAtlas=x.imageAtlas),x.glyphAtlasImage&&(this.glyphAtlasImage=x.glyphAtlasImage)}else this.collisionBoxArray=new K},Ei.prototype.unloadVectorData=function(){for(var x in this.buckets)this.buckets[x].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},Ei.prototype.getBucket=function(x){return this.buckets[x.id]},Ei.prototype.upload=function(x){for(var P in this.buckets){var U=this.buckets[P];U.uploadPending()&&U.upload(x)}var te=x.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Mc(x,this.imageAtlas.image,te.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Mc(x,this.glyphAtlasImage,te.ALPHA),this.glyphAtlasImage=null)},Ei.prototype.prepare=function(x){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(x,this.imageAtlasTexture)},Ei.prototype.queryRenderedFeatures=function(x,P,U,te,ce,pe,Te,je,nt,dt){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:te,cameraQueryGeometry:ce,scale:pe,tileSize:this.tileSize,pixelPosMatrix:dt,transform:je,params:Te,queryPadding:this.queryPadding*nt},x,P,U):{}},Ei.prototype.querySourceFeatures=function(x,P){var U=this.latestFeatureIndex;if(U&&U.rawTileData){var te=U.loadVTLayers(),ce=P?P.sourceLayer:"",pe=te._geojsonTileLayer||te[ce];if(pe)for(var Te=Ss(P&&P.filter),je=this.tileID.canonical,nt=je.z,dt=je.x,yt=je.y,kt={z:nt,x:dt,y:yt},Lt=0;Lt<pe.length;Lt++){var Rt=pe.feature(Lt);if(Te.filter(new Ta(this.tileID.overscaledZ),Rt)){var rr=U.getId(Rt,ce),ar=new pf(Rt,nt,dt,yt,rr);ar.tile=kt,x.push(ar)}}}},Ei.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},Ei.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},Ei.prototype.setExpiryData=function(x){var P=this.expirationTime;if(x.cacheControl){var U=I(x.cacheControl);U["max-age"]&&(this.expirationTime=Date.now()+1e3*U["max-age"])}else x.expires&&(this.expirationTime=new Date(x.expires).getTime());if(this.expirationTime){var te=Date.now(),ce=!1;if(this.expirationTime>te)ce=!1;else if(P)if(this.expirationTime<P)ce=!0;else{var pe=this.expirationTime-P;pe?this.expirationTime=te+Math.max(pe,3e4):ce=!0}else ce=!0;ce?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},Ei.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},Ei.prototype.setFeatureState=function(x,P){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(x).length!==0){var U=this.latestFeatureIndex.loadVTLayers();for(var te in this.buckets)if(P.style.hasLayer(te)){var ce=this.buckets[te],pe=ce.layers[0].sourceLayer||"_geojsonTileLayer",Te=U[pe],je=x[pe];if(Te&&je&&Object.keys(je).length!==0){ce.update(je,Te,this.imageAtlas&&this.imageAtlas.patternPositions||{});var nt=P&&P.style&&P.style.getLayer(te);nt&&(this.queryPadding=Math.max(this.queryPadding,nt.queryRadius(ce)))}}}},Ei.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},Ei.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<G.now()},Ei.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},Ei.prototype.setHoldDuration=function(x){this.symbolFadeHoldUntil=G.now()+x},Ei.prototype.setDependencies=function(x,P){for(var U={},te=0,ce=P;te<ce.length;te+=1)U[ce[te]]=!0;this.dependencies[x]=U},Ei.prototype.hasDependency=function(x,P){for(var U=0,te=x;U<te.length;U+=1){var ce=this.dependencies[te[U]];if(ce){for(var pe=0,Te=P;pe<Te.length;pe+=1)if(ce[Te[pe]])return!0}}return!1};var nc=self.performance,Ph=function(x){this._marks={start:[x.url,"start"].join("#"),end:[x.url,"end"].join("#"),measure:x.url.toString()},nc.mark(this._marks.start)};Ph.prototype.finish=function(){nc.mark(this._marks.end);var x=nc.getEntriesByName(this._marks.measure);return x.length===0&&(nc.measure(this._marks.measure,this._marks.start,this._marks.end),x=nc.getEntriesByName(this._marks.measure),nc.clearMarks(this._marks.start),nc.clearMarks(this._marks.end),nc.clearMeasures(this._marks.measure)),x},e.Actor=ru,e.AlphaImage=vo,e.CanonicalTileID=Sc,e.CollisionBoxArray=K,e.Color=Qt,e.DEMData=Pl,e.DataConstantProperty=Rn,e.DictionaryCoder=hf,e.EXTENT=8192,e.ErrorEvent=Ye,e.EvaluationParameters=Ta,e.Event=Ue,e.Evented=xe,e.FeatureIndex=Il,e.FillBucket=jo,e.FillExtrusionBucket=Eo,e.ImageAtlas=Wr,e.ImagePosition=mr,e.LineBucket=zi,e.LngLat=Ra,e.LngLatBounds=pi,e.MercatorCoordinate=Ac,e.ONE_EM=24,e.OverscaledTileID=di,e.Point=u,e.Point$1=u,e.Properties=ai,e.Protobuf=ne,e.RGBAImage=Gi,e.RequestManager=oe,e.RequestPerformance=Ph,e.ResourceType=rt,e.SegmentVector=Gt,e.SourceFeatureState=nu,e.StructArrayLayout1ui2=Mo,e.StructArrayLayout2f1f2i16=bl,e.StructArrayLayout2i4=Qs,e.StructArrayLayout3ui6=qi,e.StructArrayLayout4i8=is,e.SymbolBucket=_a,e.Texture=Mc,e.Tile=Ei,e.Transitionable=ri,e.Uniform1f=mn,e.Uniform1i=an,e.Uniform2f=pn,e.Uniform3f=xn,e.Uniform4f=Ln,e.UniformColor=Jn,e.UniformMatrix4f=oa,e.UnwrappedTileID=Eh,e.ValidationError=Je,e.WritingMode=Rr,e.ZoomHistory=Io,e.add=function(x,P,U){return x[0]=P[0]+U[0],x[1]=P[1]+U[1],x[2]=P[2]+U[2],x},e.addDynamicAttributes=Kf,e.asyncAll=function(x,P,U){if(!x.length)return U(null,[]);var te=x.length,ce=new Array(x.length),pe=null;x.forEach(function(Te,je){P(Te,function(nt,dt){nt&&(pe=nt),ce[je]=dt,--te==0&&U(pe,ce)})})},e.bezier=a,e.bindAll=w,e.browser=G,e.cacheEntryPossiblyAdded=function(x){++Ke>He&&(x.getActor().send("enforceCacheSizeLimit",ze),Ke=0)},e.clamp=f,e.clearTileCache=function(x){var P=self.caches.delete("mapbox-tiles");x&&P.catch(x).then(function(){return x()})},e.clipLine=Ho,e.clone=function(x){var P=new Ja(16);return P[0]=x[0],P[1]=x[1],P[2]=x[2],P[3]=x[3],P[4]=x[4],P[5]=x[5],P[6]=x[6],P[7]=x[7],P[8]=x[8],P[9]=x[9],P[10]=x[10],P[11]=x[11],P[12]=x[12],P[13]=x[13],P[14]=x[14],P[15]=x[15],P},e.clone$1=b,e.clone$2=function(x){var P=new Ja(3);return P[0]=x[0],P[1]=x[1],P[2]=x[2],P},e.collisionCircleLayout=sf,e.config=W,e.create=function(){var x=new Ja(16);return Ja!=Float32Array&&(x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[6]=0,x[7]=0,x[8]=0,x[9]=0,x[11]=0,x[12]=0,x[13]=0,x[14]=0),x[0]=1,x[5]=1,x[10]=1,x[15]=1,x},e.create$1=function(){var x=new Ja(9);return Ja!=Float32Array&&(x[1]=0,x[2]=0,x[3]=0,x[5]=0,x[6]=0,x[7]=0),x[0]=1,x[4]=1,x[8]=1,x},e.create$2=function(){var x=new Ja(4);return Ja!=Float32Array&&(x[1]=0,x[2]=0),x[0]=1,x[3]=1,x},e.createCommonjsModule=o,e.createExpression=Vs,e.createLayout=Ma,e.createStyleLayer=function(x){return x.type==="custom"?new kp(x):new Mp[x.type](x)},e.cross=function(x,P,U){var te=P[0],ce=P[1],pe=P[2],Te=U[0],je=U[1],nt=U[2];return x[0]=ce*nt-pe*je,x[1]=pe*Te-te*nt,x[2]=te*je-ce*Te,x},e.deepEqual=function x(P,U){if(Array.isArray(P)){if(!Array.isArray(U)||P.length!==U.length)return!1;for(var te=0;te<P.length;te++)if(!x(P[te],U[te]))return!1;return!0}if(typeof P=="object"&&P!==null&&U!==null){if(typeof U!="object"||Object.keys(P).length!==Object.keys(U).length)return!1;for(var ce in P)if(!x(P[ce],U[ce]))return!1;return!0}return P===U},e.dot=function(x,P){return x[0]*P[0]+x[1]*P[1]+x[2]*P[2]},e.dot$1=function(x,P){return x[0]*P[0]+x[1]*P[1]+x[2]*P[2]+x[3]*P[3]},e.ease=c,e.emitValidationErrors=Vl,e.endsWith=A,e.enforceCacheSizeLimit=function(x){et(),Me&&Me.then(function(P){P.keys().then(function(U){for(var te=0;te<U.length-x;te++)P.delete(U[te])})})},e.evaluateSizeForFeature=Ki,e.evaluateSizeForZoom=xi,e.evaluateVariableOffset=gh,e.evented=xl,e.extend=d,e.featureFilter=Ss,e.filterObject=M,e.fromRotation=function(x,P){var U=Math.sin(P),te=Math.cos(P);return x[0]=te,x[1]=U,x[2]=0,x[3]=-U,x[4]=te,x[5]=0,x[6]=0,x[7]=0,x[8]=1,x},e.getAnchorAlignment=la,e.getAnchorJustification=Jf,e.getArrayBuffer=We,e.getImage=st,e.getJSON=function(x,P){return be(d(x,{type:"json"}),P)},e.getRTLTextPluginStatus=Xs,e.getReferrer=Ie,e.getVideo=function(x,P){var U,te,ce=self.document.createElement("video");ce.muted=!0,ce.onloadstart=function(){P(null,ce)};for(var pe=0;pe<x.length;pe++){var Te=self.document.createElement("source");U=x[pe],te=void 0,(te=self.document.createElement("a")).href=U,(te.protocol!==self.document.location.protocol||te.host!==self.document.location.host)&&(ce.crossOrigin="Anonymous"),Te.src=x[pe],ce.appendChild(Te)}return{cancel:function(){}}},e.identity=vs,e.invert=function(x,P){var U=P[0],te=P[1],ce=P[2],pe=P[3],Te=P[4],je=P[5],nt=P[6],dt=P[7],yt=P[8],kt=P[9],Lt=P[10],Rt=P[11],rr=P[12],ar=P[13],_r=P[14],dr=P[15],Er=U*je-te*Te,zr=U*nt-ce*Te,Ur=U*dt-pe*Te,Vr=te*nt-ce*je,en=te*dt-pe*je,hn=ce*dt-pe*nt,_n=yt*ar-kt*rr,On=yt*_r-Lt*rr,kn=yt*dr-Rt*rr,Fn=kt*_r-Lt*ar,wn=kt*dr-Rt*ar,ia=Lt*dr-Rt*_r,Yn=Er*ia-zr*wn+Ur*Fn+Vr*kn-en*On+hn*_n;return Yn?(x[0]=(je*ia-nt*wn+dt*Fn)*(Yn=1/Yn),x[1]=(ce*wn-te*ia-pe*Fn)*Yn,x[2]=(ar*hn-_r*en+dr*Vr)*Yn,x[3]=(Lt*en-kt*hn-Rt*Vr)*Yn,x[4]=(nt*kn-Te*ia-dt*On)*Yn,x[5]=(U*ia-ce*kn+pe*On)*Yn,x[6]=(_r*Ur-rr*hn-dr*zr)*Yn,x[7]=(yt*hn-Lt*Ur+Rt*zr)*Yn,x[8]=(Te*wn-je*kn+dt*_n)*Yn,x[9]=(te*kn-U*wn-pe*_n)*Yn,x[10]=(rr*en-ar*Ur+dr*Er)*Yn,x[11]=(kt*Ur-yt*en-Rt*Er)*Yn,x[12]=(je*On-Te*Fn-nt*_n)*Yn,x[13]=(U*Fn-te*On+ce*_n)*Yn,x[14]=(ar*zr-rr*Vr-_r*Er)*Yn,x[15]=(yt*Vr-kt*zr+Lt*Er)*Yn,x):null},e.isChar=vn,e.isMapboxURL=de,e.keysDifference=function(x,P){var U=[];for(var te in x)te in P||U.push(te);return U},e.makeRequest=be,e.mapObject=E,e.mercatorXfromLng=Mh,e.mercatorYfromLat=Ah,e.mercatorZfromAltitude=Sh,e.mul=Oi,e.multiply=Da,e.mvt=Uo,e.normalize=function(x,P){var U=P[0],te=P[1],ce=P[2],pe=U*U+te*te+ce*ce;return pe>0&&(pe=1/Math.sqrt(pe)),x[0]=P[0]*pe,x[1]=P[1]*pe,x[2]=P[2]*pe,x},e.number=gn,e.offscreenCanvasSupported=$e,e.ortho=function(x,P,U,te,ce,pe,Te){var je=1/(P-U),nt=1/(te-ce),dt=1/(pe-Te);return x[0]=-2*je,x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[5]=-2*nt,x[6]=0,x[7]=0,x[8]=0,x[9]=0,x[10]=2*dt,x[11]=0,x[12]=(P+U)*je,x[13]=(ce+te)*nt,x[14]=(Te+pe)*dt,x[15]=1,x},e.parseGlyphPBF=function(x){return new ne(x).readFields(Wt,[])},e.pbf=ne,e.performSymbolLayout=function(x,P,U,te,ce,pe,Te){x.createArrays(),x.tilePixelRatio=8192/(512*x.overscaling),x.compareText={},x.iconsNeedLinear=!1;var je=x.layers[0].layout,nt=x.layers[0]._unevaluatedLayout._values,dt={};if(x.textSizeData.kind==="composite"){var yt=x.textSizeData,kt=yt.maxZoom;dt.compositeTextSizes=[nt["text-size"].possiblyEvaluate(new Ta(yt.minZoom),Te),nt["text-size"].possiblyEvaluate(new Ta(kt),Te)]}if(x.iconSizeData.kind==="composite"){var Lt=x.iconSizeData,Rt=Lt.maxZoom;dt.compositeIconSizes=[nt["icon-size"].possiblyEvaluate(new Ta(Lt.minZoom),Te),nt["icon-size"].possiblyEvaluate(new Ta(Rt),Te)]}dt.layoutTextSize=nt["text-size"].possiblyEvaluate(new Ta(x.zoom+1),Te),dt.layoutIconSize=nt["icon-size"].possiblyEvaluate(new Ta(x.zoom+1),Te),dt.textMaxSize=nt["text-size"].possiblyEvaluate(new Ta(18));for(var rr=24*je.get("text-line-height"),ar=je.get("text-rotation-alignment")==="map"&&je.get("symbol-placement")!=="point",_r=je.get("text-keep-upright"),dr=je.get("text-size"),Er=function(){var Vr=Ur[zr],en=je.get("text-font").evaluate(Vr,{},Te).join(","),hn=dr.evaluate(Vr,{},Te),_n=dt.layoutTextSize.evaluate(Vr,{},Te),On=dt.layoutIconSize.evaluate(Vr,{},Te),kn={horizontal:{},vertical:void 0},Fn=Vr.text,wn=[0,0];if(Fn){var ia=Fn.toString(),Yn=24*je.get("text-letter-spacing").evaluate(Vr,{},Te),Cn=function(ua){for(var wa=0,Ia=ua;wa<Ia.length;wa+=1)if(pa=Ia[wa].charCodeAt(0),vn.Arabic(pa)||vn["Arabic Supplement"](pa)||vn["Arabic Extended-A"](pa)||vn["Arabic Presentation Forms-A"](pa)||vn["Arabic Presentation Forms-B"](pa))return!1;var pa;return!0}(ia)?Yn:0,ca=je.get("text-anchor").evaluate(Vr,{},Te),ea=je.get("text-variable-anchor");if(!ea){var ha=je.get("text-radial-offset").evaluate(Vr,{},Te);wn=ha?gh(ca,[24*ha,Xf]):je.get("text-offset").evaluate(Vr,{},Te).map(function(ua){return 24*ua})}var Nn=ar?"center":je.get("text-justify").evaluate(Vr,{},Te),ga=je.get("symbol-placement"),Ca=ga==="point"?24*je.get("text-max-width").evaluate(Vr,{},Te):0,bi=function(){x.allowVerticalPlacement&&Pi(ia)&&(kn.vertical=ln(Fn,P,U,ce,en,Ca,rr,ca,"left",Cn,wn,Rr.vertical,!0,ga,_n,hn))};if(!ar&&ea){for(var _i=Nn==="auto"?ea.map(function(ua){return Jf(ua)}):[Nn],La=!1,li=0;li<_i.length;li++){var Pa=_i[li];if(!kn.horizontal[Pa])if(La)kn.horizontal[Pa]=kn.horizontal[0];else{var gi=ln(Fn,P,U,ce,en,Ca,rr,"center",Pa,Cn,wn,Rr.horizontal,!1,ga,_n,hn);gi&&(kn.horizontal[Pa]=gi,La=gi.positionedLines.length===1)}}bi()}else{Nn==="auto"&&(Nn=Jf(ca));var Qi=ln(Fn,P,U,ce,en,Ca,rr,ca,Nn,Cn,wn,Rr.horizontal,!1,ga,_n,hn);Qi&&(kn.horizontal[Nn]=Qi),bi(),Pi(ia)&&ar&&_r&&(kn.vertical=ln(Fn,P,U,ce,en,Ca,rr,ca,Nn,Cn,wn,Rr.vertical,!1,ga,_n,hn))}}var Ci=void 0,so=!1;if(Vr.icon&&Vr.icon.name){var mi=te[Vr.icon.name];mi&&(Ci=function(ua,wa,Ia){var pa=la(Ia),ci=wa[0]-ua.displaySize[0]*pa.horizontalAlign,Yi=wa[1]-ua.displaySize[1]*pa.verticalAlign;return{image:ua,top:Yi,bottom:Yi+ua.displaySize[1],left:ci,right:ci+ua.displaySize[0]}}(ce[Vr.icon.name],je.get("icon-offset").evaluate(Vr,{},Te),je.get("icon-anchor").evaluate(Vr,{},Te)),so=mi.sdf,x.sdfIcons===void 0?x.sdfIcons=mi.sdf:x.sdfIcons!==mi.sdf&&S("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(mi.pixelRatio!==x.pixelRatio||je.get("icon-rotate").constantOr(1)!==0)&&(x.iconsNeedLinear=!0))}var vi=vh(kn.horizontal)||kn.vertical;x.iconsInText=!!vi&&vi.iconsInText,(vi||Ci)&&function(ua,wa,Ia,pa,ci,Yi,wi,Ya,Ti,Oa,Qa){var Go=Yi.textMaxSize.evaluate(wa,{});Go===void 0&&(Go=wi);var sl,$a=ua.layers[0].layout,ll=$a.get("icon-offset").evaluate(wa,{},Qa),bs=vh(Ia.horizontal),au=wi/24,Ec=ua.tilePixelRatio*au,iu=ua.tilePixelRatio*Go/24,Ol=ua.tilePixelRatio*Ya,ou=ua.tilePixelRatio*$a.get("symbol-spacing"),df=$a.get("text-padding")*ua.tilePixelRatio,su=$a.get("icon-padding")*ua.tilePixelRatio,Lu=$a.get("text-max-angle")/180*Math.PI,gf=$a.get("text-rotation-alignment")==="map"&&$a.get("symbol-placement")!=="point",mf=$a.get("icon-rotation-alignment")==="map"&&$a.get("symbol-placement")!=="point",zl=$a.get("symbol-placement"),Pu=ou/2,lu=$a.get("icon-text-fit");pa&&lu!=="none"&&(ua.allowVerticalPlacement&&Ia.vertical&&(sl=ka(pa,Ia.vertical,lu,$a.get("icon-text-fit-padding"),ll,au)),bs&&(pa=ka(pa,bs,lu,$a.get("icon-text-fit-padding"),ll,au)));var ac=function(Sp,Nu){Nu.x<0||Nu.x>=8192||Nu.y<0||Nu.y>=8192||function(ei,Bs,Ep,ic,ih,zh,wf,cl,Tf,ju,kf,Mf,oh,Dh,Uu,Rh,Fh,Bh,Nh,jh,Yo,Af,Uh,ul,Cp){var Vh,Lc,pu,du,gu,mu=ei.addToLineVertexArray(Bs,Ep),qh=0,Hh=0,Gh=0,Yh=0,sh=-1,lh=-1,Dl={},Wh=ir(""),ch=0,uh=0;if(cl._unevaluatedLayout.getValue("text-radial-offset")===void 0?(ch=(Vh=cl.layout.get("text-offset").evaluate(Yo,{},ul).map(function(qu){return 24*qu}))[0],uh=Vh[1]):(ch=24*cl.layout.get("text-radial-offset").evaluate(Yo,{},ul),uh=Xf),ei.allowVerticalPlacement&&ic.vertical){var Zh=cl.layout.get("text-rotate").evaluate(Yo,{},ul)+90;du=new cf(Tf,Bs,ju,kf,Mf,ic.vertical,oh,Dh,Uu,Zh),wf&&(gu=new cf(Tf,Bs,ju,kf,Mf,wf,Fh,Bh,Uu,Zh))}if(ih){var fh=cl.layout.get("icon-rotate").evaluate(Yo,{}),Xh=cl.layout.get("icon-text-fit")!=="none",Jh=Cl(ih,fh,Uh,Xh),hh=wf?Cl(wf,fh,Uh,Xh):void 0;pu=new cf(Tf,Bs,ju,kf,Mf,ih,Fh,Bh,!1,fh),qh=4*Jh.length;var Kh=ei.iconSizeData,Vu=null;Kh.kind==="source"?(Vu=[128*cl.layout.get("icon-size").evaluate(Yo,{})])[0]>32640&&S(ei.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):Kh.kind==="composite"&&((Vu=[128*Af.compositeIconSizes[0].evaluate(Yo,{},ul),128*Af.compositeIconSizes[1].evaluate(Yo,{},ul)])[0]>32640||Vu[1]>32640)&&S(ei.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),ei.addSymbols(ei.icon,Jh,Vu,jh,Nh,Yo,!1,Bs,mu.lineStartIndex,mu.lineLength,-1,ul),sh=ei.icon.placedSymbolArray.length-1,hh&&(Hh=4*hh.length,ei.addSymbols(ei.icon,hh,Vu,jh,Nh,Yo,Rr.vertical,Bs,mu.lineStartIndex,mu.lineLength,-1,ul),lh=ei.icon.placedSymbolArray.length-1)}for(var Qh in ic.horizontal){var Sf=ic.horizontal[Qh];if(!Lc){Wh=ir(Sf.text);var Lp=cl.layout.get("text-rotate").evaluate(Yo,{},ul);Lc=new cf(Tf,Bs,ju,kf,Mf,Sf,oh,Dh,Uu,Lp)}var $h=Sf.positionedLines.length===1;if(Gh+=mh(ei,Bs,Sf,zh,cl,Uu,Yo,Rh,mu,ic.vertical?Rr.horizontal:Rr.horizontalOnly,$h?Object.keys(ic.horizontal):[Qh],Dl,sh,Af,ul),$h)break}ic.vertical&&(Yh+=mh(ei,Bs,ic.vertical,zh,cl,Uu,Yo,Rh,mu,Rr.vertical,["vertical"],Dl,lh,Af,ul));var Pp=Lc?Lc.boxStartIndex:ei.collisionBoxArray.length,Ip=Lc?Lc.boxEndIndex:ei.collisionBoxArray.length,Op=du?du.boxStartIndex:ei.collisionBoxArray.length,zp=du?du.boxEndIndex:ei.collisionBoxArray.length,Dp=pu?pu.boxStartIndex:ei.collisionBoxArray.length,Rp=pu?pu.boxEndIndex:ei.collisionBoxArray.length,Fp=gu?gu.boxStartIndex:ei.collisionBoxArray.length,Bp=gu?gu.boxEndIndex:ei.collisionBoxArray.length,fl=-1,Ef=function(qu,tp){return qu&&qu.circleDiameter?Math.max(qu.circleDiameter,tp):tp};fl=Ef(Lc,fl),fl=Ef(du,fl),fl=Ef(pu,fl);var ep=(fl=Ef(gu,fl))>-1?1:0;ep&&(fl*=Cp/24),ei.glyphOffsetArray.length>=_a.MAX_GLYPHS&&S("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Yo.sortKey!==void 0&&ei.addToSortKeyRanges(ei.symbolInstances.length,Yo.sortKey),ei.symbolInstances.emplaceBack(Bs.x,Bs.y,Dl.right>=0?Dl.right:-1,Dl.center>=0?Dl.center:-1,Dl.left>=0?Dl.left:-1,Dl.vertical||-1,sh,lh,Wh,Pp,Ip,Op,zp,Dp,Rp,Fp,Bp,ju,Gh,Yh,qh,Hh,ep,0,oh,ch,uh,fl)}(ua,Nu,Sp,Ia,pa,ci,sl,ua.layers[0],ua.collisionBoxArray,wa.index,wa.sourceLayerIndex,ua.index,Ec,df,gf,Ti,Ol,su,mf,ll,wa,Yi,Oa,Qa,wi)};if(zl==="line")for(var cu=0,vf=Ho(wa.geometry,0,0,8192,8192);cu<vf.length;cu+=1)for(var yf=vf[cu],Iu=0,Ou=qo(yf,ou,Lu,Ia.vertical||bs,pa,24,iu,ua.overscaling,8192);Iu<Ou.length;Iu+=1){var xf=Ou[Iu];bs&&dp(ua,bs.text,Pu,xf)||ac(yf,xf)}else if(zl==="line-center")for(var zu=0,Du=wa.geometry;zu<Du.length;zu+=1){var Ru=Du[zu];if(Ru.length>1){var bf=Di(Ru,Lu,Ia.vertical||bs,pa,24,iu);bf&&ac(Ru,bf)}}else if(wa.type==="Polygon")for(var uu=0,_f=ys(wa.geometry,0);uu<_f.length;uu+=1){var fu=_f[uu],Fu=hp(fu,16);ac(fu[0],new Na(Fu.x,Fu.y,0))}else if(wa.type==="LineString")for(var Cc=0,Bu=wa.geometry;Cc<Bu.length;Cc+=1){var hu=Bu[Cc];ac(hu,new Na(hu[0].x,hu[0].y,0))}else if(wa.type==="Point")for(var rh=0,Ih=wa.geometry;rh<Ih.length;rh+=1)for(var nh=0,Oh=Ih[rh];nh<Oh.length;nh+=1){var ah=Oh[nh];ac([ah],new Na(ah.x,ah.y,0))}}(x,Vr,kn,Ci,te,dt,_n,On,wn,so,Te)},zr=0,Ur=x.features;zr<Ur.length;zr+=1)Er();pe&&x.generateCollisionDebugBuffers()},e.perspective=function(x,P,U,te,ce){var pe,Te=1/Math.tan(P/2);return x[0]=Te/U,x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[5]=Te,x[6]=0,x[7]=0,x[8]=0,x[9]=0,x[11]=-1,x[12]=0,x[13]=0,x[15]=0,ce!=null&&ce!==1/0?(x[10]=(ce+te)*(pe=1/(te-ce)),x[14]=2*ce*te*pe):(x[10]=-1,x[14]=-2*te),x},e.pick=function(x,P){for(var U={},te=0;te<P.length;te++){var ce=P[te];ce in x&&(U[ce]=x[ce])}return U},e.plugin=Za,e.polygonIntersectsPolygon=Ao,e.postMapLoadEvent=Fe,e.postTurnstileEvent=_e,e.potpack=tr,e.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],e.register=En,e.registerForPluginStateChange=function(x){return x({pluginStatus:Ai,pluginURL:ao}),xl.on("pluginStateChange",x),x},e.rotate=function(x,P,U){var te=P[0],ce=P[1],pe=P[2],Te=P[3],je=Math.sin(U),nt=Math.cos(U);return x[0]=te*nt+pe*je,x[1]=ce*nt+Te*je,x[2]=te*-je+pe*nt,x[3]=ce*-je+Te*nt,x},e.rotateX=function(x,P,U){var te=Math.sin(U),ce=Math.cos(U),pe=P[4],Te=P[5],je=P[6],nt=P[7],dt=P[8],yt=P[9],kt=P[10],Lt=P[11];return P!==x&&(x[0]=P[0],x[1]=P[1],x[2]=P[2],x[3]=P[3],x[12]=P[12],x[13]=P[13],x[14]=P[14],x[15]=P[15]),x[4]=pe*ce+dt*te,x[5]=Te*ce+yt*te,x[6]=je*ce+kt*te,x[7]=nt*ce+Lt*te,x[8]=dt*ce-pe*te,x[9]=yt*ce-Te*te,x[10]=kt*ce-je*te,x[11]=Lt*ce-nt*te,x},e.rotateZ=function(x,P,U){var te=Math.sin(U),ce=Math.cos(U),pe=P[0],Te=P[1],je=P[2],nt=P[3],dt=P[4],yt=P[5],kt=P[6],Lt=P[7];return P!==x&&(x[8]=P[8],x[9]=P[9],x[10]=P[10],x[11]=P[11],x[12]=P[12],x[13]=P[13],x[14]=P[14],x[15]=P[15]),x[0]=pe*ce+dt*te,x[1]=Te*ce+yt*te,x[2]=je*ce+kt*te,x[3]=nt*ce+Lt*te,x[4]=dt*ce-pe*te,x[5]=yt*ce-Te*te,x[6]=kt*ce-je*te,x[7]=Lt*ce-nt*te,x},e.scale=function(x,P,U){var te=U[0],ce=U[1],pe=U[2];return x[0]=P[0]*te,x[1]=P[1]*te,x[2]=P[2]*te,x[3]=P[3]*te,x[4]=P[4]*ce,x[5]=P[5]*ce,x[6]=P[6]*ce,x[7]=P[7]*ce,x[8]=P[8]*pe,x[9]=P[9]*pe,x[10]=P[10]*pe,x[11]=P[11]*pe,x[12]=P[12],x[13]=P[13],x[14]=P[14],x[15]=P[15],x},e.scale$1=function(x,P,U){return x[0]=P[0]*U,x[1]=P[1]*U,x[2]=P[2]*U,x[3]=P[3]*U,x},e.scale$2=function(x,P,U){return x[0]=P[0]*U,x[1]=P[1]*U,x[2]=P[2]*U,x},e.setCacheLimits=function(x,P){ze=x,He=P},e.setRTLTextPlugin=function(x,P,U){if(U===void 0&&(U=!1),Ai==="deferred"||Ai==="loading"||Ai==="loaded")throw new Error("setRTLTextPlugin cannot be called multiple times.");ao=G.resolveURL(x),Ai="deferred",Ls=P,Gl(),U||Yl()},e.sphericalToCartesian=function(x){var P=x[0],U=x[1],te=x[2];return U+=90,U*=Math.PI/180,te*=Math.PI/180,{x:P*Math.cos(U)*Math.sin(te),y:P*Math.sin(U)*Math.sin(te),z:P*Math.cos(te)}},e.sqrLen=function(x){var P=x[0],U=x[1];return P*P+U*U},e.styleSpec=Ee,e.sub=function(x,P,U){return x[0]=P[0]-U[0],x[1]=P[1]-U[1],x[2]=P[2]-U[2],x},e.symbolSize=oi,e.transformMat3=function(x,P,U){var te=P[0],ce=P[1],pe=P[2];return x[0]=te*U[0]+ce*U[3]+pe*U[6],x[1]=te*U[1]+ce*U[4]+pe*U[7],x[2]=te*U[2]+ce*U[5]+pe*U[8],x},e.transformMat4=Rs,e.translate=function(x,P,U){var te,ce,pe,Te,je,nt,dt,yt,kt,Lt,Rt,rr,ar=U[0],_r=U[1],dr=U[2];return P===x?(x[12]=P[0]*ar+P[4]*_r+P[8]*dr+P[12],x[13]=P[1]*ar+P[5]*_r+P[9]*dr+P[13],x[14]=P[2]*ar+P[6]*_r+P[10]*dr+P[14],x[15]=P[3]*ar+P[7]*_r+P[11]*dr+P[15]):(ce=P[1],pe=P[2],Te=P[3],je=P[4],nt=P[5],dt=P[6],yt=P[7],kt=P[8],Lt=P[9],Rt=P[10],rr=P[11],x[0]=te=P[0],x[1]=ce,x[2]=pe,x[3]=Te,x[4]=je,x[5]=nt,x[6]=dt,x[7]=yt,x[8]=kt,x[9]=Lt,x[10]=Rt,x[11]=rr,x[12]=te*ar+je*_r+kt*dr+P[12],x[13]=ce*ar+nt*_r+Lt*dr+P[13],x[14]=pe*ar+dt*_r+Rt*dr+P[14],x[15]=Te*ar+yt*_r+rr*dr+P[15]),x},e.triggerPluginCompletionEvent=Ps,e.uniqueId=y,e.validateCustomStyleLayer=function(x){var P=[],U=x.id;return U===void 0&&P.push({message:"layers."+U+': missing required property "id"'}),x.render===void 0&&P.push({message:"layers."+U+': missing required method "render"'}),x.renderingMode&&x.renderingMode!=="2d"&&x.renderingMode!=="3d"&&P.push({message:"layers."+U+': property "renderingMode" must be either "2d" or "3d"'}),P},e.validateLight=Fc,e.validateStyle=Po,e.values=function(x){var P=[];for(var U in x)P.push(x[U]);return P},e.vectorTile=Uo,e.version="1.10.1",e.warnOnce=S,e.webpSupported=Q,e.window=self,e.wrap=g}),l(0,function(e){function o(Ce){var Ue=typeof Ce;if(Ue==="number"||Ue==="boolean"||Ue==="string"||Ce==null)return JSON.stringify(Ce);if(Array.isArray(Ce)){for(var Ye="[",xe=0,Ee=Ce;xe<Ee.length;xe+=1)Ye+=o(Ee[xe])+",";return Ye+"]"}for(var Je=Object.keys(Ce).sort(),it="{",ht=0;ht<Je.length;ht++)it+=JSON.stringify(Je[ht])+":"+o(Ce[Je[ht]])+",";return it+"}"}function r(Ce){for(var Ue="",Ye=0,xe=e.refProperties;Ye<xe.length;Ye+=1)Ue+="/"+o(Ce[xe[Ye]]);return Ue}var i=function(Ce){this.keyCache={},Ce&&this.replace(Ce)};i.prototype.replace=function(Ce){this._layerConfigs={},this._layers={},this.update(Ce,[])},i.prototype.update=function(Ce,Ue){for(var Ye=this,xe=0,Ee=Ce;xe<Ee.length;xe+=1){var Je=Ee[xe];this._layerConfigs[Je.id]=Je;var it=this._layers[Je.id]=e.createStyleLayer(Je);it._featureFilter=e.featureFilter(it.filter),this.keyCache[Je.id]&&delete this.keyCache[Je.id]}for(var ht=0,ct=Ue;ht<ct.length;ht+=1){var mt=ct[ht];delete this.keyCache[mt],delete this._layerConfigs[mt],delete this._layers[mt]}this.familiesBySource={};for(var bt=0,Et=function(Ot,Yt){for(var Pt={},Ne=0;Ne<Ot.length;Ne++){var ut=Yt&&Yt[Ot[Ne].id]||r(Ot[Ne]);Yt&&(Yt[Ot[Ne].id]=ut);var wt=Pt[ut];wt||(wt=Pt[ut]=[]),wt.push(Ot[Ne])}var Bt=[];for(var Jt in Pt)Bt.push(Pt[Jt]);return Bt}(e.values(this._layerConfigs),this.keyCache);bt<Et.length;bt+=1){var Mt=Et[bt].map(function(Ot){return Ye._layers[Ot.id]}),_t=Mt[0];if(_t.visibility!=="none"){var xt=_t.source||"",At=this.familiesBySource[xt];At||(At=this.familiesBySource[xt]={});var It=_t.sourceLayer||"_geojsonTileLayer",Nt=At[It];Nt||(Nt=At[It]=[]),Nt.push(Mt)}}};var u=function(Ce){var Ue={},Ye=[];for(var xe in Ce){var Ee=Ce[xe],Je=Ue[xe]={};for(var it in Ee){var ht=Ee[+it];if(ht&&ht.bitmap.width!==0&&ht.bitmap.height!==0){var ct={x:0,y:0,w:ht.bitmap.width+2,h:ht.bitmap.height+2};Ye.push(ct),Je[it]={rect:ct,metrics:ht.metrics}}}}var mt=e.potpack(Ye),bt=new e.AlphaImage({width:mt.w||1,height:mt.h||1});for(var Et in Ce){var Mt=Ce[Et];for(var _t in Mt){var xt=Mt[+_t];if(xt&&xt.bitmap.width!==0&&xt.bitmap.height!==0){var At=Ue[Et][_t].rect;e.AlphaImage.copy(xt.bitmap,bt,{x:0,y:0},{x:At.x+1,y:At.y+1},xt.bitmap)}}}this.image=bt,this.positions=Ue};e.register("GlyphAtlas",u);var s=function(Ce){this.tileID=new e.OverscaledTileID(Ce.tileID.overscaledZ,Ce.tileID.wrap,Ce.tileID.canonical.z,Ce.tileID.canonical.x,Ce.tileID.canonical.y),this.uid=Ce.uid,this.zoom=Ce.zoom,this.pixelRatio=Ce.pixelRatio,this.tileSize=Ce.tileSize,this.source=Ce.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=Ce.showCollisionBoxes,this.collectResourceTiming=!!Ce.collectResourceTiming,this.returnDependencies=!!Ce.returnDependencies,this.promoteId=Ce.promoteId};function a(Ce,Ue,Ye){for(var xe=new e.EvaluationParameters(Ue),Ee=0,Je=Ce;Ee<Je.length;Ee+=1)Je[Ee].recalculate(xe,Ye)}function c(Ce,Ue){var Ye=e.getArrayBuffer(Ce.request,function(xe,Ee,Je,it){xe?Ue(xe):Ee&&Ue(null,{vectorTile:new e.vectorTile.VectorTile(new e.pbf(Ee)),rawData:Ee,cacheControl:Je,expires:it})});return function(){Ye.cancel(),Ue()}}s.prototype.parse=function(Ce,Ue,Ye,xe,Ee){var Je=this;this.status="parsing",this.data=Ce,this.collisionBoxArray=new e.CollisionBoxArray;var it=new e.DictionaryCoder(Object.keys(Ce.layers).sort()),ht=new e.FeatureIndex(this.tileID,this.promoteId);ht.bucketLayerIDs=[];var ct,mt,bt,Et,Mt={},_t={featureIndex:ht,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:Ye},xt=Ue.familiesBySource[this.source];for(var At in xt){var It=Ce.layers[At];if(It){It.version===1&&e.warnOnce('Vector tile source "'+this.source+'" layer "'+At+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var Nt=it.encode(At),Ot=[],Yt=0;Yt<It.length;Yt++){var Pt=It.feature(Yt),Ne=ht.getId(Pt,At);Ot.push({feature:Pt,id:Ne,index:Yt,sourceLayerIndex:Nt})}for(var ut=0,wt=xt[At];ut<wt.length;ut+=1){var Bt=wt[ut],Jt=Bt[0];Jt.minzoom&&this.zoom<Math.floor(Jt.minzoom)||Jt.maxzoom&&this.zoom>=Jt.maxzoom||Jt.visibility!=="none"&&(a(Bt,this.zoom,Ye),(Mt[Jt.id]=Jt.createBucket({index:ht.bucketLayerIDs.length,layers:Bt,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Nt,sourceID:this.source})).populate(Ot,_t,this.tileID.canonical),ht.bucketLayerIDs.push(Bt.map(function(cr){return cr.id})))}}}var er=e.mapObject(_t.glyphDependencies,function(cr){return Object.keys(cr).map(Number)});Object.keys(er).length?xe.send("getGlyphs",{uid:this.uid,stacks:er},function(cr,Dt){ct||(ct=cr,mt=Dt,Qt.call(Je))}):mt={};var or=Object.keys(_t.iconDependencies);or.length?xe.send("getImages",{icons:or,source:this.source,tileID:this.tileID,type:"icons"},function(cr,Dt){ct||(ct=cr,bt=Dt,Qt.call(Je))}):bt={};var zt=Object.keys(_t.patternDependencies);function Qt(){if(ct)return Ee(ct);if(mt&&bt&&Et){var cr=new u(mt),Dt=new e.ImageAtlas(bt,Et);for(var Ut in Mt){var ur=Mt[Ut];ur instanceof e.SymbolBucket?(a(ur.layers,this.zoom,Ye),e.performSymbolLayout(ur,mt,cr.positions,bt,Dt.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):ur.hasPattern&&(ur instanceof e.LineBucket||ur instanceof e.FillBucket||ur instanceof e.FillExtrusionBucket)&&(a(ur.layers,this.zoom,Ye),ur.addFeatures(_t,this.tileID.canonical,Dt.patternPositions))}this.status="done",Ee(null,{buckets:e.values(Mt).filter(function(Sr){return!Sr.isEmpty()}),featureIndex:ht,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:cr.image,imageAtlas:Dt,glyphMap:this.returnDependencies?mt:null,iconMap:this.returnDependencies?bt:null,glyphPositions:this.returnDependencies?cr.positions:null})}}zt.length?xe.send("getImages",{icons:zt,source:this.source,tileID:this.tileID,type:"patterns"},function(cr,Dt){ct||(ct=cr,Et=Dt,Qt.call(Je))}):Et={},Qt.call(this)};var f=function(Ce,Ue,Ye,xe){this.actor=Ce,this.layerIndex=Ue,this.availableImages=Ye,this.loadVectorData=xe||c,this.loading={},this.loaded={}};f.prototype.loadTile=function(Ce,Ue){var Ye=this,xe=Ce.uid;this.loading||(this.loading={});var Ee=!!(Ce&&Ce.request&&Ce.request.collectResourceTiming)&&new e.RequestPerformance(Ce.request),Je=this.loading[xe]=new s(Ce);Je.abort=this.loadVectorData(Ce,function(it,ht){if(delete Ye.loading[xe],it||!ht)return Je.status="done",Ye.loaded[xe]=Je,Ue(it);var ct=ht.rawData,mt={};ht.expires&&(mt.expires=ht.expires),ht.cacheControl&&(mt.cacheControl=ht.cacheControl);var bt={};if(Ee){var Et=Ee.finish();Et&&(bt.resourceTiming=JSON.parse(JSON.stringify(Et)))}Je.vectorTile=ht.vectorTile,Je.parse(ht.vectorTile,Ye.layerIndex,Ye.availableImages,Ye.actor,function(Mt,_t){if(Mt||!_t)return Ue(Mt);Ue(null,e.extend({rawTileData:ct.slice(0)},_t,mt,bt))}),Ye.loaded=Ye.loaded||{},Ye.loaded[xe]=Je})},f.prototype.reloadTile=function(Ce,Ue){var Ye=this,xe=this.loaded,Ee=Ce.uid,Je=this;if(xe&&xe[Ee]){var it=xe[Ee];it.showCollisionBoxes=Ce.showCollisionBoxes;var ht=function(ct,mt){var bt=it.reloadCallback;bt&&(delete it.reloadCallback,it.parse(it.vectorTile,Je.layerIndex,Ye.availableImages,Je.actor,bt)),Ue(ct,mt)};it.status==="parsing"?it.reloadCallback=ht:it.status==="done"&&(it.vectorTile?it.parse(it.vectorTile,this.layerIndex,this.availableImages,this.actor,ht):ht())}},f.prototype.abortTile=function(Ce,Ue){var Ye=this.loading,xe=Ce.uid;Ye&&Ye[xe]&&Ye[xe].abort&&(Ye[xe].abort(),delete Ye[xe]),Ue()},f.prototype.removeTile=function(Ce,Ue){var Ye=this.loaded,xe=Ce.uid;Ye&&Ye[xe]&&delete Ye[xe],Ue()};var g=e.window.ImageBitmap,d=function(){this.loaded={}};function m(Ce,Ue){if(Ce.length!==0){y(Ce[0],Ue);for(var Ye=1;Ye<Ce.length;Ye++)y(Ce[Ye],!Ue)}}function y(Ce,Ue){for(var Ye=0,xe=0,Ee=Ce.length,Je=Ee-1;xe<Ee;Je=xe++)Ye+=(Ce[xe][0]-Ce[Je][0])*(Ce[Je][1]+Ce[xe][1]);Ye>=0!=!!Ue&&Ce.reverse()}d.prototype.loadTile=function(Ce,Ue){var Ye=Ce.uid,xe=Ce.encoding,Ee=Ce.rawImageData,Je=g&&Ee instanceof g?this.getImageData(Ee):Ee,it=new e.DEMData(Ye,Je,xe);this.loaded=this.loaded||{},this.loaded[Ye]=it,Ue(null,it)},d.prototype.getImageData=function(Ce){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(Ce.width,Ce.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=Ce.width,this.offscreenCanvas.height=Ce.height,this.offscreenCanvasContext.drawImage(Ce,0,0,Ce.width,Ce.height);var Ue=this.offscreenCanvasContext.getImageData(-1,-1,Ce.width+2,Ce.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new e.RGBAImage({width:Ue.width,height:Ue.height},Ue.data)},d.prototype.removeTile=function(Ce){var Ue=this.loaded,Ye=Ce.uid;Ue&&Ue[Ye]&&delete Ue[Ye]};var v=e.vectorTile.VectorTileFeature.prototype.toGeoJSON,T=function(Ce){this._feature=Ce,this.extent=e.EXTENT,this.type=Ce.type,this.properties=Ce.tags,"id"in Ce&&!isNaN(Ce.id)&&(this.id=parseInt(Ce.id,10))};T.prototype.loadGeometry=function(){if(this._feature.type===1){for(var Ce=[],Ue=0,Ye=this._feature.geometry;Ue<Ye.length;Ue+=1){var xe=Ye[Ue];Ce.push([new e.Point$1(xe[0],xe[1])])}return Ce}for(var Ee=[],Je=0,it=this._feature.geometry;Je<it.length;Je+=1){for(var ht=[],ct=0,mt=it[Je];ct<mt.length;ct+=1){var bt=mt[ct];ht.push(new e.Point$1(bt[0],bt[1]))}Ee.push(ht)}return Ee},T.prototype.toGeoJSON=function(Ce,Ue,Ye){return v.call(this,Ce,Ue,Ye)};var w=function(Ce){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=e.EXTENT,this.length=Ce.length,this._features=Ce};w.prototype.feature=function(Ce){return new T(this._features[Ce])};var A=e.vectorTile.VectorTileFeature,E=M;function M(Ce,Ue){this.options=Ue||{},this.features=Ce,this.length=Ce.length}function b(Ce,Ue){this.id=typeof Ce.id=="number"?Ce.id:void 0,this.type=Ce.type,this.rawGeometry=Ce.type===1?[Ce.geometry]:Ce.geometry,this.properties=Ce.tags,this.extent=Ue||4096}M.prototype.feature=function(Ce){return new b(this.features[Ce],this.options.extent)},b.prototype.loadGeometry=function(){var Ce=this.rawGeometry;this.geometry=[];for(var Ue=0;Ue<Ce.length;Ue++){for(var Ye=Ce[Ue],xe=[],Ee=0;Ee<Ye.length;Ee++)xe.push(new e.Point$1(Ye[Ee][0],Ye[Ee][1]));this.geometry.push(xe)}return this.geometry},b.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Ce=this.geometry,Ue=1/0,Ye=-1/0,xe=1/0,Ee=-1/0,Je=0;Je<Ce.length;Je++)for(var it=Ce[Je],ht=0;ht<it.length;ht++){var ct=it[ht];Ue=Math.min(Ue,ct.x),Ye=Math.max(Ye,ct.x),xe=Math.min(xe,ct.y),Ee=Math.max(Ee,ct.y)}return[Ue,xe,Ye,Ee]},b.prototype.toGeoJSON=A.prototype.toGeoJSON;var _=C,S=E;function C(Ce){var Ue=new e.pbf;return function(Ye,xe){for(var Ee in Ye.layers)xe.writeMessage(3,k,Ye.layers[Ee])}(Ce,Ue),Ue.finish()}function k(Ce,Ue){var Ye;Ue.writeVarintField(15,Ce.version||1),Ue.writeStringField(1,Ce.name||""),Ue.writeVarintField(5,Ce.extent||4096);var xe={keys:[],values:[],keycache:{},valuecache:{}};for(Ye=0;Ye<Ce.length;Ye++)xe.feature=Ce.feature(Ye),Ue.writeMessage(2,L,xe);var Ee=xe.keys;for(Ye=0;Ye<Ee.length;Ye++)Ue.writeStringField(3,Ee[Ye]);var Je=xe.values;for(Ye=0;Ye<Je.length;Ye++)Ue.writeMessage(4,J,Je[Ye])}function L(Ce,Ue){var Ye=Ce.feature;Ye.id!==void 0&&Ue.writeVarintField(1,Ye.id),Ue.writeMessage(2,I,Ce),Ue.writeVarintField(3,Ye.type),Ue.writeMessage(4,O,Ye)}function I(Ce,Ue){var Ye=Ce.feature,xe=Ce.keys,Ee=Ce.values,Je=Ce.keycache,it=Ce.valuecache;for(var ht in Ye.properties){var ct=Je[ht];ct===void 0&&(xe.push(ht),Je[ht]=ct=xe.length-1),Ue.writeVarint(ct);var mt=Ye.properties[ht],bt=typeof mt;bt!=="string"&&bt!=="boolean"&&bt!=="number"&&(mt=JSON.stringify(mt));var Et=bt+":"+mt,Mt=it[Et];Mt===void 0&&(Ee.push(mt),it[Et]=Mt=Ee.length-1),Ue.writeVarint(Mt)}}function R(Ce,Ue){return(Ue<<3)+(7&Ce)}function V(Ce){return Ce<<1^Ce>>31}function O(Ce,Ue){for(var Ye=Ce.loadGeometry(),xe=Ce.type,Ee=0,Je=0,it=Ye.length,ht=0;ht<it;ht++){var ct=Ye[ht],mt=1;xe===1&&(mt=ct.length),Ue.writeVarint(R(1,mt));for(var bt=xe===3?ct.length-1:ct.length,Et=0;Et<bt;Et++){Et===1&&xe!==1&&Ue.writeVarint(R(2,bt-1));var Mt=ct[Et].x-Ee,_t=ct[Et].y-Je;Ue.writeVarint(V(Mt)),Ue.writeVarint(V(_t)),Ee+=Mt,Je+=_t}xe===3&&Ue.writeVarint(R(7,1))}}function J(Ce,Ue){var Ye=typeof Ce;Ye==="string"?Ue.writeStringField(1,Ce):Ye==="boolean"?Ue.writeBooleanField(7,Ce):Ye==="number"&&(Ce%1!=0?Ue.writeDoubleField(3,Ce):Ce<0?Ue.writeSVarintField(6,Ce):Ue.writeVarintField(5,Ce))}function D(Ce,Ue,Ye,xe){B(Ce,Ye,xe),B(Ue,2*Ye,2*xe),B(Ue,2*Ye+1,2*xe+1)}function B(Ce,Ue,Ye){var xe=Ce[Ue];Ce[Ue]=Ce[Ye],Ce[Ye]=xe}function N(Ce,Ue,Ye,xe){var Ee=Ce-Ye,Je=Ue-xe;return Ee*Ee+Je*Je}_.fromVectorTileJs=C,_.fromGeojsonVt=function(Ce,Ue){Ue=Ue||{};var Ye={};for(var xe in Ce)Ye[xe]=new E(Ce[xe].features,Ue),Ye[xe].name=xe,Ye[xe].version=Ue.version,Ye[xe].extent=Ue.extent;return C({layers:Ye})},_.GeoJSONWrapper=S;var F=function(Ce){return Ce[0]},H=function(Ce){return Ce[1]},j=function(Ce,Ue,Ye,xe,Ee){Ue===void 0&&(Ue=F),Ye===void 0&&(Ye=H),xe===void 0&&(xe=64),Ee===void 0&&(Ee=Float64Array),this.nodeSize=xe,this.points=Ce;for(var Je=Ce.length<65536?Uint16Array:Uint32Array,it=this.ids=new Je(Ce.length),ht=this.coords=new Ee(2*Ce.length),ct=0;ct<Ce.length;ct++)it[ct]=ct,ht[2*ct]=Ue(Ce[ct]),ht[2*ct+1]=Ye(Ce[ct]);(function mt(bt,Et,Mt,_t,xt,At){if(!(xt-_t<=Mt)){var It=_t+xt>>1;(function Nt(Ot,Yt,Pt,Ne,ut,wt){for(;ut>Ne;){if(ut-Ne>600){var Bt=ut-Ne+1,Jt=Pt-Ne+1,er=Math.log(Bt),or=.5*Math.exp(2*er/3),zt=.5*Math.sqrt(er*or*(Bt-or)/Bt)*(Jt-Bt/2<0?-1:1);Nt(Ot,Yt,Pt,Math.max(Ne,Math.floor(Pt-Jt*or/Bt+zt)),Math.min(ut,Math.floor(Pt+(Bt-Jt)*or/Bt+zt)),wt)}var Qt=Yt[2*Pt+wt],cr=Ne,Dt=ut;for(D(Ot,Yt,Ne,Pt),Yt[2*ut+wt]>Qt&&D(Ot,Yt,Ne,ut);cr<Dt;){for(D(Ot,Yt,cr,Dt),cr++,Dt--;Yt[2*cr+wt]<Qt;)cr++;for(;Yt[2*Dt+wt]>Qt;)Dt--}Yt[2*Ne+wt]===Qt?D(Ot,Yt,Ne,Dt):D(Ot,Yt,++Dt,ut),Dt<=Pt&&(Ne=Dt+1),Pt<=Dt&&(ut=Dt-1)}})(bt,Et,It,_t,xt,At%2),mt(bt,Et,Mt,_t,It-1,At+1),mt(bt,Et,Mt,It+1,xt,At+1)}})(it,ht,xe,0,it.length-1,0)};j.prototype.range=function(Ce,Ue,Ye,xe){return function(Ee,Je,it,ht,ct,mt,bt){for(var Et,Mt,_t=[0,Ee.length-1,0],xt=[];_t.length;){var At=_t.pop(),It=_t.pop(),Nt=_t.pop();if(It-Nt<=bt)for(var Ot=Nt;Ot<=It;Ot++)Mt=Je[2*Ot+1],(Et=Je[2*Ot])>=it&&Et<=ct&&Mt>=ht&&Mt<=mt&&xt.push(Ee[Ot]);else{var Yt=Math.floor((Nt+It)/2);Mt=Je[2*Yt+1],(Et=Je[2*Yt])>=it&&Et<=ct&&Mt>=ht&&Mt<=mt&&xt.push(Ee[Yt]);var Pt=(At+1)%2;(At===0?it<=Et:ht<=Mt)&&(_t.push(Nt),_t.push(Yt-1),_t.push(Pt)),(At===0?ct>=Et:mt>=Mt)&&(_t.push(Yt+1),_t.push(It),_t.push(Pt))}}return xt}(this.ids,this.coords,Ce,Ue,Ye,xe,this.nodeSize)},j.prototype.within=function(Ce,Ue,Ye){return function(xe,Ee,Je,it,ht,ct){for(var mt=[0,xe.length-1,0],bt=[],Et=ht*ht;mt.length;){var Mt=mt.pop(),_t=mt.pop(),xt=mt.pop();if(_t-xt<=ct)for(var At=xt;At<=_t;At++)N(Ee[2*At],Ee[2*At+1],Je,it)<=Et&&bt.push(xe[At]);else{var It=Math.floor((xt+_t)/2),Nt=Ee[2*It],Ot=Ee[2*It+1];N(Nt,Ot,Je,it)<=Et&&bt.push(xe[It]);var Yt=(Mt+1)%2;(Mt===0?Je-ht<=Nt:it-ht<=Ot)&&(mt.push(xt),mt.push(It-1),mt.push(Yt)),(Mt===0?Je+ht>=Nt:it+ht>=Ot)&&(mt.push(It+1),mt.push(_t),mt.push(Yt))}}return bt}(this.ids,this.coords,Ce,Ue,Ye,this.nodeSize)};var G={minZoom:0,maxZoom:16,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(Ce){return Ce}},W=function(Ce){this.options=de(Object.create(G),Ce),this.trees=new Array(this.options.maxZoom+1)};function Q(Ce,Ue,Ye,xe,Ee){return{x:Ce,y:Ue,zoom:1/0,id:Ye,parentId:-1,numPoints:xe,properties:Ee}}function $(Ce,Ue){var Ye=Ce.geometry.coordinates,xe=Ye[1];return{x:ae(Ye[0]),y:oe(xe),zoom:1/0,index:Ue,parentId:-1}}function ee(Ce){return{type:"Feature",id:Ce.id,properties:ie(Ce),geometry:{type:"Point",coordinates:[(xe=Ce.x,360*(xe-.5)),(Ue=Ce.y,Ye=(180-360*Ue)*Math.PI/180,360*Math.atan(Math.exp(Ye))/Math.PI-90)]}};var Ue,Ye,xe}function ie(Ce){var Ue=Ce.numPoints,Ye=Ue>=1e4?Math.round(Ue/1e3)+"k":Ue>=1e3?Math.round(Ue/100)/10+"k":Ue;return de(de({},Ce.properties),{cluster:!0,cluster_id:Ce.id,point_count:Ue,point_count_abbreviated:Ye})}function ae(Ce){return Ce/360+.5}function oe(Ce){var Ue=Math.sin(Ce*Math.PI/180),Ye=.5-.25*Math.log((1+Ue)/(1-Ue))/Math.PI;return Ye<0?0:Ye>1?1:Ye}function de(Ce,Ue){for(var Ye in Ue)Ce[Ye]=Ue[Ye];return Ce}function le(Ce){return Ce.x}function fe(Ce){return Ce.y}function ue(Ce,Ue,Ye,xe,Ee,Je){var it=Ee-Ye,ht=Je-xe;if(it!==0||ht!==0){var ct=((Ce-Ye)*it+(Ue-xe)*ht)/(it*it+ht*ht);ct>1?(Ye=Ee,xe=Je):ct>0&&(Ye+=it*ct,xe+=ht*ct)}return(it=Ce-Ye)*it+(ht=Ue-xe)*ht}function we(Ce,Ue,Ye,xe){var Ee={id:Ce===void 0?null:Ce,type:Ue,geometry:Ye,tags:xe,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Je){var it=Je.geometry,ht=Je.type;if(ht==="Point"||ht==="MultiPoint"||ht==="LineString")Ae(Je,it);else if(ht==="Polygon"||ht==="MultiLineString")for(var ct=0;ct<it.length;ct++)Ae(Je,it[ct]);else if(ht==="MultiPolygon")for(ct=0;ct<it.length;ct++)for(var mt=0;mt<it[ct].length;mt++)Ae(Je,it[ct][mt])}(Ee),Ee}function Ae(Ce,Ue){for(var Ye=0;Ye<Ue.length;Ye+=3)Ce.minX=Math.min(Ce.minX,Ue[Ye]),Ce.minY=Math.min(Ce.minY,Ue[Ye+1]),Ce.maxX=Math.max(Ce.maxX,Ue[Ye]),Ce.maxY=Math.max(Ce.maxY,Ue[Ye+1])}function Se(Ce,Ue,Ye,xe){if(Ue.geometry){var Ee=Ue.geometry.coordinates,Je=Ue.geometry.type,it=Math.pow(Ye.tolerance/((1<<Ye.maxZoom)*Ye.extent),2),ht=[],ct=Ue.id;if(Ye.promoteId?ct=Ue.properties[Ye.promoteId]:Ye.generateId&&(ct=xe||0),Je==="Point")ke(Ee,ht);else if(Je==="MultiPoint")for(var mt=0;mt<Ee.length;mt++)ke(Ee[mt],ht);else if(Je==="LineString")Me(Ee,ht,it,!1);else if(Je==="MultiLineString"){if(Ye.lineMetrics){for(mt=0;mt<Ee.length;mt++)Me(Ee[mt],ht=[],it,!1),Ce.push(we(ct,"LineString",ht,Ue.properties));return}ve(Ee,ht,it,!1)}else if(Je==="Polygon")ve(Ee,ht,it,!0);else{if(Je!=="MultiPolygon"){if(Je==="GeometryCollection"){for(mt=0;mt<Ue.geometry.geometries.length;mt++)Se(Ce,{id:ct,geometry:Ue.geometry.geometries[mt],properties:Ue.properties},Ye,xe);return}throw new Error("Input data is not a valid GeoJSON object.")}for(mt=0;mt<Ee.length;mt++){var bt=[];ve(Ee[mt],bt,it,!0),ht.push(bt)}}Ce.push(we(ct,Je,ht,Ue.properties))}}function ke(Ce,Ue){Ue.push(ge(Ce[0])),Ue.push(De(Ce[1])),Ue.push(0)}function Me(Ce,Ue,Ye,xe){for(var Ee,Je,it=0,ht=0;ht<Ce.length;ht++){var ct=ge(Ce[ht][0]),mt=De(Ce[ht][1]);Ue.push(ct),Ue.push(mt),Ue.push(0),ht>0&&(it+=xe?(Ee*mt-ct*Je)/2:Math.sqrt(Math.pow(ct-Ee,2)+Math.pow(mt-Je,2))),Ee=ct,Je=mt}var bt=Ue.length-3;Ue[2]=1,function Et(Mt,_t,xt,At){for(var It,Nt=At,Ot=xt-_t>>1,Yt=xt-_t,Pt=Mt[_t],Ne=Mt[_t+1],ut=Mt[xt],wt=Mt[xt+1],Bt=_t+3;Bt<xt;Bt+=3){var Jt=ue(Mt[Bt],Mt[Bt+1],Pt,Ne,ut,wt);if(Jt>Nt)It=Bt,Nt=Jt;else if(Jt===Nt){var er=Math.abs(Bt-Ot);er<Yt&&(It=Bt,Yt=er)}}Nt>At&&(It-_t>3&&Et(Mt,_t,It,At),Mt[It+2]=Nt,xt-It>3&&Et(Mt,It,xt,At))}(Ue,0,bt,Ye),Ue[bt+2]=1,Ue.size=Math.abs(it),Ue.start=0,Ue.end=Ue.size}function ve(Ce,Ue,Ye,xe){for(var Ee=0;Ee<Ce.length;Ee++){var Je=[];Me(Ce[Ee],Je,Ye,xe),Ue.push(Je)}}function ge(Ce){return Ce/360+.5}function De(Ce){var Ue=Math.sin(Ce*Math.PI/180),Ye=.5-.25*Math.log((1+Ue)/(1-Ue))/Math.PI;return Ye<0?0:Ye>1?1:Ye}function _e(Ce,Ue,Ye,xe,Ee,Je,it,ht){if(xe/=Ue,Je>=(Ye/=Ue)&&it<xe)return Ce;if(it<Ye||Je>=xe)return null;for(var ct=[],mt=0;mt<Ce.length;mt++){var bt=Ce[mt],Et=bt.geometry,Mt=bt.type,_t=Ee===0?bt.minX:bt.minY,xt=Ee===0?bt.maxX:bt.maxY;if(_t>=Ye&&xt<xe)ct.push(bt);else if(!(xt<Ye||_t>=xe)){var At=[];if(Mt==="Point"||Mt==="MultiPoint")Pe(Et,At,Ye,xe,Ee);else if(Mt==="LineString")Fe(Et,At,Ye,xe,Ee,!1,ht.lineMetrics);else if(Mt==="MultiLineString")He(Et,At,Ye,xe,Ee,!1);else if(Mt==="Polygon")He(Et,At,Ye,xe,Ee,!0);else if(Mt==="MultiPolygon")for(var It=0;It<Et.length;It++){var Nt=[];He(Et[It],Nt,Ye,xe,Ee,!0),Nt.length&&At.push(Nt)}if(At.length){if(ht.lineMetrics&&Mt==="LineString"){for(It=0;It<At.length;It++)ct.push(we(bt.id,Mt,At[It],bt.tags));continue}Mt!=="LineString"&&Mt!=="MultiLineString"||(At.length===1?(Mt="LineString",At=At[0]):Mt="MultiLineString"),Mt!=="Point"&&Mt!=="MultiPoint"||(Mt=At.length===3?"Point":"MultiPoint"),ct.push(we(bt.id,Mt,At,bt.tags))}}}return ct.length?ct:null}function Pe(Ce,Ue,Ye,xe,Ee){for(var Je=0;Je<Ce.length;Je+=3){var it=Ce[Je+Ee];it>=Ye&&it<=xe&&(Ue.push(Ce[Je]),Ue.push(Ce[Je+1]),Ue.push(Ce[Je+2]))}}function Fe(Ce,Ue,Ye,xe,Ee,Je,it){for(var ht,ct,mt=ze(Ce),bt=Ee===0?Re:Ze,Et=Ce.start,Mt=0;Mt<Ce.length-3;Mt+=3){var _t=Ce[Mt],xt=Ce[Mt+1],At=Ce[Mt+2],It=Ce[Mt+3],Nt=Ce[Mt+4],Ot=Ee===0?_t:xt,Yt=Ee===0?It:Nt,Pt=!1;it&&(ht=Math.sqrt(Math.pow(_t-It,2)+Math.pow(xt-Nt,2))),Ot<Ye?Yt>Ye&&(ct=bt(mt,_t,xt,It,Nt,Ye),it&&(mt.start=Et+ht*ct)):Ot>xe?Yt<xe&&(ct=bt(mt,_t,xt,It,Nt,xe),it&&(mt.start=Et+ht*ct)):et(mt,_t,xt,At),Yt<Ye&&Ot>=Ye&&(ct=bt(mt,_t,xt,It,Nt,Ye),Pt=!0),Yt>xe&&Ot<=xe&&(ct=bt(mt,_t,xt,It,Nt,xe),Pt=!0),!Je&&Pt&&(it&&(mt.end=Et+ht*ct),Ue.push(mt),mt=ze(Ce)),it&&(Et+=ht)}var Ne=Ce.length-3;_t=Ce[Ne],xt=Ce[Ne+1],At=Ce[Ne+2],(Ot=Ee===0?_t:xt)>=Ye&&Ot<=xe&&et(mt,_t,xt,At),Ne=mt.length-3,Je&&Ne>=3&&(mt[Ne]!==mt[0]||mt[Ne+1]!==mt[1])&&et(mt,mt[0],mt[1],mt[2]),mt.length&&Ue.push(mt)}function ze(Ce){var Ue=[];return Ue.size=Ce.size,Ue.start=Ce.start,Ue.end=Ce.end,Ue}function He(Ce,Ue,Ye,xe,Ee,Je){for(var it=0;it<Ce.length;it++)Fe(Ce[it],Ue,Ye,xe,Ee,Je,!1)}function et(Ce,Ue,Ye,xe){Ce.push(Ue),Ce.push(Ye),Ce.push(xe)}function Re(Ce,Ue,Ye,xe,Ee,Je){var it=(Je-Ue)/(xe-Ue);return Ce.push(Je),Ce.push(Ye+(Ee-Ye)*it),Ce.push(1),it}function Ze(Ce,Ue,Ye,xe,Ee,Je){var it=(Je-Ye)/(Ee-Ye);return Ce.push(Ue+(xe-Ue)*it),Ce.push(Je),Ce.push(1),it}function Ke(Ce,Ue){for(var Ye=[],xe=0;xe<Ce.length;xe++){var Ee,Je=Ce[xe],it=Je.type;if(it==="Point"||it==="MultiPoint"||it==="LineString")Ee=$e(Je.geometry,Ue);else if(it==="MultiLineString"||it==="Polygon"){Ee=[];for(var ht=0;ht<Je.geometry.length;ht++)Ee.push($e(Je.geometry[ht],Ue))}else if(it==="MultiPolygon")for(Ee=[],ht=0;ht<Je.geometry.length;ht++){for(var ct=[],mt=0;mt<Je.geometry[ht].length;mt++)ct.push($e(Je.geometry[ht][mt],Ue));Ee.push(ct)}Ye.push(we(Je.id,it,Ee,Je.tags))}return Ye}function $e(Ce,Ue){var Ye=[];Ye.size=Ce.size,Ce.start!==void 0&&(Ye.start=Ce.start,Ye.end=Ce.end);for(var xe=0;xe<Ce.length;xe+=3)Ye.push(Ce[xe]+Ue,Ce[xe+1],Ce[xe+2]);return Ye}function rt(Ce,Ue){if(Ce.transformed)return Ce;var Ye,xe,Ee,Je=1<<Ce.z,it=Ce.x,ht=Ce.y;for(Ye=0;Ye<Ce.features.length;Ye++){var ct=Ce.features[Ye],mt=ct.geometry,bt=ct.type;if(ct.geometry=[],bt===1)for(xe=0;xe<mt.length;xe+=2)ct.geometry.push(at(mt[xe],mt[xe+1],Ue,Je,it,ht));else for(xe=0;xe<mt.length;xe++){var Et=[];for(Ee=0;Ee<mt[xe].length;Ee+=2)Et.push(at(mt[xe][Ee],mt[xe][Ee+1],Ue,Je,it,ht));ct.geometry.push(Et)}}return Ce.transformed=!0,Ce}function at(Ce,Ue,Ye,xe,Ee,Je){return[Math.round(Ye*(Ce*xe-Ee)),Math.round(Ye*(Ue*xe-Je))]}function lt(Ce,Ue,Ye,xe,Ee){for(var Je=Ue===Ee.maxZoom?0:Ee.tolerance/((1<<Ue)*Ee.extent),it={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:Ye,y:xe,z:Ue,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},ht=0;ht<Ce.length;ht++){it.numFeatures++,gt(it,Ce[ht],Je,Ee);var ct=Ce[ht].minX,mt=Ce[ht].minY,bt=Ce[ht].maxX,Et=Ce[ht].maxY;ct<it.minX&&(it.minX=ct),mt<it.minY&&(it.minY=mt),bt>it.maxX&&(it.maxX=bt),Et>it.maxY&&(it.maxY=Et)}return it}function gt(Ce,Ue,Ye,xe){var Ee=Ue.geometry,Je=Ue.type,it=[];if(Je==="Point"||Je==="MultiPoint")for(var ht=0;ht<Ee.length;ht+=3)it.push(Ee[ht]),it.push(Ee[ht+1]),Ce.numPoints++,Ce.numSimplified++;else if(Je==="LineString")Ie(it,Ee,Ce,Ye,!1,!1);else if(Je==="MultiLineString"||Je==="Polygon")for(ht=0;ht<Ee.length;ht++)Ie(it,Ee[ht],Ce,Ye,Je==="Polygon",ht===0);else if(Je==="MultiPolygon")for(var ct=0;ct<Ee.length;ct++){var mt=Ee[ct];for(ht=0;ht<mt.length;ht++)Ie(it,mt[ht],Ce,Ye,!0,ht===0)}if(it.length){var bt=Ue.tags||null;if(Je==="LineString"&&xe.lineMetrics){for(var Et in bt={},Ue.tags)bt[Et]=Ue.tags[Et];bt.mapbox_clip_start=Ee.start/Ee.size,bt.mapbox_clip_end=Ee.end/Ee.size}var Mt={geometry:it,type:Je==="Polygon"||Je==="MultiPolygon"?3:Je==="LineString"||Je==="MultiLineString"?2:1,tags:bt};Ue.id!==null&&(Mt.id=Ue.id),Ce.features.push(Mt)}}function Ie(Ce,Ue,Ye,xe,Ee,Je){var it=xe*xe;if(xe>0&&Ue.size<(Ee?it:xe))Ye.numPoints+=Ue.length/3;else{for(var ht=[],ct=0;ct<Ue.length;ct+=3)(xe===0||Ue[ct+2]>it)&&(Ye.numSimplified++,ht.push(Ue[ct]),ht.push(Ue[ct+1])),Ye.numPoints++;Ee&&function(mt,bt){for(var Et=0,Mt=0,_t=mt.length,xt=_t-2;Mt<_t;xt=Mt,Mt+=2)Et+=(mt[Mt]-mt[xt])*(mt[Mt+1]+mt[xt+1]);if(Et>0===bt)for(Mt=0,_t=mt.length;Mt<_t/2;Mt+=2){var At=mt[Mt],It=mt[Mt+1];mt[Mt]=mt[_t-2-Mt],mt[Mt+1]=mt[_t-1-Mt],mt[_t-2-Mt]=At,mt[_t-1-Mt]=It}}(ht,Je),Ce.push(ht)}}function be(Ce,Ue){var Ye=(Ue=this.options=function(Ee,Je){for(var it in Je)Ee[it]=Je[it];return Ee}(Object.create(this.options),Ue)).debug;if(Ye&&console.time("preprocess data"),Ue.maxZoom<0||Ue.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Ue.promoteId&&Ue.generateId)throw new Error("promoteId and generateId cannot be used together.");var xe=function(Ee,Je){var it=[];if(Ee.type==="FeatureCollection")for(var ht=0;ht<Ee.features.length;ht++)Se(it,Ee.features[ht],Je,ht);else Se(it,Ee.type==="Feature"?Ee:{geometry:Ee},Je);return it}(Ce,Ue);this.tiles={},this.tileCoords=[],Ye&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Ue.indexMaxZoom,Ue.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(xe=function(Ee,Je){var it=Je.buffer/Je.extent,ht=Ee,ct=_e(Ee,1,-1-it,it,0,-1,2,Je),mt=_e(Ee,1,1-it,2+it,0,-1,2,Je);return(ct||mt)&&(ht=_e(Ee,1,-it,1+it,0,-1,2,Je)||[],ct&&(ht=Ke(ct,1).concat(ht)),mt&&(ht=ht.concat(Ke(mt,-1)))),ht}(xe,Ue)).length&&this.splitTile(xe,0,0,0),Ye&&(xe.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function We(Ce,Ue,Ye){return 32*((1<<Ce)*Ye+Ue)+Ce}function Ge(Ce,Ue){var Ye=Ce.tileID.canonical;if(!this._geoJSONIndex)return Ue(null,null);var xe=this._geoJSONIndex.getTile(Ye.z,Ye.x,Ye.y);if(!xe)return Ue(null,null);var Ee=new w(xe.features),Je=_(Ee);Je.byteOffset===0&&Je.byteLength===Je.buffer.byteLength||(Je=new Uint8Array(Je)),Ue(null,{vectorTile:Ee,rawData:Je.buffer})}W.prototype.load=function(Ce){var Ue=this.options,Ye=Ue.log,xe=Ue.minZoom,Ee=Ue.maxZoom,Je=Ue.nodeSize;Ye&&console.time("total time");var it="prepare "+Ce.length+" points";Ye&&console.time(it),this.points=Ce;for(var ht=[],ct=0;ct<Ce.length;ct++)Ce[ct].geometry&&ht.push($(Ce[ct],ct));this.trees[Ee+1]=new j(ht,le,fe,Je,Float32Array),Ye&&console.timeEnd(it);for(var mt=Ee;mt>=xe;mt--){var bt=+Date.now();ht=this._cluster(ht,mt),this.trees[mt]=new j(ht,le,fe,Je,Float32Array),Ye&&console.log("z%d: %d clusters in %dms",mt,ht.length,+Date.now()-bt)}return Ye&&console.timeEnd("total time"),this},W.prototype.getClusters=function(Ce,Ue){var Ye=((Ce[0]+180)%360+360)%360-180,xe=Math.max(-90,Math.min(90,Ce[1])),Ee=Ce[2]===180?180:((Ce[2]+180)%360+360)%360-180,Je=Math.max(-90,Math.min(90,Ce[3]));if(Ce[2]-Ce[0]>=360)Ye=-180,Ee=180;else if(Ye>Ee){var it=this.getClusters([Ye,xe,180,Je],Ue),ht=this.getClusters([-180,xe,Ee,Je],Ue);return it.concat(ht)}for(var ct=this.trees[this._limitZoom(Ue)],mt=[],bt=0,Et=ct.range(ae(Ye),oe(Je),ae(Ee),oe(xe));bt<Et.length;bt+=1){var Mt=ct.points[Et[bt]];mt.push(Mt.numPoints?ee(Mt):this.points[Mt.index])}return mt},W.prototype.getChildren=function(Ce){var Ue=this._getOriginId(Ce),Ye=this._getOriginZoom(Ce),xe="No cluster with the specified id.",Ee=this.trees[Ye];if(!Ee)throw new Error(xe);var Je=Ee.points[Ue];if(!Je)throw new Error(xe);for(var it=this.options.radius/(this.options.extent*Math.pow(2,Ye-1)),ht=[],ct=0,mt=Ee.within(Je.x,Je.y,it);ct<mt.length;ct+=1){var bt=Ee.points[mt[ct]];bt.parentId===Ce&&ht.push(bt.numPoints?ee(bt):this.points[bt.index])}if(ht.length===0)throw new Error(xe);return ht},W.prototype.getLeaves=function(Ce,Ue,Ye){var xe=[];return this._appendLeaves(xe,Ce,Ue=Ue||10,Ye=Ye||0,0),xe},W.prototype.getTile=function(Ce,Ue,Ye){var xe=this.trees[this._limitZoom(Ce)],Ee=Math.pow(2,Ce),Je=this.options,it=Je.radius/Je.extent,ht=(Ye-it)/Ee,ct=(Ye+1+it)/Ee,mt={features:[]};return this._addTileFeatures(xe.range((Ue-it)/Ee,ht,(Ue+1+it)/Ee,ct),xe.points,Ue,Ye,Ee,mt),Ue===0&&this._addTileFeatures(xe.range(1-it/Ee,ht,1,ct),xe.points,Ee,Ye,Ee,mt),Ue===Ee-1&&this._addTileFeatures(xe.range(0,ht,it/Ee,ct),xe.points,-1,Ye,Ee,mt),mt.features.length?mt:null},W.prototype.getClusterExpansionZoom=function(Ce){for(var Ue=this._getOriginZoom(Ce)-1;Ue<=this.options.maxZoom;){var Ye=this.getChildren(Ce);if(Ue++,Ye.length!==1)break;Ce=Ye[0].properties.cluster_id}return Ue},W.prototype._appendLeaves=function(Ce,Ue,Ye,xe,Ee){for(var Je=0,it=this.getChildren(Ue);Je<it.length;Je+=1){var ht=it[Je],ct=ht.properties;if(ct&&ct.cluster?Ee+ct.point_count<=xe?Ee+=ct.point_count:Ee=this._appendLeaves(Ce,ct.cluster_id,Ye,xe,Ee):Ee<xe?Ee++:Ce.push(ht),Ce.length===Ye)break}return Ee},W.prototype._addTileFeatures=function(Ce,Ue,Ye,xe,Ee,Je){for(var it=0,ht=Ce;it<ht.length;it+=1){var ct=Ue[ht[it]],mt=ct.numPoints,bt={type:1,geometry:[[Math.round(this.options.extent*(ct.x*Ee-Ye)),Math.round(this.options.extent*(ct.y*Ee-xe))]],tags:mt?ie(ct):this.points[ct.index].properties},Et=void 0;mt?Et=ct.id:this.options.generateId?Et=ct.index:this.points[ct.index].id&&(Et=this.points[ct.index].id),Et!==void 0&&(bt.id=Et),Je.features.push(bt)}},W.prototype._limitZoom=function(Ce){return Math.max(this.options.minZoom,Math.min(Ce,this.options.maxZoom+1))},W.prototype._cluster=function(Ce,Ue){for(var Ye=[],xe=this.options,Ee=xe.reduce,Je=xe.radius/(xe.extent*Math.pow(2,Ue)),it=0;it<Ce.length;it++){var ht=Ce[it];if(!(ht.zoom<=Ue)){ht.zoom=Ue;for(var ct=this.trees[Ue+1],mt=ct.within(ht.x,ht.y,Je),bt=ht.numPoints||1,Et=ht.x*bt,Mt=ht.y*bt,_t=Ee&&bt>1?this._map(ht,!0):null,xt=(it<<5)+(Ue+1)+this.points.length,At=0,It=mt;At<It.length;At+=1){var Nt=ct.points[It[At]];if(!(Nt.zoom<=Ue)){Nt.zoom=Ue;var Ot=Nt.numPoints||1;Et+=Nt.x*Ot,Mt+=Nt.y*Ot,bt+=Ot,Nt.parentId=xt,Ee&&(_t||(_t=this._map(ht,!0)),Ee(_t,this._map(Nt)))}}bt===1?Ye.push(ht):(ht.parentId=xt,Ye.push(Q(Et/bt,Mt/bt,xt,bt,_t)))}}return Ye},W.prototype._getOriginId=function(Ce){return Ce-this.points.length>>5},W.prototype._getOriginZoom=function(Ce){return(Ce-this.points.length)%32},W.prototype._map=function(Ce,Ue){if(Ce.numPoints)return Ue?de({},Ce.properties):Ce.properties;var Ye=this.points[Ce.index].properties,xe=this.options.map(Ye);return Ue&&xe===Ye?de({},xe):xe},be.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},be.prototype.splitTile=function(Ce,Ue,Ye,xe,Ee,Je,it){for(var ht=[Ce,Ue,Ye,xe],ct=this.options,mt=ct.debug;ht.length;){xe=ht.pop(),Ye=ht.pop(),Ue=ht.pop(),Ce=ht.pop();var bt=1<<Ue,Et=We(Ue,Ye,xe),Mt=this.tiles[Et];if(!Mt&&(mt>1&&console.time("creation"),Mt=this.tiles[Et]=lt(Ce,Ue,Ye,xe,ct),this.tileCoords.push({z:Ue,x:Ye,y:xe}),mt)){mt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Ue,Ye,xe,Mt.numFeatures,Mt.numPoints,Mt.numSimplified),console.timeEnd("creation"));var _t="z"+Ue;this.stats[_t]=(this.stats[_t]||0)+1,this.total++}if(Mt.source=Ce,Ee){if(Ue===ct.maxZoom||Ue===Ee)continue;var xt=1<<Ee-Ue;if(Ye!==Math.floor(Je/xt)||xe!==Math.floor(it/xt))continue}else if(Ue===ct.indexMaxZoom||Mt.numPoints<=ct.indexMaxPoints)continue;if(Mt.source=null,Ce.length!==0){mt>1&&console.time("clipping");var At,It,Nt,Ot,Yt,Pt,Ne=.5*ct.buffer/ct.extent,ut=.5-Ne,wt=.5+Ne,Bt=1+Ne;At=It=Nt=Ot=null,Yt=_e(Ce,bt,Ye-Ne,Ye+wt,0,Mt.minX,Mt.maxX,ct),Pt=_e(Ce,bt,Ye+ut,Ye+Bt,0,Mt.minX,Mt.maxX,ct),Ce=null,Yt&&(At=_e(Yt,bt,xe-Ne,xe+wt,1,Mt.minY,Mt.maxY,ct),It=_e(Yt,bt,xe+ut,xe+Bt,1,Mt.minY,Mt.maxY,ct),Yt=null),Pt&&(Nt=_e(Pt,bt,xe-Ne,xe+wt,1,Mt.minY,Mt.maxY,ct),Ot=_e(Pt,bt,xe+ut,xe+Bt,1,Mt.minY,Mt.maxY,ct),Pt=null),mt>1&&console.timeEnd("clipping"),ht.push(At||[],Ue+1,2*Ye,2*xe),ht.push(It||[],Ue+1,2*Ye,2*xe+1),ht.push(Nt||[],Ue+1,2*Ye+1,2*xe),ht.push(Ot||[],Ue+1,2*Ye+1,2*xe+1)}}},be.prototype.getTile=function(Ce,Ue,Ye){var xe=this.options,Ee=xe.extent,Je=xe.debug;if(Ce<0||Ce>24)return null;var it=1<<Ce,ht=We(Ce,Ue=(Ue%it+it)%it,Ye);if(this.tiles[ht])return rt(this.tiles[ht],Ee);Je>1&&console.log("drilling down to z%d-%d-%d",Ce,Ue,Ye);for(var ct,mt=Ce,bt=Ue,Et=Ye;!ct&&mt>0;)mt--,bt=Math.floor(bt/2),Et=Math.floor(Et/2),ct=this.tiles[We(mt,bt,Et)];return ct&&ct.source?(Je>1&&console.log("found parent tile z%d-%d-%d",mt,bt,Et),Je>1&&console.time("drilling down"),this.splitTile(ct.source,mt,bt,Et,Ce,Ue,Ye),Je>1&&console.timeEnd("drilling down"),this.tiles[ht]?rt(this.tiles[ht],Ee):null):null};var st=function(Ce){function Ue(Ye,xe,Ee,Je){Ce.call(this,Ye,xe,Ee,Ge),Je&&(this.loadGeoJSON=Je)}return Ce&&(Ue.__proto__=Ce),(Ue.prototype=Object.create(Ce&&Ce.prototype)).constructor=Ue,Ue.prototype.loadData=function(Ye,xe){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=xe,this._pendingLoadDataParams=Ye,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},Ue.prototype._loadData=function(){var Ye=this;if(this._pendingCallback&&this._pendingLoadDataParams){var xe=this._pendingCallback,Ee=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var Je=!!(Ee&&Ee.request&&Ee.request.collectResourceTiming)&&new e.RequestPerformance(Ee.request);this.loadGeoJSON(Ee,function(it,ht){if(it||!ht)return xe(it);if(typeof ht!="object")return xe(new Error("Input data given to '"+Ee.source+"' is not a valid GeoJSON object."));(function bt(Et,Mt){var _t,xt=Et&&Et.type;if(xt==="FeatureCollection")for(_t=0;_t<Et.features.length;_t++)bt(Et.features[_t],Mt);else if(xt==="GeometryCollection")for(_t=0;_t<Et.geometries.length;_t++)bt(Et.geometries[_t],Mt);else if(xt==="Feature")bt(Et.geometry,Mt);else if(xt==="Polygon")m(Et.coordinates,Mt);else if(xt==="MultiPolygon")for(_t=0;_t<Et.coordinates.length;_t++)m(Et.coordinates[_t],Mt);return Et})(ht,!0);try{Ye._geoJSONIndex=Ee.cluster?new W(function(bt){var Et=bt.superclusterOptions,Mt=bt.clusterProperties;if(!Mt||!Et)return Et;for(var _t={},xt={},At={accumulated:null,zoom:0},It={properties:null},Nt=Object.keys(Mt),Ot=0,Yt=Nt;Ot<Yt.length;Ot+=1){var Pt=Yt[Ot],Ne=Mt[Pt],ut=Ne[0],wt=e.createExpression(Ne[1]),Bt=e.createExpression(typeof ut=="string"?[ut,["accumulated"],["get",Pt]]:ut);_t[Pt]=wt.value,xt[Pt]=Bt.value}return Et.map=function(Jt){It.properties=Jt;for(var er={},or=0,zt=Nt;or<zt.length;or+=1){var Qt=zt[or];er[Qt]=_t[Qt].evaluate(At,It)}return er},Et.reduce=function(Jt,er){It.properties=er;for(var or=0,zt=Nt;or<zt.length;or+=1){var Qt=zt[or];At.accumulated=Jt[Qt],Jt[Qt]=xt[Qt].evaluate(At,It)}},Et}(Ee)).load(ht.features):function(bt,Et){return new be(bt,Et)}(ht,Ee.geojsonVtOptions)}catch(bt){return xe(bt)}Ye.loaded={};var ct={};if(Je){var mt=Je.finish();mt&&(ct.resourceTiming={},ct.resourceTiming[Ee.source]=JSON.parse(JSON.stringify(mt)))}xe(null,ct)})}},Ue.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},Ue.prototype.reloadTile=function(Ye,xe){var Ee=this.loaded;return Ee&&Ee[Ye.uid]?Ce.prototype.reloadTile.call(this,Ye,xe):this.loadTile(Ye,xe)},Ue.prototype.loadGeoJSON=function(Ye,xe){if(Ye.request)e.getJSON(Ye.request,xe);else{if(typeof Ye.data!="string")return xe(new Error("Input data given to '"+Ye.source+"' is not a valid GeoJSON object."));try{return xe(null,JSON.parse(Ye.data))}catch{return xe(new Error("Input data given to '"+Ye.source+"' is not a valid GeoJSON object."))}}},Ue.prototype.removeSource=function(Ye,xe){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),xe()},Ue.prototype.getClusterExpansionZoom=function(Ye,xe){try{xe(null,this._geoJSONIndex.getClusterExpansionZoom(Ye.clusterId))}catch(Ee){xe(Ee)}},Ue.prototype.getClusterChildren=function(Ye,xe){try{xe(null,this._geoJSONIndex.getChildren(Ye.clusterId))}catch(Ee){xe(Ee)}},Ue.prototype.getClusterLeaves=function(Ye,xe){try{xe(null,this._geoJSONIndex.getLeaves(Ye.clusterId,Ye.limit,Ye.offset))}catch(Ee){xe(Ee)}},Ue}(f),ot=function(Ce){var Ue=this;this.self=Ce,this.actor=new e.Actor(Ce,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:f,geojson:st},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(Ye,xe){if(Ue.workerSourceTypes[Ye])throw new Error('Worker source with name "'+Ye+'" already registered.');Ue.workerSourceTypes[Ye]=xe},this.self.registerRTLTextPlugin=function(Ye){if(e.plugin.isParsed())throw new Error("RTL text plugin already registered.");e.plugin.applyArabicShaping=Ye.applyArabicShaping,e.plugin.processBidirectionalText=Ye.processBidirectionalText,e.plugin.processStyledBidirectionalText=Ye.processStyledBidirectionalText}};return ot.prototype.setReferrer=function(Ce,Ue){this.referrer=Ue},ot.prototype.setImages=function(Ce,Ue,Ye){for(var xe in this.availableImages[Ce]=Ue,this.workerSources[Ce]){var Ee=this.workerSources[Ce][xe];for(var Je in Ee)Ee[Je].availableImages=Ue}Ye()},ot.prototype.setLayers=function(Ce,Ue,Ye){this.getLayerIndex(Ce).replace(Ue),Ye()},ot.prototype.updateLayers=function(Ce,Ue,Ye){this.getLayerIndex(Ce).update(Ue.layers,Ue.removedIds),Ye()},ot.prototype.loadTile=function(Ce,Ue,Ye){this.getWorkerSource(Ce,Ue.type,Ue.source).loadTile(Ue,Ye)},ot.prototype.loadDEMTile=function(Ce,Ue,Ye){this.getDEMWorkerSource(Ce,Ue.source).loadTile(Ue,Ye)},ot.prototype.reloadTile=function(Ce,Ue,Ye){this.getWorkerSource(Ce,Ue.type,Ue.source).reloadTile(Ue,Ye)},ot.prototype.abortTile=function(Ce,Ue,Ye){this.getWorkerSource(Ce,Ue.type,Ue.source).abortTile(Ue,Ye)},ot.prototype.removeTile=function(Ce,Ue,Ye){this.getWorkerSource(Ce,Ue.type,Ue.source).removeTile(Ue,Ye)},ot.prototype.removeDEMTile=function(Ce,Ue){this.getDEMWorkerSource(Ce,Ue.source).removeTile(Ue)},ot.prototype.removeSource=function(Ce,Ue,Ye){if(this.workerSources[Ce]&&this.workerSources[Ce][Ue.type]&&this.workerSources[Ce][Ue.type][Ue.source]){var xe=this.workerSources[Ce][Ue.type][Ue.source];delete this.workerSources[Ce][Ue.type][Ue.source],xe.removeSource!==void 0?xe.removeSource(Ue,Ye):Ye()}},ot.prototype.loadWorkerSource=function(Ce,Ue,Ye){try{this.self.importScripts(Ue.url),Ye()}catch(xe){Ye(xe.toString())}},ot.prototype.syncRTLPluginState=function(Ce,Ue,Ye){try{e.plugin.setState(Ue);var xe=e.plugin.getPluginURL();if(e.plugin.isLoaded()&&!e.plugin.isParsed()&&xe!=null){this.self.importScripts(xe);var Ee=e.plugin.isParsed();Ye(Ee?void 0:new Error("RTL Text Plugin failed to import scripts from "+xe),Ee)}}catch(Je){Ye(Je.toString())}},ot.prototype.getAvailableImages=function(Ce){var Ue=this.availableImages[Ce];return Ue||(Ue=[]),Ue},ot.prototype.getLayerIndex=function(Ce){var Ue=this.layerIndexes[Ce];return Ue||(Ue=this.layerIndexes[Ce]=new i),Ue},ot.prototype.getWorkerSource=function(Ce,Ue,Ye){var xe=this;return this.workerSources[Ce]||(this.workerSources[Ce]={}),this.workerSources[Ce][Ue]||(this.workerSources[Ce][Ue]={}),this.workerSources[Ce][Ue][Ye]||(this.workerSources[Ce][Ue][Ye]=new this.workerSourceTypes[Ue]({send:function(Ee,Je,it){xe.actor.send(Ee,Je,it,Ce)}},this.getLayerIndex(Ce),this.getAvailableImages(Ce))),this.workerSources[Ce][Ue][Ye]},ot.prototype.getDEMWorkerSource=function(Ce,Ue){return this.demWorkerSources[Ce]||(this.demWorkerSources[Ce]={}),this.demWorkerSources[Ce][Ue]||(this.demWorkerSources[Ce][Ue]=new d),this.demWorkerSources[Ce][Ue]},ot.prototype.enforceCacheSizeLimit=function(Ce,Ue){e.enforceCacheSizeLimit(Ue)},typeof WorkerGlobalScope<"u"&&e.window!==void 0&&e.window instanceof WorkerGlobalScope&&(e.window.worker=new ot(e.window)),ot}),l(0,function(e){var o=e.createCommonjsModule(function(Y){function K(me){return!X(me)}function X(me){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var Be,tt,ft=new Blob([""],{type:"text/javascript"}),St=URL.createObjectURL(ft);try{tt=new Worker(St),Be=!0}catch{Be=!1}return tt&&tt.terminate(),URL.revokeObjectURL(St),Be}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var Be=document.createElement("canvas");Be.width=Be.height=1;var tt=Be.getContext("2d");if(!tt)return!1;var ft=tt.getImageData(0,0,1,1);return ft&&ft.width===Be.width}()?(re[Oe=me&&me.failIfMajorPerformanceCaveat]===void 0&&(re[Oe]=function(Be){var tt=function(St){var Ft=document.createElement("canvas"),Gt=Object.create(K.webGLContextAttributes);return Gt.failIfMajorPerformanceCaveat=St,Ft.probablySupportsContext?Ft.probablySupportsContext("webgl",Gt)||Ft.probablySupportsContext("experimental-webgl",Gt):Ft.supportsContext?Ft.supportsContext("webgl",Gt)||Ft.supportsContext("experimental-webgl",Gt):Ft.getContext("webgl",Gt)||Ft.getContext("experimental-webgl",Gt)}(Be);if(!tt)return!1;var ft=tt.createShader(tt.VERTEX_SHADER);return!(!ft||tt.isContextLost())&&(tt.shaderSource(ft,"void main() {}"),tt.compileShader(ft),tt.getShaderParameter(ft,tt.COMPILE_STATUS)===!0)}(Oe)),re[Oe]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var Oe}Y.exports?Y.exports=K:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=K,window.mapboxgl.notSupportedReason=X);var re={};K.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),r={create:function(Y,K,X){var re=e.window.document.createElement(Y);return K!==void 0&&(re.className=K),X&&X.appendChild(re),re},createNS:function(Y,K){return e.window.document.createElementNS(Y,K)}},i=e.window.document.documentElement.style;function u(Y){if(!i)return Y[0];for(var K=0;K<Y.length;K++)if(Y[K]in i)return Y[K];return Y[0]}var s,a=u(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);r.disableDrag=function(){i&&a&&(s=i[a],i[a]="none")},r.enableDrag=function(){i&&a&&(i[a]=s)};var c=u(["transform","WebkitTransform"]);r.setTransform=function(Y,K){Y.style[c]=K};var f=!1;try{var g=Object.defineProperty({},"passive",{get:function(){f=!0}});e.window.addEventListener("test",g,g),e.window.removeEventListener("test",g,g)}catch{f=!1}r.addEventListener=function(Y,K,X,re){re===void 0&&(re={}),Y.addEventListener(K,X,"passive"in re&&f?re:re.capture)},r.removeEventListener=function(Y,K,X,re){re===void 0&&(re={}),Y.removeEventListener(K,X,"passive"in re&&f?re:re.capture)};var d=function(Y){Y.preventDefault(),Y.stopPropagation(),e.window.removeEventListener("click",d,!0)};function m(Y){var K=Y.userImage;return!!(K&&K.render&&K.render())&&(Y.data.replace(new Uint8Array(K.data.buffer)),!0)}r.suppressClick=function(){e.window.addEventListener("click",d,!0),e.window.setTimeout(function(){e.window.removeEventListener("click",d,!0)},0)},r.mousePos=function(Y,K){var X=Y.getBoundingClientRect();return new e.Point(K.clientX-X.left-Y.clientLeft,K.clientY-X.top-Y.clientTop)},r.touchPos=function(Y,K){for(var X=Y.getBoundingClientRect(),re=[],me=0;me<K.length;me++)re.push(new e.Point(K[me].clientX-X.left-Y.clientLeft,K[me].clientY-X.top-Y.clientTop));return re},r.mouseButton=function(Y){return e.window.InstallTrigger!==void 0&&Y.button===2&&Y.ctrlKey&&e.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:Y.button},r.remove=function(Y){Y.parentNode&&Y.parentNode.removeChild(Y)};var y=function(Y){function K(){Y.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new e.RGBAImage({width:1,height:1}),this.dirty=!0}return Y&&(K.__proto__=Y),(K.prototype=Object.create(Y&&Y.prototype)).constructor=K,K.prototype.isLoaded=function(){return this.loaded},K.prototype.setLoaded=function(X){if(this.loaded!==X&&(this.loaded=X,X)){for(var re=0,me=this.requestors;re<me.length;re+=1){var Oe=me[re];this._notify(Oe.ids,Oe.callback)}this.requestors=[]}},K.prototype.getImage=function(X){return this.images[X]},K.prototype.addImage=function(X,re){this._validate(X,re)&&(this.images[X]=re)},K.prototype._validate=function(X,re){var me=!0;return this._validateStretch(re.stretchX,re.data&&re.data.width)||(this.fire(new e.ErrorEvent(new Error('Image "'+X+'" has invalid "stretchX" value'))),me=!1),this._validateStretch(re.stretchY,re.data&&re.data.height)||(this.fire(new e.ErrorEvent(new Error('Image "'+X+'" has invalid "stretchY" value'))),me=!1),this._validateContent(re.content,re)||(this.fire(new e.ErrorEvent(new Error('Image "'+X+'" has invalid "content" value'))),me=!1),me},K.prototype._validateStretch=function(X,re){if(!X)return!0;for(var me=0,Oe=0,Be=X;Oe<Be.length;Oe+=1){var tt=Be[Oe];if(tt[0]<me||tt[1]<tt[0]||re<tt[1])return!1;me=tt[1]}return!0},K.prototype._validateContent=function(X,re){return!(X&&(X.length!==4||X[0]<0||re.data.width<X[0]||X[1]<0||re.data.height<X[1]||X[2]<0||re.data.width<X[2]||X[3]<0||re.data.height<X[3]||X[2]<X[0]||X[3]<X[1]))},K.prototype.updateImage=function(X,re){re.version=this.images[X].version+1,this.images[X]=re,this.updatedImages[X]=!0},K.prototype.removeImage=function(X){var re=this.images[X];delete this.images[X],delete this.patterns[X],re.userImage&&re.userImage.onRemove&&re.userImage.onRemove()},K.prototype.listImages=function(){return Object.keys(this.images)},K.prototype.getImages=function(X,re){var me=!0;if(!this.isLoaded())for(var Oe=0,Be=X;Oe<Be.length;Oe+=1)this.images[Be[Oe]]||(me=!1);this.isLoaded()||me?this._notify(X,re):this.requestors.push({ids:X,callback:re})},K.prototype._notify=function(X,re){for(var me={},Oe=0,Be=X;Oe<Be.length;Oe+=1){var tt=Be[Oe];this.images[tt]||this.fire(new e.Event("styleimagemissing",{id:tt}));var ft=this.images[tt];ft?me[tt]={data:ft.data.clone(),pixelRatio:ft.pixelRatio,sdf:ft.sdf,version:ft.version,stretchX:ft.stretchX,stretchY:ft.stretchY,content:ft.content,hasRenderCallback:!!(ft.userImage&&ft.userImage.render)}:e.warnOnce('Image "'+tt+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}re(null,me)},K.prototype.getPixelSize=function(){var X=this.atlasImage;return{width:X.width,height:X.height}},K.prototype.getPattern=function(X){var re=this.patterns[X],me=this.getImage(X);if(!me)return null;if(re&&re.position.version===me.version)return re.position;if(re)re.position.version=me.version;else{var Oe={w:me.data.width+2,h:me.data.height+2,x:0,y:0},Be=new e.ImagePosition(Oe,me);this.patterns[X]={bin:Oe,position:Be}}return this._updatePatternAtlas(),this.patterns[X].position},K.prototype.bind=function(X){var re=X.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new e.Texture(X,this.atlasImage,re.RGBA),this.atlasTexture.bind(re.LINEAR,re.CLAMP_TO_EDGE)},K.prototype._updatePatternAtlas=function(){var X=[];for(var re in this.patterns)X.push(this.patterns[re].bin);var me=e.potpack(X),Oe=me.w,Be=me.h,tt=this.atlasImage;for(var ft in tt.resize({width:Oe||1,height:Be||1}),this.patterns){var St=this.patterns[ft].bin,Ft=St.x+1,Gt=St.y+1,$t=this.images[ft].data,sr=$t.width,lr=$t.height;e.RGBAImage.copy($t,tt,{x:0,y:0},{x:Ft,y:Gt},{width:sr,height:lr}),e.RGBAImage.copy($t,tt,{x:0,y:lr-1},{x:Ft,y:Gt-1},{width:sr,height:1}),e.RGBAImage.copy($t,tt,{x:0,y:0},{x:Ft,y:Gt+lr},{width:sr,height:1}),e.RGBAImage.copy($t,tt,{x:sr-1,y:0},{x:Ft-1,y:Gt},{width:1,height:lr}),e.RGBAImage.copy($t,tt,{x:0,y:0},{x:Ft+sr,y:Gt},{width:1,height:lr})}this.dirty=!0},K.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},K.prototype.dispatchRenderCallbacks=function(X){for(var re=0,me=X;re<me.length;re+=1){var Oe=me[re];if(!this.callbackDispatchedThisFrame[Oe]){this.callbackDispatchedThisFrame[Oe]=!0;var Be=this.images[Oe];m(Be)&&this.updateImage(Oe,Be)}}},K}(e.Evented),v=A,T=A,w=1e20;function A(Y,K,X,re,me,Oe){this.fontSize=Y||24,this.buffer=K===void 0?3:K,this.cutoff=re||.25,this.fontFamily=me||"sans-serif",this.fontWeight=Oe||"normal",this.radius=X||8;var Be=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=Be,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(Be*Be),this.gridInner=new Float64Array(Be*Be),this.f=new Float64Array(Be),this.d=new Float64Array(Be),this.z=new Float64Array(Be+1),this.v=new Int16Array(Be),this.middle=Math.round(Be/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function E(Y,K,X,re,me,Oe,Be){for(var tt=0;tt<K;tt++){for(var ft=0;ft<X;ft++)re[ft]=Y[ft*K+tt];for(M(re,me,Oe,Be,X),ft=0;ft<X;ft++)Y[ft*K+tt]=me[ft]}for(ft=0;ft<X;ft++){for(tt=0;tt<K;tt++)re[tt]=Y[ft*K+tt];for(M(re,me,Oe,Be,K),tt=0;tt<K;tt++)Y[ft*K+tt]=Math.sqrt(me[tt])}}function M(Y,K,X,re,me){X[0]=0,re[0]=-w,re[1]=+w;for(var Oe=1,Be=0;Oe<me;Oe++){for(var tt=(Y[Oe]+Oe*Oe-(Y[X[Be]]+X[Be]*X[Be]))/(2*Oe-2*X[Be]);tt<=re[Be];)Be--,tt=(Y[Oe]+Oe*Oe-(Y[X[Be]]+X[Be]*X[Be]))/(2*Oe-2*X[Be]);X[++Be]=Oe,re[Be]=tt,re[Be+1]=+w}for(Oe=0,Be=0;Oe<me;Oe++){for(;re[Be+1]<Oe;)Be++;K[Oe]=(Oe-X[Be])*(Oe-X[Be])+Y[X[Be]]}}A.prototype.draw=function(Y){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(Y,this.buffer,this.middle);for(var K=this.ctx.getImageData(0,0,this.size,this.size),X=new Uint8ClampedArray(this.size*this.size),re=0;re<this.size*this.size;re++){var me=K.data[4*re+3]/255;this.gridOuter[re]=me===1?0:me===0?w:Math.pow(Math.max(0,.5-me),2),this.gridInner[re]=me===1?w:me===0?0:Math.pow(Math.max(0,me-.5),2)}for(E(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),E(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),re=0;re<this.size*this.size;re++)X[re]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[re]-this.gridInner[re])/this.radius+this.cutoff))));return X},v.default=T;var b=function(Y,K){this.requestManager=Y,this.localIdeographFontFamily=K,this.entries={}};b.prototype.setURL=function(Y){this.url=Y},b.prototype.getGlyphs=function(Y,K){var X=this,re=[];for(var me in Y)for(var Oe=0,Be=Y[me];Oe<Be.length;Oe+=1)re.push({stack:me,id:Be[Oe]});e.asyncAll(re,function(tt,ft){var St=tt.stack,Ft=tt.id,Gt=X.entries[St];Gt||(Gt=X.entries[St]={glyphs:{},requests:{},ranges:{}});var $t=Gt.glyphs[Ft];if($t===void 0){if($t=X._tinySDF(Gt,St,Ft))return Gt.glyphs[Ft]=$t,void ft(null,{stack:St,id:Ft,glyph:$t});var sr=Math.floor(Ft/256);if(256*sr>65535)ft(new Error("glyphs > 65535 not supported"));else if(Gt.ranges[sr])ft(null,{stack:St,id:Ft,glyph:$t});else{var lr=Gt.requests[sr];lr||(lr=Gt.requests[sr]=[],b.loadGlyphRange(St,sr,X.url,X.requestManager,function(vr,ir){if(ir){for(var gr in ir)X._doesCharSupportLocalGlyph(+gr)||(Gt.glyphs[+gr]=ir[+gr]);Gt.ranges[sr]=!0}for(var Ar=0,Pr=lr;Ar<Pr.length;Ar+=1)(0,Pr[Ar])(vr,ir);delete Gt.requests[sr]})),lr.push(function(vr,ir){vr?ft(vr):ir&&ft(null,{stack:St,id:Ft,glyph:ir[Ft]||null})})}}else ft(null,{stack:St,id:Ft,glyph:$t})},function(tt,ft){if(tt)K(tt);else if(ft){for(var St={},Ft=0,Gt=ft;Ft<Gt.length;Ft+=1){var $t=Gt[Ft],sr=$t.stack,lr=$t.id,vr=$t.glyph;(St[sr]||(St[sr]={}))[lr]=vr&&{id:vr.id,bitmap:vr.bitmap.clone(),metrics:vr.metrics}}K(null,St)}})},b.prototype._doesCharSupportLocalGlyph=function(Y){return!!this.localIdeographFontFamily&&(e.isChar["CJK Unified Ideographs"](Y)||e.isChar["Hangul Syllables"](Y)||e.isChar.Hiragana(Y)||e.isChar.Katakana(Y))},b.prototype._tinySDF=function(Y,K,X){var re=this.localIdeographFontFamily;if(re&&this._doesCharSupportLocalGlyph(X)){var me=Y.tinySDF;if(!me){var Oe="400";/bold/i.test(K)?Oe="900":/medium/i.test(K)?Oe="500":/light/i.test(K)&&(Oe="200"),me=Y.tinySDF=new b.TinySDF(24,3,8,.25,re,Oe)}return{id:X,bitmap:new e.AlphaImage({width:30,height:30},me.draw(String.fromCharCode(X))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},b.loadGlyphRange=function(Y,K,X,re,me){var Oe=256*K,Be=Oe+255,tt=re.transformRequest(re.normalizeGlyphsURL(X).replace("{fontstack}",Y).replace("{range}",Oe+"-"+Be),e.ResourceType.Glyphs);e.getArrayBuffer(tt,function(ft,St){if(ft)me(ft);else if(St){for(var Ft={},Gt=0,$t=e.parseGlyphPBF(St);Gt<$t.length;Gt+=1){var sr=$t[Gt];Ft[sr.id]=sr}me(null,Ft)}})},b.TinySDF=v;var _=function(){this.specification=e.styleSpec.light.position};_.prototype.possiblyEvaluate=function(Y,K){return e.sphericalToCartesian(Y.expression.evaluate(K))},_.prototype.interpolate=function(Y,K,X){return{x:e.number(Y.x,K.x,X),y:e.number(Y.y,K.y,X),z:e.number(Y.z,K.z,X)}};var S=new e.Properties({anchor:new e.DataConstantProperty(e.styleSpec.light.anchor),position:new _,color:new e.DataConstantProperty(e.styleSpec.light.color),intensity:new e.DataConstantProperty(e.styleSpec.light.intensity)}),C=function(Y){function K(X){Y.call(this),this._transitionable=new e.Transitionable(S),this.setLight(X),this._transitioning=this._transitionable.untransitioned()}return Y&&(K.__proto__=Y),(K.prototype=Object.create(Y&&Y.prototype)).constructor=K,K.prototype.getLight=function(){return this._transitionable.serialize()},K.prototype.setLight=function(X,re){if(re===void 0&&(re={}),!this._validate(e.validateLight,X,re))for(var me in X){var Oe=X[me];e.endsWith(me,"-transition")?this._transitionable.setTransition(me.slice(0,-11),Oe):this._transitionable.setValue(me,Oe)}},K.prototype.updateTransitions=function(X){this._transitioning=this._transitionable.transitioned(X,this._transitioning)},K.prototype.hasTransition=function(){return this._transitioning.hasTransition()},K.prototype.recalculate=function(X){this.properties=this._transitioning.possiblyEvaluate(X)},K.prototype._validate=function(X,re,me){return(!me||me.validate!==!1)&&e.emitValidationErrors(this,X.call(e.validateStyle,e.extend({value:re,style:{glyphs:!0,sprite:!0},styleSpec:e.styleSpec})))},K}(e.Evented),k=function(Y,K){this.width=Y,this.height=K,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};k.prototype.getDash=function(Y,K){var X=Y.join(",")+String(K);return this.dashEntry[X]||(this.dashEntry[X]=this.addDash(Y,K)),this.dashEntry[X]},k.prototype.getDashRanges=function(Y,K,X){var re=[],me=Y.length%2==1?-Y[Y.length-1]*X:0,Oe=Y[0]*X,Be=!0;re.push({left:me,right:Oe,isDash:Be,zeroLength:Y[0]===0});for(var tt=Y[0],ft=1;ft<Y.length;ft++){var St=Y[ft];re.push({left:me=tt*X,right:Oe=(tt+=St)*X,isDash:Be=!Be,zeroLength:St===0})}return re},k.prototype.addRoundDash=function(Y,K,X){for(var re=K/2,me=-X;me<=X;me++)for(var Oe=this.width*(this.nextRow+X+me),Be=0,tt=Y[Be],ft=0;ft<this.width;ft++){ft/tt.right>1&&(tt=Y[++Be]);var St=Math.abs(ft-tt.left),Ft=Math.abs(ft-tt.right),Gt=Math.min(St,Ft),$t=void 0,sr=me/X*(re+1);if(tt.isDash){var lr=re-Math.abs(sr);$t=Math.sqrt(Gt*Gt+lr*lr)}else $t=re-Math.sqrt(Gt*Gt+sr*sr);this.data[Oe+ft]=Math.max(0,Math.min(255,$t+128))}},k.prototype.addRegularDash=function(Y){for(var K=Y.length-1;K>=0;--K){var X=Y[K],re=Y[K+1];X.zeroLength?Y.splice(K,1):re&&re.isDash===X.isDash&&(re.left=X.left,Y.splice(K,1))}var me=Y[0],Oe=Y[Y.length-1];me.isDash===Oe.isDash&&(me.left=Oe.left-this.width,Oe.right=me.right+this.width);for(var Be=this.width*this.nextRow,tt=0,ft=Y[tt],St=0;St<this.width;St++){St/ft.right>1&&(ft=Y[++tt]);var Ft=Math.abs(St-ft.left),Gt=Math.abs(St-ft.right),$t=Math.min(Ft,Gt);this.data[Be+St]=Math.max(0,Math.min(255,(ft.isDash?$t:-$t)+128))}},k.prototype.addDash=function(Y,K){var X=K?7:0,re=2*X+1;if(this.nextRow+re>this.height)return e.warnOnce("LineAtlas out of space"),null;for(var me=0,Oe=0;Oe<Y.length;Oe++)me+=Y[Oe];if(me!==0){var Be=this.width/me,tt=this.getDashRanges(Y,this.width,Be);K?this.addRoundDash(tt,Be,X):this.addRegularDash(tt)}var ft={y:(this.nextRow+X+.5)/this.height,height:2*X/this.height,width:me};return this.nextRow+=re,this.dirty=!0,ft},k.prototype.bind=function(Y){var K=Y.gl;this.texture?(K.bindTexture(K.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,K.texSubImage2D(K.TEXTURE_2D,0,0,0,this.width,this.height,K.ALPHA,K.UNSIGNED_BYTE,this.data))):(this.texture=K.createTexture(),K.bindTexture(K.TEXTURE_2D,this.texture),K.texParameteri(K.TEXTURE_2D,K.TEXTURE_WRAP_S,K.REPEAT),K.texParameteri(K.TEXTURE_2D,K.TEXTURE_WRAP_T,K.REPEAT),K.texParameteri(K.TEXTURE_2D,K.TEXTURE_MIN_FILTER,K.LINEAR),K.texParameteri(K.TEXTURE_2D,K.TEXTURE_MAG_FILTER,K.LINEAR),K.texImage2D(K.TEXTURE_2D,0,K.ALPHA,this.width,this.height,0,K.ALPHA,K.UNSIGNED_BYTE,this.data))};var L=function Y(K,X){this.workerPool=K,this.actors=[],this.currentActor=0,this.id=e.uniqueId();for(var re=this.workerPool.acquire(this.id),me=0;me<re.length;me++){var Oe=new Y.Actor(re[me],X,this.id);Oe.name="Worker "+me,this.actors.push(Oe)}};function I(Y,K,X){var re=function(me,Oe){if(me)return X(me);if(Oe){var Be=e.pick(e.extend(Oe,Y),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);Oe.vector_layers&&(Be.vectorLayers=Oe.vector_layers,Be.vectorLayerIds=Be.vectorLayers.map(function(tt){return tt.id})),Be.tiles=K.canonicalizeTileset(Be,Y.url),X(null,Be)}};return Y.url?e.getJSON(K.transformRequest(K.normalizeSourceURL(Y.url),e.ResourceType.Source),re):e.browser.frame(function(){return re(null,Y)})}L.prototype.broadcast=function(Y,K,X){e.asyncAll(this.actors,function(re,me){re.send(Y,K,me)},X=X||function(){})},L.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},L.prototype.remove=function(){this.actors.forEach(function(Y){Y.remove()}),this.actors=[],this.workerPool.release(this.id)},L.Actor=e.Actor;var R=function(Y,K,X){this.bounds=e.LngLatBounds.convert(this.validateBounds(Y)),this.minzoom=K||0,this.maxzoom=X||24};R.prototype.validateBounds=function(Y){return Array.isArray(Y)&&Y.length===4?[Math.max(-180,Y[0]),Math.max(-90,Y[1]),Math.min(180,Y[2]),Math.min(90,Y[3])]:[-180,-90,180,90]},R.prototype.contains=function(Y){var K=Math.pow(2,Y.z),X=Math.floor(e.mercatorXfromLng(this.bounds.getWest())*K),re=Math.floor(e.mercatorYfromLat(this.bounds.getNorth())*K),me=Math.ceil(e.mercatorXfromLng(this.bounds.getEast())*K),Oe=Math.ceil(e.mercatorYfromLat(this.bounds.getSouth())*K);return Y.x>=X&&Y.x<me&&Y.y>=re&&Y.y<Oe};var V=function(Y){function K(X,re,me,Oe){if(Y.call(this),this.id=X,this.dispatcher=me,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,e.extend(this,e.pick(re,["url","scheme","tileSize","promoteId"])),this._options=e.extend({type:"vector"},re),this._collectResourceTiming=re.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(Oe)}return Y&&(K.__proto__=Y),(K.prototype=Object.create(Y&&Y.prototype)).constructor=K,K.prototype.load=function(){var X=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=I(this._options,this.map._requestManager,function(re,me){X._tileJSONRequest=null,X._loaded=!0,re?X.fire(new e.ErrorEvent(re)):me&&(e.extend(X,me),me.bounds&&(X.tileBounds=new R(me.bounds,X.minzoom,X.maxzoom)),e.postTurnstileEvent(me.tiles,X.map._requestManager._customAccessToken),e.postMapLoadEvent(me.tiles,X.map._getMapId(),X.map._requestManager._skuToken,X.map._requestManager._customAccessToken),X.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})),X.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})))})},K.prototype.loaded=function(){return this._loaded},K.prototype.hasTile=function(X){return!this.tileBounds||this.tileBounds.contains(X.canonical)},K.prototype.onAdd=function(X){this.map=X,this.load()},K.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},K.prototype.serialize=function(){return e.extend({},this._options)},K.prototype.loadTile=function(X,re){var me=this.map._requestManager.normalizeTileURL(X.tileID.canonical.url(this.tiles,this.scheme)),Oe={request:this.map._requestManager.transformRequest(me,e.ResourceType.Tile),uid:X.uid,tileID:X.tileID,zoom:X.tileID.overscaledZ,tileSize:this.tileSize*X.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:e.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function Be(tt,ft){return delete X.request,X.aborted?re(null):tt&&tt.status!==404?re(tt):(ft&&ft.resourceTiming&&(X.resourceTiming=ft.resourceTiming),this.map._refreshExpiredTiles&&ft&&X.setExpiryData(ft),X.loadVectorData(ft,this.map.painter),e.cacheEntryPossiblyAdded(this.dispatcher),re(null),void(X.reloadCallback&&(this.loadTile(X,X.reloadCallback),X.reloadCallback=null)))}Oe.request.collectResourceTiming=this._collectResourceTiming,X.actor&&X.state!=="expired"?X.state==="loading"?X.reloadCallback=re:X.request=X.actor.send("reloadTile",Oe,Be.bind(this)):(X.actor=this.dispatcher.getActor(),X.request=X.actor.send("loadTile",Oe,Be.bind(this)))},K.prototype.abortTile=function(X){X.request&&(X.request.cancel(),delete X.request),X.actor&&X.actor.send("abortTile",{uid:X.uid,type:this.type,source:this.id},void 0)},K.prototype.unloadTile=function(X){X.unloadVectorData(),X.actor&&X.actor.send("removeTile",{uid:X.uid,type:this.type,source:this.id},void 0)},K.prototype.hasTransition=function(){return!1},K}(e.Evented),O=function(Y){function K(X,re,me,Oe){Y.call(this),this.id=X,this.dispatcher=me,this.setEventedParent(Oe),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=e.extend({type:"raster"},re),e.extend(this,e.pick(re,["url","scheme","tileSize"]))}return Y&&(K.__proto__=Y),(K.prototype=Object.create(Y&&Y.prototype)).constructor=K,K.prototype.load=function(){var X=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=I(this._options,this.map._requestManager,function(re,me){X._tileJSONRequest=null,X._loaded=!0,re?X.fire(new e.ErrorEvent(re)):me&&(e.extend(X,me),me.bounds&&(X.tileBounds=new R(me.bounds,X.minzoom,X.maxzoom)),e.postTurnstileEvent(me.tiles),e.postMapLoadEvent(me.tiles,X.map._getMapId(),X.map._requestManager._skuToken),X.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})),X.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})))})},K.prototype.loaded=function(){return this._loaded},K.prototype.onAdd=function(X){this.map=X,this.load()},K.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},K.prototype.serialize=function(){return e.extend({},this._options)},K.prototype.hasTile=function(X){return!this.tileBounds||this.tileBounds.contains(X.canonical)},K.prototype.loadTile=function(X,re){var me=this,Oe=this.map._requestManager.normalizeTileURL(X.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);X.request=e.getImage(this.map._requestManager.transformRequest(Oe,e.ResourceType.Tile),function(Be,tt){if(delete X.request,X.aborted)X.state="unloaded",re(null);else if(Be)X.state="errored",re(Be);else if(tt){me.map._refreshExpiredTiles&&X.setExpiryData(tt),delete tt.cacheControl,delete tt.expires;var ft=me.map.painter.context,St=ft.gl;X.texture=me.map.painter.getTileTexture(tt.width),X.texture?X.texture.update(tt,{useMipmap:!0}):(X.texture=new e.Texture(ft,tt,St.RGBA,{useMipmap:!0}),X.texture.bind(St.LINEAR,St.CLAMP_TO_EDGE,St.LINEAR_MIPMAP_NEAREST),ft.extTextureFilterAnisotropic&&St.texParameterf(St.TEXTURE_2D,ft.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,ft.extTextureFilterAnisotropicMax)),X.state="loaded",e.cacheEntryPossiblyAdded(me.dispatcher),re(null)}})},K.prototype.abortTile=function(X,re){X.request&&(X.request.cancel(),delete X.request),re()},K.prototype.unloadTile=function(X,re){X.texture&&this.map.painter.saveTileTexture(X.texture),re()},K.prototype.hasTransition=function(){return!1},K}(e.Evented),J=function(Y){function K(X,re,me,Oe){Y.call(this,X,re,me,Oe),this.type="raster-dem",this.maxzoom=22,this._options=e.extend({type:"raster-dem"},re),this.encoding=re.encoding||"mapbox"}return Y&&(K.__proto__=Y),(K.prototype=Object.create(Y&&Y.prototype)).constructor=K,K.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},K.prototype.loadTile=function(X,re){var me=this.map._requestManager.normalizeTileURL(X.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function Oe(Be,tt){Be&&(X.state="errored",re(Be)),tt&&(X.dem=tt,X.needsHillshadePrepare=!0,X.state="loaded",re(null))}X.request=e.getImage(this.map._requestManager.transformRequest(me,e.ResourceType.Tile),function(Be,tt){if(delete X.request,X.aborted)X.state="unloaded",re(null);else if(Be)X.state="errored",re(Be);else if(tt){this.map._refreshExpiredTiles&&X.setExpiryData(tt),delete tt.cacheControl,delete tt.expires;var ft=e.window.ImageBitmap&&tt instanceof e.window.ImageBitmap&&e.offscreenCanvasSupported()?tt:e.browser.getImageData(tt,1),St={uid:X.uid,coord:X.tileID,source:this.id,rawImageData:ft,encoding:this.encoding};X.actor&&X.state!=="expired"||(X.actor=this.dispatcher.getActor(),X.actor.send("loadDEMTile",St,Oe.bind(this)))}}.bind(this)),X.neighboringTiles=this._getNeighboringTiles(X.tileID)},K.prototype._getNeighboringTiles=function(X){var re=X.canonical,me=Math.pow(2,re.z),Oe=(re.x-1+me)%me,Be=re.x===0?X.wrap-1:X.wrap,tt=(re.x+1+me)%me,ft=re.x+1===me?X.wrap+1:X.wrap,St={};return St[new e.OverscaledTileID(X.overscaledZ,Be,re.z,Oe,re.y).key]={backfilled:!1},St[new e.OverscaledTileID(X.overscaledZ,ft,re.z,tt,re.y).key]={backfilled:!1},re.y>0&&(St[new e.OverscaledTileID(X.overscaledZ,Be,re.z,Oe,re.y-1).key]={backfilled:!1},St[new e.OverscaledTileID(X.overscaledZ,X.wrap,re.z,re.x,re.y-1).key]={backfilled:!1},St[new e.OverscaledTileID(X.overscaledZ,ft,re.z,tt,re.y-1).key]={backfilled:!1}),re.y+1<me&&(St[new e.OverscaledTileID(X.overscaledZ,Be,re.z,Oe,re.y+1).key]={backfilled:!1},St[new e.OverscaledTileID(X.overscaledZ,X.wrap,re.z,re.x,re.y+1).key]={backfilled:!1},St[new e.OverscaledTileID(X.overscaledZ,ft,re.z,tt,re.y+1).key]={backfilled:!1}),St},K.prototype.unloadTile=function(X){X.demTexture&&this.map.painter.saveTileTexture(X.demTexture),X.fbo&&(X.fbo.destroy(),delete X.fbo),X.dem&&delete X.dem,delete X.neighboringTiles,X.state="unloaded",X.actor&&X.actor.send("removeDEMTile",{uid:X.uid,source:this.id})},K}(O),D=function(Y){function K(X,re,me,Oe){Y.call(this),this.id=X,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=me.getActor(),this.setEventedParent(Oe),this._data=re.data,this._options=e.extend({},re),this._collectResourceTiming=re.collectResourceTiming,this._resourceTiming=[],re.maxzoom!==void 0&&(this.maxzoom=re.maxzoom),re.type&&(this.type=re.type),re.attribution&&(this.attribution=re.attribution),this.promoteId=re.promoteId;var Be=e.EXTENT/this.tileSize;this.workerOptions=e.extend({source:this.id,cluster:re.cluster||!1,geojsonVtOptions:{buffer:(re.buffer!==void 0?re.buffer:128)*Be,tolerance:(re.tolerance!==void 0?re.tolerance:.375)*Be,extent:e.EXTENT,maxZoom:this.maxzoom,lineMetrics:re.lineMetrics||!1,generateId:re.generateId||!1},superclusterOptions:{maxZoom:re.clusterMaxZoom!==void 0?Math.min(re.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,extent:e.EXTENT,radius:(re.clusterRadius||50)*Be,log:!1,generateId:re.generateId||!1},clusterProperties:re.clusterProperties},re.workerOptions)}return Y&&(K.__proto__=Y),(K.prototype=Object.create(Y&&Y.prototype)).constructor=K,K.prototype.load=function(){var X=this;this.fire(new e.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(re){if(re)X.fire(new e.ErrorEvent(re));else{var me={dataType:"source",sourceDataType:"metadata"};X._collectResourceTiming&&X._resourceTiming&&X._resourceTiming.length>0&&(me.resourceTiming=X._resourceTiming,X._resourceTiming=[]),X.fire(new e.Event("data",me))}})},K.prototype.onAdd=function(X){this.map=X,this.load()},K.prototype.setData=function(X){var re=this;return this._data=X,this.fire(new e.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(me){if(me)re.fire(new e.ErrorEvent(me));else{var Oe={dataType:"source",sourceDataType:"content"};re._collectResourceTiming&&re._resourceTiming&&re._resourceTiming.length>0&&(Oe.resourceTiming=re._resourceTiming,re._resourceTiming=[]),re.fire(new e.Event("data",Oe))}}),this},K.prototype.getClusterExpansionZoom=function(X,re){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:X,source:this.id},re),this},K.prototype.getClusterChildren=function(X,re){return this.actor.send("geojson.getClusterChildren",{clusterId:X,source:this.id},re),this},K.prototype.getClusterLeaves=function(X,re,me,Oe){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:X,limit:re,offset:me},Oe),this},K.prototype._updateWorkerData=function(X){var re=this;this._loaded=!1;var me=e.extend({},this.workerOptions),Oe=this._data;typeof Oe=="string"?(me.request=this.map._requestManager.transformRequest(e.browser.resolveURL(Oe),e.ResourceType.Source),me.request.collectResourceTiming=this._collectResourceTiming):me.data=JSON.stringify(Oe),this.actor.send(this.type+".loadData",me,function(Be,tt){re._removed||tt&&tt.abandoned||(re._loaded=!0,tt&&tt.resourceTiming&&tt.resourceTiming[re.id]&&(re._resourceTiming=tt.resourceTiming[re.id].slice(0)),re.actor.send(re.type+".coalesce",{source:me.source},null),X(Be))})},K.prototype.loaded=function(){return this._loaded},K.prototype.loadTile=function(X,re){var me=this,Oe=X.actor?"reloadTile":"loadTile";X.actor=this.actor,X.request=this.actor.send(Oe,{type:this.type,uid:X.uid,tileID:X.tileID,zoom:X.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:e.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(Be,tt){return delete X.request,X.unloadVectorData(),X.aborted?re(null):Be?re(Be):(X.loadVectorData(tt,me.map.painter,Oe==="reloadTile"),re(null))})},K.prototype.abortTile=function(X){X.request&&(X.request.cancel(),delete X.request),X.aborted=!0},K.prototype.unloadTile=function(X){X.unloadVectorData(),this.actor.send("removeTile",{uid:X.uid,type:this.type,source:this.id})},K.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},K.prototype.serialize=function(){return e.extend({},this._options,{type:this.type,data:this._data})},K.prototype.hasTransition=function(){return!1},K}(e.Evented),B=e.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),N=function(Y){function K(X,re,me,Oe){Y.call(this),this.id=X,this.dispatcher=me,this.coordinates=re.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(Oe),this.options=re}return Y&&(K.__proto__=Y),(K.prototype=Object.create(Y&&Y.prototype)).constructor=K,K.prototype.load=function(X,re){var me=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this.url=this.options.url,e.getImage(this.map._requestManager.transformRequest(this.url,e.ResourceType.Image),function(Oe,Be){me._loaded=!0,Oe?me.fire(new e.ErrorEvent(Oe)):Be&&(me.image=Be,X&&(me.coordinates=X),re&&re(),me._finishLoading())})},K.prototype.loaded=function(){return this._loaded},K.prototype.updateImage=function(X){var re=this;return this.image&&X.url?(this.options.url=X.url,this.load(X.coordinates,function(){re.texture=null}),this):this},K.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})))},K.prototype.onAdd=function(X){this.map=X,this.load()},K.prototype.setCoordinates=function(X){var re=this;this.coordinates=X;var me=X.map(e.MercatorCoordinate.fromLngLat);this.tileID=function(Be){for(var tt=1/0,ft=1/0,St=-1/0,Ft=-1/0,Gt=0,$t=Be;Gt<$t.length;Gt+=1){var sr=$t[Gt];tt=Math.min(tt,sr.x),ft=Math.min(ft,sr.y),St=Math.max(St,sr.x),Ft=Math.max(Ft,sr.y)}var lr=Math.max(St-tt,Ft-ft),vr=Math.max(0,Math.floor(-Math.log(lr)/Math.LN2)),ir=Math.pow(2,vr);return new e.CanonicalTileID(vr,Math.floor((tt+St)/2*ir),Math.floor((ft+Ft)/2*ir))}(me),this.minzoom=this.maxzoom=this.tileID.z;var Oe=me.map(function(Be){return re.tileID.getTilePoint(Be)._round()});return this._boundsArray=new e.StructArrayLayout4i8,this._boundsArray.emplaceBack(Oe[0].x,Oe[0].y,0,0),this._boundsArray.emplaceBack(Oe[1].x,Oe[1].y,e.EXTENT,0),this._boundsArray.emplaceBack(Oe[3].x,Oe[3].y,0,e.EXTENT),this._boundsArray.emplaceBack(Oe[2].x,Oe[2].y,e.EXTENT,e.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})),this},K.prototype.prepare=function(){if(Object.keys(this.tiles).length!==0&&this.image){var X=this.map.painter.context,re=X.gl;for(var me in this.boundsBuffer||(this.boundsBuffer=X.createVertexBuffer(this._boundsArray,B.members)),this.boundsSegments||(this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new e.Texture(X,this.image,re.RGBA),this.texture.bind(re.LINEAR,re.CLAMP_TO_EDGE)),this.tiles){var Oe=this.tiles[me];Oe.state!=="loaded"&&(Oe.state="loaded",Oe.texture=this.texture)}}},K.prototype.loadTile=function(X,re){this.tileID&&this.tileID.equals(X.tileID.canonical)?(this.tiles[String(X.tileID.wrap)]=X,X.buckets={},re(null)):(X.state="errored",re(null))},K.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},K.prototype.hasTransition=function(){return!1},K}(e.Evented),F=function(Y){function K(X,re,me,Oe){Y.call(this,X,re,me,Oe),this.roundZoom=!0,this.type="video",this.options=re}return Y&&(K.__proto__=Y),(K.prototype=Object.create(Y&&Y.prototype)).constructor=K,K.prototype.load=function(){var X=this;this._loaded=!1;var re=this.options;this.urls=[];for(var me=0,Oe=re.urls;me<Oe.length;me+=1)this.urls.push(this.map._requestManager.transformRequest(Oe[me],e.ResourceType.Source).url);e.getVideo(this.urls,function(Be,tt){X._loaded=!0,Be?X.fire(new e.ErrorEvent(Be)):tt&&(X.video=tt,X.video.loop=!0,X.video.addEventListener("playing",function(){X.map.triggerRepaint()}),X.map&&X.video.play(),X._finishLoading())})},K.prototype.pause=function(){this.video&&this.video.pause()},K.prototype.play=function(){this.video&&this.video.play()},K.prototype.seek=function(X){if(this.video){var re=this.video.seekable;X<re.start(0)||X>re.end(0)?this.fire(new e.ErrorEvent(new e.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+re.start(0)+" and "+re.end(0)+"-second mark."))):this.video.currentTime=X}},K.prototype.getVideo=function(){return this.video},K.prototype.onAdd=function(X){this.map||(this.map=X,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},K.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var X=this.map.painter.context,re=X.gl;for(var me in this.boundsBuffer||(this.boundsBuffer=X.createVertexBuffer(this._boundsArray,B.members)),this.boundsSegments||(this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(re.LINEAR,re.CLAMP_TO_EDGE),re.texSubImage2D(re.TEXTURE_2D,0,0,0,re.RGBA,re.UNSIGNED_BYTE,this.video)):(this.texture=new e.Texture(X,this.video,re.RGBA),this.texture.bind(re.LINEAR,re.CLAMP_TO_EDGE)),this.tiles){var Oe=this.tiles[me];Oe.state!=="loaded"&&(Oe.state="loaded",Oe.texture=this.texture)}}},K.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},K.prototype.hasTransition=function(){return this.video&&!this.video.paused},K}(N),H=function(Y){function K(X,re,me,Oe){Y.call(this,X,re,me,Oe),re.coordinates?Array.isArray(re.coordinates)&&re.coordinates.length===4&&!re.coordinates.some(function(Be){return!Array.isArray(Be)||Be.length!==2||Be.some(function(tt){return typeof tt!="number"})})||this.fire(new e.ErrorEvent(new e.ValidationError("sources."+X,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new e.ErrorEvent(new e.ValidationError("sources."+X,null,'missing required property "coordinates"'))),re.animate&&typeof re.animate!="boolean"&&this.fire(new e.ErrorEvent(new e.ValidationError("sources."+X,null,'optional "animate" property must be a boolean value'))),re.canvas?typeof re.canvas=="string"||re.canvas instanceof e.window.HTMLCanvasElement||this.fire(new e.ErrorEvent(new e.ValidationError("sources."+X,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new e.ErrorEvent(new e.ValidationError("sources."+X,null,'missing required property "canvas"'))),this.options=re,this.animate=re.animate===void 0||re.animate}return Y&&(K.__proto__=Y),(K.prototype=Object.create(Y&&Y.prototype)).constructor=K,K.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof e.window.HTMLCanvasElement?this.options.canvas:e.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new e.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},K.prototype.getCanvas=function(){return this.canvas},K.prototype.onAdd=function(X){this.map=X,this.load(),this.canvas&&this.animate&&this.play()},K.prototype.onRemove=function(){this.pause()},K.prototype.prepare=function(){var X=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,X=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,X=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var re=this.map.painter.context,me=re.gl;for(var Oe in this.boundsBuffer||(this.boundsBuffer=re.createVertexBuffer(this._boundsArray,B.members)),this.boundsSegments||(this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(X||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new e.Texture(re,this.canvas,me.RGBA,{premultiply:!0}),this.tiles){var Be=this.tiles[Oe];Be.state!=="loaded"&&(Be.state="loaded",Be.texture=this.texture)}}},K.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},K.prototype.hasTransition=function(){return this._playing},K.prototype._hasInvalidDimensions=function(){for(var X=0,re=[this.canvas.width,this.canvas.height];X<re.length;X+=1){var me=re[X];if(isNaN(me)||me<=0)return!0}return!1},K}(N),j={vector:V,raster:O,"raster-dem":J,geojson:D,video:F,image:N,canvas:H};function G(Y,K){var X=e.identity([]);return e.translate(X,X,[1,1,0]),e.scale(X,X,[.5*Y.width,.5*Y.height,1]),e.multiply(X,X,Y.calculatePosMatrix(K.toUnwrapped()))}function W(Y,K,X,re,me,Oe){var Be=function(vr,ir,gr){if(vr)for(var Ar=0,Pr=vr;Ar<Pr.length;Ar+=1){var Gr=ir[Pr[Ar]];if(Gr&&Gr.source===gr&&Gr.type==="fill-extrusion")return!0}else for(var Fr in ir){var Yr=ir[Fr];if(Yr.source===gr&&Yr.type==="fill-extrusion")return!0}return!1}(me&&me.layers,K,Y.id),tt=Oe.maxPitchScaleFactor(),ft=Y.tilesIn(re,tt,Be);ft.sort(Q);for(var St=[],Ft=0,Gt=ft;Ft<Gt.length;Ft+=1){var $t=Gt[Ft];St.push({wrappedTileID:$t.tileID.wrapped().key,queryResults:$t.tile.queryRenderedFeatures(K,X,Y._state,$t.queryGeometry,$t.cameraQueryGeometry,$t.scale,me,Oe,tt,G(Y.transform,$t.tileID))})}var sr=function(vr){for(var ir={},gr={},Ar=0,Pr=vr;Ar<Pr.length;Ar+=1){var Gr=Pr[Ar],Fr=Gr.queryResults,Yr=Gr.wrappedTileID,an=gr[Yr]=gr[Yr]||{};for(var mn in Fr)for(var pn=Fr[mn],xn=an[mn]=an[mn]||{},Ln=ir[mn]=ir[mn]||[],Jn=0,Vn=pn;Jn<Vn.length;Jn+=1){var oa=Vn[Jn];xn[oa.featureIndex]||(xn[oa.featureIndex]=!0,Ln.push(oa))}}return ir}(St);for(var lr in sr)sr[lr].forEach(function(vr){var ir=vr.feature,gr=Y.getFeatureState(ir.layer["source-layer"],ir.id);ir.source=ir.layer.source,ir.layer["source-layer"]&&(ir.sourceLayer=ir.layer["source-layer"]),ir.state=gr});return sr}function Q(Y,K){var X=Y.tileID,re=K.tileID;return X.overscaledZ-re.overscaledZ||X.canonical.y-re.canonical.y||X.wrap-re.wrap||X.canonical.x-re.canonical.x}var $=function(Y,K){this.max=Y,this.onRemove=K,this.reset()};$.prototype.reset=function(){for(var Y in this.data)for(var K=0,X=this.data[Y];K<X.length;K+=1){var re=X[K];re.timeout&&clearTimeout(re.timeout),this.onRemove(re.value)}return this.data={},this.order=[],this},$.prototype.add=function(Y,K,X){var re=this,me=Y.wrapped().key;this.data[me]===void 0&&(this.data[me]=[]);var Oe={value:K,timeout:void 0};if(X!==void 0&&(Oe.timeout=setTimeout(function(){re.remove(Y,Oe)},X)),this.data[me].push(Oe),this.order.push(me),this.order.length>this.max){var Be=this._getAndRemoveByKey(this.order[0]);Be&&this.onRemove(Be)}return this},$.prototype.has=function(Y){return Y.wrapped().key in this.data},$.prototype.getAndRemove=function(Y){return this.has(Y)?this._getAndRemoveByKey(Y.wrapped().key):null},$.prototype._getAndRemoveByKey=function(Y){var K=this.data[Y].shift();return K.timeout&&clearTimeout(K.timeout),this.data[Y].length===0&&delete this.data[Y],this.order.splice(this.order.indexOf(Y),1),K.value},$.prototype.getByKey=function(Y){var K=this.data[Y];return K?K[0].value:null},$.prototype.get=function(Y){return this.has(Y)?this.data[Y.wrapped().key][0].value:null},$.prototype.remove=function(Y,K){if(!this.has(Y))return this;var X=Y.wrapped().key,re=K===void 0?0:this.data[X].indexOf(K),me=this.data[X][re];return this.data[X].splice(re,1),me.timeout&&clearTimeout(me.timeout),this.data[X].length===0&&delete this.data[X],this.onRemove(me.value),this.order.splice(this.order.indexOf(X),1),this},$.prototype.setMaxSize=function(Y){for(this.max=Y;this.order.length>this.max;){var K=this._getAndRemoveByKey(this.order[0]);K&&this.onRemove(K)}return this},$.prototype.filter=function(Y){var K=[];for(var X in this.data)for(var re=0,me=this.data[X];re<me.length;re+=1){var Oe=me[re];Y(Oe.value)||K.push(Oe)}for(var Be=0,tt=K;Be<tt.length;Be+=1){var ft=tt[Be];this.remove(ft.value.tileID,ft)}};var ee=function(Y,K,X){this.context=Y;var re=Y.gl;this.buffer=re.createBuffer(),this.dynamicDraw=!!X,this.context.unbindVAO(),Y.bindElementBuffer.set(this.buffer),re.bufferData(re.ELEMENT_ARRAY_BUFFER,K.arrayBuffer,this.dynamicDraw?re.DYNAMIC_DRAW:re.STATIC_DRAW),this.dynamicDraw||delete K.arrayBuffer};ee.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},ee.prototype.updateData=function(Y){var K=this.context.gl;this.context.unbindVAO(),this.bind(),K.bufferSubData(K.ELEMENT_ARRAY_BUFFER,0,Y.arrayBuffer)},ee.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var ie={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},ae=function(Y,K,X,re){this.length=K.length,this.attributes=X,this.itemSize=K.bytesPerElement,this.dynamicDraw=re,this.context=Y;var me=Y.gl;this.buffer=me.createBuffer(),Y.bindVertexBuffer.set(this.buffer),me.bufferData(me.ARRAY_BUFFER,K.arrayBuffer,this.dynamicDraw?me.DYNAMIC_DRAW:me.STATIC_DRAW),this.dynamicDraw||delete K.arrayBuffer};ae.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},ae.prototype.updateData=function(Y){var K=this.context.gl;this.bind(),K.bufferSubData(K.ARRAY_BUFFER,0,Y.arrayBuffer)},ae.prototype.enableAttributes=function(Y,K){for(var X=0;X<this.attributes.length;X++){var re=K.attributes[this.attributes[X].name];re!==void 0&&Y.enableVertexAttribArray(re)}},ae.prototype.setVertexAttribPointers=function(Y,K,X){for(var re=0;re<this.attributes.length;re++){var me=this.attributes[re],Oe=K.attributes[me.name];Oe!==void 0&&Y.vertexAttribPointer(Oe,me.components,Y[ie[me.type]],!1,this.itemSize,me.offset+this.itemSize*(X||0))}},ae.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var oe=function(Y){this.gl=Y.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};oe.prototype.get=function(){return this.current},oe.prototype.set=function(Y){},oe.prototype.getDefault=function(){return this.default},oe.prototype.setDefault=function(){this.set(this.default)};var de=function(Y){function K(){Y.apply(this,arguments)}return Y&&(K.__proto__=Y),(K.prototype=Object.create(Y&&Y.prototype)).constructor=K,K.prototype.getDefault=function(){return e.Color.transparent},K.prototype.set=function(X){var re=this.current;(X.r!==re.r||X.g!==re.g||X.b!==re.b||X.a!==re.a||this.dirty)&&(this.gl.clearColor(X.r,X.g,X.b,X.a),this.current=X,this.dirty=!1)},K}(oe),le=function(Y){function K(){Y.apply(this,arguments)}return Y&&(K.__proto__=Y),(K.prototype=Object.create(Y&&Y.prototype)).constructor=K,K.prototype.getDefault=function(){return 1},K.prototype.set=function(X){(X!==this.current||this.dirty)&&(this.gl.clearDepth(X),this.current=X,this.dirty=!1)},K}(oe),fe=function(Y){function K(){Y.apply(this,arguments)}return Y&&(K.__proto__=Y),(K.prototype=Object.create(Y&&Y.prototype)).constructor=K,K.prototype.getDefault=function(){return 0},K.prototype.set=function(X){(X!==this.current||this.dirty)&&(this.gl.clearStencil(X),this.current=X,this.dirty=!1)},K}(oe),ue=function(Y){function K(){Y.apply(this,arguments)}return Y&&(K.__proto__=Y),(K.prototype=Object.create(Y&&Y.prototype)).constructor=K,K.prototype.getDefault=function(){return[!0,!0,!0,!0]},K.prototype.set=function(X){var re=this.current;(X[0]!==re[0]||X[1]!==re[1]||X[2]!==re[2]||X[3]!==re[3]||this.dirty)&&(this.gl.colorMask(X[0],X[1],X[2],X[3]),this.current=X,this.dirty=!1)},K}(oe),we=function(Y){function K(){Y.apply(this,arguments)}return Y&&(K.__proto__=Y),(K.prototype=Object.create(Y&&Y.prototype)).constructor=K,K.prototype.getDefault=function(){return!0},K.prototype.set=function(X){(X!==this.current||this.dirty)&&(this.gl.depthMask(X),this.current=X,this.dirty=!1)},K}(oe),Ae=function(Y){function K(){Y.apply(this,arguments)}return Y&&(K.__proto__=Y),(K.prototype=Object.create(Y&&Y.prototype)).constructor=K,K.prototype.getDefault=function(){return 255},K.prototype.set=function(X){(X!==this.current||this.dirty)&&(this.gl.stencilMask(X),this.current=X,this.dirty=!1)},K}(oe),Se=function(Y){function K(){Y.apply(this,arguments)}return Y&&(K.__proto__=Y),(K.prototype=Object.create(Y&&Y.prototype)).constructor=K,K.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},K.prototype.set=function(X){var re=this.current;(X.func!==re.func||X.ref!==re.ref||X.mask!==re.mask||this.dirty)&&(this.gl.stencilFunc(X.func,X.ref,X.mask),this.current=X,this.dirty=!1)},K}(oe),ke=function(Y){function K(){Y.apply(this,arguments)}return Y&&(K.__proto__=Y),(K.prototype=Object.create(Y&&Y.prototype)).constructor=K,K.prototype.getDefault=function(){var X=this.gl;return[X.KEEP,X.KEEP,X.KEEP]},K.prototype.set=function(X){var re=this.current;(X[0]!==re[0]||X[1]!==re[1]||X[2]!==re[2]||this.dirty)&&(this.gl.stencilOp(X[0],X[1],X[2]),this.current=X,this.dirty=!1)},K}(oe),Me=function(Y){function K(){Y.apply(this,arguments)}return Y&&(K.__proto__=Y),(K.prototype=Object.create(Y&&Y.prototype)).constructor=K,K.prototype.getDefault=function(){return!1},K.prototype.set=function(X){if(X!==this.current||this.dirty){var re=this.gl;X?re.enable(re.STENCIL_TEST):re.disable(re.STENCIL_TEST),this.current=X,this.dirty=!1}},K}(oe),ve=function(Y){function K(){Y.apply(this,arguments)}return Y&&(K.__proto__=Y),(K.prototype=Object.create(Y&&Y.prototype)).constructor=K,K.prototype.getDefault=function(){return[0,1]},K.prototype.set=function(X){var re=this.current;(X[0]!==re[0]||X[1]!==re[1]||this.dirty)&&(this.gl.depthRange(X[0],X[1]),this.current=X,this.dirty=!1)},K}(oe),ge=function(Y){function K(){Y.apply(this,arguments)}return Y&&(K.__proto__=Y),(K.prototype=Object.create(Y&&Y.prototype)).constructor=K,K.prototype.getDefault=function(){return!1},K.prototype.set=function(X){if(X!==this.current||this.dirty){var re=this.gl;X?re.enable(re.DEPTH_TEST):re.disable(re.DEPTH_TEST),this.current=X,this.dirty=!1}},K}(oe),De=function(Y){function K(){Y.apply(this,arguments)}return Y&&(K.__proto__=Y),(K.prototype=Object.create(Y&&Y.prototype)).constructor=K,K.prototype.getDefault=function(){return this.gl.LESS},K.prototype.set=function(X){(X!==this.current||this.dirty)&&(this.gl.depthFunc(X),this.current=X,this.dirty=!1)},K}(oe),_e=function(Y){function K(){Y.apply(this,arguments)}return Y&&(K.__proto__=Y),(K.prototype=Object.create(Y&&Y.prototype)).constructor=K,K.prototype.getDefault=function(){return!1},K.prototype.set=function(X){if(X!==this.current||this.dirty){var re=this.gl;X?re.enable(re.BLEND):re.disable(re.BLEND),this.current=X,this.dirty=!1}},K}(oe),Pe=function(Y){function K(){Y.apply(this,arguments)}return Y&&(K.__proto__=Y),(K.prototype=Object.create(Y&&Y.prototype)).constructor=K,K.prototype.getDefault=function(){var X=this.gl;return[X.ONE,X.ZERO]},K.prototype.set=function(X){var re=this.current;(X[0]!==re[0]||X[1]!==re[1]||this.dirty)&&(this.gl.blendFunc(X[0],X[1]),this.current=X,this.dirty=!1)},K}(oe),Fe=function(Y){function K(){Y.apply(this,arguments)}return Y&&(K.__proto__=Y),(K.prototype=Object.create(Y&&Y.prototype)).constructor=K,K.prototype.getDefault=function(){return e.Color.transparent},K.prototype.set=function(X){var re=this.current;(X.r!==re.r||X.g!==re.g||X.b!==re.b||X.a!==re.a||this.dirty)&&(this.gl.blendColor(X.r,X.g,X.b,X.a),this.current=X,this.dirty=!1)},K}(oe),ze=function(Y){function K(){Y.apply(this,arguments)}return Y&&(K.__proto__=Y),(K.prototype=Object.create(Y&&Y.prototype)).constructor=K,K.prototype.getDefault=function(){return this.gl.FUNC_ADD},K.prototype.set=function(X){(X!==this.current||this.dirty)&&(this.gl.blendEquation(X),this.current=X,this.dirty=!1)},K}(oe),He=function(Y){function K(){Y.apply(this,arguments)}return Y&&(K.__proto__=Y),(K.prototype=Object.create(Y&&Y.prototype)).constructor=K,K.prototype.getDefault=function(){return!1},K.prototype.set=function(X){if(X!==this.current||this.dirty){var re=this.gl;X?re.enable(re.CULL_FACE):re.disable(re.CULL_FACE),this.current=X,this.dirty=!1}},K}(oe),et=function(Y){function K(){Y.apply(this,arguments)}return Y&&(K.__proto__=Y),(K.prototype=Object.create(Y&&Y.prototype)).constructor=K,K.prototype.getDefault=function(){return this.gl.BACK},K.prototype.set=function(X){(X!==this.current||this.dirty)&&(this.gl.cullFace(X),this.current=X,this.dirty=!1)},K}(oe),Re=function(Y){function K(){Y.apply(this,arguments)}return Y&&(K.__proto__=Y),(K.prototype=Object.create(Y&&Y.prototype)).constructor=K,K.prototype.getDefault=function(){return this.gl.CCW},K.prototype.set=function(X){(X!==this.current||this.dirty)&&(this.gl.frontFace(X),this.current=X,this.dirty=!1)},K}(oe),Ze=function(Y){function K(){Y.apply(this,arguments)}return Y&&(K.__proto__=Y),(K.prototype=Object.create(Y&&Y.prototype)).constructor=K,K.prototype.getDefault=function(){return null},K.prototype.set=function(X){(X!==this.current||this.dirty)&&(this.gl.useProgram(X),this.current=X,this.dirty=!1)},K}(oe),Ke=function(Y){function K(){Y.apply(this,arguments)}return Y&&(K.__proto__=Y),(K.prototype=Object.create(Y&&Y.prototype)).constructor=K,K.prototype.getDefault=function(){return this.gl.TEXTURE0},K.prototype.set=function(X){(X!==this.current||this.dirty)&&(this.gl.activeTexture(X),this.current=X,this.dirty=!1)},K}(oe),$e=function(Y){function K(){Y.apply(this,arguments)}return Y&&(K.__proto__=Y),(K.prototype=Object.create(Y&&Y.prototype)).constructor=K,K.prototype.getDefault=function(){var X=this.gl;return[0,0,X.drawingBufferWidth,X.drawingBufferHeight]},K.prototype.set=function(X){var re=this.current;(X[0]!==re[0]||X[1]!==re[1]||X[2]!==re[2]||X[3]!==re[3]||this.dirty)&&(this.gl.viewport(X[0],X[1],X[2],X[3]),this.current=X,this.dirty=!1)},K}(oe),rt=function(Y){function K(){Y.apply(this,arguments)}return Y&&(K.__proto__=Y),(K.prototype=Object.create(Y&&Y.prototype)).constructor=K,K.prototype.getDefault=function(){return null},K.prototype.set=function(X){if(X!==this.current||this.dirty){var re=this.gl;re.bindFramebuffer(re.FRAMEBUFFER,X),this.current=X,this.dirty=!1}},K}(oe),at=function(Y){function K(){Y.apply(this,arguments)}return Y&&(K.__proto__=Y),(K.prototype=Object.create(Y&&Y.prototype)).constructor=K,K.prototype.getDefault=function(){return null},K.prototype.set=function(X){if(X!==this.current||this.dirty){var re=this.gl;re.bindRenderbuffer(re.RENDERBUFFER,X),this.current=X,this.dirty=!1}},K}(oe),lt=function(Y){function K(){Y.apply(this,arguments)}return Y&&(K.__proto__=Y),(K.prototype=Object.create(Y&&Y.prototype)).constructor=K,K.prototype.getDefault=function(){return null},K.prototype.set=function(X){if(X!==this.current||this.dirty){var re=this.gl;re.bindTexture(re.TEXTURE_2D,X),this.current=X,this.dirty=!1}},K}(oe),gt=function(Y){function K(){Y.apply(this,arguments)}return Y&&(K.__proto__=Y),(K.prototype=Object.create(Y&&Y.prototype)).constructor=K,K.prototype.getDefault=function(){return null},K.prototype.set=function(X){if(X!==this.current||this.dirty){var re=this.gl;re.bindBuffer(re.ARRAY_BUFFER,X),this.current=X,this.dirty=!1}},K}(oe),Ie=function(Y){function K(){Y.apply(this,arguments)}return Y&&(K.__proto__=Y),(K.prototype=Object.create(Y&&Y.prototype)).constructor=K,K.prototype.getDefault=function(){return null},K.prototype.set=function(X){var re=this.gl;re.bindBuffer(re.ELEMENT_ARRAY_BUFFER,X),this.current=X,this.dirty=!1},K}(oe),be=function(Y){function K(X){Y.call(this,X),this.vao=X.extVertexArrayObject}return Y&&(K.__proto__=Y),(K.prototype=Object.create(Y&&Y.prototype)).constructor=K,K.prototype.getDefault=function(){return null},K.prototype.set=function(X){this.vao&&(X!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(X),this.current=X,this.dirty=!1)},K}(oe),We=function(Y){function K(){Y.apply(this,arguments)}return Y&&(K.__proto__=Y),(K.prototype=Object.create(Y&&Y.prototype)).constructor=K,K.prototype.getDefault=function(){return 4},K.prototype.set=function(X){if(X!==this.current||this.dirty){var re=this.gl;re.pixelStorei(re.UNPACK_ALIGNMENT,X),this.current=X,this.dirty=!1}},K}(oe),Ge=function(Y){function K(){Y.apply(this,arguments)}return Y&&(K.__proto__=Y),(K.prototype=Object.create(Y&&Y.prototype)).constructor=K,K.prototype.getDefault=function(){return!1},K.prototype.set=function(X){if(X!==this.current||this.dirty){var re=this.gl;re.pixelStorei(re.UNPACK_PREMULTIPLY_ALPHA_WEBGL,X),this.current=X,this.dirty=!1}},K}(oe),st=function(Y){function K(){Y.apply(this,arguments)}return Y&&(K.__proto__=Y),(K.prototype=Object.create(Y&&Y.prototype)).constructor=K,K.prototype.getDefault=function(){return!1},K.prototype.set=function(X){if(X!==this.current||this.dirty){var re=this.gl;re.pixelStorei(re.UNPACK_FLIP_Y_WEBGL,X),this.current=X,this.dirty=!1}},K}(oe),ot=function(Y){function K(X,re){Y.call(this,X),this.context=X,this.parent=re}return Y&&(K.__proto__=Y),(K.prototype=Object.create(Y&&Y.prototype)).constructor=K,K.prototype.getDefault=function(){return null},K}(oe),Ce=function(Y){function K(){Y.apply(this,arguments)}return Y&&(K.__proto__=Y),(K.prototype=Object.create(Y&&Y.prototype)).constructor=K,K.prototype.setDirty=function(){this.dirty=!0},K.prototype.set=function(X){if(X!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var re=this.gl;re.framebufferTexture2D(re.FRAMEBUFFER,re.COLOR_ATTACHMENT0,re.TEXTURE_2D,X,0),this.current=X,this.dirty=!1}},K}(ot),Ue=function(Y){function K(){Y.apply(this,arguments)}return Y&&(K.__proto__=Y),(K.prototype=Object.create(Y&&Y.prototype)).constructor=K,K.prototype.set=function(X){if(X!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var re=this.gl;re.framebufferRenderbuffer(re.FRAMEBUFFER,re.DEPTH_ATTACHMENT,re.RENDERBUFFER,X),this.current=X,this.dirty=!1}},K}(ot),Ye=function(Y,K,X,re){this.context=Y,this.width=K,this.height=X;var me=this.framebuffer=Y.gl.createFramebuffer();this.colorAttachment=new Ce(Y,me),re&&(this.depthAttachment=new Ue(Y,me))};Ye.prototype.destroy=function(){var Y=this.context.gl,K=this.colorAttachment.get();if(K&&Y.deleteTexture(K),this.depthAttachment){var X=this.depthAttachment.get();X&&Y.deleteRenderbuffer(X)}Y.deleteFramebuffer(this.framebuffer)};var xe=function(Y,K,X){this.func=Y,this.mask=K,this.range=X};xe.ReadOnly=!1,xe.ReadWrite=!0,xe.disabled=new xe(519,xe.ReadOnly,[0,1]);var Ee=function(Y,K,X,re,me,Oe){this.test=Y,this.ref=K,this.mask=X,this.fail=re,this.depthFail=me,this.pass=Oe};Ee.disabled=new Ee({func:519,mask:0},0,0,7680,7680,7680);var Je=function(Y,K,X){this.blendFunction=Y,this.blendColor=K,this.mask=X};Je.disabled=new Je(Je.Replace=[1,0],e.Color.transparent,[!1,!1,!1,!1]),Je.unblended=new Je(Je.Replace,e.Color.transparent,[!0,!0,!0,!0]),Je.alphaBlended=new Je([1,771],e.Color.transparent,[!0,!0,!0,!0]);var it=function(Y,K,X){this.enable=Y,this.mode=K,this.frontFace=X};it.disabled=new it(!1,1029,2305),it.backCCW=new it(!0,1029,2305);var ht=function(Y){this.gl=Y,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new de(this),this.clearDepth=new le(this),this.clearStencil=new fe(this),this.colorMask=new ue(this),this.depthMask=new we(this),this.stencilMask=new Ae(this),this.stencilFunc=new Se(this),this.stencilOp=new ke(this),this.stencilTest=new Me(this),this.depthRange=new ve(this),this.depthTest=new ge(this),this.depthFunc=new De(this),this.blend=new _e(this),this.blendFunc=new Pe(this),this.blendColor=new Fe(this),this.blendEquation=new ze(this),this.cullFace=new He(this),this.cullFaceSide=new et(this),this.frontFace=new Re(this),this.program=new Ze(this),this.activeTexture=new Ke(this),this.viewport=new $e(this),this.bindFramebuffer=new rt(this),this.bindRenderbuffer=new at(this),this.bindTexture=new lt(this),this.bindVertexBuffer=new gt(this),this.bindElementBuffer=new Ie(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new be(this),this.pixelStoreUnpack=new We(this),this.pixelStoreUnpackPremultiplyAlpha=new Ge(this),this.pixelStoreUnpackFlipY=new st(this),this.extTextureFilterAnisotropic=Y.getExtension("EXT_texture_filter_anisotropic")||Y.getExtension("MOZ_EXT_texture_filter_anisotropic")||Y.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=Y.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=Y.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(Y.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=Y.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=Y.getExtension("EXT_disjoint_timer_query")};ht.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},ht.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},ht.prototype.createIndexBuffer=function(Y,K){return new ee(this,Y,K)},ht.prototype.createVertexBuffer=function(Y,K,X){return new ae(this,Y,K,X)},ht.prototype.createRenderbuffer=function(Y,K,X){var re=this.gl,me=re.createRenderbuffer();return this.bindRenderbuffer.set(me),re.renderbufferStorage(re.RENDERBUFFER,Y,K,X),this.bindRenderbuffer.set(null),me},ht.prototype.createFramebuffer=function(Y,K,X){return new Ye(this,Y,K,X)},ht.prototype.clear=function(Y){var K=Y.color,X=Y.depth,re=this.gl,me=0;K&&(me|=re.COLOR_BUFFER_BIT,this.clearColor.set(K),this.colorMask.set([!0,!0,!0,!0])),X!==void 0&&(me|=re.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(X),this.depthMask.set(!0)),re.clear(me)},ht.prototype.setCullFace=function(Y){Y.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(Y.mode),this.frontFace.set(Y.frontFace))},ht.prototype.setDepthMode=function(Y){Y.func!==this.gl.ALWAYS||Y.mask?(this.depthTest.set(!0),this.depthFunc.set(Y.func),this.depthMask.set(Y.mask),this.depthRange.set(Y.range)):this.depthTest.set(!1)},ht.prototype.setStencilMode=function(Y){Y.test.func!==this.gl.ALWAYS||Y.mask?(this.stencilTest.set(!0),this.stencilMask.set(Y.mask),this.stencilOp.set([Y.fail,Y.depthFail,Y.pass]),this.stencilFunc.set({func:Y.test.func,ref:Y.ref,mask:Y.test.mask})):this.stencilTest.set(!1)},ht.prototype.setColorMode=function(Y){e.deepEqual(Y.blendFunction,Je.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(Y.blendFunction),this.blendColor.set(Y.blendColor)),this.colorMask.set(Y.mask)},ht.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var ct=function(Y){function K(X,re,me){var Oe=this;Y.call(this),this.id=X,this.dispatcher=me,this.on("data",function(Be){Be.dataType==="source"&&Be.sourceDataType==="metadata"&&(Oe._sourceLoaded=!0),Oe._sourceLoaded&&!Oe._paused&&Be.dataType==="source"&&Be.sourceDataType==="content"&&(Oe.reload(),Oe.transform&&Oe.update(Oe.transform))}),this.on("error",function(){Oe._sourceErrored=!0}),this._source=function(Be,tt,ft,St){var Ft=new j[tt.type](Be,tt,ft,St);if(Ft.id!==Be)throw new Error("Expected Source id to be "+Be+" instead of "+Ft.id);return e.bindAll(["load","abort","unload","serialize","prepare"],Ft),Ft}(X,re,me,this),this._tiles={},this._cache=new $(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new e.SourceFeatureState}return Y&&(K.__proto__=Y),(K.prototype=Object.create(Y&&Y.prototype)).constructor=K,K.prototype.onAdd=function(X){this.map=X,this._maxTileCacheSize=X?X._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(X)},K.prototype.onRemove=function(X){this._source&&this._source.onRemove&&this._source.onRemove(X)},K.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var X in this._tiles){var re=this._tiles[X];if(re.state!=="loaded"&&re.state!=="errored")return!1}return!0},K.prototype.getSource=function(){return this._source},K.prototype.pause=function(){this._paused=!0},K.prototype.resume=function(){if(this._paused){var X=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,X&&this.reload(),this.transform&&this.update(this.transform)}},K.prototype._loadTile=function(X,re){return this._source.loadTile(X,re)},K.prototype._unloadTile=function(X){if(this._source.unloadTile)return this._source.unloadTile(X,function(){})},K.prototype._abortTile=function(X){if(this._source.abortTile)return this._source.abortTile(X,function(){})},K.prototype.serialize=function(){return this._source.serialize()},K.prototype.prepare=function(X){for(var re in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var me=this._tiles[re];me.upload(X),me.prepare(this.map.style.imageManager)}},K.prototype.getIds=function(){return e.values(this._tiles).map(function(X){return X.tileID}).sort(mt).map(function(X){return X.key})},K.prototype.getRenderableIds=function(X){var re=this,me=[];for(var Oe in this._tiles)this._isIdRenderable(Oe,X)&&me.push(this._tiles[Oe]);return X?me.sort(function(Be,tt){var ft=Be.tileID,St=tt.tileID,Ft=new e.Point(ft.canonical.x,ft.canonical.y)._rotate(re.transform.angle),Gt=new e.Point(St.canonical.x,St.canonical.y)._rotate(re.transform.angle);return ft.overscaledZ-St.overscaledZ||Gt.y-Ft.y||Gt.x-Ft.x}).map(function(Be){return Be.tileID.key}):me.map(function(Be){return Be.tileID}).sort(mt).map(function(Be){return Be.key})},K.prototype.hasRenderableParent=function(X){var re=this.findLoadedParent(X,0);return!!re&&this._isIdRenderable(re.tileID.key)},K.prototype._isIdRenderable=function(X,re){return this._tiles[X]&&this._tiles[X].hasData()&&!this._coveredTiles[X]&&(re||!this._tiles[X].holdingForFade())},K.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var X in this._cache.reset(),this._tiles)this._tiles[X].state!=="errored"&&this._reloadTile(X,"reloading")},K.prototype._reloadTile=function(X,re){var me=this._tiles[X];me&&(me.state!=="loading"&&(me.state=re),this._loadTile(me,this._tileLoaded.bind(this,me,X,re)))},K.prototype._tileLoaded=function(X,re,me,Oe){if(Oe)return X.state="errored",void(Oe.status!==404?this._source.fire(new e.ErrorEvent(Oe,{tile:X})):this.update(this.transform));X.timeAdded=e.browser.now(),me==="expired"&&(X.refreshedUponExpiration=!0),this._setTileReloadTimer(re,X),this.getSource().type==="raster-dem"&&X.dem&&this._backfillDEM(X),this._state.initializeTileState(X,this.map?this.map.painter:null),this._source.fire(new e.Event("data",{dataType:"source",tile:X,coord:X.tileID}))},K.prototype._backfillDEM=function(X){for(var re=this.getRenderableIds(),me=0;me<re.length;me++){var Oe=re[me];if(X.neighboringTiles&&X.neighboringTiles[Oe]){var Be=this.getTileByID(Oe);tt(X,Be),tt(Be,X)}}function tt(ft,St){ft.needsHillshadePrepare=!0;var Ft=St.tileID.canonical.x-ft.tileID.canonical.x,Gt=St.tileID.canonical.y-ft.tileID.canonical.y,$t=Math.pow(2,ft.tileID.canonical.z),sr=St.tileID.key;Ft===0&&Gt===0||Math.abs(Gt)>1||(Math.abs(Ft)>1&&(Math.abs(Ft+$t)===1?Ft+=$t:Math.abs(Ft-$t)===1&&(Ft-=$t)),St.dem&&ft.dem&&(ft.dem.backfillBorder(St.dem,Ft,Gt),ft.neighboringTiles&&ft.neighboringTiles[sr]&&(ft.neighboringTiles[sr].backfilled=!0)))}},K.prototype.getTile=function(X){return this.getTileByID(X.key)},K.prototype.getTileByID=function(X){return this._tiles[X]},K.prototype._retainLoadedChildren=function(X,re,me,Oe){for(var Be in this._tiles){var tt=this._tiles[Be];if(!(Oe[Be]||!tt.hasData()||tt.tileID.overscaledZ<=re||tt.tileID.overscaledZ>me)){for(var ft=tt.tileID;tt&&tt.tileID.overscaledZ>re+1;){var St=tt.tileID.scaledTo(tt.tileID.overscaledZ-1);(tt=this._tiles[St.key])&&tt.hasData()&&(ft=St)}for(var Ft=ft;Ft.overscaledZ>re;)if(X[(Ft=Ft.scaledTo(Ft.overscaledZ-1)).key]){Oe[ft.key]=ft;break}}}},K.prototype.findLoadedParent=function(X,re){if(X.key in this._loadedParentTiles){var me=this._loadedParentTiles[X.key];return me&&me.tileID.overscaledZ>=re?me:null}for(var Oe=X.overscaledZ-1;Oe>=re;Oe--){var Be=X.scaledTo(Oe),tt=this._getLoadedTile(Be);if(tt)return tt}},K.prototype._getLoadedTile=function(X){var re=this._tiles[X.key];return re&&re.hasData()?re:this._cache.getByKey(X.wrapped().key)},K.prototype.updateCacheSize=function(X){var re=Math.ceil(X.width/this._source.tileSize)+1,me=Math.ceil(X.height/this._source.tileSize)+1,Oe=Math.floor(re*me*5),Be=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,Oe):Oe;this._cache.setMaxSize(Be)},K.prototype.handleWrapJump=function(X){var re=Math.round((X-(this._prevLng===void 0?X:this._prevLng))/360);if(this._prevLng=X,re){var me={};for(var Oe in this._tiles){var Be=this._tiles[Oe];Be.tileID=Be.tileID.unwrapTo(Be.tileID.wrap+re),me[Be.tileID.key]=Be}for(var tt in this._tiles=me,this._timers)clearTimeout(this._timers[tt]),delete this._timers[tt];for(var ft in this._tiles)this._setTileReloadTimer(ft,this._tiles[ft])}},K.prototype.update=function(X){var re=this;if(this.transform=X,this._sourceLoaded&&!this._paused){var me;this.updateCacheSize(X),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?me=X.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(an){return new e.OverscaledTileID(an.canonical.z,an.wrap,an.canonical.z,an.canonical.x,an.canonical.y)}):(me=X.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(me=me.filter(function(an){return re._source.hasTile(an)}))):me=[];var Oe=X.coveringZoomLevel(this._source),Be=Math.max(Oe-K.maxOverzooming,this._source.minzoom),tt=Math.max(Oe+K.maxUnderzooming,this._source.minzoom),ft=this._updateRetainedTiles(me,Oe);if(bt(this._source.type)){for(var St={},Ft={},Gt=0,$t=Object.keys(ft);Gt<$t.length;Gt+=1){var sr=$t[Gt],lr=ft[sr],vr=this._tiles[sr];if(vr&&!(vr.fadeEndTime&&vr.fadeEndTime<=e.browser.now())){var ir=this.findLoadedParent(lr,Be);ir&&(this._addTile(ir.tileID),St[ir.tileID.key]=ir.tileID),Ft[sr]=lr}}for(var gr in this._retainLoadedChildren(Ft,Oe,tt,ft),St)ft[gr]||(this._coveredTiles[gr]=!0,ft[gr]=St[gr])}for(var Ar in ft)this._tiles[Ar].clearFadeHold();for(var Pr=0,Gr=e.keysDifference(this._tiles,ft);Pr<Gr.length;Pr+=1){var Fr=Gr[Pr],Yr=this._tiles[Fr];Yr.hasSymbolBuckets&&!Yr.holdingForFade()?Yr.setHoldDuration(this.map._fadeDuration):Yr.hasSymbolBuckets&&!Yr.symbolFadeFinished()||this._removeTile(Fr)}this._updateLoadedParentTileCache()}},K.prototype.releaseSymbolFadeTiles=function(){for(var X in this._tiles)this._tiles[X].holdingForFade()&&this._removeTile(X)},K.prototype._updateRetainedTiles=function(X,re){for(var me={},Oe={},Be=Math.max(re-K.maxOverzooming,this._source.minzoom),tt=Math.max(re+K.maxUnderzooming,this._source.minzoom),ft={},St=0,Ft=X;St<Ft.length;St+=1){var Gt=Ft[St],$t=this._addTile(Gt);me[Gt.key]=Gt,$t.hasData()||re<this._source.maxzoom&&(ft[Gt.key]=Gt)}this._retainLoadedChildren(ft,re,tt,me);for(var sr=0,lr=X;sr<lr.length;sr+=1){var vr=lr[sr],ir=this._tiles[vr.key];if(!ir.hasData()){if(re+1>this._source.maxzoom){var gr=vr.children(this._source.maxzoom)[0],Ar=this.getTile(gr);if(Ar&&Ar.hasData()){me[gr.key]=gr;continue}}else{var Pr=vr.children(this._source.maxzoom);if(me[Pr[0].key]&&me[Pr[1].key]&&me[Pr[2].key]&&me[Pr[3].key])continue}for(var Gr=ir.wasRequested(),Fr=vr.overscaledZ-1;Fr>=Be;--Fr){var Yr=vr.scaledTo(Fr);if(Oe[Yr.key]||(Oe[Yr.key]=!0,!(ir=this.getTile(Yr))&&Gr&&(ir=this._addTile(Yr)),ir&&(me[Yr.key]=Yr,Gr=ir.wasRequested(),ir.hasData())))break}}}return me},K.prototype._updateLoadedParentTileCache=function(){for(var X in this._loadedParentTiles={},this._tiles){for(var re=[],me=void 0,Oe=this._tiles[X].tileID;Oe.overscaledZ>0;){if(Oe.key in this._loadedParentTiles){me=this._loadedParentTiles[Oe.key];break}re.push(Oe.key);var Be=Oe.scaledTo(Oe.overscaledZ-1);if(me=this._getLoadedTile(Be))break;Oe=Be}for(var tt=0,ft=re;tt<ft.length;tt+=1)this._loadedParentTiles[ft[tt]]=me}},K.prototype._addTile=function(X){var re=this._tiles[X.key];if(re)return re;(re=this._cache.getAndRemove(X))&&(this._setTileReloadTimer(X.key,re),re.tileID=X,this._state.initializeTileState(re,this.map?this.map.painter:null),this._cacheTimers[X.key]&&(clearTimeout(this._cacheTimers[X.key]),delete this._cacheTimers[X.key],this._setTileReloadTimer(X.key,re)));var me=!!re;return me||(re=new e.Tile(X,this._source.tileSize*X.overscaleFactor()),this._loadTile(re,this._tileLoaded.bind(this,re,X.key,re.state))),re?(re.uses++,this._tiles[X.key]=re,me||this._source.fire(new e.Event("dataloading",{tile:re,coord:re.tileID,dataType:"source"})),re):null},K.prototype._setTileReloadTimer=function(X,re){var me=this;X in this._timers&&(clearTimeout(this._timers[X]),delete this._timers[X]);var Oe=re.getExpiryTimeout();Oe&&(this._timers[X]=setTimeout(function(){me._reloadTile(X,"expired"),delete me._timers[X]},Oe))},K.prototype._removeTile=function(X){var re=this._tiles[X];re&&(re.uses--,delete this._tiles[X],this._timers[X]&&(clearTimeout(this._timers[X]),delete this._timers[X]),re.uses>0||(re.hasData()&&re.state!=="reloading"?this._cache.add(re.tileID,re,re.getExpiryTimeout()):(re.aborted=!0,this._abortTile(re),this._unloadTile(re))))},K.prototype.clearTiles=function(){for(var X in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(X);this._cache.reset()},K.prototype.tilesIn=function(X,re,me){var Oe=this,Be=[],tt=this.transform;if(!tt)return Be;for(var ft=me?tt.getCameraQueryGeometry(X):X,St=X.map(function(Fr){return tt.pointCoordinate(Fr)}),Ft=ft.map(function(Fr){return tt.pointCoordinate(Fr)}),Gt=this.getIds(),$t=1/0,sr=1/0,lr=-1/0,vr=-1/0,ir=0,gr=Ft;ir<gr.length;ir+=1){var Ar=gr[ir];$t=Math.min($t,Ar.x),sr=Math.min(sr,Ar.y),lr=Math.max(lr,Ar.x),vr=Math.max(vr,Ar.y)}for(var Pr=function(Fr){var Yr=Oe._tiles[Gt[Fr]];if(!Yr.holdingForFade()){var an=Yr.tileID,mn=Math.pow(2,tt.zoom-Yr.tileID.overscaledZ),pn=re*Yr.queryPadding*e.EXTENT/Yr.tileSize/mn,xn=[an.getTilePoint(new e.MercatorCoordinate($t,sr)),an.getTilePoint(new e.MercatorCoordinate(lr,vr))];if(xn[0].x-pn<e.EXTENT&&xn[0].y-pn<e.EXTENT&&xn[1].x+pn>=0&&xn[1].y+pn>=0){var Ln=St.map(function(Vn){return an.getTilePoint(Vn)}),Jn=Ft.map(function(Vn){return an.getTilePoint(Vn)});Be.push({tile:Yr,tileID:an,queryGeometry:Ln,cameraQueryGeometry:Jn,scale:mn})}}},Gr=0;Gr<Gt.length;Gr++)Pr(Gr);return Be},K.prototype.getVisibleCoordinates=function(X){for(var re=this,me=this.getRenderableIds(X).map(function(ft){return re._tiles[ft].tileID}),Oe=0,Be=me;Oe<Be.length;Oe+=1){var tt=Be[Oe];tt.posMatrix=this.transform.calculatePosMatrix(tt.toUnwrapped())}return me},K.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(bt(this._source.type))for(var X in this._tiles){var re=this._tiles[X];if(re.fadeEndTime!==void 0&&re.fadeEndTime>=e.browser.now())return!0}return!1},K.prototype.setFeatureState=function(X,re,me){this._state.updateState(X=X||"_geojsonTileLayer",re,me)},K.prototype.removeFeatureState=function(X,re,me){this._state.removeFeatureState(X=X||"_geojsonTileLayer",re,me)},K.prototype.getFeatureState=function(X,re){return this._state.getState(X=X||"_geojsonTileLayer",re)},K.prototype.setDependencies=function(X,re,me){var Oe=this._tiles[X];Oe&&Oe.setDependencies(re,me)},K.prototype.reloadTilesForDependencies=function(X,re){for(var me in this._tiles)this._tiles[me].hasDependency(X,re)&&this._reloadTile(me,"reloading");this._cache.filter(function(Oe){return!Oe.hasDependency(X,re)})},K}(e.Evented);function mt(Y,K){var X=Math.abs(2*Y.wrap)-+(Y.wrap<0),re=Math.abs(2*K.wrap)-+(K.wrap<0);return Y.overscaledZ-K.overscaledZ||re-X||K.canonical.y-Y.canonical.y||K.canonical.x-Y.canonical.x}function bt(Y){return Y==="raster"||Y==="image"||Y==="video"}function Et(){return new e.window.Worker(el.workerUrl)}ct.maxOverzooming=10,ct.maxUnderzooming=3;var Mt="mapboxgl_preloaded_worker_pool",_t=function(){this.active={}};_t.prototype.acquire=function(Y){if(!this.workers)for(this.workers=[];this.workers.length<_t.workerCount;)this.workers.push(new Et);return this.active[Y]=!0,this.workers.slice()},_t.prototype.release=function(Y){delete this.active[Y],this.numActive()===0&&(this.workers.forEach(function(K){K.terminate()}),this.workers=null)},_t.prototype.isPreloaded=function(){return!!this.active[Mt]},_t.prototype.numActive=function(){return Object.keys(this.active).length};var xt,At=Math.floor(e.browser.hardwareConcurrency/2);function It(){return xt||(xt=new _t),xt}function Nt(Y,K){var X={};for(var re in Y)re!=="ref"&&(X[re]=Y[re]);return e.refProperties.forEach(function(me){me in K&&(X[me]=K[me])}),X}function Ot(Y){Y=Y.slice();for(var K=Object.create(null),X=0;X<Y.length;X++)K[Y[X].id]=Y[X];for(var re=0;re<Y.length;re++)"ref"in Y[re]&&(Y[re]=Nt(Y[re],K[Y[re].ref]));return Y}_t.workerCount=Math.max(Math.min(At,6),1);var Yt={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Pt(Y,K,X){X.push({command:Yt.addSource,args:[Y,K[Y]]})}function Ne(Y,K,X){K.push({command:Yt.removeSource,args:[Y]}),X[Y]=!0}function ut(Y,K,X,re){Ne(Y,X,re),Pt(Y,K,X)}function wt(Y,K,X){var re;for(re in Y[X])if(Y[X].hasOwnProperty(re)&&re!=="data"&&!e.deepEqual(Y[X][re],K[X][re]))return!1;for(re in K[X])if(K[X].hasOwnProperty(re)&&re!=="data"&&!e.deepEqual(Y[X][re],K[X][re]))return!1;return!0}function Bt(Y,K,X,re,me,Oe){var Be;for(Be in K=K||{},Y=Y||{})Y.hasOwnProperty(Be)&&(e.deepEqual(Y[Be],K[Be])||X.push({command:Oe,args:[re,Be,K[Be],me]}));for(Be in K)K.hasOwnProperty(Be)&&!Y.hasOwnProperty(Be)&&(e.deepEqual(Y[Be],K[Be])||X.push({command:Oe,args:[re,Be,K[Be],me]}))}function Jt(Y){return Y.id}function er(Y,K){return Y[K.id]=K,Y}var or=function(Y,K){this.reset(Y,K)};or.prototype.reset=function(Y,K){this.points=Y||[],this._distances=[0];for(var X=1;X<this.points.length;X++)this._distances[X]=this._distances[X-1]+this.points[X].dist(this.points[X-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(K||0,.5*this.length),this.paddedLength=this.length-2*this.padding},or.prototype.lerp=function(Y){if(this.points.length===1)return this.points[0];Y=e.clamp(Y,0,1);for(var K=1,X=this._distances[K],re=Y*this.paddedLength+this.padding;X<re&&K<this._distances.length;)X=this._distances[++K];var me=K-1,Oe=this._distances[me],Be=X-Oe,tt=Be>0?(re-Oe)/Be:0;return this.points[me].mult(1-tt).add(this.points[K].mult(tt))};var zt=function(Y,K,X){var re=this.boxCells=[],me=this.circleCells=[];this.xCellCount=Math.ceil(Y/X),this.yCellCount=Math.ceil(K/X);for(var Oe=0;Oe<this.xCellCount*this.yCellCount;Oe++)re.push([]),me.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=Y,this.height=K,this.xScale=this.xCellCount/Y,this.yScale=this.yCellCount/K,this.boxUid=0,this.circleUid=0};function Qt(Y,K,X,re,me){var Oe=e.create();return K?(e.scale(Oe,Oe,[1/me,1/me,1]),X||e.rotateZ(Oe,Oe,re.angle)):e.multiply(Oe,re.labelPlaneMatrix,Y),Oe}function cr(Y,K,X,re,me){if(K){var Oe=e.clone(Y);return e.scale(Oe,Oe,[me,me,1]),X||e.rotateZ(Oe,Oe,-re.angle),Oe}return re.glCoordMatrix}function Dt(Y,K){var X=[Y.x,Y.y,0,1];nn(X,X,K);var re=X[3];return{point:new e.Point(X[0]/re,X[1]/re),signedDistanceFromCamera:re}}function Ut(Y,K){return .5+Y/K*.5}function ur(Y,K){var X=Y[0]/Y[3],re=Y[1]/Y[3];return X>=-K[0]&&X<=K[0]&&re>=-K[1]&&re<=K[1]}function Sr(Y,K,X,re,me,Oe,Be,tt){var ft=re?Y.textSizeData:Y.iconSizeData,St=e.evaluateSizeForZoom(ft,X.transform.zoom),Ft=[256/X.width*2+1,256/X.height*2+1],Gt=re?Y.text.dynamicLayoutVertexArray:Y.icon.dynamicLayoutVertexArray;Gt.clear();for(var $t=Y.lineVertexArray,sr=re?Y.text.placedSymbolArray:Y.icon.placedSymbolArray,lr=X.transform.width/X.transform.height,vr=!1,ir=0;ir<sr.length;ir++){var gr=sr.get(ir);if(gr.hidden||gr.writingMode===e.WritingMode.vertical&&!vr)Qr(gr.numGlyphs,Gt);else{vr=!1;var Ar=[gr.anchorX,gr.anchorY,0,1];if(e.transformMat4(Ar,Ar,K),ur(Ar,Ft)){var Pr=Ut(X.transform.cameraToCenterDistance,Ar[3]),Gr=e.evaluateSizeForFeature(ft,St,gr),Fr=Be?Gr/Pr:Gr*Pr,Yr=new e.Point(gr.anchorX,gr.anchorY),an=Dt(Yr,me).point,mn={},pn=Kr(gr,Fr,!1,tt,K,me,Oe,Y.glyphOffsetArray,$t,Gt,an,Yr,mn,lr);vr=pn.useVertical,(pn.notEnoughRoom||vr||pn.needsFlipping&&Kr(gr,Fr,!0,tt,K,me,Oe,Y.glyphOffsetArray,$t,Gt,an,Yr,mn,lr).notEnoughRoom)&&Qr(gr.numGlyphs,Gt)}else Qr(gr.numGlyphs,Gt)}}re?Y.text.dynamicLayoutVertexBuffer.updateData(Gt):Y.icon.dynamicLayoutVertexBuffer.updateData(Gt)}function Lr(Y,K,X,re,me,Oe,Be,tt,ft,St,Ft){var Gt=tt.glyphStartIndex+tt.numGlyphs,$t=tt.lineStartIndex,sr=tt.lineStartIndex+tt.lineLength,lr=K.getoffsetX(tt.glyphStartIndex),vr=K.getoffsetX(Gt-1),ir=kr(Y*lr,X,re,me,Oe,Be,tt.segment,$t,sr,ft,St,Ft);if(!ir)return null;var gr=kr(Y*vr,X,re,me,Oe,Be,tt.segment,$t,sr,ft,St,Ft);return gr?{first:ir,last:gr}:null}function Hr(Y,K,X,re){return Y===e.WritingMode.horizontal&&Math.abs(X.y-K.y)>Math.abs(X.x-K.x)*re?{useVertical:!0}:(Y===e.WritingMode.vertical?K.y<X.y:K.x>X.x)?{needsFlipping:!0}:null}function Kr(Y,K,X,re,me,Oe,Be,tt,ft,St,Ft,Gt,$t,sr){var lr,vr=K/24,ir=Y.lineOffsetX*vr,gr=Y.lineOffsetY*vr;if(Y.numGlyphs>1){var Ar=Y.glyphStartIndex+Y.numGlyphs,Pr=Y.lineStartIndex,Gr=Y.lineStartIndex+Y.lineLength,Fr=Lr(vr,tt,ir,gr,X,Ft,Gt,Y,ft,Oe,$t);if(!Fr)return{notEnoughRoom:!0};var Yr=Dt(Fr.first.point,Be).point,an=Dt(Fr.last.point,Be).point;if(re&&!X){var mn=Hr(Y.writingMode,Yr,an,sr);if(mn)return mn}lr=[Fr.first];for(var pn=Y.glyphStartIndex+1;pn<Ar-1;pn++)lr.push(kr(vr*tt.getoffsetX(pn),ir,gr,X,Ft,Gt,Y.segment,Pr,Gr,ft,Oe,$t));lr.push(Fr.last)}else{if(re&&!X){var xn=Dt(Gt,me).point,Ln=Y.lineStartIndex+Y.segment+1,Jn=new e.Point(ft.getx(Ln),ft.gety(Ln)),Vn=Dt(Jn,me),oa=Vn.signedDistanceFromCamera>0?Vn.point:Ir(Gt,Jn,xn,1,me),Sn=Hr(Y.writingMode,xn,oa,sr);if(Sn)return Sn}var ra=kr(vr*tt.getoffsetX(Y.glyphStartIndex),ir,gr,X,Ft,Gt,Y.segment,Y.lineStartIndex,Y.lineStartIndex+Y.lineLength,ft,Oe,$t);if(!ra)return{notEnoughRoom:!0};lr=[ra]}for(var sa=0,Hn=lr;sa<Hn.length;sa+=1){var Gn=Hn[sa];e.addDynamicAttributes(St,Gn.point,Gn.angle)}return{}}function Ir(Y,K,X,re,me){var Oe=Dt(Y.add(Y.sub(K)._unit()),me).point,Be=X.sub(Oe);return X.add(Be._mult(re/Be.mag()))}function kr(Y,K,X,re,me,Oe,Be,tt,ft,St,Ft,Gt){var $t=re?Y-K:Y+K,sr=$t>0?1:-1,lr=0;re&&(sr*=-1,lr=Math.PI),sr<0&&(lr+=Math.PI);for(var vr=sr>0?tt+Be:tt+Be+1,ir=me,gr=me,Ar=0,Pr=0,Gr=Math.abs($t),Fr=[];Ar+Pr<=Gr;){if((vr+=sr)<tt||vr>=ft)return null;if(gr=ir,Fr.push(ir),(ir=Gt[vr])===void 0){var Yr=new e.Point(St.getx(vr),St.gety(vr)),an=Dt(Yr,Ft);if(an.signedDistanceFromCamera>0)ir=Gt[vr]=an.point;else{var mn=vr-sr;ir=Ir(Ar===0?Oe:new e.Point(St.getx(mn),St.gety(mn)),Yr,gr,Gr-Ar+1,Ft)}}Ar+=Pr,Pr=gr.dist(ir)}var pn=(Gr-Ar)/Pr,xn=ir.sub(gr),Ln=xn.mult(pn)._add(gr);Ln._add(xn._unit()._perp()._mult(X*sr));var Jn=lr+Math.atan2(ir.y-gr.y,ir.x-gr.x);return Fr.push(Ln),{point:Ln,angle:Jn,path:Fr}}zt.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},zt.prototype.insert=function(Y,K,X,re,me){this._forEachCell(K,X,re,me,this._insertBoxCell,this.boxUid++),this.boxKeys.push(Y),this.bboxes.push(K),this.bboxes.push(X),this.bboxes.push(re),this.bboxes.push(me)},zt.prototype.insertCircle=function(Y,K,X,re){this._forEachCell(K-re,X-re,K+re,X+re,this._insertCircleCell,this.circleUid++),this.circleKeys.push(Y),this.circles.push(K),this.circles.push(X),this.circles.push(re)},zt.prototype._insertBoxCell=function(Y,K,X,re,me,Oe){this.boxCells[me].push(Oe)},zt.prototype._insertCircleCell=function(Y,K,X,re,me,Oe){this.circleCells[me].push(Oe)},zt.prototype._query=function(Y,K,X,re,me,Oe){if(X<0||Y>this.width||re<0||K>this.height)return!me&&[];var Be=[];if(Y<=0&&K<=0&&this.width<=X&&this.height<=re){if(me)return!0;for(var tt=0;tt<this.boxKeys.length;tt++)Be.push({key:this.boxKeys[tt],x1:this.bboxes[4*tt],y1:this.bboxes[4*tt+1],x2:this.bboxes[4*tt+2],y2:this.bboxes[4*tt+3]});for(var ft=0;ft<this.circleKeys.length;ft++){var St=this.circles[3*ft],Ft=this.circles[3*ft+1],Gt=this.circles[3*ft+2];Be.push({key:this.circleKeys[ft],x1:St-Gt,y1:Ft-Gt,x2:St+Gt,y2:Ft+Gt})}return Oe?Be.filter(Oe):Be}return this._forEachCell(Y,K,X,re,this._queryCell,Be,{hitTest:me,seenUids:{box:{},circle:{}}},Oe),me?Be.length>0:Be},zt.prototype._queryCircle=function(Y,K,X,re,me){var Oe=Y-X,Be=Y+X,tt=K-X,ft=K+X;if(Be<0||Oe>this.width||ft<0||tt>this.height)return!re&&[];var St=[];return this._forEachCell(Oe,tt,Be,ft,this._queryCellCircle,St,{hitTest:re,circle:{x:Y,y:K,radius:X},seenUids:{box:{},circle:{}}},me),re?St.length>0:St},zt.prototype.query=function(Y,K,X,re,me){return this._query(Y,K,X,re,!1,me)},zt.prototype.hitTest=function(Y,K,X,re,me){return this._query(Y,K,X,re,!0,me)},zt.prototype.hitTestCircle=function(Y,K,X,re){return this._queryCircle(Y,K,X,!0,re)},zt.prototype._queryCell=function(Y,K,X,re,me,Oe,Be,tt){var ft=Be.seenUids,St=this.boxCells[me];if(St!==null)for(var Ft=this.bboxes,Gt=0,$t=St;Gt<$t.length;Gt+=1){var sr=$t[Gt];if(!ft.box[sr]){ft.box[sr]=!0;var lr=4*sr;if(Y<=Ft[lr+2]&&K<=Ft[lr+3]&&X>=Ft[lr+0]&&re>=Ft[lr+1]&&(!tt||tt(this.boxKeys[sr]))){if(Be.hitTest)return Oe.push(!0),!0;Oe.push({key:this.boxKeys[sr],x1:Ft[lr],y1:Ft[lr+1],x2:Ft[lr+2],y2:Ft[lr+3]})}}}var vr=this.circleCells[me];if(vr!==null)for(var ir=this.circles,gr=0,Ar=vr;gr<Ar.length;gr+=1){var Pr=Ar[gr];if(!ft.circle[Pr]){ft.circle[Pr]=!0;var Gr=3*Pr;if(this._circleAndRectCollide(ir[Gr],ir[Gr+1],ir[Gr+2],Y,K,X,re)&&(!tt||tt(this.circleKeys[Pr]))){if(Be.hitTest)return Oe.push(!0),!0;var Fr=ir[Gr],Yr=ir[Gr+1],an=ir[Gr+2];Oe.push({key:this.circleKeys[Pr],x1:Fr-an,y1:Yr-an,x2:Fr+an,y2:Yr+an})}}}},zt.prototype._queryCellCircle=function(Y,K,X,re,me,Oe,Be,tt){var ft=Be.circle,St=Be.seenUids,Ft=this.boxCells[me];if(Ft!==null)for(var Gt=this.bboxes,$t=0,sr=Ft;$t<sr.length;$t+=1){var lr=sr[$t];if(!St.box[lr]){St.box[lr]=!0;var vr=4*lr;if(this._circleAndRectCollide(ft.x,ft.y,ft.radius,Gt[vr+0],Gt[vr+1],Gt[vr+2],Gt[vr+3])&&(!tt||tt(this.boxKeys[lr])))return Oe.push(!0),!0}}var ir=this.circleCells[me];if(ir!==null)for(var gr=this.circles,Ar=0,Pr=ir;Ar<Pr.length;Ar+=1){var Gr=Pr[Ar];if(!St.circle[Gr]){St.circle[Gr]=!0;var Fr=3*Gr;if(this._circlesCollide(gr[Fr],gr[Fr+1],gr[Fr+2],ft.x,ft.y,ft.radius)&&(!tt||tt(this.circleKeys[Gr])))return Oe.push(!0),!0}}},zt.prototype._forEachCell=function(Y,K,X,re,me,Oe,Be,tt){for(var ft=this._convertToXCellCoord(Y),St=this._convertToYCellCoord(K),Ft=this._convertToXCellCoord(X),Gt=this._convertToYCellCoord(re),$t=ft;$t<=Ft;$t++)for(var sr=St;sr<=Gt;sr++)if(me.call(this,Y,K,X,re,this.xCellCount*sr+$t,Oe,Be,tt))return},zt.prototype._convertToXCellCoord=function(Y){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(Y*this.xScale)))},zt.prototype._convertToYCellCoord=function(Y){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(Y*this.yScale)))},zt.prototype._circlesCollide=function(Y,K,X,re,me,Oe){var Be=re-Y,tt=me-K,ft=X+Oe;return ft*ft>Be*Be+tt*tt},zt.prototype._circleAndRectCollide=function(Y,K,X,re,me,Oe,Be){var tt=(Oe-re)/2,ft=Math.abs(Y-(re+tt));if(ft>tt+X)return!1;var St=(Be-me)/2,Ft=Math.abs(K-(me+St));if(Ft>St+X)return!1;if(ft<=tt||Ft<=St)return!0;var Gt=ft-tt,$t=Ft-St;return Gt*Gt+$t*$t<=X*X};var rn=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Qr(Y,K){for(var X=0;X<Y;X++){var re=K.length;K.resize(re+4),K.float32.set(rn,3*re)}}function nn(Y,K,X){var re=K[0],me=K[1];return Y[0]=X[0]*re+X[4]*me+X[12],Y[1]=X[1]*re+X[5]*me+X[13],Y[3]=X[3]*re+X[7]*me+X[15],Y}var Xr=function(Y,K,X){K===void 0&&(K=new zt(Y.width+200,Y.height+200,25)),X===void 0&&(X=new zt(Y.width+200,Y.height+200,25)),this.transform=Y,this.grid=K,this.ignoredGrid=X,this.pitchfactor=Math.cos(Y._pitch)*Y.cameraToCenterDistance,this.screenRightBoundary=Y.width+100,this.screenBottomBoundary=Y.height+100,this.gridRightBoundary=Y.width+200,this.gridBottomBoundary=Y.height+200};function Nr(Y,K,X){return K*(e.EXTENT/(Y.tileSize*Math.pow(2,X-Y.tileID.overscaledZ)))}Xr.prototype.placeCollisionBox=function(Y,K,X,re,me){var Oe=this.projectAndGetPerspectiveRatio(re,Y.anchorPointX,Y.anchorPointY),Be=X*Oe.perspectiveRatio,tt=Y.x1*Be+Oe.point.x,ft=Y.y1*Be+Oe.point.y,St=Y.x2*Be+Oe.point.x,Ft=Y.y2*Be+Oe.point.y;return!this.isInsideGrid(tt,ft,St,Ft)||!K&&this.grid.hitTest(tt,ft,St,Ft,me)?{box:[],offscreen:!1}:{box:[tt,ft,St,Ft],offscreen:this.isOffscreen(tt,ft,St,Ft)}},Xr.prototype.placeCollisionCircles=function(Y,K,X,re,me,Oe,Be,tt,ft,St,Ft,Gt,$t){var sr=[],lr=new e.Point(K.anchorX,K.anchorY),vr=Dt(lr,Oe),ir=Ut(this.transform.cameraToCenterDistance,vr.signedDistanceFromCamera),gr=(St?me/ir:me*ir)/e.ONE_EM,Ar=Dt(lr,Be).point,Pr=Lr(gr,re,K.lineOffsetX*gr,K.lineOffsetY*gr,!1,Ar,lr,K,X,Be,{}),Gr=!1,Fr=!1,Yr=!0;if(Pr){for(var an=.5*Gt*ir+$t,mn=new e.Point(-100,-100),pn=new e.Point(this.screenRightBoundary,this.screenBottomBoundary),xn=new or,Ln=Pr.first,Jn=Pr.last,Vn=[],oa=Ln.path.length-1;oa>=1;oa--)Vn.push(Ln.path[oa]);for(var Sn=1;Sn<Jn.path.length;Sn++)Vn.push(Jn.path[Sn]);var ra=2.5*an;if(tt){var sa=Vn.map(function(Do){return Dt(Do,tt)});Vn=sa.some(function(Do){return Do.signedDistanceFromCamera<=0})?[]:sa.map(function(Do){return Do.point})}var Hn=[];if(Vn.length>0){for(var Gn=Vn[0].clone(),$n=Vn[0].clone(),Zn=1;Zn<Vn.length;Zn++)Gn.x=Math.min(Gn.x,Vn[Zn].x),Gn.y=Math.min(Gn.y,Vn[Zn].y),$n.x=Math.max($n.x,Vn[Zn].x),$n.y=Math.max($n.y,Vn[Zn].y);Hn=Gn.x>=mn.x&&$n.x<=pn.x&&Gn.y>=mn.y&&$n.y<=pn.y?[Vn]:$n.x<mn.x||Gn.x>pn.x||$n.y<mn.y||Gn.y>pn.y?[]:e.clipLine([Vn],mn.x,mn.y,pn.x,pn.y)}for(var qn=0,fi=Hn;qn<fi.length;qn+=1){var Fa;xn.reset(fi[qn],.25*an),Fa=xn.length<=.5*an?1:Math.ceil(xn.paddedLength/ra)+1;for(var Ha=0;Ha<Fa;Ha++){var ba=Ha/Math.max(Fa-1,1),Ga=xn.lerp(ba),Ea=Ga.x+100,Ao=Ga.y+100;sr.push(Ea,Ao,an,0);var Os=Ea-an,go=Ao-an,Si=Ea+an,mo=Ao+an;if(Yr=Yr&&this.isOffscreen(Os,go,Si,mo),Fr=Fr||this.isInsideGrid(Os,go,Si,mo),!Y&&this.grid.hitTestCircle(Ea,Ao,an,Ft)&&(Gr=!0,!ft))return{circles:[],offscreen:!1,collisionDetected:Gr}}}}return{circles:!ft&&Gr||!Fr?[]:sr,offscreen:Yr,collisionDetected:Gr}},Xr.prototype.queryRenderedSymbols=function(Y){if(Y.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var K=[],X=1/0,re=1/0,me=-1/0,Oe=-1/0,Be=0,tt=Y;Be<tt.length;Be+=1){var ft=tt[Be],St=new e.Point(ft.x+100,ft.y+100);X=Math.min(X,St.x),re=Math.min(re,St.y),me=Math.max(me,St.x),Oe=Math.max(Oe,St.y),K.push(St)}for(var Ft={},Gt={},$t=0,sr=this.grid.query(X,re,me,Oe).concat(this.ignoredGrid.query(X,re,me,Oe));$t<sr.length;$t+=1){var lr=sr[$t],vr=lr.key;if(Ft[vr.bucketInstanceId]===void 0&&(Ft[vr.bucketInstanceId]={}),!Ft[vr.bucketInstanceId][vr.featureIndex]){var ir=[new e.Point(lr.x1,lr.y1),new e.Point(lr.x2,lr.y1),new e.Point(lr.x2,lr.y2),new e.Point(lr.x1,lr.y2)];e.polygonIntersectsPolygon(K,ir)&&(Ft[vr.bucketInstanceId][vr.featureIndex]=!0,Gt[vr.bucketInstanceId]===void 0&&(Gt[vr.bucketInstanceId]=[]),Gt[vr.bucketInstanceId].push(vr.featureIndex))}}return Gt},Xr.prototype.insertCollisionBox=function(Y,K,X,re,me){(K?this.ignoredGrid:this.grid).insert({bucketInstanceId:X,featureIndex:re,collisionGroupID:me},Y[0],Y[1],Y[2],Y[3])},Xr.prototype.insertCollisionCircles=function(Y,K,X,re,me){for(var Oe=K?this.ignoredGrid:this.grid,Be={bucketInstanceId:X,featureIndex:re,collisionGroupID:me},tt=0;tt<Y.length;tt+=4)Oe.insertCircle(Be,Y[tt],Y[tt+1],Y[tt+2])},Xr.prototype.projectAndGetPerspectiveRatio=function(Y,K,X){var re=[K,X,0,1];return nn(re,re,Y),{point:new e.Point((re[0]/re[3]+1)/2*this.transform.width+100,(-re[1]/re[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/re[3]*.5}},Xr.prototype.isOffscreen=function(Y,K,X,re){return X<100||Y>=this.screenRightBoundary||re<100||K>this.screenBottomBoundary},Xr.prototype.isInsideGrid=function(Y,K,X,re){return X>=0&&Y<this.gridRightBoundary&&re>=0&&K<this.gridBottomBoundary},Xr.prototype.getViewportMatrix=function(){var Y=e.identity([]);return e.translate(Y,Y,[-100,-100,0]),Y};var Br=function(Y,K,X,re){this.opacity=Y?Math.max(0,Math.min(1,Y.opacity+(Y.placed?K:-K))):re&&X?1:0,this.placed=X};Br.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var on=function(Y,K,X,re,me){this.text=new Br(Y?Y.text:null,K,X,me),this.icon=new Br(Y?Y.icon:null,K,re,me)};on.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var cn=function(Y,K,X){this.text=Y,this.icon=K,this.skipFade=X},un=function(){this.invProjMatrix=e.create(),this.viewportMatrix=e.create(),this.circles=[]},Zr=function(Y,K,X,re,me){this.bucketInstanceId=Y,this.featureIndex=K,this.sourceLayerIndex=X,this.bucketIndex=re,this.tileID=me},yn=function(Y){this.crossSourceCollisions=Y,this.maxGroupID=0,this.collisionGroups={}};function In(Y,K,X,re,me){var Oe=e.getAnchorAlignment(Y),Be=-(Oe.horizontalAlign-.5)*K,tt=-(Oe.verticalAlign-.5)*X,ft=e.evaluateVariableOffset(Y,re);return new e.Point(Be+ft[0]*me,tt+ft[1]*me)}function Un(Y,K,X,re,me,Oe){var Be=Y.x1,tt=Y.x2,ft=Y.y1,St=Y.y2,Ft=Y.anchorPointX,Gt=Y.anchorPointY,$t=new e.Point(K,X);return re&&$t._rotate(me?Oe:-Oe),{x1:Be+$t.x,y1:ft+$t.y,x2:tt+$t.x,y2:St+$t.y,anchorPointX:Ft,anchorPointY:Gt}}yn.prototype.get=function(Y){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[Y]){var K=++this.maxGroupID;this.collisionGroups[Y]={ID:K,predicate:function(X){return X.collisionGroupID===K}}}return this.collisionGroups[Y]};var Kn=function(Y,K,X,re){this.transform=Y.clone(),this.collisionIndex=new Xr(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=K,this.retainedQueryData={},this.collisionGroups=new yn(X),this.collisionCircleArrays={},this.prevPlacement=re,re&&(re.prevPlacement=void 0),this.placedOrientations={}};function vt(Y,K,X,re,me){Y.emplaceBack(K?1:0,X?1:0,re||0,me||0),Y.emplaceBack(K?1:0,X?1:0,re||0,me||0),Y.emplaceBack(K?1:0,X?1:0,re||0,me||0),Y.emplaceBack(K?1:0,X?1:0,re||0,me||0)}Kn.prototype.getBucketParts=function(Y,K,X,re){var me=X.getBucket(K),Oe=X.latestFeatureIndex;if(me&&Oe&&K.id===me.layerIds[0]){var Be=X.collisionBoxArray,tt=me.layers[0].layout,ft=Math.pow(2,this.transform.zoom-X.tileID.overscaledZ),St=X.tileSize/e.EXTENT,Ft=this.transform.calculatePosMatrix(X.tileID.toUnwrapped()),Gt=tt.get("text-pitch-alignment")==="map",$t=tt.get("text-rotation-alignment")==="map",sr=Nr(X,1,this.transform.zoom),lr=Qt(Ft,Gt,$t,this.transform,sr),vr=null;if(Gt){var ir=cr(Ft,Gt,$t,this.transform,sr);vr=e.multiply([],this.transform.labelPlaneMatrix,ir)}this.retainedQueryData[me.bucketInstanceId]=new Zr(me.bucketInstanceId,Oe,me.sourceLayerIndex,me.index,X.tileID);var gr={bucket:me,layout:tt,posMatrix:Ft,textLabelPlaneMatrix:lr,labelToScreenMatrix:vr,scale:ft,textPixelRatio:St,holdingForFade:X.holdingForFade(),collisionBoxArray:Be,partiallyEvaluatedTextSize:e.evaluateSizeForZoom(me.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(me.sourceID)};if(re)for(var Ar=0,Pr=me.sortKeyRanges;Ar<Pr.length;Ar+=1){var Gr=Pr[Ar];Y.push({sortKey:Gr.sortKey,symbolInstanceStart:Gr.symbolInstanceStart,symbolInstanceEnd:Gr.symbolInstanceEnd,parameters:gr})}else Y.push({symbolInstanceStart:0,symbolInstanceEnd:me.symbolInstances.length,parameters:gr})}},Kn.prototype.attemptAnchorPlacement=function(Y,K,X,re,me,Oe,Be,tt,ft,St,Ft,Gt,$t,sr,lr){var vr,ir=[Gt.textOffset0,Gt.textOffset1],gr=In(Y,X,re,ir,me),Ar=this.collisionIndex.placeCollisionBox(Un(K,gr.x,gr.y,Oe,Be,this.transform.angle),Ft,tt,ft,St.predicate);if(!lr||this.collisionIndex.placeCollisionBox(Un(lr,gr.x,gr.y,Oe,Be,this.transform.angle),Ft,tt,ft,St.predicate).box.length!==0)return Ar.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[Gt.crossTileID]&&this.prevPlacement.placements[Gt.crossTileID]&&this.prevPlacement.placements[Gt.crossTileID].text&&(vr=this.prevPlacement.variableOffsets[Gt.crossTileID].anchor),this.variableOffsets[Gt.crossTileID]={textOffset:ir,width:X,height:re,anchor:Y,textBoxScale:me,prevAnchor:vr},this.markUsedJustification($t,Y,Gt,sr),$t.allowVerticalPlacement&&(this.markUsedOrientation($t,sr,Gt),this.placedOrientations[Gt.crossTileID]=sr),{shift:gr,placedGlyphBoxes:Ar}):void 0},Kn.prototype.placeLayerBucketPart=function(Y,K,X){var re=this,me=Y.parameters,Oe=me.bucket,Be=me.layout,tt=me.posMatrix,ft=me.textLabelPlaneMatrix,St=me.labelToScreenMatrix,Ft=me.textPixelRatio,Gt=me.holdingForFade,$t=me.collisionBoxArray,sr=me.partiallyEvaluatedTextSize,lr=me.collisionGroup,vr=Be.get("text-optional"),ir=Be.get("icon-optional"),gr=Be.get("text-allow-overlap"),Ar=Be.get("icon-allow-overlap"),Pr=Be.get("text-rotation-alignment")==="map",Gr=Be.get("text-pitch-alignment")==="map",Fr=Be.get("icon-text-fit")!=="none",Yr=Be.get("symbol-z-order")==="viewport-y",an=gr&&(Ar||!Oe.hasIconData()||ir),mn=Ar&&(gr||!Oe.hasTextData()||vr);!Oe.collisionArrays&&$t&&Oe.deserializeCollisionBoxes($t);var pn=function(Sn,ra){if(!K[Sn.crossTileID])if(Gt)re.placements[Sn.crossTileID]=new cn(!1,!1,!1);else{var sa,Hn=!1,Gn=!1,$n=!0,Zn=null,qn={box:null,offscreen:null},fi={box:null,offscreen:null},Fa=null,Ha=null,ba=0,Ga=0,Ea=0;ra.textFeatureIndex?ba=ra.textFeatureIndex:Sn.useRuntimeCollisionCircles&&(ba=Sn.featureIndex),ra.verticalTextFeatureIndex&&(Ga=ra.verticalTextFeatureIndex);var Ao=ra.textBox;if(Ao){var Os=function(Da){var Ii=e.WritingMode.horizontal;if(Oe.allowVerticalPlacement&&!Da&&re.prevPlacement){var Oi=re.prevPlacement.placedOrientations[Sn.crossTileID];Oi&&(re.placedOrientations[Sn.crossTileID]=Oi,re.markUsedOrientation(Oe,Ii=Oi,Sn))}return Ii},go=function(Da,Ii){if(Oe.allowVerticalPlacement&&Sn.numVerticalGlyphVertices>0&&ra.verticalTextBox)for(var Oi=0,Rs=Oe.writingModes;Oi<Rs.length&&(Rs[Oi]===e.WritingMode.vertical?(qn=Ii(),fi=qn):qn=Da(),!(qn&&qn.box&&qn.box.length));Oi+=1);else qn=Da()};if(Be.get("text-variable-anchor")){var Si=Be.get("text-variable-anchor");if(re.prevPlacement&&re.prevPlacement.variableOffsets[Sn.crossTileID]){var mo=re.prevPlacement.variableOffsets[Sn.crossTileID];Si.indexOf(mo.anchor)>0&&(Si=Si.filter(function(Da){return Da!==mo.anchor})).unshift(mo.anchor)}var Do=function(Da,Ii,Oi){for(var Rs=Da.x2-Da.x1,vu=Da.y2-Da.y1,Xl=Sn.textBoxScale,vc=Fr&&!Ar?Ii:null,So={box:[],offscreen:!1},kl=gr?2*Si.length:Si.length,rl=0;rl<kl;++rl){var vo=re.attemptAnchorPlacement(Si[rl%Si.length],Da,Rs,vu,Xl,Pr,Gr,Ft,tt,lr,rl>=Si.length,Sn,Oe,Oi,vc);if(vo&&(So=vo.placedGlyphBoxes)&&So.box&&So.box.length){Hn=!0,Zn=vo.shift;break}}return So};go(function(){return Do(Ao,ra.iconBox,e.WritingMode.horizontal)},function(){var Da=ra.verticalTextBox;return Oe.allowVerticalPlacement&&!(qn&&qn.box&&qn.box.length)&&Sn.numVerticalGlyphVertices>0&&Da?Do(Da,ra.verticalIconBox,e.WritingMode.vertical):{box:null,offscreen:null}}),qn&&(Hn=qn.box,$n=qn.offscreen);var tl=Os(qn&&qn.box);if(!Hn&&re.prevPlacement){var ms=re.prevPlacement.variableOffsets[Sn.crossTileID];ms&&(re.variableOffsets[Sn.crossTileID]=ms,re.markUsedJustification(Oe,ms.anchor,Sn,tl))}}else{var zs=function(Da,Ii){var Oi=re.collisionIndex.placeCollisionBox(Da,gr,Ft,tt,lr.predicate);return Oi&&Oi.box&&Oi.box.length&&(re.markUsedOrientation(Oe,Ii,Sn),re.placedOrientations[Sn.crossTileID]=Ii),Oi};go(function(){return zs(Ao,e.WritingMode.horizontal)},function(){var Da=ra.verticalTextBox;return Oe.allowVerticalPlacement&&Sn.numVerticalGlyphVertices>0&&Da?zs(Da,e.WritingMode.vertical):{box:null,offscreen:null}}),Os(qn&&qn.box&&qn.box.length)}}if(Hn=(sa=qn)&&sa.box&&sa.box.length>0,$n=sa&&sa.offscreen,Sn.useRuntimeCollisionCircles){var Ro=Oe.text.placedSymbolArray.get(Sn.centerJustifiedTextSymbolIndex),Tl=e.evaluateSizeForFeature(Oe.textSizeData,sr,Ro),Fo=Be.get("text-padding");Fa=re.collisionIndex.placeCollisionCircles(gr,Ro,Oe.lineVertexArray,Oe.glyphOffsetArray,Tl,tt,ft,St,X,Gr,lr.predicate,Sn.collisionCircleDiameter,Fo),Hn=gr||Fa.circles.length>0&&!Fa.collisionDetected,$n=$n&&Fa.offscreen}if(ra.iconFeatureIndex&&(Ea=ra.iconFeatureIndex),ra.iconBox){var Bo=function(Da){var Ii=Fr&&Zn?Un(Da,Zn.x,Zn.y,Pr,Gr,re.transform.angle):Da;return re.collisionIndex.placeCollisionBox(Ii,Ar,Ft,tt,lr.predicate)};Gn=fi&&fi.box&&fi.box.length&&ra.verticalIconBox?(Ha=Bo(ra.verticalIconBox)).box.length>0:(Ha=Bo(ra.iconBox)).box.length>0,$n=$n&&Ha.offscreen}var Xa=vr||Sn.numHorizontalGlyphVertices===0&&Sn.numVerticalGlyphVertices===0,Ds=ir||Sn.numIconVertices===0;if(Xa||Ds?Ds?Xa||(Gn=Gn&&Hn):Hn=Gn&&Hn:Gn=Hn=Gn&&Hn,Hn&&sa&&sa.box&&re.collisionIndex.insertCollisionBox(sa.box,Be.get("text-ignore-placement"),Oe.bucketInstanceId,fi&&fi.box&&Ga?Ga:ba,lr.ID),Gn&&Ha&&re.collisionIndex.insertCollisionBox(Ha.box,Be.get("icon-ignore-placement"),Oe.bucketInstanceId,Ea,lr.ID),Fa&&(Hn&&re.collisionIndex.insertCollisionCircles(Fa.circles,Be.get("text-ignore-placement"),Oe.bucketInstanceId,ba,lr.ID),X)){var Zl=Oe.bucketInstanceId,Ja=re.collisionCircleArrays[Zl];Ja===void 0&&(Ja=re.collisionCircleArrays[Zl]=new un);for(var vs=0;vs<Fa.circles.length;vs+=4)Ja.circles.push(Fa.circles[vs+0]),Ja.circles.push(Fa.circles[vs+1]),Ja.circles.push(Fa.circles[vs+2]),Ja.circles.push(Fa.collisionDetected?1:0)}re.placements[Sn.crossTileID]=new cn(Hn||an,Gn||mn,$n||Oe.justReloaded),K[Sn.crossTileID]=!0}};if(Yr)for(var xn=Oe.getSortedSymbolIndexes(this.transform.angle),Ln=xn.length-1;Ln>=0;--Ln){var Jn=xn[Ln];pn(Oe.symbolInstances.get(Jn),Oe.collisionArrays[Jn])}else for(var Vn=Y.symbolInstanceStart;Vn<Y.symbolInstanceEnd;Vn++)pn(Oe.symbolInstances.get(Vn),Oe.collisionArrays[Vn]);if(X&&Oe.bucketInstanceId in this.collisionCircleArrays){var oa=this.collisionCircleArrays[Oe.bucketInstanceId];e.invert(oa.invProjMatrix,tt),oa.viewportMatrix=this.collisionIndex.getViewportMatrix()}Oe.justReloaded=!1},Kn.prototype.markUsedJustification=function(Y,K,X,re){var me;me=re===e.WritingMode.vertical?X.verticalPlacedTextSymbolIndex:{left:X.leftJustifiedTextSymbolIndex,center:X.centerJustifiedTextSymbolIndex,right:X.rightJustifiedTextSymbolIndex}[e.getAnchorJustification(K)];for(var Oe=0,Be=[X.leftJustifiedTextSymbolIndex,X.centerJustifiedTextSymbolIndex,X.rightJustifiedTextSymbolIndex,X.verticalPlacedTextSymbolIndex];Oe<Be.length;Oe+=1){var tt=Be[Oe];tt>=0&&(Y.text.placedSymbolArray.get(tt).crossTileID=me>=0&&tt!==me?0:X.crossTileID)}},Kn.prototype.markUsedOrientation=function(Y,K,X){for(var re=K===e.WritingMode.horizontal||K===e.WritingMode.horizontalOnly?K:0,me=K===e.WritingMode.vertical?K:0,Oe=0,Be=[X.leftJustifiedTextSymbolIndex,X.centerJustifiedTextSymbolIndex,X.rightJustifiedTextSymbolIndex];Oe<Be.length;Oe+=1)Y.text.placedSymbolArray.get(Be[Oe]).placedOrientation=re;X.verticalPlacedTextSymbolIndex&&(Y.text.placedSymbolArray.get(X.verticalPlacedTextSymbolIndex).placedOrientation=me)},Kn.prototype.commit=function(Y){this.commitTime=Y,this.zoomAtLastRecencyCheck=this.transform.zoom;var K=this.prevPlacement,X=!1;this.prevZoomAdjustment=K?K.zoomAdjustment(this.transform.zoom):0;var re=K?K.symbolFadeChange(Y):1,me=K?K.opacities:{},Oe=K?K.variableOffsets:{},Be=K?K.placedOrientations:{};for(var tt in this.placements){var ft=this.placements[tt],St=me[tt];St?(this.opacities[tt]=new on(St,re,ft.text,ft.icon),X=X||ft.text!==St.text.placed||ft.icon!==St.icon.placed):(this.opacities[tt]=new on(null,re,ft.text,ft.icon,ft.skipFade),X=X||ft.text||ft.icon)}for(var Ft in me){var Gt=me[Ft];if(!this.opacities[Ft]){var $t=new on(Gt,re,!1,!1);$t.isHidden()||(this.opacities[Ft]=$t,X=X||Gt.text.placed||Gt.icon.placed)}}for(var sr in Oe)this.variableOffsets[sr]||!this.opacities[sr]||this.opacities[sr].isHidden()||(this.variableOffsets[sr]=Oe[sr]);for(var lr in Be)this.placedOrientations[lr]||!this.opacities[lr]||this.opacities[lr].isHidden()||(this.placedOrientations[lr]=Be[lr]);X?this.lastPlacementChangeTime=Y:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=K?K.lastPlacementChangeTime:Y)},Kn.prototype.updateLayerOpacities=function(Y,K){for(var X={},re=0,me=K;re<me.length;re+=1){var Oe=me[re],Be=Oe.getBucket(Y);Be&&Oe.latestFeatureIndex&&Y.id===Be.layerIds[0]&&this.updateBucketOpacities(Be,X,Oe.collisionBoxArray)}},Kn.prototype.updateBucketOpacities=function(Y,K,X){var re=this;Y.hasTextData()&&Y.text.opacityVertexArray.clear(),Y.hasIconData()&&Y.icon.opacityVertexArray.clear(),Y.hasIconCollisionBoxData()&&Y.iconCollisionBox.collisionVertexArray.clear(),Y.hasTextCollisionBoxData()&&Y.textCollisionBox.collisionVertexArray.clear();var me=Y.layers[0].layout,Oe=new on(null,0,!1,!1,!0),Be=me.get("text-allow-overlap"),tt=me.get("icon-allow-overlap"),ft=me.get("text-variable-anchor"),St=me.get("text-rotation-alignment")==="map",Ft=me.get("text-pitch-alignment")==="map",Gt=me.get("icon-text-fit")!=="none",$t=new on(null,0,Be&&(tt||!Y.hasIconData()||me.get("icon-optional")),tt&&(Be||!Y.hasTextData()||me.get("text-optional")),!0);!Y.collisionArrays&&X&&(Y.hasIconCollisionBoxData()||Y.hasTextCollisionBoxData())&&Y.deserializeCollisionBoxes(X);for(var sr=function(gr,Ar,Pr){for(var Gr=0;Gr<Ar/4;Gr++)gr.opacityVertexArray.emplaceBack(Pr)},lr=function(gr){var Ar=Y.symbolInstances.get(gr),Pr=Ar.numHorizontalGlyphVertices,Gr=Ar.numVerticalGlyphVertices,Fr=Ar.crossTileID,Yr=re.opacities[Fr];K[Fr]?Yr=Oe:Yr||(re.opacities[Fr]=Yr=$t),K[Fr]=!0;var an=Ar.numIconVertices>0,mn=re.placedOrientations[Ar.crossTileID],pn=mn===e.WritingMode.vertical,xn=mn===e.WritingMode.horizontal||mn===e.WritingMode.horizontalOnly;if(Pr>0||Gr>0){var Ln=Tr(Yr.text);sr(Y.text,Pr,pn?fr:Ln),sr(Y.text,Gr,xn?fr:Ln);var Jn=Yr.text.isHidden();[Ar.rightJustifiedTextSymbolIndex,Ar.centerJustifiedTextSymbolIndex,Ar.leftJustifiedTextSymbolIndex].forEach(function(qn){qn>=0&&(Y.text.placedSymbolArray.get(qn).hidden=Jn||pn?1:0)}),Ar.verticalPlacedTextSymbolIndex>=0&&(Y.text.placedSymbolArray.get(Ar.verticalPlacedTextSymbolIndex).hidden=Jn||xn?1:0);var Vn=re.variableOffsets[Ar.crossTileID];Vn&&re.markUsedJustification(Y,Vn.anchor,Ar,mn);var oa=re.placedOrientations[Ar.crossTileID];oa&&(re.markUsedJustification(Y,"left",Ar,oa),re.markUsedOrientation(Y,oa,Ar))}if(an){var Sn=Tr(Yr.icon),ra=!(Gt&&Ar.verticalPlacedIconSymbolIndex&&pn);Ar.placedIconSymbolIndex>=0&&(sr(Y.icon,Ar.numIconVertices,ra?Sn:fr),Y.icon.placedSymbolArray.get(Ar.placedIconSymbolIndex).hidden=Yr.icon.isHidden()),Ar.verticalPlacedIconSymbolIndex>=0&&(sr(Y.icon,Ar.numVerticalIconVertices,ra?fr:Sn),Y.icon.placedSymbolArray.get(Ar.verticalPlacedIconSymbolIndex).hidden=Yr.icon.isHidden())}if(Y.hasIconCollisionBoxData()||Y.hasTextCollisionBoxData()){var sa=Y.collisionArrays[gr];if(sa){var Hn=new e.Point(0,0);if(sa.textBox||sa.verticalTextBox){var Gn=!0;if(ft){var $n=re.variableOffsets[Fr];$n?(Hn=In($n.anchor,$n.width,$n.height,$n.textOffset,$n.textBoxScale),St&&Hn._rotate(Ft?re.transform.angle:-re.transform.angle)):Gn=!1}sa.textBox&&vt(Y.textCollisionBox.collisionVertexArray,Yr.text.placed,!Gn||pn,Hn.x,Hn.y),sa.verticalTextBox&&vt(Y.textCollisionBox.collisionVertexArray,Yr.text.placed,!Gn||xn,Hn.x,Hn.y)}var Zn=!!(!xn&&sa.verticalIconBox);sa.iconBox&&vt(Y.iconCollisionBox.collisionVertexArray,Yr.icon.placed,Zn,Gt?Hn.x:0,Gt?Hn.y:0),sa.verticalIconBox&&vt(Y.iconCollisionBox.collisionVertexArray,Yr.icon.placed,!Zn,Gt?Hn.x:0,Gt?Hn.y:0)}}},vr=0;vr<Y.symbolInstances.length;vr++)lr(vr);if(Y.sortFeatures(this.transform.angle),this.retainedQueryData[Y.bucketInstanceId]&&(this.retainedQueryData[Y.bucketInstanceId].featureSortOrder=Y.featureSortOrder),Y.hasTextData()&&Y.text.opacityVertexBuffer&&Y.text.opacityVertexBuffer.updateData(Y.text.opacityVertexArray),Y.hasIconData()&&Y.icon.opacityVertexBuffer&&Y.icon.opacityVertexBuffer.updateData(Y.icon.opacityVertexArray),Y.hasIconCollisionBoxData()&&Y.iconCollisionBox.collisionVertexBuffer&&Y.iconCollisionBox.collisionVertexBuffer.updateData(Y.iconCollisionBox.collisionVertexArray),Y.hasTextCollisionBoxData()&&Y.textCollisionBox.collisionVertexBuffer&&Y.textCollisionBox.collisionVertexBuffer.updateData(Y.textCollisionBox.collisionVertexArray),Y.bucketInstanceId in this.collisionCircleArrays){var ir=this.collisionCircleArrays[Y.bucketInstanceId];Y.placementInvProjMatrix=ir.invProjMatrix,Y.placementViewportMatrix=ir.viewportMatrix,Y.collisionCircleArray=ir.circles,delete this.collisionCircleArrays[Y.bucketInstanceId]}},Kn.prototype.symbolFadeChange=function(Y){return this.fadeDuration===0?1:(Y-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},Kn.prototype.zoomAdjustment=function(Y){return Math.max(0,(this.transform.zoom-Y)/1.5)},Kn.prototype.hasTransitions=function(Y){return this.stale||Y-this.lastPlacementChangeTime<this.fadeDuration},Kn.prototype.stillRecent=function(Y,K){var X=this.zoomAtLastRecencyCheck===K?1-this.zoomAdjustment(K):1;return this.zoomAtLastRecencyCheck=K,this.commitTime+this.fadeDuration*X>Y},Kn.prototype.setStale=function(){this.stale=!0};var Zt=Math.pow(2,25),qt=Math.pow(2,24),yr=Math.pow(2,17),Dr=Math.pow(2,16),Mr=Math.pow(2,9),xr=Math.pow(2,8),hr=Math.pow(2,1);function Tr(Y){if(Y.opacity===0&&!Y.placed)return 0;if(Y.opacity===1&&Y.placed)return 4294967295;var K=Y.placed?1:0,X=Math.floor(127*Y.opacity);return X*Zt+K*qt+X*yr+K*Dr+X*Mr+K*xr+X*hr+K}var fr=0,br=function(Y){this._sortAcrossTiles=Y.layout.get("symbol-z-order")!=="viewport-y"&&Y.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};br.prototype.continuePlacement=function(Y,K,X,re,me){for(var Oe=this._bucketParts;this._currentTileIndex<Y.length;)if(K.getBucketParts(Oe,re,Y[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,me())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,Oe.sort(function(Be,tt){return Be.sortKey-tt.sortKey}));this._currentPartIndex<Oe.length;)if(K.placeLayerBucketPart(Oe[this._currentPartIndex],this._seenCrossTileIDs,X),this._currentPartIndex++,me())return!0;return!1};var Or=function(Y,K,X,re,me,Oe,Be){this.placement=new Kn(Y,me,Oe,Be),this._currentPlacementIndex=K.length-1,this._forceFullPlacement=X,this._showCollisionBoxes=re,this._done=!1};Or.prototype.isDone=function(){return this._done},Or.prototype.continuePlacement=function(Y,K,X){for(var re=this,me=e.browser.now(),Oe=function(){var ft=e.browser.now()-me;return!re._forceFullPlacement&&ft>2};this._currentPlacementIndex>=0;){var Be=K[Y[this._currentPlacementIndex]],tt=this.placement.collisionIndex.transform.zoom;if(Be.type==="symbol"&&(!Be.minzoom||Be.minzoom<=tt)&&(!Be.maxzoom||Be.maxzoom>tt)){if(this._inProgressLayer||(this._inProgressLayer=new br(Be)),this._inProgressLayer.continuePlacement(X[Be.source],this.placement,this._showCollisionBoxes,Be,Oe))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},Or.prototype.commit=function(Y){return this.placement.commit(Y),this.placement};var sn=512/e.EXTENT/2,Jr=function(Y,K,X){this.tileID=Y,this.indexedSymbolInstances={},this.bucketInstanceId=X;for(var re=0;re<K.length;re++){var me=K.get(re),Oe=me.key;this.indexedSymbolInstances[Oe]||(this.indexedSymbolInstances[Oe]=[]),this.indexedSymbolInstances[Oe].push({crossTileID:me.crossTileID,coord:this.getScaledCoordinates(me,Y)})}};Jr.prototype.getScaledCoordinates=function(Y,K){var X=sn/Math.pow(2,K.canonical.z-this.tileID.canonical.z);return{x:Math.floor((K.canonical.x*e.EXTENT+Y.anchorX)*X),y:Math.floor((K.canonical.y*e.EXTENT+Y.anchorY)*X)}},Jr.prototype.findMatches=function(Y,K,X){for(var re=this.tileID.canonical.z<K.canonical.z?1:Math.pow(2,this.tileID.canonical.z-K.canonical.z),me=0;me<Y.length;me++){var Oe=Y.get(me);if(!Oe.crossTileID){var Be=this.indexedSymbolInstances[Oe.key];if(Be)for(var tt=this.getScaledCoordinates(Oe,K),ft=0,St=Be;ft<St.length;ft+=1){var Ft=St[ft];if(Math.abs(Ft.coord.x-tt.x)<=re&&Math.abs(Ft.coord.y-tt.y)<=re&&!X[Ft.crossTileID]){X[Ft.crossTileID]=!0,Oe.crossTileID=Ft.crossTileID;break}}}}};var dn=function(){this.maxCrossTileID=0};dn.prototype.generate=function(){return++this.maxCrossTileID};var qr=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};qr.prototype.handleWrapJump=function(Y){var K=Math.round((Y-this.lng)/360);if(K!==0)for(var X in this.indexes){var re=this.indexes[X],me={};for(var Oe in re){var Be=re[Oe];Be.tileID=Be.tileID.unwrapTo(Be.tileID.wrap+K),me[Be.tileID.key]=Be}this.indexes[X]=me}this.lng=Y},qr.prototype.addBucket=function(Y,K,X){if(this.indexes[Y.overscaledZ]&&this.indexes[Y.overscaledZ][Y.key]){if(this.indexes[Y.overscaledZ][Y.key].bucketInstanceId===K.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(Y.overscaledZ,this.indexes[Y.overscaledZ][Y.key])}for(var re=0;re<K.symbolInstances.length;re++)K.symbolInstances.get(re).crossTileID=0;this.usedCrossTileIDs[Y.overscaledZ]||(this.usedCrossTileIDs[Y.overscaledZ]={});var me=this.usedCrossTileIDs[Y.overscaledZ];for(var Oe in this.indexes){var Be=this.indexes[Oe];if(Number(Oe)>Y.overscaledZ)for(var tt in Be){var ft=Be[tt];ft.tileID.isChildOf(Y)&&ft.findMatches(K.symbolInstances,Y,me)}else{var St=Be[Y.scaledTo(Number(Oe)).key];St&&St.findMatches(K.symbolInstances,Y,me)}}for(var Ft=0;Ft<K.symbolInstances.length;Ft++){var Gt=K.symbolInstances.get(Ft);Gt.crossTileID||(Gt.crossTileID=X.generate(),me[Gt.crossTileID]=!0)}return this.indexes[Y.overscaledZ]===void 0&&(this.indexes[Y.overscaledZ]={}),this.indexes[Y.overscaledZ][Y.key]=new Jr(Y,K.symbolInstances,K.bucketInstanceId),!0},qr.prototype.removeBucketCrossTileIDs=function(Y,K){for(var X in K.indexedSymbolInstances)for(var re=0,me=K.indexedSymbolInstances[X];re<me.length;re+=1)delete this.usedCrossTileIDs[Y][me[re].crossTileID]},qr.prototype.removeStaleBuckets=function(Y){var K=!1;for(var X in this.indexes){var re=this.indexes[X];for(var me in re)Y[re[me].bucketInstanceId]||(this.removeBucketCrossTileIDs(X,re[me]),delete re[me],K=!0)}return K};var bn=function(){this.layerIndexes={},this.crossTileIDs=new dn,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};bn.prototype.addLayer=function(Y,K,X){var re=this.layerIndexes[Y.id];re===void 0&&(re=this.layerIndexes[Y.id]=new qr);var me=!1,Oe={};re.handleWrapJump(X);for(var Be=0,tt=K;Be<tt.length;Be+=1){var ft=tt[Be],St=ft.getBucket(Y);St&&Y.id===St.layerIds[0]&&(St.bucketInstanceId||(St.bucketInstanceId=++this.maxBucketInstanceId),re.addBucket(ft.tileID,St,this.crossTileIDs)&&(me=!0),Oe[St.bucketInstanceId]=!0)}return re.removeStaleBuckets(Oe)&&(me=!0),me},bn.prototype.pruneUnusedLayers=function(Y){var K={};for(var X in Y.forEach(function(re){K[re]=!0}),this.layerIndexes)K[X]||delete this.layerIndexes[X]};var Qn=function(Y,K){return e.emitValidationErrors(Y,K&&K.filter(function(X){return X.identifier!=="source.canvas"}))},Dn=e.pick(Yt,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),gn=e.pick(Yt,["setCenter","setZoom","setBearing","setPitch"]),Pn=function(){var Y={},K=e.styleSpec.$version;for(var X in e.styleSpec.$root){var re,me=e.styleSpec.$root[X];me.required&&(re=X==="version"?K:me.type==="array"?[]:{})!=null&&(Y[X]=re)}return Y}(),na=function(Y){function K(X,re){var me=this;re===void 0&&(re={}),Y.call(this),this.map=X,this.dispatcher=new L(It(),this),this.imageManager=new y,this.imageManager.setEventedParent(this),this.glyphManager=new b(X._requestManager,re.localIdeographFontFamily),this.lineAtlas=new k(256,512),this.crossTileSymbolIndex=new bn,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new e.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",e.getReferrer());var Oe=this;this._rtlTextPluginCallback=K.registerForPluginStateChange(function(Be){Oe.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:Be.pluginStatus,pluginURL:Be.pluginURL},function(tt,ft){if(e.triggerPluginCompletionEvent(tt),ft&&ft.every(function(Ft){return Ft}))for(var St in Oe.sourceCaches)Oe.sourceCaches[St].reload()})}),this.on("data",function(Be){if(Be.dataType==="source"&&Be.sourceDataType==="metadata"){var tt=me.sourceCaches[Be.sourceId];if(tt){var ft=tt.getSource();if(ft&&ft.vectorLayerIds)for(var St in me._layers){var Ft=me._layers[St];Ft.source===ft.id&&me._validateLayer(Ft)}}}})}return Y&&(K.__proto__=Y),(K.prototype=Object.create(Y&&Y.prototype)).constructor=K,K.prototype.loadURL=function(X,re){var me=this;re===void 0&&(re={}),this.fire(new e.Event("dataloading",{dataType:"style"}));var Oe=typeof re.validate=="boolean"?re.validate:!e.isMapboxURL(X);X=this.map._requestManager.normalizeStyleURL(X,re.accessToken);var Be=this.map._requestManager.transformRequest(X,e.ResourceType.Style);this._request=e.getJSON(Be,function(tt,ft){me._request=null,tt?me.fire(new e.ErrorEvent(tt)):ft&&me._load(ft,Oe)})},K.prototype.loadJSON=function(X,re){var me=this;re===void 0&&(re={}),this.fire(new e.Event("dataloading",{dataType:"style"})),this._request=e.browser.frame(function(){me._request=null,me._load(X,re.validate!==!1)})},K.prototype.loadEmpty=function(){this.fire(new e.Event("dataloading",{dataType:"style"})),this._load(Pn,!1)},K.prototype._load=function(X,re){if(!re||!Qn(this,e.validateStyle(X))){for(var me in this._loaded=!0,this.stylesheet=X,X.sources)this.addSource(me,X.sources[me],{validate:!1});X.sprite?this._loadSprite(X.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(X.glyphs);var Oe=Ot(this.stylesheet.layers);this._order=Oe.map(function(St){return St.id}),this._layers={},this._serializedLayers={};for(var Be=0,tt=Oe;Be<tt.length;Be+=1){var ft=tt[Be];(ft=e.createStyleLayer(ft)).setEventedParent(this,{layer:{id:ft.id}}),this._layers[ft.id]=ft,this._serializedLayers[ft.id]=ft.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new C(this.stylesheet.light),this.fire(new e.Event("data",{dataType:"style"})),this.fire(new e.Event("style.load"))}},K.prototype._loadSprite=function(X){var re=this;this._spriteRequest=function(me,Oe,Be){var tt,ft,St,Ft=e.browser.devicePixelRatio>1?"@2x":"",Gt=e.getJSON(Oe.transformRequest(Oe.normalizeSpriteURL(me,Ft,".json"),e.ResourceType.SpriteJSON),function(lr,vr){Gt=null,St||(St=lr,tt=vr,sr())}),$t=e.getImage(Oe.transformRequest(Oe.normalizeSpriteURL(me,Ft,".png"),e.ResourceType.SpriteImage),function(lr,vr){$t=null,St||(St=lr,ft=vr,sr())});function sr(){if(St)Be(St);else if(tt&&ft){var lr=e.browser.getImageData(ft),vr={};for(var ir in tt){var gr=tt[ir],Ar=gr.width,Pr=gr.height,Gr=gr.x,Fr=gr.y,Yr=gr.sdf,an=gr.pixelRatio,mn=gr.stretchX,pn=gr.stretchY,xn=gr.content,Ln=new e.RGBAImage({width:Ar,height:Pr});e.RGBAImage.copy(lr,Ln,{x:Gr,y:Fr},{x:0,y:0},{width:Ar,height:Pr}),vr[ir]={data:Ln,pixelRatio:an,sdf:Yr,stretchX:mn,stretchY:pn,content:xn}}Be(null,vr)}}return{cancel:function(){Gt&&(Gt.cancel(),Gt=null),$t&&($t.cancel(),$t=null)}}}(X,this.map._requestManager,function(me,Oe){if(re._spriteRequest=null,me)re.fire(new e.ErrorEvent(me));else if(Oe)for(var Be in Oe)re.imageManager.addImage(Be,Oe[Be]);re.imageManager.setLoaded(!0),re._availableImages=re.imageManager.listImages(),re.dispatcher.broadcast("setImages",re._availableImages),re.fire(new e.Event("data",{dataType:"style"}))})},K.prototype._validateLayer=function(X){var re=this.sourceCaches[X.source];if(re){var me=X.sourceLayer;if(me){var Oe=re.getSource();(Oe.type==="geojson"||Oe.vectorLayerIds&&Oe.vectorLayerIds.indexOf(me)===-1)&&this.fire(new e.ErrorEvent(new Error('Source layer "'+me+'" does not exist on source "'+Oe.id+'" as specified by style layer "'+X.id+'"')))}}},K.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var X in this.sourceCaches)if(!this.sourceCaches[X].loaded())return!1;return!!this.imageManager.isLoaded()},K.prototype._serializeLayers=function(X){for(var re=[],me=0,Oe=X;me<Oe.length;me+=1){var Be=this._layers[Oe[me]];Be.type!=="custom"&&re.push(Be.serialize())}return re},K.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var X in this.sourceCaches)if(this.sourceCaches[X].hasTransition())return!0;for(var re in this._layers)if(this._layers[re].hasTransition())return!0;return!1},K.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},K.prototype.update=function(X){if(this._loaded){var re=this._changed;if(this._changed){var me=Object.keys(this._updatedLayers),Oe=Object.keys(this._removedLayers);for(var Be in(me.length||Oe.length)&&this._updateWorkerLayers(me,Oe),this._updatedSources){var tt=this._updatedSources[Be];tt==="reload"?this._reloadSource(Be):tt==="clear"&&this._clearSource(Be)}for(var ft in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[ft].updateTransitions(X);this.light.updateTransitions(X),this._resetUpdates()}for(var St in this.sourceCaches)this.sourceCaches[St].used=!1;for(var Ft=0,Gt=this._order;Ft<Gt.length;Ft+=1){var $t=this._layers[Gt[Ft]];$t.recalculate(X,this._availableImages),!$t.isHidden(X.zoom)&&$t.source&&(this.sourceCaches[$t.source].used=!0)}this.light.recalculate(X),this.z=X.zoom,re&&this.fire(new e.Event("data",{dataType:"style"}))}},K.prototype._updateTilesForChangedImages=function(){var X=Object.keys(this._changedImages);if(X.length){for(var re in this.sourceCaches)this.sourceCaches[re].reloadTilesForDependencies(["icons","patterns"],X);this._changedImages={}}},K.prototype._updateWorkerLayers=function(X,re){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(X),removedIds:re})},K.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},K.prototype.setState=function(X){var re=this;if(this._checkLoaded(),Qn(this,e.validateStyle(X)))return!1;(X=e.clone$1(X)).layers=Ot(X.layers);var me=function(Be,tt){if(!Be)return[{command:Yt.setStyle,args:[tt]}];var ft=[];try{if(!e.deepEqual(Be.version,tt.version))return[{command:Yt.setStyle,args:[tt]}];e.deepEqual(Be.center,tt.center)||ft.push({command:Yt.setCenter,args:[tt.center]}),e.deepEqual(Be.zoom,tt.zoom)||ft.push({command:Yt.setZoom,args:[tt.zoom]}),e.deepEqual(Be.bearing,tt.bearing)||ft.push({command:Yt.setBearing,args:[tt.bearing]}),e.deepEqual(Be.pitch,tt.pitch)||ft.push({command:Yt.setPitch,args:[tt.pitch]}),e.deepEqual(Be.sprite,tt.sprite)||ft.push({command:Yt.setSprite,args:[tt.sprite]}),e.deepEqual(Be.glyphs,tt.glyphs)||ft.push({command:Yt.setGlyphs,args:[tt.glyphs]}),e.deepEqual(Be.transition,tt.transition)||ft.push({command:Yt.setTransition,args:[tt.transition]}),e.deepEqual(Be.light,tt.light)||ft.push({command:Yt.setLight,args:[tt.light]});var St={},Ft=[];(function($t,sr,lr,vr){var ir;for(ir in sr=sr||{},$t=$t||{})$t.hasOwnProperty(ir)&&(sr.hasOwnProperty(ir)||Ne(ir,lr,vr));for(ir in sr)sr.hasOwnProperty(ir)&&($t.hasOwnProperty(ir)?e.deepEqual($t[ir],sr[ir])||($t[ir].type==="geojson"&&sr[ir].type==="geojson"&&wt($t,sr,ir)?lr.push({command:Yt.setGeoJSONSourceData,args:[ir,sr[ir].data]}):ut(ir,sr,lr,vr)):Pt(ir,sr,lr))})(Be.sources,tt.sources,Ft,St);var Gt=[];Be.layers&&Be.layers.forEach(function($t){St[$t.source]?ft.push({command:Yt.removeLayer,args:[$t.id]}):Gt.push($t)}),ft=ft.concat(Ft),function($t,sr,lr){sr=sr||[];var vr,ir,gr,Ar,Pr,Gr,Fr,Yr=($t=$t||[]).map(Jt),an=sr.map(Jt),mn=$t.reduce(er,{}),pn=sr.reduce(er,{}),xn=Yr.slice(),Ln=Object.create(null);for(vr=0,ir=0;vr<Yr.length;vr++)pn.hasOwnProperty(gr=Yr[vr])?ir++:(lr.push({command:Yt.removeLayer,args:[gr]}),xn.splice(xn.indexOf(gr,ir),1));for(vr=0,ir=0;vr<an.length;vr++)xn[xn.length-1-vr]!==(gr=an[an.length-1-vr])&&(mn.hasOwnProperty(gr)?(lr.push({command:Yt.removeLayer,args:[gr]}),xn.splice(xn.lastIndexOf(gr,xn.length-ir),1)):ir++,lr.push({command:Yt.addLayer,args:[pn[gr],Gr=xn[xn.length-vr]]}),xn.splice(xn.length-vr,0,gr),Ln[gr]=!0);for(vr=0;vr<an.length;vr++)if(Ar=mn[gr=an[vr]],Pr=pn[gr],!Ln[gr]&&!e.deepEqual(Ar,Pr))if(e.deepEqual(Ar.source,Pr.source)&&e.deepEqual(Ar["source-layer"],Pr["source-layer"])&&e.deepEqual(Ar.type,Pr.type)){for(Fr in Bt(Ar.layout,Pr.layout,lr,gr,null,Yt.setLayoutProperty),Bt(Ar.paint,Pr.paint,lr,gr,null,Yt.setPaintProperty),e.deepEqual(Ar.filter,Pr.filter)||lr.push({command:Yt.setFilter,args:[gr,Pr.filter]}),e.deepEqual(Ar.minzoom,Pr.minzoom)&&e.deepEqual(Ar.maxzoom,Pr.maxzoom)||lr.push({command:Yt.setLayerZoomRange,args:[gr,Pr.minzoom,Pr.maxzoom]}),Ar)Ar.hasOwnProperty(Fr)&&Fr!=="layout"&&Fr!=="paint"&&Fr!=="filter"&&Fr!=="metadata"&&Fr!=="minzoom"&&Fr!=="maxzoom"&&(Fr.indexOf("paint.")===0?Bt(Ar[Fr],Pr[Fr],lr,gr,Fr.slice(6),Yt.setPaintProperty):e.deepEqual(Ar[Fr],Pr[Fr])||lr.push({command:Yt.setLayerProperty,args:[gr,Fr,Pr[Fr]]}));for(Fr in Pr)Pr.hasOwnProperty(Fr)&&!Ar.hasOwnProperty(Fr)&&Fr!=="layout"&&Fr!=="paint"&&Fr!=="filter"&&Fr!=="metadata"&&Fr!=="minzoom"&&Fr!=="maxzoom"&&(Fr.indexOf("paint.")===0?Bt(Ar[Fr],Pr[Fr],lr,gr,Fr.slice(6),Yt.setPaintProperty):e.deepEqual(Ar[Fr],Pr[Fr])||lr.push({command:Yt.setLayerProperty,args:[gr,Fr,Pr[Fr]]}))}else lr.push({command:Yt.removeLayer,args:[gr]}),Gr=xn[xn.lastIndexOf(gr)+1],lr.push({command:Yt.addLayer,args:[Pr,Gr]})}(Gt,tt.layers,ft)}catch($t){console.warn("Unable to compute style diff:",$t),ft=[{command:Yt.setStyle,args:[tt]}]}return ft}(this.serialize(),X).filter(function(Be){return!(Be.command in gn)});if(me.length===0)return!1;var Oe=me.filter(function(Be){return!(Be.command in Dn)});if(Oe.length>0)throw new Error("Unimplemented: "+Oe.map(function(Be){return Be.command}).join(", ")+".");return me.forEach(function(Be){Be.command!=="setTransition"&&re[Be.command].apply(re,Be.args)}),this.stylesheet=X,!0},K.prototype.addImage=function(X,re){if(this.getImage(X))return this.fire(new e.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(X,re),this._availableImages=this.imageManager.listImages(),this._changedImages[X]=!0,this._changed=!0,this.fire(new e.Event("data",{dataType:"style"}))},K.prototype.updateImage=function(X,re){this.imageManager.updateImage(X,re)},K.prototype.getImage=function(X){return this.imageManager.getImage(X)},K.prototype.removeImage=function(X){if(!this.getImage(X))return this.fire(new e.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(X),this._availableImages=this.imageManager.listImages(),this._changedImages[X]=!0,this._changed=!0,this.fire(new e.Event("data",{dataType:"style"}))},K.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},K.prototype.addSource=function(X,re,me){var Oe=this;if(me===void 0&&(me={}),this._checkLoaded(),this.sourceCaches[X]!==void 0)throw new Error("There is already a source with this ID");if(!re.type)throw new Error("The type property must be defined, but the only the following properties were given: "+Object.keys(re).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(re.type)>=0&&this._validate(e.validateStyle.source,"sources."+X,re,null,me))){this.map&&this.map._collectResourceTiming&&(re.collectResourceTiming=!0);var Be=this.sourceCaches[X]=new ct(X,re,this.dispatcher);Be.style=this,Be.setEventedParent(this,function(){return{isSourceLoaded:Oe.loaded(),source:Be.serialize(),sourceId:X}}),Be.onAdd(this.map),this._changed=!0}},K.prototype.removeSource=function(X){if(this._checkLoaded(),this.sourceCaches[X]===void 0)throw new Error("There is no source with this ID");for(var re in this._layers)if(this._layers[re].source===X)return this.fire(new e.ErrorEvent(new Error('Source "'+X+'" cannot be removed while layer "'+re+'" is using it.')));var me=this.sourceCaches[X];delete this.sourceCaches[X],delete this._updatedSources[X],me.fire(new e.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:X})),me.setEventedParent(null),me.clearTiles(),me.onRemove&&me.onRemove(this.map),this._changed=!0},K.prototype.setGeoJSONSourceData=function(X,re){this._checkLoaded(),this.sourceCaches[X].getSource().setData(re),this._changed=!0},K.prototype.getSource=function(X){return this.sourceCaches[X]&&this.sourceCaches[X].getSource()},K.prototype.addLayer=function(X,re,me){me===void 0&&(me={}),this._checkLoaded();var Oe=X.id;if(this.getLayer(Oe))this.fire(new e.ErrorEvent(new Error('Layer with id "'+Oe+'" already exists on this map')));else{var Be;if(X.type==="custom"){if(Qn(this,e.validateCustomStyleLayer(X)))return;Be=e.createStyleLayer(X)}else{if(typeof X.source=="object"&&(this.addSource(Oe,X.source),X=e.clone$1(X),X=e.extend(X,{source:Oe})),this._validate(e.validateStyle.layer,"layers."+Oe,X,{arrayIndex:-1},me))return;Be=e.createStyleLayer(X),this._validateLayer(Be),Be.setEventedParent(this,{layer:{id:Oe}}),this._serializedLayers[Be.id]=Be.serialize()}var tt=re?this._order.indexOf(re):this._order.length;if(re&&tt===-1)this.fire(new e.ErrorEvent(new Error('Layer with id "'+re+'" does not exist on this map.')));else{if(this._order.splice(tt,0,Oe),this._layerOrderChanged=!0,this._layers[Oe]=Be,this._removedLayers[Oe]&&Be.source&&Be.type!=="custom"){var ft=this._removedLayers[Oe];delete this._removedLayers[Oe],ft.type!==Be.type?this._updatedSources[Be.source]="clear":(this._updatedSources[Be.source]="reload",this.sourceCaches[Be.source].pause())}this._updateLayer(Be),Be.onAdd&&Be.onAdd(this.map)}}},K.prototype.moveLayer=function(X,re){if(this._checkLoaded(),this._changed=!0,this._layers[X]){if(X!==re){var me=this._order.indexOf(X);this._order.splice(me,1);var Oe=re?this._order.indexOf(re):this._order.length;re&&Oe===-1?this.fire(new e.ErrorEvent(new Error('Layer with id "'+re+'" does not exist on this map.'))):(this._order.splice(Oe,0,X),this._layerOrderChanged=!0)}}else this.fire(new e.ErrorEvent(new Error("The layer '"+X+"' does not exist in the map's style and cannot be moved.")))},K.prototype.removeLayer=function(X){this._checkLoaded();var re=this._layers[X];if(re){re.setEventedParent(null);var me=this._order.indexOf(X);this._order.splice(me,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[X]=re,delete this._layers[X],delete this._serializedLayers[X],delete this._updatedLayers[X],delete this._updatedPaintProps[X],re.onRemove&&re.onRemove(this.map)}else this.fire(new e.ErrorEvent(new Error("The layer '"+X+"' does not exist in the map's style and cannot be removed.")))},K.prototype.getLayer=function(X){return this._layers[X]},K.prototype.hasLayer=function(X){return X in this._layers},K.prototype.setLayerZoomRange=function(X,re,me){this._checkLoaded();var Oe=this.getLayer(X);Oe?Oe.minzoom===re&&Oe.maxzoom===me||(re!=null&&(Oe.minzoom=re),me!=null&&(Oe.maxzoom=me),this._updateLayer(Oe)):this.fire(new e.ErrorEvent(new Error("The layer '"+X+"' does not exist in the map's style and cannot have zoom extent.")))},K.prototype.setFilter=function(X,re,me){me===void 0&&(me={}),this._checkLoaded();var Oe=this.getLayer(X);if(Oe){if(!e.deepEqual(Oe.filter,re))return re==null?(Oe.filter=void 0,void this._updateLayer(Oe)):void(this._validate(e.validateStyle.filter,"layers."+Oe.id+".filter",re,null,me)||(Oe.filter=e.clone$1(re),this._updateLayer(Oe)))}else this.fire(new e.ErrorEvent(new Error("The layer '"+X+"' does not exist in the map's style and cannot be filtered.")))},K.prototype.getFilter=function(X){return e.clone$1(this.getLayer(X).filter)},K.prototype.setLayoutProperty=function(X,re,me,Oe){Oe===void 0&&(Oe={}),this._checkLoaded();var Be=this.getLayer(X);Be?e.deepEqual(Be.getLayoutProperty(re),me)||(Be.setLayoutProperty(re,me,Oe),this._updateLayer(Be)):this.fire(new e.ErrorEvent(new Error("The layer '"+X+"' does not exist in the map's style and cannot be styled.")))},K.prototype.getLayoutProperty=function(X,re){var me=this.getLayer(X);if(me)return me.getLayoutProperty(re);this.fire(new e.ErrorEvent(new Error("The layer '"+X+"' does not exist in the map's style.")))},K.prototype.setPaintProperty=function(X,re,me,Oe){Oe===void 0&&(Oe={}),this._checkLoaded();var Be=this.getLayer(X);Be?e.deepEqual(Be.getPaintProperty(re),me)||(Be.setPaintProperty(re,me,Oe)&&this._updateLayer(Be),this._changed=!0,this._updatedPaintProps[X]=!0):this.fire(new e.ErrorEvent(new Error("The layer '"+X+"' does not exist in the map's style and cannot be styled.")))},K.prototype.getPaintProperty=function(X,re){return this.getLayer(X).getPaintProperty(re)},K.prototype.setFeatureState=function(X,re){this._checkLoaded();var me=X.source,Oe=X.sourceLayer,Be=this.sourceCaches[me];if(Be!==void 0){var tt=Be.getSource().type;tt==="geojson"&&Oe?this.fire(new e.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):tt!=="vector"||Oe?(X.id===void 0&&this.fire(new e.ErrorEvent(new Error("The feature id parameter must be provided."))),Be.setFeatureState(Oe,X.id,re)):this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new e.ErrorEvent(new Error("The source '"+me+"' does not exist in the map's style.")))},K.prototype.removeFeatureState=function(X,re){this._checkLoaded();var me=X.source,Oe=this.sourceCaches[me];if(Oe!==void 0){var Be=Oe.getSource().type,tt=Be==="vector"?X.sourceLayer:void 0;Be!=="vector"||tt?re&&typeof X.id!="string"&&typeof X.id!="number"?this.fire(new e.ErrorEvent(new Error("A feature id is requred to remove its specific state property."))):Oe.removeFeatureState(tt,X.id,re):this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new e.ErrorEvent(new Error("The source '"+me+"' does not exist in the map's style.")))},K.prototype.getFeatureState=function(X){this._checkLoaded();var re=X.source,me=X.sourceLayer,Oe=this.sourceCaches[re];if(Oe!==void 0){if(Oe.getSource().type!=="vector"||me)return X.id===void 0&&this.fire(new e.ErrorEvent(new Error("The feature id parameter must be provided."))),Oe.getFeatureState(me,X.id);this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new e.ErrorEvent(new Error("The source '"+re+"' does not exist in the map's style.")))},K.prototype.getTransition=function(){return e.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},K.prototype.serialize=function(){return e.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:e.mapObject(this.sourceCaches,function(X){return X.serialize()}),layers:this._serializeLayers(this._order)},function(X){return X!==void 0})},K.prototype._updateLayer=function(X){this._updatedLayers[X.id]=!0,X.source&&!this._updatedSources[X.source]&&this.sourceCaches[X.source].getSource().type!=="raster"&&(this._updatedSources[X.source]="reload",this.sourceCaches[X.source].pause()),this._changed=!0},K.prototype._flattenAndSortRenderedFeatures=function(X){for(var re=this,me=function(mn){return re._layers[mn].type==="fill-extrusion"},Oe={},Be=[],tt=this._order.length-1;tt>=0;tt--){var ft=this._order[tt];if(me(ft)){Oe[ft]=tt;for(var St=0,Ft=X;St<Ft.length;St+=1){var Gt=Ft[St][ft];if(Gt)for(var $t=0,sr=Gt;$t<sr.length;$t+=1)Be.push(sr[$t])}}}Be.sort(function(mn,pn){return pn.intersectionZ-mn.intersectionZ});for(var lr=[],vr=this._order.length-1;vr>=0;vr--){var ir=this._order[vr];if(me(ir))for(var gr=Be.length-1;gr>=0;gr--){var Ar=Be[gr].feature;if(Oe[Ar.layer.id]<vr)break;lr.push(Ar),Be.pop()}else for(var Pr=0,Gr=X;Pr<Gr.length;Pr+=1){var Fr=Gr[Pr][ir];if(Fr)for(var Yr=0,an=Fr;Yr<an.length;Yr+=1)lr.push(an[Yr].feature)}}return lr},K.prototype.queryRenderedFeatures=function(X,re,me){re&&re.filter&&this._validate(e.validateStyle.filter,"queryRenderedFeatures.filter",re.filter,null,re);var Oe={};if(re&&re.layers){if(!Array.isArray(re.layers))return this.fire(new e.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var Be=0,tt=re.layers;Be<tt.length;Be+=1){var ft=tt[Be],St=this._layers[ft];if(!St)return this.fire(new e.ErrorEvent(new Error("The layer '"+ft+"' does not exist in the map's style and cannot be queried for features."))),[];Oe[St.source]=!0}}var Ft=[];for(var Gt in re.availableImages=this._availableImages,this.sourceCaches)re.layers&&!Oe[Gt]||Ft.push(W(this.sourceCaches[Gt],this._layers,this._serializedLayers,X,re,me));return this.placement&&Ft.push(function($t,sr,lr,vr,ir,gr,Ar){for(var Pr={},Gr=gr.queryRenderedSymbols(vr),Fr=[],Yr=0,an=Object.keys(Gr).map(Number);Yr<an.length;Yr+=1)Fr.push(Ar[an[Yr]]);Fr.sort(Q);for(var mn=function(){var Vn=xn[pn],oa=Vn.featureIndex.lookupSymbolFeatures(Gr[Vn.bucketInstanceId],sr,Vn.bucketIndex,Vn.sourceLayerIndex,ir.filter,ir.layers,ir.availableImages,$t);for(var Sn in oa){var ra=Pr[Sn]=Pr[Sn]||[],sa=oa[Sn];sa.sort(function($n,Zn){var qn=Vn.featureSortOrder;if(qn){var fi=qn.indexOf($n.featureIndex);return qn.indexOf(Zn.featureIndex)-fi}return Zn.featureIndex-$n.featureIndex});for(var Hn=0,Gn=sa;Hn<Gn.length;Hn+=1)ra.push(Gn[Hn])}},pn=0,xn=Fr;pn<xn.length;pn+=1)mn();var Ln=function(Vn){Pr[Vn].forEach(function(oa){var Sn=oa.feature,ra=lr[$t[Vn].source].getFeatureState(Sn.layer["source-layer"],Sn.id);Sn.source=Sn.layer.source,Sn.layer["source-layer"]&&(Sn.sourceLayer=Sn.layer["source-layer"]),Sn.state=ra})};for(var Jn in Pr)Ln(Jn);return Pr}(this._layers,this._serializedLayers,this.sourceCaches,X,re,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(Ft)},K.prototype.querySourceFeatures=function(X,re){re&&re.filter&&this._validate(e.validateStyle.filter,"querySourceFeatures.filter",re.filter,null,re);var me=this.sourceCaches[X];return me?function(Oe,Be){for(var tt=Oe.getRenderableIds().map(function(sr){return Oe.getTileByID(sr)}),ft=[],St={},Ft=0;Ft<tt.length;Ft++){var Gt=tt[Ft],$t=Gt.tileID.canonical.key;St[$t]||(St[$t]=!0,Gt.querySourceFeatures(ft,Be))}return ft}(me,re):[]},K.prototype.addSourceType=function(X,re,me){return K.getSourceType(X)?me(new Error('A source type called "'+X+'" already exists.')):(K.setSourceType(X,re),re.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:X,url:re.workerSourceURL},me):me(null,null))},K.prototype.getLight=function(){return this.light.getLight()},K.prototype.setLight=function(X,re){re===void 0&&(re={}),this._checkLoaded();var me=this.light.getLight(),Oe=!1;for(var Be in X)if(!e.deepEqual(X[Be],me[Be])){Oe=!0;break}if(Oe){var tt={now:e.browser.now(),transition:e.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(X,re),this.light.updateTransitions(tt)}},K.prototype._validate=function(X,re,me,Oe,Be){return Be===void 0&&(Be={}),(!Be||Be.validate!==!1)&&Qn(this,X.call(e.validateStyle,e.extend({key:re,style:this.serialize(),value:me,styleSpec:e.styleSpec},Oe)))},K.prototype._remove=function(){for(var X in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),e.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[X].setEventedParent(null);for(var re in this.sourceCaches)this.sourceCaches[re].clearTiles(),this.sourceCaches[re].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},K.prototype._clearSource=function(X){this.sourceCaches[X].clearTiles()},K.prototype._reloadSource=function(X){this.sourceCaches[X].resume(),this.sourceCaches[X].reload()},K.prototype._updateSources=function(X){for(var re in this.sourceCaches)this.sourceCaches[re].update(X)},K.prototype._generateCollisionBoxes=function(){for(var X in this.sourceCaches)this._reloadSource(X)},K.prototype._updatePlacement=function(X,re,me,Oe,Be){Be===void 0&&(Be=!1);for(var tt=!1,ft=!1,St={},Ft=0,Gt=this._order;Ft<Gt.length;Ft+=1){var $t=this._layers[Gt[Ft]];if($t.type==="symbol"){if(!St[$t.source]){var sr=this.sourceCaches[$t.source];St[$t.source]=sr.getRenderableIds(!0).map(function(Ar){return sr.getTileByID(Ar)}).sort(function(Ar,Pr){return Pr.tileID.overscaledZ-Ar.tileID.overscaledZ||(Ar.tileID.isLessThan(Pr.tileID)?-1:1)})}var lr=this.crossTileSymbolIndex.addLayer($t,St[$t.source],X.center.lng);tt=tt||lr}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((Be=Be||this._layerOrderChanged||me===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(e.browser.now(),X.zoom))&&(this.pauseablePlacement=new Or(X,this._order,Be,re,me,Oe,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,St),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(e.browser.now()),ft=!0),tt&&this.pauseablePlacement.placement.setStale()),ft||tt)for(var vr=0,ir=this._order;vr<ir.length;vr+=1){var gr=this._layers[ir[vr]];gr.type==="symbol"&&this.placement.updateLayerOpacities(gr,St[gr.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(e.browser.now())},K.prototype._releaseSymbolFadeTiles=function(){for(var X in this.sourceCaches)this.sourceCaches[X].releaseSymbolFadeTiles()},K.prototype.getImages=function(X,re,me){this.imageManager.getImages(re.icons,me),this._updateTilesForChangedImages();var Oe=this.sourceCaches[re.source];Oe&&Oe.setDependencies(re.tileID.key,re.type,re.icons)},K.prototype.getGlyphs=function(X,re,me){this.glyphManager.getGlyphs(re.stacks,me)},K.prototype.getResource=function(X,re,me){return e.makeRequest(re,me)},K}(e.Evented);na.getSourceType=function(Y){return j[Y]},na.setSourceType=function(Y,K){j[Y]=K},na.registerForPluginStateChange=e.registerForPluginStateChange;var ta=e.createLayout([{name:"a_pos",type:"Int16",components:2}]),fn=ma(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`),zn=ma(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Wn=ma(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),Sa=ma(`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),ti=ma("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),yi=ma(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),xo=ma(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),ki=ma("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),ja=ma("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),bo=ma("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),ss=ma(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),Ua=ma(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),hl=ma(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),_o=ma(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),Zo=ma(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),Co=ma(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),ls=ma(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform float u_maxzoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggeration=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/ pow(2.0,(u_zoom-u_maxzoom)*exaggeration+19.2562-u_zoom);gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),Xo=ma(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),Jo=ma(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),cs=ma(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp float v_lineprogress;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,vec2(v_lineprogress,0.5));gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define MAX_LINE_DISTANCE 32767.0
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_lineprogress;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_lineprogress=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0/MAX_LINE_DISTANCE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),wo=ma(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),js=ma(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),pl=ma(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),lo=ma(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`),_s=ma(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),Ko=ma(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`);function ma(Y,K){var X=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,re={};return{fragmentSource:Y=Y.replace(X,function(me,Oe,Be,tt,ft){return re[ft]=!0,Oe==="define"?`
#ifndef HAS_UNIFORM_u_`+ft+`
varying `+Be+" "+tt+" "+ft+`;
#else
uniform `+Be+" "+tt+" u_"+ft+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+ft+`
    `+Be+" "+tt+" "+ft+" = u_"+ft+`;
#endif
`}),vertexSource:K=K.replace(X,function(me,Oe,Be,tt,ft){var St=tt==="float"?"vec2":"vec4",Ft=ft.match(/color/)?"color":St;return re[ft]?Oe==="define"?`
#ifndef HAS_UNIFORM_u_`+ft+`
uniform lowp float u_`+ft+`_t;
attribute `+Be+" "+St+" a_"+ft+`;
varying `+Be+" "+tt+" "+ft+`;
#else
uniform `+Be+" "+tt+" u_"+ft+`;
#endif
`:Ft==="vec4"?`
#ifndef HAS_UNIFORM_u_`+ft+`
    `+ft+" = a_"+ft+`;
#else
    `+Be+" "+tt+" "+ft+" = u_"+ft+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+ft+`
    `+ft+" = unpack_mix_"+Ft+"(a_"+ft+", u_"+ft+`_t);
#else
    `+Be+" "+tt+" "+ft+" = u_"+ft+`;
#endif
`:Oe==="define"?`
#ifndef HAS_UNIFORM_u_`+ft+`
uniform lowp float u_`+ft+`_t;
attribute `+Be+" "+St+" a_"+ft+`;
#else
uniform `+Be+" "+tt+" u_"+ft+`;
#endif
`:Ft==="vec4"?`
#ifndef HAS_UNIFORM_u_`+ft+`
    `+Be+" "+tt+" "+ft+" = a_"+ft+`;
#else
    `+Be+" "+tt+" "+ft+" = u_"+ft+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+ft+`
    `+Be+" "+tt+" "+ft+" = unpack_mix_"+Ft+"(a_"+ft+", u_"+ft+`_t);
#else
    `+Be+" "+tt+" "+ft+" = u_"+ft+`;
#endif
`})}}var us=Object.freeze({__proto__:null,prelude:fn,background:zn,backgroundPattern:Wn,circle:Sa,clippingMask:ti,heatmap:yi,heatmapTexture:xo,collisionBox:ki,collisionCircle:ja,debug:bo,fill:ss,fillOutline:Ua,fillOutlinePattern:hl,fillPattern:_o,fillExtrusion:Zo,fillExtrusionPattern:Co,hillshadePrepare:ls,hillshade:Xo,line:Jo,lineGradient:cs,linePattern:wo,lineSDF:js,raster:pl,symbolIcon:lo,symbolSDF:_s,symbolTextAndIcon:Ko}),$i=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};$i.prototype.bind=function(Y,K,X,re,me,Oe,Be,tt){this.context=Y;for(var ft=this.boundPaintVertexBuffers.length!==re.length,St=0;!ft&&St<re.length;St++)this.boundPaintVertexBuffers[St]!==re[St]&&(ft=!0);Y.extVertexArrayObject&&this.vao&&this.boundProgram===K&&this.boundLayoutVertexBuffer===X&&!ft&&this.boundIndexBuffer===me&&this.boundVertexOffset===Oe&&this.boundDynamicVertexBuffer===Be&&this.boundDynamicVertexBuffer2===tt?(Y.bindVertexArrayOES.set(this.vao),Be&&Be.bind(),me&&me.dynamicDraw&&me.bind(),tt&&tt.bind()):this.freshBind(K,X,re,me,Oe,Be,tt)},$i.prototype.freshBind=function(Y,K,X,re,me,Oe,Be){var tt,ft=Y.numAttributes,St=this.context,Ft=St.gl;if(St.extVertexArrayObject)this.vao&&this.destroy(),this.vao=St.extVertexArrayObject.createVertexArrayOES(),St.bindVertexArrayOES.set(this.vao),tt=0,this.boundProgram=Y,this.boundLayoutVertexBuffer=K,this.boundPaintVertexBuffers=X,this.boundIndexBuffer=re,this.boundVertexOffset=me,this.boundDynamicVertexBuffer=Oe,this.boundDynamicVertexBuffer2=Be;else{tt=St.currentNumAttributes||0;for(var Gt=ft;Gt<tt;Gt++)Ft.disableVertexAttribArray(Gt)}K.enableAttributes(Ft,Y);for(var $t=0,sr=X;$t<sr.length;$t+=1)sr[$t].enableAttributes(Ft,Y);Oe&&Oe.enableAttributes(Ft,Y),Be&&Be.enableAttributes(Ft,Y),K.bind(),K.setVertexAttribPointers(Ft,Y,me);for(var lr=0,vr=X;lr<vr.length;lr+=1){var ir=vr[lr];ir.bind(),ir.setVertexAttribPointers(Ft,Y,me)}Oe&&(Oe.bind(),Oe.setVertexAttribPointers(Ft,Y,me)),re&&re.bind(),Be&&(Be.bind(),Be.setVertexAttribPointers(Ft,Y,me)),St.currentNumAttributes=ft},$i.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var ws=function(Y,K,X,re,me){var Oe=Y.gl;this.program=Oe.createProgram();var Be=X?X.defines():[];me&&Be.push("#define OVERDRAW_INSPECTOR;");var tt=Be.concat(fn.fragmentSource,K.fragmentSource).join(`
`),ft=Be.concat(fn.vertexSource,K.vertexSource).join(`
`),St=Oe.createShader(Oe.FRAGMENT_SHADER);if(Oe.isContextLost())this.failedToCreate=!0;else{Oe.shaderSource(St,tt),Oe.compileShader(St),Oe.attachShader(this.program,St);var Ft=Oe.createShader(Oe.VERTEX_SHADER);if(Oe.isContextLost())this.failedToCreate=!0;else{Oe.shaderSource(Ft,ft),Oe.compileShader(Ft),Oe.attachShader(this.program,Ft);for(var Gt=X?X.layoutAttributes:[],$t=0;$t<Gt.length;$t++)Oe.bindAttribLocation(this.program,$t,Gt[$t].name);Oe.linkProgram(this.program),Oe.deleteShader(Ft),Oe.deleteShader(St),this.numAttributes=Oe.getProgramParameter(this.program,Oe.ACTIVE_ATTRIBUTES),this.attributes={};for(var sr={},lr=0;lr<this.numAttributes;lr++){var vr=Oe.getActiveAttrib(this.program,lr);vr&&(this.attributes[vr.name]=Oe.getAttribLocation(this.program,vr.name))}for(var ir=Oe.getProgramParameter(this.program,Oe.ACTIVE_UNIFORMS),gr=0;gr<ir;gr++){var Ar=Oe.getActiveUniform(this.program,gr);Ar&&(sr[Ar.name]=Oe.getUniformLocation(this.program,Ar.name))}this.fixedUniforms=re(Y,sr),this.binderUniforms=X?X.getUniforms(Y,sr):[]}}};function eo(Y,K,X){var re=1/Nr(X,1,K.transform.tileZoom),me=Math.pow(2,X.tileID.overscaledZ),Oe=X.tileSize*Math.pow(2,K.transform.tileZoom)/me,Be=Oe*(X.tileID.canonical.x+X.tileID.wrap*me),tt=Oe*X.tileID.canonical.y;return{u_image:0,u_texsize:X.imageAtlasTexture.size,u_scale:[re,Y.fromScale,Y.toScale],u_fade:Y.t,u_pixel_coord_upper:[Be>>16,tt>>16],u_pixel_coord_lower:[65535&Be,65535&tt]}}ws.prototype.draw=function(Y,K,X,re,me,Oe,Be,tt,ft,St,Ft,Gt,$t,sr,lr,vr){var ir,gr=Y.gl;if(!this.failedToCreate){for(var Ar in Y.program.set(this.program),Y.setDepthMode(X),Y.setStencilMode(re),Y.setColorMode(me),Y.setCullFace(Oe),this.fixedUniforms)this.fixedUniforms[Ar].set(Be[Ar]);sr&&sr.setUniforms(Y,this.binderUniforms,Gt,{zoom:$t});for(var Pr=(ir={},ir[gr.LINES]=2,ir[gr.TRIANGLES]=3,ir[gr.LINE_STRIP]=1,ir)[K],Gr=0,Fr=Ft.get();Gr<Fr.length;Gr+=1){var Yr=Fr[Gr],an=Yr.vaos||(Yr.vaos={});(an[tt]||(an[tt]=new $i)).bind(Y,this,ft,sr?sr.getPaintVertexBuffers():[],St,Yr.vertexOffset,lr,vr),gr.drawElements(K,Yr.primitiveLength*Pr,gr.UNSIGNED_SHORT,Yr.primitiveOffset*Pr*2)}}};var Ri=function(Y,K,X,re){var me=K.style.light,Oe=me.properties.get("position"),Be=[Oe.x,Oe.y,Oe.z],tt=e.create$1();me.properties.get("anchor")==="viewport"&&e.fromRotation(tt,-K.transform.angle),e.transformMat3(Be,Be,tt);var ft=me.properties.get("color");return{u_matrix:Y,u_lightpos:Be,u_lightintensity:me.properties.get("intensity"),u_lightcolor:[ft.r,ft.g,ft.b],u_vertical_gradient:+X,u_opacity:re}},co=function(Y,K,X,re,me,Oe,Be){return e.extend(Ri(Y,K,X,re),eo(Oe,K,Be),{u_height_factor:-Math.pow(2,me.overscaledZ)/Be.tileSize/8})},Fi=function(Y){return{u_matrix:Y}},oc=function(Y,K,X,re){return e.extend(Fi(Y),eo(X,K,re))},Qo=function(Y,K){return{u_matrix:Y,u_world:K}},Lo=function(Y,K,X,re,me){return e.extend(oc(Y,K,X,re),{u_world:me})},Ts=function(Y,K,X,re){var me,Oe,Be=Y.transform;if(re.paint.get("circle-pitch-alignment")==="map"){var tt=Nr(X,1,Be.zoom);me=!0,Oe=[tt,tt]}else me=!1,Oe=Be.pixelsToGLUnits;return{u_camera_to_center_distance:Be.cameraToCenterDistance,u_scale_with_map:+(re.paint.get("circle-pitch-scale")==="map"),u_matrix:Y.translatePosMatrix(K.posMatrix,X,re.paint.get("circle-translate"),re.paint.get("circle-translate-anchor")),u_pitch_with_map:+me,u_device_pixel_ratio:e.browser.devicePixelRatio,u_extrude_scale:Oe}},fs=function(Y,K,X){var re=Nr(X,1,K.zoom),me=Math.pow(2,K.zoom-X.tileID.overscaledZ),Oe=X.tileID.overscaleFactor();return{u_matrix:Y,u_camera_to_center_distance:K.cameraToCenterDistance,u_pixels_to_tile_units:re,u_extrude_scale:[K.pixelsToGLUnits[0]/(re*me),K.pixelsToGLUnits[1]/(re*me)],u_overscale_factor:Oe}},$o=function(Y,K,X){return{u_matrix:Y,u_inv_matrix:K,u_camera_to_center_distance:X.cameraToCenterDistance,u_viewport_size:[X.width,X.height]}},Us=function(Y,K,X){return X===void 0&&(X=1),{u_matrix:Y,u_color:K,u_overlay:0,u_overlay_scale:X}},ks=function(Y){return{u_matrix:Y}},va=function(Y,K,X,re){return{u_matrix:Y,u_extrude_scale:Nr(K,1,X),u_intensity:re}},Li=function(Y,K,X){var re=Y.transform;return{u_matrix:cc(Y,K,X),u_ratio:1/Nr(K,1,re.zoom),u_device_pixel_ratio:e.browser.devicePixelRatio,u_units_to_pixels:[1/re.pixelsToGLUnits[0],1/re.pixelsToGLUnits[1]]}},sc=function(Y,K,X){return e.extend(Li(Y,K,X),{u_image:0})},es=function(Y,K,X,re){var me=Y.transform,Oe=lc(K,me);return{u_matrix:cc(Y,K,X),u_texsize:K.imageAtlasTexture.size,u_ratio:1/Nr(K,1,me.zoom),u_device_pixel_ratio:e.browser.devicePixelRatio,u_image:0,u_scale:[Oe,re.fromScale,re.toScale],u_fade:re.t,u_units_to_pixels:[1/me.pixelsToGLUnits[0],1/me.pixelsToGLUnits[1]]}},Ic=function(Y,K,X,re,me){var Oe=Y.lineAtlas,Be=lc(K,Y.transform),tt=X.layout.get("line-cap")==="round",ft=Oe.getDash(re.from,tt),St=Oe.getDash(re.to,tt),Ft=ft.width*me.fromScale,Gt=St.width*me.toScale;return e.extend(Li(Y,K,X),{u_patternscale_a:[Be/Ft,-ft.height/2],u_patternscale_b:[Be/Gt,-St.height/2],u_sdfgamma:Oe.width/(256*Math.min(Ft,Gt)*e.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:ft.y,u_tex_y_b:St.y,u_mix:me.t})};function lc(Y,K){return 1/Nr(Y,1,K.tileZoom)}function cc(Y,K,X){return Y.translatePosMatrix(K.tileID.posMatrix,K,X.paint.get("line-translate"),X.paint.get("line-translate-anchor"))}var Oc=function(Y,K,X,re,me){return{u_matrix:Y,u_tl_parent:K,u_scale_parent:X,u_buffer_scale:1,u_fade_t:re.mix,u_opacity:re.opacity*me.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:me.paint.get("raster-brightness-min"),u_brightness_high:me.paint.get("raster-brightness-max"),u_saturation_factor:(Be=me.paint.get("raster-saturation"),Be>0?1-1/(1.001-Be):-Be),u_contrast_factor:(Oe=me.paint.get("raster-contrast"),Oe>0?1/(1-Oe):1+Oe),u_spin_weights:ts(me.paint.get("raster-hue-rotate"))};var Oe,Be};function ts(Y){Y*=Math.PI/180;var K=Math.sin(Y),X=Math.cos(Y);return[(2*X+1)/3,(-Math.sqrt(3)*K-X+1)/3,(Math.sqrt(3)*K-X+1)/3]}var hs,Vs=function(Y,K,X,re,me,Oe,Be,tt,ft,St){var Ft=me.transform;return{u_is_size_zoom_constant:+(Y==="constant"||Y==="source"),u_is_size_feature_constant:+(Y==="constant"||Y==="camera"),u_size_t:K?K.uSizeT:0,u_size:K?K.uSize:0,u_camera_to_center_distance:Ft.cameraToCenterDistance,u_pitch:Ft.pitch/360*2*Math.PI,u_rotate_symbol:+X,u_aspect_ratio:Ft.width/Ft.height,u_fade_change:me.options.fadeDuration?me.symbolFadeChange:1,u_matrix:Oe,u_label_plane_matrix:Be,u_coord_matrix:tt,u_is_text:+ft,u_pitch_with_map:+re,u_texsize:St,u_texture:0}},rs=function(Y,K,X,re,me,Oe,Be,tt,ft,St,Ft){var Gt=me.transform;return e.extend(Vs(Y,K,X,re,me,Oe,Be,tt,ft,St),{u_gamma_scale:re?Math.cos(Gt._pitch)*Gt.cameraToCenterDistance:1,u_device_pixel_ratio:e.browser.devicePixelRatio,u_is_halo:+Ft})},Ms=function(Y,K,X,re,me,Oe,Be,tt,ft,St){return e.extend(rs(Y,K,X,re,me,Oe,Be,tt,!0,ft,!0),{u_texsize_icon:St,u_texture_icon:1})},zc=function(Y,K,X){return{u_matrix:Y,u_opacity:K,u_color:X}},qs=function(Y,K,X,re,me,Oe){return e.extend(function(Be,tt,ft,St){var Ft=ft.imageManager.getPattern(Be.from.toString()),Gt=ft.imageManager.getPattern(Be.to.toString()),$t=ft.imageManager.getPixelSize(),sr=$t.width,lr=$t.height,vr=Math.pow(2,St.tileID.overscaledZ),ir=St.tileSize*Math.pow(2,ft.transform.tileZoom)/vr,gr=ir*(St.tileID.canonical.x+St.tileID.wrap*vr),Ar=ir*St.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:Ft.tl,u_pattern_br_a:Ft.br,u_pattern_tl_b:Gt.tl,u_pattern_br_b:Gt.br,u_texsize:[sr,lr],u_mix:tt.t,u_pattern_size_a:Ft.displaySize,u_pattern_size_b:Gt.displaySize,u_scale_a:tt.fromScale,u_scale_b:tt.toScale,u_tile_units_to_pixels:1/Nr(St,1,ft.transform.tileZoom),u_pixel_coord_upper:[gr>>16,Ar>>16],u_pixel_coord_lower:[65535&gr,65535&Ar]}}(re,Oe,X,me),{u_matrix:Y,u_opacity:K})},To={fillExtrusion:function(Y,K){return{u_matrix:new e.UniformMatrix4f(Y,K.u_matrix),u_lightpos:new e.Uniform3f(Y,K.u_lightpos),u_lightintensity:new e.Uniform1f(Y,K.u_lightintensity),u_lightcolor:new e.Uniform3f(Y,K.u_lightcolor),u_vertical_gradient:new e.Uniform1f(Y,K.u_vertical_gradient),u_opacity:new e.Uniform1f(Y,K.u_opacity)}},fillExtrusionPattern:function(Y,K){return{u_matrix:new e.UniformMatrix4f(Y,K.u_matrix),u_lightpos:new e.Uniform3f(Y,K.u_lightpos),u_lightintensity:new e.Uniform1f(Y,K.u_lightintensity),u_lightcolor:new e.Uniform3f(Y,K.u_lightcolor),u_vertical_gradient:new e.Uniform1f(Y,K.u_vertical_gradient),u_height_factor:new e.Uniform1f(Y,K.u_height_factor),u_image:new e.Uniform1i(Y,K.u_image),u_texsize:new e.Uniform2f(Y,K.u_texsize),u_pixel_coord_upper:new e.Uniform2f(Y,K.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(Y,K.u_pixel_coord_lower),u_scale:new e.Uniform3f(Y,K.u_scale),u_fade:new e.Uniform1f(Y,K.u_fade),u_opacity:new e.Uniform1f(Y,K.u_opacity)}},fill:function(Y,K){return{u_matrix:new e.UniformMatrix4f(Y,K.u_matrix)}},fillPattern:function(Y,K){return{u_matrix:new e.UniformMatrix4f(Y,K.u_matrix),u_image:new e.Uniform1i(Y,K.u_image),u_texsize:new e.Uniform2f(Y,K.u_texsize),u_pixel_coord_upper:new e.Uniform2f(Y,K.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(Y,K.u_pixel_coord_lower),u_scale:new e.Uniform3f(Y,K.u_scale),u_fade:new e.Uniform1f(Y,K.u_fade)}},fillOutline:function(Y,K){return{u_matrix:new e.UniformMatrix4f(Y,K.u_matrix),u_world:new e.Uniform2f(Y,K.u_world)}},fillOutlinePattern:function(Y,K){return{u_matrix:new e.UniformMatrix4f(Y,K.u_matrix),u_world:new e.Uniform2f(Y,K.u_world),u_image:new e.Uniform1i(Y,K.u_image),u_texsize:new e.Uniform2f(Y,K.u_texsize),u_pixel_coord_upper:new e.Uniform2f(Y,K.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(Y,K.u_pixel_coord_lower),u_scale:new e.Uniform3f(Y,K.u_scale),u_fade:new e.Uniform1f(Y,K.u_fade)}},circle:function(Y,K){return{u_camera_to_center_distance:new e.Uniform1f(Y,K.u_camera_to_center_distance),u_scale_with_map:new e.Uniform1i(Y,K.u_scale_with_map),u_pitch_with_map:new e.Uniform1i(Y,K.u_pitch_with_map),u_extrude_scale:new e.Uniform2f(Y,K.u_extrude_scale),u_device_pixel_ratio:new e.Uniform1f(Y,K.u_device_pixel_ratio),u_matrix:new e.UniformMatrix4f(Y,K.u_matrix)}},collisionBox:function(Y,K){return{u_matrix:new e.UniformMatrix4f(Y,K.u_matrix),u_camera_to_center_distance:new e.Uniform1f(Y,K.u_camera_to_center_distance),u_pixels_to_tile_units:new e.Uniform1f(Y,K.u_pixels_to_tile_units),u_extrude_scale:new e.Uniform2f(Y,K.u_extrude_scale),u_overscale_factor:new e.Uniform1f(Y,K.u_overscale_factor)}},collisionCircle:function(Y,K){return{u_matrix:new e.UniformMatrix4f(Y,K.u_matrix),u_inv_matrix:new e.UniformMatrix4f(Y,K.u_inv_matrix),u_camera_to_center_distance:new e.Uniform1f(Y,K.u_camera_to_center_distance),u_viewport_size:new e.Uniform2f(Y,K.u_viewport_size)}},debug:function(Y,K){return{u_color:new e.UniformColor(Y,K.u_color),u_matrix:new e.UniformMatrix4f(Y,K.u_matrix),u_overlay:new e.Uniform1i(Y,K.u_overlay),u_overlay_scale:new e.Uniform1f(Y,K.u_overlay_scale)}},clippingMask:function(Y,K){return{u_matrix:new e.UniformMatrix4f(Y,K.u_matrix)}},heatmap:function(Y,K){return{u_extrude_scale:new e.Uniform1f(Y,K.u_extrude_scale),u_intensity:new e.Uniform1f(Y,K.u_intensity),u_matrix:new e.UniformMatrix4f(Y,K.u_matrix)}},heatmapTexture:function(Y,K){return{u_matrix:new e.UniformMatrix4f(Y,K.u_matrix),u_world:new e.Uniform2f(Y,K.u_world),u_image:new e.Uniform1i(Y,K.u_image),u_color_ramp:new e.Uniform1i(Y,K.u_color_ramp),u_opacity:new e.Uniform1f(Y,K.u_opacity)}},hillshade:function(Y,K){return{u_matrix:new e.UniformMatrix4f(Y,K.u_matrix),u_image:new e.Uniform1i(Y,K.u_image),u_latrange:new e.Uniform2f(Y,K.u_latrange),u_light:new e.Uniform2f(Y,K.u_light),u_shadow:new e.UniformColor(Y,K.u_shadow),u_highlight:new e.UniformColor(Y,K.u_highlight),u_accent:new e.UniformColor(Y,K.u_accent)}},hillshadePrepare:function(Y,K){return{u_matrix:new e.UniformMatrix4f(Y,K.u_matrix),u_image:new e.Uniform1i(Y,K.u_image),u_dimension:new e.Uniform2f(Y,K.u_dimension),u_zoom:new e.Uniform1f(Y,K.u_zoom),u_maxzoom:new e.Uniform1f(Y,K.u_maxzoom),u_unpack:new e.Uniform4f(Y,K.u_unpack)}},line:function(Y,K){return{u_matrix:new e.UniformMatrix4f(Y,K.u_matrix),u_ratio:new e.Uniform1f(Y,K.u_ratio),u_device_pixel_ratio:new e.Uniform1f(Y,K.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(Y,K.u_units_to_pixels)}},lineGradient:function(Y,K){return{u_matrix:new e.UniformMatrix4f(Y,K.u_matrix),u_ratio:new e.Uniform1f(Y,K.u_ratio),u_device_pixel_ratio:new e.Uniform1f(Y,K.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(Y,K.u_units_to_pixels),u_image:new e.Uniform1i(Y,K.u_image)}},linePattern:function(Y,K){return{u_matrix:new e.UniformMatrix4f(Y,K.u_matrix),u_texsize:new e.Uniform2f(Y,K.u_texsize),u_ratio:new e.Uniform1f(Y,K.u_ratio),u_device_pixel_ratio:new e.Uniform1f(Y,K.u_device_pixel_ratio),u_image:new e.Uniform1i(Y,K.u_image),u_units_to_pixels:new e.Uniform2f(Y,K.u_units_to_pixels),u_scale:new e.Uniform3f(Y,K.u_scale),u_fade:new e.Uniform1f(Y,K.u_fade)}},lineSDF:function(Y,K){return{u_matrix:new e.UniformMatrix4f(Y,K.u_matrix),u_ratio:new e.Uniform1f(Y,K.u_ratio),u_device_pixel_ratio:new e.Uniform1f(Y,K.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(Y,K.u_units_to_pixels),u_patternscale_a:new e.Uniform2f(Y,K.u_patternscale_a),u_patternscale_b:new e.Uniform2f(Y,K.u_patternscale_b),u_sdfgamma:new e.Uniform1f(Y,K.u_sdfgamma),u_image:new e.Uniform1i(Y,K.u_image),u_tex_y_a:new e.Uniform1f(Y,K.u_tex_y_a),u_tex_y_b:new e.Uniform1f(Y,K.u_tex_y_b),u_mix:new e.Uniform1f(Y,K.u_mix)}},raster:function(Y,K){return{u_matrix:new e.UniformMatrix4f(Y,K.u_matrix),u_tl_parent:new e.Uniform2f(Y,K.u_tl_parent),u_scale_parent:new e.Uniform1f(Y,K.u_scale_parent),u_buffer_scale:new e.Uniform1f(Y,K.u_buffer_scale),u_fade_t:new e.Uniform1f(Y,K.u_fade_t),u_opacity:new e.Uniform1f(Y,K.u_opacity),u_image0:new e.Uniform1i(Y,K.u_image0),u_image1:new e.Uniform1i(Y,K.u_image1),u_brightness_low:new e.Uniform1f(Y,K.u_brightness_low),u_brightness_high:new e.Uniform1f(Y,K.u_brightness_high),u_saturation_factor:new e.Uniform1f(Y,K.u_saturation_factor),u_contrast_factor:new e.Uniform1f(Y,K.u_contrast_factor),u_spin_weights:new e.Uniform3f(Y,K.u_spin_weights)}},symbolIcon:function(Y,K){return{u_is_size_zoom_constant:new e.Uniform1i(Y,K.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(Y,K.u_is_size_feature_constant),u_size_t:new e.Uniform1f(Y,K.u_size_t),u_size:new e.Uniform1f(Y,K.u_size),u_camera_to_center_distance:new e.Uniform1f(Y,K.u_camera_to_center_distance),u_pitch:new e.Uniform1f(Y,K.u_pitch),u_rotate_symbol:new e.Uniform1i(Y,K.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(Y,K.u_aspect_ratio),u_fade_change:new e.Uniform1f(Y,K.u_fade_change),u_matrix:new e.UniformMatrix4f(Y,K.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(Y,K.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(Y,K.u_coord_matrix),u_is_text:new e.Uniform1i(Y,K.u_is_text),u_pitch_with_map:new e.Uniform1i(Y,K.u_pitch_with_map),u_texsize:new e.Uniform2f(Y,K.u_texsize),u_texture:new e.Uniform1i(Y,K.u_texture)}},symbolSDF:function(Y,K){return{u_is_size_zoom_constant:new e.Uniform1i(Y,K.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(Y,K.u_is_size_feature_constant),u_size_t:new e.Uniform1f(Y,K.u_size_t),u_size:new e.Uniform1f(Y,K.u_size),u_camera_to_center_distance:new e.Uniform1f(Y,K.u_camera_to_center_distance),u_pitch:new e.Uniform1f(Y,K.u_pitch),u_rotate_symbol:new e.Uniform1i(Y,K.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(Y,K.u_aspect_ratio),u_fade_change:new e.Uniform1f(Y,K.u_fade_change),u_matrix:new e.UniformMatrix4f(Y,K.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(Y,K.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(Y,K.u_coord_matrix),u_is_text:new e.Uniform1i(Y,K.u_is_text),u_pitch_with_map:new e.Uniform1i(Y,K.u_pitch_with_map),u_texsize:new e.Uniform2f(Y,K.u_texsize),u_texture:new e.Uniform1i(Y,K.u_texture),u_gamma_scale:new e.Uniform1f(Y,K.u_gamma_scale),u_device_pixel_ratio:new e.Uniform1f(Y,K.u_device_pixel_ratio),u_is_halo:new e.Uniform1i(Y,K.u_is_halo)}},symbolTextAndIcon:function(Y,K){return{u_is_size_zoom_constant:new e.Uniform1i(Y,K.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(Y,K.u_is_size_feature_constant),u_size_t:new e.Uniform1f(Y,K.u_size_t),u_size:new e.Uniform1f(Y,K.u_size),u_camera_to_center_distance:new e.Uniform1f(Y,K.u_camera_to_center_distance),u_pitch:new e.Uniform1f(Y,K.u_pitch),u_rotate_symbol:new e.Uniform1i(Y,K.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(Y,K.u_aspect_ratio),u_fade_change:new e.Uniform1f(Y,K.u_fade_change),u_matrix:new e.UniformMatrix4f(Y,K.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(Y,K.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(Y,K.u_coord_matrix),u_is_text:new e.Uniform1i(Y,K.u_is_text),u_pitch_with_map:new e.Uniform1i(Y,K.u_pitch_with_map),u_texsize:new e.Uniform2f(Y,K.u_texsize),u_texsize_icon:new e.Uniform2f(Y,K.u_texsize_icon),u_texture:new e.Uniform1i(Y,K.u_texture),u_texture_icon:new e.Uniform1i(Y,K.u_texture_icon),u_gamma_scale:new e.Uniform1f(Y,K.u_gamma_scale),u_device_pixel_ratio:new e.Uniform1f(Y,K.u_device_pixel_ratio),u_is_halo:new e.Uniform1i(Y,K.u_is_halo)}},background:function(Y,K){return{u_matrix:new e.UniformMatrix4f(Y,K.u_matrix),u_opacity:new e.Uniform1f(Y,K.u_opacity),u_color:new e.UniformColor(Y,K.u_color)}},backgroundPattern:function(Y,K){return{u_matrix:new e.UniformMatrix4f(Y,K.u_matrix),u_opacity:new e.Uniform1f(Y,K.u_opacity),u_image:new e.Uniform1i(Y,K.u_image),u_pattern_tl_a:new e.Uniform2f(Y,K.u_pattern_tl_a),u_pattern_br_a:new e.Uniform2f(Y,K.u_pattern_br_a),u_pattern_tl_b:new e.Uniform2f(Y,K.u_pattern_tl_b),u_pattern_br_b:new e.Uniform2f(Y,K.u_pattern_br_b),u_texsize:new e.Uniform2f(Y,K.u_texsize),u_mix:new e.Uniform1f(Y,K.u_mix),u_pattern_size_a:new e.Uniform2f(Y,K.u_pattern_size_a),u_pattern_size_b:new e.Uniform2f(Y,K.u_pattern_size_b),u_scale_a:new e.Uniform1f(Y,K.u_scale_a),u_scale_b:new e.Uniform1f(Y,K.u_scale_b),u_pixel_coord_upper:new e.Uniform2f(Y,K.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(Y,K.u_pixel_coord_lower),u_tile_units_to_pixels:new e.Uniform1f(Y,K.u_tile_units_to_pixels)}}};function Fl(Y,K,X,re,me,Oe,Be){for(var tt=Y.context,ft=tt.gl,St=Y.useProgram("collisionBox"),Ft=[],Gt=0,$t=0,sr=0;sr<re.length;sr++){var lr=re[sr],vr=K.getTile(lr),ir=vr.getBucket(X);if(ir){var gr=lr.posMatrix;me[0]===0&&me[1]===0||(gr=Y.translatePosMatrix(lr.posMatrix,vr,me,Oe));var Ar=Be?ir.textCollisionBox:ir.iconCollisionBox,Pr=ir.collisionCircleArray;if(Pr.length>0){var Gr=e.create(),Fr=gr;e.mul(Gr,ir.placementInvProjMatrix,Y.transform.glCoordMatrix),e.mul(Gr,Gr,ir.placementViewportMatrix),Ft.push({circleArray:Pr,circleOffset:$t,transform:Fr,invTransform:Gr}),$t=Gt+=Pr.length/4}Ar&&St.draw(tt,ft.LINES,xe.disabled,Ee.disabled,Y.colorModeForRenderPass(),it.disabled,fs(gr,Y.transform,vr),X.id,Ar.layoutVertexBuffer,Ar.indexBuffer,Ar.segments,null,Y.transform.zoom,null,null,Ar.collisionVertexBuffer)}}if(Be&&Ft.length){var Yr=Y.useProgram("collisionCircle"),an=new e.StructArrayLayout2f1f2i16;an.resize(4*Gt),an._trim();for(var mn=0,pn=0,xn=Ft;pn<xn.length;pn+=1)for(var Ln=xn[pn],Jn=0;Jn<Ln.circleArray.length/4;Jn++){var Vn=4*Jn,oa=Ln.circleArray[Vn+0],Sn=Ln.circleArray[Vn+1],ra=Ln.circleArray[Vn+2],sa=Ln.circleArray[Vn+3];an.emplace(mn++,oa,Sn,ra,sa,0),an.emplace(mn++,oa,Sn,ra,sa,1),an.emplace(mn++,oa,Sn,ra,sa,2),an.emplace(mn++,oa,Sn,ra,sa,3)}(!hs||hs.length<2*Gt)&&(hs=function(Fa){var Ha=2*Fa,ba=new e.StructArrayLayout3ui6;ba.resize(Ha),ba._trim();for(var Ga=0;Ga<Ha;Ga++){var Ea=6*Ga;ba.uint16[Ea+0]=4*Ga+0,ba.uint16[Ea+1]=4*Ga+1,ba.uint16[Ea+2]=4*Ga+2,ba.uint16[Ea+3]=4*Ga+2,ba.uint16[Ea+4]=4*Ga+3,ba.uint16[Ea+5]=4*Ga+0}return ba}(Gt));for(var Hn=tt.createIndexBuffer(hs,!0),Gn=tt.createVertexBuffer(an,e.collisionCircleLayout.members,!0),$n=0,Zn=Ft;$n<Zn.length;$n+=1){var qn=Zn[$n],fi=$o(qn.transform,qn.invTransform,Y.transform);Yr.draw(tt,ft.TRIANGLES,xe.disabled,Ee.disabled,Y.colorModeForRenderPass(),it.disabled,fi,X.id,Gn,Hn,e.SegmentVector.simpleSegment(0,2*qn.circleOffset,qn.circleArray.length,qn.circleArray.length/2),null,Y.transform.zoom,null,null,null)}Gn.destroy(),Hn.destroy()}}var Dc=e.identity(new Float32Array(16));function uc(Y,K,X,re,me,Oe){var Be=e.getAnchorAlignment(Y),tt=-(Be.horizontalAlign-.5)*K,ft=-(Be.verticalAlign-.5)*X,St=e.evaluateVariableOffset(Y,re);return new e.Point((tt/me+St[0])*Oe,(ft/me+St[1])*Oe)}function As(Y,K,X,re,me,Oe,Be,tt,ft,St,Ft){var Gt=Y.text.placedSymbolArray,$t=Y.text.dynamicLayoutVertexArray,sr=Y.icon.dynamicLayoutVertexArray,lr={};$t.clear();for(var vr=0;vr<Gt.length;vr++){var ir=Gt.get(vr),gr=ir.hidden||!ir.crossTileID||Y.allowVerticalPlacement&&!ir.placedOrientation?null:re[ir.crossTileID];if(gr){var Ar=new e.Point(ir.anchorX,ir.anchorY),Pr=Dt(Ar,X?tt:Be),Gr=Ut(Oe.cameraToCenterDistance,Pr.signedDistanceFromCamera),Fr=me.evaluateSizeForFeature(Y.textSizeData,St,ir)*Gr/e.ONE_EM;X&&(Fr*=Y.tilePixelRatio/ft);for(var Yr=uc(gr.anchor,gr.width,gr.height,gr.textOffset,gr.textBoxScale,Fr),an=X?Dt(Ar.add(Yr),Be).point:Pr.point.add(K?Yr.rotate(-Oe.angle):Yr),mn=Y.allowVerticalPlacement&&ir.placedOrientation===e.WritingMode.vertical?Math.PI/2:0,pn=0;pn<ir.numGlyphs;pn++)e.addDynamicAttributes($t,an,mn);Ft&&ir.associatedIconIndex>=0&&(lr[ir.associatedIconIndex]={shiftedAnchor:an,angle:mn})}else Qr(ir.numGlyphs,$t)}if(Ft){sr.clear();for(var xn=Y.icon.placedSymbolArray,Ln=0;Ln<xn.length;Ln++){var Jn=xn.get(Ln);if(Jn.hidden)Qr(Jn.numGlyphs,sr);else{var Vn=lr[Ln];if(Vn)for(var oa=0;oa<Jn.numGlyphs;oa++)e.addDynamicAttributes(sr,Vn.shiftedAnchor,Vn.angle);else Qr(Jn.numGlyphs,sr)}}Y.icon.dynamicLayoutVertexBuffer.updateData(sr)}Y.text.dynamicLayoutVertexBuffer.updateData($t)}function Hs(Y,K,X){return X.iconsInText&&K?"symbolTextAndIcon":Y?"symbolSDF":"symbolIcon"}function dl(Y,K,X,re,me,Oe,Be,tt,ft,St,Ft,Gt){for(var $t=Y.context,sr=$t.gl,lr=Y.transform,vr=tt==="map",ir=ft==="map",gr=vr&&X.layout.get("symbol-placement")!=="point",Ar=vr&&!ir&&!gr,Pr=X.layout.get("symbol-sort-key").constantOr(1)!==void 0,Gr=Y.depthModeForSublayer(0,xe.ReadOnly),Fr=X.layout.get("text-variable-anchor"),Yr=[],an=0,mn=re;an<mn.length;an+=1){var pn=mn[an],xn=K.getTile(pn),Ln=xn.getBucket(X);if(Ln){var Jn=me?Ln.text:Ln.icon;if(Jn&&Jn.segments.get().length){var Vn=Jn.programConfigurations.get(X.id),oa=me||Ln.sdfIcons,Sn=me?Ln.textSizeData:Ln.iconSizeData,ra=ir||lr.pitch!==0,sa=Y.useProgram(Hs(oa,me,Ln),Vn),Hn=e.evaluateSizeForZoom(Sn,lr.zoom),Gn=void 0,$n=[0,0],Zn=void 0,qn=void 0,fi=null,Fa=void 0;if(me)Zn=xn.glyphAtlasTexture,qn=sr.LINEAR,Gn=xn.glyphAtlasTexture.size,Ln.iconsInText&&($n=xn.imageAtlasTexture.size,fi=xn.imageAtlasTexture,Fa=ra||Y.options.rotating||Y.options.zooming||Sn.kind==="composite"||Sn.kind==="camera"?sr.LINEAR:sr.NEAREST);else{var Ha=X.layout.get("icon-size").constantOr(0)!==1||Ln.iconsNeedLinear;Zn=xn.imageAtlasTexture,qn=oa||Y.options.rotating||Y.options.zooming||Ha||ra?sr.LINEAR:sr.NEAREST,Gn=xn.imageAtlasTexture.size}var ba=Nr(xn,1,Y.transform.zoom),Ga=Qt(pn.posMatrix,ir,vr,Y.transform,ba),Ea=cr(pn.posMatrix,ir,vr,Y.transform,ba),Ao=Fr&&Ln.hasTextData(),Os=X.layout.get("icon-text-fit")!=="none"&&Ao&&Ln.hasIconData();gr&&Sr(Ln,pn.posMatrix,Y,me,Ga,Ea,ir,St);var go=Y.translatePosMatrix(pn.posMatrix,xn,Oe,Be),Si=gr||me&&Fr||Os?Dc:Ga,mo=Y.translatePosMatrix(Ea,xn,Oe,Be,!0),Do=oa&&X.paint.get(me?"text-halo-width":"icon-halo-width").constantOr(1)!==0,tl={program:sa,buffers:Jn,uniformValues:oa?Ln.iconsInText?Ms(Sn.kind,Hn,Ar,ir,Y,go,Si,mo,Gn,$n):rs(Sn.kind,Hn,Ar,ir,Y,go,Si,mo,me,Gn,!0):Vs(Sn.kind,Hn,Ar,ir,Y,go,Si,mo,me,Gn),atlasTexture:Zn,atlasTextureIcon:fi,atlasInterpolation:qn,atlasInterpolationIcon:Fa,isSDF:oa,hasHalo:Do};if(Pr)for(var ms=0,zs=Jn.segments.get();ms<zs.length;ms+=1){var Ro=zs[ms];Yr.push({segments:new e.SegmentVector([Ro]),sortKey:Ro.sortKey,state:tl})}else Yr.push({segments:Jn.segments,sortKey:0,state:tl})}}}Pr&&Yr.sort(function(Zl,Ja){return Zl.sortKey-Ja.sortKey});for(var Tl=0,Fo=Yr;Tl<Fo.length;Tl+=1){var Bo=Fo[Tl],Xa=Bo.state;if($t.activeTexture.set(sr.TEXTURE0),Xa.atlasTexture.bind(Xa.atlasInterpolation,sr.CLAMP_TO_EDGE),Xa.atlasTextureIcon&&($t.activeTexture.set(sr.TEXTURE1),Xa.atlasTextureIcon&&Xa.atlasTextureIcon.bind(Xa.atlasInterpolationIcon,sr.CLAMP_TO_EDGE)),Xa.isSDF){var Ds=Xa.uniformValues;Xa.hasHalo&&(Ds.u_is_halo=1,Bl(Xa.buffers,Bo.segments,X,Y,Xa.program,Gr,Ft,Gt,Ds)),Ds.u_is_halo=0}Bl(Xa.buffers,Bo.segments,X,Y,Xa.program,Gr,Ft,Gt,Xa.uniformValues)}}function Bl(Y,K,X,re,me,Oe,Be,tt,ft){var St=re.context;me.draw(St,St.gl.TRIANGLES,Oe,Be,tt,it.disabled,ft,X.id,Y.layoutVertexBuffer,Y.indexBuffer,K,X.paint,re.transform.zoom,Y.programConfigurations.get(X.id),Y.dynamicLayoutVertexBuffer,Y.opacityVertexBuffer)}function Ss(Y,K,X,re,me,Oe,Be){var tt,ft,St,Ft,Gt,$t=Y.context.gl,sr=X.paint.get("fill-pattern"),lr=sr&&sr.constantOr(1),vr=X.getCrossfadeParameters();Be?(ft=lr&&!X.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",tt=$t.LINES):(ft=lr?"fillPattern":"fill",tt=$t.TRIANGLES);for(var ir=0,gr=re;ir<gr.length;ir+=1){var Ar=gr[ir],Pr=K.getTile(Ar);if(!lr||Pr.patternsLoaded()){var Gr=Pr.getBucket(X);if(Gr){var Fr=Gr.programConfigurations.get(X.id),Yr=Y.useProgram(ft,Fr);lr&&(Y.context.activeTexture.set($t.TEXTURE0),Pr.imageAtlasTexture.bind($t.LINEAR,$t.CLAMP_TO_EDGE),Fr.updatePaintBuffers(vr));var an=sr.constantOr(null);if(an&&Pr.imageAtlas){var mn=Pr.imageAtlas,pn=mn.patternPositions[an.to.toString()],xn=mn.patternPositions[an.from.toString()];pn&&xn&&Fr.setConstantPatternPositions(pn,xn)}var Ln=Y.translatePosMatrix(Ar.posMatrix,Pr,X.paint.get("fill-translate"),X.paint.get("fill-translate-anchor"));if(Be){Ft=Gr.indexBuffer2,Gt=Gr.segments2;var Jn=[$t.drawingBufferWidth,$t.drawingBufferHeight];St=ft==="fillOutlinePattern"&&lr?Lo(Ln,Y,vr,Pr,Jn):Qo(Ln,Jn)}else Ft=Gr.indexBuffer,Gt=Gr.segments,St=lr?oc(Ln,Y,vr,Pr):Fi(Ln);Yr.draw(Y.context,tt,me,Y.stencilModeForClipping(Ar),Oe,it.disabled,St,X.id,Gr.layoutVertexBuffer,Ft,Gt,X.paint,Y.transform.zoom,Fr)}}}}function Gs(Y,K,X,re,me,Oe,Be){for(var tt=Y.context,ft=tt.gl,St=X.paint.get("fill-extrusion-pattern"),Ft=St.constantOr(1),Gt=X.getCrossfadeParameters(),$t=X.paint.get("fill-extrusion-opacity"),sr=0,lr=re;sr<lr.length;sr+=1){var vr=lr[sr],ir=K.getTile(vr),gr=ir.getBucket(X);if(gr){var Ar=gr.programConfigurations.get(X.id),Pr=Y.useProgram(Ft?"fillExtrusionPattern":"fillExtrusion",Ar);Ft&&(Y.context.activeTexture.set(ft.TEXTURE0),ir.imageAtlasTexture.bind(ft.LINEAR,ft.CLAMP_TO_EDGE),Ar.updatePaintBuffers(Gt));var Gr=St.constantOr(null);if(Gr&&ir.imageAtlas){var Fr=ir.imageAtlas,Yr=Fr.patternPositions[Gr.to.toString()],an=Fr.patternPositions[Gr.from.toString()];Yr&&an&&Ar.setConstantPatternPositions(Yr,an)}var mn=Y.translatePosMatrix(vr.posMatrix,ir,X.paint.get("fill-extrusion-translate"),X.paint.get("fill-extrusion-translate-anchor")),pn=X.paint.get("fill-extrusion-vertical-gradient"),xn=Ft?co(mn,Y,pn,$t,vr,Gt,ir):Ri(mn,Y,pn,$t);Pr.draw(tt,tt.gl.TRIANGLES,me,Oe,Be,it.backCCW,xn,X.id,gr.layoutVertexBuffer,gr.indexBuffer,gr.segments,X.paint,Y.transform.zoom,Ar)}}}function Es(Y,K,X,re,me,Oe){var Be=Y.context,tt=Be.gl,ft=K.fbo;if(ft){var St=Y.useProgram("hillshade");Be.activeTexture.set(tt.TEXTURE0),tt.bindTexture(tt.TEXTURE_2D,ft.colorAttachment.get());var Ft=function(Gt,$t,sr){var lr=sr.paint.get("hillshade-shadow-color"),vr=sr.paint.get("hillshade-highlight-color"),ir=sr.paint.get("hillshade-accent-color"),gr=sr.paint.get("hillshade-illumination-direction")*(Math.PI/180);sr.paint.get("hillshade-illumination-anchor")==="viewport"&&(gr-=Gt.transform.angle);var Ar,Pr,Gr,Fr=!Gt.options.moving;return{u_matrix:Gt.transform.calculatePosMatrix($t.tileID.toUnwrapped(),Fr),u_image:0,u_latrange:(Ar=$t.tileID,Pr=Math.pow(2,Ar.canonical.z),Gr=Ar.canonical.y,[new e.MercatorCoordinate(0,Gr/Pr).toLngLat().lat,new e.MercatorCoordinate(0,(Gr+1)/Pr).toLngLat().lat]),u_light:[sr.paint.get("hillshade-exaggeration"),gr],u_shadow:lr,u_highlight:vr,u_accent:ir}}(Y,K,X);St.draw(Be,tt.TRIANGLES,re,me,Oe,it.disabled,Ft,X.id,Y.rasterBoundsBuffer,Y.quadTriangleIndexBuffer,Y.rasterBoundsSegments)}}function Ys(Y,K,X,re,me,Oe,Be){var tt=Y.context,ft=tt.gl,St=K.dem;if(St&&St.data){var Ft=St.dim,Gt=St.stride,$t=St.getPixels();if(tt.activeTexture.set(ft.TEXTURE1),tt.pixelStoreUnpackPremultiplyAlpha.set(!1),K.demTexture=K.demTexture||Y.getTileTexture(Gt),K.demTexture){var sr=K.demTexture;sr.update($t,{premultiply:!1}),sr.bind(ft.NEAREST,ft.CLAMP_TO_EDGE)}else K.demTexture=new e.Texture(tt,$t,ft.RGBA,{premultiply:!1}),K.demTexture.bind(ft.NEAREST,ft.CLAMP_TO_EDGE);tt.activeTexture.set(ft.TEXTURE0);var lr=K.fbo;if(!lr){var vr=new e.Texture(tt,{width:Ft,height:Ft,data:null},ft.RGBA);vr.bind(ft.LINEAR,ft.CLAMP_TO_EDGE),(lr=K.fbo=tt.createFramebuffer(Ft,Ft,!0)).colorAttachment.set(vr.texture)}tt.bindFramebuffer.set(lr.framebuffer),tt.viewport.set([0,0,Ft,Ft]),Y.useProgram("hillshadePrepare").draw(tt,ft.TRIANGLES,me,Oe,Be,it.disabled,function(ir,gr,Ar){var Pr=gr.stride,Gr=e.create();return e.ortho(Gr,0,e.EXTENT,-e.EXTENT,0,0,1),e.translate(Gr,Gr,[0,-e.EXTENT,0]),{u_matrix:Gr,u_image:1,u_dimension:[Pr,Pr],u_zoom:ir.overscaledZ,u_maxzoom:Ar,u_unpack:gr.getUnpackVector()}}(K.tileID,St,re),X.id,Y.rasterBoundsBuffer,Y.quadTriangleIndexBuffer,Y.rasterBoundsSegments),K.needsHillshadePrepare=!1}}function ml(Y,K,X,re,me){var Oe=re.paint.get("raster-fade-duration");if(Oe>0){var Be=e.browser.now(),tt=(Be-Y.timeAdded)/Oe,ft=K?(Be-K.timeAdded)/Oe:-1,St=X.getSource(),Ft=me.coveringZoomLevel({tileSize:St.tileSize,roundZoom:St.roundZoom}),Gt=!K||Math.abs(K.tileID.overscaledZ-Ft)>Math.abs(Y.tileID.overscaledZ-Ft),$t=Gt&&Y.refreshedUponExpiration?1:e.clamp(Gt?tt:1-ft,0,1);return Y.refreshedUponExpiration&&tt>=1&&(Y.refreshedUponExpiration=!1),K?{opacity:1,mix:1-$t}:{opacity:$t,mix:0}}return{opacity:1,mix:0}}var ns=new e.Color(1,0,0,1),Nl=new e.Color(0,1,0,1),fc=new e.Color(0,0,1,1),Rc=new e.Color(1,0,1,1),hc=new e.Color(0,1,1,1);function vl(Y,K,X,re){Bi(Y,0,K+X/2,Y.transform.width,X,re)}function to(Y,K,X,re){Bi(Y,K-X/2,0,X,Y.transform.height,re)}function Bi(Y,K,X,re,me,Oe){var Be=Y.context,tt=Be.gl;tt.enable(tt.SCISSOR_TEST),tt.scissor(K*e.browser.devicePixelRatio,X*e.browser.devicePixelRatio,re*e.browser.devicePixelRatio,me*e.browser.devicePixelRatio),Be.clear({color:Oe}),tt.disable(tt.SCISSOR_TEST)}function pc(Y,K,X){var re=Y.context,me=re.gl,Oe=X.posMatrix,Be=Y.useProgram("debug"),tt=xe.disabled,ft=Ee.disabled,St=Y.colorModeForRenderPass();re.activeTexture.set(me.TEXTURE0),Y.emptyTexture.bind(me.LINEAR,me.CLAMP_TO_EDGE),Be.draw(re,me.LINE_STRIP,tt,ft,St,it.disabled,Us(Oe,e.Color.red),"$debug",Y.debugBuffer,Y.tileBorderIndexBuffer,Y.debugSegments);var Ft=K.getTileByID(X.key).latestRawTileData,Gt=Math.floor((Ft&&Ft.byteLength||0)/1024),$t=K.getTile(X).tileSize,sr=512/Math.min($t,512)*(X.overscaledZ/Y.transform.zoom)*.5,lr=X.canonical.toString();X.overscaledZ!==X.canonical.z&&(lr+=" => "+X.overscaledZ),function(vr,ir){vr.initDebugOverlayCanvas();var gr=vr.debugOverlayCanvas,Ar=vr.context.gl,Pr=vr.debugOverlayCanvas.getContext("2d");Pr.clearRect(0,0,gr.width,gr.height),Pr.shadowColor="white",Pr.shadowBlur=2,Pr.lineWidth=1.5,Pr.strokeStyle="white",Pr.textBaseline="top",Pr.font="bold 36px Open Sans, sans-serif",Pr.fillText(ir,5,5),Pr.strokeText(ir,5,5),vr.debugOverlayTexture.update(gr),vr.debugOverlayTexture.bind(Ar.LINEAR,Ar.CLAMP_TO_EDGE)}(Y,lr+" "+Gt+"kb"),Be.draw(re,me.TRIANGLES,tt,ft,Je.alphaBlended,it.disabled,Us(Oe,e.Color.transparent,sr),"$debug",Y.debugBuffer,Y.quadTriangleIndexBuffer,Y.debugSegments)}var jl={symbol:function(Y,K,X,re,me){if(Y.renderPass==="translucent"){var Oe=Ee.disabled,Be=Y.colorModeForRenderPass();X.layout.get("text-variable-anchor")&&function(tt,ft,St,Ft,Gt,$t,sr){for(var lr=ft.transform,vr=Gt==="map",ir=$t==="map",gr=0,Ar=tt;gr<Ar.length;gr+=1){var Pr=Ar[gr],Gr=Ft.getTile(Pr),Fr=Gr.getBucket(St);if(Fr&&Fr.text&&Fr.text.segments.get().length){var Yr=e.evaluateSizeForZoom(Fr.textSizeData,lr.zoom),an=Nr(Gr,1,ft.transform.zoom),mn=Qt(Pr.posMatrix,ir,vr,ft.transform,an),pn=St.layout.get("icon-text-fit")!=="none"&&Fr.hasIconData();if(Yr){var xn=Math.pow(2,lr.zoom-Gr.tileID.overscaledZ);As(Fr,vr,ir,sr,e.symbolSize,lr,mn,Pr.posMatrix,xn,Yr,pn)}}}}(re,Y,X,K,X.layout.get("text-rotation-alignment"),X.layout.get("text-pitch-alignment"),me),X.paint.get("icon-opacity").constantOr(1)!==0&&dl(Y,K,X,re,!1,X.paint.get("icon-translate"),X.paint.get("icon-translate-anchor"),X.layout.get("icon-rotation-alignment"),X.layout.get("icon-pitch-alignment"),X.layout.get("icon-keep-upright"),Oe,Be),X.paint.get("text-opacity").constantOr(1)!==0&&dl(Y,K,X,re,!0,X.paint.get("text-translate"),X.paint.get("text-translate-anchor"),X.layout.get("text-rotation-alignment"),X.layout.get("text-pitch-alignment"),X.layout.get("text-keep-upright"),Oe,Be),K.map.showCollisionBoxes&&(Fl(Y,K,X,re,X.paint.get("text-translate"),X.paint.get("text-translate-anchor"),!0),Fl(Y,K,X,re,X.paint.get("icon-translate"),X.paint.get("icon-translate-anchor"),!1))}},circle:function(Y,K,X,re){if(Y.renderPass==="translucent"){var me=X.paint.get("circle-opacity"),Oe=X.paint.get("circle-stroke-width"),Be=X.paint.get("circle-stroke-opacity"),tt=X.layout.get("circle-sort-key").constantOr(1)!==void 0;if(me.constantOr(1)!==0||Oe.constantOr(1)!==0&&Be.constantOr(1)!==0){for(var ft=Y.context,St=ft.gl,Ft=Y.depthModeForSublayer(0,xe.ReadOnly),Gt=Ee.disabled,$t=Y.colorModeForRenderPass(),sr=[],lr=0;lr<re.length;lr++){var vr=re[lr],ir=K.getTile(vr),gr=ir.getBucket(X);if(gr){var Ar=gr.programConfigurations.get(X.id),Pr={programConfiguration:Ar,program:Y.useProgram("circle",Ar),layoutVertexBuffer:gr.layoutVertexBuffer,indexBuffer:gr.indexBuffer,uniformValues:Ts(Y,vr,ir,X)};if(tt)for(var Gr=0,Fr=gr.segments.get();Gr<Fr.length;Gr+=1){var Yr=Fr[Gr];sr.push({segments:new e.SegmentVector([Yr]),sortKey:Yr.sortKey,state:Pr})}else sr.push({segments:gr.segments,sortKey:0,state:Pr})}}tt&&sr.sort(function(Ln,Jn){return Ln.sortKey-Jn.sortKey});for(var an=0,mn=sr;an<mn.length;an+=1){var pn=mn[an],xn=pn.state;xn.program.draw(ft,St.TRIANGLES,Ft,Gt,$t,it.disabled,xn.uniformValues,X.id,xn.layoutVertexBuffer,xn.indexBuffer,pn.segments,X.paint,Y.transform.zoom,xn.programConfiguration)}}}},heatmap:function(Y,K,X,re){if(X.paint.get("heatmap-opacity")!==0)if(Y.renderPass==="offscreen"){var me=Y.context,Oe=me.gl,Be=Ee.disabled,tt=new Je([Oe.ONE,Oe.ONE],e.Color.transparent,[!0,!0,!0,!0]);(function(sr,lr,vr){var ir=sr.gl;sr.activeTexture.set(ir.TEXTURE1),sr.viewport.set([0,0,lr.width/4,lr.height/4]);var gr=vr.heatmapFbo;if(gr)ir.bindTexture(ir.TEXTURE_2D,gr.colorAttachment.get()),sr.bindFramebuffer.set(gr.framebuffer);else{var Ar=ir.createTexture();ir.bindTexture(ir.TEXTURE_2D,Ar),ir.texParameteri(ir.TEXTURE_2D,ir.TEXTURE_WRAP_S,ir.CLAMP_TO_EDGE),ir.texParameteri(ir.TEXTURE_2D,ir.TEXTURE_WRAP_T,ir.CLAMP_TO_EDGE),ir.texParameteri(ir.TEXTURE_2D,ir.TEXTURE_MIN_FILTER,ir.LINEAR),ir.texParameteri(ir.TEXTURE_2D,ir.TEXTURE_MAG_FILTER,ir.LINEAR),gr=vr.heatmapFbo=sr.createFramebuffer(lr.width/4,lr.height/4,!1),function(Pr,Gr,Fr,Yr){var an=Pr.gl;an.texImage2D(an.TEXTURE_2D,0,an.RGBA,Gr.width/4,Gr.height/4,0,an.RGBA,Pr.extRenderToTextureHalfFloat?Pr.extTextureHalfFloat.HALF_FLOAT_OES:an.UNSIGNED_BYTE,null),Yr.colorAttachment.set(Fr)}(sr,lr,Ar,gr)}})(me,Y,X),me.clear({color:e.Color.transparent});for(var ft=0;ft<re.length;ft++){var St=re[ft];if(!K.hasRenderableParent(St)){var Ft=K.getTile(St),Gt=Ft.getBucket(X);if(Gt){var $t=Gt.programConfigurations.get(X.id);Y.useProgram("heatmap",$t).draw(me,Oe.TRIANGLES,xe.disabled,Be,tt,it.disabled,va(St.posMatrix,Ft,Y.transform.zoom,X.paint.get("heatmap-intensity")),X.id,Gt.layoutVertexBuffer,Gt.indexBuffer,Gt.segments,X.paint,Y.transform.zoom,$t)}}}me.viewport.set([0,0,Y.width,Y.height])}else Y.renderPass==="translucent"&&(Y.context.setColorMode(Y.colorModeForRenderPass()),function(sr,lr){var vr=sr.context,ir=vr.gl,gr=lr.heatmapFbo;if(gr){vr.activeTexture.set(ir.TEXTURE0),ir.bindTexture(ir.TEXTURE_2D,gr.colorAttachment.get()),vr.activeTexture.set(ir.TEXTURE1);var Ar=lr.colorRampTexture;Ar||(Ar=lr.colorRampTexture=new e.Texture(vr,lr.colorRamp,ir.RGBA)),Ar.bind(ir.LINEAR,ir.CLAMP_TO_EDGE),sr.useProgram("heatmapTexture").draw(vr,ir.TRIANGLES,xe.disabled,Ee.disabled,sr.colorModeForRenderPass(),it.disabled,function(Pr,Gr,Fr,Yr){var an=e.create();e.ortho(an,0,Pr.width,Pr.height,0,0,1);var mn=Pr.context.gl;return{u_matrix:an,u_world:[mn.drawingBufferWidth,mn.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:Gr.paint.get("heatmap-opacity")}}(sr,lr),lr.id,sr.viewportBuffer,sr.quadTriangleIndexBuffer,sr.viewportSegments,lr.paint,sr.transform.zoom)}}(Y,X))},line:function(Y,K,X,re){if(Y.renderPass==="translucent"){var me=X.paint.get("line-opacity"),Oe=X.paint.get("line-width");if(me.constantOr(1)!==0&&Oe.constantOr(1)!==0){var Be=Y.depthModeForSublayer(0,xe.ReadOnly),tt=Y.colorModeForRenderPass(),ft=X.paint.get("line-dasharray"),St=X.paint.get("line-pattern"),Ft=St.constantOr(1),Gt=X.paint.get("line-gradient"),$t=X.getCrossfadeParameters(),sr=Ft?"linePattern":ft?"lineSDF":Gt?"lineGradient":"line",lr=Y.context,vr=lr.gl,ir=!0;if(Gt){lr.activeTexture.set(vr.TEXTURE0);var gr=X.gradientTexture;if(!X.gradient)return;gr||(gr=X.gradientTexture=new e.Texture(lr,X.gradient,vr.RGBA)),gr.bind(vr.LINEAR,vr.CLAMP_TO_EDGE)}for(var Ar=0,Pr=re;Ar<Pr.length;Ar+=1){var Gr=Pr[Ar],Fr=K.getTile(Gr);if(!Ft||Fr.patternsLoaded()){var Yr=Fr.getBucket(X);if(Yr){var an=Yr.programConfigurations.get(X.id),mn=Y.context.program.get(),pn=Y.useProgram(sr,an),xn=ir||pn.program!==mn,Ln=St.constantOr(null);if(Ln&&Fr.imageAtlas){var Jn=Fr.imageAtlas,Vn=Jn.patternPositions[Ln.to.toString()],oa=Jn.patternPositions[Ln.from.toString()];Vn&&oa&&an.setConstantPatternPositions(Vn,oa)}var Sn=Ft?es(Y,Fr,X,$t):ft?Ic(Y,Fr,X,ft,$t):Gt?sc(Y,Fr,X):Li(Y,Fr,X);Ft?(lr.activeTexture.set(vr.TEXTURE0),Fr.imageAtlasTexture.bind(vr.LINEAR,vr.CLAMP_TO_EDGE),an.updatePaintBuffers($t)):ft&&(xn||Y.lineAtlas.dirty)&&(lr.activeTexture.set(vr.TEXTURE0),Y.lineAtlas.bind(lr)),pn.draw(lr,vr.TRIANGLES,Be,Y.stencilModeForClipping(Gr),tt,it.disabled,Sn,X.id,Yr.layoutVertexBuffer,Yr.indexBuffer,Yr.segments,X.paint,Y.transform.zoom,an),ir=!1}}}}}},fill:function(Y,K,X,re){var me=X.paint.get("fill-color"),Oe=X.paint.get("fill-opacity");if(Oe.constantOr(1)!==0){var Be=Y.colorModeForRenderPass(),tt=X.paint.get("fill-pattern"),ft=Y.opaquePassEnabledForLayer()&&!tt.constantOr(1)&&me.constantOr(e.Color.transparent).a===1&&Oe.constantOr(0)===1?"opaque":"translucent";if(Y.renderPass===ft){var St=Y.depthModeForSublayer(1,Y.renderPass==="opaque"?xe.ReadWrite:xe.ReadOnly);Ss(Y,K,X,re,St,Be,!1)}if(Y.renderPass==="translucent"&&X.paint.get("fill-antialias")){var Ft=Y.depthModeForSublayer(X.getPaintProperty("fill-outline-color")?2:0,xe.ReadOnly);Ss(Y,K,X,re,Ft,Be,!0)}}},"fill-extrusion":function(Y,K,X,re){var me=X.paint.get("fill-extrusion-opacity");if(me!==0&&Y.renderPass==="translucent"){var Oe=new xe(Y.context.gl.LEQUAL,xe.ReadWrite,Y.depthRangeFor3D);if(me!==1||X.paint.get("fill-extrusion-pattern").constantOr(1))Gs(Y,K,X,re,Oe,Ee.disabled,Je.disabled),Gs(Y,K,X,re,Oe,Y.stencilModeFor3D(),Y.colorModeForRenderPass());else{var Be=Y.colorModeForRenderPass();Gs(Y,K,X,re,Oe,Ee.disabled,Be)}}},hillshade:function(Y,K,X,re){if(Y.renderPass==="offscreen"||Y.renderPass==="translucent"){for(var me=Y.context,Oe=K.getSource().maxzoom,Be=Y.depthModeForSublayer(0,xe.ReadOnly),tt=Y.colorModeForRenderPass(),ft=Y.renderPass==="translucent"?Y.stencilConfigForOverlap(re):[{},re],St=ft[0],Ft=0,Gt=ft[1];Ft<Gt.length;Ft+=1){var $t=Gt[Ft],sr=K.getTile($t);sr.needsHillshadePrepare&&Y.renderPass==="offscreen"?Ys(Y,sr,X,Oe,Be,Ee.disabled,tt):Y.renderPass==="translucent"&&Es(Y,sr,X,Be,St[$t.overscaledZ],tt)}me.viewport.set([0,0,Y.width,Y.height])}},raster:function(Y,K,X,re){if(Y.renderPass==="translucent"&&X.paint.get("raster-opacity")!==0&&re.length)for(var me=Y.context,Oe=me.gl,Be=K.getSource(),tt=Y.useProgram("raster"),ft=Y.colorModeForRenderPass(),St=Be instanceof N?[{},re]:Y.stencilConfigForOverlap(re),Ft=St[0],Gt=St[1],$t=Gt[Gt.length-1].overscaledZ,sr=!Y.options.moving,lr=0,vr=Gt;lr<vr.length;lr+=1){var ir=vr[lr],gr=Y.depthModeForSublayer(ir.overscaledZ-$t,X.paint.get("raster-opacity")===1?xe.ReadWrite:xe.ReadOnly,Oe.LESS),Ar=K.getTile(ir),Pr=Y.transform.calculatePosMatrix(ir.toUnwrapped(),sr);Ar.registerFadeDuration(X.paint.get("raster-fade-duration"));var Gr=K.findLoadedParent(ir,0),Fr=ml(Ar,Gr,K,X,Y.transform),Yr=void 0,an=void 0,mn=X.paint.get("raster-resampling")==="nearest"?Oe.NEAREST:Oe.LINEAR;me.activeTexture.set(Oe.TEXTURE0),Ar.texture.bind(mn,Oe.CLAMP_TO_EDGE,Oe.LINEAR_MIPMAP_NEAREST),me.activeTexture.set(Oe.TEXTURE1),Gr?(Gr.texture.bind(mn,Oe.CLAMP_TO_EDGE,Oe.LINEAR_MIPMAP_NEAREST),Yr=Math.pow(2,Gr.tileID.overscaledZ-Ar.tileID.overscaledZ),an=[Ar.tileID.canonical.x*Yr%1,Ar.tileID.canonical.y*Yr%1]):Ar.texture.bind(mn,Oe.CLAMP_TO_EDGE,Oe.LINEAR_MIPMAP_NEAREST);var pn=Oc(Pr,an||[0,0],Yr||1,Fr,X);Be instanceof N?tt.draw(me,Oe.TRIANGLES,gr,Ee.disabled,ft,it.disabled,pn,X.id,Be.boundsBuffer,Y.quadTriangleIndexBuffer,Be.boundsSegments):tt.draw(me,Oe.TRIANGLES,gr,Ft[ir.overscaledZ],ft,it.disabled,pn,X.id,Y.rasterBoundsBuffer,Y.quadTriangleIndexBuffer,Y.rasterBoundsSegments)}},background:function(Y,K,X){var re=X.paint.get("background-color"),me=X.paint.get("background-opacity");if(me!==0){var Oe=Y.context,Be=Oe.gl,tt=Y.transform,ft=tt.tileSize,St=X.paint.get("background-pattern");if(!Y.isPatternMissing(St)){var Ft=!St&&re.a===1&&me===1&&Y.opaquePassEnabledForLayer()?"opaque":"translucent";if(Y.renderPass===Ft){var Gt=Ee.disabled,$t=Y.depthModeForSublayer(0,Ft==="opaque"?xe.ReadWrite:xe.ReadOnly),sr=Y.colorModeForRenderPass(),lr=Y.useProgram(St?"backgroundPattern":"background"),vr=tt.coveringTiles({tileSize:ft});St&&(Oe.activeTexture.set(Be.TEXTURE0),Y.imageManager.bind(Y.context));for(var ir=X.getCrossfadeParameters(),gr=0,Ar=vr;gr<Ar.length;gr+=1){var Pr=Ar[gr],Gr=Y.transform.calculatePosMatrix(Pr.toUnwrapped()),Fr=St?qs(Gr,me,Y,St,{tileID:Pr,tileSize:ft},ir):zc(Gr,me,re);lr.draw(Oe,Be.TRIANGLES,$t,Gt,sr,it.disabled,Fr,X.id,Y.tileExtentBuffer,Y.quadTriangleIndexBuffer,Y.tileExtentSegments)}}}}},debug:function(Y,K,X){for(var re=0;re<X.length;re++)pc(Y,K,X[re])},custom:function(Y,K,X){var re=Y.context,me=X.implementation;if(Y.renderPass==="offscreen"){var Oe=me.prerender;Oe&&(Y.setCustomLayerDefaults(),re.setColorMode(Y.colorModeForRenderPass()),Oe.call(me,re.gl,Y.transform.customLayerMatrix()),re.setDirty(),Y.setBaseState())}else if(Y.renderPass==="translucent"){Y.setCustomLayerDefaults(),re.setColorMode(Y.colorModeForRenderPass()),re.setStencilMode(Ee.disabled);var Be=me.renderingMode==="3d"?new xe(Y.context.gl.LEQUAL,xe.ReadWrite,Y.depthRangeFor3D):Y.depthModeForSublayer(0,xe.ReadOnly);re.setDepthMode(Be),me.render(re.gl,Y.transform.customLayerMatrix()),re.setDirty(),Y.setBaseState(),re.bindFramebuffer.set(null)}}},Aa=function(Y,K){this.context=new ht(Y),this.transform=K,this._tileTextures={},this.setup(),this.numSublayers=ct.maxUnderzooming+ct.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new bn,this.gpuTimers={}};Aa.prototype.resize=function(Y,K){if(this.width=Y*e.browser.devicePixelRatio,this.height=K*e.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var X=0,re=this.style._order;X<re.length;X+=1)this.style._layers[re[X]].resize()},Aa.prototype.setup=function(){var Y=this.context,K=new e.StructArrayLayout2i4;K.emplaceBack(0,0),K.emplaceBack(e.EXTENT,0),K.emplaceBack(0,e.EXTENT),K.emplaceBack(e.EXTENT,e.EXTENT),this.tileExtentBuffer=Y.createVertexBuffer(K,ta.members),this.tileExtentSegments=e.SegmentVector.simpleSegment(0,0,4,2);var X=new e.StructArrayLayout2i4;X.emplaceBack(0,0),X.emplaceBack(e.EXTENT,0),X.emplaceBack(0,e.EXTENT),X.emplaceBack(e.EXTENT,e.EXTENT),this.debugBuffer=Y.createVertexBuffer(X,ta.members),this.debugSegments=e.SegmentVector.simpleSegment(0,0,4,5);var re=new e.StructArrayLayout4i8;re.emplaceBack(0,0,0,0),re.emplaceBack(e.EXTENT,0,e.EXTENT,0),re.emplaceBack(0,e.EXTENT,0,e.EXTENT),re.emplaceBack(e.EXTENT,e.EXTENT,e.EXTENT,e.EXTENT),this.rasterBoundsBuffer=Y.createVertexBuffer(re,B.members),this.rasterBoundsSegments=e.SegmentVector.simpleSegment(0,0,4,2);var me=new e.StructArrayLayout2i4;me.emplaceBack(0,0),me.emplaceBack(1,0),me.emplaceBack(0,1),me.emplaceBack(1,1),this.viewportBuffer=Y.createVertexBuffer(me,ta.members),this.viewportSegments=e.SegmentVector.simpleSegment(0,0,4,2);var Oe=new e.StructArrayLayout1ui2;Oe.emplaceBack(0),Oe.emplaceBack(1),Oe.emplaceBack(3),Oe.emplaceBack(2),Oe.emplaceBack(0),this.tileBorderIndexBuffer=Y.createIndexBuffer(Oe);var Be=new e.StructArrayLayout3ui6;Be.emplaceBack(0,1,2),Be.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=Y.createIndexBuffer(Be),this.emptyTexture=new e.Texture(Y,{width:1,height:1,data:new Uint8Array([0,0,0,0])},Y.gl.RGBA);var tt=this.context.gl;this.stencilClearMode=new Ee({func:tt.ALWAYS,mask:0},0,255,tt.ZERO,tt.ZERO,tt.ZERO)},Aa.prototype.clearStencil=function(){var Y=this.context,K=Y.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var X=e.create();e.ortho(X,0,this.width,this.height,0,0,1),e.scale(X,X,[K.drawingBufferWidth,K.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(Y,K.TRIANGLES,xe.disabled,this.stencilClearMode,Je.disabled,it.disabled,ks(X),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},Aa.prototype._renderTileClippingMasks=function(Y,K){if(this.currentStencilSource!==Y.source&&Y.isTileClipped()&&K&&K.length){this.currentStencilSource=Y.source;var X=this.context,re=X.gl;this.nextStencilID+K.length>256&&this.clearStencil(),X.setColorMode(Je.disabled),X.setDepthMode(xe.disabled);var me=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var Oe=0,Be=K;Oe<Be.length;Oe+=1){var tt=Be[Oe],ft=this._tileClippingMaskIDs[tt.key]=this.nextStencilID++;me.draw(X,re.TRIANGLES,xe.disabled,new Ee({func:re.ALWAYS,mask:0},ft,255,re.KEEP,re.KEEP,re.REPLACE),Je.disabled,it.disabled,ks(tt.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},Aa.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var Y=this.nextStencilID++,K=this.context.gl;return new Ee({func:K.NOTEQUAL,mask:255},Y,255,K.KEEP,K.KEEP,K.REPLACE)},Aa.prototype.stencilModeForClipping=function(Y){var K=this.context.gl;return new Ee({func:K.EQUAL,mask:255},this._tileClippingMaskIDs[Y.key],0,K.KEEP,K.KEEP,K.REPLACE)},Aa.prototype.stencilConfigForOverlap=function(Y){var K,X=this.context.gl,re=Y.sort(function(ft,St){return St.overscaledZ-ft.overscaledZ}),me=re[re.length-1].overscaledZ,Oe=re[0].overscaledZ-me+1;if(Oe>1){this.currentStencilSource=void 0,this.nextStencilID+Oe>256&&this.clearStencil();for(var Be={},tt=0;tt<Oe;tt++)Be[tt+me]=new Ee({func:X.GEQUAL,mask:255},tt+this.nextStencilID,255,X.KEEP,X.KEEP,X.REPLACE);return this.nextStencilID+=Oe,[Be,re]}return[(K={},K[me]=Ee.disabled,K),re]},Aa.prototype.colorModeForRenderPass=function(){var Y=this.context.gl;return this._showOverdrawInspector?new Je([Y.CONSTANT_COLOR,Y.ONE],new e.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Je.unblended:Je.alphaBlended},Aa.prototype.depthModeForSublayer=function(Y,K,X){if(!this.opaquePassEnabledForLayer())return xe.disabled;var re=1-((1+this.currentLayer)*this.numSublayers+Y)*this.depthEpsilon;return new xe(X||this.context.gl.LEQUAL,K,[re,re])},Aa.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},Aa.prototype.render=function(Y,K){var X=this;this.style=Y,this.options=K,this.lineAtlas=Y.lineAtlas,this.imageManager=Y.imageManager,this.glyphManager=Y.glyphManager,this.symbolFadeChange=Y.placement.symbolFadeChange(e.browser.now()),this.imageManager.beginFrame();var re=this.style._order,me=this.style.sourceCaches;for(var Oe in me){var Be=me[Oe];Be.used&&Be.prepare(this.context)}var tt,ft,St={},Ft={},Gt={};for(var $t in me){var sr=me[$t];St[$t]=sr.getVisibleCoordinates(),Ft[$t]=St[$t].slice().reverse(),Gt[$t]=sr.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var lr=0;lr<re.length;lr++)if(this.style._layers[re[lr]].is3D()){this.opaquePassCutoff=lr;break}this.renderPass="offscreen";for(var vr=0,ir=re;vr<ir.length;vr+=1){var gr=this.style._layers[ir[vr]];if(gr.hasOffscreenPass()&&!gr.isHidden(this.transform.zoom)){var Ar=Ft[gr.source];(gr.type==="custom"||Ar.length)&&this.renderLayer(this,me[gr.source],gr,Ar)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:K.showOverdrawInspector?e.Color.black:e.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=K.showOverdrawInspector,this.depthRangeFor3D=[0,1-(Y._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=re.length-1;this.currentLayer>=0;this.currentLayer--){var Pr=this.style._layers[re[this.currentLayer]],Gr=me[Pr.source],Fr=St[Pr.source];this._renderTileClippingMasks(Pr,Fr),this.renderLayer(this,Gr,Pr,Fr)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<re.length;this.currentLayer++){var Yr=this.style._layers[re[this.currentLayer]],an=me[Yr.source],mn=(Yr.type==="symbol"?Gt:Ft)[Yr.source];this._renderTileClippingMasks(Yr,St[Yr.source]),this.renderLayer(this,an,Yr,mn)}this.options.showTileBoundaries&&(e.values(this.style._layers).forEach(function(pn){pn.source&&!pn.isHidden(X.transform.zoom)&&(pn.source!==(ft&&ft.id)&&(ft=X.style.sourceCaches[pn.source]),(!tt||tt.getSource().maxzoom<ft.getSource().maxzoom)&&(tt=ft))}),tt&&jl.debug(this,tt,tt.getVisibleCoordinates())),this.options.showPadding&&function(pn){var xn=pn.transform.padding;vl(pn,pn.transform.height-(xn.top||0),3,ns),vl(pn,xn.bottom||0,3,Nl),to(pn,xn.left||0,3,fc),to(pn,pn.transform.width-(xn.right||0),3,Rc);var Ln=pn.transform.centerPoint;(function(Jn,Vn,oa,Sn){Bi(Jn,Vn-1,oa-10,2,20,Sn),Bi(Jn,Vn-10,oa-1,20,2,Sn)})(pn,Ln.x,pn.transform.height-Ln.y,hc)}(this),this.context.setDefault()},Aa.prototype.renderLayer=function(Y,K,X,re){X.isHidden(this.transform.zoom)||(X.type==="background"||X.type==="custom"||re.length)&&(this.id=X.id,this.gpuTimingStart(X),jl[X.type](Y,K,X,re,this.style.placement.variableOffsets),this.gpuTimingEnd())},Aa.prototype.gpuTimingStart=function(Y){if(this.options.gpuTiming){var K=this.context.extTimerQuery,X=this.gpuTimers[Y.id];X||(X=this.gpuTimers[Y.id]={calls:0,cpuTime:0,query:K.createQueryEXT()}),X.calls++,K.beginQueryEXT(K.TIME_ELAPSED_EXT,X.query)}},Aa.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var Y=this.context.extTimerQuery;Y.endQueryEXT(Y.TIME_ELAPSED_EXT)}},Aa.prototype.collectGpuTimers=function(){var Y=this.gpuTimers;return this.gpuTimers={},Y},Aa.prototype.queryGpuTimers=function(Y){var K={};for(var X in Y){var re=Y[X],me=this.context.extTimerQuery,Oe=me.getQueryObjectEXT(re.query,me.QUERY_RESULT_EXT)/1e6;me.deleteQueryEXT(re.query),K[X]=Oe}return K},Aa.prototype.translatePosMatrix=function(Y,K,X,re,me){if(!X[0]&&!X[1])return Y;var Oe=me?re==="map"?this.transform.angle:0:re==="viewport"?-this.transform.angle:0;if(Oe){var Be=Math.sin(Oe),tt=Math.cos(Oe);X=[X[0]*tt-X[1]*Be,X[0]*Be+X[1]*tt]}var ft=[me?X[0]:Nr(K,X[0],this.transform.zoom),me?X[1]:Nr(K,X[1],this.transform.zoom),0],St=new Float32Array(16);return e.translate(St,Y,ft),St},Aa.prototype.saveTileTexture=function(Y){var K=this._tileTextures[Y.size[0]];K?K.push(Y):this._tileTextures[Y.size[0]]=[Y]},Aa.prototype.getTileTexture=function(Y){var K=this._tileTextures[Y];return K&&K.length>0?K.pop():null},Aa.prototype.isPatternMissing=function(Y){if(!Y)return!1;if(!Y.from||!Y.to)return!0;var K=this.imageManager.getPattern(Y.from.toString()),X=this.imageManager.getPattern(Y.to.toString());return!K||!X},Aa.prototype.useProgram=function(Y,K){this.cache=this.cache||{};var X=""+Y+(K?K.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[X]||(this.cache[X]=new ws(this.context,us[Y],K,To[Y],this._showOverdrawInspector)),this.cache[X]},Aa.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},Aa.prototype.setBaseState=function(){var Y=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(Y.FUNC_ADD)},Aa.prototype.initDebugOverlayCanvas=function(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=e.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new e.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},Aa.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var Ul=function(Y,K){this.points=Y,this.planes=K};Ul.fromInvProjectionMatrix=function(Y,K,X){var re=Math.pow(2,X),me=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(Be){return e.transformMat4([],Be,Y)}).map(function(Be){return e.scale$1([],Be,1/Be[3]/K*re)}),Oe=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(Be){var tt=e.sub([],me[Be[0]],me[Be[1]]),ft=e.sub([],me[Be[2]],me[Be[1]]),St=e.normalize([],e.cross([],tt,ft)),Ft=-e.dot(St,me[Be[1]]);return St.concat(Ft)});return new Ul(me,Oe)};var Mi=function(Y,K){this.min=Y,this.max=K,this.center=e.scale$2([],e.add([],this.min,this.max),.5)};Mi.prototype.quadrant=function(Y){for(var K=[Y%2==0,Y<2],X=e.clone$2(this.min),re=e.clone$2(this.max),me=0;me<K.length;me++)X[me]=K[me]?this.min[me]:this.center[me],re[me]=K[me]?this.center[me]:this.max[me];return re[2]=this.max[2],new Mi(X,re)},Mi.prototype.distanceX=function(Y){return Math.max(Math.min(this.max[0],Y[0]),this.min[0])-Y[0]},Mi.prototype.distanceY=function(Y){return Math.max(Math.min(this.max[1],Y[1]),this.min[1])-Y[1]},Mi.prototype.intersects=function(Y){for(var K=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],X=!0,re=0;re<Y.planes.length;re++){for(var me=Y.planes[re],Oe=0,Be=0;Be<K.length;Be++)Oe+=e.dot$1(me,K[Be])>=0;if(Oe===0)return 0;Oe!==K.length&&(X=!1)}if(X)return 2;for(var tt=0;tt<3;tt++){for(var ft=Number.MAX_VALUE,St=-Number.MAX_VALUE,Ft=0;Ft<Y.points.length;Ft++){var Gt=Y.points[Ft][tt]-this.min[tt];ft=Math.min(ft,Gt),St=Math.max(St,Gt)}if(St<0||ft>this.max[tt]-this.min[tt])return 0}return 1};var Cs=function(Y,K,X,re){if(Y===void 0&&(Y=0),K===void 0&&(K=0),X===void 0&&(X=0),re===void 0&&(re=0),isNaN(Y)||Y<0||isNaN(K)||K<0||isNaN(X)||X<0||isNaN(re)||re<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=Y,this.bottom=K,this.left=X,this.right=re};Cs.prototype.interpolate=function(Y,K,X){return K.top!=null&&Y.top!=null&&(this.top=e.number(Y.top,K.top,X)),K.bottom!=null&&Y.bottom!=null&&(this.bottom=e.number(Y.bottom,K.bottom,X)),K.left!=null&&Y.left!=null&&(this.left=e.number(Y.left,K.left,X)),K.right!=null&&Y.right!=null&&(this.right=e.number(Y.right,K.right,X)),this},Cs.prototype.getCenter=function(Y,K){var X=e.clamp((this.left+Y-this.right)/2,0,Y),re=e.clamp((this.top+K-this.bottom)/2,0,K);return new e.Point(X,re)},Cs.prototype.equals=function(Y){return this.top===Y.top&&this.bottom===Y.bottom&&this.left===Y.left&&this.right===Y.right},Cs.prototype.clone=function(){return new Cs(this.top,this.bottom,this.left,this.right)},Cs.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var fa=function(Y,K,X,re,me){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=me===void 0||me,this._minZoom=Y||0,this._maxZoom=K||22,this._minPitch=X??0,this._maxPitch=re??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new e.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Cs,this._posMatrixCache={},this._alignedPosMatrixCache={}},ya={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};fa.prototype.clone=function(){var Y=new fa(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return Y.tileSize=this.tileSize,Y.latRange=this.latRange,Y.width=this.width,Y.height=this.height,Y._center=this._center,Y.zoom=this.zoom,Y.angle=this.angle,Y._fov=this._fov,Y._pitch=this._pitch,Y._unmodified=this._unmodified,Y._edgeInsets=this._edgeInsets.clone(),Y._calcMatrices(),Y},ya.minZoom.get=function(){return this._minZoom},ya.minZoom.set=function(Y){this._minZoom!==Y&&(this._minZoom=Y,this.zoom=Math.max(this.zoom,Y))},ya.maxZoom.get=function(){return this._maxZoom},ya.maxZoom.set=function(Y){this._maxZoom!==Y&&(this._maxZoom=Y,this.zoom=Math.min(this.zoom,Y))},ya.minPitch.get=function(){return this._minPitch},ya.minPitch.set=function(Y){this._minPitch!==Y&&(this._minPitch=Y,this.pitch=Math.max(this.pitch,Y))},ya.maxPitch.get=function(){return this._maxPitch},ya.maxPitch.set=function(Y){this._maxPitch!==Y&&(this._maxPitch=Y,this.pitch=Math.min(this.pitch,Y))},ya.renderWorldCopies.get=function(){return this._renderWorldCopies},ya.renderWorldCopies.set=function(Y){Y===void 0?Y=!0:Y===null&&(Y=!1),this._renderWorldCopies=Y},ya.worldSize.get=function(){return this.tileSize*this.scale},ya.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},ya.size.get=function(){return new e.Point(this.width,this.height)},ya.bearing.get=function(){return-this.angle/Math.PI*180},ya.bearing.set=function(Y){var K=-e.wrap(Y,-180,180)*Math.PI/180;this.angle!==K&&(this._unmodified=!1,this.angle=K,this._calcMatrices(),this.rotationMatrix=e.create$2(),e.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},ya.pitch.get=function(){return this._pitch/Math.PI*180},ya.pitch.set=function(Y){var K=e.clamp(Y,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==K&&(this._unmodified=!1,this._pitch=K,this._calcMatrices())},ya.fov.get=function(){return this._fov/Math.PI*180},ya.fov.set=function(Y){Y=Math.max(.01,Math.min(60,Y)),this._fov!==Y&&(this._unmodified=!1,this._fov=Y/180*Math.PI,this._calcMatrices())},ya.zoom.get=function(){return this._zoom},ya.zoom.set=function(Y){var K=Math.min(Math.max(Y,this.minZoom),this.maxZoom);this._zoom!==K&&(this._unmodified=!1,this._zoom=K,this.scale=this.zoomScale(K),this.tileZoom=Math.floor(K),this.zoomFraction=K-this.tileZoom,this._constrain(),this._calcMatrices())},ya.center.get=function(){return this._center},ya.center.set=function(Y){Y.lat===this._center.lat&&Y.lng===this._center.lng||(this._unmodified=!1,this._center=Y,this._constrain(),this._calcMatrices())},ya.padding.get=function(){return this._edgeInsets.toJSON()},ya.padding.set=function(Y){this._edgeInsets.equals(Y)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,Y,1),this._calcMatrices())},ya.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},fa.prototype.isPaddingEqual=function(Y){return this._edgeInsets.equals(Y)},fa.prototype.interpolatePadding=function(Y,K,X){this._unmodified=!1,this._edgeInsets.interpolate(Y,K,X),this._constrain(),this._calcMatrices()},fa.prototype.coveringZoomLevel=function(Y){var K=(Y.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/Y.tileSize));return Math.max(0,K)},fa.prototype.getVisibleUnwrappedCoordinates=function(Y){var K=[new e.UnwrappedTileID(0,Y)];if(this._renderWorldCopies)for(var X=this.pointCoordinate(new e.Point(0,0)),re=this.pointCoordinate(new e.Point(this.width,0)),me=this.pointCoordinate(new e.Point(this.width,this.height)),Oe=this.pointCoordinate(new e.Point(0,this.height)),Be=Math.floor(Math.min(X.x,re.x,me.x,Oe.x)),tt=Math.floor(Math.max(X.x,re.x,me.x,Oe.x)),ft=Be-1;ft<=tt+1;ft++)ft!==0&&K.push(new e.UnwrappedTileID(ft,Y));return K},fa.prototype.coveringTiles=function(Y){var K=this.coveringZoomLevel(Y),X=K;if(Y.minzoom!==void 0&&K<Y.minzoom)return[];Y.maxzoom!==void 0&&K>Y.maxzoom&&(K=Y.maxzoom);var re=e.MercatorCoordinate.fromLngLat(this.center),me=Math.pow(2,K),Oe=[me*re.x,me*re.y,0],Be=Ul.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,K),tt=Y.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(tt=K);var ft=function(pn){return{aabb:new Mi([pn*me,0,0],[(pn+1)*me,me,0]),zoom:0,x:0,y:0,wrap:pn,fullyVisible:!1}},St=[],Ft=[],Gt=K,$t=Y.reparseOverscaled?X:K;if(this._renderWorldCopies)for(var sr=1;sr<=3;sr++)St.push(ft(-sr)),St.push(ft(sr));for(St.push(ft(0));St.length>0;){var lr=St.pop(),vr=lr.x,ir=lr.y,gr=lr.fullyVisible;if(!gr){var Ar=lr.aabb.intersects(Be);if(Ar===0)continue;gr=Ar===2}var Pr=lr.aabb.distanceX(Oe),Gr=lr.aabb.distanceY(Oe),Fr=Math.max(Math.abs(Pr),Math.abs(Gr));if(lr.zoom===Gt||Fr>3+(1<<Gt-lr.zoom)-2&&lr.zoom>=tt)Ft.push({tileID:new e.OverscaledTileID(lr.zoom===Gt?$t:lr.zoom,lr.wrap,lr.zoom,vr,ir),distanceSq:e.sqrLen([Oe[0]-.5-vr,Oe[1]-.5-ir])});else for(var Yr=0;Yr<4;Yr++){var an=(vr<<1)+Yr%2,mn=(ir<<1)+(Yr>>1);St.push({aabb:lr.aabb.quadrant(Yr),zoom:lr.zoom+1,x:an,y:mn,wrap:lr.wrap,fullyVisible:gr})}}return Ft.sort(function(pn,xn){return pn.distanceSq-xn.distanceSq}).map(function(pn){return pn.tileID})},fa.prototype.resize=function(Y,K){this.width=Y,this.height=K,this.pixelsToGLUnits=[2/Y,-2/K],this._constrain(),this._calcMatrices()},ya.unmodified.get=function(){return this._unmodified},fa.prototype.zoomScale=function(Y){return Math.pow(2,Y)},fa.prototype.scaleZoom=function(Y){return Math.log(Y)/Math.LN2},fa.prototype.project=function(Y){var K=e.clamp(Y.lat,-this.maxValidLatitude,this.maxValidLatitude);return new e.Point(e.mercatorXfromLng(Y.lng)*this.worldSize,e.mercatorYfromLat(K)*this.worldSize)},fa.prototype.unproject=function(Y){return new e.MercatorCoordinate(Y.x/this.worldSize,Y.y/this.worldSize).toLngLat()},ya.point.get=function(){return this.project(this.center)},fa.prototype.setLocationAtPoint=function(Y,K){var X=this.pointCoordinate(K),re=this.pointCoordinate(this.centerPoint),me=this.locationCoordinate(Y),Oe=new e.MercatorCoordinate(me.x-(X.x-re.x),me.y-(X.y-re.y));this.center=this.coordinateLocation(Oe),this._renderWorldCopies&&(this.center=this.center.wrap())},fa.prototype.locationPoint=function(Y){return this.coordinatePoint(this.locationCoordinate(Y))},fa.prototype.pointLocation=function(Y){return this.coordinateLocation(this.pointCoordinate(Y))},fa.prototype.locationCoordinate=function(Y){return e.MercatorCoordinate.fromLngLat(Y)},fa.prototype.coordinateLocation=function(Y){return Y.toLngLat()},fa.prototype.pointCoordinate=function(Y){var K=[Y.x,Y.y,0,1],X=[Y.x,Y.y,1,1];e.transformMat4(K,K,this.pixelMatrixInverse),e.transformMat4(X,X,this.pixelMatrixInverse);var re=K[3],me=X[3],Oe=K[1]/re,Be=X[1]/me,tt=K[2]/re,ft=X[2]/me,St=tt===ft?0:(0-tt)/(ft-tt);return new e.MercatorCoordinate(e.number(K[0]/re,X[0]/me,St)/this.worldSize,e.number(Oe,Be,St)/this.worldSize)},fa.prototype.coordinatePoint=function(Y){var K=[Y.x*this.worldSize,Y.y*this.worldSize,0,1];return e.transformMat4(K,K,this.pixelMatrix),new e.Point(K[0]/K[3],K[1]/K[3])},fa.prototype.getBounds=function(){return new e.LngLatBounds().extend(this.pointLocation(new e.Point(0,0))).extend(this.pointLocation(new e.Point(this.width,0))).extend(this.pointLocation(new e.Point(this.width,this.height))).extend(this.pointLocation(new e.Point(0,this.height)))},fa.prototype.getMaxBounds=function(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new e.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},fa.prototype.setMaxBounds=function(Y){Y?(this.lngRange=[Y.getWest(),Y.getEast()],this.latRange=[Y.getSouth(),Y.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},fa.prototype.calculatePosMatrix=function(Y,K){K===void 0&&(K=!1);var X=Y.key,re=K?this._alignedPosMatrixCache:this._posMatrixCache;if(re[X])return re[X];var me=Y.canonical,Oe=this.worldSize/this.zoomScale(me.z),Be=me.x+Math.pow(2,me.z)*Y.wrap,tt=e.identity(new Float64Array(16));return e.translate(tt,tt,[Be*Oe,me.y*Oe,0]),e.scale(tt,tt,[Oe/e.EXTENT,Oe/e.EXTENT,1]),e.multiply(tt,K?this.alignedProjMatrix:this.projMatrix,tt),re[X]=new Float32Array(tt),re[X]},fa.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},fa.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var Y,K,X,re,me=-90,Oe=90,Be=-180,tt=180,ft=this.size,St=this._unmodified;if(this.latRange){var Ft=this.latRange;me=e.mercatorYfromLat(Ft[1])*this.worldSize,Y=(Oe=e.mercatorYfromLat(Ft[0])*this.worldSize)-me<ft.y?ft.y/(Oe-me):0}if(this.lngRange){var Gt=this.lngRange;Be=e.mercatorXfromLng(Gt[0])*this.worldSize,K=(tt=e.mercatorXfromLng(Gt[1])*this.worldSize)-Be<ft.x?ft.x/(tt-Be):0}var $t=this.point,sr=Math.max(K||0,Y||0);if(sr)return this.center=this.unproject(new e.Point(K?(tt+Be)/2:$t.x,Y?(Oe+me)/2:$t.y)),this.zoom+=this.scaleZoom(sr),this._unmodified=St,void(this._constraining=!1);if(this.latRange){var lr=$t.y,vr=ft.y/2;lr-vr<me&&(re=me+vr),lr+vr>Oe&&(re=Oe-vr)}if(this.lngRange){var ir=$t.x,gr=ft.x/2;ir-gr<Be&&(X=Be+gr),ir+gr>tt&&(X=tt-gr)}X===void 0&&re===void 0||(this.center=this.unproject(new e.Point(X!==void 0?X:$t.x,re!==void 0?re:$t.y))),this._unmodified=St,this._constraining=!1}},fa.prototype._calcMatrices=function(){if(this.height){var Y=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var K=Math.PI/2+this._pitch,X=this._fov*(.5+Y.y/this.height),re=Math.sin(X)*this.cameraToCenterDistance/Math.sin(e.clamp(Math.PI-K-X,.01,Math.PI-.01)),me=this.point,Oe=me.x,Be=me.y,tt=1.01*(Math.cos(Math.PI/2-this._pitch)*re+this.cameraToCenterDistance),ft=this.height/50,St=new Float64Array(16);e.perspective(St,this._fov,this.width/this.height,ft,tt),St[8]=2*-Y.x/this.width,St[9]=2*Y.y/this.height,e.scale(St,St,[1,-1,1]),e.translate(St,St,[0,0,-this.cameraToCenterDistance]),e.rotateX(St,St,this._pitch),e.rotateZ(St,St,this.angle),e.translate(St,St,[-Oe,-Be,0]),this.mercatorMatrix=e.scale([],St,[this.worldSize,this.worldSize,this.worldSize]),e.scale(St,St,[1,1,e.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=St,this.invProjMatrix=e.invert([],this.projMatrix);var Ft=this.width%2/2,Gt=this.height%2/2,$t=Math.cos(this.angle),sr=Math.sin(this.angle),lr=Oe-Math.round(Oe)+$t*Ft+sr*Gt,vr=Be-Math.round(Be)+$t*Gt+sr*Ft,ir=new Float64Array(St);if(e.translate(ir,ir,[lr>.5?lr-1:lr,vr>.5?vr-1:vr,0]),this.alignedProjMatrix=ir,St=e.create(),e.scale(St,St,[this.width/2,-this.height/2,1]),e.translate(St,St,[1,-1,0]),this.labelPlaneMatrix=St,St=e.create(),e.scale(St,St,[1,-1,1]),e.translate(St,St,[-1,-1,0]),e.scale(St,St,[2/this.width,2/this.height,1]),this.glCoordMatrix=St,this.pixelMatrix=e.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(St=e.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=St,this._posMatrixCache={},this._alignedPosMatrixCache={}}},fa.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var Y=this.pointCoordinate(new e.Point(0,0)),K=[Y.x*this.worldSize,Y.y*this.worldSize,0,1];return e.transformMat4(K,K,this.pixelMatrix)[3]/this.cameraToCenterDistance},fa.prototype.getCameraPoint=function(){var Y=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new e.Point(0,Y))},fa.prototype.getCameraQueryGeometry=function(Y){var K=this.getCameraPoint();if(Y.length===1)return[Y[0],K];for(var X=K.x,re=K.y,me=K.x,Oe=K.y,Be=0,tt=Y;Be<tt.length;Be+=1){var ft=tt[Be];X=Math.min(X,ft.x),re=Math.min(re,ft.y),me=Math.max(me,ft.x),Oe=Math.max(Oe,ft.y)}return[new e.Point(X,re),new e.Point(me,re),new e.Point(me,Oe),new e.Point(X,Oe),new e.Point(X,re)]},Object.defineProperties(fa.prototype,ya);var ui=function(Y){var K,X,re,me;this._hashName=Y&&encodeURIComponent(Y),e.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(K=this._updateHashUnthrottled.bind(this),X=!1,re=null,me=function(){re=null,X&&(K(),re=setTimeout(me,300),X=!1)},function(){return X=!0,re||me(),re})};ui.prototype.addTo=function(Y){return this._map=Y,e.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},ui.prototype.remove=function(){return e.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},ui.prototype.getHashString=function(Y){var K=this._map.getCenter(),X=Math.round(100*this._map.getZoom())/100,re=Math.ceil((X*Math.LN2+Math.log(512/360/.5))/Math.LN10),me=Math.pow(10,re),Oe=Math.round(K.lng*me)/me,Be=Math.round(K.lat*me)/me,tt=this._map.getBearing(),ft=this._map.getPitch(),St="";if(St+=Y?"/"+Oe+"/"+Be+"/"+X:X+"/"+Be+"/"+Oe,(tt||ft)&&(St+="/"+Math.round(10*tt)/10),ft&&(St+="/"+Math.round(ft)),this._hashName){var Ft=this._hashName,Gt=!1,$t=e.window.location.hash.slice(1).split("&").map(function(sr){var lr=sr.split("=")[0];return lr===Ft?(Gt=!0,lr+"="+St):sr}).filter(function(sr){return sr});return Gt||$t.push(Ft+"="+St),"#"+$t.join("&")}return"#"+St},ui.prototype._getCurrentHash=function(){var Y,K=this,X=e.window.location.hash.replace("#","");return this._hashName?(X.split("&").map(function(re){return re.split("=")}).forEach(function(re){re[0]===K._hashName&&(Y=re)}),(Y&&Y[1]||"").split("/")):X.split("/")},ui.prototype._onHashChange=function(){var Y=this._getCurrentHash();if(Y.length>=3&&!Y.some(function(X){return isNaN(X)})){var K=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(Y[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+Y[2],+Y[1]],zoom:+Y[0],bearing:K,pitch:+(Y[4]||0)}),!0}return!1},ui.prototype._updateHashUnthrottled=function(){var Y=this.getHashString();try{e.window.history.replaceState(e.window.history.state,"",Y)}catch{}};var Po={linearity:.3,easing:e.bezier(0,0,.3,1)},Fc=e.extend({deceleration:2500,maxSpeed:1400},Po),yl=e.extend({deceleration:20,maxSpeed:1400},Po),Bc=e.extend({deceleration:1e3,maxSpeed:360},Po),Vl=e.extend({deceleration:1e3,maxSpeed:90},Po),ko=function(Y){this._map=Y,this.clear()};function Wi(Y,K){(!Y.duration||Y.duration<K.duration)&&(Y.duration=K.duration,Y.easing=K.easing)}function Ws(Y,K,X){var re=X.maxSpeed,me=X.linearity,Oe=X.deceleration,Be=e.clamp(Y*me/(K/1e3),-re,re),tt=Math.abs(Be)/(Oe*me);return{easing:X.easing,duration:1e3*tt,amount:Be*(tt/2)}}ko.prototype.clear=function(){this._inertiaBuffer=[]},ko.prototype.record=function(Y){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:e.browser.now(),settings:Y})},ko.prototype._drainInertiaBuffer=function(){for(var Y=this._inertiaBuffer,K=e.browser.now();Y.length>0&&K-Y[0].time>160;)Y.shift()},ko.prototype._onMoveEnd=function(Y){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var K={zoom:0,bearing:0,pitch:0,pan:new e.Point(0,0),pinchAround:void 0,around:void 0},X=0,re=this._inertiaBuffer;X<re.length;X+=1){var me=re[X].settings;K.zoom+=me.zoomDelta||0,K.bearing+=me.bearingDelta||0,K.pitch+=me.pitchDelta||0,me.panDelta&&K.pan._add(me.panDelta),me.around&&(K.around=me.around),me.pinchAround&&(K.pinchAround=me.pinchAround)}var Oe=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,Be={};if(K.pan.mag()){var tt=Ws(K.pan.mag(),Oe,e.extend({},Fc,Y||{}));Be.offset=K.pan.mult(tt.amount/K.pan.mag()),Be.center=this._map.transform.center,Wi(Be,tt)}if(K.zoom){var ft=Ws(K.zoom,Oe,yl);Be.zoom=this._map.transform.zoom+ft.amount,Wi(Be,ft)}if(K.bearing){var St=Ws(K.bearing,Oe,Bc);Be.bearing=this._map.transform.bearing+e.clamp(St.amount,-179,179),Wi(Be,St)}if(K.pitch){var Ft=Ws(K.pitch,Oe,Vl);Be.pitch=this._map.transform.pitch+Ft.amount,Wi(Be,Ft)}if(Be.zoom||Be.bearing){var Gt=K.pinchAround===void 0?K.around:K.pinchAround;Be.around=Gt?this._map.unproject(Gt):this._map.getCenter()}return this.clear(),e.extend(Be,{noMoveStart:!0})}};var Ni=function(Y){function K(re,me,Oe,Be){Be===void 0&&(Be={});var tt=r.mousePos(me.getCanvasContainer(),Oe),ft=me.unproject(tt);Y.call(this,re,e.extend({point:tt,lngLat:ft,originalEvent:Oe},Be)),this._defaultPrevented=!1,this.target=me}Y&&(K.__proto__=Y),(K.prototype=Object.create(Y&&Y.prototype)).constructor=K;var X={defaultPrevented:{configurable:!0}};return K.prototype.preventDefault=function(){this._defaultPrevented=!0},X.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(K.prototype,X),K}(e.Event),as=function(Y){function K(re,me,Oe){var Be=re==="touchend"?Oe.changedTouches:Oe.touches,tt=r.touchPos(me.getCanvasContainer(),Be),ft=tt.map(function(Gt){return me.unproject(Gt)}),St=tt.reduce(function(Gt,$t,sr,lr){return Gt.add($t.div(lr.length))},new e.Point(0,0)),Ft=me.unproject(St);Y.call(this,re,{points:tt,point:St,lngLats:ft,lngLat:Ft,originalEvent:Oe}),this._defaultPrevented=!1}Y&&(K.__proto__=Y),(K.prototype=Object.create(Y&&Y.prototype)).constructor=K;var X={defaultPrevented:{configurable:!0}};return K.prototype.preventDefault=function(){this._defaultPrevented=!0},X.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(K.prototype,X),K}(e.Event),En=function(Y){function K(re,me,Oe){Y.call(this,re,{originalEvent:Oe}),this._defaultPrevented=!1}Y&&(K.__proto__=Y),(K.prototype=Object.create(Y&&Y.prototype)).constructor=K;var X={defaultPrevented:{configurable:!0}};return K.prototype.preventDefault=function(){this._defaultPrevented=!0},X.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(K.prototype,X),K}(e.Event),Wa=function(Y,K){this._map=Y,this._clickTolerance=K.clickTolerance};Wa.prototype.reset=function(){delete this._mousedownPos},Wa.prototype.wheel=function(Y){return this._firePreventable(new En(Y.type,this._map,Y))},Wa.prototype.mousedown=function(Y,K){return this._mousedownPos=K,this._firePreventable(new Ni(Y.type,this._map,Y))},Wa.prototype.mouseup=function(Y){this._map.fire(new Ni(Y.type,this._map,Y))},Wa.prototype.click=function(Y,K){this._mousedownPos&&this._mousedownPos.dist(K)>=this._clickTolerance||this._map.fire(new Ni(Y.type,this._map,Y))},Wa.prototype.dblclick=function(Y){return this._firePreventable(new Ni(Y.type,this._map,Y))},Wa.prototype.mouseover=function(Y){this._map.fire(new Ni(Y.type,this._map,Y))},Wa.prototype.mouseout=function(Y){this._map.fire(new Ni(Y.type,this._map,Y))},Wa.prototype.touchstart=function(Y){return this._firePreventable(new as(Y.type,this._map,Y))},Wa.prototype.touchmove=function(Y){this._map.fire(new as(Y.type,this._map,Y))},Wa.prototype.touchend=function(Y){this._map.fire(new as(Y.type,this._map,Y))},Wa.prototype.touchcancel=function(Y){this._map.fire(new as(Y.type,this._map,Y))},Wa.prototype._firePreventable=function(Y){if(this._map.fire(Y),Y.defaultPrevented)return{}},Wa.prototype.isEnabled=function(){return!0},Wa.prototype.isActive=function(){return!1},Wa.prototype.enable=function(){},Wa.prototype.disable=function(){};var ro=function(Y){this._map=Y};ro.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},ro.prototype.mousemove=function(Y){this._map.fire(new Ni(Y.type,this._map,Y))},ro.prototype.mousedown=function(){this._delayContextMenu=!0},ro.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Ni("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},ro.prototype.contextmenu=function(Y){this._delayContextMenu?this._contextMenuEvent=Y:this._map.fire(new Ni(Y.type,this._map,Y)),this._map.listens("contextmenu")&&Y.preventDefault()},ro.prototype.isEnabled=function(){return!0},ro.prototype.isActive=function(){return!1},ro.prototype.enable=function(){},ro.prototype.disable=function(){};var Zi=function(Y,K){this._map=Y,this._el=Y.getCanvasContainer(),this._container=Y.getContainer(),this._clickTolerance=K.clickTolerance||1};function uo(Y,K){for(var X={},re=0;re<Y.length;re++)X[Y[re].identifier]=K[re];return X}Zi.prototype.isEnabled=function(){return!!this._enabled},Zi.prototype.isActive=function(){return!!this._active},Zi.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},Zi.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Zi.prototype.mousedown=function(Y,K){this.isEnabled()&&Y.shiftKey&&Y.button===0&&(r.disableDrag(),this._startPos=this._lastPos=K,this._active=!0)},Zi.prototype.mousemoveWindow=function(Y,K){if(this._active){var X=K;if(!(this._lastPos.equals(X)||!this._box&&X.dist(this._startPos)<this._clickTolerance)){var re=this._startPos;this._lastPos=X,this._box||(this._box=r.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",Y));var me=Math.min(re.x,X.x),Oe=Math.max(re.x,X.x),Be=Math.min(re.y,X.y),tt=Math.max(re.y,X.y);r.setTransform(this._box,"translate("+me+"px,"+Be+"px)"),this._box.style.width=Oe-me+"px",this._box.style.height=tt-Be+"px"}}},Zi.prototype.mouseupWindow=function(Y,K){var X=this;if(this._active&&Y.button===0){var re=this._startPos,me=K;if(this.reset(),r.suppressClick(),re.x!==me.x||re.y!==me.y)return this._map.fire(new e.Event("boxzoomend",{originalEvent:Y})),{cameraAnimation:function(Oe){return Oe.fitScreenCoordinates(re,me,X._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",Y)}},Zi.prototype.keydown=function(Y){this._active&&Y.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",Y))},Zi.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(r.remove(this._box),this._box=null),r.enableDrag(),delete this._startPos,delete this._lastPos},Zi.prototype._fireEvent=function(Y,K){return this._map.fire(new e.Event(Y,{originalEvent:K}))};var no=function(Y){this.reset(),this.numTouches=Y.numTouches};no.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},no.prototype.touchstart=function(Y,K,X){(this.centroid||X.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=Y.timeStamp),X.length===this.numTouches&&(this.centroid=function(re){for(var me=new e.Point(0,0),Oe=0,Be=re;Oe<Be.length;Oe+=1)me._add(Be[Oe]);return me.div(re.length)}(K),this.touches=uo(X,K)))},no.prototype.touchmove=function(Y,K,X){if(!this.aborted&&this.centroid){var re=uo(X,K);for(var me in this.touches){var Oe=re[me];(!Oe||Oe.dist(this.touches[me])>30)&&(this.aborted=!0)}}},no.prototype.touchend=function(Y,K,X){if((!this.centroid||Y.timeStamp-this.startTime>500)&&(this.aborted=!0),X.length===0){var re=!this.aborted&&this.centroid;if(this.reset(),re)return re}};var Io=function(Y){this.singleTap=new no(Y),this.numTaps=Y.numTaps,this.reset()};Io.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},Io.prototype.touchstart=function(Y,K,X){this.singleTap.touchstart(Y,K,X)},Io.prototype.touchmove=function(Y,K,X){this.singleTap.touchmove(Y,K,X)},Io.prototype.touchend=function(Y,K,X){var re=this.singleTap.touchend(Y,K,X);if(re){var me=Y.timeStamp-this.lastTime<500,Oe=!this.lastTap||this.lastTap.dist(re)<30;if(me&&Oe||this.reset(),this.count++,this.lastTime=Y.timeStamp,this.lastTap=re,this.count===this.numTaps)return this.reset(),re}};var vn=function(){this._zoomIn=new Io({numTouches:1,numTaps:2}),this._zoomOut=new Io({numTouches:2,numTaps:1}),this.reset()};vn.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},vn.prototype.touchstart=function(Y,K,X){this._zoomIn.touchstart(Y,K,X),this._zoomOut.touchstart(Y,K,X)},vn.prototype.touchmove=function(Y,K,X){this._zoomIn.touchmove(Y,K,X),this._zoomOut.touchmove(Y,K,X)},vn.prototype.touchend=function(Y,K,X){var re=this,me=this._zoomIn.touchend(Y,K,X),Oe=this._zoomOut.touchend(Y,K,X);return me?(this._active=!0,Y.preventDefault(),setTimeout(function(){return re.reset()},0),{cameraAnimation:function(Be){return Be.easeTo({duration:300,zoom:Be.getZoom()+1,around:Be.unproject(me)},{originalEvent:Y})}}):Oe?(this._active=!0,Y.preventDefault(),setTimeout(function(){return re.reset()},0),{cameraAnimation:function(Be){return Be.easeTo({duration:300,zoom:Be.getZoom()-1,around:Be.unproject(Oe)},{originalEvent:Y})}}):void 0},vn.prototype.touchcancel=function(){this.reset()},vn.prototype.enable=function(){this._enabled=!0},vn.prototype.disable=function(){this._enabled=!1,this.reset()},vn.prototype.isEnabled=function(){return this._enabled},vn.prototype.isActive=function(){return this._active};var Pi=function(Y){this.reset(),this._clickTolerance=Y.clickTolerance||1};Pi.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},Pi.prototype._correctButton=function(Y,K){return!1},Pi.prototype._move=function(Y,K){return{}},Pi.prototype.mousedown=function(Y,K){if(!this._lastPoint){var X=r.mouseButton(Y);this._correctButton(Y,X)&&(this._lastPoint=K,this._eventButton=X)}},Pi.prototype.mousemoveWindow=function(Y,K){var X=this._lastPoint;if(X&&(Y.preventDefault(),this._moved||!(K.dist(X)<this._clickTolerance)))return this._moved=!0,this._lastPoint=K,this._move(X,K)},Pi.prototype.mouseupWindow=function(Y){r.mouseButton(Y)===this._eventButton&&(this._moved&&r.suppressClick(),this.reset())},Pi.prototype.enable=function(){this._enabled=!0},Pi.prototype.disable=function(){this._enabled=!1,this.reset()},Pi.prototype.isEnabled=function(){return this._enabled},Pi.prototype.isActive=function(){return this._active};var ql=function(Y){function K(){Y.apply(this,arguments)}return Y&&(K.__proto__=Y),(K.prototype=Object.create(Y&&Y.prototype)).constructor=K,K.prototype.mousedown=function(X,re){Y.prototype.mousedown.call(this,X,re),this._lastPoint&&(this._active=!0)},K.prototype._correctButton=function(X,re){return re===0&&!X.ctrlKey},K.prototype._move=function(X,re){return{around:re,panDelta:re.sub(X)}},K}(Pi),Hl=function(Y){function K(){Y.apply(this,arguments)}return Y&&(K.__proto__=Y),(K.prototype=Object.create(Y&&Y.prototype)).constructor=K,K.prototype._correctButton=function(X,re){return re===0&&X.ctrlKey||re===2},K.prototype._move=function(X,re){var me=.8*(re.x-X.x);if(me)return this._active=!0,{bearingDelta:me}},K.prototype.contextmenu=function(X){X.preventDefault()},K}(Pi),Zs=function(Y){function K(){Y.apply(this,arguments)}return Y&&(K.__proto__=Y),(K.prototype=Object.create(Y&&Y.prototype)).constructor=K,K.prototype._correctButton=function(X,re){return re===0&&X.ctrlKey||re===2},K.prototype._move=function(X,re){var me=-.5*(re.y-X.y);if(me)return this._active=!0,{pitchDelta:me}},K.prototype.contextmenu=function(X){X.preventDefault()},K}(Pi),fo=function(Y){this._minTouches=1,this._clickTolerance=Y.clickTolerance||1,this.reset()};fo.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new e.Point(0,0)},fo.prototype.touchstart=function(Y,K,X){return this._calculateTransform(Y,K,X)},fo.prototype.touchmove=function(Y,K,X){if(this._active)return Y.preventDefault(),this._calculateTransform(Y,K,X)},fo.prototype.touchend=function(Y,K,X){this._calculateTransform(Y,K,X),this._active&&X.length<this._minTouches&&this.reset()},fo.prototype.touchcancel=function(){this.reset()},fo.prototype._calculateTransform=function(Y,K,X){X.length>0&&(this._active=!0);var re=uo(X,K),me=new e.Point(0,0),Oe=new e.Point(0,0),Be=0;for(var tt in re){var ft=re[tt],St=this._touches[tt];St&&(me._add(ft),Oe._add(ft.sub(St)),Be++,re[tt]=ft)}if(this._touches=re,!(Be<this._minTouches)&&Oe.mag()){var Ft=Oe.div(Be);if(this._sum._add(Ft),!(this._sum.mag()<this._clickTolerance))return{around:me.div(Be),panDelta:Ft}}},fo.prototype.enable=function(){this._enabled=!0},fo.prototype.disable=function(){this._enabled=!1,this.reset()},fo.prototype.isEnabled=function(){return this._enabled},fo.prototype.isActive=function(){return this._active};var ji=function(){this.reset()};function Ls(Y,K,X){for(var re=0;re<Y.length;re++)if(Y[re].identifier===X)return K[re]}function Ai(Y,K){return Math.log(Y/K)/Math.LN2}ji.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},ji.prototype._start=function(Y){},ji.prototype._move=function(Y,K,X){return{}},ji.prototype.touchstart=function(Y,K,X){this._firstTwoTouches||X.length<2||(this._firstTwoTouches=[X[0].identifier,X[1].identifier],this._start([K[0],K[1]]))},ji.prototype.touchmove=function(Y,K,X){if(this._firstTwoTouches){Y.preventDefault();var re=this._firstTwoTouches,me=re[1],Oe=Ls(X,K,re[0]),Be=Ls(X,K,me);if(Oe&&Be){var tt=this._aroundCenter?null:Oe.add(Be).div(2);return this._move([Oe,Be],tt,Y)}}},ji.prototype.touchend=function(Y,K,X){if(this._firstTwoTouches){var re=this._firstTwoTouches,me=re[1],Oe=Ls(X,K,re[0]),Be=Ls(X,K,me);Oe&&Be||(this._active&&r.suppressClick(),this.reset())}},ji.prototype.touchcancel=function(){this.reset()},ji.prototype.enable=function(Y){this._enabled=!0,this._aroundCenter=!!Y&&Y.around==="center"},ji.prototype.disable=function(){this._enabled=!1,this.reset()},ji.prototype.isEnabled=function(){return this._enabled},ji.prototype.isActive=function(){return this._active};var ao=function(Y){function K(){Y.apply(this,arguments)}return Y&&(K.__proto__=Y),(K.prototype=Object.create(Y&&Y.prototype)).constructor=K,K.prototype.reset=function(){Y.prototype.reset.call(this),delete this._distance,delete this._startDistance},K.prototype._start=function(X){this._startDistance=this._distance=X[0].dist(X[1])},K.prototype._move=function(X,re){var me=this._distance;if(this._distance=X[0].dist(X[1]),this._active||!(Math.abs(Ai(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Ai(this._distance,me),pinchAround:re}},K}(ji);function Ps(Y,K){return 180*Y.angleWith(K)/Math.PI}var Gl=function(Y){function K(){Y.apply(this,arguments)}return Y&&(K.__proto__=Y),(K.prototype=Object.create(Y&&Y.prototype)).constructor=K,K.prototype.reset=function(){Y.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},K.prototype._start=function(X){this._startVector=this._vector=X[0].sub(X[1]),this._minDiameter=X[0].dist(X[1])},K.prototype._move=function(X,re){var me=this._vector;if(this._vector=X[0].sub(X[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Ps(this._vector,me),pinchAround:re}},K.prototype._isBelowThreshold=function(X){this._minDiameter=Math.min(this._minDiameter,X.mag());var re=25/(Math.PI*this._minDiameter)*360,me=Ps(X,this._startVector);return Math.abs(me)<re},K}(ji);function xl(Y){return Math.abs(Y.y)>Math.abs(Y.x)}var Xs=function(Y){function K(){Y.apply(this,arguments)}return Y&&(K.__proto__=Y),(K.prototype=Object.create(Y&&Y.prototype)).constructor=K,K.prototype.reset=function(){Y.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},K.prototype._start=function(X){this._lastPoints=X,xl(X[0].sub(X[1]))&&(this._valid=!1)},K.prototype._move=function(X,re,me){var Oe=X[0].sub(this._lastPoints[0]),Be=X[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(Oe,Be,me.timeStamp),this._valid)return this._lastPoints=X,this._active=!0,{pitchDelta:(Oe.y+Be.y)/2*-.5}},K.prototype.gestureBeginsVertically=function(X,re,me){if(this._valid!==void 0)return this._valid;var Oe=X.mag()>=2,Be=re.mag()>=2;if(Oe||Be){if(!Oe||!Be)return this._firstMove===void 0&&(this._firstMove=me),me-this._firstMove<100&&void 0;var tt=X.y>0==re.y>0;return xl(X)&&xl(re)&&tt}},K}(ji),Yl={panStep:100,bearingStep:15,pitchStep:10},Za=function(){var Y=Yl;this._panStep=Y.panStep,this._bearingStep=Y.bearingStep,this._pitchStep=Y.pitchStep};function Ta(Y){return Y*(2-Y)}Za.prototype.reset=function(){this._active=!1},Za.prototype.keydown=function(Y){var K=this;if(!(Y.altKey||Y.ctrlKey||Y.metaKey)){var X=0,re=0,me=0,Oe=0,Be=0;switch(Y.keyCode){case 61:case 107:case 171:case 187:X=1;break;case 189:case 109:case 173:X=-1;break;case 37:Y.shiftKey?re=-1:(Y.preventDefault(),Oe=-1);break;case 39:Y.shiftKey?re=1:(Y.preventDefault(),Oe=1);break;case 38:Y.shiftKey?me=1:(Y.preventDefault(),Be=-1);break;case 40:Y.shiftKey?me=-1:(Y.preventDefault(),Be=1);break;default:return}return{cameraAnimation:function(tt){var ft=tt.getZoom();tt.easeTo({duration:300,easeId:"keyboardHandler",easing:Ta,zoom:X?Math.round(ft)+X*(Y.shiftKey?2:1):ft,bearing:tt.getBearing()+re*K._bearingStep,pitch:tt.getPitch()+me*K._pitchStep,offset:[-Oe*K._panStep,-Be*K._panStep],center:tt.getCenter()},{originalEvent:Y})}}}},Za.prototype.enable=function(){this._enabled=!0},Za.prototype.disable=function(){this._enabled=!1,this.reset()},Za.prototype.isEnabled=function(){return this._enabled},Za.prototype.isActive=function(){return this._active};var za=function(Y,K){this._map=Y,this._el=Y.getCanvasContainer(),this._handler=K,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,e.bindAll(["_onWheel","_onTimeout","_onScrollFrame","_onScrollFinished"],this)};za.prototype.setZoomRate=function(Y){this._defaultZoomRate=Y},za.prototype.setWheelZoomRate=function(Y){this._wheelZoomRate=Y},za.prototype.isEnabled=function(){return!!this._enabled},za.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},za.prototype.isZooming=function(){return!!this._zooming},za.prototype.enable=function(Y){this.isEnabled()||(this._enabled=!0,this._aroundCenter=Y&&Y.around==="center")},za.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},za.prototype.wheel=function(Y){if(this.isEnabled()){var K=Y.deltaMode===e.window.WheelEvent.DOM_DELTA_LINE?40*Y.deltaY:Y.deltaY,X=e.browser.now(),re=X-(this._lastWheelEventTime||0);this._lastWheelEventTime=X,K!==0&&K%4.000244140625==0?this._type="wheel":K!==0&&Math.abs(K)<4?this._type="trackpad":re>400?(this._type=null,this._lastValue=K,this._timeout=setTimeout(this._onTimeout,40,Y)):this._type||(this._type=Math.abs(re*K)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,K+=this._lastValue)),Y.shiftKey&&K&&(K/=4),this._type&&(this._lastWheelEvent=Y,this._delta-=K,this._active||this._start(Y)),Y.preventDefault()}},za.prototype._onTimeout=function(Y){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(Y)},za.prototype._start=function(Y){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var K=r.mousePos(this._el,Y);this._around=e.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(K)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},za.prototype.renderFrame=function(){return this._onScrollFrame()},za.prototype._onScrollFrame=function(){var Y=this;if(this._frameId&&(this._frameId=null,this.isActive())){var K=this._map.transform;if(this._delta!==0){var X=this._type==="wheel"&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,re=2/(1+Math.exp(-Math.abs(this._delta*X)));this._delta<0&&re!==0&&(re=1/re);var me=typeof this._targetZoom=="number"?K.zoomScale(this._targetZoom):K.scale;this._targetZoom=Math.min(K.maxZoom,Math.max(K.minZoom,K.scaleZoom(me*re))),this._type==="wheel"&&(this._startZoom=K.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var Oe,Be=typeof this._targetZoom=="number"?this._targetZoom:K.zoom,tt=this._startZoom,ft=this._easing,St=!1;if(this._type==="wheel"&&tt&&ft){var Ft=Math.min((e.browser.now()-this._lastWheelEventTime)/200,1),Gt=ft(Ft);Oe=e.number(tt,Be,Gt),Ft<1?this._frameId||(this._frameId=!0):St=!0}else Oe=Be,St=!0;return this._active=!0,St&&(this._active=!1,this._finishTimeout=setTimeout(function(){Y._zooming=!1,Y._handler._triggerRenderFrame(),delete Y._targetZoom,delete Y._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!St,zoomDelta:Oe-K.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},za.prototype._smoothOutEasing=function(Y){var K=e.ease;if(this._prevEase){var X=this._prevEase,re=(e.browser.now()-X.start)/X.duration,me=X.easing(re+.01)-X.easing(re),Oe=.27/Math.sqrt(me*me+1e-4)*.01,Be=Math.sqrt(.0729-Oe*Oe);K=e.bezier(Oe,Be,.25,1)}return this._prevEase={start:e.browser.now(),duration:Y,easing:K},K},za.prototype.reset=function(){this._active=!1};var Ui=function(Y,K){this._clickZoom=Y,this._tapZoom=K};Ui.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},Ui.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},Ui.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},Ui.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var ri=function(){this.reset()};ri.prototype.reset=function(){this._active=!1},ri.prototype.dblclick=function(Y,K){return Y.preventDefault(),{cameraAnimation:function(X){X.easeTo({duration:300,zoom:X.getZoom()+(Y.shiftKey?-1:1),around:X.unproject(K)},{originalEvent:Y})}}},ri.prototype.enable=function(){this._enabled=!0},ri.prototype.disable=function(){this._enabled=!1,this.reset()},ri.prototype.isEnabled=function(){return this._enabled},ri.prototype.isActive=function(){return this._active};var Xi=function(){this._tap=new Io({numTouches:1,numTaps:1}),this.reset()};Xi.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},Xi.prototype.touchstart=function(Y,K,X){this._swipePoint||(this._tapTime&&Y.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?X.length>0&&(this._swipePoint=K[0],this._swipeTouch=X[0].identifier):this._tap.touchstart(Y,K,X))},Xi.prototype.touchmove=function(Y,K,X){if(this._tapTime){if(this._swipePoint){if(X[0].identifier!==this._swipeTouch)return;var re=K[0],me=re.y-this._swipePoint.y;return this._swipePoint=re,Y.preventDefault(),this._active=!0,{zoomDelta:me/128}}}else this._tap.touchmove(Y,K,X)},Xi.prototype.touchend=function(Y,K,X){this._tapTime?this._swipePoint&&X.length===0&&this.reset():this._tap.touchend(Y,K,X)&&(this._tapTime=Y.timeStamp)},Xi.prototype.touchcancel=function(){this.reset()},Xi.prototype.enable=function(){this._enabled=!0},Xi.prototype.disable=function(){this._enabled=!1,this.reset()},Xi.prototype.isEnabled=function(){return this._enabled},Xi.prototype.isActive=function(){return this._active};var ho=function(Y,K,X){this._el=Y,this._mousePan=K,this._touchPan=X};ho.prototype.enable=function(Y){this._inertiaOptions=Y||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},ho.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},ho.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},ho.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var Oo=function(Y,K,X){this._pitchWithRotate=Y.pitchWithRotate,this._mouseRotate=K,this._mousePitch=X};Oo.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},Oo.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},Oo.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},Oo.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var ni=function(Y,K,X,re){this._el=Y,this._touchZoom=K,this._touchRotate=X,this._tapDragZoom=re,this._rotationDisabled=!1,this._enabled=!0};ni.prototype.enable=function(Y){this._touchZoom.enable(Y),this._rotationDisabled||this._touchRotate.enable(Y),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},ni.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},ni.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},ni.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},ni.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},ni.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var ps=function(Y){return Y.zoom||Y.drag||Y.pitch||Y.rotate},Rn=function(Y){function K(){Y.apply(this,arguments)}return Y&&(K.__proto__=Y),(K.prototype=Object.create(Y&&Y.prototype)).constructor=K,K}(e.Event);function jn(Y){return Y.panDelta&&Y.panDelta.mag()||Y.zoomDelta||Y.bearingDelta||Y.pitchDelta}var Va=function(Y,K){this._map=Y,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new ko(Y),this._bearingSnap=K.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(K),e.bindAll(["handleEvent","handleWindowEvent"],this);var X=this._el;this._listeners=[[X,"touchstart",{passive:!1}],[X,"touchmove",{passive:!1}],[X,"touchend",void 0],[X,"touchcancel",void 0],[X,"mousedown",void 0],[X,"mousemove",void 0],[X,"mouseup",void 0],[e.window.document,"mousemove",{capture:!0}],[e.window.document,"mouseup",void 0],[X,"mouseover",void 0],[X,"mouseout",void 0],[X,"dblclick",void 0],[X,"click",void 0],[X,"keydown",{capture:!1}],[X,"keyup",void 0],[X,"wheel",{passive:!1}],[X,"contextmenu",void 0],[e.window,"blur",void 0]];for(var re=0,me=this._listeners;re<me.length;re+=1){var Oe=me[re],Be=Oe[0];r.addEventListener(Be,Oe[1],Be===e.window.document?this.handleWindowEvent:this.handleEvent,Oe[2])}};Va.prototype.destroy=function(){for(var Y=0,K=this._listeners;Y<K.length;Y+=1){var X=K[Y],re=X[0];r.removeEventListener(re,X[1],re===e.window.document?this.handleWindowEvent:this.handleEvent,X[2])}},Va.prototype._addDefaultHandlers=function(Y){var K=this._map,X=K.getCanvasContainer();this._add("mapEvent",new Wa(K,Y));var re=K.boxZoom=new Zi(K,Y);this._add("boxZoom",re);var me=new vn,Oe=new ri;K.doubleClickZoom=new Ui(Oe,me),this._add("tapZoom",me),this._add("clickZoom",Oe);var Be=new Xi;this._add("tapDragZoom",Be);var tt=K.touchPitch=new Xs;this._add("touchPitch",tt);var ft=new Hl(Y),St=new Zs(Y);K.dragRotate=new Oo(Y,ft,St),this._add("mouseRotate",ft,["mousePitch"]),this._add("mousePitch",St,["mouseRotate"]);var Ft=new ql(Y),Gt=new fo(Y);K.dragPan=new ho(X,Ft,Gt),this._add("mousePan",Ft),this._add("touchPan",Gt,["touchZoom","touchRotate"]);var $t=new Gl,sr=new ao;K.touchZoomRotate=new ni(X,sr,$t,Be),this._add("touchRotate",$t,["touchPan","touchZoom"]),this._add("touchZoom",sr,["touchPan","touchRotate"]);var lr=K.scrollZoom=new za(K,this);this._add("scrollZoom",lr,["mousePan"]);var vr=K.keyboard=new Za;this._add("keyboard",vr),this._add("blockableMapEvent",new ro(K));for(var ir=0,gr=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];ir<gr.length;ir+=1){var Ar=gr[ir];Y.interactive&&Y[Ar]&&K[Ar].enable(Y[Ar])}},Va.prototype._add=function(Y,K,X){this._handlers.push({handlerName:Y,handler:K,allowed:X}),this._handlersById[Y]=K},Va.prototype.stop=function(){if(!this._updatingCamera){for(var Y=0,K=this._handlers;Y<K.length;Y+=1)K[Y].handler.reset();this._inertia.clear(),this._fireEvents({},{}),this._changes=[]}},Va.prototype.isActive=function(){for(var Y=0,K=this._handlers;Y<K.length;Y+=1)if(K[Y].handler.isActive())return!0;return!1},Va.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},Va.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},Va.prototype.isMoving=function(){return!!ps(this._eventsInProgress)||this.isZooming()},Va.prototype._blockedByActive=function(Y,K,X){for(var re in Y)if(re!==X&&(!K||K.indexOf(re)<0))return!0;return!1},Va.prototype.handleWindowEvent=function(Y){this.handleEvent(Y,Y.type+"Window")},Va.prototype._getMapTouches=function(Y){for(var K=[],X=0,re=Y;X<re.length;X+=1){var me=re[X];this._el.contains(me.target)&&K.push(me)}return K},Va.prototype.handleEvent=function(Y,K){if(Y.type!=="blur"){this._updatingCamera=!0;for(var X=Y.type==="renderFrame"?void 0:Y,re={needsRenderFrame:!1},me={},Oe={},Be=Y.touches?this._getMapTouches(Y.touches):void 0,tt=Be?r.touchPos(this._el,Be):r.mousePos(this._el,Y),ft=0,St=this._handlers;ft<St.length;ft+=1){var Ft=St[ft],Gt=Ft.handlerName,$t=Ft.handler,sr=Ft.allowed;if($t.isEnabled()){var lr=void 0;this._blockedByActive(Oe,sr,Gt)?$t.reset():$t[K||Y.type]&&(lr=$t[K||Y.type](Y,tt,Be),this.mergeHandlerResult(re,me,lr,Gt,X),lr&&lr.needsRenderFrame&&this._triggerRenderFrame()),(lr||$t.isActive())&&(Oe[Gt]=$t)}}var vr={};for(var ir in this._previousActiveHandlers)Oe[ir]||(vr[ir]=X);this._previousActiveHandlers=Oe,(Object.keys(vr).length||jn(re))&&(this._changes.push([re,me,vr]),this._triggerRenderFrame()),(Object.keys(Oe).length||jn(re))&&this._map._stop(!0),this._updatingCamera=!1;var gr=re.cameraAnimation;gr&&(this._inertia.clear(),this._fireEvents({},{}),this._changes=[],gr(this._map))}else this.stop()},Va.prototype.mergeHandlerResult=function(Y,K,X,re,me){if(X){e.extend(Y,X);var Oe={handlerName:re,originalEvent:X.originalEvent||me};X.zoomDelta!==void 0&&(K.zoom=Oe),X.panDelta!==void 0&&(K.drag=Oe),X.pitchDelta!==void 0&&(K.pitch=Oe),X.bearingDelta!==void 0&&(K.rotate=Oe)}},Va.prototype._applyChanges=function(){for(var Y={},K={},X={},re=0,me=this._changes;re<me.length;re+=1){var Oe=me[re],Be=Oe[0],tt=Oe[1],ft=Oe[2];Be.panDelta&&(Y.panDelta=(Y.panDelta||new e.Point(0,0))._add(Be.panDelta)),Be.zoomDelta&&(Y.zoomDelta=(Y.zoomDelta||0)+Be.zoomDelta),Be.bearingDelta&&(Y.bearingDelta=(Y.bearingDelta||0)+Be.bearingDelta),Be.pitchDelta&&(Y.pitchDelta=(Y.pitchDelta||0)+Be.pitchDelta),Be.around!==void 0&&(Y.around=Be.around),Be.pinchAround!==void 0&&(Y.pinchAround=Be.pinchAround),Be.noInertia&&(Y.noInertia=Be.noInertia),e.extend(K,tt),e.extend(X,ft)}this._updateMapTransform(Y,K,X),this._changes=[]},Va.prototype._updateMapTransform=function(Y,K,X){var re=this._map,me=re.transform;if(!jn(Y))return this._fireEvents(K,X);var Oe=Y.panDelta,Be=Y.zoomDelta,tt=Y.bearingDelta,ft=Y.pitchDelta,St=Y.around,Ft=Y.pinchAround;Ft!==void 0&&(St=Ft),re._stop(!0),St=St||re.transform.centerPoint;var Gt=me.pointLocation(Oe?St.sub(Oe):St);tt&&(me.bearing+=tt),ft&&(me.pitch+=ft),Be&&(me.zoom+=Be),me.setLocationAtPoint(Gt,St),this._map._update(),Y.noInertia||this._inertia.record(Y),this._fireEvents(K,X)},Va.prototype._fireEvents=function(Y,K){var X=this,re=ps(this._eventsInProgress),me=ps(Y),Oe={};for(var Be in Y)this._eventsInProgress[Be]||(Oe[Be+"start"]=Y[Be].originalEvent),this._eventsInProgress[Be]=Y[Be];for(var tt in!re&&me&&this._fireEvent("movestart",me.originalEvent),Oe)this._fireEvent(tt,Oe[tt]);for(var ft in Y.rotate&&(this._bearingChanged=!0),me&&this._fireEvent("move",me.originalEvent),Y)this._fireEvent(ft,Y[ft].originalEvent);var St,Ft={};for(var Gt in this._eventsInProgress){var $t=this._eventsInProgress[Gt],sr=$t.handlerName,lr=$t.originalEvent;this._handlersById[sr].isActive()||(delete this._eventsInProgress[Gt],Ft[Gt+"end"]=St=K[sr]||lr)}for(var vr in Ft)this._fireEvent(vr,Ft[vr]);var ir=ps(this._eventsInProgress);if((re||me)&&!ir){this._updatingCamera=!0;var gr=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),Ar=function(Pr){return Pr!==0&&-X._bearingSnap<Pr&&Pr<X._bearingSnap};gr?(Ar(gr.bearing||this._map.getBearing())&&(gr.bearing=0),this._map.easeTo(gr,{originalEvent:St})):(this._map.fire(new e.Event("moveend",{originalEvent:St})),Ar(this._map.getBearing())&&this._map.resetNorth()),this._bearingChanged=!1,this._updatingCamera=!1}},Va.prototype._fireEvent=function(Y,K){this._map.fire(new e.Event(Y,K?{originalEvent:K}:{}))},Va.prototype._triggerRenderFrame=function(){var Y=this;this._frameId===void 0&&(this._frameId=this._map._requestRenderFrame(function(K){delete Y._frameId,Y.handleEvent(new Rn("renderFrame",{timeStamp:K})),Y._applyChanges()}))};var Js=function(Y){function K(X,re){Y.call(this),this._moving=!1,this._zooming=!1,this.transform=X,this._bearingSnap=re.bearingSnap,e.bindAll(["_renderFrameCallback"],this)}return Y&&(K.__proto__=Y),(K.prototype=Object.create(Y&&Y.prototype)).constructor=K,K.prototype.getCenter=function(){return new e.LngLat(this.transform.center.lng,this.transform.center.lat)},K.prototype.setCenter=function(X,re){return this.jumpTo({center:X},re)},K.prototype.panBy=function(X,re,me){return X=e.Point.convert(X).mult(-1),this.panTo(this.transform.center,e.extend({offset:X},re),me)},K.prototype.panTo=function(X,re,me){return this.easeTo(e.extend({center:X},re),me)},K.prototype.getZoom=function(){return this.transform.zoom},K.prototype.setZoom=function(X,re){return this.jumpTo({zoom:X},re),this},K.prototype.zoomTo=function(X,re,me){return this.easeTo(e.extend({zoom:X},re),me)},K.prototype.zoomIn=function(X,re){return this.zoomTo(this.getZoom()+1,X,re),this},K.prototype.zoomOut=function(X,re){return this.zoomTo(this.getZoom()-1,X,re),this},K.prototype.getBearing=function(){return this.transform.bearing},K.prototype.setBearing=function(X,re){return this.jumpTo({bearing:X},re),this},K.prototype.getPadding=function(){return this.transform.padding},K.prototype.setPadding=function(X,re){return this.jumpTo({padding:X},re),this},K.prototype.rotateTo=function(X,re,me){return this.easeTo(e.extend({bearing:X},re),me)},K.prototype.resetNorth=function(X,re){return this.rotateTo(0,e.extend({duration:1e3},X),re),this},K.prototype.resetNorthPitch=function(X,re){return this.easeTo(e.extend({bearing:0,pitch:0,duration:1e3},X),re),this},K.prototype.snapToNorth=function(X,re){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(X,re):this},K.prototype.getPitch=function(){return this.transform.pitch},K.prototype.setPitch=function(X,re){return this.jumpTo({pitch:X},re),this},K.prototype.cameraForBounds=function(X,re){return X=e.LngLatBounds.convert(X),this._cameraForBoxAndBearing(X.getNorthWest(),X.getSouthEast(),0,re)},K.prototype._cameraForBoxAndBearing=function(X,re,me,Oe){var Be={top:0,bottom:0,right:0,left:0};if(typeof(Oe=e.extend({padding:Be,offset:[0,0],maxZoom:this.transform.maxZoom},Oe)).padding=="number"){var tt=Oe.padding;Oe.padding={top:tt,bottom:tt,right:tt,left:tt}}Oe.padding=e.extend(Be,Oe.padding);var ft=this.transform,St=ft.padding,Ft=ft.project(e.LngLat.convert(X)),Gt=ft.project(e.LngLat.convert(re)),$t=Ft.rotate(-me*Math.PI/180),sr=Gt.rotate(-me*Math.PI/180),lr=new e.Point(Math.max($t.x,sr.x),Math.max($t.y,sr.y)),vr=new e.Point(Math.min($t.x,sr.x),Math.min($t.y,sr.y)),ir=lr.sub(vr),gr=(ft.width-(St.left+St.right+Oe.padding.left+Oe.padding.right))/ir.x,Ar=(ft.height-(St.top+St.bottom+Oe.padding.top+Oe.padding.bottom))/ir.y;if(!(Ar<0||gr<0)){var Pr=Math.min(ft.scaleZoom(ft.scale*Math.min(gr,Ar)),Oe.maxZoom),Gr=e.Point.convert(Oe.offset),Fr=new e.Point(Gr.x+(Oe.padding.left-Oe.padding.right)/2,Gr.y+(Oe.padding.top-Oe.padding.bottom)/2).mult(ft.scale/ft.zoomScale(Pr));return{center:ft.unproject(Ft.add(Gt).div(2).sub(Fr)),zoom:Pr,bearing:me}}e.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},K.prototype.fitBounds=function(X,re,me){return this._fitInternal(this.cameraForBounds(X,re),re,me)},K.prototype.fitScreenCoordinates=function(X,re,me,Oe,Be){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(e.Point.convert(X)),this.transform.pointLocation(e.Point.convert(re)),me,Oe),Oe,Be)},K.prototype._fitInternal=function(X,re,me){return X?(delete(re=e.extend(X,re)).padding,re.linear?this.easeTo(re,me):this.flyTo(re,me)):this},K.prototype.jumpTo=function(X,re){this.stop();var me=this.transform,Oe=!1,Be=!1,tt=!1;return"zoom"in X&&me.zoom!==+X.zoom&&(Oe=!0,me.zoom=+X.zoom),X.center!==void 0&&(me.center=e.LngLat.convert(X.center)),"bearing"in X&&me.bearing!==+X.bearing&&(Be=!0,me.bearing=+X.bearing),"pitch"in X&&me.pitch!==+X.pitch&&(tt=!0,me.pitch=+X.pitch),X.padding==null||me.isPaddingEqual(X.padding)||(me.padding=X.padding),this.fire(new e.Event("movestart",re)).fire(new e.Event("move",re)),Oe&&this.fire(new e.Event("zoomstart",re)).fire(new e.Event("zoom",re)).fire(new e.Event("zoomend",re)),Be&&this.fire(new e.Event("rotatestart",re)).fire(new e.Event("rotate",re)).fire(new e.Event("rotateend",re)),tt&&this.fire(new e.Event("pitchstart",re)).fire(new e.Event("pitch",re)).fire(new e.Event("pitchend",re)),this.fire(new e.Event("moveend",re))},K.prototype.easeTo=function(X,re){var me=this;this._stop(!1,X.easeId),((X=e.extend({offset:[0,0],duration:500,easing:e.ease},X)).animate===!1||!X.essential&&e.browser.prefersReducedMotion)&&(X.duration=0);var Oe=this.transform,Be=this.getZoom(),tt=this.getBearing(),ft=this.getPitch(),St=this.getPadding(),Ft="zoom"in X?+X.zoom:Be,Gt="bearing"in X?this._normalizeBearing(X.bearing,tt):tt,$t="pitch"in X?+X.pitch:ft,sr="padding"in X?X.padding:Oe.padding,lr=e.Point.convert(X.offset),vr=Oe.centerPoint.add(lr),ir=Oe.pointLocation(vr),gr=e.LngLat.convert(X.center||ir);this._normalizeCenter(gr);var Ar,Pr,Gr=Oe.project(ir),Fr=Oe.project(gr).sub(Gr),Yr=Oe.zoomScale(Ft-Be);X.around&&(Ar=e.LngLat.convert(X.around),Pr=Oe.locationPoint(Ar));var an={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||Ft!==Be,this._rotating=this._rotating||tt!==Gt,this._pitching=this._pitching||$t!==ft,this._padding=!Oe.isPaddingEqual(sr),this._easeId=X.easeId,this._prepareEase(re,X.noMoveStart,an),clearTimeout(this._easeEndTimeoutID),this._ease(function(mn){if(me._zooming&&(Oe.zoom=e.number(Be,Ft,mn)),me._rotating&&(Oe.bearing=e.number(tt,Gt,mn)),me._pitching&&(Oe.pitch=e.number(ft,$t,mn)),me._padding&&(Oe.interpolatePadding(St,sr,mn),vr=Oe.centerPoint.add(lr)),Ar)Oe.setLocationAtPoint(Ar,Pr);else{var pn=Oe.zoomScale(Oe.zoom-Be),xn=Ft>Be?Math.min(2,Yr):Math.max(.5,Yr),Ln=Math.pow(xn,1-mn),Jn=Oe.unproject(Gr.add(Fr.mult(mn*Ln)).mult(pn));Oe.setLocationAtPoint(Oe.renderWorldCopies?Jn.wrap():Jn,vr)}me._fireMoveEvents(re)},function(mn){me._afterEase(re,mn)},X),this},K.prototype._prepareEase=function(X,re,me){me===void 0&&(me={}),this._moving=!0,re||me.moving||this.fire(new e.Event("movestart",X)),this._zooming&&!me.zooming&&this.fire(new e.Event("zoomstart",X)),this._rotating&&!me.rotating&&this.fire(new e.Event("rotatestart",X)),this._pitching&&!me.pitching&&this.fire(new e.Event("pitchstart",X))},K.prototype._fireMoveEvents=function(X){this.fire(new e.Event("move",X)),this._zooming&&this.fire(new e.Event("zoom",X)),this._rotating&&this.fire(new e.Event("rotate",X)),this._pitching&&this.fire(new e.Event("pitch",X))},K.prototype._afterEase=function(X,re){if(!this._easeId||!re||this._easeId!==re){delete this._easeId;var me=this._zooming,Oe=this._rotating,Be=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,me&&this.fire(new e.Event("zoomend",X)),Oe&&this.fire(new e.Event("rotateend",X)),Be&&this.fire(new e.Event("pitchend",X)),this.fire(new e.Event("moveend",X))}},K.prototype.flyTo=function(X,re){var me=this;if(!X.essential&&e.browser.prefersReducedMotion){var Oe=e.pick(X,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Oe,re)}this.stop(),X=e.extend({offset:[0,0],speed:1.2,curve:1.42,easing:e.ease},X);var Be=this.transform,tt=this.getZoom(),ft=this.getBearing(),St=this.getPitch(),Ft=this.getPadding(),Gt="zoom"in X?e.clamp(+X.zoom,Be.minZoom,Be.maxZoom):tt,$t="bearing"in X?this._normalizeBearing(X.bearing,ft):ft,sr="pitch"in X?+X.pitch:St,lr="padding"in X?X.padding:Be.padding,vr=Be.zoomScale(Gt-tt),ir=e.Point.convert(X.offset),gr=Be.centerPoint.add(ir),Ar=Be.pointLocation(gr),Pr=e.LngLat.convert(X.center||Ar);this._normalizeCenter(Pr);var Gr=Be.project(Ar),Fr=Be.project(Pr).sub(Gr),Yr=X.curve,an=Math.max(Be.width,Be.height),mn=an/vr,pn=Fr.mag();if("minZoom"in X){var xn=e.clamp(Math.min(X.minZoom,tt,Gt),Be.minZoom,Be.maxZoom),Ln=an/Be.zoomScale(xn-tt);Yr=Math.sqrt(Ln/pn*2)}var Jn=Yr*Yr;function Vn(Zn){var qn=(mn*mn-an*an+(Zn?-1:1)*Jn*Jn*pn*pn)/(2*(Zn?mn:an)*Jn*pn);return Math.log(Math.sqrt(qn*qn+1)-qn)}function oa(Zn){return(Math.exp(Zn)-Math.exp(-Zn))/2}function Sn(Zn){return(Math.exp(Zn)+Math.exp(-Zn))/2}var ra=Vn(0),sa=function(Zn){return Sn(ra)/Sn(ra+Yr*Zn)},Hn=function(Zn){return an*((Sn(ra)*(oa(qn=ra+Yr*Zn)/Sn(qn))-oa(ra))/Jn)/pn;var qn},Gn=(Vn(1)-ra)/Yr;if(Math.abs(pn)<1e-6||!isFinite(Gn)){if(Math.abs(an-mn)<1e-6)return this.easeTo(X,re);var $n=mn<an?-1:1;Gn=Math.abs(Math.log(mn/an))/Yr,Hn=function(){return 0},sa=function(Zn){return Math.exp($n*Yr*Zn)}}return X.duration="duration"in X?+X.duration:1e3*Gn/("screenSpeed"in X?+X.screenSpeed/Yr:+X.speed),X.maxDuration&&X.duration>X.maxDuration&&(X.duration=0),this._zooming=!0,this._rotating=ft!==$t,this._pitching=sr!==St,this._padding=!Be.isPaddingEqual(lr),this._prepareEase(re,!1),this._ease(function(Zn){var qn=Zn*Gn,fi=1/sa(qn);Be.zoom=Zn===1?Gt:tt+Be.scaleZoom(fi),me._rotating&&(Be.bearing=e.number(ft,$t,Zn)),me._pitching&&(Be.pitch=e.number(St,sr,Zn)),me._padding&&(Be.interpolatePadding(Ft,lr,Zn),gr=Be.centerPoint.add(ir));var Fa=Zn===1?Pr:Be.unproject(Gr.add(Fr.mult(Hn(qn))).mult(fi));Be.setLocationAtPoint(Be.renderWorldCopies?Fa.wrap():Fa,gr),me._fireMoveEvents(re)},function(){return me._afterEase(re)},X),this},K.prototype.isEasing=function(){return!!this._easeFrameId},K.prototype.stop=function(){return this._stop()},K.prototype._stop=function(X,re){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var me=this._onEaseEnd;delete this._onEaseEnd,me.call(this,re)}if(!X){var Oe=this.handlers;Oe&&Oe.stop()}return this},K.prototype._ease=function(X,re,me){me.animate===!1||me.duration===0?(X(1),re()):(this._easeStart=e.browser.now(),this._easeOptions=me,this._onEaseFrame=X,this._onEaseEnd=re,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},K.prototype._renderFrameCallback=function(){var X=Math.min((e.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(X)),X<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},K.prototype._normalizeBearing=function(X,re){X=e.wrap(X,-180,180);var me=Math.abs(X-re);return Math.abs(X-360-re)<me&&(X-=360),Math.abs(X+360-re)<me&&(X+=360),X},K.prototype._normalizeCenter=function(X){var re=this.transform;if(re.renderWorldCopies&&!re.lngRange){var me=X.lng-re.center.lng;X.lng+=me>180?-360:me<-180?360:0}},K}(e.Evented),Ji=function(Y){Y===void 0&&(Y={}),this.options=Y,e.bindAll(["_updateEditLink","_updateData","_updateCompact"],this)};Ji.prototype.getDefaultPosition=function(){return"bottom-right"},Ji.prototype.onAdd=function(Y){var K=this.options&&this.options.compact;return this._map=Y,this._container=r.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._innerContainer=r.create("div","mapboxgl-ctrl-attrib-inner",this._container),K&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),K===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},Ji.prototype.onRemove=function(){r.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},Ji.prototype._updateEditLink=function(){var Y=this._editLink;Y||(Y=this._editLink=this._container.querySelector(".mapbox-improve-map"));var K=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||e.config.ACCESS_TOKEN}];if(Y){var X=K.reduce(function(re,me,Oe){return me.value&&(re+=me.key+"="+me.value+(Oe<K.length-1?"&":"")),re},"?");Y.href=e.config.FEEDBACK_URL+"/"+X+(this._map._hash?this._map._hash.getHashString(!0):""),Y.rel="noopener nofollow"}},Ji.prototype._updateData=function(Y){!Y||Y.sourceDataType!=="metadata"&&Y.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())},Ji.prototype._updateAttributions=function(){if(this._map.style){var Y=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?Y=Y.concat(this.options.customAttribution.map(function(tt){return typeof tt!="string"?"":tt})):typeof this.options.customAttribution=="string"&&Y.push(this.options.customAttribution)),this._map.style.stylesheet){var K=this._map.style.stylesheet;this.styleOwner=K.owner,this.styleId=K.id}var X=this._map.style.sourceCaches;for(var re in X){var me=X[re];if(me.used){var Oe=me.getSource();Oe.attribution&&Y.indexOf(Oe.attribution)<0&&Y.push(Oe.attribution)}}Y.sort(function(tt,ft){return tt.length-ft.length});var Be=(Y=Y.filter(function(tt,ft){for(var St=ft+1;St<Y.length;St++)if(Y[St].indexOf(tt)>=0)return!1;return!0})).join(" | ");Be!==this._attribHTML&&(this._attribHTML=Be,Y.length?(this._innerContainer.innerHTML=Be,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},Ji.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact")};var ai=function(){e.bindAll(["_updateLogo"],this),e.bindAll(["_updateCompact"],this)};ai.prototype.onAdd=function(Y){this._map=Y,this._container=r.create("div","mapboxgl-ctrl");var K=r.create("a","mapboxgl-ctrl-logo");return K.target="_blank",K.rel="noopener nofollow",K.href="https://www.mapbox.com/",K.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),K.setAttribute("rel","noopener nofollow"),this._container.appendChild(K),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},ai.prototype.onRemove=function(){r.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},ai.prototype.getDefaultPosition=function(){return"bottom-left"},ai.prototype._updateLogo=function(Y){Y&&Y.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")},ai.prototype._logoRequired=function(){if(this._map.style){var Y=this._map.style.sourceCaches;for(var K in Y)if(Y[K].getSource().mapbox_logo)return!0;return!1}},ai.prototype._updateCompact=function(){var Y=this._container.children;if(Y.length){var K=Y[0];this._map.getCanvasContainer().offsetWidth<250?K.classList.add("mapboxgl-compact"):K.classList.remove("mapboxgl-compact")}};var Vi=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};Vi.prototype.add=function(Y){var K=++this._id;return this._queue.push({callback:Y,id:K,cancelled:!1}),K},Vi.prototype.remove=function(Y){for(var K=this._currentlyRunning,X=0,re=K?this._queue.concat(K):this._queue;X<re.length;X+=1){var me=re[X];if(me.id===Y)return void(me.cancelled=!0)}},Vi.prototype.run=function(Y){Y===void 0&&(Y=0);var K=this._currentlyRunning=this._queue;this._queue=[];for(var X=0,re=K;X<re.length;X+=1){var me=re[X];if(!me.cancelled&&(me.callback(Y),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},Vi.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var Nc={"FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},Ks=e.window.HTMLImageElement,da=e.window.HTMLElement,Ma=e.window.ImageBitmap,jc={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},Qs=function(Y){function K(re){var me=this;if((re=e.extend({},jc,re)).minZoom!=null&&re.maxZoom!=null&&re.minZoom>re.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(re.minPitch!=null&&re.maxPitch!=null&&re.minPitch>re.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(re.minPitch!=null&&re.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(re.maxPitch!=null&&re.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var Oe=new fa(re.minZoom,re.maxZoom,re.minPitch,re.maxPitch,re.renderWorldCopies);if(Y.call(this,Oe,re),this._interactive=re.interactive,this._maxTileCacheSize=re.maxTileCacheSize,this._failIfMajorPerformanceCaveat=re.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=re.preserveDrawingBuffer,this._antialias=re.antialias,this._trackResize=re.trackResize,this._bearingSnap=re.bearingSnap,this._refreshExpiredTiles=re.refreshExpiredTiles,this._fadeDuration=re.fadeDuration,this._crossSourceCollisions=re.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=re.collectResourceTiming,this._renderTaskQueue=new Vi,this._controls=[],this._mapId=e.uniqueId(),this._locale=e.extend({},Nc,re.locale),this._requestManager=new e.RequestManager(re.transformRequest,re.accessToken),typeof re.container=="string"){if(this._container=e.window.document.getElementById(re.container),!this._container)throw new Error("Container '"+re.container+"' not found.")}else{if(!(re.container instanceof da))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=re.container}if(re.maxBounds&&this.setMaxBounds(re.maxBounds),e.bindAll(["_onWindowOnline","_onWindowResize","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return me._update(!1)}),this.on("moveend",function(){return me._update(!1)}),this.on("zoom",function(){return me._update(!0)}),e.window!==void 0&&(e.window.addEventListener("online",this._onWindowOnline,!1),e.window.addEventListener("resize",this._onWindowResize,!1)),this.handlers=new Va(this,re),this._hash=re.hash&&new ui(typeof re.hash=="string"&&re.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:re.center,zoom:re.zoom,bearing:re.bearing,pitch:re.pitch}),re.bounds&&(this.resize(),this.fitBounds(re.bounds,e.extend({},re.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=re.localIdeographFontFamily,re.style&&this.setStyle(re.style,{localIdeographFontFamily:re.localIdeographFontFamily}),re.attributionControl&&this.addControl(new Ji({customAttribution:re.customAttribution})),this.addControl(new ai,re.logoPosition),this.on("style.load",function(){me.transform.unmodified&&me.jumpTo(me.style.stylesheet)}),this.on("data",function(Be){me._update(Be.dataType==="style"),me.fire(new e.Event(Be.dataType+"data",Be))}),this.on("dataloading",function(Be){me.fire(new e.Event(Be.dataType+"dataloading",Be))})}Y&&(K.__proto__=Y),(K.prototype=Object.create(Y&&Y.prototype)).constructor=K;var X={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return K.prototype._getMapId=function(){return this._mapId},K.prototype.addControl=function(re,me){if(me===void 0&&re.getDefaultPosition&&(me=re.getDefaultPosition()),me===void 0&&(me="top-right"),!re||!re.onAdd)return this.fire(new e.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var Oe=re.onAdd(this);this._controls.push(re);var Be=this._controlPositions[me];return me.indexOf("bottom")!==-1?Be.insertBefore(Oe,Be.firstChild):Be.appendChild(Oe),this},K.prototype.removeControl=function(re){if(!re||!re.onRemove)return this.fire(new e.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var me=this._controls.indexOf(re);return me>-1&&this._controls.splice(me,1),re.onRemove(this),this},K.prototype.resize=function(re){var me=this._containerDimensions(),Oe=me[0],Be=me[1];this._resizeCanvas(Oe,Be),this.transform.resize(Oe,Be),this.painter.resize(Oe,Be);var tt=!this._moving;return tt&&(this.stop(),this.fire(new e.Event("movestart",re)).fire(new e.Event("move",re))),this.fire(new e.Event("resize",re)),tt&&this.fire(new e.Event("moveend",re)),this},K.prototype.getBounds=function(){return this.transform.getBounds()},K.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},K.prototype.setMaxBounds=function(re){return this.transform.setMaxBounds(e.LngLatBounds.convert(re)),this._update()},K.prototype.setMinZoom=function(re){if((re=re??-2)>=-2&&re<=this.transform.maxZoom)return this.transform.minZoom=re,this._update(),this.getZoom()<re&&this.setZoom(re),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},K.prototype.getMinZoom=function(){return this.transform.minZoom},K.prototype.setMaxZoom=function(re){if((re=re??22)>=this.transform.minZoom)return this.transform.maxZoom=re,this._update(),this.getZoom()>re&&this.setZoom(re),this;throw new Error("maxZoom must be greater than the current minZoom")},K.prototype.getMaxZoom=function(){return this.transform.maxZoom},K.prototype.setMinPitch=function(re){if((re=re??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(re>=0&&re<=this.transform.maxPitch)return this.transform.minPitch=re,this._update(),this.getPitch()<re&&this.setPitch(re),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},K.prototype.getMinPitch=function(){return this.transform.minPitch},K.prototype.setMaxPitch=function(re){if((re=re??60)>60)throw new Error("maxPitch must be less than or equal to 60");if(re>=this.transform.minPitch)return this.transform.maxPitch=re,this._update(),this.getPitch()>re&&this.setPitch(re),this;throw new Error("maxPitch must be greater than the current minPitch")},K.prototype.getMaxPitch=function(){return this.transform.maxPitch},K.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},K.prototype.setRenderWorldCopies=function(re){return this.transform.renderWorldCopies=re,this._update()},K.prototype.project=function(re){return this.transform.locationPoint(e.LngLat.convert(re))},K.prototype.unproject=function(re){return this.transform.pointLocation(e.Point.convert(re))},K.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},K.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},K.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},K.prototype._createDelegatedListener=function(re,me,Oe){var Be,tt=this;if(re==="mouseenter"||re==="mouseover"){var ft=!1;return{layer:me,listener:Oe,delegates:{mousemove:function(Ft){var Gt=tt.getLayer(me)?tt.queryRenderedFeatures(Ft.point,{layers:[me]}):[];Gt.length?ft||(ft=!0,Oe.call(tt,new Ni(re,tt,Ft.originalEvent,{features:Gt}))):ft=!1},mouseout:function(){ft=!1}}}}if(re==="mouseleave"||re==="mouseout"){var St=!1;return{layer:me,listener:Oe,delegates:{mousemove:function(Ft){(tt.getLayer(me)?tt.queryRenderedFeatures(Ft.point,{layers:[me]}):[]).length?St=!0:St&&(St=!1,Oe.call(tt,new Ni(re,tt,Ft.originalEvent)))},mouseout:function(Ft){St&&(St=!1,Oe.call(tt,new Ni(re,tt,Ft.originalEvent)))}}}}return{layer:me,listener:Oe,delegates:(Be={},Be[re]=function(Ft){var Gt=tt.getLayer(me)?tt.queryRenderedFeatures(Ft.point,{layers:[me]}):[];Gt.length&&(Ft.features=Gt,Oe.call(tt,Ft),delete Ft.features)},Be)}},K.prototype.on=function(re,me,Oe){if(Oe===void 0)return Y.prototype.on.call(this,re,me);var Be=this._createDelegatedListener(re,me,Oe);for(var tt in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[re]=this._delegatedListeners[re]||[],this._delegatedListeners[re].push(Be),Be.delegates)this.on(tt,Be.delegates[tt]);return this},K.prototype.once=function(re,me,Oe){if(Oe===void 0)return Y.prototype.once.call(this,re,me);var Be=this._createDelegatedListener(re,me,Oe);for(var tt in Be.delegates)this.once(tt,Be.delegates[tt]);return this},K.prototype.off=function(re,me,Oe){var Be=this;return Oe===void 0?Y.prototype.off.call(this,re,me):(this._delegatedListeners&&this._delegatedListeners[re]&&function(tt){for(var ft=tt[re],St=0;St<ft.length;St++){var Ft=ft[St];if(Ft.layer===me&&Ft.listener===Oe){for(var Gt in Ft.delegates)Be.off(Gt,Ft.delegates[Gt]);return ft.splice(St,1),Be}}}(this._delegatedListeners),this)},K.prototype.queryRenderedFeatures=function(re,me){if(!this.style)return[];var Oe;if(me!==void 0||re===void 0||re instanceof e.Point||Array.isArray(re)||(me=re,re=void 0),me=me||{},(re=re||[[0,0],[this.transform.width,this.transform.height]])instanceof e.Point||typeof re[0]=="number")Oe=[e.Point.convert(re)];else{var Be=e.Point.convert(re[0]),tt=e.Point.convert(re[1]);Oe=[Be,new e.Point(tt.x,Be.y),tt,new e.Point(Be.x,tt.y),Be]}return this.style.queryRenderedFeatures(Oe,me,this.transform)},K.prototype.querySourceFeatures=function(re,me){return this.style.querySourceFeatures(re,me)},K.prototype.setStyle=function(re,me){return(me=e.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},me)).diff!==!1&&me.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&re?(this._diffStyle(re,me),this):(this._localIdeographFontFamily=me.localIdeographFontFamily,this._updateStyle(re,me))},K.prototype._getUIString=function(re){var me=this._locale[re];if(me==null)throw new Error("Missing UI string '"+re+"'");return me},K.prototype._updateStyle=function(re,me){return this.style&&(this.style.setEventedParent(null),this.style._remove()),re?(this.style=new na(this,me||{}),this.style.setEventedParent(this,{style:this.style}),typeof re=="string"?this.style.loadURL(re):this.style.loadJSON(re),this):(delete this.style,this)},K.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new na(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},K.prototype._diffStyle=function(re,me){var Oe=this;if(typeof re=="string"){var Be=this._requestManager.normalizeStyleURL(re),tt=this._requestManager.transformRequest(Be,e.ResourceType.Style);e.getJSON(tt,function(ft,St){ft?Oe.fire(new e.ErrorEvent(ft)):St&&Oe._updateDiff(St,me)})}else typeof re=="object"&&this._updateDiff(re,me)},K.prototype._updateDiff=function(re,me){try{this.style.setState(re)&&this._update(!0)}catch(Oe){e.warnOnce("Unable to perform style diff: "+(Oe.message||Oe.error||Oe)+".  Rebuilding the style from scratch."),this._updateStyle(re,me)}},K.prototype.getStyle=function(){if(this.style)return this.style.serialize()},K.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():e.warnOnce("There is no style added to the map.")},K.prototype.addSource=function(re,me){return this._lazyInitEmptyStyle(),this.style.addSource(re,me),this._update(!0)},K.prototype.isSourceLoaded=function(re){var me=this.style&&this.style.sourceCaches[re];if(me!==void 0)return me.loaded();this.fire(new e.ErrorEvent(new Error("There is no source with ID '"+re+"'")))},K.prototype.areTilesLoaded=function(){var re=this.style&&this.style.sourceCaches;for(var me in re){var Oe=re[me]._tiles;for(var Be in Oe){var tt=Oe[Be];if(tt.state!=="loaded"&&tt.state!=="errored")return!1}}return!0},K.prototype.addSourceType=function(re,me,Oe){return this._lazyInitEmptyStyle(),this.style.addSourceType(re,me,Oe)},K.prototype.removeSource=function(re){return this.style.removeSource(re),this._update(!0)},K.prototype.getSource=function(re){return this.style.getSource(re)},K.prototype.addImage=function(re,me,Oe){Oe===void 0&&(Oe={});var Be=Oe.pixelRatio;Be===void 0&&(Be=1);var tt=Oe.sdf;tt===void 0&&(tt=!1);var ft=Oe.stretchX,St=Oe.stretchY,Ft=Oe.content;if(this._lazyInitEmptyStyle(),me instanceof Ks||Ma&&me instanceof Ma){var Gt=e.browser.getImageData(me);this.style.addImage(re,{data:new e.RGBAImage({width:Gt.width,height:Gt.height},Gt.data),pixelRatio:Be,stretchX:ft,stretchY:St,content:Ft,sdf:tt,version:0})}else{if(me.width===void 0||me.height===void 0)return this.fire(new e.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var $t=me;this.style.addImage(re,{data:new e.RGBAImage({width:me.width,height:me.height},new Uint8Array(me.data)),pixelRatio:Be,stretchX:ft,stretchY:St,content:Ft,sdf:tt,version:0,userImage:$t}),$t.onAdd&&$t.onAdd(this,re)}},K.prototype.updateImage=function(re,me){var Oe=this.style.getImage(re);if(!Oe)return this.fire(new e.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var Be=me instanceof Ks||Ma&&me instanceof Ma?e.browser.getImageData(me):me,tt=Be.width,ft=Be.height,St=Be.data;return tt===void 0||ft===void 0?this.fire(new e.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):tt!==Oe.data.width||ft!==Oe.data.height?this.fire(new e.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(Oe.data.replace(St,!(me instanceof Ks||Ma&&me instanceof Ma)),void this.style.updateImage(re,Oe))},K.prototype.hasImage=function(re){return re?!!this.style.getImage(re):(this.fire(new e.ErrorEvent(new Error("Missing required image id"))),!1)},K.prototype.removeImage=function(re){this.style.removeImage(re)},K.prototype.loadImage=function(re,me){e.getImage(this._requestManager.transformRequest(re,e.ResourceType.Image),me)},K.prototype.listImages=function(){return this.style.listImages()},K.prototype.addLayer=function(re,me){return this._lazyInitEmptyStyle(),this.style.addLayer(re,me),this._update(!0)},K.prototype.moveLayer=function(re,me){return this.style.moveLayer(re,me),this._update(!0)},K.prototype.removeLayer=function(re){return this.style.removeLayer(re),this._update(!0)},K.prototype.getLayer=function(re){return this.style.getLayer(re)},K.prototype.setLayerZoomRange=function(re,me,Oe){return this.style.setLayerZoomRange(re,me,Oe),this._update(!0)},K.prototype.setFilter=function(re,me,Oe){return Oe===void 0&&(Oe={}),this.style.setFilter(re,me,Oe),this._update(!0)},K.prototype.getFilter=function(re){return this.style.getFilter(re)},K.prototype.setPaintProperty=function(re,me,Oe,Be){return Be===void 0&&(Be={}),this.style.setPaintProperty(re,me,Oe,Be),this._update(!0)},K.prototype.getPaintProperty=function(re,me){return this.style.getPaintProperty(re,me)},K.prototype.setLayoutProperty=function(re,me,Oe,Be){return Be===void 0&&(Be={}),this.style.setLayoutProperty(re,me,Oe,Be),this._update(!0)},K.prototype.getLayoutProperty=function(re,me){return this.style.getLayoutProperty(re,me)},K.prototype.setLight=function(re,me){return me===void 0&&(me={}),this._lazyInitEmptyStyle(),this.style.setLight(re,me),this._update(!0)},K.prototype.getLight=function(){return this.style.getLight()},K.prototype.setFeatureState=function(re,me){return this.style.setFeatureState(re,me),this._update()},K.prototype.removeFeatureState=function(re,me){return this.style.removeFeatureState(re,me),this._update()},K.prototype.getFeatureState=function(re){return this.style.getFeatureState(re)},K.prototype.getContainer=function(){return this._container},K.prototype.getCanvasContainer=function(){return this._canvasContainer},K.prototype.getCanvas=function(){return this._canvas},K.prototype._containerDimensions=function(){var re=0,me=0;return this._container&&(re=this._container.clientWidth||400,me=this._container.clientHeight||300),[re,me]},K.prototype._detectMissingCSS=function(){e.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&e.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},K.prototype._setupContainer=function(){var re=this._container;re.classList.add("mapboxgl-map"),(this._missingCSSCanary=r.create("div","mapboxgl-canary",re)).style.visibility="hidden",this._detectMissingCSS();var me=this._canvasContainer=r.create("div","mapboxgl-canvas-container",re);this._interactive&&me.classList.add("mapboxgl-interactive"),this._canvas=r.create("canvas","mapboxgl-canvas",me),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map");var Oe=this._containerDimensions();this._resizeCanvas(Oe[0],Oe[1]);var Be=this._controlContainer=r.create("div","mapboxgl-control-container",re),tt=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(ft){tt[ft]=r.create("div","mapboxgl-ctrl-"+ft,Be)})},K.prototype._resizeCanvas=function(re,me){var Oe=e.browser.devicePixelRatio||1;this._canvas.width=Oe*re,this._canvas.height=Oe*me,this._canvas.style.width=re+"px",this._canvas.style.height=me+"px"},K.prototype._setupPainter=function(){var re=e.extend({},o.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),me=this._canvas.getContext("webgl",re)||this._canvas.getContext("experimental-webgl",re);me?(this.painter=new Aa(me,this.transform),e.webpSupported.testSupport(me)):this.fire(new e.ErrorEvent(new Error("Failed to initialize WebGL")))},K.prototype._contextLost=function(re){re.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new e.Event("webglcontextlost",{originalEvent:re}))},K.prototype._contextRestored=function(re){this._setupPainter(),this.resize(),this._update(),this.fire(new e.Event("webglcontextrestored",{originalEvent:re}))},K.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},K.prototype._update=function(re){return this.style?(this._styleDirty=this._styleDirty||re,this._sourcesDirty=!0,this.triggerRepaint(),this):this},K.prototype._requestRenderFrame=function(re){return this._update(),this._renderTaskQueue.add(re)},K.prototype._cancelRenderFrame=function(re){this._renderTaskQueue.remove(re)},K.prototype._render=function(re){var me,Oe=this,Be=0,tt=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(me=tt.createQueryEXT(),tt.beginQueryEXT(tt.TIME_ELAPSED_EXT,me),Be=e.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(re),!this._removed){var ft=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var St=this.transform.zoom,Ft=e.browser.now();this.style.zoomHistory.update(St,Ft);var Gt=new e.EvaluationParameters(St,{now:Ft,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),$t=Gt.crossFadingFactor();$t===1&&$t===this._crossFadingFactor||(ft=!0,this._crossFadingFactor=$t),this.style.update(Gt)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new e.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new e.Event("load"))),this.style&&(this.style.hasTransitions()||ft)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var sr=e.browser.now()-Be;tt.endQueryEXT(tt.TIME_ELAPSED_EXT,me),setTimeout(function(){var vr=tt.getQueryObjectEXT(me,tt.QUERY_RESULT_EXT)/1e6;tt.deleteQueryEXT(me),Oe.fire(new e.Event("gpu-timing-frame",{cpuTime:sr,gpuTime:vr}))},50)}if(this.listens("gpu-timing-layer")){var lr=this.painter.collectGpuTimers();setTimeout(function(){var vr=Oe.painter.queryGpuTimers(lr);Oe.fire(new e.Event("gpu-timing-layer",{layerTimes:vr}))},50)}return this._sourcesDirty||this._styleDirty||this._placementDirty||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&(this._fullyLoaded||(this._fullyLoaded=!0),this.fire(new e.Event("idle"))),this}},K.prototype.remove=function(){this._hash&&this._hash.remove();for(var re=0,me=this._controls;re<me.length;re+=1)me[re].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),e.window!==void 0&&(e.window.removeEventListener("resize",this._onWindowResize,!1),e.window.removeEventListener("online",this._onWindowOnline,!1));var Oe=this.painter.context.gl.getExtension("WEBGL_lose_context");Oe&&Oe.loseContext(),is(this._canvasContainer),is(this._controlContainer),is(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new e.Event("remove"))},K.prototype.triggerRepaint=function(){var re=this;this.style&&!this._frame&&(this._frame=e.browser.frame(function(me){re._frame=null,re._render(me)}))},K.prototype._onWindowOnline=function(){this._update()},K.prototype._onWindowResize=function(re){this._trackResize&&this.resize({originalEvent:re})._update()},X.showTileBoundaries.get=function(){return!!this._showTileBoundaries},X.showTileBoundaries.set=function(re){this._showTileBoundaries!==re&&(this._showTileBoundaries=re,this._update())},X.showPadding.get=function(){return!!this._showPadding},X.showPadding.set=function(re){this._showPadding!==re&&(this._showPadding=re,this._update())},X.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},X.showCollisionBoxes.set=function(re){this._showCollisionBoxes!==re&&(this._showCollisionBoxes=re,re?this.style._generateCollisionBoxes():this._update())},X.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},X.showOverdrawInspector.set=function(re){this._showOverdrawInspector!==re&&(this._showOverdrawInspector=re,this._update())},X.repaint.get=function(){return!!this._repaint},X.repaint.set=function(re){this._repaint!==re&&(this._repaint=re,this.triggerRepaint())},X.vertices.get=function(){return!!this._vertices},X.vertices.set=function(re){this._vertices=re,this._update()},K.prototype._setCacheLimits=function(re,me){e.setCacheLimits(re,me)},X.version.get=function(){return e.version},Object.defineProperties(K.prototype,X),K}(Js);function is(Y){Y.parentNode&&Y.parentNode.removeChild(Y)}var dc={showCompass:!0,showZoom:!0,visualizePitch:!1},po=function(Y){var K=this;this.options=e.extend({},dc,Y),this._container=r.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(X){return X.preventDefault()}),this.options.showZoom&&(e.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(X){return K._map.zoomIn({},{originalEvent:X})}),r.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(X){return K._map.zoomOut({},{originalEvent:X})}),r.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(e.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(X){K.options.visualizePitch?K._map.resetNorthPitch({},{originalEvent:X}):K._map.resetNorth({},{originalEvent:X})}),this._compassIcon=r.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};po.prototype._updateZoomButtons=function(){var Y=this._map.getZoom();this._zoomInButton.disabled=Y===this._map.getMaxZoom(),this._zoomOutButton.disabled=Y===this._map.getMinZoom()},po.prototype._rotateCompassArrow=function(){var Y=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=Y},po.prototype.onAdd=function(Y){return this._map=Y,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new qa(this._map,this._compass,this.options.visualizePitch)),this._container},po.prototype.onRemove=function(){r.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},po.prototype._createButton=function(Y,K){var X=r.create("button",Y,this._container);return X.type="button",X.addEventListener("click",K),X},po.prototype._setButtonTitle=function(Y,K){var X=this._map._getUIString("NavigationControl."+K);Y.title=X,Y.setAttribute("aria-label",X)};var qa=function(Y,K,X){X===void 0&&(X=!1),this._clickTolerance=10,this.element=K,this.mouseRotate=new Hl({clickTolerance:Y.dragRotate._mouseRotate._clickTolerance}),this.map=Y,X&&(this.mousePitch=new Zs({clickTolerance:Y.dragRotate._mousePitch._clickTolerance})),e.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),r.addEventListener(K,"mousedown",this.mousedown),r.addEventListener(K,"touchstart",this.touchstart,{passive:!1}),r.addEventListener(K,"touchmove",this.touchmove),r.addEventListener(K,"touchend",this.touchend),r.addEventListener(K,"touchcancel",this.reset)};function $s(Y,K,X){if(Y=new e.LngLat(Y.lng,Y.lat),K){var re=new e.LngLat(Y.lng-360,Y.lat),me=new e.LngLat(Y.lng+360,Y.lat),Oe=X.locationPoint(Y).distSqr(K);X.locationPoint(re).distSqr(K)<Oe?Y=re:X.locationPoint(me).distSqr(K)<Oe&&(Y=me)}for(;Math.abs(Y.lng-X.center.lng)>180;){var Be=X.locationPoint(Y);if(Be.x>=0&&Be.y>=0&&Be.x<=X.width&&Be.y<=X.height)break;Y.lng>X.center.lng?Y.lng-=360:Y.lng+=360}return Y}qa.prototype.down=function(Y,K){this.mouseRotate.mousedown(Y,K),this.mousePitch&&this.mousePitch.mousedown(Y,K),r.disableDrag()},qa.prototype.move=function(Y,K){var X=this.map,re=this.mouseRotate.mousemoveWindow(Y,K);if(re&&re.bearingDelta&&X.setBearing(X.getBearing()+re.bearingDelta),this.mousePitch){var me=this.mousePitch.mousemoveWindow(Y,K);me&&me.pitchDelta&&X.setPitch(X.getPitch()+me.pitchDelta)}},qa.prototype.off=function(){var Y=this.element;r.removeEventListener(Y,"mousedown",this.mousedown),r.removeEventListener(Y,"touchstart",this.touchstart,{passive:!1}),r.removeEventListener(Y,"touchmove",this.touchmove),r.removeEventListener(Y,"touchend",this.touchend),r.removeEventListener(Y,"touchcancel",this.reset),this.offTemp()},qa.prototype.offTemp=function(){r.enableDrag(),r.removeEventListener(e.window,"mousemove",this.mousemove),r.removeEventListener(e.window,"mouseup",this.mouseup)},qa.prototype.mousedown=function(Y){this.down(e.extend({},Y,{ctrlKey:!0,preventDefault:function(){return Y.preventDefault()}}),r.mousePos(this.element,Y)),r.addEventListener(e.window,"mousemove",this.mousemove),r.addEventListener(e.window,"mouseup",this.mouseup)},qa.prototype.mousemove=function(Y){this.move(Y,r.mousePos(this.element,Y))},qa.prototype.mouseup=function(Y){this.mouseRotate.mouseupWindow(Y),this.mousePitch&&this.mousePitch.mouseupWindow(Y),this.offTemp()},qa.prototype.touchstart=function(Y){Y.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=r.touchPos(this.element,Y.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return Y.preventDefault()}},this._startPos))},qa.prototype.touchmove=function(Y){Y.targetTouches.length!==1?this.reset():(this._lastPos=r.touchPos(this.element,Y.targetTouches)[0],this.move({preventDefault:function(){return Y.preventDefault()}},this._lastPos))},qa.prototype.touchend=function(Y){Y.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},qa.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var ds={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function gs(Y,K,X){var re=Y.classList;for(var me in ds)re.remove("mapboxgl-"+X+"-anchor-"+me);re.add("mapboxgl-"+X+"-anchor-"+K)}var zo,Is=function(Y){function K(X,re){var me=this;if(Y.call(this),(X instanceof e.window.HTMLElement||re)&&(X=e.extend({element:X},re)),e.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=X&&X.anchor||"center",this._color=X&&X.color||"#3FB1CE",this._draggable=X&&X.draggable||!1,this._state="inactive",this._rotation=X&&X.rotation||0,this._rotationAlignment=X&&X.rotationAlignment||"auto",this._pitchAlignment=X&&X.pitchAlignment&&X.pitchAlignment!=="auto"?X.pitchAlignment:this._rotationAlignment,X&&X.element)this._element=X.element,this._offset=e.Point.convert(X&&X.offset||[0,0]);else{this._defaultMarker=!0,this._element=r.create("div"),this._element.setAttribute("aria-label","Map marker");var Oe=r.createNS("http://www.w3.org/2000/svg","svg");Oe.setAttributeNS(null,"display","block"),Oe.setAttributeNS(null,"height","41px"),Oe.setAttributeNS(null,"width","27px"),Oe.setAttributeNS(null,"viewBox","0 0 27 41");var Be=r.createNS("http://www.w3.org/2000/svg","g");Be.setAttributeNS(null,"stroke","none"),Be.setAttributeNS(null,"stroke-width","1"),Be.setAttributeNS(null,"fill","none"),Be.setAttributeNS(null,"fill-rule","evenodd");var tt=r.createNS("http://www.w3.org/2000/svg","g");tt.setAttributeNS(null,"fill-rule","nonzero");var ft=r.createNS("http://www.w3.org/2000/svg","g");ft.setAttributeNS(null,"transform","translate(3.0, 29.0)"),ft.setAttributeNS(null,"fill","#000000");for(var St=0,Ft=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];St<Ft.length;St+=1){var Gt=Ft[St],$t=r.createNS("http://www.w3.org/2000/svg","ellipse");$t.setAttributeNS(null,"opacity","0.04"),$t.setAttributeNS(null,"cx","10.5"),$t.setAttributeNS(null,"cy","5.80029008"),$t.setAttributeNS(null,"rx",Gt.rx),$t.setAttributeNS(null,"ry",Gt.ry),ft.appendChild($t)}var sr=r.createNS("http://www.w3.org/2000/svg","g");sr.setAttributeNS(null,"fill",this._color);var lr=r.createNS("http://www.w3.org/2000/svg","path");lr.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),sr.appendChild(lr);var vr=r.createNS("http://www.w3.org/2000/svg","g");vr.setAttributeNS(null,"opacity","0.25"),vr.setAttributeNS(null,"fill","#000000");var ir=r.createNS("http://www.w3.org/2000/svg","path");ir.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),vr.appendChild(ir);var gr=r.createNS("http://www.w3.org/2000/svg","g");gr.setAttributeNS(null,"transform","translate(6.0, 7.0)"),gr.setAttributeNS(null,"fill","#FFFFFF");var Ar=r.createNS("http://www.w3.org/2000/svg","g");Ar.setAttributeNS(null,"transform","translate(8.0, 8.0)");var Pr=r.createNS("http://www.w3.org/2000/svg","circle");Pr.setAttributeNS(null,"fill","#000000"),Pr.setAttributeNS(null,"opacity","0.25"),Pr.setAttributeNS(null,"cx","5.5"),Pr.setAttributeNS(null,"cy","5.5"),Pr.setAttributeNS(null,"r","5.4999962");var Gr=r.createNS("http://www.w3.org/2000/svg","circle");Gr.setAttributeNS(null,"fill","#FFFFFF"),Gr.setAttributeNS(null,"cx","5.5"),Gr.setAttributeNS(null,"cy","5.5"),Gr.setAttributeNS(null,"r","5.4999962"),Ar.appendChild(Pr),Ar.appendChild(Gr),tt.appendChild(ft),tt.appendChild(sr),tt.appendChild(vr),tt.appendChild(gr),tt.appendChild(Ar),Oe.appendChild(tt),this._element.appendChild(Oe),this._offset=e.Point.convert(X&&X.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(Fr){Fr.preventDefault()}),this._element.addEventListener("mousedown",function(Fr){Fr.preventDefault()}),this._element.addEventListener("focus",function(){var Fr=me._map.getContainer();Fr.scrollTop=0,Fr.scrollLeft=0}),gs(this._element,this._anchor,"marker"),this._popup=null}return Y&&(K.__proto__=Y),(K.prototype=Object.create(Y&&Y.prototype)).constructor=K,K.prototype.addTo=function(X){return this.remove(),this._map=X,X.getCanvasContainer().appendChild(this._element),X.on("move",this._update),X.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},K.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),r.remove(this._element),this._popup&&this._popup.remove(),this},K.prototype.getLngLat=function(){return this._lngLat},K.prototype.setLngLat=function(X){return this._lngLat=e.LngLat.convert(X),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},K.prototype.getElement=function(){return this._element},K.prototype.setPopup=function(X){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),X){if(!("offset"in X.options)){var re=Math.sqrt(Math.pow(13.5,2)/2);X.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[re,-1*(24.6+re)],"bottom-right":[-re,-1*(24.6+re)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=X,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},K.prototype._onKeyPress=function(X){var re=X.code,me=X.charCode||X.keyCode;re!=="Space"&&re!=="Enter"&&me!==32&&me!==13||this.togglePopup()},K.prototype._onMapClick=function(X){var re=X.originalEvent.target,me=this._element;this._popup&&(re===me||me.contains(re))&&this.togglePopup()},K.prototype.getPopup=function(){return this._popup},K.prototype.togglePopup=function(){var X=this._popup;return X?(X.isOpen()?X.remove():X.addTo(this._map),this):this},K.prototype._update=function(X){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=$s(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var re="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?re="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(re="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var me="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?me="rotateX(0deg)":this._pitchAlignment==="map"&&(me="rotateX("+this._map.getPitch()+"deg)"),X&&X.type!=="moveend"||(this._pos=this._pos.round()),r.setTransform(this._element,ds[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+me+" "+re)}},K.prototype.getOffset=function(){return this._offset},K.prototype.setOffset=function(X){return this._offset=e.Point.convert(X),this._update(),this},K.prototype._onMove=function(X){this._pos=X.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new e.Event("dragstart"))),this.fire(new e.Event("drag"))},K.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new e.Event("dragend")),this._state="inactive"},K.prototype._addDragHandler=function(X){this._element.contains(X.originalEvent.target)&&(X.preventDefault(),this._positionDelta=X.point.sub(this._pos).add(this._offset),this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},K.prototype.setDraggable=function(X){return this._draggable=!!X,this._map&&(X?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},K.prototype.isDraggable=function(){return this._draggable},K.prototype.setRotation=function(X){return this._rotation=X||0,this._update(),this},K.prototype.getRotation=function(){return this._rotation},K.prototype.setRotationAlignment=function(X){return this._rotationAlignment=X||"auto",this._update(),this},K.prototype.getRotationAlignment=function(){return this._rotationAlignment},K.prototype.setPitchAlignment=function(X){return this._pitchAlignment=X&&X!=="auto"?X:this._rotationAlignment,this._update(),this},K.prototype.getPitchAlignment=function(){return this._pitchAlignment},K}(e.Evented),bl={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},_l=0,qi=!1,gc=function(Y){function K(X){Y.call(this),this.options=e.extend({},bl,X),e.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return Y&&(K.__proto__=Y),(K.prototype=Object.create(Y&&Y.prototype)).constructor=K,K.prototype.onAdd=function(X){var re;return this._map=X,this._container=r.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),re=this._setupUI,zo!==void 0?re(zo):e.window.navigator.permissions!==void 0?e.window.navigator.permissions.query({name:"geolocation"}).then(function(me){re(zo=me.state!=="denied")}):re(zo=!!e.window.navigator.geolocation),this._container},K.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(e.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),r.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,_l=0,qi=!1},K.prototype._isOutOfMapMaxBounds=function(X){var re=this._map.getMaxBounds(),me=X.coords;return re&&(me.longitude<re.getWest()||me.longitude>re.getEast()||me.latitude<re.getSouth()||me.latitude>re.getNorth())},K.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},K.prototype._onSuccess=function(X){if(this._map){if(this._isOutOfMapMaxBounds(X))return this._setErrorState(),this.fire(new e.Event("outofmaxbounds",X)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=X,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(X),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(X),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new e.Event("geolocate",X)),this._finish()}},K.prototype._updateCamera=function(X){var re=new e.LngLat(X.coords.longitude,X.coords.latitude),me=X.coords.accuracy,Oe=this._map.getBearing(),Be=e.extend({bearing:Oe},this.options.fitBoundsOptions);this._map.fitBounds(re.toBounds(me),Be,{geolocateSource:!0})},K.prototype._updateMarker=function(X){if(X){var re=new e.LngLat(X.coords.longitude,X.coords.latitude);this._accuracyCircleMarker.setLngLat(re).addTo(this._map),this._userLocationDotMarker.setLngLat(re).addTo(this._map),this._accuracy=X.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},K.prototype._updateCircleRadius=function(){var X=this._map._container.clientHeight/2,re=this._map.unproject([0,X]),me=this._map.unproject([1,X]),Oe=re.distanceTo(me),Be=Math.ceil(2*this._accuracy/Oe);this._circleElement.style.width=Be+"px",this._circleElement.style.height=Be+"px"},K.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},K.prototype._onError=function(X){if(this._map){if(this.options.trackUserLocation)if(X.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var re=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=re,this._geolocateButton.setAttribute("aria-label",re),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(X.code===3&&qi)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new e.Event("error",X)),this._finish()}},K.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},K.prototype._setupUI=function(X){var re=this;if(this._container.addEventListener("contextmenu",function(Be){return Be.preventDefault()}),this._geolocateButton=r.create("button","mapboxgl-ctrl-geolocate",this._container),r.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",X===!1){e.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var me=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=me,this._geolocateButton.setAttribute("aria-label",me)}else{var Oe=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=Oe,this._geolocateButton.setAttribute("aria-label",Oe)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=r.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new Is(this._dotElement),this._circleElement=r.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Is({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(Be){Be.geolocateSource||re._watchState!=="ACTIVE_LOCK"||Be.originalEvent&&Be.originalEvent.type==="resize"||(re._watchState="BACKGROUND",re._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),re._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),re.fire(new e.Event("trackuserlocationend")))})},K.prototype.trigger=function(){if(!this._setup)return e.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new e.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":_l--,qi=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new e.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new e.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){var X;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++_l>1?(X={maximumAge:6e5,timeout:0},qi=!0):(X=this.options.positionOptions,qi=!1),this._geolocationWatchID=e.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,X)}}else e.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},K.prototype._clearWatch=function(){e.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},K}(e.Evented),mc={maxWidth:100,unit:"metric"},io=function(Y){this.options=e.extend({},mc,Y),e.bindAll(["_onMove","setUnit"],this)};function Wl(Y,K,X){var re=X&&X.maxWidth||100,me=Y._container.clientHeight/2,Oe=Y.unproject([0,me]),Be=Y.unproject([re,me]),tt=Oe.distanceTo(Be);if(X&&X.unit==="imperial"){var ft=3.2808*tt;ft>5280?os(K,re,ft/5280,Y._getUIString("ScaleControl.Miles")):os(K,re,ft,Y._getUIString("ScaleControl.Feet"))}else X&&X.unit==="nautical"?os(K,re,tt/1852,Y._getUIString("ScaleControl.NauticalMiles")):tt>=1e3?os(K,re,tt/1e3,Y._getUIString("ScaleControl.Kilometers")):os(K,re,tt,Y._getUIString("ScaleControl.Meters"))}function os(Y,K,X,re){var me,Oe,Be,tt=(me=X,(Oe=Math.pow(10,(""+Math.floor(me)).length-1))*(Be=(Be=me/Oe)>=10?10:Be>=5?5:Be>=3?3:Be>=2?2:Be>=1?1:function(ft){var St=Math.pow(10,Math.ceil(-Math.log(ft)/Math.LN10));return Math.round(ft*St)/St}(Be)));Y.style.width=K*(tt/X)+"px",Y.innerHTML=tt+"&nbsp;"+re}io.prototype.getDefaultPosition=function(){return"bottom-left"},io.prototype._onMove=function(){Wl(this._map,this._container,this.options)},io.prototype.onAdd=function(Y){return this._map=Y,this._container=r.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",Y.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},io.prototype.onRemove=function(){r.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},io.prototype.setUnit=function(Y){this.options.unit=Y,Wl(this._map,this._container,this.options)};var Hi=function(Y){this._fullscreen=!1,Y&&Y.container&&(Y.container instanceof e.window.HTMLElement?this._container=Y.container:e.warnOnce("Full screen control 'container' must be a DOM element.")),e.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in e.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in e.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in e.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in e.window.document&&(this._fullscreenchange="MSFullscreenChange")};Hi.prototype.onAdd=function(Y){return this._map=Y,this._container||(this._container=this._map.getContainer()),this._controlContainer=r.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",e.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},Hi.prototype.onRemove=function(){r.remove(this._controlContainer),this._map=null,e.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},Hi.prototype._checkFullscreenSupport=function(){return!!(e.window.document.fullscreenEnabled||e.window.document.mozFullScreenEnabled||e.window.document.msFullscreenEnabled||e.window.document.webkitFullscreenEnabled)},Hi.prototype._setupUI=function(){var Y=this._fullscreenButton=r.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);r.create("span","mapboxgl-ctrl-icon",Y).setAttribute("aria-hidden",!0),Y.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),e.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},Hi.prototype._updateTitle=function(){var Y=this._getTitle();this._fullscreenButton.setAttribute("aria-label",Y),this._fullscreenButton.title=Y},Hi.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},Hi.prototype._isFullscreen=function(){return this._fullscreen},Hi.prototype._changeIcon=function(){(e.window.document.fullscreenElement||e.window.document.mozFullScreenElement||e.window.document.webkitFullscreenElement||e.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},Hi.prototype._onClickFullscreen=function(){this._isFullscreen()?e.window.document.exitFullscreen?e.window.document.exitFullscreen():e.window.document.mozCancelFullScreen?e.window.document.mozCancelFullScreen():e.window.document.msExitFullscreen?e.window.document.msExitFullscreen():e.window.document.webkitCancelFullScreen&&e.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var Mo={closeButton:!0,closeOnClick:!0,className:"",maxWidth:"240px"},wl=function(Y){function K(X){Y.call(this),this.options=e.extend(Object.create(Mo),X),e.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return Y&&(K.__proto__=Y),(K.prototype=Object.create(Y&&Y.prototype)).constructor=K,K.prototype.addTo=function(X){return this._map&&this.remove(),this._map=X,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new e.Event("open")),this},K.prototype.isOpen=function(){return!!this._map},K.prototype.remove=function(){return this._content&&r.remove(this._content),this._container&&(r.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new e.Event("close")),this},K.prototype.getLngLat=function(){return this._lngLat},K.prototype.setLngLat=function(X){return this._lngLat=e.LngLat.convert(X),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},K.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},K.prototype.getElement=function(){return this._container},K.prototype.setText=function(X){return this.setDOMContent(e.window.document.createTextNode(X))},K.prototype.setHTML=function(X){var re,me=e.window.document.createDocumentFragment(),Oe=e.window.document.createElement("body");for(Oe.innerHTML=X;re=Oe.firstChild;)me.appendChild(re);return this.setDOMContent(me)},K.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},K.prototype.setMaxWidth=function(X){return this.options.maxWidth=X,this._update(),this},K.prototype.setDOMContent=function(X){return this._createContent(),this._content.appendChild(X),this._update(),this},K.prototype.addClassName=function(X){this._container&&this._container.classList.add(X)},K.prototype.removeClassName=function(X){this._container&&this._container.classList.remove(X)},K.prototype.toggleClassName=function(X){if(this._container)return this._container.classList.toggle(X)},K.prototype._createContent=function(){this._content&&r.remove(this._content),this._content=r.create("div","mapboxgl-popup-content",this._container),this.options.closeButton&&(this._closeButton=r.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},K.prototype._onMouseUp=function(X){this._update(X.point)},K.prototype._onMouseMove=function(X){this._update(X.point)},K.prototype._onDrag=function(X){this._update(X.point)},K.prototype._update=function(X){var re=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=r.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=r.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(Gt){return re._container.classList.add(Gt)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=$s(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||X)){var me=this._pos=this._trackPointer&&X?X:this._map.project(this._lngLat),Oe=this.options.anchor,Be=function Gt($t){if($t){if(typeof $t=="number"){var sr=Math.round(Math.sqrt(.5*Math.pow($t,2)));return{center:new e.Point(0,0),top:new e.Point(0,$t),"top-left":new e.Point(sr,sr),"top-right":new e.Point(-sr,sr),bottom:new e.Point(0,-$t),"bottom-left":new e.Point(sr,-sr),"bottom-right":new e.Point(-sr,-sr),left:new e.Point($t,0),right:new e.Point(-$t,0)}}if($t instanceof e.Point||Array.isArray($t)){var lr=e.Point.convert($t);return{center:lr,top:lr,"top-left":lr,"top-right":lr,bottom:lr,"bottom-left":lr,"bottom-right":lr,left:lr,right:lr}}return{center:e.Point.convert($t.center||[0,0]),top:e.Point.convert($t.top||[0,0]),"top-left":e.Point.convert($t["top-left"]||[0,0]),"top-right":e.Point.convert($t["top-right"]||[0,0]),bottom:e.Point.convert($t.bottom||[0,0]),"bottom-left":e.Point.convert($t["bottom-left"]||[0,0]),"bottom-right":e.Point.convert($t["bottom-right"]||[0,0]),left:e.Point.convert($t.left||[0,0]),right:e.Point.convert($t.right||[0,0])}}return Gt(new e.Point(0,0))}(this.options.offset);if(!Oe){var tt,ft=this._container.offsetWidth,St=this._container.offsetHeight;tt=me.y+Be.bottom.y<St?["top"]:me.y>this._map.transform.height-St?["bottom"]:[],me.x<ft/2?tt.push("left"):me.x>this._map.transform.width-ft/2&&tt.push("right"),Oe=tt.length===0?"bottom":tt.join("-")}var Ft=me.add(Be[Oe]).round();r.setTransform(this._container,ds[Oe]+" translate("+Ft.x+"px,"+Ft.y+"px)"),gs(this._container,Oe,"popup")}},K.prototype._onClose=function(){this.remove()},K}(e.Evented),el={version:e.version,supported:o,setRTLTextPlugin:e.setRTLTextPlugin,getRTLTextPluginStatus:e.getRTLTextPluginStatus,Map:Qs,NavigationControl:po,GeolocateControl:gc,AttributionControl:Ji,ScaleControl:io,FullscreenControl:Hi,Popup:wl,Marker:Is,Style:na,LngLat:e.LngLat,LngLatBounds:e.LngLatBounds,Point:e.Point,MercatorCoordinate:e.MercatorCoordinate,Evented:e.Evented,config:e.config,prewarm:function(){It().acquire(Mt)},clearPrewarmedResources:function(){var Y=xt;Y&&(Y.isPreloaded()&&Y.numActive()===1?(Y.release(Mt),xt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return e.config.ACCESS_TOKEN},set accessToken(Y){e.config.ACCESS_TOKEN=Y},get baseApiUrl(){return e.config.API_URL},set baseApiUrl(Y){e.config.API_URL=Y},get workerCount(){return _t.workerCount},set workerCount(Y){_t.workerCount=Y},get maxParallelImageRequests(){return e.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(Y){e.config.MAX_PARALLEL_IMAGE_REQUESTS=Y},clearStorage:function(Y){e.clearTileCache(Y)},workerUrl:""};return el}),p})},{}],474:[function(n,z,q){"use strict";z.exports=function(l){for(var e=1<<l+1,o=new Array(e),r=0;r<e;++r)o[r]=p(l,r);return o};var t=n("convex-hull");function h(l,e,o){for(var r=new Array(l),i=0;i<l;++i)r[i]=0,i===e&&(r[i]+=.5),i===o&&(r[i]+=.5);return r}function p(l,e){if(e===0||e===(1<<l+1)-1)return[];for(var o=[],r=[],i=0;i<=l;++i)if(e&1<<i){o.push(h(l,i-1,i-1)),r.push(null);for(var u=0;u<=l;++u)~e&1<<u&&(o.push(h(l,i-1,u-1)),r.push([i,u]))}var s=t(o),a=[];e:for(i=0;i<s.length;++i){var c=s[i],f=[];for(u=0;u<c.length;++u){if(!r[c[u]])continue e;f.push(r[c[u]].slice())}a.push(f)}return a}},{"convex-hull":135}],475:[function(n,z,q){var t=n("./normalize"),h=n("gl-mat4/create"),p=n("gl-mat4/clone"),l=n("gl-mat4/determinant"),e=n("gl-mat4/invert"),o=n("gl-mat4/transpose"),r={length:n("gl-vec3/length"),normalize:n("gl-vec3/normalize"),dot:n("gl-vec3/dot"),cross:n("gl-vec3/cross")},i=h(),u=h(),s=[0,0,0,0],a=[[0,0,0],[0,0,0],[0,0,0]],c=[0,0,0];function f(g,d,m,y,v){g[0]=d[0]*y+m[0]*v,g[1]=d[1]*y+m[1]*v,g[2]=d[2]*y+m[2]*v}z.exports=function(g,d,m,y,v,T){if(d||(d=[0,0,0]),m||(m=[0,0,0]),y||(y=[0,0,0]),v||(v=[0,0,0,1]),T||(T=[0,0,0,1]),!t(i,g)||(p(u,i),u[3]=0,u[7]=0,u[11]=0,u[15]=1,Math.abs(l(u)<1e-8)))return!1;var w,A,E,M,b,_,S,C=i[3],k=i[7],L=i[11],I=i[12],R=i[13],V=i[14],O=i[15];if(C!==0||k!==0||L!==0){if(s[0]=C,s[1]=k,s[2]=L,s[3]=O,!e(u,u))return!1;o(u,u),w=v,E=u,M=(A=s)[0],b=A[1],_=A[2],S=A[3],w[0]=E[0]*M+E[4]*b+E[8]*_+E[12]*S,w[1]=E[1]*M+E[5]*b+E[9]*_+E[13]*S,w[2]=E[2]*M+E[6]*b+E[10]*_+E[14]*S,w[3]=E[3]*M+E[7]*b+E[11]*_+E[15]*S}else v[0]=v[1]=v[2]=0,v[3]=1;if(d[0]=I,d[1]=R,d[2]=V,function(D,B){D[0][0]=B[0],D[0][1]=B[1],D[0][2]=B[2],D[1][0]=B[4],D[1][1]=B[5],D[1][2]=B[6],D[2][0]=B[8],D[2][1]=B[9],D[2][2]=B[10]}(a,i),m[0]=r.length(a[0]),r.normalize(a[0],a[0]),y[0]=r.dot(a[0],a[1]),f(a[1],a[1],a[0],1,-y[0]),m[1]=r.length(a[1]),r.normalize(a[1],a[1]),y[0]/=m[1],y[1]=r.dot(a[0],a[2]),f(a[2],a[2],a[0],1,-y[1]),y[2]=r.dot(a[1],a[2]),f(a[2],a[2],a[1],1,-y[2]),m[2]=r.length(a[2]),r.normalize(a[2],a[2]),y[1]/=m[2],y[2]/=m[2],r.cross(c,a[1],a[2]),r.dot(a[0],c)<0)for(var J=0;J<3;J++)m[J]*=-1,a[J][0]*=-1,a[J][1]*=-1,a[J][2]*=-1;return T[0]=.5*Math.sqrt(Math.max(1+a[0][0]-a[1][1]-a[2][2],0)),T[1]=.5*Math.sqrt(Math.max(1-a[0][0]+a[1][1]-a[2][2],0)),T[2]=.5*Math.sqrt(Math.max(1-a[0][0]-a[1][1]+a[2][2],0)),T[3]=.5*Math.sqrt(Math.max(1+a[0][0]+a[1][1]+a[2][2],0)),a[2][1]>a[1][2]&&(T[0]=-T[0]),a[0][2]>a[2][0]&&(T[1]=-T[1]),a[1][0]>a[0][1]&&(T[2]=-T[2]),!0}},{"./normalize":476,"gl-mat4/clone":278,"gl-mat4/create":280,"gl-mat4/determinant":281,"gl-mat4/invert":293,"gl-mat4/transpose":306,"gl-vec3/cross":365,"gl-vec3/dot":370,"gl-vec3/length":380,"gl-vec3/normalize":387}],476:[function(n,z,q){z.exports=function(t,h){var p=h[15];if(p===0)return!1;for(var l=1/p,e=0;e<16;e++)t[e]=h[e]*l;return!0}},{}],477:[function(n,z,q){var t=n("gl-vec3/lerp"),h=n("mat4-recompose"),p=n("mat4-decompose"),l=n("gl-mat4/determinant"),e=n("quat-slerp"),o=u(),r=u(),i=u();function u(){return{translate:s(),scale:s(1),skew:s(),perspective:[0,0,0,1],quaternion:[0,0,0,1]}}function s(a){return[a||0,a||0,a||0]}z.exports=function(a,c,f,g){if(l(c)===0||l(f)===0)return!1;var d=p(c,o.translate,o.scale,o.skew,o.perspective,o.quaternion),m=p(f,r.translate,r.scale,r.skew,r.perspective,r.quaternion);return!(!d||!m)&&(t(i.translate,o.translate,r.translate,g),t(i.skew,o.skew,r.skew,g),t(i.scale,o.scale,r.scale,g),t(i.perspective,o.perspective,r.perspective,g),e(i.quaternion,o.quaternion,r.quaternion,g),h(a,i.translate,i.scale,i.skew,i.perspective,i.quaternion),!0)}},{"gl-mat4/determinant":281,"gl-vec3/lerp":381,"mat4-decompose":475,"mat4-recompose":478,"quat-slerp":527}],478:[function(n,z,q){var t={identity:n("gl-mat4/identity"),translate:n("gl-mat4/translate"),multiply:n("gl-mat4/multiply"),create:n("gl-mat4/create"),scale:n("gl-mat4/scale"),fromRotationTranslation:n("gl-mat4/fromRotationTranslation")},h=(t.create(),t.create());z.exports=function(p,l,e,o,r,i){return t.identity(p),t.fromRotationTranslation(p,i,l),p[3]=r[0],p[7]=r[1],p[11]=r[2],p[15]=r[3],t.identity(h),o[2]!==0&&(h[9]=o[2],t.multiply(p,p,h)),o[1]!==0&&(h[9]=0,h[8]=o[1],t.multiply(p,p,h)),o[0]!==0&&(h[8]=0,h[4]=o[0],t.multiply(p,p,h)),t.scale(p,p,e),p}},{"gl-mat4/create":280,"gl-mat4/fromRotationTranslation":284,"gl-mat4/identity":291,"gl-mat4/multiply":295,"gl-mat4/scale":303,"gl-mat4/translate":305}],479:[function(n,z,q){"use strict";z.exports=Math.log2||function(t){return Math.log(t)*Math.LOG2E}},{}],480:[function(n,z,q){"use strict";var t=n("binary-search-bounds"),h=n("mat4-interpolate"),p=n("gl-mat4/invert"),l=n("gl-mat4/rotateX"),e=n("gl-mat4/rotateY"),o=n("gl-mat4/rotateZ"),r=n("gl-mat4/lookAt"),i=n("gl-mat4/translate"),u=(n("gl-mat4/scale"),n("gl-vec3/normalize")),s=[0,0,0];function a(g){this._components=g.slice(),this._time=[0],this.prevMatrix=g.slice(),this.nextMatrix=g.slice(),this.computedMatrix=g.slice(),this.computedInverse=g.slice(),this.computedEye=[0,0,0],this.computedUp=[0,0,0],this.computedCenter=[0,0,0],this.computedRadius=[0],this._limits=[-1/0,1/0]}z.exports=function(g){return new a((g=g||{}).matrix||[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])};var c=a.prototype;c.recalcMatrix=function(g){var d=this._time,m=t.le(d,g),y=this.computedMatrix;if(!(m<0)){var v=this._components;if(m===d.length-1)for(var T=16*m,w=0;w<16;++w)y[w]=v[T++];else{var A=d[m+1]-d[m],E=(T=16*m,this.prevMatrix),M=!0;for(w=0;w<16;++w)E[w]=v[T++];var b=this.nextMatrix;for(w=0;w<16;++w)b[w]=v[T++],M=M&&E[w]===b[w];if(A<1e-6||M)for(w=0;w<16;++w)y[w]=E[w];else h(y,E,b,(g-d[m])/A)}var _=this.computedUp;_[0]=y[1],_[1]=y[5],_[2]=y[9],u(_,_);var S=this.computedInverse;p(S,y);var C=this.computedEye,k=S[15];C[0]=S[12]/k,C[1]=S[13]/k,C[2]=S[14]/k;var L=this.computedCenter,I=Math.exp(this.computedRadius[0]);for(w=0;w<3;++w)L[w]=C[w]-y[2+4*w]*I}},c.idle=function(g){if(!(g<this.lastT())){for(var d=this._components,m=d.length-16,y=0;y<16;++y)d.push(d[m++]);this._time.push(g)}},c.flush=function(g){var d=t.gt(this._time,g)-2;d<0||(this._time.splice(0,d),this._components.splice(0,16*d))},c.lastT=function(){return this._time[this._time.length-1]},c.lookAt=function(g,d,m,y){this.recalcMatrix(g),d=d||this.computedEye,m=m||s,y=y||this.computedUp,this.setMatrix(g,r(this.computedMatrix,d,m,y));for(var v=0,T=0;T<3;++T)v+=Math.pow(m[T]-d[T],2);v=Math.log(Math.sqrt(v)),this.computedRadius[0]=v},c.rotate=function(g,d,m,y){this.recalcMatrix(g);var v=this.computedInverse;d&&e(v,v,d),m&&l(v,v,m),y&&o(v,v,y),this.setMatrix(g,p(this.computedMatrix,v))};var f=[0,0,0];c.pan=function(g,d,m,y){f[0]=-(d||0),f[1]=-(m||0),f[2]=-(y||0),this.recalcMatrix(g);var v=this.computedInverse;i(v,v,f),this.setMatrix(g,p(v,v))},c.translate=function(g,d,m,y){f[0]=d||0,f[1]=m||0,f[2]=y||0,this.recalcMatrix(g);var v=this.computedMatrix;i(v,v,f),this.setMatrix(g,v)},c.setMatrix=function(g,d){if(!(g<this.lastT())){this._time.push(g);for(var m=0;m<16;++m)this._components.push(d[m])}},c.setDistance=function(g,d){this.computedRadius[0]=d},c.setDistanceLimits=function(g,d){var m=this._limits;m[0]=g,m[1]=d},c.getDistanceLimits=function(g){var d=this._limits;return g?(g[0]=d[0],g[1]=d[1],g):d}},{"binary-search-bounds":481,"gl-mat4/invert":293,"gl-mat4/lookAt":294,"gl-mat4/rotateX":300,"gl-mat4/rotateY":301,"gl-mat4/rotateZ":302,"gl-mat4/scale":303,"gl-mat4/translate":305,"gl-vec3/normalize":387,"mat4-interpolate":477}],481:[function(n,z,q){arguments[4][243][0].apply(q,arguments)},{dup:243}],482:[function(n,z,q){"use strict";z.exports=function(h){var p=h.length;if(p<3){for(var l=new Array(p),e=0;e<p;++e)l[e]=e;return p===2&&h[0][0]===h[1][0]&&h[0][1]===h[1][1]?[0]:l}var o=new Array(p);for(e=0;e<p;++e)o[e]=e;o.sort(function(d,m){var y=h[d][0]-h[m][0];return y||h[d][1]-h[m][1]});var r=[o[0],o[1]],i=[o[0],o[1]];for(e=2;e<p;++e){for(var u=o[e],s=h[u],a=r.length;a>1&&t(h[r[a-2]],h[r[a-1]],s)<=0;)a-=1,r.pop();for(r.push(u),a=i.length;a>1&&t(h[i[a-2]],h[i[a-1]],s)>=0;)a-=1,i.pop();i.push(u)}l=new Array(i.length+r.length-2);for(var c=0,f=(e=0,r.length);e<f;++e)l[c++]=r[e];for(var g=i.length-2;g>0;--g)l[c++]=i[g];return l};var t=n("robust-orientation")[3]},{"robust-orientation":548}],483:[function(n,z,q){"use strict";z.exports=function(h,p){p||(p=h,h=window);var l=0,e=0,o=0,r={shift:!1,alt:!1,control:!1,meta:!1},i=!1;function u(T){var w=!1;return"altKey"in T&&(w=w||T.altKey!==r.alt,r.alt=!!T.altKey),"shiftKey"in T&&(w=w||T.shiftKey!==r.shift,r.shift=!!T.shiftKey),"ctrlKey"in T&&(w=w||T.ctrlKey!==r.control,r.control=!!T.ctrlKey),"metaKey"in T&&(w=w||T.metaKey!==r.meta,r.meta=!!T.metaKey),w}function s(T,w){var A=t.x(w),E=t.y(w);"buttons"in w&&(T=0|w.buttons),(T!==l||A!==e||E!==o||u(w))&&(l=0|T,e=A||0,o=E||0,p&&p(l,e,o,r))}function a(T){s(0,T)}function c(){(l||e||o||r.shift||r.alt||r.meta||r.control)&&(e=o=0,l=0,r.shift=r.alt=r.control=r.meta=!1,p&&p(0,0,0,r))}function f(T){u(T)&&p&&p(l,e,o,r)}function g(T){t.buttons(T)===0?s(0,T):s(l,T)}function d(T){s(l|t.buttons(T),T)}function m(T){s(l&~t.buttons(T),T)}function y(){i||(i=!0,h.addEventListener("mousemove",g),h.addEventListener("mousedown",d),h.addEventListener("mouseup",m),h.addEventListener("mouseleave",a),h.addEventListener("mouseenter",a),h.addEventListener("mouseout",a),h.addEventListener("mouseover",a),h.addEventListener("blur",c),h.addEventListener("keyup",f),h.addEventListener("keydown",f),h.addEventListener("keypress",f),h!==window&&(window.addEventListener("blur",c),window.addEventListener("keyup",f),window.addEventListener("keydown",f),window.addEventListener("keypress",f)))}y();var v={element:h};return Object.defineProperties(v,{enabled:{get:function(){return i},set:function(T){T?y():function(){i&&(i=!1,h.removeEventListener("mousemove",g),h.removeEventListener("mousedown",d),h.removeEventListener("mouseup",m),h.removeEventListener("mouseleave",a),h.removeEventListener("mouseenter",a),h.removeEventListener("mouseout",a),h.removeEventListener("mouseover",a),h.removeEventListener("blur",c),h.removeEventListener("keyup",f),h.removeEventListener("keydown",f),h.removeEventListener("keypress",f),h!==window&&(window.removeEventListener("blur",c),window.removeEventListener("keyup",f),window.removeEventListener("keydown",f),window.removeEventListener("keypress",f)))}()},enumerable:!0},buttons:{get:function(){return l},enumerable:!0},x:{get:function(){return e},enumerable:!0},y:{get:function(){return o},enumerable:!0},mods:{get:function(){return r},enumerable:!0}}),v};var t=n("mouse-event")},{"mouse-event":485}],484:[function(n,z,q){var t={left:0,top:0};z.exports=function(h,p,l){p=p||h.currentTarget||h.srcElement,Array.isArray(l)||(l=[0,0]);var e=h.clientX||0,o=h.clientY||0,r=(i=p,i===window||i===document||i===document.body?t:i.getBoundingClientRect()),i;return l[0]=e-r.left,l[1]=o-r.top,l}},{}],485:[function(n,z,q){"use strict";function t(h){return h.target||h.srcElement||window}q.buttons=function(h){if(typeof h=="object"){if("buttons"in h)return h.buttons;if("which"in h){if((p=h.which)===2)return 4;if(p===3)return 2;if(p>0)return 1<<p-1}else if("button"in h){var p;if((p=h.button)===1)return 4;if(p===2)return 2;if(p>=0)return 1<<p}}return 0},q.element=t,q.x=function(h){if(typeof h=="object"){if("offsetX"in h)return h.offsetX;var p=t(h).getBoundingClientRect();return h.clientX-p.left}return 0},q.y=function(h){if(typeof h=="object"){if("offsetY"in h)return h.offsetY;var p=t(h).getBoundingClientRect();return h.clientY-p.top}return 0}},{}],486:[function(n,z,q){"use strict";var t=n("to-px");z.exports=function(h,p,l){typeof h=="function"&&(l=!!p,p=h,h=window);var e=t("ex",h),o=function(r){l&&r.preventDefault();var i=r.deltaX||0,u=r.deltaY||0,s=r.deltaZ||0,a=1;switch(r.deltaMode){case 1:a=e;break;case 2:a=window.innerHeight}if(u*=a,s*=a,(i*=a)||u||s)return p(i,u,s,r)};return h.addEventListener("wheel",o),o}},{"to-px":578}],487:[function(n,z,q){"use strict";var t=n("typedarray-pool");function h(v){return"a"+v}function p(v){return"d"+v}function l(v,T){return"c"+v+"_"+T}function e(v){return"s"+v}function o(v,T){return"t"+v+"_"+T}function r(v){return"o"+v}function i(v){return"x"+v}function u(v){return"p"+v}function s(v,T){return"d"+v+"_"+T}function a(v){return"i"+v}function c(v,T){return"u"+v+"_"+T}function f(v){return"b"+v}function g(v){return"y"+v}function d(v){return"e"+v}function m(v){return"v"+v}z.exports=function(v){function T(S){throw new Error("ndarray-extract-contour: "+S)}typeof v!="object"&&T("Must specify arguments");var w=v.order;Array.isArray(w)||T("Must specify order");var A=v.arrayArguments||1;A<1&&T("Must have at least one array argument");var E=v.scalarArguments||0;E<0&&T("Scalar arg count must be > 0"),typeof v.vertex!="function"&&T("Must specify vertex creation function"),typeof v.cell!="function"&&T("Must specify cell creation function"),typeof v.phase!="function"&&T("Must specify phase function");for(var M=v.getters||[],b=new Array(A),_=0;_<A;++_)M.indexOf(_)>=0?b[_]=!0:b[_]=!1;return function(S,C,k,L,I,R){var V=R.length,O=I.length;if(O<2)throw new Error("ndarray-extract-contour: Dimension must be at least 2");for(var J="extractContour"+I.join("_"),D=[],B=[],N=[],F=0;F<V;++F)N.push(h(F));for(F=0;F<L;++F)N.push(i(F));for(F=0;F<O;++F)B.push(e(F)+"="+h(0)+".shape["+F+"]|0");for(F=0;F<V;++F){B.push(p(F)+"="+h(F)+".data",r(F)+"="+h(F)+".offset|0");for(var H=0;H<O;++H)B.push(o(F,H)+"="+h(F)+".stride["+H+"]|0")}for(F=0;F<V;++F)for(B.push(u(F)+"="+r(F)),B.push(l(F,0)),H=1;H<1<<O;++H){for(var j=[],G=0;G<O;++G)H&1<<G&&j.push("-"+o(F,G));B.push(s(F,H)+"=("+j.join("")+")|0"),B.push(l(F,H)+"=0")}for(F=0;F<V;++F)for(H=0;H<O;++H){var W=[o(F,I[H])];H>0&&W.push(o(F,I[H-1])+"*"+e(I[H-1])),B.push(c(F,I[H])+"=("+W.join("-")+")|0")}for(F=0;F<O;++F)B.push(a(F)+"=0");B.push("N=0");var Q=["2"];for(F=O-2;F>=0;--F)Q.push(e(I[F]));for(B.push("Q=("+Q.join("*")+")|0","P=mallocUint32(Q)","V=mallocUint32(Q)","X=0"),B.push(f(0)+"=0"),H=1;H<1<<O;++H){var $=[],ee=[];for(G=0;G<O;++G)H&1<<G&&(ee.length===0?$.push("1"):$.unshift(ee.join("*"))),ee.push(e(I[G]));var ie="";$[0].indexOf(e(I[O-2]))<0&&(ie="-");var ae=y(O,H,I);B.push(d(ae)+"=(-"+$.join("-")+")|0",g(ae)+"=("+ie+$.join("-")+")|0",f(ae)+"=0")}function oe(ue,we){D.push("for(",a(I[ue]),"=",we,";",a(I[ue]),"<",e(I[ue]),";","++",a(I[ue]),"){")}function de(ue){for(var we=0;we<V;++we)D.push(u(we),"+=",c(we,I[ue]),";");D.push("}")}function le(){for(var ue=1;ue<1<<O;++ue)D.push("T","=",d(ue),";",d(ue),"=",g(ue),";",g(ue),"=","T",";")}B.push(m(0)+"=0","T=0"),function ue(we,Ae){if(we<0)(function(ke){for(var Me=0;Me<V;++Me)R[Me]?D.push(l(Me,0),"=",p(Me),".get(",u(Me),");"):D.push(l(Me,0),"=",p(Me),"[",u(Me),"];");var ve=[];for(Me=0;Me<V;++Me)ve.push(l(Me,0));for(Me=0;Me<L;++Me)ve.push(i(Me));D.push(f(0),"=","P","[","X","]=phase(",ve.join(),");");for(var ge=1;ge<1<<O;++ge)D.push(f(ge),"=","P","[","X","+",d(ge),"];");var De=[];for(ge=1;ge<1<<O;++ge)De.push("("+f(0)+"!=="+f(ge)+")");D.push("if(",De.join("||"),"){");var _e=[];for(Me=0;Me<O;++Me)_e.push(a(Me));for(Me=0;Me<V;++Me)for(_e.push(l(Me,0)),ge=1;ge<1<<O;++ge)R[Me]?D.push(l(Me,ge),"=",p(Me),".get(",u(Me),"+",s(Me,ge),");"):D.push(l(Me,ge),"=",p(Me),"[",u(Me),"+",s(Me,ge),"];"),_e.push(l(Me,ge));for(Me=0;Me<1<<O;++Me)_e.push(f(Me));for(Me=0;Me<L;++Me)_e.push(i(Me));D.push("vertex(",_e.join(),");",m(0),"=","V","[","X","]=","N","++;");var Pe=(1<<O)-1,Fe=f(Pe);for(ge=0;ge<O;++ge)if(!(ke&~(1<<ge))){for(var ze=Pe^1<<ge,He=f(ze),et=[],Re=ze;Re>0;Re=Re-1&ze)et.push("V[X+"+d(Re)+"]");for(et.push(m(0)),Re=0;Re<V;++Re)1&ge?et.push(l(Re,Pe),l(Re,ze)):et.push(l(Re,ze),l(Re,Pe));for(1&ge?et.push(Fe,He):et.push(He,Fe),Re=0;Re<L;++Re)et.push(i(Re));D.push("if(",Fe,"!==",He,"){","face(",et.join(),")}")}D.push("}","X","+=1;")})(Ae);else{(function(ke){for(var Me=ke-1;Me>=0;--Me)oe(Me,0);var ve=[];for(Me=0;Me<V;++Me)R[Me]?ve.push(p(Me)+".get("+u(Me)+")"):ve.push(p(Me)+"["+u(Me)+"]");for(Me=0;Me<L;++Me)ve.push(i(Me));for(D.push("P","[","X","++]=phase(",ve.join(),");"),Me=0;Me<ke;++Me)de(Me);for(var ge=0;ge<V;++ge)D.push(u(ge),"+=",c(ge,I[ke]),";")})(we),D.push("if(",e(I[we]),">0){",a(I[we]),"=1;"),ue(we-1,Ae|1<<I[we]);for(var Se=0;Se<V;++Se)D.push(u(Se),"+=",c(Se,I[we]),";");we===O-1&&(D.push("X","=0;"),le()),oe(we,2),ue(we-1,Ae),we===O-1&&(D.push("if(",a(I[O-1]),"&1){","X","=0;}"),le()),de(we),D.push("}")}}(O-1,0),D.push("freeUint32(","V",");freeUint32(","P",");");var fe=["'use strict';","function ",J,"(",N.join(),"){","var ",B.join(),";",D.join(""),"}","return ",J].join("");return new Function("vertex","face","phase","mallocUint32","freeUint32",fe)(S,C,k,t.mallocUint32,t.freeUint32)}(v.vertex,v.cell,v.phase,E,w,b)};function y(v,T,w){for(var A=0,E=0;E<v;++E)T&1<<E&&(A|=1<<w[E]);return A}},{"typedarray-pool":595}],488:[function(n,z,q){"use strict";z.exports=function(u,s,a){if(Array.isArray(a)){if(a.length!==s.dimension)throw new Error("ndarray-gradient: invalid boundary conditions")}else a=t(s.dimension,typeof a=="string"?a:"clamp");if(u.dimension!==s.dimension+1)throw new Error("ndarray-gradient: output dimension must be +1 input dimension");if(u.shape[s.dimension]!==s.dimension)throw new Error("ndarray-gradient: output shape must match input shape");for(var c=0;c<s.dimension;++c)if(u.shape[c]!==s.shape[c])throw new Error("ndarray-gradient: shape mismatch");return s.size===0?u:s.dimension<=0?(u.set(0),u):function(f){var g=f.join();if(_=l[g])return _;var d=f.length,m=["function gradient(dst,src){var s=src.shape.slice();"];function y(S){for(var C=d-S.length,k=[],L=[],I=[],R=0;R<d;++R)S.indexOf(R+1)>=0?I.push("0"):S.indexOf(-(R+1))>=0?I.push("s["+R+"]-1"):(I.push("-1"),k.push("1"),L.push("s["+R+"]-2"));var V=".lo("+k.join()+").hi("+L.join()+")";if(k.length===0&&(V=""),C>0){for(m.push("if(1"),R=0;R<d;++R)S.indexOf(R+1)>=0||S.indexOf(-(R+1))>=0||m.push("&&s[",R,"]>2");for(m.push("){grad",C,"(src.pick(",I.join(),")",V),R=0;R<d;++R)S.indexOf(R+1)>=0||S.indexOf(-(R+1))>=0||m.push(",dst.pick(",I.join(),",",R,")",V);m.push(");")}for(R=0;R<S.length;++R){var O=Math.abs(S[R])-1,J="dst.pick("+I.join()+","+O+")"+V;switch(f[O]){case"clamp":var D=I.slice(),B=I.slice();S[R]<0?D[O]="s["+O+"]-2":B[O]="1",C===0?m.push("if(s[",O,"]>1){dst.set(",I.join(),",",O,",0.5*(src.get(",D.join(),")-src.get(",B.join(),")))}else{dst.set(",I.join(),",",O,",0)};"):m.push("if(s[",O,"]>1){diff(",J,",src.pick(",D.join(),")",V,",src.pick(",B.join(),")",V,");}else{zero(",J,");};");break;case"mirror":C===0?m.push("dst.set(",I.join(),",",O,",0);"):m.push("zero(",J,");");break;case"wrap":var N=I.slice(),F=I.slice();S[R]<0?(N[O]="s["+O+"]-2",F[O]="0"):(N[O]="s["+O+"]-1",F[O]="1"),C===0?m.push("if(s[",O,"]>2){dst.set(",I.join(),",",O,",0.5*(src.get(",N.join(),")-src.get(",F.join(),")))}else{dst.set(",I.join(),",",O,",0)};"):m.push("if(s[",O,"]>2){diff(",J,",src.pick(",N.join(),")",V,",src.pick(",F.join(),")",V,");}else{zero(",J,");};");break;default:throw new Error("ndarray-gradient: Invalid boundary condition")}}C>0&&m.push("};")}for(var v=0;v<1<<d;++v){for(var T=[],w=0;w<d;++w)v&1<<w&&T.push(w+1);for(var A=0;A<1<<T.length;++A){var E=T.slice();for(w=0;w<T.length;++w)A&1<<w&&(E[w]=-E[w]);y(E)}}m.push("return dst;};return gradient");var M=["diff","zero"],b=[o,r];for(v=1;v<=d;++v)M.push("grad"+v),b.push(i(v));M.push(m.join(""));var _=Function.apply(void 0,M).apply(void 0,b);return p[g]=_,_}(a)(u,s)};var t=n("dup"),h=n("cwise-compiler"),p={},l={},e={body:"",args:[],thisVars:[],localVars:[]},o=h({args:["array","array","array"],pre:e,post:e,body:{args:[{name:"out",lvalue:!0,rvalue:!1,count:1},{name:"left",lvalue:!1,rvalue:!0,count:1},{name:"right",lvalue:!1,rvalue:!0,count:1}],body:"out=0.5*(left-right)",thisVars:[],localVars:[]},funcName:"cdiff"}),r=h({args:["array"],pre:e,post:e,body:{args:[{name:"out",lvalue:!0,rvalue:!1,count:1}],body:"out=0",thisVars:[],localVars:[]},funcName:"zero"});function i(u){if(u in p)return p[u];for(var s=[],a=0;a<u;++a)s.push("out",a,"s=0.5*(inp",a,"l-inp",a,"r);");var c=["array"],f=["junk"];for(a=0;a<u;++a){c.push("array"),f.push("out"+a+"s");var g=t(u);g[a]=-1,c.push({array:0,offset:g.slice()}),g[a]=1,c.push({array:0,offset:g.slice()}),f.push("inp"+a+"l","inp"+a+"r")}return p[u]=h({args:c,pre:e,post:e,body:{body:s.join(""),args:f.map(function(d){return{name:d,lvalue:d.indexOf("out")===0,rvalue:d.indexOf("inp")===0,count:d!=="junk"|0}}),thisVars:[],localVars:[]},funcName:"fdTemplate"+u})}},{"cwise-compiler":151,dup:176}],489:[function(n,z,q){"use strict";function t(e,o){var r=Math.floor(o),i=o-r,u=0<=r&&r<e.shape[0],s=0<=r+1&&r+1<e.shape[0];return(1-i)*(u?+e.get(r):0)+i*(s?+e.get(r+1):0)}function h(e,o,r){var i=Math.floor(o),u=o-i,s=0<=i&&i<e.shape[0],a=0<=i+1&&i+1<e.shape[0],c=Math.floor(r),f=r-c,g=0<=c&&c<e.shape[1],d=0<=c+1&&c+1<e.shape[1],m=s&&g?e.get(i,c):0,y=s&&d?e.get(i,c+1):0;return(1-f)*((1-u)*m+u*(a&&g?e.get(i+1,c):0))+f*((1-u)*y+u*(a&&d?e.get(i+1,c+1):0))}function p(e,o,r,i){var u=Math.floor(o),s=o-u,a=0<=u&&u<e.shape[0],c=0<=u+1&&u+1<e.shape[0],f=Math.floor(r),g=r-f,d=0<=f&&f<e.shape[1],m=0<=f+1&&f+1<e.shape[1],y=Math.floor(i),v=i-y,T=0<=y&&y<e.shape[2],w=0<=y+1&&y+1<e.shape[2],A=a&&d&&T?e.get(u,f,y):0,E=a&&m&&T?e.get(u,f+1,y):0,M=c&&d&&T?e.get(u+1,f,y):0,b=c&&m&&T?e.get(u+1,f+1,y):0,_=a&&d&&w?e.get(u,f,y+1):0,S=a&&m&&w?e.get(u,f+1,y+1):0;return(1-v)*((1-g)*((1-s)*A+s*M)+g*((1-s)*E+s*b))+v*((1-g)*((1-s)*_+s*(c&&d&&w?e.get(u+1,f,y+1):0))+g*((1-s)*S+s*(c&&m&&w?e.get(u+1,f+1,y+1):0)))}function l(e){var o,r,i=0|e.shape.length,u=new Array(i),s=new Array(i),a=new Array(i),c=new Array(i);for(o=0;o<i;++o)r=+arguments[o+1],u[o]=Math.floor(r),s[o]=r-u[o],a[o]=0<=u[o]&&u[o]<e.shape[o],c[o]=0<=u[o]+1&&u[o]+1<e.shape[o];var f,g,d,m=0;e:for(o=0;o<1<<i;++o){for(g=1,d=e.offset,f=0;f<i;++f)if(o&1<<f){if(!c[f])continue e;g*=s[f],d+=e.stride[f]*(u[f]+1)}else{if(!a[f])continue e;g*=1-s[f],d+=e.stride[f]*u[f]}m+=g*e.data[d]}return m}z.exports=function(e,o,r,i){switch(e.shape.length){case 0:return 0;case 1:return t(e,o);case 2:return h(e,o,r);case 3:return p(e,o,r,i);default:return l.apply(void 0,arguments)}},z.exports.d1=t,z.exports.d2=h,z.exports.d3=p},{}],490:[function(n,z,q){"use strict";var t=n("cwise-compiler"),h={body:"",args:[],thisVars:[],localVars:[]};function p(a){if(!a)return h;for(var c=0;c<a.args.length;++c){var f=a.args[c];a.args[c]=c===0?{name:f,lvalue:!0,rvalue:!!a.rvalue,count:a.count||1}:{name:f,lvalue:!1,rvalue:!0,count:1}}return a.thisVars||(a.thisVars=[]),a.localVars||(a.localVars=[]),a}function l(a){for(var c=[],f=0;f<a.args.length;++f)c.push("a"+f);return new Function("P",["return function ",a.funcName,"_ndarrayops(",c.join(","),") {P(",c.join(","),");return a0}"].join(""))(function(g){return t({args:g.args,pre:p(g.pre),body:p(g.body),post:p(g.proc),funcName:g.funcName})}(a))}var e={add:"+",sub:"-",mul:"*",div:"/",mod:"%",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"};(function(){for(var a in e){var c=e[a];q[a]=l({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+c+"c"},funcName:a}),q[a+"eq"]=l({args:["array","array"],body:{args:["a","b"],body:"a"+c+"=b"},rvalue:!0,funcName:a+"eq"}),q[a+"s"]=l({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+c+"s"},funcName:a+"s"}),q[a+"seq"]=l({args:["array","scalar"],body:{args:["a","s"],body:"a"+c+"=s"},rvalue:!0,funcName:a+"seq"})}})();var o={not:"!",bnot:"~",neg:"-",recip:"1.0/"};(function(){for(var a in o){var c=o[a];q[a]=l({args:["array","array"],body:{args:["a","b"],body:"a="+c+"b"},funcName:a}),q[a+"eq"]=l({args:["array"],body:{args:["a"],body:"a="+c+"a"},rvalue:!0,count:2,funcName:a+"eq"})}})();var r={and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">="};(function(){for(var a in r){var c=r[a];q[a]=l({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+c+"c"},funcName:a}),q[a+"s"]=l({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+c+"s"},funcName:a+"s"}),q[a+"eq"]=l({args:["array","array"],body:{args:["a","b"],body:"a=a"+c+"b"},rvalue:!0,count:2,funcName:a+"eq"}),q[a+"seq"]=l({args:["array","scalar"],body:{args:["a","s"],body:"a=a"+c+"s"},rvalue:!0,count:2,funcName:a+"seq"})}})();var i=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan"];(function(){for(var a=0;a<i.length;++a){var c=i[a];q[c]=l({args:["array","array"],pre:{args:[],body:"this_f=Math."+c,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b)",thisVars:["this_f"]},funcName:c}),q[c+"eq"]=l({args:["array"],pre:{args:[],body:"this_f=Math."+c,thisVars:["this_f"]},body:{args:["a"],body:"a=this_f(a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:c+"eq"})}})();var u=["max","min","atan2","pow"];(function(){for(var a=0;a<u.length;++a){var c=u[a];q[c]=l({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+c,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:c}),q[c+"s"]=l({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+c,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:c+"s"}),q[c+"eq"]=l({args:["array","array"],pre:{args:[],body:"this_f=Math."+c,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:c+"eq"}),q[c+"seq"]=l({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+c,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:c+"seq"})}})();var s=["atan2","pow"];(function(){for(var a=0;a<s.length;++a){var c=s[a];q[c+"op"]=l({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+c,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:c+"op"}),q[c+"ops"]=l({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+c,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:c+"ops"}),q[c+"opeq"]=l({args:["array","array"],pre:{args:[],body:"this_f=Math."+c,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:c+"opeq"}),q[c+"opseq"]=l({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+c,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:c+"opseq"})}})(),q.any=t({args:["array"],pre:h,body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"if(a){return true}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return false"},funcName:"any"}),q.all=t({args:["array"],pre:h,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1}],body:"if(!x){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"all"}),q.sum=t({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s+=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"sum"}),q.prod=t({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=1"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s*=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"prod"}),q.norm2squared=t({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm2squared"}),q.norm2=t({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return Math.sqrt(this_s)"},funcName:"norm2"}),q.norminf=t({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:4}],body:"if(-a>this_s){this_s=-a}else if(a>this_s){this_s=a}",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norminf"}),q.norm1=t({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:3}],body:"this_s+=a<0?-a:a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm1"}),q.sup=t({args:["array"],pre:{body:"this_h=-Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_>this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),q.inf=t({args:["array"],pre:{body:"this_h=Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_<this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),q.argmin=t({args:["index","array","shape"],pre:{body:"{this_v=Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_<this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),q.argmax=t({args:["index","array","shape"],pre:{body:"{this_v=-Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_>this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),q.random=l({args:["array"],pre:{args:[],body:"this_f=Math.random",thisVars:["this_f"]},body:{args:["a"],body:"a=this_f()",thisVars:["this_f"]},funcName:"random"}),q.assign=l({args:["array","array"],body:{args:["a","b"],body:"a=b"},funcName:"assign"}),q.assigns=l({args:["array","scalar"],body:{args:["a","b"],body:"a=b"},funcName:"assigns"}),q.equals=t({args:["array","array"],pre:h,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1},{name:"y",lvalue:!1,rvalue:!0,count:1}],body:"if(x!==y){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"equals"})},{"cwise-compiler":151}],491:[function(n,z,q){"use strict";var t=n("ndarray"),h=n("./doConvert.js");z.exports=function(p,l){for(var e=[],o=p,r=1;Array.isArray(o);)e.push(o.length),r*=o.length,o=o[0];return e.length===0?t():(l||(l=t(new Float64Array(r),e)),h(l,p),l)}},{"./doConvert.js":492,ndarray:495}],492:[function(n,z,q){z.exports=n("cwise-compiler")({args:["array","scalar","index"],pre:{body:"{}",args:[],thisVars:[],localVars:[]},body:{body:`{
var _inline_1_v=_inline_1_arg1_,_inline_1_i
for(_inline_1_i=0;_inline_1_i<_inline_1_arg2_.length-1;++_inline_1_i) {
_inline_1_v=_inline_1_v[_inline_1_arg2_[_inline_1_i]]
}
_inline_1_arg0_=_inline_1_v[_inline_1_arg2_[_inline_1_arg2_.length-1]]
}`,args:[{name:"_inline_1_arg0_",lvalue:!0,rvalue:!1,count:1},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_1_arg2_",lvalue:!1,rvalue:!0,count:4}],thisVars:[],localVars:["_inline_1_i","_inline_1_v"]},post:{body:"{}",args:[],thisVars:[],localVars:[]},funcName:"convert",blockSize:64})},{"cwise-compiler":151}],493:[function(n,z,q){"use strict";var t=n("typedarray-pool"),h=32;function p(e){switch(e){case"uint8":return[t.mallocUint8,t.freeUint8];case"uint16":return[t.mallocUint16,t.freeUint16];case"uint32":return[t.mallocUint32,t.freeUint32];case"int8":return[t.mallocInt8,t.freeInt8];case"int16":return[t.mallocInt16,t.freeInt16];case"int32":return[t.mallocInt32,t.freeInt32];case"float32":return[t.mallocFloat,t.freeFloat];case"float64":return[t.mallocDouble,t.freeDouble];default:return null}}function l(e){for(var o=[],r=0;r<e;++r)o.push("s"+r);for(r=0;r<e;++r)o.push("n"+r);for(r=1;r<e;++r)o.push("d"+r);for(r=1;r<e;++r)o.push("e"+r);for(r=1;r<e;++r)o.push("f"+r);return o}z.exports=function(e,o){var r=["'use strict'"],i=["ndarraySortWrapper",e.join("d"),o].join("");r.push(["function ",i,"(",["array"].join(","),"){"].join(""));for(var u=["data=array.data,offset=array.offset|0,shape=array.shape,stride=array.stride"],s=0;s<e.length;++s)u.push(["s",s,"=stride[",s,"]|0,n",s,"=shape[",s,"]|0"].join(""));var a=new Array(e.length),c=[];for(s=0;s<e.length;++s)(d=e[s])!==0&&(c.length===0?a[d]="1":a[d]=c.join("*"),c.push("n"+d));var f=-1,g=-1;for(s=0;s<e.length;++s){var d,m=e[s];m!==0&&(f>0?u.push(["d",m,"=s",m,"-d",f,"*n",f].join("")):u.push(["d",m,"=s",m].join("")),f=m),(d=e.length-1-s)!==0&&(g>0?u.push(["e",d,"=s",d,"-e",g,"*n",g,",f",d,"=",a[d],"-f",g,"*n",g].join("")):u.push(["e",d,"=s",d,",f",d,"=",a[d]].join("")),g=d)}r.push("var "+u.join(","));var y=["0","n0-1","data","offset"].concat(l(e.length));r.push(["if(n0<=",h,"){","insertionSort(",y.join(","),")}else{","quickSort(",y.join(","),")}"].join("")),r.push("}return "+i);var v=new Function("insertionSort","quickSort",r.join(`
`)),T=function(A,E){var M=["'use strict'"],b=["ndarrayInsertionSort",A.join("d"),E].join(""),_=["left","right","data","offset"].concat(l(A.length)),S=p(E),C=["i,j,cptr,ptr=left*s0+offset"];if(A.length>1){for(var k=[],L=1;L<A.length;++L)C.push("i"+L),k.push("n"+L);S?C.push("scratch=malloc("+k.join("*")+")"):C.push("scratch=new Array("+k.join("*")+")"),C.push("dptr","sptr","a","b")}else C.push("scratch");function I(O){return E==="generic"?["data.get(",O,")"].join(""):["data[",O,"]"].join("")}function R(O,J){return E==="generic"?["data.set(",O,",",J,")"].join(""):["data[",O,"]=",J].join("")}if(M.push(["function ",b,"(",_.join(","),"){var ",C.join(",")].join(""),"for(i=left+1;i<=right;++i){","j=i;ptr+=s0","cptr=ptr"),A.length>1){for(M.push("dptr=0;sptr=ptr"),L=A.length-1;L>=0;--L)(V=A[L])!==0&&M.push(["for(i",V,"=0;i",V,"<n",V,";++i",V,"){"].join(""));for(M.push("scratch[dptr++]=",I("sptr")),L=0;L<A.length;++L)(V=A[L])!==0&&M.push("sptr+=d"+V,"}");for(M.push("__g:while(j-->left){","dptr=0","sptr=cptr-s0"),L=1;L<A.length;++L)L===1&&M.push("__l:"),M.push(["for(i",L,"=0;i",L,"<n",L,";++i",L,"){"].join(""));for(M.push(["a=",I("sptr"),`
b=scratch[dptr]
if(a<b){break __g}
if(a>b){break __l}`].join("")),L=A.length-1;L>=1;--L)M.push("sptr+=e"+L,"dptr+=f"+L,"}");for(M.push("dptr=cptr;sptr=cptr-s0"),L=A.length-1;L>=0;--L)(V=A[L])!==0&&M.push(["for(i",V,"=0;i",V,"<n",V,";++i",V,"){"].join(""));for(M.push(R("dptr",I("sptr"))),L=0;L<A.length;++L)(V=A[L])!==0&&M.push(["dptr+=d",V,";sptr+=d",V].join(""),"}");for(M.push(`cptr-=s0
}`),M.push("dptr=cptr;sptr=0"),L=A.length-1;L>=0;--L)(V=A[L])!==0&&M.push(["for(i",V,"=0;i",V,"<n",V,";++i",V,"){"].join(""));for(M.push(R("dptr","scratch[sptr++]")),L=0;L<A.length;++L){var V;(V=A[L])!==0&&M.push("dptr+=d"+V,"}")}}else M.push("scratch="+I("ptr"),"while((j-->left)&&("+I("cptr-s0")+">scratch)){",R("cptr",I("cptr-s0")),"cptr-=s0","}",R("cptr","scratch"));return M.push("}"),A.length>1&&S&&M.push("free(scratch)"),M.push("} return "+b),S?new Function("malloc","free",M.join(`
`))(S[0],S[1]):new Function(M.join(`
`))()}(e,o),w=function(A,E,M){var b=["'use strict'"],_=["ndarrayQuickSort",A.join("d"),E].join(""),S=["left","right","data","offset"].concat(l(A.length)),C=p(E),k=0;b.push(["function ",_,"(",S.join(","),"){"].join(""));var L=["sixth=((right-left+1)/6)|0","index1=left+sixth","index5=right-sixth","index3=(left+right)>>1","index2=index3-sixth","index4=index3+sixth","el1=index1","el2=index2","el3=index3","el4=index4","el5=index5","less=left+1","great=right-1","pivots_are_equal=true","tmp","tmp0","x","y","z","k","ptr0","ptr1","ptr2","comp_pivot1=0","comp_pivot2=0","comp=0"];if(A.length>1){for(var I=[],R=1;R<A.length;++R)I.push("n"+R),L.push("i"+R);for(R=0;R<8;++R)L.push("b_ptr"+R);L.push("ptr3","ptr4","ptr5","ptr6","ptr7","pivot_ptr","ptr_shift","elementSize="+I.join("*")),C?L.push("pivot1=malloc(elementSize)","pivot2=malloc(elementSize)"):L.push("pivot1=new Array(elementSize),pivot2=new Array(elementSize)")}else L.push("pivot1","pivot2");function V(ae){return["(offset+",ae,"*s0)"].join("")}function O(ae){return E==="generic"?["data.get(",ae,")"].join(""):["data[",ae,"]"].join("")}function J(ae,oe){return E==="generic"?["data.set(",ae,",",oe,")"].join(""):["data[",ae,"]=",oe].join("")}function D(ae,oe,de){if(ae.length===1)b.push("ptr0="+V(ae[0]));else for(var le=0;le<ae.length;++le)b.push(["b_ptr",le,"=s0*",ae[le]].join(""));for(oe&&b.push("pivot_ptr=0"),b.push("ptr_shift=offset"),le=A.length-1;le>=0;--le)(fe=A[le])!==0&&b.push(["for(i",fe,"=0;i",fe,"<n",fe,";++i",fe,"){"].join(""));if(ae.length>1)for(le=0;le<ae.length;++le)b.push(["ptr",le,"=b_ptr",le,"+ptr_shift"].join(""));for(b.push(de),oe&&b.push("++pivot_ptr"),le=0;le<A.length;++le){var fe;(fe=A[le])!==0&&(ae.length>1?b.push("ptr_shift+=d"+fe):b.push("ptr0+=d"+fe),b.push("}"))}}function B(ae,oe,de,le){if(oe.length===1)b.push("ptr0="+V(oe[0]));else{for(var fe=0;fe<oe.length;++fe)b.push(["b_ptr",fe,"=s0*",oe[fe]].join(""));b.push("ptr_shift=offset")}for(de&&b.push("pivot_ptr=0"),ae&&b.push(ae+":"),fe=1;fe<A.length;++fe)b.push(["for(i",fe,"=0;i",fe,"<n",fe,";++i",fe,"){"].join(""));if(oe.length>1)for(fe=0;fe<oe.length;++fe)b.push(["ptr",fe,"=b_ptr",fe,"+ptr_shift"].join(""));for(b.push(le),fe=A.length-1;fe>=1;--fe)de&&b.push("pivot_ptr+=f"+fe),oe.length>1?b.push("ptr_shift+=e"+fe):b.push("ptr0+=e"+fe),b.push("}")}function N(){A.length>1&&C&&b.push("free(pivot1)","free(pivot2)")}function F(ae,oe){var de="el"+ae,le="el"+oe;if(A.length>1){var fe="__l"+ ++k;B(fe,[de,le],!1,["comp=",O("ptr0"),"-",O("ptr1"),`
`,"if(comp>0){tmp0=",de,";",de,"=",le,";",le,"=tmp0;break ",fe,`}
`,"if(comp<0){break ",fe,"}"].join(""))}else b.push(["if(",O(V(de)),">",O(V(le)),"){tmp0=",de,";",de,"=",le,";",le,"=tmp0}"].join(""))}function H(ae,oe){A.length>1?D([ae,oe],!1,J("ptr0",O("ptr1"))):b.push(J(V(ae),O(V(oe))))}function j(ae,oe,de){if(A.length>1){var le="__l"+ ++k;B(le,[oe],!0,[ae,"=",O("ptr0"),"-pivot",de,`[pivot_ptr]
`,"if(",ae,"!==0){break ",le,"}"].join(""))}else b.push([ae,"=",O(V(oe)),"-pivot",de].join(""))}function G(ae,oe){A.length>1?D([ae,oe],!1,["tmp=",O("ptr0"),`
`,J("ptr0",O("ptr1")),`
`,J("ptr1","tmp")].join("")):b.push(["ptr0=",V(ae),`
`,"ptr1=",V(oe),`
`,"tmp=",O("ptr0"),`
`,J("ptr0",O("ptr1")),`
`,J("ptr1","tmp")].join(""))}function W(ae,oe,de){A.length>1?(D([ae,oe,de],!1,["tmp=",O("ptr0"),`
`,J("ptr0",O("ptr1")),`
`,J("ptr1",O("ptr2")),`
`,J("ptr2","tmp")].join("")),b.push("++"+oe,"--"+de)):b.push(["ptr0=",V(ae),`
`,"ptr1=",V(oe),`
`,"ptr2=",V(de),`
`,"++",oe,`
`,"--",de,`
`,"tmp=",O("ptr0"),`
`,J("ptr0",O("ptr1")),`
`,J("ptr1",O("ptr2")),`
`,J("ptr2","tmp")].join(""))}function Q(ae,oe){G(ae,oe),b.push("--"+oe)}function $(ae,oe,de){A.length>1?D([ae,oe],!0,[J("ptr0",O("ptr1")),`
`,J("ptr1",["pivot",de,"[pivot_ptr]"].join(""))].join("")):b.push(J(V(ae),O(V(oe))),J(V(oe),"pivot"+de))}function ee(ae,oe){b.push(["if((",oe,"-",ae,")<=",h,`){
`,"insertionSort(",ae,",",oe,",data,offset,",l(A.length).join(","),`)
`,`}else{
`,_,"(",ae,",",oe,",data,offset,",l(A.length).join(","),`)
`,"}"].join(""))}function ie(ae,oe,de){A.length>1?(b.push(["__l",++k,":while(true){"].join("")),D([ae],!0,["if(",O("ptr0"),"!==pivot",oe,"[pivot_ptr]){break __l",k,"}"].join("")),b.push(de,"}")):b.push(["while(",O(V(ae)),"===pivot",oe,"){",de,"}"].join(""))}return b.push("var "+L.join(",")),F(1,2),F(4,5),F(1,3),F(2,3),F(1,4),F(3,4),F(2,5),F(2,3),F(4,5),A.length>1?D(["el1","el2","el3","el4","el5","index1","index3","index5"],!0,["pivot1[pivot_ptr]=",O("ptr1"),`
`,"pivot2[pivot_ptr]=",O("ptr3"),`
`,`pivots_are_equal=pivots_are_equal&&(pivot1[pivot_ptr]===pivot2[pivot_ptr])
`,"x=",O("ptr0"),`
`,"y=",O("ptr2"),`
`,"z=",O("ptr4"),`
`,J("ptr5","x"),`
`,J("ptr6","y"),`
`,J("ptr7","z")].join("")):b.push(["pivot1=",O(V("el2")),`
`,"pivot2=",O(V("el4")),`
`,`pivots_are_equal=pivot1===pivot2
`,"x=",O(V("el1")),`
`,"y=",O(V("el3")),`
`,"z=",O(V("el5")),`
`,J(V("index1"),"x"),`
`,J(V("index3"),"y"),`
`,J(V("index5"),"z")].join("")),H("index2","left"),H("index4","right"),b.push("if(pivots_are_equal){"),b.push("for(k=less;k<=great;++k){"),j("comp","k",1),b.push("if(comp===0){continue}"),b.push("if(comp<0){"),b.push("if(k!==less){"),G("k","less"),b.push("}"),b.push("++less"),b.push("}else{"),b.push("while(true){"),j("comp","great",1),b.push("if(comp>0){"),b.push("great--"),b.push("}else if(comp<0){"),W("k","less","great"),b.push("break"),b.push("}else{"),Q("k","great"),b.push("break"),b.push("}"),b.push("}"),b.push("}"),b.push("}"),b.push("}else{"),b.push("for(k=less;k<=great;++k){"),j("comp_pivot1","k",1),b.push("if(comp_pivot1<0){"),b.push("if(k!==less){"),G("k","less"),b.push("}"),b.push("++less"),b.push("}else{"),j("comp_pivot2","k",2),b.push("if(comp_pivot2>0){"),b.push("while(true){"),j("comp","great",2),b.push("if(comp>0){"),b.push("if(--great<k){break}"),b.push("continue"),b.push("}else{"),j("comp","great",1),b.push("if(comp<0){"),W("k","less","great"),b.push("}else{"),Q("k","great"),b.push("}"),b.push("break"),b.push("}"),b.push("}"),b.push("}"),b.push("}"),b.push("}"),b.push("}"),$("left","(less-1)",1),$("right","(great+1)",2),ee("left","(less-2)"),ee("(great+2)","right"),b.push("if(pivots_are_equal){"),N(),b.push("return"),b.push("}"),b.push("if(less<index1&&great>index5){"),ie("less",1,"++less"),ie("great",2,"--great"),b.push("for(k=less;k<=great;++k){"),j("comp_pivot1","k",1),b.push("if(comp_pivot1===0){"),b.push("if(k!==less){"),G("k","less"),b.push("}"),b.push("++less"),b.push("}else{"),j("comp_pivot2","k",2),b.push("if(comp_pivot2===0){"),b.push("while(true){"),j("comp","great",2),b.push("if(comp===0){"),b.push("if(--great<k){break}"),b.push("continue"),b.push("}else{"),j("comp","great",1),b.push("if(comp<0){"),W("k","less","great"),b.push("}else{"),Q("k","great"),b.push("}"),b.push("break"),b.push("}"),b.push("}"),b.push("}"),b.push("}"),b.push("}"),b.push("}"),N(),ee("less","great"),b.push("}return "+_),A.length>1&&C?new Function("insertionSort","malloc","free",b.join(`
`))(M,C[0],C[1]):new Function("insertionSort",b.join(`
`))(M)}(e,o,T);return v(T,w)}},{"typedarray-pool":595}],494:[function(n,z,q){"use strict";var t=n("./lib/compile_sort.js"),h={};z.exports=function(p){var l=p.order,e=p.dtype,o=[l,e].join(":"),r=h[o];return r||(h[o]=r=t(l,e)),r(p),p}},{"./lib/compile_sort.js":493}],495:[function(n,z,q){var t=n("iota-array"),h=n("is-buffer"),p=typeof Float64Array<"u";function l(i,u){return i[0]-u[0]}function e(){var i,u=this.stride,s=new Array(u.length);for(i=0;i<s.length;++i)s[i]=[Math.abs(u[i]),i];s.sort(l);var a=new Array(s.length);for(i=0;i<a.length;++i)a[i]=s[i][1];return a}function o(i,u){var s=["View",u,"d",i].join("");u<0&&(s="View_Nil"+i);var a=i==="generic";if(u===-1){var c="function "+s+"(a){this.data=a;};var proto="+s+".prototype;proto.dtype='"+i+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+s+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+s+"(a){return new "+s+"(a);}";return new Function(c)()}if(u===0)return c="function "+s+"(a,d) {this.data = a;this.offset = d};var proto="+s+".prototype;proto.dtype='"+i+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+s+"_copy() {return new "+s+"(this.data,this.offset)};proto.pick=function "+s+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+s+"_get(){return "+(a?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+s+"_set(v){return "+(a?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+s+"(a,b,c,d){return new "+s+"(a,d)}",new Function("TrivialArray",c)(r[i][0]);c=["'use strict'"];var f=t(u),g=f.map(function(M){return"i"+M}),d="this.offset+"+f.map(function(M){return"this.stride["+M+"]*i"+M}).join("+"),m=f.map(function(M){return"b"+M}).join(","),y=f.map(function(M){return"c"+M}).join(",");c.push("function "+s+"(a,"+m+","+y+",d){this.data=a","this.shape=["+m+"]","this.stride=["+y+"]","this.offset=d|0}","var proto="+s+".prototype","proto.dtype='"+i+"'","proto.dimension="+u),c.push("Object.defineProperty(proto,'size',{get:function "+s+"_size(){return "+f.map(function(M){return"this.shape["+M+"]"}).join("*"),"}})"),u===1?c.push("proto.order=[0]"):(c.push("Object.defineProperty(proto,'order',{get:"),u<4?(c.push("function "+s+"_order(){"),u===2?c.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):u===3&&c.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")):c.push("ORDER})")),c.push("proto.set=function "+s+"_set("+g.join(",")+",v){"),a?c.push("return this.data.set("+d+",v)}"):c.push("return this.data["+d+"]=v}"),c.push("proto.get=function "+s+"_get("+g.join(",")+"){"),a?c.push("return this.data.get("+d+")}"):c.push("return this.data["+d+"]}"),c.push("proto.index=function "+s+"_index(",g.join(),"){return "+d+"}"),c.push("proto.hi=function "+s+"_hi("+g.join(",")+"){return new "+s+"(this.data,"+f.map(function(M){return["(typeof i",M,"!=='number'||i",M,"<0)?this.shape[",M,"]:i",M,"|0"].join("")}).join(",")+","+f.map(function(M){return"this.stride["+M+"]"}).join(",")+",this.offset)}");var v=f.map(function(M){return"a"+M+"=this.shape["+M+"]"}),T=f.map(function(M){return"c"+M+"=this.stride["+M+"]"});c.push("proto.lo=function "+s+"_lo("+g.join(",")+"){var b=this.offset,d=0,"+v.join(",")+","+T.join(","));for(var w=0;w<u;++w)c.push("if(typeof i"+w+"==='number'&&i"+w+">=0){d=i"+w+"|0;b+=c"+w+"*d;a"+w+"-=d}");for(c.push("return new "+s+"(this.data,"+f.map(function(M){return"a"+M}).join(",")+","+f.map(function(M){return"c"+M}).join(",")+",b)}"),c.push("proto.step=function "+s+"_step("+g.join(",")+"){var "+f.map(function(M){return"a"+M+"=this.shape["+M+"]"}).join(",")+","+f.map(function(M){return"b"+M+"=this.stride["+M+"]"}).join(",")+",c=this.offset,d=0,ceil=Math.ceil"),w=0;w<u;++w)c.push("if(typeof i"+w+"==='number'){d=i"+w+"|0;if(d<0){c+=b"+w+"*(a"+w+"-1);a"+w+"=ceil(-a"+w+"/d)}else{a"+w+"=ceil(a"+w+"/d)}b"+w+"*=d}");c.push("return new "+s+"(this.data,"+f.map(function(M){return"a"+M}).join(",")+","+f.map(function(M){return"b"+M}).join(",")+",c)}");var A=new Array(u),E=new Array(u);for(w=0;w<u;++w)A[w]="a[i"+w+"]",E[w]="b[i"+w+"]";for(c.push("proto.transpose=function "+s+"_transpose("+g+"){"+g.map(function(M,b){return M+"=("+M+"===undefined?"+b+":"+M+"|0)"}).join(";"),"var a=this.shape,b=this.stride;return new "+s+"(this.data,"+A.join(",")+","+E.join(",")+",this.offset)}"),c.push("proto.pick=function "+s+"_pick("+g+"){var a=[],b=[],c=this.offset"),w=0;w<u;++w)c.push("if(typeof i"+w+"==='number'&&i"+w+">=0){c=(c+this.stride["+w+"]*i"+w+")|0}else{a.push(this.shape["+w+"]);b.push(this.stride["+w+"])}");return c.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),c.push("return function construct_"+s+"(data,shape,stride,offset){return new "+s+"(data,"+f.map(function(M){return"shape["+M+"]"}).join(",")+","+f.map(function(M){return"stride["+M+"]"}).join(",")+",offset)}"),new Function("CTOR_LIST","ORDER",c.join(`
`))(r[i],e)}var r={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],bigint64:[],biguint64:[],buffer:[],generic:[]};z.exports=function(i,u,s,a){if(i===void 0)return(0,r.array[0])([]);typeof i=="number"&&(i=[i]),u===void 0&&(u=[i.length]);var c=u.length;if(s===void 0){s=new Array(c);for(var f=c-1,g=1;f>=0;--f)s[f]=g,g*=u[f]}if(a===void 0)for(a=0,f=0;f<c;++f)s[f]<0&&(a-=(u[f]-1)*s[f]);for(var d=function(y){if(h(y))return"buffer";if(p)switch(Object.prototype.toString.call(y)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped";case"[object BigInt64Array]":return"bigint64";case"[object BigUint64Array]":return"biguint64"}return Array.isArray(y)?"array":"generic"}(i),m=r[d];m.length<=c+1;)m.push(o(d,m.length-1));return(0,m[c+1])(i,u,s,a)}},{"iota-array":463,"is-buffer":465}],496:[function(n,z,q){"use strict";var t=n("double-bits"),h=Math.pow(2,-1074);z.exports=function(p,l){if(isNaN(p)||isNaN(l))return NaN;if(p===l)return p;if(p===0)return l<0?-h:h;var e=t.hi(p),o=t.lo(p);return l>p==p>0?o===-1>>>0?(e+=1,o=0):o+=1:o===0?(o=-1>>>0,e-=1):o-=1,t.pack(o,e)}},{"double-bits":173}],497:[function(n,z,q){var t=Math.PI,h=r(120);function p(i,u,s,a){return["C",i,u,s,a,s,a]}function l(i,u,s,a,c,f){return["C",i/3+2/3*s,u/3+2/3*a,c/3+2/3*s,f/3+2/3*a,c,f]}function e(i,u,s,a,c,f,g,d,m,y){if(y)C=y[0],k=y[1],_=y[2],S=y[3];else{var v=o(i,u,-c);i=v.x,u=v.y;var T=(i-(d=(v=o(d,m,-c)).x))/2,w=(u-(m=v.y))/2,A=T*T/(s*s)+w*w/(a*a);A>1&&(s*=A=Math.sqrt(A),a*=A);var E=s*s,M=a*a,b=(f==g?-1:1)*Math.sqrt(Math.abs((E*M-E*w*w-M*T*T)/(E*w*w+M*T*T)));b==1/0&&(b=1);var _=b*s*w/a+(i+d)/2,S=b*-a*T/s+(u+m)/2,C=Math.asin(((u-S)/a).toFixed(9)),k=Math.asin(((m-S)/a).toFixed(9));(C=i<_?t-C:C)<0&&(C=2*t+C),(k=d<_?t-k:k)<0&&(k=2*t+k),g&&C>k&&(C-=2*t),!g&&k>C&&(k-=2*t)}if(Math.abs(k-C)>h){var L=k,I=d,R=m;k=C+h*(g&&k>C?1:-1);var V=e(d=_+s*Math.cos(k),m=S+a*Math.sin(k),s,a,c,0,g,I,R,[k,L,_,S])}var O=Math.tan((k-C)/4),J=4/3*s*O,D=4/3*a*O,B=[2*i-(i+J*Math.sin(C)),2*u-(u-D*Math.cos(C)),d+J*Math.sin(k),m-D*Math.cos(k),d,m];if(y)return B;V&&(B=B.concat(V));for(var N=0;N<B.length;){var F=o(B[N],B[N+1],c);B[N++]=F.x,B[N++]=F.y}return B}function o(i,u,s){return{x:i*Math.cos(s)-u*Math.sin(s),y:i*Math.sin(s)+u*Math.cos(s)}}function r(i){return i*(t/180)}z.exports=function(i){for(var u,s=[],a=0,c=0,f=0,g=0,d=null,m=null,y=0,v=0,T=0,w=i.length;T<w;T++){var A=i[T],E=A[0];switch(E){case"M":f=A[1],g=A[2];break;case"A":(A=e(y,v,A[1],A[2],r(A[3]),A[4],A[5],A[6],A[7])).unshift("C"),A.length>7&&(s.push(A.splice(0,7)),A.unshift("C"));break;case"S":var M=y,b=v;u!="C"&&u!="S"||(M+=M-a,b+=b-c),A=["C",M,b,A[1],A[2],A[3],A[4]];break;case"T":u=="Q"||u=="T"?(d=2*y-d,m=2*v-m):(d=y,m=v),A=l(y,v,d,m,A[1],A[2]);break;case"Q":d=A[1],m=A[2],A=l(y,v,A[1],A[2],A[3],A[4]);break;case"L":A=p(y,v,A[1],A[2]);break;case"H":A=p(y,v,A[1],v);break;case"V":A=p(y,v,y,A[1]);break;case"Z":A=p(y,v,f,g)}u=E,y=A[A.length-2],v=A[A.length-1],A.length>4?(a=A[A.length-4],c=A[A.length-3]):(a=y,c=v),s.push(A)}return s}},{}],498:[function(n,z,q){q.vertexNormals=function(t,h,p){for(var l=h.length,e=new Array(l),o=p===void 0?1e-6:p,r=0;r<l;++r)e[r]=[0,0,0];for(r=0;r<t.length;++r)for(var i=t[r],u=0,s=i[i.length-1],a=i[0],c=0;c<i.length;++c){u=s,s=a,a=i[(c+1)%i.length];for(var f=h[u],g=h[s],d=h[a],m=new Array(3),y=0,v=new Array(3),T=0,w=0;w<3;++w)m[w]=f[w]-g[w],y+=m[w]*m[w],v[w]=d[w]-g[w],T+=v[w]*v[w];if(y*T>o){var A=e[s],E=1/Math.sqrt(y*T);for(w=0;w<3;++w){var M=(w+1)%3,b=(w+2)%3;A[w]+=E*(v[M]*m[b]-v[b]*m[M])}}}for(r=0;r<l;++r){A=e[r];var _=0;for(w=0;w<3;++w)_+=A[w]*A[w];if(_>o)for(E=1/Math.sqrt(_),w=0;w<3;++w)A[w]*=E;else for(w=0;w<3;++w)A[w]=0}return e},q.faceNormals=function(t,h,p){for(var l=t.length,e=new Array(l),o=p===void 0?1e-6:p,r=0;r<l;++r){for(var i=t[r],u=new Array(3),s=0;s<3;++s)u[s]=h[i[s]];var a=new Array(3),c=new Array(3);for(s=0;s<3;++s)a[s]=u[1][s]-u[0][s],c[s]=u[2][s]-u[0][s];var f=new Array(3),g=0;for(s=0;s<3;++s){var d=(s+1)%3,m=(s+2)%3;f[s]=a[d]*c[m]-a[m]*c[d],g+=f[s]*f[s]}for(g=g>o?1/Math.sqrt(g):0,s=0;s<3;++s)f[s]*=g;e[r]=f}return e}},{}],499:[function(n,z,q){"use strict";var t=Object.getOwnPropertySymbols,h=Object.prototype.hasOwnProperty,p=Object.prototype.propertyIsEnumerable;function l(e){if(e==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}z.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de",Object.getOwnPropertyNames(e)[0]==="5")return!1;for(var o={},r=0;r<10;r++)o["_"+String.fromCharCode(r)]=r;if(Object.getOwnPropertyNames(o).map(function(u){return o[u]}).join("")!=="0123456789")return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach(function(u){i[u]=u}),Object.keys(Object.assign({},i)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}()?Object.assign:function(e,o){for(var r,i,u=l(e),s=1;s<arguments.length;s++){for(var a in r=Object(arguments[s]))h.call(r,a)&&(u[a]=r[a]);if(t){i=t(r);for(var c=0;c<i.length;c++)p.call(r,i[c])&&(u[i[c]]=r[i[c]])}}return u}},{}],500:[function(n,z,q){"use strict";z.exports=function(t,h,p,l,e,o,r,i,u,s){var a=h+o+s;if(c>0){var c=Math.sqrt(a+1);t[0]=.5*(r-u)/c,t[1]=.5*(i-l)/c,t[2]=.5*(p-o)/c,t[3]=.5*c}else{var f=Math.max(h,o,s);c=Math.sqrt(2*f-a+1),h>=f?(t[0]=.5*c,t[1]=.5*(e+p)/c,t[2]=.5*(i+l)/c,t[3]=.5*(r-u)/c):o>=f?(t[0]=.5*(p+e)/c,t[1]=.5*c,t[2]=.5*(u+r)/c,t[3]=.5*(i-l)/c):(t[0]=.5*(l+i)/c,t[1]=.5*(r+u)/c,t[2]=.5*c,t[3]=.5*(p-e)/c)}return t}},{}],501:[function(n,z,q){"use strict";z.exports=function(a){var c=(a=a||{}).center||[0,0,0],f=a.rotation||[0,0,0,1],g=a.radius||1;c=[].slice.call(c,0,3),i(f=[].slice.call(f,0,4),f);var d=new u(f,c,Math.log(g));return d.setDistanceLimits(a.zoomMin,a.zoomMax),("eye"in a||"up"in a)&&d.lookAt(0,a.eye,a.center,a.up),d};var t=n("filtered-vector"),h=n("gl-mat4/lookAt"),p=n("gl-mat4/fromQuat"),l=n("gl-mat4/invert"),e=n("./lib/quatFromFrame");function o(a,c,f){return Math.sqrt(Math.pow(a,2)+Math.pow(c,2)+Math.pow(f,2))}function r(a,c,f,g){return Math.sqrt(Math.pow(a,2)+Math.pow(c,2)+Math.pow(f,2)+Math.pow(g,2))}function i(a,c){var f=c[0],g=c[1],d=c[2],m=c[3],y=r(f,g,d,m);y>1e-6?(a[0]=f/y,a[1]=g/y,a[2]=d/y,a[3]=m/y):(a[0]=a[1]=a[2]=0,a[3]=1)}function u(a,c,f){this.radius=t([f]),this.center=t(c),this.rotation=t(a),this.computedRadius=this.radius.curve(0),this.computedCenter=this.center.curve(0),this.computedRotation=this.rotation.curve(0),this.computedUp=[.1,0,0],this.computedEye=[.1,0,0],this.computedMatrix=[.1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.recalcMatrix(0)}var s=u.prototype;s.lastT=function(){return Math.max(this.radius.lastT(),this.center.lastT(),this.rotation.lastT())},s.recalcMatrix=function(a){this.radius.curve(a),this.center.curve(a),this.rotation.curve(a);var c=this.computedRotation;i(c,c);var f=this.computedMatrix;p(f,c);var g=this.computedCenter,d=this.computedEye,m=this.computedUp,y=Math.exp(this.computedRadius[0]);d[0]=g[0]+y*f[2],d[1]=g[1]+y*f[6],d[2]=g[2]+y*f[10],m[0]=f[1],m[1]=f[5],m[2]=f[9];for(var v=0;v<3;++v){for(var T=0,w=0;w<3;++w)T+=f[v+4*w]*d[w];f[12+v]=-T}},s.getMatrix=function(a,c){this.recalcMatrix(a);var f=this.computedMatrix;if(c){for(var g=0;g<16;++g)c[g]=f[g];return c}return f},s.idle=function(a){this.center.idle(a),this.radius.idle(a),this.rotation.idle(a)},s.flush=function(a){this.center.flush(a),this.radius.flush(a),this.rotation.flush(a)},s.pan=function(a,c,f,g){c=c||0,f=f||0,g=g||0,this.recalcMatrix(a);var d=this.computedMatrix,m=d[1],y=d[5],v=d[9],T=o(m,y,v);m/=T,y/=T,v/=T;var w=d[0],A=d[4],E=d[8],M=w*m+A*y+E*v,b=o(w-=m*M,A-=y*M,E-=v*M);w/=b,A/=b,E/=b;var _=d[2],S=d[6],C=d[10],k=_*m+S*y+C*v,L=_*w+S*A+C*E,I=o(_-=k*m+L*w,S-=k*y+L*A,C-=k*v+L*E);_/=I,S/=I,C/=I;var R=w*c+m*f,V=A*c+y*f,O=E*c+v*f;this.center.move(a,R,V,O);var J=Math.exp(this.computedRadius[0]);J=Math.max(1e-4,J+g),this.radius.set(a,Math.log(J))},s.rotate=function(a,c,f,g){this.recalcMatrix(a),c=c||0,f=f||0;var d=this.computedMatrix,m=d[0],y=d[4],v=d[8],T=d[1],w=d[5],A=d[9],E=d[2],M=d[6],b=d[10],_=c*m+f*T,S=c*y+f*w,C=c*v+f*A,k=-(M*C-b*S),L=-(b*_-E*C),I=-(E*S-M*_),R=Math.sqrt(Math.max(0,1-Math.pow(k,2)-Math.pow(L,2)-Math.pow(I,2))),V=r(k,L,I,R);V>1e-6?(k/=V,L/=V,I/=V,R/=V):(k=L=I=0,R=1);var O=this.computedRotation,J=O[0],D=O[1],B=O[2],N=O[3],F=J*R+N*k+D*I-B*L,H=D*R+N*L+B*k-J*I,j=B*R+N*I+J*L-D*k,G=N*R-J*k-D*L-B*I;if(g){k=E,L=M,I=b;var W=Math.sin(g)/o(k,L,I);k*=W,L*=W,I*=W,G=G*(R=Math.cos(c))-(F=F*R+G*k+H*I-j*L)*k-(H=H*R+G*L+j*k-F*I)*L-(j=j*R+G*I+F*L-H*k)*I}var Q=r(F,H,j,G);Q>1e-6?(F/=Q,H/=Q,j/=Q,G/=Q):(F=H=j=0,G=1),this.rotation.set(a,F,H,j,G)},s.lookAt=function(a,c,f,g){this.recalcMatrix(a),f=f||this.computedCenter,c=c||this.computedEye,g=g||this.computedUp;var d=this.computedMatrix;h(d,c,f,g);var m=this.computedRotation;e(m,d[0],d[1],d[2],d[4],d[5],d[6],d[8],d[9],d[10]),i(m,m),this.rotation.set(a,m[0],m[1],m[2],m[3]);for(var y=0,v=0;v<3;++v)y+=Math.pow(f[v]-c[v],2);this.radius.set(a,.5*Math.log(Math.max(y,1e-6))),this.center.set(a,f[0],f[1],f[2])},s.translate=function(a,c,f,g){this.center.move(a,c||0,f||0,g||0)},s.setMatrix=function(a,c){var f=this.computedRotation;e(f,c[0],c[1],c[2],c[4],c[5],c[6],c[8],c[9],c[10]),i(f,f),this.rotation.set(a,f[0],f[1],f[2],f[3]);var g=this.computedMatrix;l(g,c);var d=g[15];if(Math.abs(d)>1e-6){var m=g[12]/d,y=g[13]/d,v=g[14]/d;this.recalcMatrix(a);var T=Math.exp(this.computedRadius[0]);this.center.set(a,m-g[2]*T,y-g[6]*T,v-g[10]*T),this.radius.idle(a)}else this.center.idle(a),this.radius.idle(a)},s.setDistance=function(a,c){c>0&&this.radius.set(a,Math.log(c))},s.setDistanceLimits=function(a,c){a=a>0?Math.log(a):-1/0,c=c>0?Math.log(c):1/0,c=Math.max(c,a),this.radius.bounds[0][0]=a,this.radius.bounds[1][0]=c},s.getDistanceLimits=function(a){var c=this.radius.bounds;return a?(a[0]=Math.exp(c[0][0]),a[1]=Math.exp(c[1][0]),a):[Math.exp(c[0][0]),Math.exp(c[1][0])]},s.toJSON=function(){return this.recalcMatrix(this.lastT()),{center:this.computedCenter.slice(),rotation:this.computedRotation.slice(),distance:Math.log(this.computedRadius[0]),zoomMin:this.radius.bounds[0][0],zoomMax:this.radius.bounds[1][0]}},s.fromJSON=function(a){var c=this.lastT(),f=a.center;f&&this.center.set(c,f[0],f[1],f[2]);var g=a.rotation;g&&this.rotation.set(c,g[0],g[1],g[2],g[3]);var d=a.distance;d&&d>0&&this.radius.set(c,Math.log(d)),this.setDistanceLimits(a.zoomMin,a.zoomMax)}},{"./lib/quatFromFrame":500,"filtered-vector":242,"gl-mat4/fromQuat":282,"gl-mat4/invert":293,"gl-mat4/lookAt":294}],502:[function(n,z,q){"use strict";var t=n("repeat-string");z.exports=function(h,p,l){return t(l=typeof l<"u"?l+"":" ",p)+h}},{"repeat-string":541}],503:[function(n,z,q){"use strict";function t(l,e){if(typeof l!="string")return[l];var o=[l];typeof e=="string"||Array.isArray(e)?e={brackets:e}:e||(e={});var r=e.brackets?Array.isArray(e.brackets)?e.brackets:[e.brackets]:["{}","[]","()"],i=e.escape||"___",u=!!e.flat;r.forEach(function(a){var c=new RegExp(["\\",a[0],"[^\\",a[0],"\\",a[1],"]*\\",a[1]].join("")),f=[];function g(d,m,y){var v=o.push(d.slice(a[0].length,-a[1].length))-1;return f.push(v),i+v+i}o.forEach(function(d,m){for(var y,v=0;d!=y;)if(y=d,d=d.replace(c,g),v++>1e4)throw Error("References have circular dependency. Please, check them.");o[m]=d}),f=f.reverse(),o=o.map(function(d){return f.forEach(function(m){d=d.replace(new RegExp("(\\"+i+m+"\\"+i+")","g"),a[0]+"$1"+a[1])}),d})});var s=new RegExp("\\"+i+"([0-9]+)\\"+i);return u?o:function a(c,f,g){for(var d,m=[],y=0;d=s.exec(c);){if(y++>1e4)throw Error("Circular references in parenthesis");m.push(c.slice(0,d.index)),m.push(a(f[d[1]],f)),c=c.slice(d.index+d[0].length)}return m.push(c),m}(o[0],o)}function h(l,e){if(e&&e.flat){var o,r=e&&e.escape||"___",i=l[0];if(!i)return"";for(var u=new RegExp("\\"+r+"([0-9]+)\\"+r),s=0;i!=o;){if(s++>1e4)throw Error("Circular references in "+l);o=i,i=i.replace(u,a)}return i}return l.reduce(function c(f,g){return Array.isArray(g)&&(g=g.reduce(c,"")),f+g},"");function a(c,f){if(l[f]==null)throw Error("Reference "+f+"is undefined");return l[f]}}function p(l,e){return Array.isArray(l)?h(l,e):t(l,e)}p.parse=t,p.stringify=h,z.exports=p},{}],504:[function(n,z,q){"use strict";var t=n("pick-by-alias");z.exports=function(h){var p;return arguments.length>1&&(h=arguments),typeof h=="string"?h=h.split(/\s/).map(parseFloat):typeof h=="number"&&(h=[h]),h.length&&typeof h[0]=="number"?p=h.length===1?{width:h[0],height:h[0],x:0,y:0}:h.length===2?{width:h[0],height:h[1],x:0,y:0}:{x:h[0],y:h[1],width:h[2]-h[0]||0,height:h[3]-h[1]||0}:h&&(h=t(h,{left:"x l left Left",top:"y t top Top",width:"w width W Width",height:"h height W Width",bottom:"b bottom Bottom",right:"r right Right"}),p={x:h.left||0,y:h.top||0},h.width==null?h.right?p.width=h.right-p.x:p.width=0:p.width=h.width,h.height==null?h.bottom?p.height=h.bottom-p.y:p.height=0:p.height=h.height),p}},{"pick-by-alias":511}],505:[function(n,z,q){z.exports=function(l){var e=[];return l.replace(h,function(o,r,i){var u=r.toLowerCase();for(i=function(s){var a=s.match(p);return a?a.map(Number):[]}(i),u=="m"&&i.length>2&&(e.push([r].concat(i.splice(0,2))),u="l",r=r=="m"?"l":"L");;){if(i.length==t[u])return i.unshift(r),e.push(i);if(i.length<t[u])throw new Error("malformed path data");e.push([r].concat(i.splice(0,t[u])))}}),e};var t={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},h=/([astvzqmhlc])([^astvzqmhlc]*)/gi,p=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/gi},{}],506:[function(n,z,q){z.exports=function(t,h){h||(h=[0,""]),t=String(t);var p=parseFloat(t,10);return h[0]=p,h[1]=t.match(/[\d.\-\+]*\s*(.*)/)[1]||"",h}},{}],507:[function(n,z,q){(function(t){(function(){"use strict";function h(e){if(typeof e!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}function p(e,o){for(var r,i="",u=0,s=-1,a=0,c=0;c<=e.length;++c){if(c<e.length)r=e.charCodeAt(c);else{if(r===47)break;r=47}if(r===47){if(!(s===c-1||a===1))if(s!==c-1&&a===2){if(i.length<2||u!==2||i.charCodeAt(i.length-1)!==46||i.charCodeAt(i.length-2)!==46){if(i.length>2){var f=i.lastIndexOf("/");if(f!==i.length-1){f===-1?(i="",u=0):u=(i=i.slice(0,f)).length-1-i.lastIndexOf("/"),s=c,a=0;continue}}else if(i.length===2||i.length===1){i="",u=0,s=c,a=0;continue}}o&&(i.length>0?i+="/..":i="..",u=2)}else i.length>0?i+="/"+e.slice(s+1,c):i=e.slice(s+1,c),u=c-s-1;s=c,a=0}else r===46&&a!==-1?++a:a=-1}return i}var l={resolve:function(){for(var e,o="",r=!1,i=arguments.length-1;i>=-1&&!r;i--){var u;i>=0?u=arguments[i]:(e===void 0&&(e=t.cwd()),u=e),h(u),u.length!==0&&(o=u+"/"+o,r=u.charCodeAt(0)===47)}return o=p(o,!r),r?o.length>0?"/"+o:"/":o.length>0?o:"."},normalize:function(e){if(h(e),e.length===0)return".";var o=e.charCodeAt(0)===47,r=e.charCodeAt(e.length-1)===47;return(e=p(e,!o)).length!==0||o||(e="."),e.length>0&&r&&(e+="/"),o?"/"+e:e},isAbsolute:function(e){return h(e),e.length>0&&e.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var e,o=0;o<arguments.length;++o){var r=arguments[o];h(r),r.length>0&&(e===void 0?e=r:e+="/"+r)}return e===void 0?".":l.normalize(e)},relative:function(e,o){if(h(e),h(o),e===o||(e=l.resolve(e))===(o=l.resolve(o)))return"";for(var r=1;r<e.length&&e.charCodeAt(r)===47;++r);for(var i=e.length,u=i-r,s=1;s<o.length&&o.charCodeAt(s)===47;++s);for(var a=o.length-s,c=u<a?u:a,f=-1,g=0;g<=c;++g){if(g===c){if(a>c){if(o.charCodeAt(s+g)===47)return o.slice(s+g+1);if(g===0)return o.slice(s+g)}else u>c&&(e.charCodeAt(r+g)===47?f=g:g===0&&(f=0));break}var d=e.charCodeAt(r+g);if(d!==o.charCodeAt(s+g))break;d===47&&(f=g)}var m="";for(g=r+f+1;g<=i;++g)g!==i&&e.charCodeAt(g)!==47||(m.length===0?m+="..":m+="/..");return m.length>0?m+o.slice(s+f):(s+=f,o.charCodeAt(s)===47&&++s,o.slice(s))},_makeLong:function(e){return e},dirname:function(e){if(h(e),e.length===0)return".";for(var o=e.charCodeAt(0),r=o===47,i=-1,u=!0,s=e.length-1;s>=1;--s)if((o=e.charCodeAt(s))===47){if(!u){i=s;break}}else u=!1;return i===-1?r?"/":".":r&&i===1?"//":e.slice(0,i)},basename:function(e,o){if(o!==void 0&&typeof o!="string")throw new TypeError('"ext" argument must be a string');h(e);var r,i=0,u=-1,s=!0;if(o!==void 0&&o.length>0&&o.length<=e.length){if(o.length===e.length&&o===e)return"";var a=o.length-1,c=-1;for(r=e.length-1;r>=0;--r){var f=e.charCodeAt(r);if(f===47){if(!s){i=r+1;break}}else c===-1&&(s=!1,c=r+1),a>=0&&(f===o.charCodeAt(a)?--a==-1&&(u=r):(a=-1,u=c))}return i===u?u=c:u===-1&&(u=e.length),e.slice(i,u)}for(r=e.length-1;r>=0;--r)if(e.charCodeAt(r)===47){if(!s){i=r+1;break}}else u===-1&&(s=!1,u=r+1);return u===-1?"":e.slice(i,u)},extname:function(e){h(e);for(var o=-1,r=0,i=-1,u=!0,s=0,a=e.length-1;a>=0;--a){var c=e.charCodeAt(a);if(c!==47)i===-1&&(u=!1,i=a+1),c===46?o===-1?o=a:s!==1&&(s=1):o!==-1&&(s=-1);else if(!u){r=a+1;break}}return o===-1||i===-1||s===0||s===1&&o===i-1&&o===r+1?"":e.slice(o,i)},format:function(e){if(e===null||typeof e!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return function(o,r){var i=r.dir||r.root,u=r.base||(r.name||"")+(r.ext||"");return i?i===r.root?i+u:i+o+u:u}("/",e)},parse:function(e){h(e);var o={root:"",dir:"",base:"",ext:"",name:""};if(e.length===0)return o;var r,i=e.charCodeAt(0),u=i===47;u?(o.root="/",r=1):r=0;for(var s=-1,a=0,c=-1,f=!0,g=e.length-1,d=0;g>=r;--g)if((i=e.charCodeAt(g))!==47)c===-1&&(f=!1,c=g+1),i===46?s===-1?s=g:d!==1&&(d=1):s!==-1&&(d=-1);else if(!f){a=g+1;break}return s===-1||c===-1||d===0||d===1&&s===c-1&&s===a+1?c!==-1&&(o.base=o.name=a===0&&u?e.slice(1,c):e.slice(a,c)):(a===0&&u?(o.name=e.slice(1,s),o.base=e.slice(1,c)):(o.name=e.slice(a,s),o.base=e.slice(a,c)),o.ext=e.slice(s,c)),a>0?o.dir=e.slice(0,a-1):u&&(o.dir="/"),o},sep:"/",delimiter:":",win32:null,posix:null};l.posix=l,z.exports=l}).call(this)}).call(this,n("_process"))},{_process:526}],508:[function(n,z,q){(function(t){(function(){(function(){var h,p,l,e,o,r;typeof performance<"u"&&performance!==null&&performance.now?z.exports=function(){return performance.now()}:typeof t<"u"&&t!==null&&t.hrtime?(z.exports=function(){return(h()-o)/1e6},p=t.hrtime,e=(h=function(){var i;return 1e9*(i=p())[0]+i[1]})(),r=1e9*t.uptime(),o=e-r):Date.now?(z.exports=function(){return Date.now()-l},l=Date.now()):(z.exports=function(){return new Date().getTime()-l},l=new Date().getTime())}).call(this)}).call(this)}).call(this,n("_process"))},{_process:526}],509:[function(n,z,q){"use strict";z.exports=function(h){var p=h.length;if(p<32){for(var l=1,e=0;e<p;++e)for(var o=0;o<e;++o)if(h[e]<h[o])l=-l;else if(h[e]===h[o])return 0;return l}var r=t.mallocUint8(p);for(e=0;e<p;++e)r[e]=0;for(l=1,e=0;e<p;++e)if(!r[e]){var i=1;for(r[e]=1,o=h[e];o!==e;o=h[o]){if(r[o])return t.freeUint8(r),0;i+=1,r[o]=1}1&i||(l=-l)}return t.freeUint8(r),l};var t=n("typedarray-pool")},{"typedarray-pool":595}],510:[function(n,z,q){"use strict";var t=n("typedarray-pool"),h=n("invert-permutation");q.rank=function(p){var l=p.length;switch(l){case 0:case 1:return 0;case 2:return p[1]}var e,o,r,i=t.mallocUint32(l),u=t.mallocUint32(l),s=0;for(h(p,u),r=0;r<l;++r)i[r]=p[r];for(r=l-1;r>0;--r)o=u[r],e=i[r],i[r]=i[o],i[o]=e,u[r]=u[e],u[e]=o,s=(s+e)*r;return t.freeUint32(u),t.freeUint32(i),s},q.unrank=function(p,l,e){switch(p){case 0:return e||[];case 1:return e?(e[0]=0,e):[0];case 2:return e?(l?(e[0]=0,e[1]=1):(e[0]=1,e[1]=0),e):l?[0,1]:[1,0]}var o,r,i,u=1;for((e=e||new Array(p))[0]=0,i=1;i<p;++i)e[i]=i,u=u*i|0;for(i=p-1;i>0;--i)l=l-(o=l/u|0)*u|0,u=u/i|0,r=0|e[i],e[i]=0|e[o],e[o]=0|r;return e}},{"invert-permutation":462,"typedarray-pool":595}],511:[function(n,z,q){"use strict";z.exports=function(p,l,e){var o,r,i={};if(typeof l=="string"&&(l=h(l)),Array.isArray(l)){var u={};for(r=0;r<l.length;r++)u[l[r]]=!0;l=u}for(o in l)l[o]=h(l[o]);var s={};for(o in l){var a=l[o];if(Array.isArray(a))for(r=0;r<a.length;r++){var c=a[r];if(e&&(s[c]=!0),c in p){if(i[o]=p[c],e)for(var f=r;f<a.length;f++)s[a[f]]=!0;break}}else o in p&&(l[o]&&(i[o]=p[o]),e&&(s[o]=!0))}if(e)for(o in p)s[o]||(i[o]=p[o]);return i};var t={};function h(p){return t[p]?t[p]:(typeof p=="string"&&(p=t[p]=p.split(/\s*,\s*|\s+/)),p)}},{}],512:[function(n,z,q){"use strict";z.exports=function(h,p){for(var l=0|p.length,e=h.length,o=[new Array(l),new Array(l)],r=0;r<l;++r)o[0][r]=[],o[1][r]=[];for(r=0;r<e;++r){var i=h[r];o[0][i[0]].push(i),o[1][i[1]].push(i)}var u=[];for(r=0;r<l;++r)o[0][r].length+o[1][r].length===0&&u.push([r]);function s(y,v){var T=o[v][y[v]];T.splice(T.indexOf(y),1)}function a(y,v,T){for(var w,A,E,M=0;M<2;++M)if(o[M][v].length>0){w=o[M][v][0],E=M;break}A=w[1^E];for(var b=0;b<2;++b)for(var _=o[b][v],S=0;S<_.length;++S){var C=_[S],k=C[1^b];t(p[y],p[v],p[A],p[k])>0&&(w=C,A=k,E=b)}return T||w&&s(w,E),A}function c(y,v){var T=o[v][y][0],w=[y];s(T,v);for(var A=T[1^v];;){for(;A!==y;)w.push(A),A=a(w[w.length-2],A,!1);if(o[0][y].length+o[1][y].length===0)break;var E=w[w.length-1],M=y,b=w[1],_=a(E,M,!0);if(t(p[E],p[M],p[b],p[_])<0)break;w.push(y),A=a(E,M)}return w}function f(y,v){return v[1]===v[v.length-1]}for(r=0;r<l;++r)for(var g=0;g<2;++g){for(var d=[];o[g][r].length>0;){o[0][r].length;var m=c(r,g);f(0,m)?d.push.apply(d,m):(d.length>0&&u.push(d),d=m)}d.length>0&&u.push(d)}return u};var t=n("compare-angle")},{"compare-angle":132}],513:[function(n,z,q){"use strict";z.exports=function(h,p){for(var l=t(h,p.length),e=new Array(p.length),o=new Array(p.length),r=[],i=0;i<p.length;++i){var u=l[i].length;o[i]=u,e[i]=!0,u<=1&&r.push(i)}for(;r.length>0;){var s=r.pop();e[s]=!1;var a=l[s];for(i=0;i<a.length;++i){var c=a[i];--o[c]==0&&r.push(c)}}var f=new Array(p.length),g=[];for(i=0;i<p.length;++i)e[i]?(s=g.length,f[i]=s,g.push(p[i])):f[i]=-1;var d=[];for(i=0;i<h.length;++i){var m=h[i];e[m[0]]&&e[m[1]]&&d.push([f[m[0]],f[m[1]]])}return[d,g]};var t=n("edges-to-adjacency-list")},{"edges-to-adjacency-list":178}],514:[function(n,z,q){"use strict";z.exports=function(u,s){var a=r(u,s);u=a[0];for(var c=(s=a[1]).length,f=(u.length,t(u,s.length)),g=0;g<c;++g)if(f[g].length%2==1)throw new Error("planar-graph-to-polyline: graph must be manifold");var d=h(u,s),m=(d=d.filter(function(ie){for(var ae=ie.length,oe=[0],de=0;de<ae;++de){var le=s[ie[de]],fe=s[ie[(de+1)%ae]],ue=l(-le[0],le[1]),we=l(-le[0],fe[1]),Ae=l(fe[0],le[1]),Se=l(fe[0],fe[1]);oe=e(oe,e(e(ue,we),e(Ae,Se)))}return oe[oe.length-1]>0})).length,y=new Array(m),v=new Array(m);for(g=0;g<m;++g){y[g]=g;var T=new Array(m),w=d[g].map(function(ie){return s[ie]}),A=p([w]),E=0;e:for(var M=0;M<m;++M)if(T[M]=0,g!==M){for(var b=($=d[M]).length,_=0;_<b;++_){var S=A(s[$[_]]);if(S!==0){S<0&&(T[M]=1,E+=1);continue e}}T[M]=1,E+=1}v[g]=[E,g,T]}for(v.sort(function(ie,ae){return ae[0]-ie[0]}),g=0;g<m;++g){var C=(T=v[g])[1],k=T[2];for(M=0;M<m;++M)k[M]&&(y[M]=C)}var L=function(ie){for(var ae=new Array(ie),oe=0;oe<ie;++oe)ae[oe]=[];return ae}(m);for(g=0;g<m;++g)L[g].push(y[g]),L[y[g]].push(g);var I={},R=i(c,!1);for(g=0;g<m;++g)for(b=($=d[g]).length,M=0;M<b;++M){var V=$[M],O=$[(M+1)%b],J=Math.min(V,O)+":"+Math.max(V,O);if(J in I){var D=I[J];L[D].push(g),L[g].push(D),R[V]=R[O]=!0}else I[J]=g}function B(ie){for(var ae=ie.length,oe=0;oe<ae;++oe)if(!R[ie[oe]])return!1;return!0}var N=[],F=i(m,-1);for(g=0;g<m;++g)y[g]!==g||B(d[g])?F[g]=-1:(N.push(g),F[g]=0);for(a=[];N.length>0;){var H=N.pop(),j=L[H];o(j,function(ie,ae){return ie-ae});var G,W=j.length,Q=F[H];if(Q===0){var $=d[H];G=[$]}for(g=0;g<W;++g){var ee=j[g];F[ee]>=0||(F[ee]=1^Q,N.push(ee),Q===0&&(B($=d[ee])||($.reverse(),G.push($))))}Q===0&&a.push(G)}return a};var t=n("edges-to-adjacency-list"),h=n("planar-dual"),p=n("point-in-big-polygon"),l=n("two-product"),e=n("robust-sum"),o=n("uniq"),r=n("./lib/trim-leaves");function i(u,s){for(var a=new Array(u),c=0;c<u;++c)a[c]=s;return a}},{"./lib/trim-leaves":513,"edges-to-adjacency-list":178,"planar-dual":512,"point-in-big-polygon":516,"robust-sum":553,"two-product":582,uniq:597}],515:[function(n,z,q){arguments[4][243][0].apply(q,arguments)},{dup:243}],516:[function(n,z,q){z.exports=function(i){for(var u=i.length,s=[],a=[],c=0;c<u;++c)for(var f=i[c],g=f.length,d=g-1,m=0;m<g;d=m++){var y=f[d],v=f[m];y[0]===v[0]?a.push([y,v]):s.push([y,v])}if(s.length===0)return a.length===0?r:(T=o(a),function(E){return T(E[0],E[1])?0:1});var T,w=h(s),A=function(E,M){return function(b){var _=l.le(M,b[0]);if(_<0)return 1;var S=E[_];if(!S){if(!(_>0&&M[_]===b[0]))return 1;S=E[_-1]}for(var C=1;S;){var k=S.key,L=t(b,k[0],k[1]);if(k[0][0]<k[1][0])if(L<0)S=S.left;else{if(!(L>0))return 0;C=-1,S=S.right}else if(L>0)S=S.left;else{if(!(L<0))return 0;C=1,S=S.right}}return C}}(w.slabs,w.coordinates);return a.length===0?A:function(E,M){return function(b){return E(b[0],b[1])?0:M(b)}}(o(a),A)};var t=n("robust-orientation")[3],h=n("slab-decomposition"),p=n("interval-tree-1d"),l=n("binary-search-bounds");function e(){return!0}function o(i){for(var u={},s=0;s<i.length;++s){var a=i[s],c=a[0][0],f=a[0][1],g=a[1][1],d=[Math.min(f,g),Math.max(f,g)];c in u?u[c].push(d):u[c]=[d]}var m={},y=Object.keys(u);for(s=0;s<y.length;++s){var v=u[y[s]];m[y[s]]=p(v)}return function(T){return function(w,A){var E=T[w];return!!E&&!!E.queryPoint(A,e)}}(m)}function r(i){return 1}},{"binary-search-bounds":515,"interval-tree-1d":460,"robust-orientation":548,"slab-decomposition":565}],517:[function(n,z,q){var t,h=n("./lib/build-log"),p=n("./lib/epsilon"),l=n("./lib/intersecter"),e=n("./lib/segment-chainer"),o=n("./lib/segment-selector"),r=n("./lib/geojson"),i=!1,u=p();function s(a,c,f){var g=t.segments(a),d=t.segments(c),m=f(t.combine(g,d));return t.polygon(m)}t={buildLog:function(a){return a===!0?i=h():a===!1&&(i=!1),i!==!1&&i.list},epsilon:function(a){return u.epsilon(a)},segments:function(a){var c=l(!0,u,i);return a.regions.forEach(c.addRegion),{segments:c.calculate(a.inverted),inverted:a.inverted}},combine:function(a,c){return{combined:l(!1,u,i).calculate(a.segments,a.inverted,c.segments,c.inverted),inverted1:a.inverted,inverted2:c.inverted}},selectUnion:function(a){return{segments:o.union(a.combined,i),inverted:a.inverted1||a.inverted2}},selectIntersect:function(a){return{segments:o.intersect(a.combined,i),inverted:a.inverted1&&a.inverted2}},selectDifference:function(a){return{segments:o.difference(a.combined,i),inverted:a.inverted1&&!a.inverted2}},selectDifferenceRev:function(a){return{segments:o.differenceRev(a.combined,i),inverted:!a.inverted1&&a.inverted2}},selectXor:function(a){return{segments:o.xor(a.combined,i),inverted:a.inverted1!==a.inverted2}},polygon:function(a){return{regions:e(a.segments,u,i),inverted:a.inverted}},polygonFromGeoJSON:function(a){return r.toPolygon(t,a)},polygonToGeoJSON:function(a){return r.fromPolygon(t,u,a)},union:function(a,c){return s(a,c,t.selectUnion)},intersect:function(a,c){return s(a,c,t.selectIntersect)},difference:function(a,c){return s(a,c,t.selectDifference)},differenceRev:function(a,c){return s(a,c,t.selectDifferenceRev)},xor:function(a,c){return s(a,c,t.selectXor)}},typeof window=="object"&&(window.PolyBool=t),z.exports=t},{"./lib/build-log":518,"./lib/epsilon":519,"./lib/geojson":520,"./lib/intersecter":521,"./lib/segment-chainer":523,"./lib/segment-selector":524}],518:[function(n,z,q){z.exports=function(){var t,h=0,p=!1;function l(e,o){return t.list.push({type:e,data:o?JSON.parse(JSON.stringify(o)):void 0}),t}return t={list:[],segmentId:function(){return h++},checkIntersection:function(e,o){return l("check",{seg1:e,seg2:o})},segmentChop:function(e,o){return l("div_seg",{seg:e,pt:o}),l("chop",{seg:e,pt:o})},statusRemove:function(e){return l("pop_seg",{seg:e})},segmentUpdate:function(e){return l("seg_update",{seg:e})},segmentNew:function(e,o){return l("new_seg",{seg:e,primary:o})},segmentRemove:function(e){return l("rem_seg",{seg:e})},tempStatus:function(e,o,r){return l("temp_status",{seg:e,above:o,below:r})},rewind:function(e){return l("rewind",{seg:e})},status:function(e,o,r){return l("status",{seg:e,above:o,below:r})},vert:function(e){return e===p?t:(p=e,l("vert",{x:e}))},log:function(e){return typeof e!="string"&&(e=JSON.stringify(e,!1,"  ")),l("log",{txt:e})},reset:function(){return l("reset")},selected:function(e){return l("selected",{segs:e})},chainStart:function(e){return l("chain_start",{seg:e})},chainRemoveHead:function(e,o){return l("chain_rem_head",{index:e,pt:o})},chainRemoveTail:function(e,o){return l("chain_rem_tail",{index:e,pt:o})},chainNew:function(e,o){return l("chain_new",{pt1:e,pt2:o})},chainMatch:function(e){return l("chain_match",{index:e})},chainClose:function(e){return l("chain_close",{index:e})},chainAddHead:function(e,o){return l("chain_add_head",{index:e,pt:o})},chainAddTail:function(e,o){return l("chain_add_tail",{index:e,pt:o})},chainConnect:function(e,o){return l("chain_con",{index1:e,index2:o})},chainReverse:function(e){return l("chain_rev",{index:e})},chainJoin:function(e,o){return l("chain_join",{index1:e,index2:o})},done:function(){return l("done")}}}},{}],519:[function(n,z,q){z.exports=function(t){typeof t!="number"&&(t=1e-10);var h={epsilon:function(p){return typeof p=="number"&&(t=p),t},pointAboveOrOnLine:function(p,l,e){var o=l[0],r=l[1],i=e[0],u=e[1],s=p[0];return(i-o)*(p[1]-r)-(u-r)*(s-o)>=-t},pointBetween:function(p,l,e){var o=p[1]-l[1],r=e[0]-l[0],i=p[0]-l[0],u=e[1]-l[1],s=i*r+o*u;return!(s<t)&&!(s-(r*r+u*u)>-t)},pointsSameX:function(p,l){return Math.abs(p[0]-l[0])<t},pointsSameY:function(p,l){return Math.abs(p[1]-l[1])<t},pointsSame:function(p,l){return h.pointsSameX(p,l)&&h.pointsSameY(p,l)},pointsCompare:function(p,l){return h.pointsSameX(p,l)?h.pointsSameY(p,l)?0:p[1]<l[1]?-1:1:p[0]<l[0]?-1:1},pointsCollinear:function(p,l,e){var o=p[0]-l[0],r=p[1]-l[1],i=l[0]-e[0],u=l[1]-e[1];return Math.abs(o*u-i*r)<t},linesIntersect:function(p,l,e,o){var r=l[0]-p[0],i=l[1]-p[1],u=o[0]-e[0],s=o[1]-e[1],a=r*s-i*u;if(Math.abs(a)<t)return!1;var c=p[0]-e[0],f=p[1]-e[1],g=(u*f-s*c)/a,d=(r*f-i*c)/a,m={alongA:0,alongB:0,pt:[p[0]+g*r,p[1]+g*i]};return m.alongA=g<=-t?-2:g<t?-1:g-1<=-t?0:g-1<t?1:2,m.alongB=d<=-t?-2:d<t?-1:d-1<=-t?0:d-1<t?1:2,m},pointInsideRegion:function(p,l){for(var e=p[0],o=p[1],r=l[l.length-1][0],i=l[l.length-1][1],u=!1,s=0;s<l.length;s++){var a=l[s][0],c=l[s][1];c-o>t!=i-o>t&&(r-a)*(o-c)/(i-c)+a-e>t&&(u=!u),r=a,i=c}return u}};return h}},{}],520:[function(n,z,q){var t={toPolygon:function(h,p){function l(r){if(r.length<=0)return h.segments({inverted:!1,regions:[]});function i(a){var c=a.slice(0,a.length-1);return h.segments({inverted:!1,regions:[c]})}for(var u=i(r[0]),s=1;s<r.length;s++)u=h.selectDifference(h.combine(u,i(r[s])));return u}if(p.type==="Polygon")return h.polygon(l(p.coordinates));if(p.type==="MultiPolygon"){for(var e=h.segments({inverted:!1,regions:[]}),o=0;o<p.coordinates.length;o++)e=h.selectUnion(h.combine(e,l(p.coordinates[o])));return h.polygon(e)}throw new Error("PolyBool: Cannot convert GeoJSON object to PolyBool polygon")},fromPolygon:function(h,p,l){function e(d,m){return p.pointInsideRegion([.5*(d[0][0]+d[1][0]),.5*(d[0][1]+d[1][1])],m)}function o(d){return{region:d,children:[]}}l=h.polygon(h.segments(l));var r=o(null);function i(d,m){for(var y=0;y<d.children.length;y++)if(e(m,(T=d.children[y]).region))return void i(T,m);var v=o(m);for(y=0;y<d.children.length;y++){var T;e((T=d.children[y]).region,m)&&(v.children.push(T),d.children.splice(y,1),y--)}d.children.push(v)}for(var u=0;u<l.regions.length;u++){var s=l.regions[u];s.length<3||i(r,s)}function a(d,m){for(var y=0,v=d[d.length-1][0],T=d[d.length-1][1],w=[],A=0;A<d.length;A++){var E=d[A][0],M=d[A][1];w.push([E,M]),y+=M*v-E*T,v=E,T=M}return y<0!==m&&w.reverse(),w.push([w[0][0],w[0][1]]),w}var c=[];function f(d){var m=[a(d.region,!1)];c.push(m);for(var y=0;y<d.children.length;y++)m.push(g(d.children[y]))}function g(d){for(var m=0;m<d.children.length;m++)f(d.children[m]);return a(d.region,!0)}for(u=0;u<r.children.length;u++)f(r.children[u]);return c.length<=0?{type:"Polygon",coordinates:[]}:c.length==1?{type:"Polygon",coordinates:c[0]}:{type:"MultiPolygon",coordinates:c}}};z.exports=t},{}],521:[function(n,z,q){var t=n("./linked-list");z.exports=function(h,p,l){function e(a,c,f){return{id:l?l.segmentId():-1,start:a,end:c,myFill:{above:f.myFill.above,below:f.myFill.below},otherFill:null}}var o=t.create();function r(a,c){o.insertBefore(a,function(f){return function(g,d,m,y,v,T){var w=p.pointsCompare(d,v);return w!==0?w:p.pointsSame(m,T)?0:g!==y?g?1:-1:p.pointAboveOrOnLine(m,y?v:T,y?T:v)?1:-1}(a.isStart,a.pt,c,f.isStart,f.pt,f.other.pt)<0})}function i(a,c){var f=function(g,d){var m=t.node({isStart:!0,pt:g.start,seg:g,primary:d,other:null,status:null});return r(m,g.end),m}(a,c);return function(g,d,m){var y=t.node({isStart:!1,pt:d.end,seg:d,primary:m,other:g,status:null});g.other=y,r(y,g.pt)}(f,a,c),f}function u(a,c){var f=e(c,a.seg.end,a.seg);return function(g,d){l&&l.segmentChop(g.seg,d),g.other.remove(),g.seg.end=d,g.other.pt=d,r(g.other,g.pt)}(a,c),i(f,a.primary)}function s(a,c){var f=t.create();function g(S){return f.findTransition(function(C){var k,L,I,R,V,O;return k=S,L=C.ev,I=k.seg.start,R=k.seg.end,V=L.seg.start,O=L.seg.end,(p.pointsCollinear(I,V,O)?p.pointsCollinear(R,V,O)||p.pointAboveOrOnLine(R,V,O)?1:-1:p.pointAboveOrOnLine(I,V,O)?1:-1)>0})}function d(S,C){var k=S.seg,L=C.seg,I=k.start,R=k.end,V=L.start,O=L.end;l&&l.checkIntersection(k,L);var J=p.linesIntersect(I,R,V,O);if(J===!1){if(!p.pointsCollinear(I,R,V)||p.pointsSame(I,O)||p.pointsSame(R,V))return!1;var D=p.pointsSame(I,V),B=p.pointsSame(R,O);if(D&&B)return C;var N=!D&&p.pointBetween(I,V,O),F=!B&&p.pointBetween(R,V,O);if(D)return F?u(C,R):u(S,O),C;N&&(B||(F?u(C,R):u(S,O)),u(C,I))}else J.alongA===0&&(J.alongB===-1?u(S,V):J.alongB===0?u(S,J.pt):J.alongB===1&&u(S,O)),J.alongB===0&&(J.alongA===-1?u(C,I):J.alongA===0?u(C,J.pt):J.alongA===1&&u(C,R));return!1}for(var m=[];!o.isEmpty();){var y=o.getHead();if(l&&l.vert(y.pt[0]),y.isStart){let S=function(){if(T){var C=d(y,T);if(C)return C}return!!w&&d(y,w)};l&&l.segmentNew(y.seg,y.primary);var v=g(y),T=v.before?v.before.ev:null,w=v.after?v.after.ev:null;l&&l.tempStatus(y.seg,!!T&&T.seg,!!w&&w.seg);var A,E=S();if(E){var M;h?(M=y.seg.myFill.below===null||y.seg.myFill.above!==y.seg.myFill.below)&&(E.seg.myFill.above=!E.seg.myFill.above):E.seg.otherFill=y.seg.myFill,l&&l.segmentUpdate(E.seg),y.other.remove(),y.remove()}if(o.getHead()!==y){l&&l.rewind(y.seg);continue}h?(M=y.seg.myFill.below===null||y.seg.myFill.above!==y.seg.myFill.below,y.seg.myFill.below=w?w.seg.myFill.above:a,y.seg.myFill.above=M?!y.seg.myFill.below:y.seg.myFill.below):y.seg.otherFill===null&&(A=w?y.primary===w.primary?w.seg.otherFill.above:w.seg.myFill.above:y.primary?c:a,y.seg.otherFill={above:A,below:A}),l&&l.status(y.seg,!!T&&T.seg,!!w&&w.seg),y.other.status=v.insert(t.node({ev:y}))}else{var b=y.status;if(b===null)throw new Error("PolyBool: Zero-length segment detected; your epsilon is probably too small or too large");if(f.exists(b.prev)&&f.exists(b.next)&&d(b.prev.ev,b.next.ev),l&&l.statusRemove(b.ev.seg),b.remove(),!y.primary){var _=y.seg.myFill;y.seg.myFill=y.seg.otherFill,y.seg.otherFill=_}m.push(y.seg)}o.getHead().remove()}return l&&l.done(),m}return h?{addRegion:function(a){for(var c,f,g,d=a[a.length-1],m=0;m<a.length;m++){c=d,d=a[m];var y=p.pointsCompare(c,d);y!==0&&i((f=y<0?c:d,g=y<0?d:c,{id:l?l.segmentId():-1,start:f,end:g,myFill:{above:null,below:null},otherFill:null}),!0)}},calculate:function(a){return s(a,!1)}}:{calculate:function(a,c,f,g){return a.forEach(function(d){i(e(d.start,d.end,d),!0)}),f.forEach(function(d){i(e(d.start,d.end,d),!1)}),s(c,g)}}}},{"./linked-list":522}],522:[function(n,z,q){z.exports={create:function(){var t={root:{root:!0,next:null},exists:function(h){return h!==null&&h!==t.root},isEmpty:function(){return t.root.next===null},getHead:function(){return t.root.next},insertBefore:function(h,p){for(var l=t.root,e=t.root.next;e!==null;){if(p(e))return h.prev=e.prev,h.next=e,e.prev.next=h,void(e.prev=h);l=e,e=e.next}l.next=h,h.prev=l,h.next=null},findTransition:function(h){for(var p=t.root,l=t.root.next;l!==null&&!h(l);)p=l,l=l.next;return{before:p===t.root?null:p,after:l,insert:function(e){return e.prev=p,e.next=l,p.next=e,l!==null&&(l.prev=e),e}}}};return t},node:function(t){return t.prev=null,t.next=null,t.remove=function(){t.prev.next=t.next,t.next&&(t.next.prev=t.prev),t.prev=null,t.next=null},t}}},{}],523:[function(n,z,q){z.exports=function(t,h,p){var l=[],e=[];return t.forEach(function(o){var r=o.start,i=o.end;if(h.pointsSame(r,i))console.warn("PolyBool: Warning: Zero-length segment detected; your epsilon is probably too small or too large");else{p&&p.chainStart(o);for(var u={index:0,matches_head:!1,matches_pt1:!1},s={index:0,matches_head:!1,matches_pt1:!1},a=u,c=0;c<l.length;c++){var f=(v=l[c])[0],g=(v[1],v[v.length-1]);if(v[v.length-2],h.pointsSame(f,r)){if(S(c,!0,!0))break}else if(h.pointsSame(f,i)){if(S(c,!0,!1))break}else if(h.pointsSame(g,r)){if(S(c,!1,!0))break}else if(h.pointsSame(g,i)&&S(c,!1,!1))break}if(a===u)return l.push([r,i]),void(p&&p.chainNew(r,i));if(a===s){p&&p.chainMatch(u.index);var d=u.index,m=u.matches_pt1?i:r,y=u.matches_head,v=l[d],T=y?v[0]:v[v.length-1],w=y?v[1]:v[v.length-2],A=y?v[v.length-1]:v[0],E=y?v[v.length-2]:v[1];return h.pointsCollinear(w,T,m)&&(y?(p&&p.chainRemoveHead(u.index,m),v.shift()):(p&&p.chainRemoveTail(u.index,m),v.pop()),T=w),h.pointsSame(A,m)?(l.splice(d,1),h.pointsCollinear(E,A,T)&&(y?(p&&p.chainRemoveTail(u.index,T),v.pop()):(p&&p.chainRemoveHead(u.index,T),v.shift())),p&&p.chainClose(u.index),void e.push(v)):void(y?(p&&p.chainAddHead(u.index,m),v.unshift(m)):(p&&p.chainAddTail(u.index,m),v.push(m)))}var M=u.index,b=s.index;p&&p.chainConnect(M,b);var _=l[M].length<l[b].length;u.matches_head?s.matches_head?_?(C(M),k(M,b)):(C(b),k(b,M)):k(b,M):s.matches_head?k(M,b):_?(C(M),k(b,M)):(C(b),k(M,b))}function S(L,I,R){return a.index=L,a.matches_head=I,a.matches_pt1=R,a===u?(a=s,!1):(a=null,!0)}function C(L){p&&p.chainReverse(L),l[L].reverse()}function k(L,I){var R=l[L],V=l[I],O=R[R.length-1],J=R[R.length-2],D=V[0],B=V[1];h.pointsCollinear(J,O,D)&&(p&&p.chainRemoveTail(L,O),R.pop(),O=J),h.pointsCollinear(O,D,B)&&(p&&p.chainRemoveHead(I,D),V.shift()),p&&p.chainJoin(L,I),l[L]=R.concat(V),l.splice(I,1)}}),e}},{}],524:[function(n,z,q){function t(p,l,e){var o=[];return p.forEach(function(r){var i=(r.myFill.above?8:0)+(r.myFill.below?4:0)+(r.otherFill&&r.otherFill.above?2:0)+(r.otherFill&&r.otherFill.below?1:0);l[i]!==0&&o.push({id:e?e.segmentId():-1,start:r.start,end:r.end,myFill:{above:l[i]===1,below:l[i]===2},otherFill:null})}),e&&e.selected(o),o}var h={union:function(p,l){return t(p,[0,2,1,0,2,2,0,0,1,0,1,0,0,0,0,0],l)},intersect:function(p,l){return t(p,[0,0,0,0,0,2,0,2,0,0,1,1,0,2,1,0],l)},difference:function(p,l){return t(p,[0,0,0,0,2,0,2,0,1,1,0,0,0,1,2,0],l)},differenceRev:function(p,l){return t(p,[0,2,1,0,0,0,1,1,0,2,0,2,0,0,0,0],l)},xor:function(p,l){return t(p,[0,2,1,0,2,0,0,1,1,0,0,2,0,1,2,0],l)}};z.exports=h},{}],525:[function(n,z,q){"use strict";var t=new Float64Array(4),h=new Float64Array(4),p=new Float64Array(4);z.exports=function(l,e,o,r,i){t.length<r.length&&(t=new Float64Array(r.length),h=new Float64Array(r.length),p=new Float64Array(r.length));for(var u=0;u<r.length;++u)t[u]=l[u]-r[u],h[u]=e[u]-l[u],p[u]=o[u]-l[u];var s=0,a=0,c=0,f=0,g=0,d=0;for(u=0;u<r.length;++u){var m=h[u],y=p[u],v=t[u];s+=m*m,a+=m*y,c+=y*y,f+=v*m,g+=v*y,d+=v*v}var T,w,A,E,M,b=Math.abs(s*c-a*a),_=a*g-c*f,S=a*f-s*g;if(_+S<=b)if(_<0)S<0&&f<0?(S=0,-f>=s?(_=1,T=s+2*f+d):T=f*(_=-f/s)+d):(_=0,g>=0?(S=0,T=d):-g>=c?(S=1,T=c+2*g+d):T=g*(S=-g/c)+d);else if(S<0)S=0,f>=0?(_=0,T=d):-f>=s?(_=1,T=s+2*f+d):T=f*(_=-f/s)+d;else{var C=1/b;T=(_*=C)*(s*_+a*(S*=C)+2*f)+S*(a*_+c*S+2*g)+d}else _<0?(A=c+g)>(w=a+f)?(E=A-w)>=(M=s-2*a+c)?(_=1,S=0,T=s+2*f+d):T=(_=E/M)*(s*_+a*(S=1-_)+2*f)+S*(a*_+c*S+2*g)+d:(_=0,A<=0?(S=1,T=c+2*g+d):g>=0?(S=0,T=d):T=g*(S=-g/c)+d):S<0?(A=s+f)>(w=a+g)?(E=A-w)>=(M=s-2*a+c)?(S=1,_=0,T=c+2*g+d):T=(_=1-(S=E/M))*(s*_+a*S+2*f)+S*(a*_+c*S+2*g)+d:(S=0,A<=0?(_=1,T=s+2*f+d):f>=0?(_=0,T=d):T=f*(_=-f/s)+d):(E=c+g-a-f)<=0?(_=0,S=1,T=c+2*g+d):E>=(M=s-2*a+c)?(_=1,S=0,T=s+2*f+d):T=(_=E/M)*(s*_+a*(S=1-_)+2*f)+S*(a*_+c*S+2*g)+d;var k=1-_-S;for(u=0;u<r.length;++u)i[u]=k*l[u]+_*e[u]+S*o[u];return T<0?0:T}},{}],526:[function(n,z,q){var t,h,p=z.exports={};function l(){throw new Error("setTimeout has not been defined")}function e(){throw new Error("clearTimeout has not been defined")}function o(d){if(t===setTimeout)return setTimeout(d,0);if((t===l||!t)&&setTimeout)return t=setTimeout,setTimeout(d,0);try{return t(d,0)}catch{try{return t.call(null,d,0)}catch{return t.call(this,d,0)}}}(function(){try{t=typeof setTimeout=="function"?setTimeout:l}catch{t=l}try{h=typeof clearTimeout=="function"?clearTimeout:e}catch{h=e}})();var r,i=[],u=!1,s=-1;function a(){u&&r&&(u=!1,r.length?i=r.concat(i):s=-1,i.length&&c())}function c(){if(!u){var d=o(a);u=!0;for(var m=i.length;m;){for(r=i,i=[];++s<m;)r&&r[s].run();s=-1,m=i.length}r=null,u=!1,function(y){if(h===clearTimeout)return clearTimeout(y);if((h===e||!h)&&clearTimeout)return h=clearTimeout,clearTimeout(y);try{h(y)}catch{try{return h.call(null,y)}catch{return h.call(this,y)}}}(d)}}function f(d,m){this.fun=d,this.array=m}function g(){}p.nextTick=function(d){var m=new Array(arguments.length-1);if(arguments.length>1)for(var y=1;y<arguments.length;y++)m[y-1]=arguments[y];i.push(new f(d,m)),i.length!==1||u||o(c)},f.prototype.run=function(){this.fun.apply(null,this.array)},p.title="browser",p.browser=!0,p.env={},p.argv=[],p.version="",p.versions={},p.on=g,p.addListener=g,p.once=g,p.off=g,p.removeListener=g,p.removeAllListeners=g,p.emit=g,p.prependListener=g,p.prependOnceListener=g,p.listeners=function(d){return[]},p.binding=function(d){throw new Error("process.binding is not supported")},p.cwd=function(){return"/"},p.chdir=function(d){throw new Error("process.chdir is not supported")},p.umask=function(){return 0}},{}],527:[function(n,z,q){z.exports=n("gl-quat/slerp")},{"gl-quat/slerp":325}],528:[function(n,z,q){(function(t){(function(){for(var h=n("performance-now"),p=typeof window>"u"?t:window,l=["moz","webkit"],e="AnimationFrame",o=p["request"+e],r=p["cancel"+e]||p["cancelRequest"+e],i=0;!o&&i<l.length;i++)o=p[l[i]+"Request"+e],r=p[l[i]+"Cancel"+e]||p[l[i]+"CancelRequest"+e];if(!o||!r){var u=0,s=0,a=[];o=function(c){if(a.length===0){var f=h(),g=Math.max(0,1e3/60-(f-u));u=g+f,setTimeout(function(){var d=a.slice(0);a.length=0;for(var m=0;m<d.length;m++)if(!d[m].cancelled)try{d[m].callback(u)}catch(y){setTimeout(function(){throw y},0)}},Math.round(g))}return a.push({handle:++s,callback:c,cancelled:!1}),s},r=function(c){for(var f=0;f<a.length;f++)a[f].handle===c&&(a[f].cancelled=!0)}}z.exports=function(c){return o.call(p,c)},z.exports.cancel=function(){r.apply(p,arguments)},z.exports.polyfill=function(c){c||(c=p),c.requestAnimationFrame=o,c.cancelAnimationFrame=r}}).call(this)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{"performance-now":508}],529:[function(n,z,q){"use strict";var t=n("big-rat/add");z.exports=function(h,p){for(var l=h.length,e=new Array(l),o=0;o<l;++o)e[o]=t(h[o],p[o]);return e}},{"big-rat/add":80}],530:[function(n,z,q){"use strict";z.exports=function(h){for(var p=new Array(h.length),l=0;l<h.length;++l)p[l]=t(h[l]);return p};var t=n("big-rat")},{"big-rat":83}],531:[function(n,z,q){"use strict";var t=n("big-rat"),h=n("big-rat/mul");z.exports=function(p,l){for(var e=t(l),o=p.length,r=new Array(o),i=0;i<o;++i)r[i]=h(p[i],e);return r}},{"big-rat":83,"big-rat/mul":92}],532:[function(n,z,q){"use strict";var t=n("big-rat/sub");z.exports=function(h,p){for(var l=h.length,e=new Array(l),o=0;o<l;++o)e[o]=t(h[o],p[o]);return e}},{"big-rat/sub":94}],533:[function(n,z,q){"use strict";var t=n("compare-cell"),h=n("compare-oriented-cell"),p=n("cell-orientation");z.exports=function(l){l.sort(h);for(var e=l.length,o=0,r=0;r<e;++r){var i=l[r],u=p(i);if(u!==0){if(o>0){var s=l[o-1];if(t(i,s)===0&&p(s)!==u){o-=1;continue}}l[o++]=i}}return l.length=o,l}},{"cell-orientation":117,"compare-cell":133,"compare-oriented-cell":134}],534:[function(n,z,q){"use strict";var t=n("array-bounds"),h=n("color-normalize"),p=n("update-diff"),l=n("pick-by-alias"),e=n("object-assign"),o=n("flatten-vertex-data"),r=n("to-float32"),i=r.float32,u=r.fract32;z.exports=function(a,c){if(typeof a=="function"?(c||(c={}),c.regl=a):c=a,c.length&&(c.positions=c),!(a=c.regl).hasExtension("ANGLE_instanced_arrays"))throw Error("regl-error2d: `ANGLE_instanced_arrays` extension should be enabled");var f,g,d,m,y,v,T=a._gl,w={color:"black",capSize:5,lineWidth:1,opacity:1,viewport:null,range:null,offset:0,count:0,bounds:null,positions:[],errors:[]},A=[];return m=a.buffer({usage:"dynamic",type:"uint8",data:new Uint8Array(0)}),g=a.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),d=a.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),y=a.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),v=a.buffer({usage:"static",type:"float",data:s}),_(c),f=a({vert:`
		precision highp float;

		attribute vec2 position, positionFract;
		attribute vec4 error;
		attribute vec4 color;

		attribute vec2 direction, lineOffset, capOffset;

		uniform vec4 viewport;
		uniform float lineWidth, capSize;
		uniform vec2 scale, scaleFract, translate, translateFract;

		varying vec4 fragColor;

		void main() {
			fragColor = color / 255.;

			vec2 pixelOffset = lineWidth * lineOffset + (capSize + lineWidth) * capOffset;

			vec2 dxy = -step(.5, direction.xy) * error.xz + step(direction.xy, vec2(-.5)) * error.yw;

			vec2 position = position + dxy;

			vec2 pos = (position + translate) * scale
				+ (positionFract + translateFract) * scale
				+ (position + translate) * scaleFract
				+ (positionFract + translateFract) * scaleFract;

			pos += pixelOffset / viewport.zw;

			gl_Position = vec4(pos * 2. - 1., 0, 1);
		}
		`,frag:`
		precision highp float;

		varying vec4 fragColor;

		uniform float opacity;

		void main() {
			gl_FragColor = fragColor;
			gl_FragColor.a *= opacity;
		}
		`,uniforms:{range:a.prop("range"),lineWidth:a.prop("lineWidth"),capSize:a.prop("capSize"),opacity:a.prop("opacity"),scale:a.prop("scale"),translate:a.prop("translate"),scaleFract:a.prop("scaleFract"),translateFract:a.prop("translateFract"),viewport:function(C,k){return[k.viewport.x,k.viewport.y,C.viewportWidth,C.viewportHeight]}},attributes:{color:{buffer:m,offset:function(C,k){return 4*k.offset},divisor:1},position:{buffer:g,offset:function(C,k){return 8*k.offset},divisor:1},positionFract:{buffer:d,offset:function(C,k){return 8*k.offset},divisor:1},error:{buffer:y,offset:function(C,k){return 16*k.offset},divisor:1},direction:{buffer:v,stride:24,offset:0},lineOffset:{buffer:v,stride:24,offset:8},capOffset:{buffer:v,stride:24,offset:16}},primitive:"triangles",blend:{enable:!0,color:[0,0,0,0],equation:{rgb:"add",alpha:"add"},func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},depth:{enable:!1},scissor:{enable:!0,box:a.prop("viewport")},viewport:a.prop("viewport"),stencil:!1,instances:a.prop("count"),count:s.length}),e(E,{update:_,draw:M,destroy:S,regl:a,gl:T,canvas:T.canvas,groups:A}),E;function E(C){C?_(C):C===null&&S(),M()}function M(C){if(typeof C=="number")return b(C);C&&!Array.isArray(C)&&(C=[C]),a._refresh(),A.forEach(function(k,L){k&&(C&&(C[L]?k.draw=!0:k.draw=!1),k.draw?b(L):k.draw=!0)})}function b(C){typeof C=="number"&&(C=A[C]),C!=null&&C&&C.count&&C.color&&C.opacity&&C.positions&&C.positions.length>1&&(C.scaleRatio=[C.scale[0]*C.viewport.width,C.scale[1]*C.viewport.height],f(C),C.after&&C.after(C))}function _(C){if(C){C.length!=null?typeof C[0]=="number"&&(C=[{positions:C}]):Array.isArray(C)||(C=[C]);var k=0,L=0;if(E.groups=A=C.map(function(J,D){var B=A[D];return J&&(typeof J=="function"?J={after:J}:typeof J[0]=="number"&&(J={positions:J}),J=l(J,{color:"color colors fill",capSize:"capSize cap capsize cap-size",lineWidth:"lineWidth line-width width line thickness",opacity:"opacity alpha",range:"range dataBox",viewport:"viewport viewBox",errors:"errors error",positions:"positions position data points"}),B||(A[D]=B={id:D,scale:null,translate:null,scaleFract:null,translateFract:null,draw:!0},J=e({},w,J)),p(B,J,[{lineWidth:function(N){return .5*+N},capSize:function(N){return .5*+N},opacity:parseFloat,errors:function(N){return N=o(N),L+=N.length,N},positions:function(N,F){return N=o(N,"float64"),F.count=Math.floor(N.length/2),F.bounds=t(N,2),F.offset=k,k+=F.count,N}},{color:function(N,F){var H=F.count;if(N||(N="transparent"),!Array.isArray(N)||typeof N[0]=="number"){var j=N;N=Array(H);for(var G=0;G<H;G++)N[G]=j}if(N.length<H)throw Error("Not enough colors");for(var W=new Uint8Array(4*H),Q=0;Q<H;Q++){var $=h(N[Q],"uint8");W.set($,4*Q)}return W},range:function(N,F,H){var j=F.bounds;return N||(N=j),F.scale=[1/(N[2]-N[0]),1/(N[3]-N[1])],F.translate=[-N[0],-N[1]],F.scaleFract=u(F.scale),F.translateFract=u(F.translate),N},viewport:function(N){var F;return Array.isArray(N)?F={x:N[0],y:N[1],width:N[2]-N[0],height:N[3]-N[1]}:N?(F={x:N.x||N.left||0,y:N.y||N.top||0},N.right?F.width=N.right-F.x:F.width=N.w||N.width||0,N.bottom?F.height=N.bottom-F.y:F.height=N.h||N.height||0):F={x:0,y:0,width:T.drawingBufferWidth,height:T.drawingBufferHeight},F}}])),B}),k||L){var I=A.reduce(function(J,D,B){return J+(D?D.count:0)},0),R=new Float64Array(2*I),V=new Uint8Array(4*I),O=new Float32Array(4*I);A.forEach(function(J,D){if(J){var B=J.positions,N=J.count,F=J.offset,H=J.color,j=J.errors;N&&(V.set(H,4*F),O.set(j,4*F),R.set(B,2*F))}}),g(i(R)),d(u(R)),m(V),y(O)}}}function S(){g.destroy(),d.destroy(),m.destroy(),y.destroy(),v.destroy()}};var s=[[1,0,0,1,0,0],[1,0,0,-1,0,0],[-1,0,0,-1,0,0],[-1,0,0,-1,0,0],[-1,0,0,1,0,0],[1,0,0,1,0,0],[1,0,-1,0,0,1],[1,0,-1,0,0,-1],[1,0,1,0,0,-1],[1,0,1,0,0,-1],[1,0,1,0,0,1],[1,0,-1,0,0,1],[-1,0,-1,0,0,1],[-1,0,-1,0,0,-1],[-1,0,1,0,0,-1],[-1,0,1,0,0,-1],[-1,0,1,0,0,1],[-1,0,-1,0,0,1],[0,1,1,0,0,0],[0,1,-1,0,0,0],[0,-1,-1,0,0,0],[0,-1,-1,0,0,0],[0,1,1,0,0,0],[0,-1,1,0,0,0],[0,1,0,-1,1,0],[0,1,0,-1,-1,0],[0,1,0,1,-1,0],[0,1,0,1,1,0],[0,1,0,-1,1,0],[0,1,0,1,-1,0],[0,-1,0,-1,1,0],[0,-1,0,-1,-1,0],[0,-1,0,1,-1,0],[0,-1,0,1,1,0],[0,-1,0,-1,1,0],[0,-1,0,1,-1,0]]},{"array-bounds":70,"color-normalize":125,"flatten-vertex-data":244,"object-assign":499,"pick-by-alias":511,"to-float32":577,"update-diff":599}],535:[function(n,z,q){"use strict";var t=n("color-normalize"),h=n("array-bounds"),p=n("object-assign"),l=n("glslify"),e=n("pick-by-alias"),o=n("flatten-vertex-data"),r=n("earcut"),i=n("array-normalize"),u=n("to-float32"),s=u.float32,a=u.fract32,c=n("es6-weak-map"),f=n("parse-rect");function g(d,m){if(!(this instanceof g))return new g(d,m);if(typeof d=="function"?(m||(m={}),m.regl=d):m=d,m.length&&(m.positions=m),!(d=m.regl).hasExtension("ANGLE_instanced_arrays"))throw Error("regl-error2d: `ANGLE_instanced_arrays` extension should be enabled");this.gl=d._gl,this.regl=d,this.passes=[],this.shaders=g.shaders.has(d)?g.shaders.get(d):g.shaders.set(d,g.createShaders(d)).get(d),this.update(m)}z.exports=g,g.dashMult=2,g.maxPatternLength=256,g.precisionThreshold=3e6,g.maxPoints=1e4,g.maxLines=2048,g.shaders=new c,g.createShaders=function(d){var m,y=d.buffer({usage:"static",type:"float",data:[0,1,0,0,1,1,1,0]}),v={primitive:"triangle strip",instances:d.prop("count"),count:4,offset:0,uniforms:{miterMode:function(w,A){return A.join==="round"?2:1},miterLimit:d.prop("miterLimit"),scale:d.prop("scale"),scaleFract:d.prop("scaleFract"),translateFract:d.prop("translateFract"),translate:d.prop("translate"),thickness:d.prop("thickness"),dashPattern:d.prop("dashTexture"),opacity:d.prop("opacity"),pixelRatio:d.context("pixelRatio"),id:d.prop("id"),dashSize:d.prop("dashLength"),viewport:function(w,A){return[A.viewport.x,A.viewport.y,w.viewportWidth,w.viewportHeight]},depth:d.prop("depth")},blend:{enable:!0,color:[0,0,0,0],equation:{rgb:"add",alpha:"add"},func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},depth:{enable:function(w,A){return!A.overlay}},stencil:{enable:!1},scissor:{enable:!0,box:d.prop("viewport")},viewport:d.prop("viewport")},T=d(p({vert:l([`precision highp float;
#define GLSLIFY 1

attribute vec2 aCoord, bCoord, aCoordFract, bCoordFract;
attribute vec4 color;
attribute float lineEnd, lineTop;

uniform vec2 scale, scaleFract, translate, translateFract;
uniform float thickness, pixelRatio, id, depth;
uniform vec4 viewport;

varying vec4 fragColor;
varying vec2 tangent;

vec2 project(vec2 position, vec2 positionFract, vec2 scale, vec2 scaleFract, vec2 translate, vec2 translateFract) {
	// the order is important
	return position * scale + translate
       + positionFract * scale + translateFract
       + position * scaleFract
       + positionFract * scaleFract;
}

void main() {
	float lineStart = 1. - lineEnd;
	float lineOffset = lineTop * 2. - 1.;

	vec2 diff = (bCoord + bCoordFract - aCoord - aCoordFract);
	tangent = normalize(diff * scale * viewport.zw);
	vec2 normal = vec2(-tangent.y, tangent.x);

	vec2 position = project(aCoord, aCoordFract, scale, scaleFract, translate, translateFract) * lineStart
		+ project(bCoord, bCoordFract, scale, scaleFract, translate, translateFract) * lineEnd

		+ thickness * normal * .5 * lineOffset / viewport.zw;

	gl_Position = vec4(position * 2.0 - 1.0, depth, 1);

	fragColor = color / 255.;
}
`]),frag:l([`precision highp float;
#define GLSLIFY 1

uniform sampler2D dashPattern;

uniform float dashSize, pixelRatio, thickness, opacity, id;

varying vec4 fragColor;
varying vec2 tangent;

void main() {
	float alpha = 1.;

	float t = fract(dot(tangent, gl_FragCoord.xy) / dashSize) * .5 + .25;
	float dash = texture2D(dashPattern, vec2(t, .5)).r;

	gl_FragColor = fragColor;
	gl_FragColor.a *= alpha * opacity * dash;
}
`]),attributes:{lineEnd:{buffer:y,divisor:0,stride:8,offset:0},lineTop:{buffer:y,divisor:0,stride:8,offset:4},aCoord:{buffer:d.prop("positionBuffer"),stride:8,offset:8,divisor:1},bCoord:{buffer:d.prop("positionBuffer"),stride:8,offset:16,divisor:1},aCoordFract:{buffer:d.prop("positionFractBuffer"),stride:8,offset:8,divisor:1},bCoordFract:{buffer:d.prop("positionFractBuffer"),stride:8,offset:16,divisor:1},color:{buffer:d.prop("colorBuffer"),stride:4,offset:0,divisor:1}}},v));try{m=d(p({cull:{enable:!0,face:"back"},vert:l([`precision highp float;
#define GLSLIFY 1

attribute vec2 aCoord, bCoord, nextCoord, prevCoord;
attribute vec4 aColor, bColor;
attribute float lineEnd, lineTop;

uniform vec2 scale, translate;
uniform float thickness, pixelRatio, id, depth;
uniform vec4 viewport;
uniform float miterLimit, miterMode;

varying vec4 fragColor;
varying vec4 startCutoff, endCutoff;
varying vec2 tangent;
varying vec2 startCoord, endCoord;
varying float enableStartMiter, enableEndMiter;

const float REVERSE_THRESHOLD = -.875;
const float MIN_DIFF = 1e-6;

// TODO: possible optimizations: avoid overcalculating all for vertices and calc just one instead
// TODO: precalculate dot products, normalize things beforehead etc.
// TODO: refactor to rectangular algorithm

float distToLine(vec2 p, vec2 a, vec2 b) {
	vec2 diff = b - a;
	vec2 perp = normalize(vec2(-diff.y, diff.x));
	return dot(p - a, perp);
}

bool isNaN( float val ){
  return ( val < 0.0 || 0.0 < val || val == 0.0 ) ? false : true;
}

void main() {
	vec2 aCoord = aCoord, bCoord = bCoord, prevCoord = prevCoord, nextCoord = nextCoord;

  vec2 adjustedScale;
  adjustedScale.x = (abs(scale.x) < MIN_DIFF) ? MIN_DIFF : scale.x;
  adjustedScale.y = (abs(scale.y) < MIN_DIFF) ? MIN_DIFF : scale.y;

  vec2 scaleRatio = adjustedScale * viewport.zw;
	vec2 normalWidth = thickness / scaleRatio;

	float lineStart = 1. - lineEnd;
	float lineBot = 1. - lineTop;

	fragColor = (lineStart * aColor + lineEnd * bColor) / 255.;

	if (isNaN(aCoord.x) || isNaN(aCoord.y) || isNaN(bCoord.x) || isNaN(bCoord.y)) return;

	if (aCoord == prevCoord) prevCoord = aCoord + normalize(bCoord - aCoord);
	if (bCoord == nextCoord) nextCoord = bCoord - normalize(bCoord - aCoord);

	vec2 prevDiff = aCoord - prevCoord;
	vec2 currDiff = bCoord - aCoord;
	vec2 nextDiff = nextCoord - bCoord;

	vec2 prevTangent = normalize(prevDiff * scaleRatio);
	vec2 currTangent = normalize(currDiff * scaleRatio);
	vec2 nextTangent = normalize(nextDiff * scaleRatio);

	vec2 prevNormal = vec2(-prevTangent.y, prevTangent.x);
	vec2 currNormal = vec2(-currTangent.y, currTangent.x);
	vec2 nextNormal = vec2(-nextTangent.y, nextTangent.x);

	vec2 startJoinDirection = normalize(prevTangent - currTangent);
	vec2 endJoinDirection = normalize(currTangent - nextTangent);

	// collapsed/unidirectional segment cases
	// FIXME: there should be more elegant solution
	vec2 prevTanDiff = abs(prevTangent - currTangent);
	vec2 nextTanDiff = abs(nextTangent - currTangent);
	if (max(prevTanDiff.x, prevTanDiff.y) < MIN_DIFF) {
		startJoinDirection = currNormal;
	}
	if (max(nextTanDiff.x, nextTanDiff.y) < MIN_DIFF) {
		endJoinDirection = currNormal;
	}
	if (aCoord == bCoord) {
		endJoinDirection = startJoinDirection;
		currNormal = prevNormal;
		currTangent = prevTangent;
	}

	tangent = currTangent;

	//calculate join shifts relative to normals
	float startJoinShift = dot(currNormal, startJoinDirection);
	float endJoinShift = dot(currNormal, endJoinDirection);

	float startMiterRatio = abs(1. / startJoinShift);
	float endMiterRatio = abs(1. / endJoinShift);

	vec2 startJoin = startJoinDirection * startMiterRatio;
	vec2 endJoin = endJoinDirection * endMiterRatio;

	vec2 startTopJoin, startBotJoin, endTopJoin, endBotJoin;
	startTopJoin = sign(startJoinShift) * startJoin * .5;
	startBotJoin = -startTopJoin;

	endTopJoin = sign(endJoinShift) * endJoin * .5;
	endBotJoin = -endTopJoin;

	vec2 aTopCoord = aCoord + normalWidth * startTopJoin;
	vec2 bTopCoord = bCoord + normalWidth * endTopJoin;
	vec2 aBotCoord = aCoord + normalWidth * startBotJoin;
	vec2 bBotCoord = bCoord + normalWidth * endBotJoin;

	//miter anti-clipping
	float baClipping = distToLine(bCoord, aCoord, aBotCoord) / dot(normalize(normalWidth * endBotJoin), normalize(normalWidth.yx * vec2(-startBotJoin.y, startBotJoin.x)));
	float abClipping = distToLine(aCoord, bCoord, bTopCoord) / dot(normalize(normalWidth * startBotJoin), normalize(normalWidth.yx * vec2(-endBotJoin.y, endBotJoin.x)));

	//prevent close to reverse direction switch
	bool prevReverse = dot(currTangent, prevTangent) <= REVERSE_THRESHOLD && abs(dot(currTangent, prevNormal)) * min(length(prevDiff), length(currDiff)) <  length(normalWidth * currNormal);
	bool nextReverse = dot(currTangent, nextTangent) <= REVERSE_THRESHOLD && abs(dot(currTangent, nextNormal)) * min(length(nextDiff), length(currDiff)) <  length(normalWidth * currNormal);

	if (prevReverse) {
		//make join rectangular
		vec2 miterShift = normalWidth * startJoinDirection * miterLimit * .5;
		float normalAdjust = 1. - min(miterLimit / startMiterRatio, 1.);
		aBotCoord = aCoord + miterShift - normalAdjust * normalWidth * currNormal * .5;
		aTopCoord = aCoord + miterShift + normalAdjust * normalWidth * currNormal * .5;
	}
	else if (!nextReverse && baClipping > 0. && baClipping < length(normalWidth * endBotJoin)) {
		//handle miter clipping
		bTopCoord -= normalWidth * endTopJoin;
		bTopCoord += normalize(endTopJoin * normalWidth) * baClipping;
	}

	if (nextReverse) {
		//make join rectangular
		vec2 miterShift = normalWidth * endJoinDirection * miterLimit * .5;
		float normalAdjust = 1. - min(miterLimit / endMiterRatio, 1.);
		bBotCoord = bCoord + miterShift - normalAdjust * normalWidth * currNormal * .5;
		bTopCoord = bCoord + miterShift + normalAdjust * normalWidth * currNormal * .5;
	}
	else if (!prevReverse && abClipping > 0. && abClipping < length(normalWidth * startBotJoin)) {
		//handle miter clipping
		aBotCoord -= normalWidth * startBotJoin;
		aBotCoord += normalize(startBotJoin * normalWidth) * abClipping;
	}

	vec2 aTopPosition = (aTopCoord) * adjustedScale + translate;
	vec2 aBotPosition = (aBotCoord) * adjustedScale + translate;

	vec2 bTopPosition = (bTopCoord) * adjustedScale + translate;
	vec2 bBotPosition = (bBotCoord) * adjustedScale + translate;

	//position is normalized 0..1 coord on the screen
	vec2 position = (aTopPosition * lineTop + aBotPosition * lineBot) * lineStart + (bTopPosition * lineTop + bBotPosition * lineBot) * lineEnd;

	startCoord = aCoord * scaleRatio + translate * viewport.zw + viewport.xy;
	endCoord = bCoord * scaleRatio + translate * viewport.zw + viewport.xy;

	gl_Position = vec4(position  * 2.0 - 1.0, depth, 1);

	enableStartMiter = step(dot(currTangent, prevTangent), .5);
	enableEndMiter = step(dot(currTangent, nextTangent), .5);

	//bevel miter cutoffs
	if (miterMode == 1.) {
		if (enableStartMiter == 1.) {
			vec2 startMiterWidth = vec2(startJoinDirection) * thickness * miterLimit * .5;
			startCutoff = vec4(aCoord, aCoord);
			startCutoff.zw += vec2(-startJoinDirection.y, startJoinDirection.x) / scaleRatio;
			startCutoff = startCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;
			startCutoff += viewport.xyxy;
			startCutoff += startMiterWidth.xyxy;
		}

		if (enableEndMiter == 1.) {
			vec2 endMiterWidth = vec2(endJoinDirection) * thickness * miterLimit * .5;
			endCutoff = vec4(bCoord, bCoord);
			endCutoff.zw += vec2(-endJoinDirection.y, endJoinDirection.x)  / scaleRatio;
			endCutoff = endCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;
			endCutoff += viewport.xyxy;
			endCutoff += endMiterWidth.xyxy;
		}
	}

	//round miter cutoffs
	else if (miterMode == 2.) {
		if (enableStartMiter == 1.) {
			vec2 startMiterWidth = vec2(startJoinDirection) * thickness * abs(dot(startJoinDirection, currNormal)) * .5;
			startCutoff = vec4(aCoord, aCoord);
			startCutoff.zw += vec2(-startJoinDirection.y, startJoinDirection.x) / scaleRatio;
			startCutoff = startCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;
			startCutoff += viewport.xyxy;
			startCutoff += startMiterWidth.xyxy;
		}

		if (enableEndMiter == 1.) {
			vec2 endMiterWidth = vec2(endJoinDirection) * thickness * abs(dot(endJoinDirection, currNormal)) * .5;
			endCutoff = vec4(bCoord, bCoord);
			endCutoff.zw += vec2(-endJoinDirection.y, endJoinDirection.x)  / scaleRatio;
			endCutoff = endCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;
			endCutoff += viewport.xyxy;
			endCutoff += endMiterWidth.xyxy;
		}
	}
}
`]),frag:l([`precision highp float;
#define GLSLIFY 1

uniform sampler2D dashPattern;
uniform float dashSize, pixelRatio, thickness, opacity, id, miterMode;

varying vec4 fragColor;
varying vec2 tangent;
varying vec4 startCutoff, endCutoff;
varying vec2 startCoord, endCoord;
varying float enableStartMiter, enableEndMiter;

float distToLine(vec2 p, vec2 a, vec2 b) {
	vec2 diff = b - a;
	vec2 perp = normalize(vec2(-diff.y, diff.x));
	return dot(p - a, perp);
}

void main() {
	float alpha = 1., distToStart, distToEnd;
	float cutoff = thickness * .5;

	//bevel miter
	if (miterMode == 1.) {
		if (enableStartMiter == 1.) {
			distToStart = distToLine(gl_FragCoord.xy, startCutoff.xy, startCutoff.zw);
			if (distToStart < -1.) {
				discard;
				return;
			}
			alpha *= min(max(distToStart + 1., 0.), 1.);
		}

		if (enableEndMiter == 1.) {
			distToEnd = distToLine(gl_FragCoord.xy, endCutoff.xy, endCutoff.zw);
			if (distToEnd < -1.) {
				discard;
				return;
			}
			alpha *= min(max(distToEnd + 1., 0.), 1.);
		}
	}

	// round miter
	else if (miterMode == 2.) {
		if (enableStartMiter == 1.) {
			distToStart = distToLine(gl_FragCoord.xy, startCutoff.xy, startCutoff.zw);
			if (distToStart < 0.) {
				float radius = length(gl_FragCoord.xy - startCoord);

				if(radius > cutoff + .5) {
					discard;
					return;
				}

				alpha -= smoothstep(cutoff - .5, cutoff + .5, radius);
			}
		}

		if (enableEndMiter == 1.) {
			distToEnd = distToLine(gl_FragCoord.xy, endCutoff.xy, endCutoff.zw);
			if (distToEnd < 0.) {
				float radius = length(gl_FragCoord.xy - endCoord);

				if(radius > cutoff + .5) {
					discard;
					return;
				}

				alpha -= smoothstep(cutoff - .5, cutoff + .5, radius);
			}
		}
	}

	float t = fract(dot(tangent, gl_FragCoord.xy) / dashSize) * .5 + .25;
	float dash = texture2D(dashPattern, vec2(t, .5)).r;

	gl_FragColor = fragColor;
	gl_FragColor.a *= alpha * opacity * dash;
}
`]),attributes:{lineEnd:{buffer:y,divisor:0,stride:8,offset:0},lineTop:{buffer:y,divisor:0,stride:8,offset:4},aColor:{buffer:d.prop("colorBuffer"),stride:4,offset:0,divisor:1},bColor:{buffer:d.prop("colorBuffer"),stride:4,offset:4,divisor:1},prevCoord:{buffer:d.prop("positionBuffer"),stride:8,offset:0,divisor:1},aCoord:{buffer:d.prop("positionBuffer"),stride:8,offset:8,divisor:1},bCoord:{buffer:d.prop("positionBuffer"),stride:8,offset:16,divisor:1},nextCoord:{buffer:d.prop("positionBuffer"),stride:8,offset:24,divisor:1}}},v))}catch{m=T}return{fill:d({primitive:"triangle",elements:function(w,A){return A.triangles},offset:0,vert:l([`precision highp float;
#define GLSLIFY 1

attribute vec2 position, positionFract;

uniform vec4 color;
uniform vec2 scale, scaleFract, translate, translateFract;
uniform float pixelRatio, id;
uniform vec4 viewport;
uniform float opacity;

varying vec4 fragColor;

const float MAX_LINES = 256.;

void main() {
	float depth = (MAX_LINES - 4. - id) / (MAX_LINES);

	vec2 position = position * scale + translate
       + positionFract * scale + translateFract
       + position * scaleFract
       + positionFract * scaleFract;

	gl_Position = vec4(position * 2.0 - 1.0, depth, 1);

	fragColor = color / 255.;
	fragColor.a *= opacity;
}
`]),frag:l([`precision highp float;
#define GLSLIFY 1

varying vec4 fragColor;

void main() {
	gl_FragColor = fragColor;
}
`]),uniforms:{scale:d.prop("scale"),color:d.prop("fill"),scaleFract:d.prop("scaleFract"),translateFract:d.prop("translateFract"),translate:d.prop("translate"),opacity:d.prop("opacity"),pixelRatio:d.context("pixelRatio"),id:d.prop("id"),viewport:function(w,A){return[A.viewport.x,A.viewport.y,w.viewportWidth,w.viewportHeight]}},attributes:{position:{buffer:d.prop("positionBuffer"),stride:8,offset:8},positionFract:{buffer:d.prop("positionFractBuffer"),stride:8,offset:8}},blend:v.blend,depth:{enable:!1},scissor:v.scissor,stencil:v.stencil,viewport:v.viewport}),rect:T,miter:m}},g.defaults={dashes:null,join:"miter",miterLimit:1,thickness:10,cap:"square",color:"black",opacity:1,overlay:!1,viewport:null,range:null,close:!1,fill:null},g.prototype.render=function(){for(var d,m=[],y=arguments.length;y--;)m[y]=arguments[y];m.length&&(d=this).update.apply(d,m),this.draw()},g.prototype.draw=function(){for(var d=this,m=[],y=arguments.length;y--;)m[y]=arguments[y];return(m.length?m:this.passes).forEach(function(v,T){var w;if(v&&Array.isArray(v))return(w=d).draw.apply(w,v);typeof v=="number"&&(v=d.passes[v]),v&&v.count>1&&v.opacity&&(d.regl._refresh(),v.fill&&v.triangles&&v.triangles.length>2&&d.shaders.fill(v),v.thickness&&(v.scale[0]*v.viewport.width>g.precisionThreshold||v.scale[1]*v.viewport.height>g.precisionThreshold||v.join==="rect"||!v.join&&(v.thickness<=2||v.count>=g.maxPoints)?d.shaders.rect(v):d.shaders.miter(v)))}),this},g.prototype.update=function(d){var m=this;if(d){d.length!=null?typeof d[0]=="number"&&(d=[{positions:d}]):Array.isArray(d)||(d=[d]);var y=this.regl,v=this.gl;if(d.forEach(function(M,b){var _=m.passes[b];if(M!==void 0)if(M!==null){if(typeof M[0]=="number"&&(M={positions:M}),M=e(M,{positions:"positions points data coords",thickness:"thickness lineWidth lineWidths line-width linewidth width stroke-width strokewidth strokeWidth",join:"lineJoin linejoin join type mode",miterLimit:"miterlimit miterLimit",dashes:"dash dashes dasharray dash-array dashArray",color:"color colour stroke colors colours stroke-color strokeColor",fill:"fill fill-color fillColor",opacity:"alpha opacity",overlay:"overlay crease overlap intersect",close:"closed close closed-path closePath",range:"range dataBox",viewport:"viewport viewBox",hole:"holes hole hollow"}),_||(m.passes[b]=_={id:b,scale:null,scaleFract:null,translate:null,translateFract:null,count:0,hole:[],depth:0,dashLength:1,dashTexture:y.texture({channels:1,data:new Uint8Array([255]),width:1,height:1,mag:"linear",min:"linear"}),colorBuffer:y.buffer({usage:"dynamic",type:"uint8",data:new Uint8Array}),positionBuffer:y.buffer({usage:"dynamic",type:"float",data:new Uint8Array}),positionFractBuffer:y.buffer({usage:"dynamic",type:"float",data:new Uint8Array})},M=p({},g.defaults,M)),M.thickness!=null&&(_.thickness=parseFloat(M.thickness)),M.opacity!=null&&(_.opacity=parseFloat(M.opacity)),M.miterLimit!=null&&(_.miterLimit=parseFloat(M.miterLimit)),M.overlay!=null&&(_.overlay=!!M.overlay,b<g.maxLines&&(_.depth=2*(g.maxLines-1-b%g.maxLines)/g.maxLines-1)),M.join!=null&&(_.join=M.join),M.hole!=null&&(_.hole=M.hole),M.fill!=null&&(_.fill=M.fill?t(M.fill,"uint8"):null),M.viewport!=null&&(_.viewport=f(M.viewport)),_.viewport||(_.viewport=f([v.drawingBufferWidth,v.drawingBufferHeight])),M.close!=null&&(_.close=M.close),M.positions===null&&(M.positions=[]),M.positions){var S,C;if(M.positions.x&&M.positions.y){var k=M.positions.x,L=M.positions.y;C=_.count=Math.max(k.length,L.length),S=new Float64Array(2*C);for(var I=0;I<C;I++)S[2*I]=k[I],S[2*I+1]=L[I]}else S=o(M.positions,"float64"),C=_.count=Math.floor(S.length/2);var R=_.bounds=h(S,2);if(_.fill){for(var V=[],O={},J=0,D=0,B=0,N=_.count;D<N;D++){var F=S[2*D],H=S[2*D+1];isNaN(F)||isNaN(H)||F==null||H==null?(F=S[2*J],H=S[2*J+1],O[D]=J):J=D,V[B++]=F,V[B++]=H}for(var j=r(V,_.hole||[]),G=0,W=j.length;G<W;G++)O[j[G]]!=null&&(j[G]=O[j[G]]);_.triangles=j}var Q=new Float64Array(S);i(Q,2,R);var $=new Float64Array(2*C+6);_.close?S[0]===S[2*C-2]&&S[1]===S[2*C-1]?($[0]=Q[2*C-4],$[1]=Q[2*C-3]):($[0]=Q[2*C-2],$[1]=Q[2*C-1]):($[0]=Q[0],$[1]=Q[1]),$.set(Q,2),_.close?S[0]===S[2*C-2]&&S[1]===S[2*C-1]?($[2*C+2]=Q[2],$[2*C+3]=Q[3],_.count-=1):($[2*C+2]=Q[0],$[2*C+3]=Q[1],$[2*C+4]=Q[2],$[2*C+5]=Q[3]):($[2*C+2]=Q[2*C-2],$[2*C+3]=Q[2*C-1],$[2*C+4]=Q[2*C-2],$[2*C+5]=Q[2*C-1]),_.positionBuffer(s($)),_.positionFractBuffer(a($))}if(M.range?_.range=M.range:_.range||(_.range=_.bounds),(M.range||M.positions)&&_.count){var ee=_.bounds,ie=ee[2]-ee[0],ae=ee[3]-ee[1],oe=_.range[2]-_.range[0],de=_.range[3]-_.range[1];_.scale=[ie/oe,ae/de],_.translate=[-_.range[0]/oe+ee[0]/oe||0,-_.range[1]/de+ee[1]/de||0],_.scaleFract=a(_.scale),_.translateFract=a(_.translate)}if(M.dashes){var le,fe=0;if(!M.dashes||M.dashes.length<2)fe=1,le=new Uint8Array([255,255,255,255,255,255,255,255]);else{fe=0;for(var ue=0;ue<M.dashes.length;++ue)fe+=M.dashes[ue];le=new Uint8Array(fe*g.dashMult);for(var we=0,Ae=255,Se=0;Se<2;Se++)for(var ke=0;ke<M.dashes.length;++ke){for(var Me=0,ve=M.dashes[ke]*g.dashMult*.5;Me<ve;++Me)le[we++]=Ae;Ae^=255}}_.dashLength=fe,_.dashTexture({channels:1,data:le,width:le.length,height:1,mag:"linear",min:"linear"},0,0)}if(M.color){var ge=_.count,De=M.color;De||(De="transparent");var _e=new Uint8Array(4*ge+4);if(Array.isArray(De)&&typeof De[0]!="number"){for(var Pe=0;Pe<ge;Pe++){var Fe=t(De[Pe],"uint8");_e.set(Fe,4*Pe)}_e.set(t(De[0],"uint8"),4*ge)}else for(var ze=t(De,"uint8"),He=0;He<ge+1;He++)_e.set(ze,4*He);_.colorBuffer({usage:"dynamic",type:"uint8",data:_e})}}else m.passes[b]=null}),d.length<this.passes.length){for(var T=d.length;T<this.passes.length;T++){var w=this.passes[T];w&&(w.colorBuffer.destroy(),w.positionBuffer.destroy(),w.dashTexture.destroy())}this.passes.length=d.length}for(var A=[],E=0;E<this.passes.length;E++)this.passes[E]!==null&&A.push(this.passes[E]);return this.passes=A,this}},g.prototype.destroy=function(){return this.passes.forEach(function(d){d.colorBuffer.destroy(),d.positionBuffer.destroy(),d.dashTexture.destroy()}),this.passes.length=0,this}},{"array-bounds":70,"array-normalize":71,"color-normalize":125,earcut:177,"es6-weak-map":233,"flatten-vertex-data":244,glslify:536,"object-assign":499,"parse-rect":504,"pick-by-alias":511,"to-float32":577}],536:[function(n,z,q){arguments[4][257][0].apply(q,arguments)},{dup:257}],537:[function(n,z,q){"use strict";function t(w,A){return function(E){if(Array.isArray(E))return E}(w)||function(E,M){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(E)))){var b=[],_=!0,S=!1,C=void 0;try{for(var k,L=E[Symbol.iterator]();!(_=(k=L.next()).done)&&(b.push(k.value),!M||b.length!==M);_=!0);}catch(I){S=!0,C=I}finally{try{_||L.return==null||L.return()}finally{if(S)throw C}}return b}}(w,A)||p(w,A)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function h(w){return function(A){if(Array.isArray(A))return l(A)}(w)||function(A){if(typeof Symbol<"u"&&Symbol.iterator in Object(A))return Array.from(A)}(w)||p(w)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function p(w,A){if(w){if(typeof w=="string")return l(w,A);var E=Object.prototype.toString.call(w).slice(8,-1);return E==="Object"&&w.constructor&&(E=w.constructor.name),E==="Map"||E==="Set"?Array.from(w):E==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(E)?l(w,A):void 0}}function l(w,A){(A==null||A>w.length)&&(A=w.length);for(var E=0,M=new Array(A);E<A;E++)M[E]=w[E];return M}var e=n("color-normalize"),o=n("array-bounds"),r=n("color-id"),i=n("@plotly/point-cluster"),u=n("object-assign"),s=n("glslify"),a=n("pick-by-alias"),c=n("update-diff"),f=n("flatten-vertex-data"),g=n("is-iexplorer"),d=n("to-float32"),m=n("parse-rect"),y=v;function v(w,A){var E=this;if(!(this instanceof v))return new v(w,A);typeof w=="function"?(A||(A={}),A.regl=w):(A=w,w=null),A&&A.length&&(A.positions=A);var M,b=(w=A.regl)._gl,_=[];this.tooManyColors=g,M=w.texture({data:new Uint8Array(1020),width:255,height:1,type:"uint8",format:"rgba",wrapS:"clamp",wrapT:"clamp",mag:"nearest",min:"nearest"}),u(this,{regl:w,gl:b,groups:[],markerCache:[null],markerTextures:[null],palette:_,paletteIds:{},paletteTexture:M,maxColors:255,maxSize:100,canvas:b.canvas}),this.update(A);var S={uniforms:{constPointSize:!!A.constPointSize,pixelRatio:w.context("pixelRatio"),palette:M,paletteSize:function(L,I){return[E.tooManyColors?0:255,M.height]},scale:w.prop("scale"),scaleFract:w.prop("scaleFract"),translate:w.prop("translate"),translateFract:w.prop("translateFract"),opacity:w.prop("opacity"),marker:w.prop("markerTexture")},attributes:{x:function(L,I){return I.xAttr||{buffer:I.positionBuffer,stride:8,offset:0}},y:function(L,I){return I.yAttr||{buffer:I.positionBuffer,stride:8,offset:4}},xFract:function(L,I){return I.xAttr?{constant:[0,0]}:{buffer:I.positionFractBuffer,stride:8,offset:0}},yFract:function(L,I){return I.yAttr?{constant:[0,0]}:{buffer:I.positionFractBuffer,stride:8,offset:4}},size:function(L,I){return I.size.length?{buffer:I.sizeBuffer,stride:2,offset:0}:{constant:[Math.round(255*I.size/E.maxSize)]}},borderSize:function(L,I){return I.borderSize.length?{buffer:I.sizeBuffer,stride:2,offset:1}:{constant:[Math.round(255*I.borderSize/E.maxSize)]}},colorId:function(L,I){return I.color.length?{buffer:I.colorBuffer,stride:E.tooManyColors?8:4,offset:0}:{constant:E.tooManyColors?_.slice(4*I.color,4*I.color+4):[I.color]}},borderColorId:function(L,I){return I.borderColor.length?{buffer:I.colorBuffer,stride:E.tooManyColors?8:4,offset:E.tooManyColors?4:2}:{constant:E.tooManyColors?_.slice(4*I.borderColor,4*I.borderColor+4):[I.borderColor]}},isActive:function(L,I){return I.activation===!0?{constant:[1]}:I.activation?I.activation:{constant:[0]}}},blend:{enable:!0,color:[0,0,0,1],func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},scissor:{enable:!0,box:w.prop("viewport")},viewport:w.prop("viewport"),stencil:{enable:!1},depth:{enable:!1},elements:w.prop("elements"),count:w.prop("count"),offset:w.prop("offset"),primitive:"points"},C=u({},S);C.frag=s([`precision highp float;
#define GLSLIFY 1

varying vec4 fragColor, fragBorderColor;
varying float fragWidth, fragBorderColorLevel, fragColorLevel;

uniform sampler2D marker;
uniform float opacity;

float smoothStep(float x, float y) {
  return 1.0 / (1.0 + exp(50.0*(x - y)));
}

void main() {
  float dist = texture2D(marker, gl_PointCoord).r, delta = fragWidth;

  // max-distance alpha
  if (dist < 0.003) discard;

  // null-border case
  if (fragBorderColorLevel == fragColorLevel || fragBorderColor.a == 0.) {
    float colorAmt = smoothstep(.5 - delta, .5 + delta, dist);
    gl_FragColor = vec4(fragColor.rgb, colorAmt * fragColor.a * opacity);
  }
  else {
    float borderColorAmt = smoothstep(fragBorderColorLevel - delta, fragBorderColorLevel + delta, dist);
    float colorAmt = smoothstep(fragColorLevel - delta, fragColorLevel + delta, dist);

    vec4 color = fragBorderColor;
    color.a *= borderColorAmt;
    color = mix(color, fragColor, colorAmt);
    color.a *= opacity;

    gl_FragColor = color;
  }

}
`]),C.vert=s([`precision highp float;
#define GLSLIFY 1

attribute float x, y, xFract, yFract;
attribute float size, borderSize;
attribute vec4 colorId, borderColorId;
attribute float isActive;

uniform vec2 scale, scaleFract, translate, translateFract, paletteSize;
uniform float pixelRatio;
uniform bool constPointSize;
uniform sampler2D palette;

const float maxSize = 100.;
const float borderLevel = .5;

varying vec4 fragColor, fragBorderColor;
varying float fragPointSize, fragBorderRadius, fragWidth, fragBorderColorLevel, fragColorLevel;

float pointSizeScale = (constPointSize) ? 2. : pixelRatio;

bool isDirect = (paletteSize.x < 1.);

vec4 getColor(vec4 id) {
  return isDirect ? id / 255. : texture2D(palette,
    vec2(
      (id.x + .5) / paletteSize.x,
      (id.y + .5) / paletteSize.y
    )
  );
}

void main() {
  // ignore inactive points
  if (isActive == 0.) return;

  vec2 position = vec2(x, y);
  vec2 positionFract = vec2(xFract, yFract);

  vec4 color = getColor(colorId);
  vec4 borderColor = getColor(borderColorId);

  float size = size * maxSize / 255.;
  float borderSize = borderSize * maxSize / 255.;

  gl_PointSize = 2. * size * pointSizeScale;
  fragPointSize = size * pixelRatio;

  vec2 pos = (position + translate) * scale
      + (positionFract + translateFract) * scale
      + (position + translate) * scaleFract
      + (positionFract + translateFract) * scaleFract;

  gl_Position = vec4(pos * 2. - 1., 0., 1.);

  fragColor = color;
  fragBorderColor = borderColor;
  fragWidth = 1. / gl_PointSize;

  fragBorderColorLevel = clamp(borderLevel - borderLevel * borderSize / size, 0., 1.);
  fragColorLevel = clamp(borderLevel + (1. - borderLevel) * borderSize / size, 0., 1.);
}`]),this.drawMarker=w(C);var k=u({},S);k.frag=s([`precision highp float;
#define GLSLIFY 1

varying vec4 fragColor, fragBorderColor;

uniform float opacity;
varying float fragBorderRadius, fragWidth;

float smoothStep(float edge0, float edge1, float x) {
	float t;
	t = clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);
	return t * t * (3.0 - 2.0 * t);
}

void main() {
	float radius, alpha = 1.0, delta = fragWidth;

	radius = length(2.0 * gl_PointCoord.xy - 1.0);

	if (radius > 1.0 + delta) {
		discard;
	}

	alpha -= smoothstep(1.0 - delta, 1.0 + delta, radius);

	float borderRadius = fragBorderRadius;
	float ratio = smoothstep(borderRadius - delta, borderRadius + delta, radius);
	vec4 color = mix(fragColor, fragBorderColor, ratio);
	color.a *= alpha * opacity;
	gl_FragColor = color;
}
`]),k.vert=s([`precision highp float;
#define GLSLIFY 1

attribute float x, y, xFract, yFract;
attribute float size, borderSize;
attribute vec4 colorId, borderColorId;
attribute float isActive;

uniform vec2 scale, scaleFract, translate, translateFract;
uniform float pixelRatio;
uniform bool constPointSize;
uniform sampler2D palette;
uniform vec2 paletteSize;

const float maxSize = 100.;

varying vec4 fragColor, fragBorderColor;
varying float fragBorderRadius, fragWidth;

float pointSizeScale = (constPointSize) ? 2. : pixelRatio;

bool isDirect = (paletteSize.x < 1.);

vec4 getColor(vec4 id) {
  return isDirect ? id / 255. : texture2D(palette,
    vec2(
      (id.x + .5) / paletteSize.x,
      (id.y + .5) / paletteSize.y
    )
  );
}

void main() {
  // ignore inactive points
  if (isActive == 0.) return;

  vec2 position = vec2(x, y);
  vec2 positionFract = vec2(xFract, yFract);

  vec4 color = getColor(colorId);
  vec4 borderColor = getColor(borderColorId);

  float size = size * maxSize / 255.;
  float borderSize = borderSize * maxSize / 255.;

  gl_PointSize = (size + borderSize) * pointSizeScale;

  vec2 pos = (position + translate) * scale
      + (positionFract + translateFract) * scale
      + (position + translate) * scaleFract
      + (positionFract + translateFract) * scaleFract;

  gl_Position = vec4(pos * 2. - 1., 0., 1.);

  fragBorderRadius = 1. - 2. * borderSize / (size + borderSize);
  fragColor = color;
  fragBorderColor = borderColor.a == 0. || borderSize == 0. ? vec4(color.rgb, 0.) : borderColor;
  fragWidth = 1. / gl_PointSize;
}
`]),g&&(k.frag=k.frag.replace("smoothstep","smoothStep"),C.frag=C.frag.replace("smoothstep","smoothStep")),this.drawCircle=w(k)}v.defaults={color:"black",borderColor:"transparent",borderSize:0,size:12,opacity:1,marker:void 0,viewport:null,range:null,pixelSize:null,count:0,offset:0,bounds:null,positions:[],snap:1e4},v.prototype.render=function(){return arguments.length&&this.update.apply(this,arguments),this.draw(),this},v.prototype.draw=function(){for(var w=this,A=arguments.length,E=new Array(A),M=0;M<A;M++)E[M]=arguments[M];var b=this.groups;if(E.length===1&&Array.isArray(E[0])&&(E[0][0]===null||Array.isArray(E[0][0]))&&(E=E[0]),this.regl._refresh(),E.length)for(var _=0;_<E.length;_++)this.drawItem(_,E[_]);else b.forEach(function(S,C){w.drawItem(C)});return this},v.prototype.drawItem=function(w,A){var E=this.groups,M=E[w];if(typeof A=="number"&&(w=A,M=E[A],A=null),M&&M.count&&M.opacity){M.activation[0]&&this.drawCircle(this.getMarkerDrawOptions(0,M,A));for(var b=[],_=1;_<M.activation.length;_++)M.activation[_]&&(M.activation[_]===!0||M.activation[_].data.length)&&b.push.apply(b,h(this.getMarkerDrawOptions(_,M,A)));b.length&&this.drawMarker(b)}},v.prototype.getMarkerDrawOptions=function(w,A,E){var M=A.range,b=A.tree,_=A.viewport,S=A.activation,C=A.selectionBuffer,k=A.count;if(this.regl,!b)return E?[u({},A,{markerTexture:this.markerTextures[w],activation:S[w],count:E.length,elements:E,offset:0})]:[u({},A,{markerTexture:this.markerTextures[w],activation:S[w],offset:0})];var L=[],I=b.range(M,{lod:!0,px:[(M[2]-M[0])/_.width,(M[3]-M[1])/_.height]});if(E){for(var R=S[w].data,V=new Uint8Array(k),O=0;O<E.length;O++){var J=E[O];V[J]=R?R[J]:1}C.subdata(V)}for(var D=I.length;D--;){var B=t(I[D],2),N=B[0],F=B[1];L.push(u({},A,{markerTexture:this.markerTextures[w],activation:E?C:S[w],offset:N,count:F-N}))}return L},v.prototype.update=function(){for(var w=this,A=arguments.length,E=new Array(A),M=0;M<A;M++)E[M]=arguments[M];if(E.length){E.length===1&&Array.isArray(E[0])&&(E=E[0]);var b=this.groups,_=this.gl,S=this.regl,C=this.maxSize,k=this.maxColors,L=this.palette;this.groups=b=E.map(function(I,R){var V=b[R];if(I===void 0)return V;I===null?I={positions:null}:typeof I=="function"?I={ondraw:I}:typeof I[0]=="number"&&(I={positions:I}),(I=a(I,{positions:"positions data points",snap:"snap cluster lod tree",size:"sizes size radius",borderSize:"borderSizes borderSize border-size bordersize borderWidth borderWidths border-width borderwidth stroke-width strokeWidth strokewidth outline",color:"colors color fill fill-color fillColor",borderColor:"borderColors borderColor stroke stroke-color strokeColor",marker:"markers marker shape",range:"range dataBox databox",viewport:"viewport viewPort viewBox viewbox",opacity:"opacity alpha transparency",bounds:"bound bounds boundaries limits",tooManyColors:"tooManyColors palette paletteMode optimizePalette enablePalette"})).positions===null&&(I.positions=[]),I.tooManyColors!=null&&(w.tooManyColors=I.tooManyColors),V||(b[R]=V={id:R,scale:null,translate:null,scaleFract:null,translateFract:null,activation:[],selectionBuffer:S.buffer({data:new Uint8Array(0),usage:"stream",type:"uint8"}),sizeBuffer:S.buffer({data:new Uint8Array(0),usage:"dynamic",type:"uint8"}),colorBuffer:S.buffer({data:new Uint8Array(0),usage:"dynamic",type:"uint8"}),positionBuffer:S.buffer({data:new Uint8Array(0),usage:"dynamic",type:"float"}),positionFractBuffer:S.buffer({data:new Uint8Array(0),usage:"dynamic",type:"float"})},I=u({},v.defaults,I)),I.positions&&!("marker"in I)&&(I.marker=V.marker,delete V.marker),I.marker&&!("positions"in I)&&(I.positions=V.positions,delete V.positions);var O=0,J=0;if(c(V,I,[{snap:!0,size:function(ue,we){return ue==null&&(ue=v.defaults.size),O+=ue&&ue.length?1:0,ue},borderSize:function(ue,we){return ue==null&&(ue=v.defaults.borderSize),O+=ue&&ue.length?1:0,ue},opacity:parseFloat,color:function(ue,we){return ue==null&&(ue=v.defaults.color),ue=w.updateColor(ue),J++,ue},borderColor:function(ue,we){return ue==null&&(ue=v.defaults.borderColor),ue=w.updateColor(ue),J++,ue},bounds:function(ue,we,Ae){return"range"in Ae||(Ae.range=null),ue},positions:function(ue,we,Ae){var Se=we.snap,ke=we.positionBuffer,Me=we.positionFractBuffer,ve=we.selectionBuffer;if(ue.x||ue.y)return ue.x.length?we.xAttr={buffer:S.buffer(ue.x),offset:0,stride:4,count:ue.x.length}:we.xAttr={buffer:ue.x.buffer,offset:4*ue.x.offset||0,stride:4*(ue.x.stride||1),count:ue.x.count},ue.y.length?we.yAttr={buffer:S.buffer(ue.y),offset:0,stride:4,count:ue.y.length}:we.yAttr={buffer:ue.y.buffer,offset:4*ue.y.offset||0,stride:4*(ue.y.stride||1),count:ue.y.count},we.count=Math.max(we.xAttr.count,we.yAttr.count),ue;ue=f(ue,"float64");var ge=we.count=Math.floor(ue.length/2),De=we.bounds=ge?o(ue,2):null;if(Ae.range||we.range||(delete we.range,Ae.range=De),Ae.marker||we.marker||(delete we.marker,Ae.marker=null),Se&&(Se===!0||ge>Se)?we.tree=i(ue,{bounds:De}):Se&&Se.length&&(we.tree=Se),we.tree){var _e={primitive:"points",usage:"static",data:we.tree,type:"uint32"};we.elements?we.elements(_e):we.elements=S.elements(_e)}return ke({data:d.float(ue),usage:"dynamic"}),Me({data:d.fract(ue),usage:"dynamic"}),ve({data:new Uint8Array(ge),type:"uint8",usage:"stream"}),ue}},{marker:function(ue,we,Ae){var Se=we.activation;if(Se.forEach(function(Pe){return Pe&&Pe.destroy&&Pe.destroy()}),Se.length=0,ue&&typeof ue[0]!="number"){for(var ke=[],Me=0,ve=Math.min(ue.length,we.count);Me<ve;Me++){var ge=w.addMarker(ue[Me]);ke[ge]||(ke[ge]=new Uint8Array(we.count)),ke[ge][Me]=1}for(var De=0;De<ke.length;De++)if(ke[De]){var _e={data:ke[De],type:"uint8",usage:"static"};Se[De]?Se[De](_e):Se[De]=S.buffer(_e),Se[De].data=ke[De]}}else Se[w.addMarker(ue)]=!0;return ue},range:function(ue,we,Ae){var Se=we.bounds;if(Se)return ue||(ue=Se),we.scale=[1/(ue[2]-ue[0]),1/(ue[3]-ue[1])],we.translate=[-ue[0],-ue[1]],we.scaleFract=d.fract(we.scale),we.translateFract=d.fract(we.translate),ue},viewport:function(ue){return m(ue||[_.drawingBufferWidth,_.drawingBufferHeight])}}]),O){var D=V,B=D.count,N=D.size,F=D.borderSize,H=D.sizeBuffer,j=new Uint8Array(2*B);if(N.length||F.length)for(var G=0;G<B;G++)j[2*G]=Math.round(255*(N[G]==null?N:N[G])/C),j[2*G+1]=Math.round(255*(F[G]==null?F:F[G])/C);H({data:j,usage:"dynamic"})}if(J){var W,Q=V,$=Q.count,ee=Q.color,ie=Q.borderColor,ae=Q.colorBuffer;if(w.tooManyColors){if(ee.length||ie.length){W=new Uint8Array(8*$);for(var oe=0;oe<$;oe++){var de=ee[oe];W[8*oe]=L[4*de],W[8*oe+1]=L[4*de+1],W[8*oe+2]=L[4*de+2],W[8*oe+3]=L[4*de+3];var le=ie[oe];W[8*oe+4]=L[4*le],W[8*oe+5]=L[4*le+1],W[8*oe+6]=L[4*le+2],W[8*oe+7]=L[4*le+3]}}}else if(ee.length||ie.length){W=new Uint8Array(4*$+2);for(var fe=0;fe<$;fe++)ee[fe]!=null&&(W[4*fe]=ee[fe]%k,W[4*fe+1]=Math.floor(ee[fe]/k)),ie[fe]!=null&&(W[4*fe+2]=ie[fe]%k,W[4*fe+3]=Math.floor(ie[fe]/k))}ae({data:W||new Uint8Array(0),type:"uint8",usage:"dynamic"})}return V})}},v.prototype.addMarker=function(w){var A,E=this.markerTextures,M=this.regl,b=this.markerCache,_=w==null?0:b.indexOf(w);if(_>=0)return _;if(w instanceof Uint8Array||w instanceof Uint8ClampedArray)A=w;else{A=new Uint8Array(w.length);for(var S=0,C=w.length;S<C;S++)A[S]=255*w[S]}var k=Math.floor(Math.sqrt(A.length));return _=E.length,b.push(w),E.push(M.texture({channels:1,data:A,radius:k,mag:"linear",min:"linear"})),_},v.prototype.updateColor=function(w){var A=this.paletteIds,E=this.palette,M=this.maxColors;Array.isArray(w)||(w=[w]);var b=[];if(typeof w[0]=="number"){var _=[];if(Array.isArray(w))for(var S=0;S<w.length;S+=4)_.push(w.slice(S,S+4));else for(var C=0;C<w.length;C+=4)_.push(w.subarray(C,C+4));w=_}for(var k=0;k<w.length;k++){var L=w[k];L=e(L,"uint8");var I=r(L,!1);if(A[I]==null){var R=E.length;A[I]=Math.floor(R/4),E[R]=L[0],E[R+1]=L[1],E[R+2]=L[2],E[R+3]=L[3]}b[k]=A[I]}return!this.tooManyColors&&E.length>4*M&&(this.tooManyColors=!0),this.updatePalette(E),b.length===1?b[0]:b},v.prototype.updatePalette=function(w){if(!this.tooManyColors){var A=this.maxColors,E=this.paletteTexture,M=Math.ceil(.25*w.length/A);if(M>1)for(var b=.25*(w=w.slice()).length%A;b<M*A;b++)w.push(0,0,0,0);E.height<M&&E.resize(A,M),E.subimage({width:Math.min(.25*w.length,A),height:M,data:w},0,0)}},v.prototype.destroy=function(){return this.groups.forEach(function(w){w.sizeBuffer.destroy(),w.positionBuffer.destroy(),w.positionFractBuffer.destroy(),w.colorBuffer.destroy(),w.activation.forEach(function(A){return A&&A.destroy&&A.destroy()}),w.selectionBuffer.destroy(),w.elements&&w.elements.destroy()}),this.groups.length=0,this.paletteTexture.destroy(),this.markerTextures.forEach(function(w){return w&&w.destroy&&w.destroy()}),this};var T=n("object-assign");z.exports=function(w,A){var E=new y(w,A),M=E.render.bind(E);return T(M,{render:M,update:E.update.bind(E),draw:E.draw.bind(E),destroy:E.destroy.bind(E),regl:E.regl,gl:E.gl,canvas:E.gl.canvas,groups:E.groups,markers:E.markerCache,palette:E.palette}),M}},{"@plotly/point-cluster":57,"array-bounds":70,"color-id":123,"color-normalize":125,"flatten-vertex-data":244,glslify:538,"is-iexplorer":466,"object-assign":499,"parse-rect":504,"pick-by-alias":511,"to-float32":577,"update-diff":599}],538:[function(n,z,q){arguments[4][257][0].apply(q,arguments)},{dup:257}],539:[function(n,z,q){"use strict";var t=n("regl-scatter2d"),h=n("pick-by-alias"),p=n("array-bounds"),l=n("raf"),e=n("array-range"),o=n("parse-rect"),r=n("flatten-vertex-data");function i(c,f){if(!(this instanceof i))return new i(c,f);this.traces=[],this.passes={},this.regl=c,this.scatter=t(c),this.canvas=this.scatter.canvas}function u(c,f,g){return(c.id!=null?c.id:c)<<16|(255&f)<<8|255&g}function s(c,f,g){var d,m,y,v,T=c[f],w=c[g];return T.length>2?(T[0],T[2],d=T[1],m=T[3]):T.length?(d=T[0],m=T[1]):(T.x,d=T.y,T.x+T.width,m=T.y+T.height),w.length>2?(y=w[0],v=w[2],w[1],w[3]):w.length?(y=w[0],v=w[1]):(y=w.x,w.y,v=w.x+w.width,w.y+w.height),[y,d,v,m]}function a(c){if(typeof c=="number")return[c,c,c,c];if(c.length===2)return[c[0],c[1],c[0],c[1]];var f=o(c);return[f.x,f.y,f.x+f.width,f.y+f.height]}z.exports=i,i.prototype.render=function(){for(var c,f=this,g=[],d=arguments.length;d--;)g[d]=arguments[d];return g.length&&(c=this).update.apply(c,g),this.regl.attributes.preserveDrawingBuffer?this.draw():(this.dirty?this.planned==null&&(this.planned=l(function(){f.draw(),f.dirty=!0,f.planned=null})):(this.draw(),this.dirty=!0,l(function(){f.dirty=!1})),this)},i.prototype.update=function(){for(var c,f=[],g=arguments.length;g--;)f[g]=arguments[g];if(f.length){for(var d=0;d<f.length;d++)this.updateItem(d,f[d]);this.traces=this.traces.filter(Boolean);for(var m=[],y=0,v=0;v<this.traces.length;v++){for(var T=this.traces[v],w=this.traces[v].passes,A=0;A<w.length;A++)m.push(this.passes[w[A]]);T.passOffset=y,y+=T.passes.length}return(c=this.scatter).update.apply(c,m),this}},i.prototype.updateItem=function(c,f){var g=this.regl;if(f===null)return this.traces[c]=null,this;if(!f)return this;var d,m=h(f,{data:"data items columns rows values dimensions samples x",snap:"snap cluster",size:"sizes size radius",color:"colors color fill fill-color fillColor",opacity:"opacity alpha transparency opaque",borderSize:"borderSizes borderSize border-size bordersize borderWidth borderWidths border-width borderwidth stroke-width strokeWidth strokewidth outline",borderColor:"borderColors borderColor bordercolor stroke stroke-color strokeColor",marker:"markers marker shape",range:"range ranges databox dataBox",viewport:"viewport viewBox viewbox",domain:"domain domains area areas",padding:"pad padding paddings pads margin margins",transpose:"transpose transposed",diagonal:"diagonal diag showDiagonal",upper:"upper up top upperhalf upperHalf showupperhalf showUpper showUpperHalf",lower:"lower low bottom lowerhalf lowerHalf showlowerhalf showLowerHalf showLower"}),y=this.traces[c]||(this.traces[c]={id:c,buffer:g.buffer({usage:"dynamic",type:"float",data:new Uint8Array}),color:"black",marker:null,size:12,borderColor:"transparent",borderSize:1,viewport:o([g._gl.drawingBufferWidth,g._gl.drawingBufferHeight]),padding:[0,0,0,0],opacity:1,diagonal:!0,upper:!0,lower:!0});if(m.color!=null&&(y.color=m.color),m.size!=null&&(y.size=m.size),m.marker!=null&&(y.marker=m.marker),m.borderColor!=null&&(y.borderColor=m.borderColor),m.borderSize!=null&&(y.borderSize=m.borderSize),m.opacity!=null&&(y.opacity=m.opacity),m.viewport&&(y.viewport=o(m.viewport)),m.diagonal!=null&&(y.diagonal=m.diagonal),m.upper!=null&&(y.upper=m.upper),m.lower!=null&&(y.lower=m.lower),m.data){y.buffer(r(m.data)),y.columns=m.data.length,y.count=m.data[0].length,y.bounds=[];for(var v=0;v<y.columns;v++)y.bounds[v]=p(m.data[v],1)}m.range&&(y.range=m.range,d=y.range&&typeof y.range[0]!="number"),m.domain&&(y.domain=m.domain);var T=!1;m.padding!=null&&(Array.isArray(m.padding)&&m.padding.length===y.columns&&typeof m.padding[m.padding.length-1]=="number"?(y.padding=m.padding.map(a),T=!0):y.padding=a(m.padding));var w=y.columns,A=y.count,E=y.viewport.width,M=y.viewport.height,b=y.viewport.x,_=y.viewport.y,S=E/w,C=M/w;y.passes=[];for(var k=0;k<w;k++)for(var L=0;L<w;L++)if((y.diagonal||L!==k)&&(y.upper||!(k>L))&&(y.lower||!(k<L))){var I=u(y.id,k,L),R=this.passes[I]||(this.passes[I]={});if(m.data&&(m.transpose?R.positions={x:{buffer:y.buffer,offset:L,count:A,stride:w},y:{buffer:y.buffer,offset:k,count:A,stride:w}}:R.positions={x:{buffer:y.buffer,offset:L*A,count:A},y:{buffer:y.buffer,offset:k*A,count:A}},R.bounds=s(y.bounds,k,L)),m.domain||m.viewport||m.data){var V=T?s(y.padding,k,L):y.padding;if(y.domain){var O=s(y.domain,k,L),J=O[0],D=O[1],B=O[2],N=O[3];R.viewport=[b+J*E+V[0],_+D*M+V[1],b+B*E-V[2],_+N*M-V[3]]}else R.viewport=[b+L*S+S*V[0],_+k*C+C*V[1],b+(L+1)*S-S*V[2],_+(k+1)*C-C*V[3]]}m.color&&(R.color=y.color),m.size&&(R.size=y.size),m.marker&&(R.marker=y.marker),m.borderSize&&(R.borderSize=y.borderSize),m.borderColor&&(R.borderColor=y.borderColor),m.opacity&&(R.opacity=y.opacity),m.range&&(R.range=d?s(y.range,k,L):y.range||R.bounds),y.passes.push(I)}return this},i.prototype.draw=function(){for(var c,f=[],g=arguments.length;g--;)f[g]=arguments[g];if(f.length){for(var d=[],m=0;m<f.length;m++)if(typeof f[m]=="number"){var y=this.traces[f[m]],v=y.passes,T=y.passOffset;d.push.apply(d,e(T,T+v.length))}else if(f[m].length){var w=f[m],A=this.traces[m],E=A.passes,M=A.passOffset;E=E.map(function(b,_){d[M+_]=w})}(c=this.scatter).draw.apply(c,d)}else this.scatter.draw();return this},i.prototype.destroy=function(){return this.traces.forEach(function(c){c.buffer&&c.buffer.destroy&&c.buffer.destroy()}),this.traces=null,this.passes=null,this.scatter.destroy(),this}},{"array-bounds":70,"array-range":72,"flatten-vertex-data":244,"parse-rect":504,"pick-by-alias":511,raf:528,"regl-scatter2d":537}],540:[function(n,z,q){(function(t,h){typeof q=="object"&&typeof z<"u"?z.exports=h():t.createREGL=h()})(this,function(){function t(xe,Ee){this.id=Q++,this.type=xe,this.data=Ee}function h(xe){return"["+function Ee(Je){if(Je.length===0)return[];var it=Je.charAt(0),ht=Je.charAt(Je.length-1);if(1<Je.length&&it===ht&&(it==='"'||it==="'"))return['"'+Je.substr(1,Je.length-2).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];if(it=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(Je))return Ee(Je.substr(0,it.index)).concat(Ee(it[1])).concat(Ee(Je.substr(it.index+it[0].length)));if((it=Je.split(".")).length===1)return['"'+Je.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];for(Je=[],ht=0;ht<it.length;++ht)Je=Je.concat(Ee(it[ht]));return Je}(xe).join("][")+"]"}function p(xe){return typeof xe=="string"?xe.split():xe}function l(xe){return typeof xe=="string"?document.querySelector(xe):xe}function e(xe){var Ee,Je,it,ht,ct=xe||{};xe={};var mt=[],bt=[],Et=typeof window>"u"?1:window.devicePixelRatio,Mt=!1,_t=function(At){},xt=function(){};if(typeof ct=="string"?Ee=document.querySelector(ct):typeof ct=="object"&&(typeof ct.nodeName=="string"&&typeof ct.appendChild=="function"&&typeof ct.getBoundingClientRect=="function"?Ee=ct:typeof ct.drawArrays=="function"||typeof ct.drawElements=="function"?it=(ht=ct).canvas:("gl"in ct?ht=ct.gl:"canvas"in ct?it=l(ct.canvas):"container"in ct&&(Je=l(ct.container)),"attributes"in ct&&(xe=ct.attributes),"extensions"in ct&&(mt=p(ct.extensions)),"optionalExtensions"in ct&&(bt=p(ct.optionalExtensions)),"onDone"in ct&&(_t=ct.onDone),"profile"in ct&&(Mt=!!ct.profile),"pixelRatio"in ct&&(Et=+ct.pixelRatio))),Ee&&(Ee.nodeName.toLowerCase()==="canvas"?it=Ee:Je=Ee),!ht){if(!it){if(!(Ee=function(At,It,Nt){function Ot(){var Ne=window.innerWidth,ut=window.innerHeight;At!==document.body&&(Ne=(ut=At.getBoundingClientRect()).right-ut.left,ut=ut.bottom-ut.top),Pt.width=Nt*Ne,Pt.height=Nt*ut,W(Pt.style,{width:Ne+"px",height:ut+"px"})}var Yt,Pt=document.createElement("canvas");return W(Pt.style,{border:0,margin:0,padding:0,top:0,left:0}),At.appendChild(Pt),At===document.body&&(Pt.style.position="absolute",W(At.style,{margin:0,padding:0})),At!==document.body&&typeof ResizeObserver=="function"?(Yt=new ResizeObserver(function(){setTimeout(Ot)})).observe(At):window.addEventListener("resize",Ot,!1),Ot(),{canvas:Pt,onDestroy:function(){Yt?Yt.disconnect():window.removeEventListener("resize",Ot),At.removeChild(Pt)}}}(Je||document.body,0,Et)))return null;it=Ee.canvas,xt=Ee.onDestroy}xe.premultipliedAlpha===void 0&&(xe.premultipliedAlpha=!0),ht=function(At,It){function Nt(Ot){try{return At.getContext(Ot,It)}catch{return null}}return Nt("webgl")||Nt("experimental-webgl")||Nt("webgl-experimental")}(it,xe)}return ht?{gl:ht,canvas:it,container:Je,extensions:mt,optionalExtensions:bt,pixelRatio:Et,profile:Mt,onDone:_t,onDestroy:xt}:(xt(),_t("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function o(xe,Ee){for(var Je=Array(xe),it=0;it<xe;++it)Je[it]=Ee(it);return Je}function r(xe){var Ee,Je;return Ee=(65535<xe)<<4,Ee|=Je=(255<(xe>>>=Ee))<<3,(Ee|=Je=(15<(xe>>>=Je))<<2)|(Je=(3<(xe>>>=Je))<<1)|xe>>>Je>>1}function i(){function xe(it){e:{for(var ht=16;268435456>=ht;ht*=16)if(it<=ht){it=ht;break e}it=0}return 0<(ht=Je[r(it)>>2]).length?ht.pop():new ArrayBuffer(it)}function Ee(it){Je[r(it.byteLength)>>2].push(it)}var Je=o(8,function(){return[]});return{alloc:xe,free:Ee,allocType:function(it,ht){var ct=null;switch(it){case 5120:ct=new Int8Array(xe(ht),0,ht);break;case 5121:ct=new Uint8Array(xe(ht),0,ht);break;case 5122:ct=new Int16Array(xe(2*ht),0,ht);break;case 5123:ct=new Uint16Array(xe(2*ht),0,ht);break;case 5124:ct=new Int32Array(xe(4*ht),0,ht);break;case 5125:ct=new Uint32Array(xe(4*ht),0,ht);break;case 5126:ct=new Float32Array(xe(4*ht),0,ht);break;default:return null}return ct.length!==ht?ct.subarray(0,ht):ct},freeType:function(it){Ee(it.buffer)}}}function u(xe){return!!xe&&typeof xe=="object"&&Array.isArray(xe.shape)&&Array.isArray(xe.stride)&&typeof xe.offset=="number"&&xe.shape.length===xe.stride.length&&(Array.isArray(xe.data)||de(xe.data))}function s(xe,Ee,Je,it,ht,ct){for(var mt=0;mt<Ee;++mt)for(var bt=xe[mt],Et=0;Et<Je;++Et)for(var Mt=bt[Et],_t=0;_t<it;++_t)ht[ct++]=Mt[_t]}function a(xe){return 0|ue[Object.prototype.toString.call(xe)]}function c(xe,Ee){for(var Je=0;Je<Ee.length;++Je)xe[Je]=Ee[Je]}function f(xe,Ee,Je,it,ht,ct,mt){for(var bt=0,Et=0;Et<Je;++Et)for(var Mt=0;Mt<it;++Mt)xe[bt++]=Ee[ht*Et+ct*Mt+mt]}function g(xe,Ee,Je,it){function ht(xt){this.id=Et++,this.buffer=xe.createBuffer(),this.type=xt,this.usage=35044,this.byteLength=0,this.dimension=1,this.dtype=5121,this.persistentData=null,Je.profile&&(this.stats={size:0})}function ct(xt,At,It){xt.byteLength=At.byteLength,xe.bufferData(xt.type,At,It)}function mt(xt,At,It,Nt,Ot,Yt){if(xt.usage=It,Array.isArray(At)){if(xt.dtype=Nt||5126,0<At.length)if(Array.isArray(At[0])){Ot=ke(At);for(var Pt=Nt=1;Pt<Ot.length;++Pt)Nt*=Ot[Pt];xt.dimension=Nt,ct(xt,At=Se(At,Ot,xt.dtype),It),Yt?xt.persistentData=At:ae.freeType(At)}else typeof At[0]=="number"?(xt.dimension=Ot,c(Ot=ae.allocType(xt.dtype,At.length),At),ct(xt,Ot,It),Yt?xt.persistentData=Ot:ae.freeType(Ot)):de(At[0])&&(xt.dimension=At[0].length,xt.dtype=Nt||a(At[0])||5126,ct(xt,At=Se(At,[At.length,At[0].length],xt.dtype),It),Yt?xt.persistentData=At:ae.freeType(At))}else if(de(At))xt.dtype=Nt||a(At),xt.dimension=Ot,ct(xt,At,It),Yt&&(xt.persistentData=new Uint8Array(new Uint8Array(At.buffer)));else if(u(At)){Ot=At.shape;var Ne=At.stride,ut=(Pt=At.offset,0),wt=0,Bt=0,Jt=0;Ot.length===1?(ut=Ot[0],wt=1,Bt=Ne[0],Jt=0):Ot.length===2&&(ut=Ot[0],wt=Ot[1],Bt=Ne[0],Jt=Ne[1]),xt.dtype=Nt||a(At.data)||5126,xt.dimension=wt,f(Ot=ae.allocType(xt.dtype,ut*wt),At.data,ut,wt,Bt,Jt,Pt),ct(xt,Ot,It),Yt?xt.persistentData=Ot:ae.freeType(Ot)}else At instanceof ArrayBuffer&&(xt.dtype=5121,xt.dimension=Ot,ct(xt,At,It),Yt&&(xt.persistentData=new Uint8Array(new Uint8Array(At))))}function bt(xt){Ee.bufferCount--,it(xt),xe.deleteBuffer(xt.buffer),xt.buffer=null,delete Mt[xt.id]}var Et=0,Mt={};ht.prototype.bind=function(){xe.bindBuffer(this.type,this.buffer)},ht.prototype.destroy=function(){bt(this)};var _t=[];return Je.profile&&(Ee.getTotalBufferSize=function(){var xt=0;return Object.keys(Mt).forEach(function(At){xt+=Mt[At].stats.size}),xt}),{create:function(xt,At,It,Nt){function Ot(Pt){var Ne=35044,ut=null,wt=0,Bt=0,Jt=1;return Array.isArray(Pt)||de(Pt)||u(Pt)||Pt instanceof ArrayBuffer?ut=Pt:typeof Pt=="number"?wt=0|Pt:Pt&&("data"in Pt&&(ut=Pt.data),"usage"in Pt&&(Ne=Ae[Pt.usage]),"type"in Pt&&(Bt=we[Pt.type]),"dimension"in Pt&&(Jt=0|Pt.dimension),"length"in Pt&&(wt=0|Pt.length)),Yt.bind(),ut?mt(Yt,ut,Ne,Bt,Jt,Nt):(wt&&xe.bufferData(Yt.type,wt,Ne),Yt.dtype=Bt||5121,Yt.usage=Ne,Yt.dimension=Jt,Yt.byteLength=wt),Je.profile&&(Yt.stats.size=Yt.byteLength*Me[Yt.dtype]),Ot}Ee.bufferCount++;var Yt=new ht(At);return Mt[Yt.id]=Yt,It||Ot(xt),Ot._reglType="buffer",Ot._buffer=Yt,Ot.subdata=function(Pt,Ne){var ut,wt=0|(Ne||0);if(Yt.bind(),de(Pt)||Pt instanceof ArrayBuffer)xe.bufferSubData(Yt.type,wt,Pt);else if(Array.isArray(Pt)){if(0<Pt.length)if(typeof Pt[0]=="number"){var Bt=ae.allocType(Yt.dtype,Pt.length);c(Bt,Pt),xe.bufferSubData(Yt.type,wt,Bt),ae.freeType(Bt)}else(Array.isArray(Pt[0])||de(Pt[0]))&&(ut=ke(Pt),Bt=Se(Pt,ut,Yt.dtype),xe.bufferSubData(Yt.type,wt,Bt),ae.freeType(Bt))}else if(u(Pt)){ut=Pt.shape;var Jt=Pt.stride,er=Bt=0,or=0,zt=0;ut.length===1?(Bt=ut[0],er=1,or=Jt[0],zt=0):ut.length===2&&(Bt=ut[0],er=ut[1],or=Jt[0],zt=Jt[1]),ut=Array.isArray(Pt.data)?Yt.dtype:a(Pt.data),f(ut=ae.allocType(ut,Bt*er),Pt.data,Bt,er,or,zt,Pt.offset),xe.bufferSubData(Yt.type,wt,ut),ae.freeType(ut)}return Ot},Je.profile&&(Ot.stats=Yt.stats),Ot.destroy=function(){bt(Yt)},Ot},createStream:function(xt,At){var It=_t.pop();return It||(It=new ht(xt)),It.bind(),mt(It,At,35040,0,1,!1),It},destroyStream:function(xt){_t.push(xt)},clear:function(){le(Mt).forEach(bt),_t.forEach(bt)},getBuffer:function(xt){return xt&&xt._buffer instanceof ht?xt._buffer:null},restore:function(){le(Mt).forEach(function(xt){xt.buffer=xe.createBuffer(),xe.bindBuffer(xt.type,xt.buffer),xe.bufferData(xt.type,xt.persistentData||xt.byteLength,xt.usage)})},_initBuffer:mt}}function d(xe,Ee,Je,it){function ht(xt){this.id=Et++,bt[this.id]=this,this.buffer=xt,this.primType=4,this.type=this.vertCount=0}function ct(xt,At,It,Nt,Ot,Yt,Pt){var Ne;if(xt.buffer.bind(),At?((Ne=Pt)||de(At)&&(!u(At)||de(At.data))||(Ne=Ee.oes_element_index_uint?5125:5123),Je._initBuffer(xt.buffer,At,It,Ne,3)):(xe.bufferData(34963,Yt,It),xt.buffer.dtype=Ne||5121,xt.buffer.usage=It,xt.buffer.dimension=3,xt.buffer.byteLength=Yt),Ne=Pt,!Pt){switch(xt.buffer.dtype){case 5121:case 5120:Ne=5121;break;case 5123:case 5122:Ne=5123;break;case 5125:case 5124:Ne=5125}xt.buffer.dtype=Ne}xt.type=Ne,0>(At=Ot)&&(At=xt.buffer.byteLength,Ne===5123?At>>=1:Ne===5125&&(At>>=2)),xt.vertCount=At,At=Nt,0>Nt&&(At=4,(Nt=xt.buffer.dimension)===1&&(At=0),Nt===2&&(At=1),Nt===3&&(At=4)),xt.primType=At}function mt(xt){it.elementsCount--,delete bt[xt.id],xt.buffer.destroy(),xt.buffer=null}var bt={},Et=0,Mt={uint8:5121,uint16:5123};Ee.oes_element_index_uint&&(Mt.uint32=5125),ht.prototype.bind=function(){this.buffer.bind()};var _t=[];return{create:function(xt,At){function It(Yt){if(Yt)if(typeof Yt=="number")Nt(Yt),Ot.primType=4,Ot.vertCount=0|Yt,Ot.type=5121;else{var Pt=null,Ne=35044,ut=-1,wt=-1,Bt=0,Jt=0;Array.isArray(Yt)||de(Yt)||u(Yt)?Pt=Yt:("data"in Yt&&(Pt=Yt.data),"usage"in Yt&&(Ne=Ae[Yt.usage]),"primitive"in Yt&&(ut=ve[Yt.primitive]),"count"in Yt&&(wt=0|Yt.count),"type"in Yt&&(Jt=Mt[Yt.type]),"length"in Yt?Bt=0|Yt.length:(Bt=wt,Jt===5123||Jt===5122?Bt*=2:Jt!==5125&&Jt!==5124||(Bt*=4))),ct(Ot,Pt,Ne,ut,wt,Bt,Jt)}else Nt(),Ot.primType=4,Ot.vertCount=0,Ot.type=5121;return It}var Nt=Je.create(null,34963,!0),Ot=new ht(Nt._buffer);return it.elementsCount++,It(xt),It._reglType="elements",It._elements=Ot,It.subdata=function(Yt,Pt){return Nt.subdata(Yt,Pt),It},It.destroy=function(){mt(Ot)},It},createStream:function(xt){var At=_t.pop();return At||(At=new ht(Je.create(null,34963,!0,!1)._buffer)),ct(At,xt,35040,-1,-1,0,0),At},destroyStream:function(xt){_t.push(xt)},getElements:function(xt){return typeof xt=="function"&&xt._elements instanceof ht?xt._elements:null},clear:function(){le(bt).forEach(mt)}}}function m(xe){for(var Ee=ae.allocType(5123,xe.length),Je=0;Je<xe.length;++Je)if(isNaN(xe[Je]))Ee[Je]=65535;else if(1/0===xe[Je])Ee[Je]=31744;else if(-1/0===xe[Je])Ee[Je]=64512;else{ge[0]=xe[Je];var it=(ct=De[0])>>>31<<15,ht=(ct<<1>>>24)-127,ct=ct>>13&1023;Ee[Je]=-24>ht?it:-14>ht?it+(ct+1024>>-14-ht):15<ht?it+31744:it+(ht+15<<10)+ct}return Ee}function y(xe){return Array.isArray(xe)||de(xe)}function v(xe){return"[object "+xe+"]"}function T(xe){return Array.isArray(xe)&&(xe.length===0||typeof xe[0]=="number")}function w(xe){return!(!Array.isArray(xe)||xe.length===0||!y(xe[0]))}function A(xe){return Object.prototype.toString.call(xe)}function E(xe){if(!xe)return!1;var Ee=A(xe);return 0<=$e.indexOf(Ee)||T(xe)||w(xe)||u(xe)}function M(xe,Ee){xe.type===36193?(xe.data=m(Ee),ae.freeType(Ee)):xe.data=Ee}function b(xe,Ee,Je,it,ht,ct){if(xe=typeof at[xe]<"u"?at[xe]:Fe[xe]*rt[Ee],ct&&(xe*=6),ht){for(it=0;1<=Je;)it+=xe*Je*Je,Je/=2;return it}return xe*Je*it}function _(xe,Ee,Je,it,ht,ct,mt){function bt(){this.format=this.internalformat=6408,this.type=5121,this.flipY=this.premultiplyAlpha=this.compressed=!1,this.unpackAlignment=1,this.colorSpace=37444,this.channels=this.height=this.width=0}function Et(vt,Zt){vt.internalformat=Zt.internalformat,vt.format=Zt.format,vt.type=Zt.type,vt.compressed=Zt.compressed,vt.premultiplyAlpha=Zt.premultiplyAlpha,vt.flipY=Zt.flipY,vt.unpackAlignment=Zt.unpackAlignment,vt.colorSpace=Zt.colorSpace,vt.width=Zt.width,vt.height=Zt.height,vt.channels=Zt.channels}function Mt(vt,Zt){if(typeof Zt=="object"&&Zt){"premultiplyAlpha"in Zt&&(vt.premultiplyAlpha=Zt.premultiplyAlpha),"flipY"in Zt&&(vt.flipY=Zt.flipY),"alignment"in Zt&&(vt.unpackAlignment=Zt.alignment),"colorSpace"in Zt&&(vt.colorSpace=Hr[Zt.colorSpace]),"type"in Zt&&(vt.type=Kr[Zt.type]);var qt=vt.width,yr=vt.height,Dr=vt.channels,Mr=!1;"shape"in Zt?(qt=Zt.shape[0],yr=Zt.shape[1],Zt.shape.length===3&&(Dr=Zt.shape[2],Mr=!0)):("radius"in Zt&&(qt=yr=Zt.radius),"width"in Zt&&(qt=Zt.width),"height"in Zt&&(yr=Zt.height),"channels"in Zt&&(Dr=Zt.channels,Mr=!0)),vt.width=0|qt,vt.height=0|yr,vt.channels=0|Dr,qt=!1,"format"in Zt&&(qt=Zt.format,yr=vt.internalformat=Ir[qt],vt.format=cn[yr],qt in Kr&&!("type"in Zt)&&(vt.type=Kr[qt]),qt in kr&&(vt.compressed=!0),qt=!0),!Mr&&qt?vt.channels=Fe[vt.format]:Mr&&!qt&&vt.channels!==Pe[vt.format]&&(vt.format=vt.internalformat=Pe[vt.channels])}}function _t(vt){xe.pixelStorei(37440,vt.flipY),xe.pixelStorei(37441,vt.premultiplyAlpha),xe.pixelStorei(37443,vt.colorSpace),xe.pixelStorei(3317,vt.unpackAlignment)}function xt(){bt.call(this),this.yOffset=this.xOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function At(vt,Zt){var qt=null;if(E(Zt)?qt=Zt:Zt&&(Mt(vt,Zt),"x"in Zt&&(vt.xOffset=0|Zt.x),"y"in Zt&&(vt.yOffset=0|Zt.y),E(Zt.data)&&(qt=Zt.data)),Zt.copy){var yr=ht.viewportWidth,Dr=ht.viewportHeight;vt.width=vt.width||yr-vt.xOffset,vt.height=vt.height||Dr-vt.yOffset,vt.needsCopy=!0}else if(qt){if(de(qt))vt.channels=vt.channels||4,vt.data=qt,"type"in Zt||vt.type!==5121||(vt.type=0|ue[Object.prototype.toString.call(qt)]);else if(T(qt)){switch(vt.channels=vt.channels||4,Dr=(yr=qt).length,vt.type){case 5121:case 5123:case 5125:case 5126:(Dr=ae.allocType(vt.type,Dr)).set(yr),vt.data=Dr;break;case 36193:vt.data=m(yr)}vt.alignment=1,vt.needsFree=!0}else if(u(qt)){yr=qt.data,Array.isArray(yr)||vt.type!==5121||(vt.type=0|ue[Object.prototype.toString.call(yr)]),Dr=qt.shape;var Mr,xr,hr,Tr,fr=qt.stride;Dr.length===3?(hr=Dr[2],Tr=fr[2]):Tr=hr=1,Mr=Dr[0],xr=Dr[1],Dr=fr[0],fr=fr[1],vt.alignment=1,vt.width=Mr,vt.height=xr,vt.channels=hr,vt.format=vt.internalformat=Pe[hr],vt.needsFree=!0,Mr=Tr,qt=qt.offset,hr=vt.width,Tr=vt.height,xr=vt.channels;for(var br=ae.allocType(vt.type===36193?5126:vt.type,hr*Tr*xr),Or=0,sn=0;sn<Tr;++sn)for(var Jr=0;Jr<hr;++Jr)for(var dn=0;dn<xr;++dn)br[Or++]=yr[Dr*Jr+fr*sn+Mr*dn+qt];M(vt,br)}else if(A(qt)===ze||A(qt)===He||A(qt)===et)A(qt)===ze||A(qt)===He?vt.element=qt:vt.element=qt.canvas,vt.width=vt.element.width,vt.height=vt.element.height,vt.channels=4;else if(A(qt)===Re)vt.element=qt,vt.width=qt.width,vt.height=qt.height,vt.channels=4;else if(A(qt)===Ze)vt.element=qt,vt.width=qt.naturalWidth,vt.height=qt.naturalHeight,vt.channels=4;else if(A(qt)===Ke)vt.element=qt,vt.width=qt.videoWidth,vt.height=qt.videoHeight,vt.channels=4;else if(w(qt)){for(yr=vt.width||qt[0].length,Dr=vt.height||qt.length,fr=vt.channels,fr=y(qt[0][0])?fr||qt[0][0].length:fr||1,Mr=fe.shape(qt),hr=1,Tr=0;Tr<Mr.length;++Tr)hr*=Mr[Tr];hr=ae.allocType(vt.type===36193?5126:vt.type,hr),fe.flatten(qt,Mr,"",hr),M(vt,hr),vt.alignment=1,vt.width=yr,vt.height=Dr,vt.channels=fr,vt.format=vt.internalformat=Pe[fr],vt.needsFree=!0}}else vt.width=vt.width||1,vt.height=vt.height||1,vt.channels=vt.channels||4}function It(vt,Zt,qt,yr,Dr){var Mr=vt.element,xr=vt.data,hr=vt.internalformat,Tr=vt.format,fr=vt.type,br=vt.width,Or=vt.height;_t(vt),Mr?xe.texSubImage2D(Zt,Dr,qt,yr,Tr,fr,Mr):vt.compressed?xe.compressedTexSubImage2D(Zt,Dr,qt,yr,hr,br,Or,xr):vt.needsCopy?(it(),xe.copyTexSubImage2D(Zt,Dr,qt,yr,vt.xOffset,vt.yOffset,br,Or)):xe.texSubImage2D(Zt,Dr,qt,yr,br,Or,Tr,fr,xr)}function Nt(){return un.pop()||new xt}function Ot(vt){vt.needsFree&&ae.freeType(vt.data),xt.call(vt),un.push(vt)}function Yt(){bt.call(this),this.genMipmaps=!1,this.mipmapHint=4352,this.mipmask=0,this.images=Array(16)}function Pt(vt,Zt,qt){var yr=vt.images[0]=Nt();vt.mipmask=1,yr.width=vt.width=Zt,yr.height=vt.height=qt,yr.channels=vt.channels=4}function Ne(vt,Zt){var qt=null;if(E(Zt))Et(qt=vt.images[0]=Nt(),vt),At(qt,Zt),vt.mipmask=1;else if(Mt(vt,Zt),Array.isArray(Zt.mipmap))for(var yr=Zt.mipmap,Dr=0;Dr<yr.length;++Dr)Et(qt=vt.images[Dr]=Nt(),vt),qt.width>>=Dr,qt.height>>=Dr,At(qt,yr[Dr]),vt.mipmask|=1<<Dr;else Et(qt=vt.images[0]=Nt(),vt),At(qt,Zt),vt.mipmask=1;Et(vt,vt.images[0])}function ut(vt,Zt){for(var qt=vt.images,yr=0;yr<qt.length&&qt[yr];++yr){var Dr=qt[yr],Mr=Zt,xr=yr,hr=Dr.element,Tr=Dr.data,fr=Dr.internalformat,br=Dr.format,Or=Dr.type,sn=Dr.width,Jr=Dr.height;_t(Dr),hr?xe.texImage2D(Mr,xr,br,br,Or,hr):Dr.compressed?xe.compressedTexImage2D(Mr,xr,fr,sn,Jr,0,Tr):Dr.needsCopy?(it(),xe.copyTexImage2D(Mr,xr,br,Dr.xOffset,Dr.yOffset,sn,Jr,0)):xe.texImage2D(Mr,xr,br,sn,Jr,0,br,Or,Tr||null)}}function wt(){var vt=Zr.pop()||new Yt;bt.call(vt);for(var Zt=vt.mipmask=0;16>Zt;++Zt)vt.images[Zt]=null;return vt}function Bt(vt){for(var Zt=vt.images,qt=0;qt<Zt.length;++qt)Zt[qt]&&Ot(Zt[qt]),Zt[qt]=null;Zr.push(vt)}function Jt(){this.magFilter=this.minFilter=9728,this.wrapT=this.wrapS=33071,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=4352}function er(vt,Zt){"min"in Zt&&(vt.minFilter=Lr[Zt.min],0<=_e.indexOf(vt.minFilter)&&!("faces"in Zt)&&(vt.genMipmaps=!0)),"mag"in Zt&&(vt.magFilter=Sr[Zt.mag]);var qt=vt.wrapS,yr=vt.wrapT;if("wrap"in Zt){var Dr=Zt.wrap;typeof Dr=="string"?qt=yr=ur[Dr]:Array.isArray(Dr)&&(qt=ur[Dr[0]],yr=ur[Dr[1]])}else"wrapS"in Zt&&(qt=ur[Zt.wrapS]),"wrapT"in Zt&&(yr=ur[Zt.wrapT]);if(vt.wrapS=qt,vt.wrapT=yr,"anisotropic"in Zt&&(vt.anisotropic=Zt.anisotropic),"mipmap"in Zt){switch(qt=!1,typeof Zt.mipmap){case"string":vt.mipmapHint=Ut[Zt.mipmap],qt=vt.genMipmaps=!0;break;case"boolean":qt=vt.genMipmaps=Zt.mipmap;break;case"object":vt.genMipmaps=!1,qt=!0}!qt||"min"in Zt||(vt.minFilter=9984)}}function or(vt,Zt){xe.texParameteri(Zt,10241,vt.minFilter),xe.texParameteri(Zt,10240,vt.magFilter),xe.texParameteri(Zt,10242,vt.wrapS),xe.texParameteri(Zt,10243,vt.wrapT),Ee.ext_texture_filter_anisotropic&&xe.texParameteri(Zt,34046,vt.anisotropic),vt.genMipmaps&&(xe.hint(33170,vt.mipmapHint),xe.generateMipmap(Zt))}function zt(vt){bt.call(this),this.mipmask=0,this.internalformat=6408,this.id=yn++,this.refCount=1,this.target=vt,this.texture=xe.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new Jt,mt.profile&&(this.stats={size:0})}function Qt(vt){xe.activeTexture(33984),xe.bindTexture(vt.target,vt.texture)}function cr(){var vt=Kn[0];vt?xe.bindTexture(vt.target,vt.texture):xe.bindTexture(3553,null)}function Dt(vt){var Zt=vt.texture,qt=vt.unit,yr=vt.target;0<=qt&&(xe.activeTexture(33984+qt),xe.bindTexture(yr,null),Kn[qt]=null),xe.deleteTexture(Zt),vt.texture=null,vt.params=null,vt.pixels=null,vt.refCount=0,delete In[vt.id],ct.textureCount--}var Ut={"don't care":4352,"dont care":4352,nice:4354,fast:4353},ur={repeat:10497,clamp:33071,mirror:33648},Sr={nearest:9728,linear:9729},Lr=W({mipmap:9987,"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987},Sr),Hr={none:0,browser:37444},Kr={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},Ir={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},kr={};Ee.ext_srgb&&(Ir.srgb=35904,Ir.srgba=35906),Ee.oes_texture_float&&(Kr.float32=Kr.float=5126),Ee.oes_texture_half_float&&(Kr.float16=Kr["half float"]=36193),Ee.webgl_depth_texture&&(W(Ir,{depth:6402,"depth stencil":34041}),W(Kr,{uint16:5123,uint32:5125,"depth stencil":34042})),Ee.webgl_compressed_texture_s3tc&&W(kr,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779}),Ee.webgl_compressed_texture_atc&&W(kr,{"rgb atc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798}),Ee.webgl_compressed_texture_pvrtc&&W(kr,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843}),Ee.webgl_compressed_texture_etc1&&(kr["rgb etc1"]=36196);var rn=Array.prototype.slice.call(xe.getParameter(34467));Object.keys(kr).forEach(function(vt){var Zt=kr[vt];0<=rn.indexOf(Zt)&&(Ir[vt]=Zt)});var Qr=Object.keys(Ir);Je.textureFormats=Qr;var nn=[];Object.keys(Ir).forEach(function(vt){nn[Ir[vt]]=vt});var Xr=[];Object.keys(Kr).forEach(function(vt){Xr[Kr[vt]]=vt});var Nr=[];Object.keys(Sr).forEach(function(vt){Nr[Sr[vt]]=vt});var Br=[];Object.keys(Lr).forEach(function(vt){Br[Lr[vt]]=vt});var on=[];Object.keys(ur).forEach(function(vt){on[ur[vt]]=vt});var cn=Qr.reduce(function(vt,Zt){var qt=Ir[Zt];return qt===6409||qt===6406||qt===6409||qt===6410||qt===6402||qt===34041||Ee.ext_srgb&&(qt===35904||qt===35906)?vt[qt]=qt:qt===32855||0<=Zt.indexOf("rgba")?vt[qt]=6408:vt[qt]=6407,vt},{}),un=[],Zr=[],yn=0,In={},Un=Je.maxTextureUnits,Kn=Array(Un).map(function(){return null});return W(zt.prototype,{bind:function(){this.bindCount+=1;var vt=this.unit;if(0>vt){for(var Zt=0;Zt<Un;++Zt){var qt=Kn[Zt];if(qt){if(0<qt.bindCount)continue;qt.unit=-1}Kn[Zt]=this,vt=Zt;break}mt.profile&&ct.maxTextureUnits<vt+1&&(ct.maxTextureUnits=vt+1),this.unit=vt,xe.activeTexture(33984+vt),xe.bindTexture(this.target,this.texture)}return vt},unbind:function(){--this.bindCount},decRef:function(){0>=--this.refCount&&Dt(this)}}),mt.profile&&(ct.getTotalTextureSize=function(){var vt=0;return Object.keys(In).forEach(function(Zt){vt+=In[Zt].stats.size}),vt}),{create2D:function(vt,Zt){function qt(Dr,Mr){var xr=yr.texInfo;Jt.call(xr);var hr=wt();return typeof Dr=="number"?Pt(hr,0|Dr,typeof Mr=="number"?0|Mr:0|Dr):Dr?(er(xr,Dr),Ne(hr,Dr)):Pt(hr,1,1),xr.genMipmaps&&(hr.mipmask=(hr.width<<1)-1),yr.mipmask=hr.mipmask,Et(yr,hr),yr.internalformat=hr.internalformat,qt.width=hr.width,qt.height=hr.height,Qt(yr),ut(hr,3553),or(xr,3553),cr(),Bt(hr),mt.profile&&(yr.stats.size=b(yr.internalformat,yr.type,hr.width,hr.height,xr.genMipmaps,!1)),qt.format=nn[yr.internalformat],qt.type=Xr[yr.type],qt.mag=Nr[xr.magFilter],qt.min=Br[xr.minFilter],qt.wrapS=on[xr.wrapS],qt.wrapT=on[xr.wrapT],qt}var yr=new zt(3553);return In[yr.id]=yr,ct.textureCount++,qt(vt,Zt),qt.subimage=function(Dr,Mr,xr,hr){Mr|=0,xr|=0,hr|=0;var Tr=Nt();return Et(Tr,yr),Tr.width=0,Tr.height=0,At(Tr,Dr),Tr.width=Tr.width||(yr.width>>hr)-Mr,Tr.height=Tr.height||(yr.height>>hr)-xr,Qt(yr),It(Tr,3553,Mr,xr,hr),cr(),Ot(Tr),qt},qt.resize=function(Dr,Mr){var xr=0|Dr,hr=0|Mr||xr;if(xr===yr.width&&hr===yr.height)return qt;qt.width=yr.width=xr,qt.height=yr.height=hr,Qt(yr);for(var Tr=0;yr.mipmask>>Tr;++Tr){var fr=xr>>Tr,br=hr>>Tr;if(!fr||!br)break;xe.texImage2D(3553,Tr,yr.format,fr,br,0,yr.format,yr.type,null)}return cr(),mt.profile&&(yr.stats.size=b(yr.internalformat,yr.type,xr,hr,!1,!1)),qt},qt._reglType="texture2d",qt._texture=yr,mt.profile&&(qt.stats=yr.stats),qt.destroy=function(){yr.decRef()},qt},createCube:function(vt,Zt,qt,yr,Dr,Mr){function xr(fr,br,Or,sn,Jr,dn){var qr,bn=hr.texInfo;for(Jt.call(bn),qr=0;6>qr;++qr)Tr[qr]=wt();if(typeof fr!="number"&&fr){if(typeof fr=="object")if(br)Ne(Tr[0],fr),Ne(Tr[1],br),Ne(Tr[2],Or),Ne(Tr[3],sn),Ne(Tr[4],Jr),Ne(Tr[5],dn);else if(er(bn,fr),Mt(hr,fr),"faces"in fr)for(fr=fr.faces,qr=0;6>qr;++qr)Et(Tr[qr],hr),Ne(Tr[qr],fr[qr]);else for(qr=0;6>qr;++qr)Ne(Tr[qr],fr)}else for(fr=0|fr||1,qr=0;6>qr;++qr)Pt(Tr[qr],fr,fr);for(Et(hr,Tr[0]),hr.mipmask=bn.genMipmaps?(Tr[0].width<<1)-1:Tr[0].mipmask,hr.internalformat=Tr[0].internalformat,xr.width=Tr[0].width,xr.height=Tr[0].height,Qt(hr),qr=0;6>qr;++qr)ut(Tr[qr],34069+qr);for(or(bn,34067),cr(),mt.profile&&(hr.stats.size=b(hr.internalformat,hr.type,xr.width,xr.height,bn.genMipmaps,!0)),xr.format=nn[hr.internalformat],xr.type=Xr[hr.type],xr.mag=Nr[bn.magFilter],xr.min=Br[bn.minFilter],xr.wrapS=on[bn.wrapS],xr.wrapT=on[bn.wrapT],qr=0;6>qr;++qr)Bt(Tr[qr]);return xr}var hr=new zt(34067);In[hr.id]=hr,ct.cubeCount++;var Tr=Array(6);return xr(vt,Zt,qt,yr,Dr,Mr),xr.subimage=function(fr,br,Or,sn,Jr){Or|=0,sn|=0,Jr|=0;var dn=Nt();return Et(dn,hr),dn.width=0,dn.height=0,At(dn,br),dn.width=dn.width||(hr.width>>Jr)-Or,dn.height=dn.height||(hr.height>>Jr)-sn,Qt(hr),It(dn,34069+fr,Or,sn,Jr),cr(),Ot(dn),xr},xr.resize=function(fr){if((fr|=0)!==hr.width){xr.width=hr.width=fr,xr.height=hr.height=fr,Qt(hr);for(var br=0;6>br;++br)for(var Or=0;hr.mipmask>>Or;++Or)xe.texImage2D(34069+br,Or,hr.format,fr>>Or,fr>>Or,0,hr.format,hr.type,null);return cr(),mt.profile&&(hr.stats.size=b(hr.internalformat,hr.type,xr.width,xr.height,!1,!0)),xr}},xr._reglType="textureCube",xr._texture=hr,mt.profile&&(xr.stats=hr.stats),xr.destroy=function(){hr.decRef()},xr},clear:function(){for(var vt=0;vt<Un;++vt)xe.activeTexture(33984+vt),xe.bindTexture(3553,null),Kn[vt]=null;le(In).forEach(Dt),ct.cubeCount=0,ct.textureCount=0},getTexture:function(vt){return null},restore:function(){for(var vt=0;vt<Un;++vt){var Zt=Kn[vt];Zt&&(Zt.bindCount=0,Zt.unit=-1,Kn[vt]=null)}le(In).forEach(function(qt){qt.texture=xe.createTexture(),xe.bindTexture(qt.target,qt.texture);for(var yr=0;32>yr;++yr)if(qt.mipmask&1<<yr)if(qt.target===3553)xe.texImage2D(3553,yr,qt.internalformat,qt.width>>yr,qt.height>>yr,0,qt.internalformat,qt.type,null);else for(var Dr=0;6>Dr;++Dr)xe.texImage2D(34069+Dr,yr,qt.internalformat,qt.width>>yr,qt.height>>yr,0,qt.internalformat,qt.type,null);or(qt.texInfo,qt.target)})}}}function S(xe,Ee,Je,it,ht,ct){function mt(zt,Qt,cr){this.target=zt,this.texture=Qt,this.renderbuffer=cr;var Dt=zt=0;Qt?(zt=Qt.width,Dt=Qt.height):cr&&(zt=cr.width,Dt=cr.height),this.width=zt,this.height=Dt}function bt(zt){zt&&(zt.texture&&zt.texture._texture.decRef(),zt.renderbuffer&&zt.renderbuffer._renderbuffer.decRef())}function Et(zt,Qt,cr){zt&&(zt.texture?zt.texture._texture.refCount+=1:zt.renderbuffer._renderbuffer.refCount+=1)}function Mt(zt,Qt){Qt&&(Qt.texture?xe.framebufferTexture2D(36160,zt,Qt.target,Qt.texture._texture.texture,0):xe.framebufferRenderbuffer(36160,zt,36161,Qt.renderbuffer._renderbuffer.renderbuffer))}function _t(zt){var Qt=3553,cr=null,Dt=null,Ut=zt;return typeof zt=="object"&&(Ut=zt.data,"target"in zt&&(Qt=0|zt.target)),(zt=Ut._reglType)==="texture2d"||zt==="textureCube"?cr=Ut:zt==="renderbuffer"&&(Dt=Ut,Qt=36161),new mt(Qt,cr,Dt)}function xt(zt,Qt,cr,Dt,Ut){return cr?((zt=it.create2D({width:zt,height:Qt,format:Dt,type:Ut}))._texture.refCount=0,new mt(3553,zt,null)):((zt=ht.create({width:zt,height:Qt,format:Dt}))._renderbuffer.refCount=0,new mt(36161,null,zt))}function At(zt){return zt&&(zt.texture||zt.renderbuffer)}function It(zt,Qt,cr){zt&&(zt.texture?zt.texture.resize(Qt,cr):zt.renderbuffer&&zt.renderbuffer.resize(Qt,cr),zt.width=Qt,zt.height=cr)}function Nt(){this.id=er++,or[this.id]=this,this.framebuffer=xe.createFramebuffer(),this.height=this.width=0,this.colorAttachments=[],this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=null}function Ot(zt){zt.colorAttachments.forEach(bt),bt(zt.depthAttachment),bt(zt.stencilAttachment),bt(zt.depthStencilAttachment)}function Yt(zt){xe.deleteFramebuffer(zt.framebuffer),zt.framebuffer=null,ct.framebufferCount--,delete or[zt.id]}function Pt(zt){var Qt;xe.bindFramebuffer(36160,zt.framebuffer);var cr=zt.colorAttachments;for(Qt=0;Qt<cr.length;++Qt)Mt(36064+Qt,cr[Qt]);for(Qt=cr.length;Qt<Je.maxColorAttachments;++Qt)xe.framebufferTexture2D(36160,36064+Qt,3553,null,0);xe.framebufferTexture2D(36160,33306,3553,null,0),xe.framebufferTexture2D(36160,36096,3553,null,0),xe.framebufferTexture2D(36160,36128,3553,null,0),Mt(36096,zt.depthAttachment),Mt(36128,zt.stencilAttachment),Mt(33306,zt.depthStencilAttachment),xe.checkFramebufferStatus(36160),xe.isContextLost(),xe.bindFramebuffer(36160,ut.next?ut.next.framebuffer:null),ut.cur=ut.next,xe.getError()}function Ne(zt,Qt){function cr(Ut,ur){var Sr,Lr=0,Hr=0,Kr=!0,Ir=!0;Sr=null;var kr=!0,rn="rgba",Qr="uint8",nn=1,Xr=null,Nr=null,Br=null,on=!1;typeof Ut=="number"?(Lr=0|Ut,Hr=0|ur||Lr):Ut?("shape"in Ut?(Lr=(Hr=Ut.shape)[0],Hr=Hr[1]):("radius"in Ut&&(Lr=Hr=Ut.radius),"width"in Ut&&(Lr=Ut.width),"height"in Ut&&(Hr=Ut.height)),("color"in Ut||"colors"in Ut)&&(Sr=Ut.color||Ut.colors,Array.isArray(Sr)),Sr||("colorCount"in Ut&&(nn=0|Ut.colorCount),"colorTexture"in Ut&&(kr=!!Ut.colorTexture,rn="rgba4"),"colorType"in Ut&&(Qr=Ut.colorType,!kr)&&(Qr==="half float"||Qr==="float16"?rn="rgba16f":Qr!=="float"&&Qr!=="float32"||(rn="rgba32f")),"colorFormat"in Ut&&(rn=Ut.colorFormat,0<=wt.indexOf(rn)?kr=!0:0<=Bt.indexOf(rn)&&(kr=!1))),("depthTexture"in Ut||"depthStencilTexture"in Ut)&&(on=!(!Ut.depthTexture&&!Ut.depthStencilTexture)),"depth"in Ut&&(typeof Ut.depth=="boolean"?Kr=Ut.depth:(Xr=Ut.depth,Ir=!1)),"stencil"in Ut&&(typeof Ut.stencil=="boolean"?Ir=Ut.stencil:(Nr=Ut.stencil,Kr=!1)),"depthStencil"in Ut&&(typeof Ut.depthStencil=="boolean"?Kr=Ir=Ut.depthStencil:(Br=Ut.depthStencil,Ir=Kr=!1))):Lr=Hr=1;var cn=null,un=null,Zr=null,yn=null;if(Array.isArray(Sr))cn=Sr.map(_t);else if(Sr)cn=[_t(Sr)];else for(cn=Array(nn),Sr=0;Sr<nn;++Sr)cn[Sr]=xt(Lr,Hr,kr,rn,Qr);for(Lr=Lr||cn[0].width,Hr=Hr||cn[0].height,Xr?un=_t(Xr):Kr&&!Ir&&(un=xt(Lr,Hr,on,"depth","uint32")),Nr?Zr=_t(Nr):Ir&&!Kr&&(Zr=xt(Lr,Hr,!1,"stencil","uint8")),Br?yn=_t(Br):!Xr&&!Nr&&Ir&&Kr&&(yn=xt(Lr,Hr,on,"depth stencil","depth stencil")),Kr=null,Sr=0;Sr<cn.length;++Sr)Et(cn[Sr]),cn[Sr]&&cn[Sr].texture&&(Ir=Ie[cn[Sr].texture._texture.format]*be[cn[Sr].texture._texture.type],Kr===null&&(Kr=Ir));return Et(un),Et(Zr),Et(yn),Ot(Dt),Dt.width=Lr,Dt.height=Hr,Dt.colorAttachments=cn,Dt.depthAttachment=un,Dt.stencilAttachment=Zr,Dt.depthStencilAttachment=yn,cr.color=cn.map(At),cr.depth=At(un),cr.stencil=At(Zr),cr.depthStencil=At(yn),cr.width=Dt.width,cr.height=Dt.height,Pt(Dt),cr}var Dt=new Nt;return ct.framebufferCount++,cr(zt,Qt),W(cr,{resize:function(Ut,ur){var Sr=Math.max(0|Ut,1),Lr=Math.max(0|ur||Sr,1);if(Sr===Dt.width&&Lr===Dt.height)return cr;for(var Hr=Dt.colorAttachments,Kr=0;Kr<Hr.length;++Kr)It(Hr[Kr],Sr,Lr);return It(Dt.depthAttachment,Sr,Lr),It(Dt.stencilAttachment,Sr,Lr),It(Dt.depthStencilAttachment,Sr,Lr),Dt.width=cr.width=Sr,Dt.height=cr.height=Lr,Pt(Dt),cr},_reglType:"framebuffer",_framebuffer:Dt,destroy:function(){Yt(Dt),Ot(Dt)},use:function(Ut){ut.setFBO({framebuffer:cr},Ut)}})}var ut={cur:null,next:null,dirty:!1,setFBO:null},wt=["rgba"],Bt=["rgba4","rgb565","rgb5 a1"];Ee.ext_srgb&&Bt.push("srgba"),Ee.ext_color_buffer_half_float&&Bt.push("rgba16f","rgb16f"),Ee.webgl_color_buffer_float&&Bt.push("rgba32f");var Jt=["uint8"];Ee.oes_texture_half_float&&Jt.push("half float","float16"),Ee.oes_texture_float&&Jt.push("float","float32");var er=0,or={};return W(ut,{getFramebuffer:function(zt){return typeof zt=="function"&&zt._reglType==="framebuffer"&&(zt=zt._framebuffer)instanceof Nt?zt:null},create:Ne,createCube:function(zt){function Qt(Dt){var Ut,ur={color:null},Sr=0,Lr=null;Ut="rgba";var Hr="uint8",Kr=1;if(typeof Dt=="number"?Sr=0|Dt:Dt?("shape"in Dt?Sr=Dt.shape[0]:("radius"in Dt&&(Sr=0|Dt.radius),"width"in Dt?Sr=0|Dt.width:"height"in Dt&&(Sr=0|Dt.height)),("color"in Dt||"colors"in Dt)&&(Lr=Dt.color||Dt.colors,Array.isArray(Lr)),Lr||("colorCount"in Dt&&(Kr=0|Dt.colorCount),"colorType"in Dt&&(Hr=Dt.colorType),"colorFormat"in Dt&&(Ut=Dt.colorFormat)),"depth"in Dt&&(ur.depth=Dt.depth),"stencil"in Dt&&(ur.stencil=Dt.stencil),"depthStencil"in Dt&&(ur.depthStencil=Dt.depthStencil)):Sr=1,Lr)if(Array.isArray(Lr))for(Dt=[],Ut=0;Ut<Lr.length;++Ut)Dt[Ut]=Lr[Ut];else Dt=[Lr];else for(Dt=Array(Kr),Lr={radius:Sr,format:Ut,type:Hr},Ut=0;Ut<Kr;++Ut)Dt[Ut]=it.createCube(Lr);for(ur.color=Array(Dt.length),Ut=0;Ut<Dt.length;++Ut)Kr=Dt[Ut],Sr=Sr||Kr.width,ur.color[Ut]={target:34069,data:Dt[Ut]};for(Ut=0;6>Ut;++Ut){for(Kr=0;Kr<Dt.length;++Kr)ur.color[Kr].target=34069+Ut;0<Ut&&(ur.depth=cr[0].depth,ur.stencil=cr[0].stencil,ur.depthStencil=cr[0].depthStencil),cr[Ut]?cr[Ut](ur):cr[Ut]=Ne(ur)}return W(Qt,{width:Sr,height:Sr,color:Dt})}var cr=Array(6);return Qt(zt),W(Qt,{faces:cr,resize:function(Dt){var Ut=0|Dt;if(Ut===Qt.width)return Qt;var ur=Qt.color;for(Dt=0;Dt<ur.length;++Dt)ur[Dt].resize(Ut);for(Dt=0;6>Dt;++Dt)cr[Dt].resize(Ut);return Qt.width=Qt.height=Ut,Qt},_reglType:"framebufferCube",destroy:function(){cr.forEach(function(Dt){Dt.destroy()})}})},clear:function(){le(or).forEach(Yt)},restore:function(){ut.cur=null,ut.next=null,ut.dirty=!0,le(or).forEach(function(zt){zt.framebuffer=xe.createFramebuffer(),Pt(zt)})}})}function C(){this.w=this.z=this.y=this.x=this.state=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=5126,this.divisor=this.stride=this.offset=0}function k(xe,Ee,Je,it,ht){function ct(){this.id=++Et,this.attributes=[];var xt=Ee.oes_vertex_array_object;this.vao=xt?xt.createVertexArrayOES():null,Mt[this.id]=this,this.buffers=[]}var mt=Je.maxAttributes,bt=Array(mt);for(Je=0;Je<mt;++Je)bt[Je]=new C;var Et=0,Mt={},_t={Record:C,scope:{},state:bt,currentVAO:null,targetVAO:null,restore:Ee.oes_vertex_array_object?function(){Ee.oes_vertex_array_object&&le(Mt).forEach(function(xt){xt.refresh()})}:function(){},createVAO:function(xt){function At(Nt){for(var Ot=0;Ot<It.buffers.length;++Ot)It.buffers[Ot].destroy();It.buffers.length=0,(Ot=It.attributes).length=Nt.length;for(var Yt=0;Yt<Nt.length;++Yt){var Pt=Nt[Yt],Ne=Ot[Yt]=new C;Array.isArray(Pt)||de(Pt)||u(Pt)?(Pt=ht.create(Pt,34962,!1,!0),Ne.buffer=ht.getBuffer(Pt),Ne.size=0|Ne.buffer.dimension,Ne.normalized=!1,Ne.type=Ne.buffer.dtype,Ne.offset=0,Ne.stride=0,Ne.divisor=0,Ne.state=1,It.buffers.push(Pt)):ht.getBuffer(Pt)?(Ne.buffer=ht.getBuffer(Pt),Ne.size=0|Ne.buffer.dimension,Ne.normalized=!1,Ne.type=Ne.buffer.dtype,Ne.offset=0,Ne.stride=0,Ne.divisor=0,Ne.state=1):ht.getBuffer(Pt.buffer)?(Ne.buffer=ht.getBuffer(Pt.buffer),Ne.size=0|(+Pt.size||Ne.buffer.dimension),Ne.normalized=!!Pt.normalized||!1,Ne.type="type"in Pt?we[Pt.type]:Ne.buffer.dtype,Ne.offset=0|(Pt.offset||0),Ne.stride=0|(Pt.stride||0),Ne.divisor=0|(Pt.divisor||0),Ne.state=1):"x"in Pt&&(Ne.x=+Pt.x||0,Ne.y=+Pt.y||0,Ne.z=+Pt.z||0,Ne.w=+Pt.w||0,Ne.state=2)}return It.refresh(),At}var It=new ct;return it.vaoCount+=1,At.destroy=function(){It.destroy()},At._vao=It,At._reglType="vao",At(xt)},getVAO:function(xt){return typeof xt=="function"&&xt._vao?xt._vao:null},destroyBuffer:function(xt){for(var At=0;At<bt.length;++At){var It=bt[At];It.buffer===xt&&(xe.disableVertexAttribArray(At),It.buffer=null)}},setVAO:Ee.oes_vertex_array_object?function(xt){if(xt!==_t.currentVAO){var At=Ee.oes_vertex_array_object;xt?At.bindVertexArrayOES(xt.vao):At.bindVertexArrayOES(null),_t.currentVAO=xt}}:function(xt){if(xt!==_t.currentVAO){if(xt)xt.bindAttrs();else for(var At=Ee.angle_instanced_arrays,It=0;It<bt.length;++It){var Nt=bt[It];Nt.buffer?(xe.enableVertexAttribArray(It),xe.vertexAttribPointer(It,Nt.size,Nt.type,Nt.normalized,Nt.stride,Nt.offfset),At&&At.vertexAttribDivisorANGLE(It,Nt.divisor)):(xe.disableVertexAttribArray(It),xe.vertexAttrib4f(It,Nt.x,Nt.y,Nt.z,Nt.w))}_t.currentVAO=xt}},clear:Ee.oes_vertex_array_object?function(){le(Mt).forEach(function(xt){xt.destroy()})}:function(){}};return ct.prototype.bindAttrs=function(){for(var xt=Ee.angle_instanced_arrays,At=this.attributes,It=0;It<At.length;++It){var Nt=At[It];Nt.buffer?(xe.enableVertexAttribArray(It),xe.bindBuffer(34962,Nt.buffer.buffer),xe.vertexAttribPointer(It,Nt.size,Nt.type,Nt.normalized,Nt.stride,Nt.offset),xt&&xt.vertexAttribDivisorANGLE(It,Nt.divisor)):(xe.disableVertexAttribArray(It),xe.vertexAttrib4f(It,Nt.x,Nt.y,Nt.z,Nt.w))}for(xt=At.length;xt<mt;++xt)xe.disableVertexAttribArray(xt)},ct.prototype.refresh=function(){var xt=Ee.oes_vertex_array_object;xt&&(xt.bindVertexArrayOES(this.vao),this.bindAttrs(),_t.currentVAO=this)},ct.prototype.destroy=function(){if(this.vao){var xt=Ee.oes_vertex_array_object;this===_t.currentVAO&&(_t.currentVAO=null,xt.bindVertexArrayOES(null)),xt.deleteVertexArrayOES(this.vao),this.vao=null}Mt[this.id]&&(delete Mt[this.id],--it.vaoCount)},_t}function L(xe,Ee,Je,it){function ht(Nt,Ot,Yt,Pt){this.name=Nt,this.id=Ot,this.location=Yt,this.info=Pt}function ct(Nt,Ot){for(var Yt=0;Yt<Nt.length;++Yt)if(Nt[Yt].id===Ot.id)return void(Nt[Yt].location=Ot.location);Nt.push(Ot)}function mt(Nt,Ot,Yt){if(!(Ne=(Yt=Nt===35632?Mt:_t)[Ot])){var Pt=Ee.str(Ot),Ne=xe.createShader(Nt);xe.shaderSource(Ne,Pt),xe.compileShader(Ne),Yt[Ot]=Ne}return Ne}function bt(Nt,Ot){this.id=It++,this.fragId=Nt,this.vertId=Ot,this.program=null,this.uniforms=[],this.attributes=[],it.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function Et(Nt,Ot,Yt){var Pt;Pt=mt(35632,Nt.fragId);var Ne=mt(35633,Nt.vertId);if(Ot=Nt.program=xe.createProgram(),xe.attachShader(Ot,Pt),xe.attachShader(Ot,Ne),Yt)for(Pt=0;Pt<Yt.length;++Pt)Ne=Yt[Pt],xe.bindAttribLocation(Ot,Ne[0],Ne[1]);xe.linkProgram(Ot),Ne=xe.getProgramParameter(Ot,35718),it.profile&&(Nt.stats.uniformsCount=Ne);var ut=Nt.uniforms;for(Pt=0;Pt<Ne;++Pt)if(Yt=xe.getActiveUniform(Ot,Pt))if(1<Yt.size)for(var wt=0;wt<Yt.size;++wt){var Bt=Yt.name.replace("[0]","["+wt+"]");ct(ut,new ht(Bt,Ee.id(Bt),xe.getUniformLocation(Ot,Bt),Yt))}else ct(ut,new ht(Yt.name,Ee.id(Yt.name),xe.getUniformLocation(Ot,Yt.name),Yt));for(Ne=xe.getProgramParameter(Ot,35721),it.profile&&(Nt.stats.attributesCount=Ne),Nt=Nt.attributes,Pt=0;Pt<Ne;++Pt)(Yt=xe.getActiveAttrib(Ot,Pt))&&ct(Nt,new ht(Yt.name,Ee.id(Yt.name),xe.getAttribLocation(Ot,Yt.name),Yt))}var Mt={},_t={},xt={},At=[],It=0;return it.profile&&(Je.getMaxUniformsCount=function(){var Nt=0;return At.forEach(function(Ot){Ot.stats.uniformsCount>Nt&&(Nt=Ot.stats.uniformsCount)}),Nt},Je.getMaxAttributesCount=function(){var Nt=0;return At.forEach(function(Ot){Ot.stats.attributesCount>Nt&&(Nt=Ot.stats.attributesCount)}),Nt}),{clear:function(){var Nt=xe.deleteShader.bind(xe);le(Mt).forEach(Nt),Mt={},le(_t).forEach(Nt),_t={},At.forEach(function(Ot){xe.deleteProgram(Ot.program)}),At.length=0,xt={},Je.shaderCount=0},program:function(Nt,Ot,Yt,Pt){var Ne=xt[Ot];Ne||(Ne=xt[Ot]={});var ut=Ne[Nt];return ut&&!Pt?ut:(Ot=new bt(Ot,Nt),Je.shaderCount++,Et(Ot,Yt,Pt),ut||(Ne[Nt]=Ot),At.push(Ot),Ot)},restore:function(){Mt={},_t={};for(var Nt=0;Nt<At.length;++Nt)Et(At[Nt],null,At[Nt].attributes.map(function(Ot){return[Ot.location,Ot.name]}))},shader:mt,frag:-1,vert:-1}}function I(xe,Ee,Je,it,ht,ct,mt){function bt(Et){var Mt;Mt=Ee.next===null?5121:Ee.next.colorAttachments[0].texture._texture.type;var _t=0,xt=0,At=it.framebufferWidth,It=it.framebufferHeight,Nt=null;return de(Et)?Nt=Et:Et&&(_t=0|Et.x,xt=0|Et.y,At=0|(Et.width||it.framebufferWidth-_t),It=0|(Et.height||it.framebufferHeight-xt),Nt=Et.data||null),Je(),Et=At*It*4,Nt||(Mt===5121?Nt=new Uint8Array(Et):Mt===5126&&(Nt=Nt||new Float32Array(Et))),xe.pixelStorei(3333,4),xe.readPixels(_t,xt,At,It,6408,Mt,Nt),Nt}return function(Et){return Et&&"framebuffer"in Et?function(Mt){var _t;return Ee.setFBO({framebuffer:Mt.framebuffer},function(){_t=bt(Mt)}),_t}(Et):bt(Et)}}function R(xe){return Array.prototype.slice.call(xe)}function V(xe){return R(xe).join("")}function O(){function xe(){var bt=[],Et=[];return W(function(){bt.push.apply(bt,R(arguments))},{def:function(){var Mt="v"+Je++;return Et.push(Mt),0<arguments.length&&(bt.push(Mt,"="),bt.push.apply(bt,R(arguments)),bt.push(";")),Mt},toString:function(){return V([0<Et.length?"var "+Et.join(",")+";":"",V(bt)])}})}function Ee(){function bt(At,It){Mt(At,It,"=",Et.def(At,It),";")}var Et=xe(),Mt=xe(),_t=Et.toString,xt=Mt.toString;return W(function(){Et.apply(Et,R(arguments))},{def:Et.def,entry:Et,exit:Mt,save:bt,set:function(At,It,Nt){bt(At,It),Et(At,It,"=",Nt,";")},toString:function(){return _t()+xt()}})}var Je=0,it=[],ht=[],ct=xe(),mt={};return{global:ct,link:function(bt){for(var Et=0;Et<ht.length;++Et)if(ht[Et]===bt)return it[Et];return Et="g"+Je++,it.push(Et),ht.push(bt),Et},block:xe,proc:function(bt,Et){function Mt(){var It="a"+_t.length;return _t.push(It),It}var _t=[];Et=Et||0;for(var xt=0;xt<Et;++xt)Mt();var At=(xt=Ee()).toString;return mt[bt]=W(xt,{arg:Mt,toString:function(){return V(["function(",_t.join(),"){",At(),"}"])}})},scope:Ee,cond:function(){var bt=V(arguments),Et=Ee(),Mt=Ee(),_t=Et.toString,xt=Mt.toString;return W(Et,{then:function(){return Et.apply(Et,R(arguments)),this},else:function(){return Mt.apply(Mt,R(arguments)),this},toString:function(){var At=xt();return At&&(At="else{"+At+"}"),V(["if(",bt,"){",_t(),"}",At])}})},compile:function(){var bt=['"use strict";',ct,"return {"];Object.keys(mt).forEach(function(Mt){bt.push('"',Mt,'":',mt[Mt].toString(),",")}),bt.push("}");var Et=V(bt).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`);return Function.apply(null,it.concat(Et)).apply(null,ht)}}}function J(xe){return Array.isArray(xe)||de(xe)||u(xe)}function D(xe){return xe.sort(function(Ee,Je){return Ee==="viewport"?-1:Je==="viewport"?1:Ee<Je?-1:1})}function B(xe,Ee,Je,it){this.thisDep=xe,this.contextDep=Ee,this.propDep=Je,this.append=it}function N(xe){return xe&&!(xe.thisDep||xe.contextDep||xe.propDep)}function F(xe){return new B(!1,!1,!1,xe)}function H(xe,Ee){var Je=xe.type;return Je===0?new B(!0,1<=(Je=xe.data.length),2<=Je,Ee):Je===4?new B((Je=xe.data).thisDep,Je.contextDep,Je.propDep,Ee):new B(Je===3,Je===2,Je===1,Ee)}function j(xe,Ee,Je,it,ht,ct,mt,bt,Et,Mt,_t,xt,At,It,Nt){function Ot(vt){return vt.replace(".","_")}function Yt(vt,Zt,qt){var yr=Ot(vt);un.push(vt),cn[yr]=on[yr]=!!qt,Zr[yr]=Zt}function Pt(vt,Zt,qt){var yr=Ot(vt);un.push(vt),Array.isArray(qt)?(on[yr]=qt.slice(),cn[yr]=qt.slice()):on[yr]=cn[yr]=qt,yn[yr]=Zt}function Ne(){var vt=O(),Zt=vt.link,qt=vt.global;vt.id=Kn++,vt.batchId="0";var yr=Zt(In),Dr=vt.shared={props:"a0"};Object.keys(In).forEach(function(fr){Dr[fr]=qt.def(yr,".",fr)});var Mr=vt.next={},xr=vt.current={};Object.keys(yn).forEach(function(fr){Array.isArray(on[fr])&&(Mr[fr]=qt.def(Dr.next,".",fr),xr[fr]=qt.def(Dr.current,".",fr))});var hr=vt.constants={};Object.keys(Un).forEach(function(fr){hr[fr]=qt.def(JSON.stringify(Un[fr]))}),vt.invoke=function(fr,br){switch(br.type){case 0:var Or=["this",Dr.context,Dr.props,vt.batchId];return fr.def(Zt(br.data),".call(",Or.slice(0,Math.max(br.data.length+1,4)),")");case 1:return fr.def(Dr.props,br.data);case 2:return fr.def(Dr.context,br.data);case 3:return fr.def("this",br.data);case 4:return br.data.append(vt,fr),br.data.ref}},vt.attribCache={};var Tr={};return vt.scopeAttrib=function(fr){if((fr=Ee.id(fr))in Tr)return Tr[fr];var br=Mt.scope[fr];return br||(br=Mt.scope[fr]=new nn),Tr[fr]=Zt(br)},vt}function ut(vt,Zt){var qt=vt.static,yr=vt.dynamic;if("framebuffer"in qt){var Dr=qt.framebuffer;return Dr?(Dr=bt.getFramebuffer(Dr),F(function(xr,hr){var Tr=xr.link(Dr),fr=xr.shared;return hr.set(fr.framebuffer,".next",Tr),fr=fr.context,hr.set(fr,".framebufferWidth",Tr+".width"),hr.set(fr,".framebufferHeight",Tr+".height"),Tr})):F(function(xr,hr){var Tr=xr.shared;return hr.set(Tr.framebuffer,".next","null"),Tr=Tr.context,hr.set(Tr,".framebufferWidth",Tr+".drawingBufferWidth"),hr.set(Tr,".framebufferHeight",Tr+".drawingBufferHeight"),"null"})}if("framebuffer"in yr){var Mr=yr.framebuffer;return H(Mr,function(xr,hr){var Tr=xr.invoke(hr,Mr),fr=xr.shared,br=fr.framebuffer;return Tr=hr.def(br,".getFramebuffer(",Tr,")"),hr.set(br,".next",Tr),fr=fr.context,hr.set(fr,".framebufferWidth",Tr+"?"+Tr+".width:"+fr+".drawingBufferWidth"),hr.set(fr,".framebufferHeight",Tr+"?"+Tr+".height:"+fr+".drawingBufferHeight"),Tr})}return null}function wt(vt,Zt,qt){function yr(fr){if(fr in Dr){var br=Ee.id(Dr[fr]);return(fr=F(function(){return br})).id=br,fr}if(fr in Mr){var Or=Mr[fr];return H(Or,function(sn,Jr){var dn=sn.invoke(Jr,Or);return Jr.def(sn.shared.strings,".id(",dn,")")})}return null}var Dr=vt.static,Mr=vt.dynamic,xr=yr("frag"),hr=yr("vert"),Tr=null;return N(xr)&&N(hr)?(Tr=_t.program(hr.id,xr.id,null,qt),vt=F(function(fr,br){return fr.link(Tr)})):vt=new B(xr&&xr.thisDep||hr&&hr.thisDep,xr&&xr.contextDep||hr&&hr.contextDep,xr&&xr.propDep||hr&&hr.propDep,function(fr,br){var Or,sn,Jr=fr.shared.shader;return Or=xr?xr.append(fr,br):br.def(Jr,".","frag"),sn=hr?hr.append(fr,br):br.def(Jr,".","vert"),br.def(Jr+".program("+sn+","+Or+")")}),{frag:xr,vert:hr,progVar:vt,program:Tr}}function Bt(vt,Zt){function qt(hr,Tr){if(hr in yr){var fr=0|yr[hr];return F(function(Or,sn){return Tr&&(Or.OFFSET=fr),fr})}if(hr in Dr){var br=Dr[hr];return H(br,function(Or,sn){var Jr=Or.invoke(sn,br);return Tr&&(Or.OFFSET=Jr),Jr})}return Tr&&Mr?F(function(Or,sn){return Or.OFFSET="0",0}):null}var yr=vt.static,Dr=vt.dynamic,Mr=function(){if("elements"in yr){var hr=yr.elements;J(hr)?hr=ct.getElements(ct.create(hr,!0)):hr&&(hr=ct.getElements(hr));var Tr=F(function(br,Or){if(hr){var sn=br.link(hr);return br.ELEMENTS=sn}return br.ELEMENTS=null});return Tr.value=hr,Tr}if("elements"in Dr){var fr=Dr.elements;return H(fr,function(br,Or){var sn=(Jr=br.shared).isBufferArgs,Jr=Jr.elements,dn=br.invoke(Or,fr),qr=Or.def("null");return sn=Or.def(sn,"(",dn,")"),dn=br.cond(sn).then(qr,"=",Jr,".createStream(",dn,");").else(qr,"=",Jr,".getElements(",dn,");"),Or.entry(dn),Or.exit(br.cond(sn).then(Jr,".destroyStream(",qr,");")),br.ELEMENTS=qr})}return null}(),xr=qt("offset",!0);return{elements:Mr,primitive:function(){if("primitive"in yr){var hr=yr.primitive;return F(function(fr,br){return ve[hr]})}if("primitive"in Dr){var Tr=Dr.primitive;return H(Tr,function(fr,br){var Or=fr.constants.primTypes,sn=fr.invoke(br,Tr);return br.def(Or,"[",sn,"]")})}return Mr?N(Mr)?Mr.value?F(function(fr,br){return br.def(fr.ELEMENTS,".primType")}):F(function(){return 4}):new B(Mr.thisDep,Mr.contextDep,Mr.propDep,function(fr,br){var Or=fr.ELEMENTS;return br.def(Or,"?",Or,".primType:",4)}):null}(),count:function(){if("count"in yr){var hr=0|yr.count;return F(function(){return hr})}if("count"in Dr){var Tr=Dr.count;return H(Tr,function(fr,br){return fr.invoke(br,Tr)})}return Mr?N(Mr)?Mr?xr?new B(xr.thisDep,xr.contextDep,xr.propDep,function(fr,br){return br.def(fr.ELEMENTS,".vertCount-",fr.OFFSET)}):F(function(fr,br){return br.def(fr.ELEMENTS,".vertCount")}):F(function(){return-1}):new B(Mr.thisDep||xr.thisDep,Mr.contextDep||xr.contextDep,Mr.propDep||xr.propDep,function(fr,br){var Or=fr.ELEMENTS;return fr.OFFSET?br.def(Or,"?",Or,".vertCount-",fr.OFFSET,":-1"):br.def(Or,"?",Or,".vertCount:-1")}):null}(),instances:qt("instances",!1),offset:xr}}function Jt(vt,Zt){var qt=vt.static,yr=vt.dynamic,Dr={};return Object.keys(qt).forEach(function(Mr){var xr=qt[Mr],hr=Ee.id(Mr),Tr=new nn;if(J(xr))Tr.state=1,Tr.buffer=ht.getBuffer(ht.create(xr,34962,!1,!0)),Tr.type=0;else if(br=ht.getBuffer(xr))Tr.state=1,Tr.buffer=br,Tr.type=0;else if("constant"in xr){var fr=xr.constant;Tr.buffer="null",Tr.state=2,typeof fr=="number"?Tr.x=fr:We.forEach(function(bn,Qn){Qn<fr.length&&(Tr[bn]=fr[Qn])})}else{var br=J(xr.buffer)?ht.getBuffer(ht.create(xr.buffer,34962,!1,!0)):ht.getBuffer(xr.buffer),Or=0|xr.offset,sn=0|xr.stride,Jr=0|xr.size,dn=!!xr.normalized,qr=0;"type"in xr&&(qr=we[xr.type]),xr=0|xr.divisor,Tr.buffer=br,Tr.state=1,Tr.size=Jr,Tr.normalized=dn,Tr.type=qr||br.dtype,Tr.offset=Or,Tr.stride=sn,Tr.divisor=xr}Dr[Mr]=F(function(bn,Qn){var Dn=bn.attribCache;if(hr in Dn)return Dn[hr];var gn={isStream:!1};return Object.keys(Tr).forEach(function(Pn){gn[Pn]=Tr[Pn]}),Tr.buffer&&(gn.buffer=bn.link(Tr.buffer),gn.type=gn.type||gn.buffer+".dtype"),Dn[hr]=gn})}),Object.keys(yr).forEach(function(Mr){var xr=yr[Mr];Dr[Mr]=H(xr,function(hr,Tr){function fr(Dn){Tr(dn[Dn],"=",br,".",Dn,"|0;")}var br=hr.invoke(Tr,xr),Or=hr.shared,sn=hr.constants,Jr=Or.isBufferArgs,dn=(Or=Or.buffer,{isStream:Tr.def(!1)}),qr=new nn;qr.state=1,Object.keys(qr).forEach(function(Dn){dn[Dn]=Tr.def(""+qr[Dn])});var bn=dn.buffer,Qn=dn.type;return Tr("if(",Jr,"(",br,")){",dn.isStream,"=true;",bn,"=",Or,".createStream(",34962,",",br,");",Qn,"=",bn,".dtype;","}else{",bn,"=",Or,".getBuffer(",br,");","if(",bn,"){",Qn,"=",bn,".dtype;",'}else if("constant" in ',br,"){",dn.state,"=",2,";","if(typeof "+br+'.constant === "number"){',dn[We[0]],"=",br,".constant;",We.slice(1).map(function(Dn){return dn[Dn]}).join("="),"=0;","}else{",We.map(function(Dn,gn){return dn[Dn]+"="+br+".constant.length>"+gn+"?"+br+".constant["+gn+"]:0;"}).join(""),"}}else{","if(",Jr,"(",br,".buffer)){",bn,"=",Or,".createStream(",34962,",",br,".buffer);","}else{",bn,"=",Or,".getBuffer(",br,".buffer);","}",Qn,'="type" in ',br,"?",sn.glTypes,"[",br,".type]:",bn,".dtype;",dn.normalized,"=!!",br,".normalized;"),fr("size"),fr("offset"),fr("stride"),fr("divisor"),Tr("}}"),Tr.exit("if(",dn.isStream,"){",Or,".destroyStream(",bn,");","}"),dn})}),Dr}function er(vt,Zt,qt,yr,Dr){function Mr(qr){var bn=hr[qr];bn&&(fr[qr]=bn)}var xr=function(qr,bn){if(typeof(Qn=qr.static).frag=="string"&&typeof Qn.vert=="string"){if(0<Object.keys(bn.dynamic).length)return null;var Qn=bn.static,Dn=Object.keys(Qn);if(0<Dn.length&&typeof Qn[Dn[0]]=="number"){for(var gn=[],Pn=0;Pn<Dn.length;++Pn)gn.push([0|Qn[Dn[Pn]],Dn[Pn]]);return gn}}return null}(vt,Zt),hr=function(qr,bn,Qn){function Dn(ta){if(ta in gn){var fn=gn[ta];ta=!0;var zn,Wn,Sa=0|fn.x,ti=0|fn.y;return"width"in fn?zn=0|fn.width:ta=!1,"height"in fn?Wn=0|fn.height:ta=!1,new B(!ta&&bn&&bn.thisDep,!ta&&bn&&bn.contextDep,!ta&&bn&&bn.propDep,function(xo,ki){var ja=xo.shared.context,bo=zn;"width"in fn||(bo=ki.def(ja,".","framebufferWidth","-",Sa));var ss=Wn;return"height"in fn||(ss=ki.def(ja,".","framebufferHeight","-",ti)),[Sa,ti,bo,ss]})}if(ta in Pn){var yi=Pn[ta];return ta=H(yi,function(xo,ki){var ja=xo.invoke(ki,yi),bo=xo.shared.context,ss=ki.def(ja,".x|0"),Ua=ki.def(ja,".y|0");return[ss,Ua,ki.def('"width" in ',ja,"?",ja,".width|0:","(",bo,".","framebufferWidth","-",ss,")"),ja=ki.def('"height" in ',ja,"?",ja,".height|0:","(",bo,".","framebufferHeight","-",Ua,")")]}),bn&&(ta.thisDep=ta.thisDep||bn.thisDep,ta.contextDep=ta.contextDep||bn.contextDep,ta.propDep=ta.propDep||bn.propDep),ta}return bn?new B(bn.thisDep,bn.contextDep,bn.propDep,function(xo,ki){var ja=xo.shared.context;return[0,0,ki.def(ja,".","framebufferWidth"),ki.def(ja,".","framebufferHeight")]}):null}var gn=qr.static,Pn=qr.dynamic;if(qr=Dn("viewport")){var na=qr;qr=new B(qr.thisDep,qr.contextDep,qr.propDep,function(ta,fn){var zn=na.append(ta,fn),Wn=ta.shared.context;return fn.set(Wn,".viewportWidth",zn[2]),fn.set(Wn,".viewportHeight",zn[3]),zn})}return{viewport:qr,scissor_box:Dn("scissor.box")}}(vt,Or=ut(vt)),Tr=Bt(vt),fr=function(qr,bn){var Qn=qr.static,Dn=qr.dynamic,gn={};return un.forEach(function(Pn){function na(fn,zn){if(Pn in Qn){var Wn=fn(Qn[Pn]);gn[ta]=F(function(){return Wn})}else if(Pn in Dn){var Sa=Dn[Pn];gn[ta]=H(Sa,function(ti,yi){return zn(ti,yi,ti.invoke(yi,Sa))})}}var ta=Ot(Pn);switch(Pn){case"cull.enable":case"blend.enable":case"dither":case"stencil.enable":case"depth.enable":case"scissor.enable":case"polygonOffset.enable":case"sample.alpha":case"sample.enable":case"depth.mask":return na(function(fn){return fn},function(fn,zn,Wn){return Wn});case"depth.func":return na(function(fn){return ot[fn]},function(fn,zn,Wn){return zn.def(fn.constants.compareFuncs,"[",Wn,"]")});case"depth.range":return na(function(fn){return fn},function(fn,zn,Wn){return[zn.def("+",Wn,"[0]"),zn=zn.def("+",Wn,"[1]")]});case"blend.func":return na(function(fn){return[st["srcRGB"in fn?fn.srcRGB:fn.src],st["dstRGB"in fn?fn.dstRGB:fn.dst],st["srcAlpha"in fn?fn.srcAlpha:fn.src],st["dstAlpha"in fn?fn.dstAlpha:fn.dst]]},function(fn,zn,Wn){function Sa(ki,ja){return zn.def('"',ki,ja,'" in ',Wn,"?",Wn,".",ki,ja,":",Wn,".",ki)}fn=fn.constants.blendFuncs;var ti=Sa("src","RGB"),yi=Sa("dst","RGB"),xo=(ti=zn.def(fn,"[",ti,"]"),zn.def(fn,"[",Sa("src","Alpha"),"]"));return[ti,yi=zn.def(fn,"[",yi,"]"),xo,fn=zn.def(fn,"[",Sa("dst","Alpha"),"]")]});case"blend.equation":return na(function(fn){return typeof fn=="string"?[Xr[fn],Xr[fn]]:typeof fn=="object"?[Xr[fn.rgb],Xr[fn.alpha]]:void 0},function(fn,zn,Wn){var Sa=fn.constants.blendEquations,ti=zn.def(),yi=zn.def();return(fn=fn.cond("typeof ",Wn,'==="string"')).then(ti,"=",yi,"=",Sa,"[",Wn,"];"),fn.else(ti,"=",Sa,"[",Wn,".rgb];",yi,"=",Sa,"[",Wn,".alpha];"),zn(fn),[ti,yi]});case"blend.color":return na(function(fn){return o(4,function(zn){return+fn[zn]})},function(fn,zn,Wn){return o(4,function(Sa){return zn.def("+",Wn,"[",Sa,"]")})});case"stencil.mask":return na(function(fn){return 0|fn},function(fn,zn,Wn){return zn.def(Wn,"|0")});case"stencil.func":return na(function(fn){return[ot[fn.cmp||"keep"],fn.ref||0,"mask"in fn?fn.mask:-1]},function(fn,zn,Wn){return[fn=zn.def('"cmp" in ',Wn,"?",fn.constants.compareFuncs,"[",Wn,".cmp]",":",7680),zn.def(Wn,".ref|0"),zn=zn.def('"mask" in ',Wn,"?",Wn,".mask|0:-1")]});case"stencil.opFront":case"stencil.opBack":return na(function(fn){return[Pn==="stencil.opBack"?1029:1028,Ce[fn.fail||"keep"],Ce[fn.zfail||"keep"],Ce[fn.zpass||"keep"]]},function(fn,zn,Wn){function Sa(yi){return zn.def('"',yi,'" in ',Wn,"?",ti,"[",Wn,".",yi,"]:",7680)}var ti=fn.constants.stencilOps;return[Pn==="stencil.opBack"?1029:1028,Sa("fail"),Sa("zfail"),Sa("zpass")]});case"polygonOffset.offset":return na(function(fn){return[0|fn.factor,0|fn.units]},function(fn,zn,Wn){return[zn.def(Wn,".factor|0"),zn=zn.def(Wn,".units|0")]});case"cull.face":return na(function(fn){var zn=0;return fn==="front"?zn=1028:fn==="back"&&(zn=1029),zn},function(fn,zn,Wn){return zn.def(Wn,'==="front"?',1028,":",1029)});case"lineWidth":return na(function(fn){return fn},function(fn,zn,Wn){return Wn});case"frontFace":return na(function(fn){return Ue[fn]},function(fn,zn,Wn){return zn.def(Wn+'==="cw"?2304:2305')});case"colorMask":return na(function(fn){return fn.map(function(zn){return!!zn})},function(fn,zn,Wn){return o(4,function(Sa){return"!!"+Wn+"["+Sa+"]"})});case"sample.coverage":return na(function(fn){return["value"in fn?fn.value:1,!!fn.invert]},function(fn,zn,Wn){return[zn.def('"value" in ',Wn,"?+",Wn,".value:1"),zn=zn.def("!!",Wn,".invert")]})}}),gn}(vt),br=wt(vt,0,xr);Mr("viewport"),Mr(Ot("scissor.box"));var Or,sn=0<Object.keys(fr).length;if((Or={framebuffer:Or,draw:Tr,shader:br,state:fr,dirty:sn,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}}).profile=function(qr){var bn,Qn=qr.static;if(qr=qr.dynamic,"profile"in Qn){var Dn=!!Qn.profile;(bn=F(function(Pn,na){return Dn})).enable=Dn}else if("profile"in qr){var gn=qr.profile;bn=H(gn,function(Pn,na){return Pn.invoke(na,gn)})}return bn}(vt),Or.uniforms=function(qr,bn){var Qn=qr.static,Dn=qr.dynamic,gn={};return Object.keys(Qn).forEach(function(Pn){var na,ta=Qn[Pn];if(typeof ta=="number"||typeof ta=="boolean")na=F(function(){return ta});else if(typeof ta=="function"){var fn=ta._reglType;fn==="texture2d"||fn==="textureCube"?na=F(function(zn){return zn.link(ta)}):fn!=="framebuffer"&&fn!=="framebufferCube"||(na=F(function(zn){return zn.link(ta.color[0])}))}else y(ta)&&(na=F(function(zn){return zn.global.def("[",o(ta.length,function(Wn){return ta[Wn]}),"]")}));na.value=ta,gn[Pn]=na}),Object.keys(Dn).forEach(function(Pn){var na=Dn[Pn];gn[Pn]=H(na,function(ta,fn){return ta.invoke(fn,na)})}),gn}(qt),Or.drawVAO=Or.scopeVAO=function(qr,bn){var Qn=qr.static,Dn=qr.dynamic;if("vao"in Qn){var gn=Qn.vao;return gn!==null&&Mt.getVAO(gn)===null&&(gn=Mt.createVAO(gn)),F(function(na){return na.link(Mt.getVAO(gn))})}if("vao"in Dn){var Pn=Dn.vao;return H(Pn,function(na,ta){var fn=na.invoke(ta,Pn);return ta.def(na.shared.vao+".getVAO("+fn+")")})}return null}(vt),!Or.drawVAO&&br.program&&!xr&&Je.angle_instanced_arrays){var Jr=!0;if(vt=br.program.attributes.map(function(qr){return qr=Zt.static[qr],Jr=Jr&&!!qr,qr}),Jr&&0<vt.length){var dn=Mt.getVAO(Mt.createVAO(vt));Or.drawVAO=new B(null,null,null,function(qr,bn){return qr.link(dn)}),Or.useVAO=!0}}return xr?Or.useVAO=!0:Or.attributes=Jt(Zt),Or.context=function(qr){var bn=qr.static,Qn=qr.dynamic,Dn={};return Object.keys(bn).forEach(function(gn){var Pn=bn[gn];Dn[gn]=F(function(na,ta){return typeof Pn=="number"||typeof Pn=="boolean"?""+Pn:na.link(Pn)})}),Object.keys(Qn).forEach(function(gn){var Pn=Qn[gn];Dn[gn]=H(Pn,function(na,ta){return na.invoke(ta,Pn)})}),Dn}(yr),Or}function or(vt,Zt,qt){var yr=vt.shared.context,Dr=vt.scope();Object.keys(qt).forEach(function(Mr){Zt.save(yr,"."+Mr),Dr(yr,".",Mr,"=",qt[Mr].append(vt,Zt),";")}),Zt(Dr)}function zt(vt,Zt,qt,yr){var Dr,Mr=(hr=vt.shared).gl,xr=hr.framebuffer;Br&&(Dr=Zt.def(hr.extensions,".webgl_draw_buffers"));var hr=(Tr=vt.constants).drawBuffer,Tr=Tr.backBuffer;vt=qt?qt.append(vt,Zt):Zt.def(xr,".next"),yr||Zt("if(",vt,"!==",xr,".cur){"),Zt("if(",vt,"){",Mr,".bindFramebuffer(",36160,",",vt,".framebuffer);"),Br&&Zt(Dr,".drawBuffersWEBGL(",hr,"[",vt,".colorAttachments.length]);"),Zt("}else{",Mr,".bindFramebuffer(",36160,",null);"),Br&&Zt(Dr,".drawBuffersWEBGL(",Tr,");"),Zt("}",xr,".cur=",vt,";"),yr||Zt("}")}function Qt(vt,Zt,qt){var yr=vt.shared,Dr=yr.gl,Mr=vt.current,xr=vt.next,hr=yr.current,Tr=yr.next,fr=vt.cond(hr,".dirty");un.forEach(function(br){var Or,sn;if(!((br=Ot(br))in qt.state))if(br in xr){Or=xr[br],sn=Mr[br];var Jr=o(on[br].length,function(dn){return fr.def(Or,"[",dn,"]")});fr(vt.cond(Jr.map(function(dn,qr){return dn+"!=="+sn+"["+qr+"]"}).join("||")).then(Dr,".",yn[br],"(",Jr,");",Jr.map(function(dn,qr){return sn+"["+qr+"]="+dn}).join(";"),";"))}else Or=fr.def(Tr,".",br),Jr=vt.cond(Or,"!==",hr,".",br),fr(Jr),br in Zr?Jr(vt.cond(Or).then(Dr,".enable(",Zr[br],");").else(Dr,".disable(",Zr[br],");"),hr,".",br,"=",Or,";"):Jr(Dr,".",yn[br],"(",Or,");",hr,".",br,"=",Or,";")}),Object.keys(qt.state).length===0&&fr(hr,".dirty=false;"),Zt(fr)}function cr(vt,Zt,qt,yr){var Dr=vt.shared,Mr=vt.current,xr=Dr.current,hr=Dr.gl;D(Object.keys(qt)).forEach(function(Tr){var fr=qt[Tr];if(!yr||yr(fr)){var br=fr.append(vt,Zt);if(Zr[Tr]){var Or=Zr[Tr];N(fr)?Zt(hr,br?".enable(":".disable(",Or,");"):Zt(vt.cond(br).then(hr,".enable(",Or,");").else(hr,".disable(",Or,");")),Zt(xr,".",Tr,"=",br,";")}else if(y(br)){var sn=Mr[Tr];Zt(hr,".",yn[Tr],"(",br,");",br.map(function(Jr,dn){return sn+"["+dn+"]="+Jr}).join(";"),";")}else Zt(hr,".",yn[Tr],"(",br,");",xr,".",Tr,"=",br,";")}})}function Dt(vt,Zt){Nr&&(vt.instancing=Zt.def(vt.shared.extensions,".angle_instanced_arrays"))}function Ut(vt,Zt,qt,yr,Dr){function Mr(){return typeof performance>"u"?"Date.now()":"performance.now()"}function xr(qr){qr(fr=Zt.def(),"=",Mr(),";"),typeof Dr=="string"?qr(sn,".count+=",Dr,";"):qr(sn,".count++;"),It&&(yr?qr(br=Zt.def(),"=",dn,".getNumPendingQueries();"):qr(dn,".beginQuery(",sn,");"))}function hr(qr){qr(sn,".cpuTime+=",Mr(),"-",fr,";"),It&&(yr?qr(dn,".pushScopeStats(",br,",",dn,".getNumPendingQueries(),",sn,");"):qr(dn,".endQuery();"))}function Tr(qr){var bn=Zt.def(Jr,".profile");Zt(Jr,".profile=",qr,";"),Zt.exit(Jr,".profile=",bn,";")}var fr,br,Or=vt.shared,sn=vt.stats,Jr=Or.current,dn=Or.timer;if(qt=qt.profile){if(N(qt))return void(qt.enable?(xr(Zt),hr(Zt.exit),Tr("true")):Tr("false"));Tr(qt=qt.append(vt,Zt))}else qt=Zt.def(Jr,".profile");xr(Or=vt.block()),Zt("if(",qt,"){",Or,"}"),hr(vt=vt.block()),Zt.exit("if(",qt,"){",vt,"}")}function ur(vt,Zt,qt,yr,Dr){function Mr(hr,Tr,fr){function br(){Zt("if(!",dn,".buffer){",sn,".enableVertexAttribArray(",Jr,");}");var Dn,gn=fr.type;Dn=fr.size?Zt.def(fr.size,"||",Tr):Tr,Zt("if(",dn,".type!==",gn,"||",dn,".size!==",Dn,"||",Qn.map(function(Pn){return dn+"."+Pn+"!=="+fr[Pn]}).join("||"),"){",sn,".bindBuffer(",34962,",",qr,".buffer);",sn,".vertexAttribPointer(",[Jr,Dn,gn,fr.normalized,fr.stride,fr.offset],");",dn,".type=",gn,";",dn,".size=",Dn,";",Qn.map(function(Pn){return dn+"."+Pn+"="+fr[Pn]+";"}).join(""),"}"),Nr&&(gn=fr.divisor,Zt("if(",dn,".divisor!==",gn,"){",vt.instancing,".vertexAttribDivisorANGLE(",[Jr,gn],");",dn,".divisor=",gn,";}"))}function Or(){Zt("if(",dn,".buffer){",sn,".disableVertexAttribArray(",Jr,");",dn,".buffer=null;","}if(",We.map(function(Dn,gn){return dn+"."+Dn+"!=="+bn[gn]}).join("||"),"){",sn,".vertexAttrib4f(",Jr,",",bn,");",We.map(function(Dn,gn){return dn+"."+Dn+"="+bn[gn]+";"}).join(""),"}")}var sn=xr.gl,Jr=Zt.def(hr,".location"),dn=Zt.def(xr.attributes,"[",Jr,"]");hr=fr.state;var qr=fr.buffer,bn=[fr.x,fr.y,fr.z,fr.w],Qn=["buffer","normalized","offset","stride"];hr===1?br():hr===2?Or():(Zt("if(",hr,"===",1,"){"),br(),Zt("}else{"),Or(),Zt("}"))}var xr=vt.shared;yr.forEach(function(hr){var Tr,fr=hr.name,br=qt.attributes[fr];if(br){if(!Dr(br))return;Tr=br.append(vt,Zt)}else{if(!Dr(Ye))return;var Or=vt.scopeAttrib(fr);Tr={},Object.keys(new nn).forEach(function(sn){Tr[sn]=Zt.def(Or,".",sn)})}Mr(vt.link(hr),function(sn){switch(sn){case 35664:case 35667:case 35671:return 2;case 35665:case 35668:case 35672:return 3;case 35666:case 35669:case 35673:return 4;default:return 1}}(hr.info.type),Tr)})}function Sr(vt,Zt,qt,yr,Dr){for(var Mr,xr=vt.shared,hr=xr.gl,Tr=0;Tr<yr.length;++Tr){var fr,br=(Jr=yr[Tr]).name,Or=Jr.info.type,sn=qt.uniforms[br],Jr=vt.link(Jr)+".location";if(sn){if(!Dr(sn))continue;if(N(sn)){if(br=sn.value,Or===35678||Or===35680)Zt(hr,".uniform1i(",Jr,",",(Or=vt.link(br._texture||br.color[0]._texture))+".bind());"),Zt.exit(Or,".unbind();");else if(Or===35674||Or===35675||Or===35676)sn=2,Or===35675?sn=3:Or===35676&&(sn=4),Zt(hr,".uniformMatrix",sn,"fv(",Jr,",false,",br=vt.global.def("new Float32Array(["+Array.prototype.slice.call(br)+"])"),");");else{switch(Or){case 5126:Mr="1f";break;case 35664:Mr="2f";break;case 35665:Mr="3f";break;case 35666:Mr="4f";break;case 35670:case 5124:Mr="1i";break;case 35671:case 35667:Mr="2i";break;case 35672:case 35668:Mr="3i";break;case 35673:Mr="4i";break;case 35669:Mr="4i"}Zt(hr,".uniform",Mr,"(",Jr,",",y(br)?Array.prototype.slice.call(br):br,");")}continue}fr=sn.append(vt,Zt)}else{if(!Dr(Ye))continue;fr=Zt.def(xr.uniforms,"[",Ee.id(br),"]")}switch(Or===35678?Zt("if(",fr,"&&",fr,'._reglType==="framebuffer"){',fr,"=",fr,".color[0];","}"):Or===35680&&Zt("if(",fr,"&&",fr,'._reglType==="framebufferCube"){',fr,"=",fr,".color[0];","}"),br=1,Or){case 35678:case 35680:Or=Zt.def(fr,"._texture"),Zt(hr,".uniform1i(",Jr,",",Or,".bind());"),Zt.exit(Or,".unbind();");continue;case 5124:case 35670:Mr="1i";break;case 35667:case 35671:Mr="2i",br=2;break;case 35668:case 35672:Mr="3i",br=3;break;case 35669:case 35673:Mr="4i",br=4;break;case 5126:Mr="1f";break;case 35664:Mr="2f",br=2;break;case 35665:Mr="3f",br=3;break;case 35666:Mr="4f",br=4;break;case 35674:Mr="Matrix2fv";break;case 35675:Mr="Matrix3fv";break;case 35676:Mr="Matrix4fv"}if(Zt(hr,".uniform",Mr,"(",Jr,","),Mr.charAt(0)==="M"){Jr=Math.pow(Or-35674+2,2);var dn=vt.global.def("new Float32Array(",Jr,")");Zt("false,(Array.isArray(",fr,")||",fr," instanceof Float32Array)?",fr,":(",o(Jr,function(qr){return dn+"["+qr+"]="+fr+"["+qr+"]"}),",",dn,")")}else Zt(1<br?o(br,function(qr){return fr+"["+qr+"]"}):fr);Zt(");")}}function Lr(vt,Zt,qt,yr){function Dr(gn){var Pn=sn[gn];return Pn?Pn.contextDep&&yr.contextDynamic||Pn.propDep?Pn.append(vt,qt):Pn.append(vt,Zt):Zt.def(Or,".",gn)}function Mr(){function gn(){qt(Tr,".drawElementsInstancedANGLE(",[dn,bn,Qn,qr+"<<(("+Qn+"-5121)>>1)",hr],");")}function Pn(){qt(Tr,".drawArraysInstancedANGLE(",[dn,qr,bn,hr],");")}Jr?Dn?gn():(qt("if(",Jr,"){"),gn(),qt("}else{"),Pn(),qt("}")):Pn()}function xr(){function gn(){qt(br+".drawElements("+[dn,bn,Qn,qr+"<<(("+Qn+"-5121)>>1)"]+");")}function Pn(){qt(br+".drawArrays("+[dn,qr,bn]+");")}Jr?Dn?gn():(qt("if(",Jr,"){"),gn(),qt("}else{"),Pn(),qt("}")):Pn()}var hr,Tr,fr=vt.shared,br=fr.gl,Or=fr.draw,sn=yr.draw,Jr=function(){var gn=sn.elements,Pn=Zt;return gn?((gn.contextDep&&yr.contextDynamic||gn.propDep)&&(Pn=qt),gn=gn.append(vt,Pn)):gn=Pn.def(Or,".","elements"),gn&&Pn("if("+gn+")"+br+".bindBuffer(34963,"+gn+".buffer.buffer);"),gn}(),dn=Dr("primitive"),qr=Dr("offset"),bn=function(){var gn=sn.count,Pn=Zt;return gn?((gn.contextDep&&yr.contextDynamic||gn.propDep)&&(Pn=qt),gn=gn.append(vt,Pn)):gn=Pn.def(Or,".","count"),gn}();if(typeof bn=="number"){if(bn===0)return}else qt("if(",bn,"){"),qt.exit("}");Nr&&(hr=Dr("instances"),Tr=vt.instancing);var Qn=Jr+".type",Dn=sn.elements&&N(sn.elements);Nr&&(typeof hr!="number"||0<=hr)?typeof hr=="string"?(qt("if(",hr,">0){"),Mr(),qt("}else if(",hr,"<0){"),xr(),qt("}")):Mr():xr()}function Hr(vt,Zt,qt,yr,Dr){return Dr=(Zt=Ne()).proc("body",Dr),Nr&&(Zt.instancing=Dr.def(Zt.shared.extensions,".angle_instanced_arrays")),vt(Zt,Dr,qt,yr),Zt.compile().body}function Kr(vt,Zt,qt,yr){Dt(vt,Zt),qt.useVAO?qt.drawVAO?Zt(vt.shared.vao,".setVAO(",qt.drawVAO.append(vt,Zt),");"):Zt(vt.shared.vao,".setVAO(",vt.shared.vao,".targetVAO);"):(Zt(vt.shared.vao,".setVAO(null);"),ur(vt,Zt,qt,yr.attributes,function(){return!0})),Sr(vt,Zt,qt,yr.uniforms,function(){return!0}),Lr(vt,Zt,Zt,qt)}function Ir(vt,Zt,qt,yr){function Dr(){return!0}vt.batchId="a1",Dt(vt,Zt),ur(vt,Zt,qt,yr.attributes,Dr),Sr(vt,Zt,qt,yr.uniforms,Dr),Lr(vt,Zt,Zt,qt)}function kr(vt,Zt,qt,yr){function Dr(Or){return Or.contextDep&&xr||Or.propDep}function Mr(Or){return!Dr(Or)}Dt(vt,Zt);var xr=qt.contextDep,hr=Zt.def(),Tr=Zt.def();vt.shared.props=Tr,vt.batchId=hr;var fr=vt.scope(),br=vt.scope();Zt(fr.entry,"for(",hr,"=0;",hr,"<","a1",";++",hr,"){",Tr,"=","a0","[",hr,"];",br,"}",fr.exit),qt.needsContext&&or(vt,br,qt.context),qt.needsFramebuffer&&zt(vt,br,qt.framebuffer),cr(vt,br,qt.state,Dr),qt.profile&&Dr(qt.profile)&&Ut(vt,br,qt,!1,!0),yr?(qt.useVAO?qt.drawVAO?Dr(qt.drawVAO)?br(vt.shared.vao,".setVAO(",qt.drawVAO.append(vt,br),");"):fr(vt.shared.vao,".setVAO(",qt.drawVAO.append(vt,fr),");"):fr(vt.shared.vao,".setVAO(",vt.shared.vao,".targetVAO);"):(fr(vt.shared.vao,".setVAO(null);"),ur(vt,fr,qt,yr.attributes,Mr),ur(vt,br,qt,yr.attributes,Dr)),Sr(vt,fr,qt,yr.uniforms,Mr),Sr(vt,br,qt,yr.uniforms,Dr),Lr(vt,fr,br,qt)):(Zt=vt.global.def("{}"),yr=qt.shader.progVar.append(vt,br),Tr=br.def(yr,".id"),fr=br.def(Zt,"[",Tr,"]"),br(vt.shared.gl,".useProgram(",yr,".program);","if(!",fr,"){",fr,"=",Zt,"[",Tr,"]=",vt.link(function(Or){return Hr(Ir,vt,qt,Or,2)}),"(",yr,");}",fr,".call(this,a0[",hr,"],",hr,");"))}function rn(vt,Zt){function qt(xr){var hr=Zt.shader[xr];hr&&yr.set(Dr.shader,"."+xr,hr.append(vt,yr))}var yr=vt.proc("scope",3);vt.batchId="a2";var Dr=vt.shared,Mr=Dr.current;or(vt,yr,Zt.context),Zt.framebuffer&&Zt.framebuffer.append(vt,yr),D(Object.keys(Zt.state)).forEach(function(xr){var hr=Zt.state[xr].append(vt,yr);y(hr)?hr.forEach(function(Tr,fr){yr.set(vt.next[xr],"["+fr+"]",Tr)}):yr.set(Dr.next,"."+xr,hr)}),Ut(vt,yr,Zt,!0,!0),["elements","offset","count","instances","primitive"].forEach(function(xr){var hr=Zt.draw[xr];hr&&yr.set(Dr.draw,"."+xr,""+hr.append(vt,yr))}),Object.keys(Zt.uniforms).forEach(function(xr){yr.set(Dr.uniforms,"["+Ee.id(xr)+"]",Zt.uniforms[xr].append(vt,yr))}),Object.keys(Zt.attributes).forEach(function(xr){var hr=Zt.attributes[xr].append(vt,yr),Tr=vt.scopeAttrib(xr);Object.keys(new nn).forEach(function(fr){yr.set(Tr,"."+fr,hr[fr])})}),Zt.scopeVAO&&yr.set(Dr.vao,".targetVAO",Zt.scopeVAO.append(vt,yr)),qt("vert"),qt("frag"),0<Object.keys(Zt.state).length&&(yr(Mr,".dirty=true;"),yr.exit(Mr,".dirty=true;")),yr("a1(",vt.shared.context,",a0,",vt.batchId,");")}function Qr(vt,Zt,qt){var yr=Zt.static[qt];if(yr&&function(br){if(typeof br=="object"&&!y(br)){for(var Or=Object.keys(br),sn=0;sn<Or.length;++sn)if($.isDynamic(br[Or[sn]]))return!0;return!1}}(yr)){var Dr=vt.global,Mr=Object.keys(yr),xr=!1,hr=!1,Tr=!1,fr=vt.global.def("{}");Mr.forEach(function(br){var Or=yr[br];if($.isDynamic(Or))typeof Or=="function"&&(Or=yr[br]=$.unbox(Or)),br=H(Or,null),xr=xr||br.thisDep,Tr=Tr||br.propDep,hr=hr||br.contextDep;else{switch(Dr(fr,".",br,"="),typeof Or){case"number":Dr(Or);break;case"string":Dr('"',Or,'"');break;case"object":Array.isArray(Or)&&Dr("[",Or.join(),"]");break;default:Dr(vt.link(Or))}Dr(";")}}),Zt.dynamic[qt]=new $.DynamicVariable(4,{thisDep:xr,contextDep:hr,propDep:Tr,ref:fr,append:function(br,Or){Mr.forEach(function(sn){var Jr=yr[sn];$.isDynamic(Jr)&&(Jr=br.invoke(Or,Jr),Or(fr,".",sn,"=",Jr,";"))})}}),delete Zt.static[qt]}}var nn=Mt.Record,Xr={add:32774,subtract:32778,"reverse subtract":32779};Je.ext_blend_minmax&&(Xr.min=32775,Xr.max=32776);var Nr=Je.angle_instanced_arrays,Br=Je.webgl_draw_buffers,on={dirty:!0,profile:Nt.profile},cn={},un=[],Zr={},yn={};Yt("dither",3024),Yt("blend.enable",3042),Pt("blend.color","blendColor",[0,0,0,0]),Pt("blend.equation","blendEquationSeparate",[32774,32774]),Pt("blend.func","blendFuncSeparate",[1,0,1,0]),Yt("depth.enable",2929,!0),Pt("depth.func","depthFunc",513),Pt("depth.range","depthRange",[0,1]),Pt("depth.mask","depthMask",!0),Pt("colorMask","colorMask",[!0,!0,!0,!0]),Yt("cull.enable",2884),Pt("cull.face","cullFace",1029),Pt("frontFace","frontFace",2305),Pt("lineWidth","lineWidth",1),Yt("polygonOffset.enable",32823),Pt("polygonOffset.offset","polygonOffset",[0,0]),Yt("sample.alpha",32926),Yt("sample.enable",32928),Pt("sample.coverage","sampleCoverage",[1,!1]),Yt("stencil.enable",2960),Pt("stencil.mask","stencilMask",-1),Pt("stencil.func","stencilFunc",[519,0,-1]),Pt("stencil.opFront","stencilOpSeparate",[1028,7680,7680,7680]),Pt("stencil.opBack","stencilOpSeparate",[1029,7680,7680,7680]),Yt("scissor.enable",3089),Pt("scissor.box","scissor",[0,0,xe.drawingBufferWidth,xe.drawingBufferHeight]),Pt("viewport","viewport",[0,0,xe.drawingBufferWidth,xe.drawingBufferHeight]);var In={gl:xe,context:At,strings:Ee,next:cn,current:on,draw:xt,elements:ct,buffer:ht,shader:_t,attributes:Mt.state,vao:Mt,uniforms:Et,framebuffer:bt,extensions:Je,timer:It,isBufferArgs:J},Un={primTypes:ve,compareFuncs:ot,blendFuncs:st,blendEquations:Xr,stencilOps:Ce,glTypes:we,orientationType:Ue};Br&&(Un.backBuffer=[1029],Un.drawBuffer=o(it.maxDrawbuffers,function(vt){return vt===0?[0]:o(vt,function(Zt){return 36064+Zt})}));var Kn=0;return{next:cn,current:on,procs:function(){var vt=Ne(),Zt=vt.proc("poll"),qt=vt.proc("refresh"),yr=vt.block();Zt(yr),qt(yr);var Dr,Mr=vt.shared,xr=Mr.gl,hr=Mr.next,Tr=Mr.current;yr(Tr,".dirty=false;"),zt(vt,Zt),zt(vt,qt,null,!0),Nr&&(Dr=vt.link(Nr)),Je.oes_vertex_array_object&&qt(vt.link(Je.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var fr=0;fr<it.maxAttributes;++fr){var br=qt.def(Mr.attributes,"[",fr,"]"),Or=vt.cond(br,".buffer");Or.then(xr,".enableVertexAttribArray(",fr,");",xr,".bindBuffer(",34962,",",br,".buffer.buffer);",xr,".vertexAttribPointer(",fr,",",br,".size,",br,".type,",br,".normalized,",br,".stride,",br,".offset);").else(xr,".disableVertexAttribArray(",fr,");",xr,".vertexAttrib4f(",fr,",",br,".x,",br,".y,",br,".z,",br,".w);",br,".buffer=null;"),qt(Or),Nr&&qt(Dr,".vertexAttribDivisorANGLE(",fr,",",br,".divisor);")}return qt(vt.shared.vao,".currentVAO=null;",vt.shared.vao,".setVAO(",vt.shared.vao,".targetVAO);"),Object.keys(Zr).forEach(function(sn){var Jr=Zr[sn],dn=yr.def(hr,".",sn),qr=vt.block();qr("if(",dn,"){",xr,".enable(",Jr,")}else{",xr,".disable(",Jr,")}",Tr,".",sn,"=",dn,";"),qt(qr),Zt("if(",dn,"!==",Tr,".",sn,"){",qr,"}")}),Object.keys(yn).forEach(function(sn){var Jr,dn,qr=yn[sn],bn=on[sn],Qn=vt.block();Qn(xr,".",qr,"("),y(bn)?(qr=bn.length,Jr=vt.global.def(hr,".",sn),dn=vt.global.def(Tr,".",sn),Qn(o(qr,function(Dn){return Jr+"["+Dn+"]"}),");",o(qr,function(Dn){return dn+"["+Dn+"]="+Jr+"["+Dn+"];"}).join("")),Zt("if(",o(qr,function(Dn){return Jr+"["+Dn+"]!=="+dn+"["+Dn+"]"}).join("||"),"){",Qn,"}")):(Jr=yr.def(hr,".",sn),dn=yr.def(Tr,".",sn),Qn(Jr,");",Tr,".",sn,"=",Jr,";"),Zt("if(",Jr,"!==",dn,"){",Qn,"}")),qt(Qn)}),vt.compile()}(),compile:function(vt,Zt,qt,yr,Dr){var Mr=Ne();return Mr.stats=Mr.link(Dr),Object.keys(Zt.static).forEach(function(xr){Qr(Mr,Zt,xr)}),Ge.forEach(function(xr){Qr(Mr,vt,xr)}),qt=er(vt,Zt,qt,yr),function(xr,hr){var Tr=xr.proc("draw",1);Dt(xr,Tr),or(xr,Tr,hr.context),zt(xr,Tr,hr.framebuffer),Qt(xr,Tr,hr),cr(xr,Tr,hr.state),Ut(xr,Tr,hr,!1,!0);var fr=hr.shader.progVar.append(xr,Tr);if(Tr(xr.shared.gl,".useProgram(",fr,".program);"),hr.shader.program)Kr(xr,Tr,hr,hr.shader.program);else{Tr(xr.shared.vao,".setVAO(null);");var br=xr.global.def("{}"),Or=Tr.def(fr,".id"),sn=Tr.def(br,"[",Or,"]");Tr(xr.cond(sn).then(sn,".call(this,a0);").else(sn,"=",br,"[",Or,"]=",xr.link(function(Jr){return Hr(Kr,xr,hr,Jr,1)}),"(",fr,");",sn,".call(this,a0);"))}0<Object.keys(hr.state).length&&Tr(xr.shared.current,".dirty=true;")}(Mr,qt),rn(Mr,qt),function(xr,hr){function Tr(qr){return qr.contextDep&&br||qr.propDep}var fr=xr.proc("batch",2);xr.batchId="0",Dt(xr,fr);var br=!1,Or=!0;Object.keys(hr.context).forEach(function(qr){br=br||hr.context[qr].propDep}),br||(or(xr,fr,hr.context),Or=!1);var sn=!1;if((Jr=hr.framebuffer)?(Jr.propDep?br=sn=!0:Jr.contextDep&&br&&(sn=!0),sn||zt(xr,fr,Jr)):zt(xr,fr,null),hr.state.viewport&&hr.state.viewport.propDep&&(br=!0),Qt(xr,fr,hr),cr(xr,fr,hr.state,function(qr){return!Tr(qr)}),hr.profile&&Tr(hr.profile)||Ut(xr,fr,hr,!1,"a1"),hr.contextDep=br,hr.needsContext=Or,hr.needsFramebuffer=sn,(Or=hr.shader.progVar).contextDep&&br||Or.propDep)kr(xr,fr,hr,null);else if(Or=Or.append(xr,fr),fr(xr.shared.gl,".useProgram(",Or,".program);"),hr.shader.program)kr(xr,fr,hr,hr.shader.program);else{fr(xr.shared.vao,".setVAO(null);");var Jr=xr.global.def("{}"),dn=(sn=fr.def(Or,".id"),fr.def(Jr,"[",sn,"]"));fr(xr.cond(dn).then(dn,".call(this,a0,a1);").else(dn,"=",Jr,"[",sn,"]=",xr.link(function(qr){return Hr(kr,xr,hr,qr,2)}),"(",Or,");",dn,".call(this,a0,a1);"))}0<Object.keys(hr.state).length&&fr(xr.shared.current,".dirty=true;")}(Mr,qt),Mr.compile()}}}function G(xe,Ee){for(var Je=0;Je<xe.length;++Je)if(xe[Je]===Ee)return Je;return-1}var W=function(xe,Ee){for(var Je=Object.keys(Ee),it=0;it<Je.length;++it)xe[Je[it]]=Ee[Je[it]];return xe},Q=0,$={DynamicVariable:t,define:function(xe,Ee){return new t(xe,h(Ee+""))},isDynamic:function(xe){return typeof xe=="function"&&!xe._reglType||xe instanceof t},unbox:function(xe,Ee){return typeof xe=="function"?new t(0,xe):xe},accessor:h},ee={next:typeof requestAnimationFrame=="function"?function(xe){return requestAnimationFrame(xe)}:function(xe){return setTimeout(xe,16)},cancel:typeof cancelAnimationFrame=="function"?function(xe){return cancelAnimationFrame(xe)}:clearTimeout},ie=typeof performance<"u"&&performance.now?function(){return performance.now()}:function(){return+new Date},ae=i();ae.zero=i();var oe=function(xe,Ee){var Je=1;Ee.ext_texture_filter_anisotropic&&(Je=xe.getParameter(34047));var it=1,ht=1;Ee.webgl_draw_buffers&&(it=xe.getParameter(34852),ht=xe.getParameter(36063));var ct=!!Ee.oes_texture_float;if(ct){ct=xe.createTexture(),xe.bindTexture(3553,ct),xe.texImage2D(3553,0,6408,1,1,0,6408,5126,null);var mt=xe.createFramebuffer();if(xe.bindFramebuffer(36160,mt),xe.framebufferTexture2D(36160,36064,3553,ct,0),xe.bindTexture(3553,null),xe.checkFramebufferStatus(36160)!==36053)ct=!1;else{xe.viewport(0,0,1,1),xe.clearColor(1,0,0,1),xe.clear(16384);var bt=ae.allocType(5126,4);xe.readPixels(0,0,1,1,6408,5126,bt),xe.getError()?ct=!1:(xe.deleteFramebuffer(mt),xe.deleteTexture(ct),ct=bt[0]===1),ae.freeType(bt)}}return bt=!0,typeof navigator<"u"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent))||(bt=xe.createTexture(),mt=ae.allocType(5121,36),xe.activeTexture(33984),xe.bindTexture(34067,bt),xe.texImage2D(34069,0,6408,3,3,0,6408,5121,mt),ae.freeType(mt),xe.bindTexture(34067,null),xe.deleteTexture(bt),bt=!xe.getError()),{colorBits:[xe.getParameter(3410),xe.getParameter(3411),xe.getParameter(3412),xe.getParameter(3413)],depthBits:xe.getParameter(3414),stencilBits:xe.getParameter(3415),subpixelBits:xe.getParameter(3408),extensions:Object.keys(Ee).filter(function(Et){return!!Ee[Et]}),maxAnisotropic:Je,maxDrawbuffers:it,maxColorAttachments:ht,pointSizeDims:xe.getParameter(33901),lineWidthDims:xe.getParameter(33902),maxViewportDims:xe.getParameter(3386),maxCombinedTextureUnits:xe.getParameter(35661),maxCubeMapSize:xe.getParameter(34076),maxRenderbufferSize:xe.getParameter(34024),maxTextureUnits:xe.getParameter(34930),maxTextureSize:xe.getParameter(3379),maxAttributes:xe.getParameter(34921),maxVertexUniforms:xe.getParameter(36347),maxVertexTextureUnits:xe.getParameter(35660),maxVaryingVectors:xe.getParameter(36348),maxFragmentUniforms:xe.getParameter(36349),glsl:xe.getParameter(35724),renderer:xe.getParameter(7937),vendor:xe.getParameter(7936),version:xe.getParameter(7938),readFloat:ct,npotTextureCube:bt}},de=function(xe){return xe instanceof Uint8Array||xe instanceof Uint16Array||xe instanceof Uint32Array||xe instanceof Int8Array||xe instanceof Int16Array||xe instanceof Int32Array||xe instanceof Float32Array||xe instanceof Float64Array||xe instanceof Uint8ClampedArray},le=function(xe){return Object.keys(xe).map(function(Ee){return xe[Ee]})},fe={shape:function(xe){for(var Ee=[];xe.length;xe=xe[0])Ee.push(xe.length);return Ee},flatten:function(xe,Ee,Je,it){var ht=1;if(Ee.length)for(var ct=0;ct<Ee.length;++ct)ht*=Ee[ct];else ht=0;switch(Je=it||ae.allocType(Je,ht),Ee.length){case 0:break;case 1:for(it=Ee[0],Ee=0;Ee<it;++Ee)Je[Ee]=xe[Ee];break;case 2:for(it=Ee[0],Ee=Ee[1],ct=ht=0;ct<it;++ct)for(var mt=xe[ct],bt=0;bt<Ee;++bt)Je[ht++]=mt[bt];break;case 3:s(xe,Ee[0],Ee[1],Ee[2],Je,0);break;default:(function Et(Mt,_t,xt,At,It){for(var Nt=1,Ot=xt+1;Ot<_t.length;++Ot)Nt*=_t[Ot];var Yt=_t[xt];if(_t.length-xt==4){var Pt=_t[xt+1],Ne=_t[xt+2];for(_t=_t[xt+3],Ot=0;Ot<Yt;++Ot)s(Mt[Ot],Pt,Ne,_t,At,It),It+=Nt}else for(Ot=0;Ot<Yt;++Ot)Et(Mt[Ot],_t,xt+1,At,It),It+=Nt})(xe,Ee,0,Je,0)}return Je}},ue={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},we={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,float:5126,float32:5126},Ae={dynamic:35048,stream:35040,static:35044},Se=fe.flatten,ke=fe.shape,Me=[];Me[5120]=1,Me[5122]=2,Me[5124]=4,Me[5121]=1,Me[5123]=2,Me[5125]=4,Me[5126]=4;var ve={points:0,point:0,lines:1,line:1,triangles:4,triangle:4,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},ge=new Float32Array(1),De=new Uint32Array(ge.buffer),_e=[9984,9986,9985,9987],Pe=[0,6409,6410,6407,6408],Fe={};Fe[6409]=Fe[6406]=Fe[6402]=1,Fe[34041]=Fe[6410]=2,Fe[6407]=Fe[35904]=3,Fe[6408]=Fe[35906]=4;var ze=v("HTMLCanvasElement"),He=v("OffscreenCanvas"),et=v("CanvasRenderingContext2D"),Re=v("ImageBitmap"),Ze=v("HTMLImageElement"),Ke=v("HTMLVideoElement"),$e=Object.keys(ue).concat([ze,He,et,Re,Ze,Ke]),rt=[];rt[5121]=1,rt[5126]=4,rt[36193]=2,rt[5123]=2,rt[5125]=4;var at=[];at[32854]=2,at[32855]=2,at[36194]=2,at[34041]=4,at[33776]=.5,at[33777]=.5,at[33778]=1,at[33779]=1,at[35986]=.5,at[35987]=1,at[34798]=1,at[35840]=.5,at[35841]=.25,at[35842]=.5,at[35843]=.25,at[36196]=.5;var lt=[];lt[32854]=2,lt[32855]=2,lt[36194]=2,lt[33189]=2,lt[36168]=1,lt[34041]=4,lt[35907]=4,lt[34836]=16,lt[34842]=8,lt[34843]=6;var gt=function(xe,Ee,Je,it,ht){function ct(xt){this.id=Mt++,this.refCount=1,this.renderbuffer=xt,this.format=32854,this.height=this.width=0,ht.profile&&(this.stats={size:0})}function mt(xt){var At=xt.renderbuffer;xe.bindRenderbuffer(36161,null),xe.deleteRenderbuffer(At),xt.renderbuffer=null,xt.refCount=0,delete _t[xt.id],it.renderbufferCount--}var bt={rgba4:32854,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};Ee.ext_srgb&&(bt.srgba=35907),Ee.ext_color_buffer_half_float&&(bt.rgba16f=34842,bt.rgb16f=34843),Ee.webgl_color_buffer_float&&(bt.rgba32f=34836);var Et=[];Object.keys(bt).forEach(function(xt){Et[bt[xt]]=xt});var Mt=0,_t={};return ct.prototype.decRef=function(){0>=--this.refCount&&mt(this)},ht.profile&&(it.getTotalRenderbufferSize=function(){var xt=0;return Object.keys(_t).forEach(function(At){xt+=_t[At].stats.size}),xt}),{create:function(xt,At){function It(Ot,Yt){var Pt=0,Ne=0,ut=32854;if(typeof Ot=="object"&&Ot?("shape"in Ot?(Pt=0|(Ne=Ot.shape)[0],Ne=0|Ne[1]):("radius"in Ot&&(Pt=Ne=0|Ot.radius),"width"in Ot&&(Pt=0|Ot.width),"height"in Ot&&(Ne=0|Ot.height)),"format"in Ot&&(ut=bt[Ot.format])):typeof Ot=="number"?(Pt=0|Ot,Ne=typeof Yt=="number"?0|Yt:Pt):Ot||(Pt=Ne=1),Pt!==Nt.width||Ne!==Nt.height||ut!==Nt.format)return It.width=Nt.width=Pt,It.height=Nt.height=Ne,Nt.format=ut,xe.bindRenderbuffer(36161,Nt.renderbuffer),xe.renderbufferStorage(36161,ut,Pt,Ne),ht.profile&&(Nt.stats.size=lt[Nt.format]*Nt.width*Nt.height),It.format=Et[Nt.format],It}var Nt=new ct(xe.createRenderbuffer());return _t[Nt.id]=Nt,it.renderbufferCount++,It(xt,At),It.resize=function(Ot,Yt){var Pt=0|Ot,Ne=0|Yt||Pt;return Pt===Nt.width&&Ne===Nt.height||(It.width=Nt.width=Pt,It.height=Nt.height=Ne,xe.bindRenderbuffer(36161,Nt.renderbuffer),xe.renderbufferStorage(36161,Nt.format,Pt,Ne),ht.profile&&(Nt.stats.size=lt[Nt.format]*Nt.width*Nt.height)),It},It._reglType="renderbuffer",It._renderbuffer=Nt,ht.profile&&(It.stats=Nt.stats),It.destroy=function(){Nt.decRef()},It},clear:function(){le(_t).forEach(mt)},restore:function(){le(_t).forEach(function(xt){xt.renderbuffer=xe.createRenderbuffer(),xe.bindRenderbuffer(36161,xt.renderbuffer),xe.renderbufferStorage(36161,xt.format,xt.width,xt.height)}),xe.bindRenderbuffer(36161,null)}}},Ie=[];Ie[6408]=4,Ie[6407]=3;var be=[];be[5121]=1,be[5126]=4,be[36193]=2;var We=["x","y","z","w"],Ge="blend.func blend.equation stencil.func stencil.opFront stencil.opBack sample.coverage viewport scissor.box polygonOffset.offset".split(" "),st={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},ot={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},Ce={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},Ue={cw:2304,ccw:2305},Ye=new B(!1,!1,!1,function(){});return function(xe){function Ee(){if(Ir.length===0)ut&&ut.update(),nn=null;else{nn=ee.next(Ee),_t();for(var Nr=Ir.length-1;0<=Nr;--Nr){var Br=Ir[Nr];Br&&Br(er,null,0)}It.flush(),ut&&ut.update()}}function Je(){!nn&&0<Ir.length&&(nn=ee.next(Ee))}function it(){nn&&(ee.cancel(Ee),nn=null)}function ht(Nr){Nr.preventDefault(),it(),kr.forEach(function(Br){Br()})}function ct(Nr){It.getError(),Ot.restore(),Dt.restore(),zt.restore(),Ut.restore(),ur.restore(),Sr.restore(),Qt.restore(),ut&&ut.restore(),Lr.procs.refresh(),Je(),rn.forEach(function(Br){Br()})}function mt(Nr){function Br(vt){var Zt={},qt={};return Object.keys(vt).forEach(function(yr){var Dr=vt[yr];$.isDynamic(Dr)?qt[yr]=$.unbox(Dr,yr):Zt[yr]=Dr}),{dynamic:qt,static:Zt}}var on=Br(Nr.context||{}),cn=Br(Nr.uniforms||{}),un=Br(Nr.attributes||{}),Zr=Br(function(vt){function Zt(yr){if(yr in qt){var Dr=qt[yr];delete qt[yr],Object.keys(Dr).forEach(function(Mr){qt[yr+"."+Mr]=Dr[Mr]})}}var qt=W({},vt);return delete qt.uniforms,delete qt.attributes,delete qt.context,delete qt.vao,"stencil"in qt&&qt.stencil.op&&(qt.stencil.opBack=qt.stencil.opFront=qt.stencil.op,delete qt.stencil.op),Zt("blend"),Zt("depth"),Zt("cull"),Zt("stencil"),Zt("polygonOffset"),Zt("scissor"),Zt("sample"),"vao"in vt&&(qt.vao=vt.vao),qt}(Nr));Nr={gpuTime:0,cpuTime:0,count:0};var yn=(on=Lr.compile(Zr,un,cn,on,Nr)).draw,In=on.batch,Un=on.scope,Kn=[];return W(function(vt,Zt){var qt;if(typeof vt=="function")return Un.call(this,null,vt,0);if(typeof Zt=="function")if(typeof vt=="number")for(qt=0;qt<vt;++qt)Un.call(this,null,Zt,qt);else{if(!Array.isArray(vt))return Un.call(this,vt,Zt,0);for(qt=0;qt<vt.length;++qt)Un.call(this,vt[qt],Zt,qt)}else if(typeof vt=="number"){if(0<vt)return In.call(this,function(yr){for(;Kn.length<yr;)Kn.push(null);return Kn}(0|vt),0|vt)}else{if(!Array.isArray(vt))return yn.call(this,vt);if(vt.length)return In.call(this,vt,vt.length)}},{stats:Nr})}function bt(Nr,Br){var on=0;Lr.procs.poll();var cn=Br.color;cn&&(It.clearColor(+cn[0]||0,+cn[1]||0,+cn[2]||0,+cn[3]||0),on|=16384),"depth"in Br&&(It.clearDepth(+Br.depth),on|=256),"stencil"in Br&&(It.clearStencil(0|Br.stencil),on|=1024),It.clear(on)}function Et(Nr){return Ir.push(Nr),Je(),{cancel:function(){var Br=G(Ir,Nr);Ir[Br]=function on(){var cn=G(Ir,on);Ir[cn]=Ir[Ir.length-1],--Ir.length,0>=Ir.length&&it()}}}}function Mt(){var Nr=Hr.viewport,Br=Hr.scissor_box;Nr[0]=Nr[1]=Br[0]=Br[1]=0,er.viewportWidth=er.framebufferWidth=er.drawingBufferWidth=Nr[2]=Br[2]=It.drawingBufferWidth,er.viewportHeight=er.framebufferHeight=er.drawingBufferHeight=Nr[3]=Br[3]=It.drawingBufferHeight}function _t(){er.tick+=1,er.time=At(),Mt(),Lr.procs.poll()}function xt(){Mt(),Lr.procs.refresh(),ut&&ut.update()}function At(){return(ie()-wt)/1e3}if(!(xe=e(xe)))return null;var It=xe.gl,Nt=It.getContextAttributes();It.isContextLost();var Ot=function(Nr,Br){function on(yn){var In;yn=yn.toLowerCase();try{In=cn[yn]=Nr.getExtension(yn)}catch{}return!!In}for(var cn={},un=0;un<Br.extensions.length;++un){var Zr=Br.extensions[un];if(!on(Zr))return Br.onDestroy(),Br.onDone('"'+Zr+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return Br.optionalExtensions.forEach(on),{extensions:cn,restore:function(){Object.keys(cn).forEach(function(yn){if(cn[yn]&&!on(yn))throw Error("(regl): error restoring extension "+yn)})}}}(It,xe);if(!Ot)return null;var Yt=function(){var Nr={"":0},Br=[""];return{id:function(on){var cn=Nr[on];return cn||(cn=Nr[on]=Br.length,Br.push(on),cn)},str:function(on){return Br[on]}}}(),Pt={vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0},Ne=Ot.extensions,ut=function(Nr,Br){function on(){this.endQueryIndex=this.startQueryIndex=-1,this.sum=0,this.stats=null}function cn(vt,Zt,qt){var yr=yn.pop()||new on;yr.startQueryIndex=vt,yr.endQueryIndex=Zt,yr.sum=0,yr.stats=qt,In.push(yr)}if(!Br.ext_disjoint_timer_query)return null;var un=[],Zr=[],yn=[],In=[],Un=[],Kn=[];return{beginQuery:function(vt){var Zt=un.pop()||Br.ext_disjoint_timer_query.createQueryEXT();Br.ext_disjoint_timer_query.beginQueryEXT(35007,Zt),Zr.push(Zt),cn(Zr.length-1,Zr.length,vt)},endQuery:function(){Br.ext_disjoint_timer_query.endQueryEXT(35007)},pushScopeStats:cn,update:function(){var vt,Zt;if((vt=Zr.length)!==0){Kn.length=Math.max(Kn.length,vt+1),Un.length=Math.max(Un.length,vt+1),Un[0]=0;var qt=Kn[0]=0;for(Zt=vt=0;Zt<Zr.length;++Zt){var yr=Zr[Zt];Br.ext_disjoint_timer_query.getQueryObjectEXT(yr,34919)?(qt+=Br.ext_disjoint_timer_query.getQueryObjectEXT(yr,34918),un.push(yr)):Zr[vt++]=yr,Un[Zt+1]=qt,Kn[Zt+1]=vt}for(Zr.length=vt,Zt=vt=0;Zt<In.length;++Zt){var Dr=(qt=In[Zt]).startQueryIndex;yr=qt.endQueryIndex,qt.sum+=Un[yr]-Un[Dr],Dr=Kn[Dr],(yr=Kn[yr])===Dr?(qt.stats.gpuTime+=qt.sum/1e6,yn.push(qt)):(qt.startQueryIndex=Dr,qt.endQueryIndex=yr,In[vt++]=qt)}In.length=vt}},getNumPendingQueries:function(){return Zr.length},clear:function(){un.push.apply(un,Zr);for(var vt=0;vt<un.length;vt++)Br.ext_disjoint_timer_query.deleteQueryEXT(un[vt]);Zr.length=0,un.length=0},restore:function(){Zr.length=0,un.length=0}}}(0,Ne),wt=ie(),Bt=It.drawingBufferWidth,Jt=It.drawingBufferHeight,er={tick:0,time:0,viewportWidth:Bt,viewportHeight:Jt,framebufferWidth:Bt,framebufferHeight:Jt,drawingBufferWidth:Bt,drawingBufferHeight:Jt,pixelRatio:xe.pixelRatio},or=oe(It,Ne),zt=g(It,Pt,xe,function(Nr){return Qt.destroyBuffer(Nr)}),Qt=k(It,Ne,or,Pt,zt),cr=d(It,Ne,zt,Pt),Dt=L(It,Yt,Pt,xe),Ut=_(It,Ne,or,function(){Lr.procs.poll()},er,Pt,xe),ur=gt(It,Ne,0,Pt,xe),Sr=S(It,Ne,or,Ut,ur,Pt),Lr=j(It,Yt,Ne,or,zt,cr,0,Sr,{},Qt,Dt,{elements:null,primitive:4,count:-1,offset:0,instances:-1},er,ut,xe),Hr=(Yt=I(It,Sr,Lr.procs.poll,er),Lr.next),Kr=It.canvas,Ir=[],kr=[],rn=[],Qr=[xe.onDestroy],nn=null;Kr&&(Kr.addEventListener("webglcontextlost",ht,!1),Kr.addEventListener("webglcontextrestored",ct,!1));var Xr=Sr.setFBO=mt({framebuffer:$.define.call(null,1,"framebuffer")});return xt(),Nt=W(mt,{clear:function(Nr){if("framebuffer"in Nr)if(Nr.framebuffer&&Nr.framebuffer_reglType==="framebufferCube")for(var Br=0;6>Br;++Br)Xr(W({framebuffer:Nr.framebuffer.faces[Br]},Nr),bt);else Xr(Nr,bt);else bt(0,Nr)},prop:$.define.bind(null,1),context:$.define.bind(null,2),this:$.define.bind(null,3),draw:mt({}),buffer:function(Nr){return zt.create(Nr,34962,!1,!1)},elements:function(Nr){return cr.create(Nr,!1)},texture:Ut.create2D,cube:Ut.createCube,renderbuffer:ur.create,framebuffer:Sr.create,framebufferCube:Sr.createCube,vao:Qt.createVAO,attributes:Nt,frame:Et,on:function(Nr,Br){var on;switch(Nr){case"frame":return Et(Br);case"lost":on=kr;break;case"restore":on=rn;break;case"destroy":on=Qr}return on.push(Br),{cancel:function(){for(var cn=0;cn<on.length;++cn)if(on[cn]===Br){on[cn]=on[on.length-1],on.pop();break}}}},limits:or,hasExtension:function(Nr){return 0<=or.extensions.indexOf(Nr.toLowerCase())},read:Yt,destroy:function(){Ir.length=0,it(),Kr&&(Kr.removeEventListener("webglcontextlost",ht),Kr.removeEventListener("webglcontextrestored",ct)),Dt.clear(),Sr.clear(),ur.clear(),Ut.clear(),cr.clear(),zt.clear(),Qt.clear(),ut&&ut.clear(),Qr.forEach(function(Nr){Nr()})},_gl:It,_refresh:xt,poll:function(){_t(),ut&&ut.update()},now:At,stats:Pt}),xe.onDone(null,Nt),Nt}})},{}],541:[function(n,z,q){"use strict";var t,h="";z.exports=function(p,l){if(typeof p!="string")throw new TypeError("expected a string");if(l===1)return p;if(l===2)return p+p;var e=p.length*l;if(t!==p||typeof t>"u")t=p,h="";else if(h.length>=e)return h.substr(0,e);for(;e>h.length&&l>1;)1&l&&(h+=p),l>>=1,p+=p;return h=(h+=p).substr(0,e)}},{}],542:[function(n,z,q){(function(t){(function(){z.exports=t.performance&&t.performance.now?function(){return performance.now()}:Date.now||function(){return+new Date}}).call(this)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],543:[function(n,z,q){"use strict";z.exports=function(t){for(var h=t.length,p=t[t.length-1],l=h,e=h-2;e>=0;--e){var o=p,r=t[e];(u=r-((p=o+r)-o))&&(t[--l]=p,p=u)}var i=0;for(e=l;e<h;++e){var u;o=t[e],(u=(r=p)-((p=o+r)-o))&&(t[i++]=u)}return t[i++]=p,t.length=i,t}},{}],544:[function(n,z,q){"use strict";var t=n("two-product"),h=n("robust-sum"),p=n("robust-scale"),l=n("robust-compress");function e(s,a){for(var c=new Array(s.length-1),f=1;f<s.length;++f)for(var g=c[f-1]=new Array(s.length-1),d=0,m=0;d<s.length;++d)d!==a&&(g[m++]=s[f][d]);return c}function o(s){for(var a=new Array(s),c=0;c<s;++c){a[c]=new Array(s);for(var f=0;f<s;++f)a[c][f]=["m[",c,"][",f,"]"].join("")}return a}function r(s){if(s.length===2)return["sum(prod(",s[0][0],",",s[1][1],"),prod(-",s[0][1],",",s[1][0],"))"].join("");for(var a=[],c=0;c<s.length;++c)a.push(["scale(",r(e(s,c)),",",(f=c,1&f?"-":""),s[0][c],")"].join(""));return function g(d){if(d.length===1)return d[0];if(d.length===2)return["sum(",d[0],",",d[1],")"].join("");var m=d.length>>1;return["sum(",g(d.slice(0,m)),",",g(d.slice(m)),")"].join("")}(a);var f}function i(s){return new Function("sum","scale","prod","compress",["function robustDeterminant",s,"(m){return compress(",r(o(s)),")};return robustDeterminant",s].join(""))(h,p,t,l)}var u=[function(){return[0]},function(s){return[s[0][0]]}];(function(){for(;u.length<6;)u.push(i(u.length));for(var s=[],a=["function robustDeterminant(m){switch(m.length){"],c=0;c<6;++c)s.push("det"+c),a.push("case ",c,":return det",c,"(m);");a.push("}var det=CACHE[m.length];if(!det)det=CACHE[m.length]=gen(m.length);return det(m);}return robustDeterminant"),s.push("CACHE","gen",a.join(""));var f=Function.apply(void 0,s);for(z.exports=f.apply(void 0,u.concat([u,i])),c=0;c<u.length;++c)z.exports[c]=u[c]})()},{"robust-compress":543,"robust-scale":550,"robust-sum":553,"two-product":582}],545:[function(n,z,q){"use strict";var t=n("two-product"),h=n("robust-sum");z.exports=function(p,l){for(var e=t(p[0],l[0]),o=1;o<p.length;++o)e=h(e,t(p[o],l[o]));return e}},{"robust-sum":553,"two-product":582}],546:[function(n,z,q){"use strict";var t=n("two-product"),h=n("robust-sum"),p=n("robust-subtract"),l=n("robust-scale");function e(f,g){for(var d=new Array(f.length-1),m=1;m<f.length;++m)for(var y=d[m-1]=new Array(f.length-1),v=0,T=0;v<f.length;++v)v!==g&&(y[T++]=f[m][v]);return d}function o(f){if(f.length===1)return f[0];if(f.length===2)return["sum(",f[0],",",f[1],")"].join("");var g=f.length>>1;return["sum(",o(f.slice(0,g)),",",o(f.slice(g)),")"].join("")}function r(f,g){if(f.charAt(0)==="m"){if(g.charAt(0)==="w"){var d=f.split("[");return["w",g.substr(1),"m",d[0].substr(1)].join("")}return["prod(",f,",",g,")"].join("")}return r(g,f)}function i(f){if(f.length===2)return[["diff(",r(f[0][0],f[1][1]),",",r(f[1][0],f[0][1]),")"].join("")];for(var g=[],d=0;d<f.length;++d)g.push(["scale(",o(i(e(f,d))),",",(m=d,!0&m?"-":""),f[0][d],")"].join(""));return g;var m}function u(f,g){for(var d=[],m=0;m<g-2;++m)d.push(["prod(m",f,"[",m,"],m",f,"[",m,"])"].join(""));return o(d)}function s(f){for(var g=[],d=[],m=function(b){for(var _=new Array(b),S=0;S<b;++S){_[S]=new Array(b);for(var C=0;C<b;++C)_[S][C]=["m",C,"[",b-S-2,"]"].join("")}return _}(f),y=0;y<f;++y)m[0][y]="1",m[f-1][y]="w"+y;for(y=0;y<f;++y)1&y?d.push.apply(d,i(e(m,y))):g.push.apply(g,i(e(m,y)));var v=o(g),T=o(d),w="exactInSphere"+f,A=[];for(y=0;y<f;++y)A.push("m"+y);var E=["function ",w,"(",A.join(),"){"];for(y=0;y<f;++y){E.push("var w",y,"=",u(y,f),";");for(var M=0;M<f;++M)M!==y&&E.push("var w",y,"m",M,"=scale(w",y,",m",M,"[0]);")}return E.push("var p=",v,",n=",T,",d=diff(p,n);return d[d.length-1];}return ",w),new Function("sum","diff","prod","scale",E.join(""))(h,p,t,l)}var a=[function(){return 0},function(){return 0},function(){return 0}];function c(f){var g=a[f.length];return g||(g=a[f.length]=s(f.length)),g.apply(void 0,f)}(function(){for(;a.length<=6;)a.push(s(a.length));for(var f=[],g=["slow"],d=0;d<=6;++d)f.push("a"+d),g.push("o"+d);var m=["function testInSphere(",f.join(),"){switch(arguments.length){case 0:case 1:return 0;"];for(d=2;d<=6;++d)m.push("case ",d,":return o",d,"(",f.slice(0,d).join(),");");m.push("}var s=new Array(arguments.length);for(var i=0;i<arguments.length;++i){s[i]=arguments[i]};return slow(s);}return testInSphere"),g.push(m.join(""));var y=Function.apply(void 0,g);for(z.exports=y.apply(void 0,[c].concat(a)),d=0;d<=6;++d)z.exports[d]=a[d]})()},{"robust-scale":550,"robust-subtract":552,"robust-sum":553,"two-product":582}],547:[function(n,z,q){"use strict";var t=n("robust-determinant");function h(l){for(var e="robustLinearSolve"+l+"d",o=["function ",e,"(A,b){return ["],r=0;r<l;++r){o.push("det([");for(var i=0;i<l;++i){i>0&&o.push(","),o.push("[");for(var u=0;u<l;++u)u>0&&o.push(","),u===r?o.push("+b[",i,"]"):o.push("+A[",i,"][",u,"]");o.push("]")}o.push("]),")}o.push("det(A)]}return ",e);var s=new Function("det",o.join(""));return s(l<6?t[l]:t)}var p=[function(){return[0]},function(l,e){return[[e[0]],[l[0][0]]]}];(function(){for(;p.length<6;)p.push(h(p.length));for(var l=[],e=["function dispatchLinearSolve(A,b){switch(A.length){"],o=0;o<6;++o)l.push("s"+o),e.push("case ",o,":return s",o,"(A,b);");e.push("}var s=CACHE[A.length];if(!s)s=CACHE[A.length]=g(A.length);return s(A,b)}return dispatchLinearSolve"),l.push("CACHE","g",e.join(""));var r=Function.apply(void 0,l);for(z.exports=r.apply(void 0,p.concat([p,h])),o=0;o<6;++o)z.exports[o]=p[o]})()},{"robust-determinant":544}],548:[function(n,z,q){"use strict";var t=n("two-product"),h=n("robust-sum"),p=n("robust-scale"),l=n("robust-subtract");function e(f,g){for(var d=new Array(f.length-1),m=1;m<f.length;++m)for(var y=d[m-1]=new Array(f.length-1),v=0,T=0;v<f.length;++v)v!==g&&(y[T++]=f[m][v]);return d}function o(f){if(f.length===1)return f[0];if(f.length===2)return["sum(",f[0],",",f[1],")"].join("");var g=f.length>>1;return["sum(",o(f.slice(0,g)),",",o(f.slice(g)),")"].join("")}function r(f){if(f.length===2)return[["sum(prod(",f[0][0],",",f[1][1],"),prod(-",f[0][1],",",f[1][0],"))"].join("")];for(var g=[],d=0;d<f.length;++d)g.push(["scale(",o(r(e(f,d))),",",(m=d,1&m?"-":""),f[0][d],")"].join(""));return g;var m}function i(f){for(var g=[],d=[],m=function(M){for(var b=new Array(M),_=0;_<M;++_){b[_]=new Array(M);for(var S=0;S<M;++S)b[_][S]=["m",S,"[",M-_-1,"]"].join("")}return b}(f),y=[],v=0;v<f;++v)1&v?d.push.apply(d,r(e(m,v))):g.push.apply(g,r(e(m,v))),y.push("m"+v);var T=o(g),w=o(d),A="orientation"+f+"Exact",E=["function ",A,"(",y.join(),"){var p=",T,",n=",w,",d=sub(p,n);return d[d.length-1];};return ",A].join("");return new Function("sum","prod","scale","sub",E)(h,t,p,l)}var u=i(3),s=i(4),a=[function(){return 0},function(){return 0},function(f,g){return g[0]-f[0]},function(f,g,d){var m,y=(f[1]-d[1])*(g[0]-d[0]),v=(f[0]-d[0])*(g[1]-d[1]),T=y-v;if(y>0){if(v<=0)return T;m=y+v}else{if(!(y<0)||v>=0)return T;m=-(y+v)}var w=33306690738754716e-32*m;return T>=w||T<=-w?T:u(f,g,d)},function(f,g,d,m){var y=f[0]-m[0],v=g[0]-m[0],T=d[0]-m[0],w=f[1]-m[1],A=g[1]-m[1],E=d[1]-m[1],M=f[2]-m[2],b=g[2]-m[2],_=d[2]-m[2],S=v*E,C=T*A,k=T*w,L=y*E,I=y*A,R=v*w,V=M*(S-C)+b*(k-L)+_*(I-R),O=7771561172376103e-31*((Math.abs(S)+Math.abs(C))*Math.abs(M)+(Math.abs(k)+Math.abs(L))*Math.abs(b)+(Math.abs(I)+Math.abs(R))*Math.abs(_));return V>O||-V>O?V:s(f,g,d,m)}];function c(f){var g=a[f.length];return g||(g=a[f.length]=i(f.length)),g.apply(void 0,f)}(function(){for(;a.length<=5;)a.push(i(a.length));for(var f=[],g=["slow"],d=0;d<=5;++d)f.push("a"+d),g.push("o"+d);var m=["function getOrientation(",f.join(),"){switch(arguments.length){case 0:case 1:return 0;"];for(d=2;d<=5;++d)m.push("case ",d,":return o",d,"(",f.slice(0,d).join(),");");m.push("}var s=new Array(arguments.length);for(var i=0;i<arguments.length;++i){s[i]=arguments[i]};return slow(s);}return getOrientation"),g.push(m.join(""));var y=Function.apply(void 0,g);for(z.exports=y.apply(void 0,[c].concat(a)),d=0;d<=5;++d)z.exports[d]=a[d]})()},{"robust-scale":550,"robust-subtract":552,"robust-sum":553,"two-product":582}],549:[function(n,z,q){"use strict";var t=n("robust-sum"),h=n("robust-scale");z.exports=function(p,l){if(p.length===1)return h(l,p[0]);if(l.length===1)return h(p,l[0]);if(p.length===0||l.length===0)return[0];var e=[0];if(p.length<l.length)for(var o=0;o<p.length;++o)e=t(e,h(l,p[o]));else for(o=0;o<l.length;++o)e=t(e,h(p,l[o]));return e}},{"robust-scale":550,"robust-sum":553}],550:[function(n,z,q){"use strict";var t=n("two-product"),h=n("two-sum");z.exports=function(p,l){var e=p.length;if(e===1){var o=t(p[0],l);return o[0]?o:[o[1]]}var r=new Array(2*e),i=[.1,.1],u=[.1,.1],s=0;t(p[0],l,i),i[0]&&(r[s++]=i[0]);for(var a=1;a<e;++a){t(p[a],l,u);var c=i[1];h(c,u[0],i),i[0]&&(r[s++]=i[0]);var f=u[1],g=i[1],d=f+g,m=g-(d-f);i[1]=d,m&&(r[s++]=m)}return i[1]&&(r[s++]=i[1]),s===0&&(r[s++]=0),r.length=s,r}},{"two-product":582,"two-sum":583}],551:[function(n,z,q){"use strict";z.exports=function(h,p,l,e){var o=t(h,l,e),r=t(p,l,e);if(o>0&&r>0||o<0&&r<0)return!1;var i=t(l,h,p),u=t(e,h,p);return i>0&&u>0||i<0&&u<0?!1:o===0&&r===0&&i===0&&u===0?function(s,a,c,f){for(var g=0;g<2;++g){var d=s[g],m=a[g],y=Math.min(d,m),v=Math.max(d,m),T=c[g],w=f[g],A=Math.min(T,w);if(Math.max(T,w)<y||v<A)return!1}return!0}(h,p,l,e):!0};var t=n("robust-orientation")[3]},{"robust-orientation":548}],552:[function(n,z,q){"use strict";z.exports=function(t,h){var p=0|t.length,l=0|h.length;if(p===1&&l===1)return function(M,b){var _=M+b,S=_-M,C=M-(_-S)+(b-S);return C?[C,_]:[_]}(t[0],-h[0]);var e,o,r=new Array(p+l),i=0,u=0,s=0,a=Math.abs,c=t[u],f=a(c),g=-h[s],d=a(g);f<d?(o=c,(u+=1)<p&&(c=t[u],f=a(c))):(o=g,(s+=1)<l&&(g=-h[s],d=a(g))),u<p&&f<d||s>=l?(e=c,(u+=1)<p&&(c=t[u],f=a(c))):(e=g,(s+=1)<l&&(g=-h[s],d=a(g)));for(var m,y,v=e+o,T=v-e,w=o-T,A=w,E=v;u<p&&s<l;)f<d?(e=c,(u+=1)<p&&(c=t[u],f=a(c))):(e=g,(s+=1)<l&&(g=-h[s],d=a(g))),(w=(o=A)-(T=(v=e+o)-e))&&(r[i++]=w),A=E-((m=E+v)-(y=m-E))+(v-y),E=m;for(;u<p;)(w=(o=A)-(T=(v=(e=c)+o)-e))&&(r[i++]=w),A=E-((m=E+v)-(y=m-E))+(v-y),E=m,(u+=1)<p&&(c=t[u]);for(;s<l;)(w=(o=A)-(T=(v=(e=g)+o)-e))&&(r[i++]=w),A=E-((m=E+v)-(y=m-E))+(v-y),E=m,(s+=1)<l&&(g=-h[s]);return A&&(r[i++]=A),E&&(r[i++]=E),i||(r[i++]=0),r.length=i,r}},{}],553:[function(n,z,q){"use strict";z.exports=function(t,h){var p=0|t.length,l=0|h.length;if(p===1&&l===1)return function(M,b){var _=M+b,S=_-M,C=M-(_-S)+(b-S);return C?[C,_]:[_]}(t[0],h[0]);var e,o,r=new Array(p+l),i=0,u=0,s=0,a=Math.abs,c=t[u],f=a(c),g=h[s],d=a(g);f<d?(o=c,(u+=1)<p&&(c=t[u],f=a(c))):(o=g,(s+=1)<l&&(g=h[s],d=a(g))),u<p&&f<d||s>=l?(e=c,(u+=1)<p&&(c=t[u],f=a(c))):(e=g,(s+=1)<l&&(g=h[s],d=a(g)));for(var m,y,v=e+o,T=v-e,w=o-T,A=w,E=v;u<p&&s<l;)f<d?(e=c,(u+=1)<p&&(c=t[u],f=a(c))):(e=g,(s+=1)<l&&(g=h[s],d=a(g))),(w=(o=A)-(T=(v=e+o)-e))&&(r[i++]=w),A=E-((m=E+v)-(y=m-E))+(v-y),E=m;for(;u<p;)(w=(o=A)-(T=(v=(e=c)+o)-e))&&(r[i++]=w),A=E-((m=E+v)-(y=m-E))+(v-y),E=m,(u+=1)<p&&(c=t[u]);for(;s<l;)(w=(o=A)-(T=(v=(e=g)+o)-e))&&(r[i++]=w),A=E-((m=E+v)-(y=m-E))+(v-y),E=m,(s+=1)<l&&(g=h[s]);return A&&(r[i++]=A),E&&(r[i++]=E),i||(r[i++]=0),r.length=i,r}},{}],554:[function(n,z,q){"use strict";z.exports=function(t){return t<0?-1:t>0?1:0}},{}],555:[function(n,z,q){"use strict";z.exports=function(p){return h(t(p))};var t=n("boundary-cells"),h=n("reduce-simplicial-complex")},{"boundary-cells":100,"reduce-simplicial-complex":533}],556:[function(n,z,q){"use strict";z.exports=function(e,o,r,i){if(r=r||0,typeof i>"u"&&(i=function(m){for(var y=m.length,v=0,T=0;T<y;++T)v=0|Math.max(v,m[T].length);return v-1}(e)),e.length===0||i<1)return{cells:[],vertexIds:[],vertexWeights:[]};var u=function(m,y){for(var v=m.length,T=h.mallocUint8(v),w=0;w<v;++w)T[w]=m[w]<y|0;return T}(o,+r),s=function(m,y){for(var v=m.length,T=y*(y+1)/2*v|0,w=h.mallocUint32(2*T),A=0,E=0;E<v;++E)for(var M=m[E],b=(y=M.length,0);b<y;++b)for(var _=0;_<b;++_){var S=M[_],C=M[b];w[A++]=0|Math.min(S,C),w[A++]=0|Math.max(S,C)}p(t(w,[A/2|0,2]));var k=2;for(E=2;E<A;E+=2)w[E-2]===w[E]&&w[E-1]===w[E+1]||(w[k++]=w[E],w[k++]=w[E+1]);return t(w,[k/2|0,2])}(e,i),a=function(m,y,v,T){for(var w=m.data,A=m.shape[0],E=h.mallocDouble(A),M=0,b=0;b<A;++b){var _=w[2*b],S=w[2*b+1];if(v[_]!==v[S]){var C=y[_],k=y[S];w[2*M]=_,w[2*M+1]=S,E[M++]=(k-T)/(k-C)}}return m.shape[0]=M,t(E,[M])}(s,o,u,+r),c=function(m,y){var v=h.mallocInt32(2*y),T=m.shape[0],w=m.data;v[0]=0;for(var A=0,E=0;E<T;++E){var M=w[2*E];if(M!==A){for(v[2*A+1]=E;++A<M;)v[2*A]=E,v[2*A+1]=E;v[2*A]=E}}for(v[2*A+1]=T;++A<y;)v[2*A]=v[2*A+1]=T;return v}(s,0|o.length),f=l(i)(e,s.data,c,u),g=function(m){for(var y=0|m.shape[0],v=m.data,T=new Array(y),w=0;w<y;++w)T[w]=[v[2*w],v[2*w+1]];return T}(s),d=[].slice.call(a.data,0,a.shape[0]);return h.free(u),h.free(s.data),h.free(a.data),h.free(c),{cells:f,vertexIds:g,vertexWeights:d}};var t=n("ndarray"),h=n("typedarray-pool"),p=n("ndarray-sort"),l=n("./lib/codegen")},{"./lib/codegen":557,ndarray:495,"ndarray-sort":494,"typedarray-pool":595}],557:[function(n,z,q){"use strict";z.exports=function(l){var e=p[l];return e||(e=p[l]=function(o){var r=0,i=new Array(o+1);i[0]=[[]];for(var u=1;u<=o;++u)for(var s=i[u]=h(u),a=0;a<s.length;++a)r=Math.max(r,s[u].length);var c=["function B(C,E,i,j){","var a=Math.min(i,j)|0,b=Math.max(i,j)|0,l=C[2*a],h=C[2*a+1];","while(l<h){","var m=(l+h)>>1,v=E[2*m+1];","if(v===b){return m}","if(b<v){h=m}else{l=m+1}","}","return l;","};","function getContour",o,"d(F,E,C,S){","var n=F.length,R=[];","for(var i=0;i<n;++i){var c=F[i],l=c.length;"];function f(d){if(!(d.length<=0)){c.push("R.push(");for(var m=0;m<d.length;++m){var y=d[m];m>0&&c.push(","),c.push("[");for(var v=0;v<y.length;++v){var T=y[v];v>0&&c.push(","),c.push("B(C,E,c[",T[0],"],c[",T[1],"])")}c.push("]")}c.push(");")}}for(u=o+1;u>1;--u){u<o+1&&c.push("else "),c.push("if(l===",u,"){");var g=[];for(a=0;a<u;++a)g.push("(S[c["+a+"]]<<"+a+")");for(c.push("var M=",g.join("+"),";if(M===0||M===",(1<<u)-1,"){continue}switch(M){"),s=i[u-1],a=0;a<s.length;++a)c.push("case ",a,":"),f(s[a]),c.push("break;");c.push("}}")}return c.push("}return R;};return getContour",o,"d"),new Function("pool",c.join(""))(t)}(l)),e};var t=n("typedarray-pool"),h=n("marching-simplex-table"),p={}},{"marching-simplex-table":474,"typedarray-pool":595}],558:[function(n,z,q){"use strict";var t=n("bit-twiddle"),h=n("union-find");function p(s,a){var c=s.length,f=s.length-a.length,g=Math.min;if(f)return f;switch(c){case 0:return 0;case 1:return s[0]-a[0];case 2:return(y=s[0]+s[1]-a[0]-a[1])||g(s[0],s[1])-g(a[0],a[1]);case 3:var d=s[0]+s[1],m=a[0]+a[1];if(y=d+s[2]-(m+a[2]))return y;var y,v=g(s[0],s[1]),T=g(a[0],a[1]);return(y=g(v,s[2])-g(T,a[2]))||g(v+s[2],d)-g(T+a[2],m);default:var w=s.slice(0);w.sort();var A=a.slice(0);A.sort();for(var E=0;E<c;++E)if(f=w[E]-A[E])return f;return 0}}function l(s,a){return p(s[0],a[0])}function e(s,a){if(a){for(var c=s.length,f=new Array(c),g=0;g<c;++g)f[g]=[s[g],a[g]];for(f.sort(l),g=0;g<c;++g)s[g]=f[g][0],a[g]=f[g][1];return s}return s.sort(p),s}function o(s){if(s.length===0)return[];for(var a=1,c=s.length,f=1;f<c;++f){var g=s[f];if(p(g,s[f-1])){if(f===a){a++;continue}s[a++]=g}}return s.length=a,s}function r(s,a){for(var c=0,f=s.length-1,g=-1;c<=f;){var d=c+f>>1,m=p(s[d],a);m<=0?(m===0&&(g=d),c=d+1):m>0&&(f=d-1)}return g}function i(s,a){for(var c=new Array(s.length),f=0,g=c.length;f<g;++f)c[f]=[];for(var d=[],m=(f=0,a.length);f<m;++f)for(var y=a[f],v=y.length,T=1,w=1<<v;T<w;++T){d.length=t.popCount(T);for(var A=0,E=0;E<v;++E)T&1<<E&&(d[A++]=y[E]);var M=r(s,d);if(!(M<0))for(;c[M++].push(f),!(M>=s.length||p(s[M],d)!==0););}return c}function u(s,a){if(a<0)return[];for(var c=[],f=(1<<a+1)-1,g=0;g<s.length;++g)for(var d=s[g],m=f;m<1<<d.length;m=t.nextCombination(m)){for(var y=new Array(a+1),v=0,T=0;T<d.length;++T)m&1<<T&&(y[v++]=d[T]);c.push(y)}return e(c)}q.dimension=function(s){for(var a=0,c=Math.max,f=0,g=s.length;f<g;++f)a=c(a,s[f].length);return a-1},q.countVertices=function(s){for(var a=-1,c=Math.max,f=0,g=s.length;f<g;++f)for(var d=s[f],m=0,y=d.length;m<y;++m)a=c(a,d[m]);return a+1},q.cloneCells=function(s){for(var a=new Array(s.length),c=0,f=s.length;c<f;++c)a[c]=s[c].slice(0);return a},q.compareCells=p,q.normalize=e,q.unique=o,q.findCell=r,q.incidence=i,q.dual=function(s,a){if(!a)return i(o(u(s,0)),s);for(var c=new Array(a),f=0;f<a;++f)c[f]=[];f=0;for(var g=s.length;f<g;++f)for(var d=s[f],m=0,y=d.length;m<y;++m)c[d[m]].push(f);return c},q.explode=function(s){for(var a=[],c=0,f=s.length;c<f;++c)for(var g=s[c],d=0|g.length,m=1,y=1<<d;m<y;++m){for(var v=[],T=0;T<d;++T)m>>>T&1&&v.push(g[T]);a.push(v)}return e(a)},q.skeleton=u,q.boundary=function(s){for(var a=[],c=0,f=s.length;c<f;++c)for(var g=s[c],d=0,m=g.length;d<m;++d){for(var y=new Array(g.length-1),v=0,T=0;v<m;++v)v!==d&&(y[T++]=g[v]);a.push(y)}return e(a)},q.connectedComponents=function(s,a){return a?function(c,f){for(var g=new h(f),d=0;d<c.length;++d)for(var m=c[d],y=0;y<m.length;++y)for(var v=y+1;v<m.length;++v)g.link(m[y],m[v]);var T=[],w=g.ranks;for(d=0;d<w.length;++d)w[d]=-1;for(d=0;d<c.length;++d){var A=g.find(c[d][0]);w[A]<0?(w[A]=T.length,T.push([c[d].slice(0)])):T[w[A]].push(c[d].slice(0))}return T}(s,a):function(c){for(var f=o(e(u(c,0))),g=new h(f.length),d=0;d<c.length;++d)for(var m=c[d],y=0;y<m.length;++y)for(var v=r(f,[m[y]]),T=y+1;T<m.length;++T)g.link(v,r(f,[m[T]]));var w=[],A=g.ranks;for(d=0;d<A.length;++d)A[d]=-1;for(d=0;d<c.length;++d){var E=g.find(r(f,[c[d][0]]));A[E]<0?(A[E]=w.length,w.push([c[d].slice(0)])):w[A[E]].push(c[d].slice(0))}return w}(s)}},{"bit-twiddle":97,"union-find":596}],559:[function(n,z,q){arguments[4][97][0].apply(q,arguments)},{dup:97}],560:[function(n,z,q){arguments[4][558][0].apply(q,arguments)},{"bit-twiddle":559,dup:558,"union-find":561}],561:[function(n,z,q){"use strict";function t(h){this.roots=new Array(h),this.ranks=new Array(h);for(var p=0;p<h;++p)this.roots[p]=p,this.ranks[p]=0}z.exports=t,t.prototype.length=function(){return this.roots.length},t.prototype.makeSet=function(){var h=this.roots.length;return this.roots.push(h),this.ranks.push(0),h},t.prototype.find=function(h){for(var p=this.roots;p[h]!==h;){var l=p[h];p[h]=p[l],h=l}return h},t.prototype.link=function(h,p){var l=this.find(h),e=this.find(p);if(l!==e){var o=this.ranks,r=this.roots,i=o[l],u=o[e];i<u?r[l]=e:u<i?r[e]=l:(r[e]=l,++o[l])}}},{}],562:[function(n,z,q){"use strict";z.exports=function(p,l,e){for(var o=l.length,r=p.length,i=new Array(o),u=new Array(o),s=new Array(o),a=new Array(o),c=0;c<o;++c)i[c]=u[c]=-1,s[c]=1/0,a[c]=!1;for(c=0;c<r;++c){var f=p[c];if(f.length!==2)throw new Error("Input must be a graph");var g=f[1],d=f[0];u[d]!==-1?u[d]=-2:u[d]=g,i[g]!==-1?i[g]=-2:i[g]=d}function m(V){if(a[V])return 1/0;var O,J,D,B,N,F=i[V],H=u[V];return F<0||H<0?1/0:(O=l[V],J=l[F],D=l[H],B=Math.abs(t(O,J,D)),N=Math.sqrt(Math.pow(J[0]-D[0],2)+Math.pow(J[1]-D[1],2)),B/N)}function y(V,O){var J=_[V],D=_[O];_[V]=D,_[O]=J,S[J]=O,S[D]=V}function v(V){return s[_[V]]}function T(V){return 1&V?V-1>>1:(V>>1)-1}function w(V){for(var O=v(V);;){var J=O,D=2*V+1,B=2*(V+1),N=V;if(D<C){var F=v(D);F<J&&(N=D,J=F)}if(B<C&&v(B)<J&&(N=B),N===V)return V;y(V,N),V=N}}function A(V){for(var O=v(V);V>0;){var J=T(V);if(J>=0&&O<v(J)){y(V,J),V=J;continue}return V}}function E(){if(C>0){var V=_[0];return y(0,C-1),C-=1,w(0),V}return-1}function M(V,O){var J=_[V];return s[J]===O?V:(s[J]=-1/0,A(V),E(),s[J]=O,A((C+=1)-1))}function b(V){if(!a[V]){a[V]=!0;var O=i[V],J=u[V];i[J]>=0&&(i[J]=O),u[O]>=0&&(u[O]=J),S[O]>=0&&M(S[O],m(O)),S[J]>=0&&M(S[J],m(J))}}var _=[],S=new Array(o);for(c=0;c<o;++c)(s[c]=m(c))<1/0?(S[c]=_.length,_.push(c)):S[c]=-1;var C=_.length;for(c=C>>1;c>=0;--c)w(c);for(;;){var k=E();if(k<0||s[k]>e)break;b(k)}var L=[];for(c=0;c<o;++c)a[c]||(S[c]=L.length,L.push(l[c].slice()));L.length;function I(V,O){if(V[O]<0)return O;var J=O,D=O;do{var B=V[D];if(!a[D]||B<0||B===D||(B=V[D=B],!a[D]||B<0||B===D))break;D=B,J=V[J]}while(J!==D);for(var N=O;N!==D;N=V[N])V[N]=D;return D}var R=[];return p.forEach(function(V){var O=I(i,V[0]),J=I(u,V[1]);if(O>=0&&J>=0&&O!==J){var D=S[O],B=S[J];D!==B&&R.push([D,B])}}),h.unique(h.normalize(R)),{positions:L,edges:R}};var t=n("robust-orientation"),h=n("simplicial-complex")},{"robust-orientation":548,"simplicial-complex":560}],563:[function(n,z,q){"use strict";z.exports=function(p,l){var e,o,r,i;if(l[0][0]<l[1][0])e=l[0],o=l[1];else{if(!(l[0][0]>l[1][0]))return h(l,p);e=l[1],o=l[0]}if(p[0][0]<p[1][0])r=p[0],i=p[1];else{if(!(p[0][0]>p[1][0]))return-h(p,l);r=p[1],i=p[0]}var u=t(e,o,i),s=t(e,o,r);if(u<0){if(s<=0)return u}else if(u>0){if(s>=0)return u}else if(s)return s;if(u=t(i,r,o),s=t(i,r,e),u<0){if(s<=0)return u}else if(u>0){if(s>=0)return u}else if(s)return s;return o[0]-i[0]};var t=n("robust-orientation");function h(p,l){var e,o,r,i;if(l[0][0]<l[1][0])e=l[0],o=l[1];else{if(!(l[0][0]>l[1][0])){var u=Math.min(p[0][1],p[1][1]),s=Math.max(p[0][1],p[1][1]),a=Math.min(l[0][1],l[1][1]),c=Math.max(l[0][1],l[1][1]);return s<a?s-a:u>c?u-c:s-c}e=l[1],o=l[0]}p[0][1]<p[1][1]?(r=p[0],i=p[1]):(r=p[1],i=p[0]);var f=t(o,e,r);return f||(f=t(o,e,i))||i-o}},{"robust-orientation":548}],564:[function(n,z,q){arguments[4][243][0].apply(q,arguments)},{dup:243}],565:[function(n,z,q){"use strict";z.exports=function(s){for(var a=s.length,c=2*a,f=new Array(c),g=0;g<a;++g){var d=s[g],m=d[0][0]<d[1][0];f[2*g]=new u(d[0][0],d,m,g),f[2*g+1]=new u(d[1][0],d,!m,g)}f.sort(function(b,_){var S=b.x-_.x;return S||(S=b.create-_.create)||Math.min(b.segment[0][1],b.segment[1][1])-Math.min(_.segment[0][1],_.segment[1][1])});var y=h(l),v=[],T=[],w=[];for(g=0;g<c;){for(var A=f[g].x,E=[];g<c;){var M=f[g];if(M.x!==A)break;g+=1,M.segment[0][0]===M.x&&M.segment[1][0]===M.x?M.create&&(M.segment[0][1]<M.segment[1][1]?(E.push(new i(M.segment[0][1],M.index,!0,!0)),E.push(new i(M.segment[1][1],M.index,!1,!1))):(E.push(new i(M.segment[1][1],M.index,!0,!1)),E.push(new i(M.segment[0][1],M.index,!1,!0)))):y=M.create?y.insert(M.segment,M.index):y.remove(M.segment)}v.push(y.root),T.push(A),w.push(E)}return new e(v,T,w)};var t=n("binary-search-bounds"),h=n("functional-red-black-tree"),p=n("robust-orientation"),l=n("./lib/order-segments");function e(s,a,c){this.slabs=s,this.coordinates=a,this.horizontal=c}function o(s,a){return s.y-a}function r(s,a){for(var c=null;s;){var f,g,d=s.key;d[0][0]<d[1][0]?(f=d[0],g=d[1]):(f=d[1],g=d[0]);var m=p(f,g,a);if(m<0)s=s.left;else if(m>0)if(a[0]!==d[1][0])c=s,s=s.right;else{if(y=r(s.right,a))return y;s=s.left}else{if(a[0]!==d[1][0])return s;var y;if(y=r(s.right,a))return y;s=s.left}}return c}function i(s,a,c,f){this.y=s,this.index=a,this.start=c,this.closed=f}function u(s,a,c,f){this.x=s,this.segment=a,this.create=c,this.index=f}e.prototype.castUp=function(s){var a=t.le(this.coordinates,s[0]);if(a<0)return-1;this.slabs[a];var c=r(this.slabs[a],s),f=-1;if(c&&(f=c.value),this.coordinates[a]===s[0]){var g=null;if(c&&(g=c.key),a>0){var d=r(this.slabs[a-1],s);d&&(g?l(d.key,g)>0&&(g=d.key,f=d.value):(f=d.value,g=d.key))}var m=this.horizontal[a];if(m.length>0){var y=t.ge(m,s[1],o);if(y<m.length){var v=m[y];if(s[1]===v.y){if(v.closed)return v.index;for(;y<m.length-1&&m[y+1].y===s[1];)if((v=m[y+=1]).closed)return v.index;if(v.y===s[1]&&!v.start){if((y+=1)>=m.length)return f;v=m[y]}}if(v.start)if(g){var T=p(g[0],g[1],[s[0],v.y]);g[0][0]>g[1][0]&&(T=-T),T>0&&(f=v.index)}else f=v.index;else v.y!==s[1]&&(f=v.index)}}}return f}},{"./lib/order-segments":563,"binary-search-bounds":564,"functional-red-black-tree":247,"robust-orientation":548}],566:[function(n,z,q){"use strict";var t=n("robust-dot-product"),h=n("robust-sum");function p(e,o){var r=h(t(e,o),[o[o.length-1]]);return r[r.length-1]}function l(e,o,r,i){var u=-o/(i-o);u<0?u=0:u>1&&(u=1);for(var s=1-u,a=e.length,c=new Array(a),f=0;f<a;++f)c[f]=u*e[f]+s*r[f];return c}z.exports=function(e,o){for(var r=[],i=[],u=p(e[e.length-1],o),s=e[e.length-1],a=e[0],c=0;c<e.length;++c,s=a){var f=p(a=e[c],o);if(u<0&&f>0||u>0&&f<0){var g=l(s,f,a,u);r.push(g),i.push(g.slice())}f<0?i.push(a.slice()):f>0?r.push(a.slice()):(r.push(a.slice()),i.push(a.slice())),u=f}return{positive:r,negative:i}},z.exports.positive=function(e,o){for(var r=[],i=p(e[e.length-1],o),u=e[e.length-1],s=e[0],a=0;a<e.length;++a,u=s){var c=p(s=e[a],o);(i<0&&c>0||i>0&&c<0)&&r.push(l(u,c,s,i)),c>=0&&r.push(s.slice()),i=c}return r},z.exports.negative=function(e,o){for(var r=[],i=p(e[e.length-1],o),u=e[e.length-1],s=e[0],a=0;a<e.length;++a,u=s){var c=p(s=e[a],o);(i<0&&c>0||i>0&&c<0)&&r.push(l(u,c,s,i)),c<=0&&r.push(s.slice()),i=c}return r}},{"robust-dot-product":545,"robust-sum":553}],567:[function(n,z,q){(function(){"use strict";var t={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/};function h(r){return l(o(r),arguments)}function p(r,i){return h.apply(null,[r].concat(i||[]))}function l(r,i){var u,s,a,c,f,g,d,m,y,v=1,T=r.length,w="";for(s=0;s<T;s++)if(typeof r[s]=="string")w+=r[s];else if(typeof r[s]=="object"){if((c=r[s]).keys)for(u=i[v],a=0;a<c.keys.length;a++){if(u==null)throw new Error(h('[sprintf] Cannot access property "%s" of undefined value "%s"',c.keys[a],c.keys[a-1]));u=u[c.keys[a]]}else u=c.param_no?i[c.param_no]:i[v++];if(t.not_type.test(c.type)&&t.not_primitive.test(c.type)&&u instanceof Function&&(u=u()),t.numeric_arg.test(c.type)&&typeof u!="number"&&isNaN(u))throw new TypeError(h("[sprintf] expecting number but found %T",u));switch(t.number.test(c.type)&&(m=u>=0),c.type){case"b":u=parseInt(u,10).toString(2);break;case"c":u=String.fromCharCode(parseInt(u,10));break;case"d":case"i":u=parseInt(u,10);break;case"j":u=JSON.stringify(u,null,c.width?parseInt(c.width):0);break;case"e":u=c.precision?parseFloat(u).toExponential(c.precision):parseFloat(u).toExponential();break;case"f":u=c.precision?parseFloat(u).toFixed(c.precision):parseFloat(u);break;case"g":u=c.precision?String(Number(u.toPrecision(c.precision))):parseFloat(u);break;case"o":u=(parseInt(u,10)>>>0).toString(8);break;case"s":u=String(u),u=c.precision?u.substring(0,c.precision):u;break;case"t":u=String(!!u),u=c.precision?u.substring(0,c.precision):u;break;case"T":u=Object.prototype.toString.call(u).slice(8,-1).toLowerCase(),u=c.precision?u.substring(0,c.precision):u;break;case"u":u=parseInt(u,10)>>>0;break;case"v":u=u.valueOf(),u=c.precision?u.substring(0,c.precision):u;break;case"x":u=(parseInt(u,10)>>>0).toString(16);break;case"X":u=(parseInt(u,10)>>>0).toString(16).toUpperCase()}t.json.test(c.type)?w+=u:(!t.number.test(c.type)||m&&!c.sign?y="":(y=m?"+":"-",u=u.toString().replace(t.sign,"")),g=c.pad_char?c.pad_char==="0"?"0":c.pad_char.charAt(1):" ",d=c.width-(y+u).length,f=c.width&&d>0?g.repeat(d):"",w+=c.align?y+u+f:g==="0"?y+f+u:f+y+u)}return w}var e=Object.create(null);function o(r){if(e[r])return e[r];for(var i,u=r,s=[],a=0;u;){if((i=t.text.exec(u))!==null)s.push(i[0]);else if((i=t.modulo.exec(u))!==null)s.push("%");else{if((i=t.placeholder.exec(u))===null)throw new SyntaxError("[sprintf] unexpected placeholder");if(i[2]){a|=1;var c=[],f=i[2],g=[];if((g=t.key.exec(f))===null)throw new SyntaxError("[sprintf] failed to parse named argument key");for(c.push(g[1]);(f=f.substring(g[0].length))!=="";)if((g=t.key_access.exec(f))!==null)c.push(g[1]);else{if((g=t.index_access.exec(f))===null)throw new SyntaxError("[sprintf] failed to parse named argument key");c.push(g[1])}i[2]=c}else a|=2;if(a===3)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");s.push({placeholder:i[0],param_no:i[1],keys:i[2],sign:i[3],pad_char:i[4],align:i[5],width:i[6],precision:i[7],type:i[8]})}u=u.substring(i[0].length)}return e[r]=s}typeof q<"u"&&(q.sprintf=h,q.vsprintf=p),typeof window<"u"&&(window.sprintf=h,window.vsprintf=p)})()},{}],568:[function(n,z,q){"use strict";var t=n("parenthesis");z.exports=function(h,p,l){if(h==null)throw Error("First argument should be a string");if(p==null)throw Error("Separator should be a string or a RegExp");l?(typeof l=="string"||Array.isArray(l))&&(l={ignore:l}):l={},l.escape==null&&(l.escape=!0),l.ignore==null?l.ignore=["[]","()","{}","<>",'""',"''","``","\u201C\u201D","\xAB\xBB"]:(typeof l.ignore=="string"&&(l.ignore=[l.ignore]),l.ignore=l.ignore.map(function(a){return a.length===1&&(a+=a),a}));var e=t.parse(h,{flat:!0,brackets:l.ignore}),o=e[0].split(p);if(l.escape){for(var r=[],i=0;i<o.length;i++){var u=o[i],s=o[i+1];u[u.length-1]==="\\"&&u[u.length-2]!=="\\"?(r.push(u+p+s),i++):r.push(u)}o=r}for(i=0;i<o.length;i++)e[0]=o[i],o[i]=t.stringify(e,{flat:!0});return o}},{parenthesis:503}],569:[function(n,z,q){"use strict";z.exports=function(t){for(var h=t.length,p=new Array(h),l=new Array(h),e=new Array(h),o=new Array(h),r=new Array(h),i=new Array(h),u=0;u<h;++u)p[u]=-1,l[u]=0,e[u]=!1,o[u]=0,r[u]=-1,i[u]=[];var s,a=0,c=[],f=[];function g(y){var v=[y],T=[y];for(p[y]=l[y]=a,e[y]=!0,a+=1;T.length>0;){y=T[T.length-1];var w=t[y];if(o[y]<w.length){for(var A=o[y];A<w.length;++A){var E=w[A];if(p[E]<0){p[E]=l[E]=a,e[E]=!0,a+=1,v.push(E),T.push(E);break}e[E]&&(l[y]=0|Math.min(l[y],l[E])),r[E]>=0&&i[y].push(r[E])}o[y]=A}else{if(l[y]===p[y]){var M=[],b=[],_=0;for(A=v.length-1;A>=0;--A){var S=v[A];if(e[S]=!1,M.push(S),b.push(i[S]),_+=i[S].length,r[S]=c.length,S===y){v.length=A;break}}c.push(M);var C=new Array(_);for(A=0;A<b.length;A++)for(var k=0;k<b[A].length;k++)C[--_]=b[A][k];f.push(C)}T.pop()}}}for(u=0;u<h;++u)p[u]<0&&g(u);for(u=0;u<f.length;u++){var d=f[u];if(d.length!==0){d.sort(function(y,v){return y-v}),s=[d[0]];for(var m=1;m<d.length;m++)d[m]!==d[m-1]&&s.push(d[m]);f[u]=s}}return{components:c,adjacencyList:f}}},{}],570:[function(n,z,q){"use strict";z.exports=function(e,o){if(e.dimension<=0)return{positions:[],cells:[]};if(e.dimension===1)return function(u,s){for(var a=p(u,s),c=a.length,f=new Array(c),g=new Array(c),d=0;d<c;++d)f[d]=[a[d]],g[d]=[d];return{positions:f,cells:g}}(e,o);var r=e.order.join()+"-"+e.dtype,i=l[r];return o=+o||0,i||(i=l[r]=function(u,s){var a=u.length,c=["'use strict';"],f="surfaceNets"+u.join("_")+"d"+s;c.push("var contour=genContour({","order:[",u.join(),"],","scalarArguments: 3,","phase:function phaseFunc(p,a,b,c) { return (p > c)|0 },"),s==="generic"&&c.push("getters:[0],");for(var g=[],d=[],m=0;m<a;++m)g.push("d"+m),d.push("d"+m);for(m=0;m<1<<a;++m)g.push("v"+m),d.push("v"+m);for(m=0;m<1<<a;++m)g.push("p"+m),d.push("p"+m);g.push("a","b","c"),d.push("a","c"),c.push("vertex:function vertexFunc(",g.join(),"){");var y=[];for(m=0;m<1<<a;++m)y.push("(p"+m+"<<"+m+")");c.push("var m=(",y.join("+"),")|0;if(m===0||m===",(1<<(1<<a))-1,"){return}");var v=[],T=[];for(1<<(1<<a)<=128?(c.push("switch(m){"),T=c):c.push("switch(m>>>7){"),m=0;m<1<<(1<<a);++m){if(1<<(1<<a)>128&&m%128==0){v.length>0&&T.push("}}");var w="vExtra"+v.length;c.push("case ",m>>>7,":",w,"(m&0x7f,",d.join(),");break;"),T=["function ",w,"(m,",d.join(),"){switch(m){"],v.push(T)}T.push("case ",127&m,":");for(var A=new Array(a),E=new Array(a),M=new Array(a),b=new Array(a),_=0,S=0;S<a;++S)A[S]=[],E[S]=[],M[S]=0,b[S]=0;for(S=0;S<1<<a;++S)for(var C=0;C<a;++C){var k=S^1<<C;if(!(k>S)&&!(m&1<<k)!=!(m&1<<S)){var L=1;m&1<<k?E[C].push("v"+k+"-v"+S):(E[C].push("v"+S+"-v"+k),L=-L),L<0?(A[C].push("-v"+S+"-v"+k),M[C]+=2):(A[C].push("v"+S+"+v"+k),M[C]-=2),_+=1;for(var I=0;I<a;++I)I!==C&&(k&1<<I?b[I]+=1:b[I]-=1)}}var R=[];for(C=0;C<a;++C)if(A[C].length===0)R.push("d"+C+"-0.5");else{var V="";M[C]<0?V=M[C]+"*c":M[C]>0&&(V="+"+M[C]+"*c");var O=A[C].length/_*.5,J=.5+b[C]/_*.5;R.push("d"+C+"-"+J+"-"+O+"*("+A[C].join("+")+V+")/("+E[C].join("+")+")")}T.push("a.push([",R.join(),"]);","break;")}c.push("}},"),v.length>0&&T.push("}}");var D=[];for(m=0;m<1<<a-1;++m)D.push("v"+m);D.push("c0","c1","p0","p1","a","b","c"),c.push("cell:function cellFunc(",D.join(),"){");var B=h(a-1);for(c.push("if(p0){b.push(",B.map(function(N){return"["+N.map(function(F){return"v"+F})+"]"}).join(),")}else{b.push(",B.map(function(N){var F=N.slice();return F.reverse(),"["+F.map(function(H){return"v"+H})+"]"}).join(),")}}});function ",f,"(array,level){var verts=[],cells=[];contour(array,verts,cells,level);return {positions:verts,cells:cells};} return ",f,";"),m=0;m<v.length;++m)c.push(v[m].join(""));return new Function("genContour",c.join(""))(t)}(e.order,e.dtype)),i(e,o)};var t=n("ndarray-extract-contour"),h=n("triangulate-hypercube"),p=n("zero-crossings"),l={}},{"ndarray-extract-contour":487,"triangulate-hypercube":580,"zero-crossings":624}],571:[function(n,z,q){"use strict";Object.defineProperty(q,"__esModule",{value:!0});var t=function(o,r){if(Array.isArray(o))return o;if(Symbol.iterator in Object(o))return function(i,u){var s=[],a=!0,c=!1,f=void 0;try{for(var g,d=i[Symbol.iterator]();!(a=(g=d.next()).done)&&(s.push(g.value),!u||s.length!==u);a=!0);}catch(m){c=!0,f=m}finally{try{!a&&d.return&&d.return()}finally{if(c)throw f}}return s}(o,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")},h=2*Math.PI,p=function(o,r,i,u,s,a,c){var f=o.x,g=o.y;return{x:u*(f*=r)-s*(g*=i)+a,y:s*f+u*g+c}},l=function(o,r){var i=r===1.5707963267948966?.551915024494:r===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(r/4),u=Math.cos(o),s=Math.sin(o),a=Math.cos(o+r),c=Math.sin(o+r);return[{x:u-s*i,y:s+u*i},{x:a+c*i,y:c-a*i},{x:a,y:c}]},e=function(o,r,i,u){var s=o*i+r*u;return s>1&&(s=1),s<-1&&(s=-1),(o*u-r*i<0?-1:1)*Math.acos(s)};q.default=function(o){var r=o.px,i=o.py,u=o.cx,s=o.cy,a=o.rx,c=o.ry,f=o.xAxisRotation,g=f===void 0?0:f,d=o.largeArcFlag,m=d===void 0?0:d,y=o.sweepFlag,v=y===void 0?0:y,T=[];if(a===0||c===0)return[];var w=Math.sin(g*h/360),A=Math.cos(g*h/360),E=A*(r-u)/2+w*(i-s)/2,M=-w*(r-u)/2+A*(i-s)/2;if(E===0&&M===0)return[];a=Math.abs(a),c=Math.abs(c);var b=Math.pow(E,2)/Math.pow(a,2)+Math.pow(M,2)/Math.pow(c,2);b>1&&(a*=Math.sqrt(b),c*=Math.sqrt(b));var _=function(J,D,B,N,F,H,j,G,W,Q,$,ee){var ie=Math.pow(F,2),ae=Math.pow(H,2),oe=Math.pow($,2),de=Math.pow(ee,2),le=ie*ae-ie*de-ae*oe;le<0&&(le=0),le/=ie*de+ae*oe;var fe=(le=Math.sqrt(le)*(j===G?-1:1))*F/H*ee,ue=le*-H/F*$,we=Q*fe-W*ue+(J+B)/2,Ae=W*fe+Q*ue+(D+N)/2,Se=($-fe)/F,ke=(ee-ue)/H,Me=(-$-fe)/F,ve=(-ee-ue)/H,ge=e(1,0,Se,ke),De=e(Se,ke,Me,ve);return G===0&&De>0&&(De-=h),G===1&&De<0&&(De+=h),[we,Ae,ge,De]}(r,i,u,s,a,c,m,v,w,A,E,M),S=t(_,4),C=S[0],k=S[1],L=S[2],I=S[3],R=Math.abs(I)/(h/4);Math.abs(1-R)<1e-7&&(R=1);var V=Math.max(Math.ceil(R),1);I/=V;for(var O=0;O<V;O++)T.push(l(L,I)),L+=I;return T.map(function(J){var D=p(J[0],a,c,A,w,C,k),B=D.x,N=D.y,F=p(J[1],a,c,A,w,C,k),H=F.x,j=F.y,G=p(J[2],a,c,A,w,C,k);return{x1:B,y1:N,x2:H,y2:j,x:G.x,y:G.y}})},z.exports=q.default},{}],572:[function(n,z,q){"use strict";var t=n("parse-svg-path"),h=n("abs-svg-path"),p=n("normalize-svg-path"),l=n("is-svg-path"),e=n("assert");z.exports=function(o){if(Array.isArray(o)&&o.length===1&&typeof o[0]=="string"&&(o=o[0]),typeof o=="string"&&(e(l(o),"String is not an SVG path."),o=t(o)),e(Array.isArray(o),"Argument should be a string or an array of path segments."),o=h(o),!(o=p(o)).length)return[0,0,0,0];for(var r=[1/0,1/0,-1/0,-1/0],i=0,u=o.length;i<u;i++)for(var s=o[i].slice(1),a=0;a<s.length;a+=2)s[a+0]<r[0]&&(r[0]=s[a+0]),s[a+1]<r[1]&&(r[1]=s[a+1]),s[a+0]>r[2]&&(r[2]=s[a+0]),s[a+1]>r[3]&&(r[3]=s[a+1]);return r}},{"abs-svg-path":65,assert:73,"is-svg-path":471,"normalize-svg-path":573,"parse-svg-path":505}],573:[function(n,z,q){"use strict";z.exports=function(l){for(var e,o=[],r=0,i=0,u=0,s=0,a=null,c=null,f=0,g=0,d=0,m=l.length;d<m;d++){var y=l[d],v=y[0];switch(v){case"M":u=y[1],s=y[2];break;case"A":var T=t({px:f,py:g,cx:y[6],cy:y[7],rx:y[1],ry:y[2],xAxisRotation:y[3],largeArcFlag:y[4],sweepFlag:y[5]});if(!T.length)continue;for(var w,A=0;A<T.length;A++)w=T[A],y=["C",w.x1,w.y1,w.x2,w.y2,w.x,w.y],A<T.length-1&&o.push(y);break;case"S":var E=f,M=g;e!="C"&&e!="S"||(E+=E-r,M+=M-i),y=["C",E,M,y[1],y[2],y[3],y[4]];break;case"T":e=="Q"||e=="T"?(a=2*f-a,c=2*g-c):(a=f,c=g),y=p(f,g,a,c,y[1],y[2]);break;case"Q":a=y[1],c=y[2],y=p(f,g,y[1],y[2],y[3],y[4]);break;case"L":y=h(f,g,y[1],y[2]);break;case"H":y=h(f,g,y[1],g);break;case"V":y=h(f,g,f,y[1]);break;case"Z":y=h(f,g,u,s)}e=v,f=y[y.length-2],g=y[y.length-1],y.length>4?(r=y[y.length-4],i=y[y.length-3]):(r=f,i=g),o.push(y)}return o};var t=n("svg-arc-to-cubic-bezier");function h(l,e,o,r){return["C",l,e,o,r,o,r]}function p(l,e,o,r,i,u){return["C",l/3+2/3*o,e/3+2/3*r,i/3+2/3*o,u/3+2/3*r,i,u]}},{"svg-arc-to-cubic-bezier":571}],574:[function(n,z,q){"use strict";var t,h=n("svg-path-bounds"),p=n("parse-svg-path"),l=n("draw-svg-path"),e=n("is-svg-path"),o=n("bitmap-sdf"),r=document.createElement("canvas"),i=r.getContext("2d");z.exports=function(u,s){if(!e(u))throw Error("Argument should be valid svg path string");s||(s={});var a,c;s.shape?(a=s.shape[0],c=s.shape[1]):(a=r.width=s.w||s.width||200,c=r.height=s.h||s.height||200);var f=Math.min(a,c),g=s.stroke||0,d=s.viewbox||s.viewBox||h(u),m=[a/(d[2]-d[0]),c/(d[3]-d[1])],y=Math.min(m[0]||0,m[1]||0)/2;if(i.fillStyle="black",i.fillRect(0,0,a,c),i.fillStyle="white",g&&(typeof g!="number"&&(g=1),i.strokeStyle=g>0?"white":"black",i.lineWidth=Math.abs(g)),i.translate(.5*a,.5*c),i.scale(y,y),function(){if(t!=null)return t;var w=document.createElement("canvas").getContext("2d");if(w.canvas.width=w.canvas.height=1,!window.Path2D)return t=!1;var A=new Path2D("M0,0h1v1h-1v-1Z");w.fillStyle="black",w.fill(A);var E=w.getImageData(0,0,1,1);return t=E&&E.data&&E.data[3]===255}()){var v=new Path2D(u);i.fill(v),g&&i.stroke(v)}else{var T=p(u);l(i,T),i.fill(),g&&i.stroke()}return i.setTransform(1,0,0,1,0,0),o(i,{cutoff:s.cutoff!=null?s.cutoff:.5,radius:s.radius!=null?s.radius:.5*f})}},{"bitmap-sdf":98,"draw-svg-path":174,"is-svg-path":471,"parse-svg-path":505,"svg-path-bounds":572}],575:[function(n,z,q){(function(t){(function(){"use strict";z.exports=function e(o,r,i){i=i||{};var u=l[o];u||(u=l[o]={" ":{data:new Float32Array(0),shape:.2}});var s=u[r];if(!s)if(r.length<=1||!/\d/.test(r))s=u[r]=function(A){for(var E=A.cells,M=A.positions,b=new Float32Array(6*E.length),_=0,S=0,C=0;C<E.length;++C)for(var k=E[C],L=0;L<3;++L){var I=M[k[L]];b[_++]=I[0],b[_++]=I[1]+1.4,S=Math.max(I[0],S)}return{data:b,shape:S}}(h(r,{triangles:!0,font:o,textAlign:i.textAlign||"left",textBaseline:"alphabetic",styletags:{breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0}}));else{for(var a=r.split(/(\d|\s)/),c=new Array(a.length),f=0,g=0,d=0;d<a.length;++d)c[d]=e(o,a[d]),f+=c[d].data.length,g+=c[d].shape,d>0&&(g+=.02);var m=new Float32Array(f),y=0,v=-.5*g;for(d=0;d<c.length;++d){for(var T=c[d].data,w=0;w<T.length;w+=2)m[y++]=T[w]+v,m[y++]=T[w+1];v+=c[d].shape+.02}s=u[r]={data:m,shape:g}}return s};var h=n("vectorize-text"),p=window||t.global||{},l=p.__TEXT_CACHE||{};p.__TEXT_CACHE={}}).call(this)}).call(this,n("_process"))},{_process:526,"vectorize-text":600}],576:[function(n,z,q){(function(t){var h=/^\s+/,p=/\s+$/,l=0,e=t.round,o=t.min,r=t.max,i=t.random;function u(W,Q){if(Q=Q||{},(W=W||"")instanceof u)return W;if(!(this instanceof u))return new u(W,Q);var $=function(ee){var ie={r:0,g:0,b:0},ae=1,oe=null,de=null,le=null,fe=!1,ue=!1;typeof ee=="string"&&(ee=function(ke){ke=ke.replace(h,"").replace(p,"").toLowerCase();var Me,ve=!1;if(C[ke])ke=C[ke],ve=!0;else if(ke=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};return(Me=j.rgb.exec(ke))?{r:Me[1],g:Me[2],b:Me[3]}:(Me=j.rgba.exec(ke))?{r:Me[1],g:Me[2],b:Me[3],a:Me[4]}:(Me=j.hsl.exec(ke))?{h:Me[1],s:Me[2],l:Me[3]}:(Me=j.hsla.exec(ke))?{h:Me[1],s:Me[2],l:Me[3],a:Me[4]}:(Me=j.hsv.exec(ke))?{h:Me[1],s:Me[2],v:Me[3]}:(Me=j.hsva.exec(ke))?{h:Me[1],s:Me[2],v:Me[3],a:Me[4]}:(Me=j.hex8.exec(ke))?{r:V(Me[1]),g:V(Me[2]),b:V(Me[3]),a:B(Me[4]),format:ve?"name":"hex8"}:(Me=j.hex6.exec(ke))?{r:V(Me[1]),g:V(Me[2]),b:V(Me[3]),format:ve?"name":"hex"}:(Me=j.hex4.exec(ke))?{r:V(Me[1]+""+Me[1]),g:V(Me[2]+""+Me[2]),b:V(Me[3]+""+Me[3]),a:B(Me[4]+""+Me[4]),format:ve?"name":"hex8"}:(Me=j.hex3.exec(ke))?{r:V(Me[1]+""+Me[1]),g:V(Me[2]+""+Me[2]),b:V(Me[3]+""+Me[3]),format:ve?"name":"hex"}:!1}(ee)),typeof ee=="object"&&(G(ee.r)&&G(ee.g)&&G(ee.b)?(we=ee.r,Ae=ee.g,Se=ee.b,ie={r:255*I(we,255),g:255*I(Ae,255),b:255*I(Se,255)},fe=!0,ue=String(ee.r).substr(-1)==="%"?"prgb":"rgb"):G(ee.h)&&G(ee.s)&&G(ee.v)?(oe=J(ee.s),de=J(ee.v),ie=function(ke,Me,ve){ke=6*I(ke,360),Me=I(Me,100),ve=I(ve,100);var ge=t.floor(ke),De=ke-ge,_e=ve*(1-Me),Pe=ve*(1-De*Me),Fe=ve*(1-(1-De)*Me),ze=ge%6;return{r:255*[ve,Pe,_e,_e,Fe,ve][ze],g:255*[Fe,ve,ve,Pe,_e,_e][ze],b:255*[_e,_e,Fe,ve,ve,Pe][ze]}}(ee.h,oe,de),fe=!0,ue="hsv"):G(ee.h)&&G(ee.s)&&G(ee.l)&&(oe=J(ee.s),le=J(ee.l),ie=function(ke,Me,ve){var ge,De,_e;function Pe(He,et,Re){return Re<0&&(Re+=1),Re>1&&(Re-=1),Re<1/6?He+6*(et-He)*Re:Re<.5?et:Re<2/3?He+(et-He)*(2/3-Re)*6:He}if(ke=I(ke,360),Me=I(Me,100),ve=I(ve,100),Me===0)ge=De=_e=ve;else{var Fe=ve<.5?ve*(1+Me):ve+Me-ve*Me,ze=2*ve-Fe;ge=Pe(ze,Fe,ke+1/3),De=Pe(ze,Fe,ke),_e=Pe(ze,Fe,ke-1/3)}return{r:255*ge,g:255*De,b:255*_e}}(ee.h,oe,le),fe=!0,ue="hsl"),ee.hasOwnProperty("a")&&(ae=ee.a));var we,Ae,Se;return ae=L(ae),{ok:fe,format:ee.format||ue,r:o(255,r(ie.r,0)),g:o(255,r(ie.g,0)),b:o(255,r(ie.b,0)),a:ae}}(W);this._originalInput=W,this._r=$.r,this._g=$.g,this._b=$.b,this._a=$.a,this._roundA=e(100*this._a)/100,this._format=Q.format||$.format,this._gradientType=Q.gradientType,this._r<1&&(this._r=e(this._r)),this._g<1&&(this._g=e(this._g)),this._b<1&&(this._b=e(this._b)),this._ok=$.ok,this._tc_id=l++}function s(W,Q,$){W=I(W,255),Q=I(Q,255),$=I($,255);var ee,ie,ae=r(W,Q,$),oe=o(W,Q,$),de=(ae+oe)/2;if(ae==oe)ee=ie=0;else{var le=ae-oe;switch(ie=de>.5?le/(2-ae-oe):le/(ae+oe),ae){case W:ee=(Q-$)/le+(Q<$?6:0);break;case Q:ee=($-W)/le+2;break;case $:ee=(W-Q)/le+4}ee/=6}return{h:ee,s:ie,l:de}}function a(W,Q,$){W=I(W,255),Q=I(Q,255),$=I($,255);var ee,ie,ae=r(W,Q,$),oe=o(W,Q,$),de=ae,le=ae-oe;if(ie=ae===0?0:le/ae,ae==oe)ee=0;else{switch(ae){case W:ee=(Q-$)/le+(Q<$?6:0);break;case Q:ee=($-W)/le+2;break;case $:ee=(W-Q)/le+4}ee/=6}return{h:ee,s:ie,v:de}}function c(W,Q,$,ee){var ie=[O(e(W).toString(16)),O(e(Q).toString(16)),O(e($).toString(16))];return ee&&ie[0].charAt(0)==ie[0].charAt(1)&&ie[1].charAt(0)==ie[1].charAt(1)&&ie[2].charAt(0)==ie[2].charAt(1)?ie[0].charAt(0)+ie[1].charAt(0)+ie[2].charAt(0):ie.join("")}function f(W,Q,$,ee){return[O(D(ee)),O(e(W).toString(16)),O(e(Q).toString(16)),O(e($).toString(16))].join("")}function g(W,Q){Q=Q===0?0:Q||10;var $=u(W).toHsl();return $.s-=Q/100,$.s=R($.s),u($)}function d(W,Q){Q=Q===0?0:Q||10;var $=u(W).toHsl();return $.s+=Q/100,$.s=R($.s),u($)}function m(W){return u(W).desaturate(100)}function y(W,Q){Q=Q===0?0:Q||10;var $=u(W).toHsl();return $.l+=Q/100,$.l=R($.l),u($)}function v(W,Q){Q=Q===0?0:Q||10;var $=u(W).toRgb();return $.r=r(0,o(255,$.r-e(-Q/100*255))),$.g=r(0,o(255,$.g-e(-Q/100*255))),$.b=r(0,o(255,$.b-e(-Q/100*255))),u($)}function T(W,Q){Q=Q===0?0:Q||10;var $=u(W).toHsl();return $.l-=Q/100,$.l=R($.l),u($)}function w(W,Q){var $=u(W).toHsl(),ee=($.h+Q)%360;return $.h=ee<0?360+ee:ee,u($)}function A(W){var Q=u(W).toHsl();return Q.h=(Q.h+180)%360,u(Q)}function E(W){var Q=u(W).toHsl(),$=Q.h;return[u(W),u({h:($+120)%360,s:Q.s,l:Q.l}),u({h:($+240)%360,s:Q.s,l:Q.l})]}function M(W){var Q=u(W).toHsl(),$=Q.h;return[u(W),u({h:($+90)%360,s:Q.s,l:Q.l}),u({h:($+180)%360,s:Q.s,l:Q.l}),u({h:($+270)%360,s:Q.s,l:Q.l})]}function b(W){var Q=u(W).toHsl(),$=Q.h;return[u(W),u({h:($+72)%360,s:Q.s,l:Q.l}),u({h:($+216)%360,s:Q.s,l:Q.l})]}function _(W,Q,$){Q=Q||6,$=$||30;var ee=u(W).toHsl(),ie=360/$,ae=[u(W)];for(ee.h=(ee.h-(ie*Q>>1)+720)%360;--Q;)ee.h=(ee.h+ie)%360,ae.push(u(ee));return ae}function S(W,Q){Q=Q||6;for(var $=u(W).toHsv(),ee=$.h,ie=$.s,ae=$.v,oe=[],de=1/Q;Q--;)oe.push(u({h:ee,s:ie,v:ae})),ae=(ae+de)%1;return oe}u.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var W=this.toRgb();return(299*W.r+587*W.g+114*W.b)/1e3},getLuminance:function(){var W,Q,$,ee=this.toRgb();return W=ee.r/255,Q=ee.g/255,$=ee.b/255,.2126*(W<=.03928?W/12.92:t.pow((W+.055)/1.055,2.4))+.7152*(Q<=.03928?Q/12.92:t.pow((Q+.055)/1.055,2.4))+.0722*($<=.03928?$/12.92:t.pow(($+.055)/1.055,2.4))},setAlpha:function(W){return this._a=L(W),this._roundA=e(100*this._a)/100,this},toHsv:function(){var W=a(this._r,this._g,this._b);return{h:360*W.h,s:W.s,v:W.v,a:this._a}},toHsvString:function(){var W=a(this._r,this._g,this._b),Q=e(360*W.h),$=e(100*W.s),ee=e(100*W.v);return this._a==1?"hsv("+Q+", "+$+"%, "+ee+"%)":"hsva("+Q+", "+$+"%, "+ee+"%, "+this._roundA+")"},toHsl:function(){var W=s(this._r,this._g,this._b);return{h:360*W.h,s:W.s,l:W.l,a:this._a}},toHslString:function(){var W=s(this._r,this._g,this._b),Q=e(360*W.h),$=e(100*W.s),ee=e(100*W.l);return this._a==1?"hsl("+Q+", "+$+"%, "+ee+"%)":"hsla("+Q+", "+$+"%, "+ee+"%, "+this._roundA+")"},toHex:function(W){return c(this._r,this._g,this._b,W)},toHexString:function(W){return"#"+this.toHex(W)},toHex8:function(W){return function(Q,$,ee,ie,ae){var oe=[O(e(Q).toString(16)),O(e($).toString(16)),O(e(ee).toString(16)),O(D(ie))];return ae&&oe[0].charAt(0)==oe[0].charAt(1)&&oe[1].charAt(0)==oe[1].charAt(1)&&oe[2].charAt(0)==oe[2].charAt(1)&&oe[3].charAt(0)==oe[3].charAt(1)?oe[0].charAt(0)+oe[1].charAt(0)+oe[2].charAt(0)+oe[3].charAt(0):oe.join("")}(this._r,this._g,this._b,this._a,W)},toHex8String:function(W){return"#"+this.toHex8(W)},toRgb:function(){return{r:e(this._r),g:e(this._g),b:e(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+e(this._r)+", "+e(this._g)+", "+e(this._b)+")":"rgba("+e(this._r)+", "+e(this._g)+", "+e(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:e(100*I(this._r,255))+"%",g:e(100*I(this._g,255))+"%",b:e(100*I(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+e(100*I(this._r,255))+"%, "+e(100*I(this._g,255))+"%, "+e(100*I(this._b,255))+"%)":"rgba("+e(100*I(this._r,255))+"%, "+e(100*I(this._g,255))+"%, "+e(100*I(this._b,255))+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":!(this._a<1)&&(k[c(this._r,this._g,this._b,!0)]||!1)},toFilter:function(W){var Q="#"+f(this._r,this._g,this._b,this._a),$=Q,ee=this._gradientType?"GradientType = 1, ":"";if(W){var ie=u(W);$="#"+f(ie._r,ie._g,ie._b,ie._a)}return"progid:DXImageTransform.Microsoft.gradient("+ee+"startColorstr="+Q+",endColorstr="+$+")"},toString:function(W){var Q=!!W;W=W||this._format;var $=!1,ee=this._a<1&&this._a>=0;return Q||!ee||W!=="hex"&&W!=="hex6"&&W!=="hex3"&&W!=="hex4"&&W!=="hex8"&&W!=="name"?(W==="rgb"&&($=this.toRgbString()),W==="prgb"&&($=this.toPercentageRgbString()),W!=="hex"&&W!=="hex6"||($=this.toHexString()),W==="hex3"&&($=this.toHexString(!0)),W==="hex4"&&($=this.toHex8String(!0)),W==="hex8"&&($=this.toHex8String()),W==="name"&&($=this.toName()),W==="hsl"&&($=this.toHslString()),W==="hsv"&&($=this.toHsvString()),$||this.toHexString()):W==="name"&&this._a===0?this.toName():this.toRgbString()},clone:function(){return u(this.toString())},_applyModification:function(W,Q){var $=W.apply(null,[this].concat([].slice.call(Q)));return this._r=$._r,this._g=$._g,this._b=$._b,this.setAlpha($._a),this},lighten:function(){return this._applyModification(y,arguments)},brighten:function(){return this._applyModification(v,arguments)},darken:function(){return this._applyModification(T,arguments)},desaturate:function(){return this._applyModification(g,arguments)},saturate:function(){return this._applyModification(d,arguments)},greyscale:function(){return this._applyModification(m,arguments)},spin:function(){return this._applyModification(w,arguments)},_applyCombination:function(W,Q){return W.apply(null,[this].concat([].slice.call(Q)))},analogous:function(){return this._applyCombination(_,arguments)},complement:function(){return this._applyCombination(A,arguments)},monochromatic:function(){return this._applyCombination(S,arguments)},splitcomplement:function(){return this._applyCombination(b,arguments)},triad:function(){return this._applyCombination(E,arguments)},tetrad:function(){return this._applyCombination(M,arguments)}},u.fromRatio=function(W,Q){if(typeof W=="object"){var $={};for(var ee in W)W.hasOwnProperty(ee)&&($[ee]=ee==="a"?W[ee]:J(W[ee]));W=$}return u(W,Q)},u.equals=function(W,Q){return!(!W||!Q)&&u(W).toRgbString()==u(Q).toRgbString()},u.random=function(){return u.fromRatio({r:i(),g:i(),b:i()})},u.mix=function(W,Q,$){$=$===0?0:$||50;var ee=u(W).toRgb(),ie=u(Q).toRgb(),ae=$/100;return u({r:(ie.r-ee.r)*ae+ee.r,g:(ie.g-ee.g)*ae+ee.g,b:(ie.b-ee.b)*ae+ee.b,a:(ie.a-ee.a)*ae+ee.a})},u.readability=function(W,Q){var $=u(W),ee=u(Q);return(t.max($.getLuminance(),ee.getLuminance())+.05)/(t.min($.getLuminance(),ee.getLuminance())+.05)},u.isReadable=function(W,Q,$){var ee,ie,ae=u.readability(W,Q);switch(ie=!1,(ee=function(oe){var de,le;return de=((oe=oe||{level:"AA",size:"small"}).level||"AA").toUpperCase(),le=(oe.size||"small").toLowerCase(),de!=="AA"&&de!=="AAA"&&(de="AA"),le!=="small"&&le!=="large"&&(le="small"),{level:de,size:le}}($)).level+ee.size){case"AAsmall":case"AAAlarge":ie=ae>=4.5;break;case"AAlarge":ie=ae>=3;break;case"AAAsmall":ie=ae>=7}return ie},u.mostReadable=function(W,Q,$){var ee,ie,ae,oe,de=null,le=0;ie=($=$||{}).includeFallbackColors,ae=$.level,oe=$.size;for(var fe=0;fe<Q.length;fe++)(ee=u.readability(W,Q[fe]))>le&&(le=ee,de=u(Q[fe]));return u.isReadable(W,de,{level:ae,size:oe})||!ie?de:($.includeFallbackColors=!1,u.mostReadable(W,["#fff","#000"],$))};var C=u.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},k=u.hexNames=function(W){var Q={};for(var $ in W)W.hasOwnProperty($)&&(Q[W[$]]=$);return Q}(C);function L(W){return W=parseFloat(W),(isNaN(W)||W<0||W>1)&&(W=1),W}function I(W,Q){(function(ee){return typeof ee=="string"&&ee.indexOf(".")!=-1&&parseFloat(ee)===1})(W)&&(W="100%");var $=function(ee){return typeof ee=="string"&&ee.indexOf("%")!=-1}(W);return W=o(Q,r(0,parseFloat(W))),$&&(W=parseInt(W*Q,10)/100),t.abs(W-Q)<1e-6?1:W%Q/parseFloat(Q)}function R(W){return o(1,r(0,W))}function V(W){return parseInt(W,16)}function O(W){return W.length==1?"0"+W:""+W}function J(W){return W<=1&&(W=100*W+"%"),W}function D(W){return t.round(255*parseFloat(W)).toString(16)}function B(W){return V(W)/255}var N,F,H,j=(F="[\\s|\\(]+("+(N="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)")+")[,|\\s]+("+N+")[,|\\s]+("+N+")\\s*\\)?",H="[\\s|\\(]+("+N+")[,|\\s]+("+N+")[,|\\s]+("+N+")[,|\\s]+("+N+")\\s*\\)?",{CSS_UNIT:new RegExp(N),rgb:new RegExp("rgb"+F),rgba:new RegExp("rgba"+H),hsl:new RegExp("hsl"+F),hsla:new RegExp("hsla"+H),hsv:new RegExp("hsv"+F),hsva:new RegExp("hsva"+H),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/});function G(W){return!!j.CSS_UNIT.exec(W)}typeof z<"u"&&z.exports?z.exports=u:window.tinycolor=u})(Math)},{}],577:[function(n,z,q){"use strict";z.exports=h,z.exports.float32=z.exports.float=h,z.exports.fract32=z.exports.fract=function(p){if(p.length){for(var l=h(p),e=0,o=l.length;e<o;e++)l[e]=p[e]-l[e];return l}return h(p-h(p))};var t=new Float32Array(1);function h(p){if(p.length){if(p instanceof Float32Array)return p;var l=new Float32Array(p);return l.set(p),l}return t[0]=p,t[0]}},{}],578:[function(n,z,q){"use strict";var t=n("parse-unit");z.exports=p;function h(l,e){var o=t(getComputedStyle(l).getPropertyValue(e));return o[0]*p(o[1],l)}function p(l,e){switch(e=e||document.body,l=(l||"px").trim().toLowerCase(),e!==window&&e!==document||(e=document.body),l){case"%":return e.clientHeight/100;case"ch":case"ex":return function(o,r){var i=document.createElement("div");i.style["font-size"]="128"+o,r.appendChild(i);var u=h(i,"font-size")/128;return r.removeChild(i),u}(l,e);case"em":return h(e,"font-size");case"rem":return h(document.body,"font-size");case"vw":return window.innerWidth/100;case"vh":return window.innerHeight/100;case"vmin":return Math.min(window.innerWidth,window.innerHeight)/100;case"vmax":return Math.max(window.innerWidth,window.innerHeight)/100;case"in":return 96;case"cm":return 96/2.54;case"mm":return 96/25.4;case"pt":return 96/72;case"pc":return 16}return 1}},{"parse-unit":506}],579:[function(n,z,q){(function(t,h){h(typeof q=="object"&&typeof z<"u"?q:(t=t||self).topojson=t.topojson||{})})(this,function(t){"use strict";function h(f){return f}function p(f){if(f==null)return h;var g,d,m=f.scale[0],y=f.scale[1],v=f.translate[0],T=f.translate[1];return function(w,A){A||(g=d=0);var E=2,M=w.length,b=new Array(M);for(b[0]=(g+=w[0])*m+v,b[1]=(d+=w[1])*y+T;E<M;)b[E]=w[E],++E;return b}}function l(f){var g,d=p(f.transform),m=1/0,y=m,v=-m,T=-m;function w(E){(E=d(E))[0]<m&&(m=E[0]),E[0]>v&&(v=E[0]),E[1]<y&&(y=E[1]),E[1]>T&&(T=E[1])}function A(E){switch(E.type){case"GeometryCollection":E.geometries.forEach(A);break;case"Point":w(E.coordinates);break;case"MultiPoint":E.coordinates.forEach(w)}}for(g in f.arcs.forEach(function(E){for(var M,b=-1,_=E.length;++b<_;)(M=d(E[b],b))[0]<m&&(m=M[0]),M[0]>v&&(v=M[0]),M[1]<y&&(y=M[1]),M[1]>T&&(T=M[1])}),f.objects)A(f.objects[g]);return[m,y,v,T]}function e(f,g){var d=g.id,m=g.bbox,y=g.properties==null?{}:g.properties,v=o(f,g);return d==null&&m==null?{type:"Feature",properties:y,geometry:v}:m==null?{type:"Feature",id:d,properties:y,geometry:v}:{type:"Feature",id:d,bbox:m,properties:y,geometry:v}}function o(f,g){var d=p(f.transform),m=f.arcs;function y(E,M){M.length&&M.pop();for(var b=m[E<0?~E:E],_=0,S=b.length;_<S;++_)M.push(d(b[_],_));E<0&&function(C,k){for(var L,I=C.length,R=I-k;R<--I;)L=C[R],C[R++]=C[I],C[I]=L}(M,S)}function v(E){return d(E)}function T(E){for(var M=[],b=0,_=E.length;b<_;++b)y(E[b],M);return M.length<2&&M.push(M[0]),M}function w(E){for(var M=T(E);M.length<4;)M.push(M[0]);return M}function A(E){return E.map(w)}return function E(M){var b,_=M.type;switch(_){case"GeometryCollection":return{type:_,geometries:M.geometries.map(E)};case"Point":b=v(M.coordinates);break;case"MultiPoint":b=M.coordinates.map(v);break;case"LineString":b=T(M.arcs);break;case"MultiLineString":b=M.arcs.map(T);break;case"Polygon":b=A(M.arcs);break;case"MultiPolygon":b=M.arcs.map(A);break;default:return null}return{type:_,coordinates:b}}(g)}function r(f,g){var d={},m={},y={},v=[],T=-1;function w(A,E){for(var M in A){var b=A[M];delete E[b.start],delete b.start,delete b.end,b.forEach(function(_){d[_<0?~_:_]=1}),v.push(b)}}return g.forEach(function(A,E){var M,b=f.arcs[A<0?~A:A];b.length<3&&!b[1][0]&&!b[1][1]&&(M=g[++T],g[T]=A,g[E]=M)}),g.forEach(function(A){var E,M,b=function(L){var I,R=f.arcs[L<0?~L:L],V=R[0];return f.transform?(I=[0,0],R.forEach(function(O){I[0]+=O[0],I[1]+=O[1]})):I=R[R.length-1],L<0?[I,V]:[V,I]}(A),_=b[0],S=b[1];if(E=y[_])if(delete y[E.end],E.push(A),E.end=S,M=m[S]){delete m[M.start];var C=M===E?E:E.concat(M);m[C.start=E.start]=y[C.end=M.end]=C}else m[E.start]=y[E.end]=E;else if(E=m[S])if(delete m[E.start],E.unshift(A),E.start=_,M=y[_]){delete y[M.end];var k=M===E?E:M.concat(E);m[k.start=M.start]=y[k.end=E.end]=k}else m[E.start]=y[E.end]=E;else m[(E=[A]).start=_]=y[E.end=S]=E}),w(y,m),w(m,y),g.forEach(function(A){d[A<0?~A:A]||v.push([A])}),v}function i(f,g,d){var m,y,v;if(arguments.length>1)m=u(f,g,d);else for(y=0,m=new Array(v=f.arcs.length);y<v;++y)m[y]=y;return{type:"MultiLineString",arcs:r(f,m)}}function u(f,g,d){var m,y=[],v=[];function T(E){var M=E<0?~E:E;(v[M]||(v[M]=[])).push({i:E,g:m})}function w(E){E.forEach(T)}function A(E){E.forEach(w)}return function E(M){switch(m=M,M.type){case"GeometryCollection":M.geometries.forEach(E);break;case"LineString":w(M.arcs);break;case"MultiLineString":case"Polygon":A(M.arcs);break;case"MultiPolygon":(function(b){b.forEach(A)})(M.arcs)}}(g),v.forEach(d==null?function(E){y.push(E[0].i)}:function(E){d(E[0].g,E[E.length-1].g)&&y.push(E[0].i)}),y}function s(f,g){var d={},m=[],y=[];function v(w){w.forEach(function(A){A.forEach(function(E){(d[E=E<0?~E:E]||(d[E]=[])).push(w)})}),m.push(w)}function T(w){return function(A){for(var E,M=-1,b=A.length,_=A[b-1],S=0;++M<b;)E=_,_=A[M],S+=E[0]*_[1]-E[1]*_[0];return Math.abs(S)}(o(f,{type:"Polygon",arcs:[w]}).coordinates[0])}return g.forEach(function w(A){switch(A.type){case"GeometryCollection":A.geometries.forEach(w);break;case"Polygon":v(A.arcs);break;case"MultiPolygon":A.arcs.forEach(v)}}),m.forEach(function(w){if(!w._){var A=[],E=[w];for(w._=1,y.push(A);w=E.pop();)A.push(w),w.forEach(function(M){M.forEach(function(b){d[b<0?~b:b].forEach(function(_){_._||(_._=1,E.push(_))})})})}}),m.forEach(function(w){delete w._}),{type:"MultiPolygon",arcs:y.map(function(w){var A,E=[];if(w.forEach(function(C){C.forEach(function(k){k.forEach(function(L){d[L<0?~L:L].length<2&&E.push(L)})})}),(A=(E=r(f,E)).length)>1)for(var M,b,_=1,S=T(E[0]);_<A;++_)(M=T(E[_]))>S&&(b=E[0],E[0]=E[_],E[_]=b,S=M);return E}).filter(function(w){return w.length>0})}}function a(f,g){for(var d=0,m=f.length;d<m;){var y=d+m>>>1;f[y]<g?d=y+1:m=y}return d}function c(f){if(f==null)return h;var g,d,m=f.scale[0],y=f.scale[1],v=f.translate[0],T=f.translate[1];return function(w,A){A||(g=d=0);var E=2,M=w.length,b=new Array(M),_=Math.round((w[0]-v)/m),S=Math.round((w[1]-T)/y);for(b[0]=_-g,g=_,b[1]=S-d,d=S;E<M;)b[E]=w[E],++E;return b}}t.bbox=l,t.feature=function(f,g){return typeof g=="string"&&(g=f.objects[g]),g.type==="GeometryCollection"?{type:"FeatureCollection",features:g.geometries.map(function(d){return e(f,d)})}:e(f,g)},t.merge=function(f){return o(f,s.apply(this,arguments))},t.mergeArcs=s,t.mesh=function(f){return o(f,i.apply(this,arguments))},t.meshArcs=i,t.neighbors=function(f){var g={},d=f.map(function(){return[]});function m(C,k){C.forEach(function(L){L<0&&(L=~L);var I=g[L];I?I.push(k):g[L]=[k]})}function y(C,k){C.forEach(function(L){m(L,k)})}var v={LineString:m,MultiLineString:y,Polygon:y,MultiPolygon:function(C,k){C.forEach(function(L){y(L,k)})}};for(var T in f.forEach(function C(k,L){k.type==="GeometryCollection"?k.geometries.forEach(function(I){C(I,L)}):k.type in v&&v[k.type](k.arcs,L)}),g)for(var w=g[T],A=w.length,E=0;E<A;++E)for(var M=E+1;M<A;++M){var b,_=w[E],S=w[M];(b=d[_])[T=a(b,S)]!==S&&b.splice(T,0,S),(b=d[S])[T=a(b,_)]!==_&&b.splice(T,0,_)}return d},t.quantize=function(f,g){if(f.transform)throw new Error("already quantized");if(g&&g.scale)w=f.bbox;else{if(!((d=Math.floor(g))>=2))throw new Error("n must be \u22652");var d,m=(w=f.bbox||l(f))[0],y=w[1],v=w[2],T=w[3];g={scale:[v-m?(v-m)/(d-1):1,T-y?(T-y)/(d-1):1],translate:[m,y]}}var w,A,E=c(g),M=f.objects,b={};function _(C){return E(C)}function S(C){var k;switch(C.type){case"GeometryCollection":k={type:"GeometryCollection",geometries:C.geometries.map(S)};break;case"Point":k={type:"Point",coordinates:_(C.coordinates)};break;case"MultiPoint":k={type:"MultiPoint",coordinates:C.coordinates.map(_)};break;default:return C}return C.id!=null&&(k.id=C.id),C.bbox!=null&&(k.bbox=C.bbox),C.properties!=null&&(k.properties=C.properties),k}for(A in M)b[A]=S(M[A]);return{type:"Topology",bbox:w,transform:g,objects:b,arcs:f.arcs.map(function(C){var k,L=0,I=1,R=C.length,V=new Array(R);for(V[0]=E(C[0],0);++L<R;)((k=E(C[L],L))[0]||k[1])&&(V[I++]=k);return I===1&&(V[I++]=[0,0]),V.length=I,V})}},t.transform=p,t.untransform=c,Object.defineProperty(t,"__esModule",{value:!0})})},{}],580:[function(n,z,q){"use strict";z.exports=function(l){if(l<0)return[];if(l===0)return[[0]];for(var e=0|Math.round(p(l+1)),o=[],r=0;r<e;++r){for(var i=t.unrank(l,r),u=[0],s=0,a=0;a<i.length;++a)s+=1<<i[a],u.push(s);h(i)<1&&(u[0]=s,u[l]=0),o.push(u)}return o};var t=n("permutation-rank"),h=n("permutation-parity"),p=n("gamma")},{gamma:248,"permutation-parity":509,"permutation-rank":510}],581:[function(n,z,q){"use strict";z.exports=function(f){var g=(f=f||{}).center||[0,0,0],d=f.up||[0,1,0],m=f.right||u(d),y=f.radius||1,v=f.theta||0,T=f.phi||0;if(g=[].slice.call(g,0,3),d=[].slice.call(d,0,3),e(d,d),m=[].slice.call(m,0,3),e(m,m),"eye"in f){var w=f.eye,A=[w[0]-g[0],w[1]-g[1],w[2]-g[2]];l(m,A,d),r(m[0],m[1],m[2])<1e-6?m=u(d):e(m,m),y=r(A[0],A[1],A[2]);var E=o(d,A)/y,M=o(m,A)/y;T=Math.acos(E),v=Math.acos(M)}return y=Math.log(y),new s(f.zoomMin,f.zoomMax,g,d,m,y,v,T)};var t=n("filtered-vector"),h=n("gl-mat4/invert"),p=n("gl-mat4/rotate"),l=n("gl-vec3/cross"),e=n("gl-vec3/normalize"),o=n("gl-vec3/dot");function r(f,g,d){return Math.sqrt(Math.pow(f,2)+Math.pow(g,2)+Math.pow(d,2))}function i(f){return Math.min(1,Math.max(-1,f))}function u(f){var g=Math.abs(f[0]),d=Math.abs(f[1]),m=Math.abs(f[2]),y=[0,0,0];g>Math.max(d,m)?y[2]=1:d>Math.max(g,m)?y[0]=1:y[1]=1;for(var v=0,T=0,w=0;w<3;++w)v+=f[w]*f[w],T+=y[w]*f[w];for(w=0;w<3;++w)y[w]-=T/v*f[w];return e(y,y),y}function s(f,g,d,m,y,v,T,w){this.center=t(d),this.up=t(m),this.right=t(y),this.radius=t([v]),this.angle=t([T,w]),this.angle.bounds=[[-1/0,-Math.PI/2],[1/0,Math.PI/2]],this.setDistanceLimits(f,g),this.computedCenter=this.center.curve(0),this.computedUp=this.up.curve(0),this.computedRight=this.right.curve(0),this.computedRadius=this.radius.curve(0),this.computedAngle=this.angle.curve(0),this.computedToward=[0,0,0],this.computedEye=[0,0,0],this.computedMatrix=new Array(16);for(var A=0;A<16;++A)this.computedMatrix[A]=.5;this.recalcMatrix(0)}var a=s.prototype;a.setDistanceLimits=function(f,g){f=f>0?Math.log(f):-1/0,g=g>0?Math.log(g):1/0,g=Math.max(g,f),this.radius.bounds[0][0]=f,this.radius.bounds[1][0]=g},a.getDistanceLimits=function(f){var g=this.radius.bounds[0];return f?(f[0]=Math.exp(g[0][0]),f[1]=Math.exp(g[1][0]),f):[Math.exp(g[0][0]),Math.exp(g[1][0])]},a.recalcMatrix=function(f){this.center.curve(f),this.up.curve(f),this.right.curve(f),this.radius.curve(f),this.angle.curve(f);for(var g=this.computedUp,d=this.computedRight,m=0,y=0,v=0;v<3;++v)y+=g[v]*d[v],m+=g[v]*g[v];var T=Math.sqrt(m),w=0;for(v=0;v<3;++v)d[v]-=g[v]*y/m,w+=d[v]*d[v],g[v]/=T;var A=Math.sqrt(w);for(v=0;v<3;++v)d[v]/=A;var E=this.computedToward;l(E,g,d),e(E,E);var M=Math.exp(this.computedRadius[0]),b=this.computedAngle[0],_=this.computedAngle[1],S=Math.cos(b),C=Math.sin(b),k=Math.cos(_),L=Math.sin(_),I=this.computedCenter,R=S*k,V=C*k,O=L,J=-S*L,D=-C*L,B=k,N=this.computedEye,F=this.computedMatrix;for(v=0;v<3;++v){var H=R*d[v]+V*E[v]+O*g[v];F[4*v+1]=J*d[v]+D*E[v]+B*g[v],F[4*v+2]=H,F[4*v+3]=0}var j=F[1],G=F[5],W=F[9],Q=F[2],$=F[6],ee=F[10],ie=G*ee-W*$,ae=W*Q-j*ee,oe=j*$-G*Q,de=r(ie,ae,oe);for(ie/=de,ae/=de,oe/=de,F[0]=ie,F[4]=ae,F[8]=oe,v=0;v<3;++v)N[v]=I[v]+F[2+4*v]*M;for(v=0;v<3;++v){w=0;for(var le=0;le<3;++le)w+=F[v+4*le]*N[le];F[12+v]=-w}F[15]=1},a.getMatrix=function(f,g){this.recalcMatrix(f);var d=this.computedMatrix;if(g){for(var m=0;m<16;++m)g[m]=d[m];return g}return d};var c=[0,0,0];a.rotate=function(f,g,d,m){if(this.angle.move(f,g,d),m){this.recalcMatrix(f);var y=this.computedMatrix;c[0]=y[2],c[1]=y[6],c[2]=y[10];for(var v=this.computedUp,T=this.computedRight,w=this.computedToward,A=0;A<3;++A)y[4*A]=v[A],y[4*A+1]=T[A],y[4*A+2]=w[A];for(p(y,y,m,c),A=0;A<3;++A)v[A]=y[4*A],T[A]=y[4*A+1];this.up.set(f,v[0],v[1],v[2]),this.right.set(f,T[0],T[1],T[2])}},a.pan=function(f,g,d,m){g=g||0,d=d||0,m=m||0,this.recalcMatrix(f);var y=this.computedMatrix,v=(Math.exp(this.computedRadius[0]),y[1]),T=y[5],w=y[9],A=r(v,T,w);v/=A,T/=A,w/=A;var E=y[0],M=y[4],b=y[8],_=E*v+M*T+b*w,S=r(E-=v*_,M-=T*_,b-=w*_),C=(E/=S)*g+v*d,k=(M/=S)*g+T*d,L=(b/=S)*g+w*d;this.center.move(f,C,k,L);var I=Math.exp(this.computedRadius[0]);I=Math.max(1e-4,I+m),this.radius.set(f,Math.log(I))},a.translate=function(f,g,d,m){this.center.move(f,g||0,d||0,m||0)},a.setMatrix=function(f,g,d,m){var y=1;typeof d=="number"&&(y=0|d),(y<0||y>3)&&(y=1);var v=(y+2)%3;g||(this.recalcMatrix(f),g=this.computedMatrix);var T=g[y],w=g[y+4],A=g[y+8];if(m){var E=Math.abs(T),M=Math.abs(w),b=Math.abs(A),_=Math.max(E,M,b);E===_?(T=T<0?-1:1,w=A=0):b===_?(A=A<0?-1:1,T=w=0):(w=w<0?-1:1,T=A=0)}else{var S=r(T,w,A);T/=S,w/=S,A/=S}var C,k,L=g[v],I=g[v+4],R=g[v+8],V=L*T+I*w+R*A,O=r(L-=T*V,I-=w*V,R-=A*V),J=w*(R/=O)-A*(I/=O),D=A*(L/=O)-T*R,B=T*I-w*L,N=r(J,D,B);if(J/=N,D/=N,B/=N,this.center.jump(f,Ae,Se,ke),this.radius.idle(f),this.up.jump(f,T,w,A),this.right.jump(f,L,I,R),y===2){var F=g[1],H=g[5],j=g[9],G=F*L+H*I+j*R,W=F*J+H*D+j*B;C=ie<0?-Math.PI/2:Math.PI/2,k=Math.atan2(W,G)}else{var Q=g[2],$=g[6],ee=g[10],ie=Q*T+$*w+ee*A,ae=Q*L+$*I+ee*R,oe=Q*J+$*D+ee*B;C=Math.asin(i(ie)),k=Math.atan2(oe,ae)}this.angle.jump(f,k,C),this.recalcMatrix(f);var de=g[2],le=g[6],fe=g[10],ue=this.computedMatrix;h(ue,g);var we=ue[15],Ae=ue[12]/we,Se=ue[13]/we,ke=ue[14]/we,Me=Math.exp(this.computedRadius[0]);this.center.jump(f,Ae-de*Me,Se-le*Me,ke-fe*Me)},a.lastT=function(){return Math.max(this.center.lastT(),this.up.lastT(),this.right.lastT(),this.radius.lastT(),this.angle.lastT())},a.idle=function(f){this.center.idle(f),this.up.idle(f),this.right.idle(f),this.radius.idle(f),this.angle.idle(f)},a.flush=function(f){this.center.flush(f),this.up.flush(f),this.right.flush(f),this.radius.flush(f),this.angle.flush(f)},a.setDistance=function(f,g){g>0&&this.radius.set(f,Math.log(g))},a.lookAt=function(f,g,d,m){this.recalcMatrix(f),g=g||this.computedEye,d=d||this.computedCenter;var y=(m=m||this.computedUp)[0],v=m[1],T=m[2],w=r(y,v,T);if(!(w<1e-6)){y/=w,v/=w,T/=w;var A=g[0]-d[0],E=g[1]-d[1],M=g[2]-d[2],b=r(A,E,M);if(!(b<1e-6)){A/=b,E/=b,M/=b;var _=this.computedRight,S=_[0],C=_[1],k=_[2],L=y*S+v*C+T*k,I=r(S-=L*y,C-=L*v,k-=L*T);if(!(I<.01&&(I=r(S=v*M-T*E,C=T*A-y*M,k=y*E-v*A))<1e-6)){S/=I,C/=I,k/=I,this.up.set(f,y,v,T),this.right.set(f,S,C,k),this.center.set(f,d[0],d[1],d[2]),this.radius.set(f,Math.log(b));var R=v*k-T*C,V=T*S-y*k,O=y*C-v*S,J=r(R,V,O),D=y*A+v*E+T*M,B=S*A+C*E+k*M,N=(R/=J)*A+(V/=J)*E+(O/=J)*M,F=Math.asin(i(D)),H=Math.atan2(N,B),j=this.angle._state,G=j[j.length-1],W=j[j.length-2];G%=2*Math.PI;var Q=Math.abs(G+2*Math.PI-H),$=Math.abs(G-H),ee=Math.abs(G-2*Math.PI-H);Q<$&&(G+=2*Math.PI),ee<$&&(G-=2*Math.PI),this.angle.jump(this.angle.lastT(),G,W),this.angle.set(f,H,F)}}}}},{"filtered-vector":242,"gl-mat4/invert":293,"gl-mat4/rotate":299,"gl-vec3/cross":365,"gl-vec3/dot":370,"gl-vec3/normalize":387}],582:[function(n,z,q){"use strict";z.exports=function(h,p,l){var e=h*p,o=t*h,r=o-(o-h),i=h-r,u=t*p,s=u-(u-p),a=p-s,c=i*a-(e-r*s-i*s-r*a);return l?(l[0]=c,l[1]=e,l):[c,e]};var t=+(Math.pow(2,27)+1)},{}],583:[function(n,z,q){"use strict";z.exports=function(t,h,p){var l=t+h,e=l-t,o=h-e,r=t-(l-e);return p?(p[0]=r+o,p[1]=l,p):[r+o,l]}},{}],584:[function(n,z,q){"use strict";var t=n("../prototype/is");z.exports=function(h){if(typeof h!="function"||!hasOwnProperty.call(h,"length"))return!1;try{if(typeof h.length!="number"||typeof h.call!="function"||typeof h.apply!="function")return!1}catch{return!1}return!t(h)}},{"../prototype/is":591}],585:[function(n,z,q){"use strict";var t=n("../value/is"),h=n("../object/is"),p=n("../string/coerce"),l=n("./to-short-string"),e=function(o,r){return o.replace("%v",l(r))};z.exports=function(o,r,i){if(!h(i))throw new TypeError(e(r,o));if(!t(o)){if("default"in i)return i.default;if(i.isOptional)return null}var u=p(i.errorMessage);throw t(u)||(u=r),new TypeError(e(u,o))}},{"../object/is":588,"../string/coerce":592,"../value/is":594,"./to-short-string":587}],586:[function(n,z,q){"use strict";z.exports=function(t){try{return t.toString()}catch{try{return String(t)}catch{return null}}}},{}],587:[function(n,z,q){"use strict";var t=n("./safe-to-string"),h=/[\n\r\u2028\u2029]/g;z.exports=function(p){var l=t(p);return l===null?"<Non-coercible to string value>":(l.length>100&&(l=l.slice(0,99)+"\u2026"),l=l.replace(h,function(e){switch(e){case`
`:return"\\n";case"\r":return"\\r";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw new Error("Unexpected character")}}))}},{"./safe-to-string":586}],588:[function(n,z,q){"use strict";var t=n("../value/is"),h={object:!0,function:!0,undefined:!0};z.exports=function(p){return!!t(p)&&hasOwnProperty.call(h,typeof p)}},{"../value/is":594}],589:[function(n,z,q){"use strict";var t=n("../lib/resolve-exception"),h=n("./is");z.exports=function(p){return h(p)?p:t(p,"%v is not a plain function",arguments[1])}},{"../lib/resolve-exception":585,"./is":590}],590:[function(n,z,q){"use strict";var t=n("../function/is"),h=/^\s*class[\s{/}]/,p=Function.prototype.toString;z.exports=function(l){return!!t(l)&&!h.test(p.call(l))}},{"../function/is":584}],591:[function(n,z,q){"use strict";var t=n("../object/is");z.exports=function(h){if(!t(h))return!1;try{return!!h.constructor&&h.constructor.prototype===h}catch{return!1}}},{"../object/is":588}],592:[function(n,z,q){"use strict";var t=n("../value/is"),h=n("../object/is"),p=Object.prototype.toString;z.exports=function(l){if(!t(l))return null;if(h(l)){var e=l.toString;if(typeof e!="function"||e===p)return null}try{return""+l}catch{return null}}},{"../object/is":588,"../value/is":594}],593:[function(n,z,q){"use strict";var t=n("../lib/resolve-exception"),h=n("./is");z.exports=function(p){return h(p)?p:t(p,"Cannot use %v",arguments[1])}},{"../lib/resolve-exception":585,"./is":594}],594:[function(n,z,q){"use strict";z.exports=function(t){return t!=null}},{}],595:[function(n,z,q){(function(t){(function(){"use strict";var h=n("bit-twiddle"),p=n("dup"),l=n("buffer").Buffer;t.__TYPEDARRAY_POOL||(t.__TYPEDARRAY_POOL={UINT8:p([32,0]),UINT16:p([32,0]),UINT32:p([32,0]),BIGUINT64:p([32,0]),INT8:p([32,0]),INT16:p([32,0]),INT32:p([32,0]),BIGINT64:p([32,0]),FLOAT:p([32,0]),DOUBLE:p([32,0]),DATA:p([32,0]),UINT8C:p([32,0]),BUFFER:p([32,0])});var e=typeof Uint8ClampedArray<"u",o=typeof BigUint64Array<"u",r=typeof BigInt64Array<"u",i=t.__TYPEDARRAY_POOL;i.UINT8C||(i.UINT8C=p([32,0])),i.BIGUINT64||(i.BIGUINT64=p([32,0])),i.BIGINT64||(i.BIGINT64=p([32,0])),i.BUFFER||(i.BUFFER=p([32,0]));var u=i.DATA,s=i.BUFFER;function a(S){if(S){var C=S.length||S.byteLength,k=h.log2(C);u[k].push(S)}}function c(S){S=h.nextPow2(S);var C=h.log2(S),k=u[C];return k.length>0?k.pop():new ArrayBuffer(S)}function f(S){return new Uint8Array(c(S),0,S)}function g(S){return new Uint16Array(c(2*S),0,S)}function d(S){return new Uint32Array(c(4*S),0,S)}function m(S){return new Int8Array(c(S),0,S)}function y(S){return new Int16Array(c(2*S),0,S)}function v(S){return new Int32Array(c(4*S),0,S)}function T(S){return new Float32Array(c(4*S),0,S)}function w(S){return new Float64Array(c(8*S),0,S)}function A(S){return e?new Uint8ClampedArray(c(S),0,S):f(S)}function E(S){return o?new BigUint64Array(c(8*S),0,S):null}function M(S){return r?new BigInt64Array(c(8*S),0,S):null}function b(S){return new DataView(c(S),0,S)}function _(S){S=h.nextPow2(S);var C=h.log2(S),k=s[C];return k.length>0?k.pop():new l(S)}q.free=function(S){if(l.isBuffer(S))s[h.log2(S.length)].push(S);else{if(Object.prototype.toString.call(S)!=="[object ArrayBuffer]"&&(S=S.buffer),!S)return;var C=S.length||S.byteLength,k=0|h.log2(C);u[k].push(S)}},q.freeUint8=q.freeUint16=q.freeUint32=q.freeBigUint64=q.freeInt8=q.freeInt16=q.freeInt32=q.freeBigInt64=q.freeFloat32=q.freeFloat=q.freeFloat64=q.freeDouble=q.freeUint8Clamped=q.freeDataView=function(S){a(S.buffer)},q.freeArrayBuffer=a,q.freeBuffer=function(S){s[h.log2(S.length)].push(S)},q.malloc=function(S,C){if(C===void 0||C==="arraybuffer")return c(S);switch(C){case"uint8":return f(S);case"uint16":return g(S);case"uint32":return d(S);case"int8":return m(S);case"int16":return y(S);case"int32":return v(S);case"float":case"float32":return T(S);case"double":case"float64":return w(S);case"uint8_clamped":return A(S);case"bigint64":return M(S);case"biguint64":return E(S);case"buffer":return _(S);case"data":case"dataview":return b(S);default:return null}return null},q.mallocArrayBuffer=c,q.mallocUint8=f,q.mallocUint16=g,q.mallocUint32=d,q.mallocInt8=m,q.mallocInt16=y,q.mallocInt32=v,q.mallocFloat32=q.mallocFloat=T,q.mallocFloat64=q.mallocDouble=w,q.mallocUint8Clamped=A,q.mallocBigUint64=E,q.mallocBigInt64=M,q.mallocDataView=b,q.mallocBuffer=_,q.clearCache=function(){for(var S=0;S<32;++S)i.UINT8[S].length=0,i.UINT16[S].length=0,i.UINT32[S].length=0,i.INT8[S].length=0,i.INT16[S].length=0,i.INT32[S].length=0,i.FLOAT[S].length=0,i.DOUBLE[S].length=0,i.BIGUINT64[S].length=0,i.BIGINT64[S].length=0,i.UINT8C[S].length=0,u[S].length=0,s[S].length=0}}).call(this)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{"bit-twiddle":97,buffer:111,dup:176}],596:[function(n,z,q){"use strict";function t(p){this.roots=new Array(p),this.ranks=new Array(p);for(var l=0;l<p;++l)this.roots[l]=l,this.ranks[l]=0}z.exports=t;var h=t.prototype;Object.defineProperty(h,"length",{get:function(){return this.roots.length}}),h.makeSet=function(){var p=this.roots.length;return this.roots.push(p),this.ranks.push(0),p},h.find=function(p){for(var l=p,e=this.roots;e[p]!==p;)p=e[p];for(;e[l]!==p;){var o=e[l];e[l]=p,l=o}return p},h.link=function(p,l){var e=this.find(p),o=this.find(l);if(e!==o){var r=this.ranks,i=this.roots,u=r[e],s=r[o];u<s?i[e]=o:s<u?i[o]=e:(i[o]=e,++r[e])}}},{}],597:[function(n,z,q){"use strict";z.exports=function(t,h,p){return t.length===0?t:h?(p||t.sort(h),function(l,e){for(var o=1,r=l.length,i=l[0],u=l[0],s=1;s<r;++s)if(u=i,e(i=l[s],u)){if(s===o){o++;continue}l[o++]=i}return l.length=o,l}(t,h)):(p||t.sort(),function(l){for(var e=1,o=l.length,r=l[0],i=l[0],u=1;u<o;++u,i=r)if(i=r,(r=l[u])!==i){if(u===e){e++;continue}l[e++]=r}return l.length=e,l}(t))}},{}],598:[function(n,z,q){var t=/[\'\"]/;z.exports=function(h){return h?(t.test(h.charAt(0))&&(h=h.substr(1)),t.test(h.charAt(h.length-1))&&(h=h.substr(0,h.length-1)),h):""}},{}],599:[function(n,z,q){"use strict";z.exports=function(t,h,p){Array.isArray(p)||(p=[].slice.call(arguments,2));for(var l=0,e=p.length;l<e;l++){var o=p[l];for(var r in o)if((h[r]===void 0||Array.isArray(h[r])||t[r]!==h[r])&&r in h){var i;if(o[r]===!0)i=h[r];else if(o[r]===!1||typeof o[r]=="function"&&(i=o[r](h[r],t,h))===void 0)continue;t[r]=i}}return t}},{}],600:[function(n,z,q){"use strict";z.exports=function(l,e){return typeof e=="object"&&e!==null||(e={}),t(l,e.canvas||h,e.context||p,e)};var t=n("./lib/vtext"),h=null,p=null;typeof document<"u"&&((h=document.createElement("canvas")).width=8192,h.height=1024,p=h.getContext("2d"))},{"./lib/vtext":601}],601:[function(n,z,q){z.exports=function(a,c,f,g){var d=64,m=1.25,y={breaklines:!1,bolds:!1,italics:!1,subscripts:!1,superscripts:!1};return g&&(g.size&&g.size>0&&(d=g.size),g.lineSpacing&&g.lineSpacing>0&&(m=g.lineSpacing),g.styletags&&g.styletags.breaklines&&(y.breaklines=!!g.styletags.breaklines),g.styletags&&g.styletags.bolds&&(y.bolds=!!g.styletags.bolds),g.styletags&&g.styletags.italics&&(y.italics=!!g.styletags.italics),g.styletags&&g.styletags.subscripts&&(y.subscripts=!!g.styletags.subscripts),g.styletags&&g.styletags.superscripts&&(y.superscripts=!!g.styletags.superscripts)),f.font=[g.fontStyle,g.fontVariant,g.fontWeight,d+"px",g.font].filter(function(v){return v}).join(" "),f.textAlign="start",f.textBaseline="alphabetic",f.direction="ltr",s(function(v,T,w,A,E,M){w=w.replace(/\n/g,""),w=M.breaklines===!0?w.replace(/\<br\>/g,`
`):w.replace(/\<br\>/g," ");var b="",_=[];for(L=0;L<w.length;++L)_[L]=b;M.bolds===!0&&(_=r("b","b|",w,_)),M.italics===!0&&(_=r("i","i|",w,_)),M.superscripts===!0&&(_=r("sup","+1",w,_)),M.subscripts===!0&&(_=r("sub","-1",w,_));var S=[],C="";for(L=0;L<w.length;++L)_[L]!==null&&(C+=w[L],S.push(_[L]));var k,L,I,R,V,O=C.split(`
`),J=O.length,D=Math.round(E*A),B=A,N=2*A,F=0,H=J*D+N;v.height<H&&(v.height=H),T.fillStyle="#000",T.fillRect(0,0,v.width,v.height),T.fillStyle="#fff";var j=0,G="";function W(){if(G!==""){var le=T.measureText(G).width;T.fillText(G,B+I,N+R),I+=le}}function Q(){return Math.round(V)+"px "}function $(le,fe){var ue=""+T.font;if(M.subscripts===!0){var we=le.indexOf("-"),Ae=fe.indexOf("-"),Se=we>-1?parseInt(le[1+we]):0,ke=Ae>-1?parseInt(fe[1+Ae]):0;Se!==ke&&(ue=ue.replace(Q(),"?px "),V*=Math.pow(.75,ke-Se),ue=ue.replace("?px ",Q())),R+=.25*D*(ke-Se)}if(M.superscripts===!0){var Me=le.indexOf("+"),ve=fe.indexOf("+"),ge=Me>-1?parseInt(le[1+Me]):0,De=ve>-1?parseInt(fe[1+ve]):0;ge!==De&&(ue=ue.replace(Q(),"?px "),V*=Math.pow(.75,De-ge),ue=ue.replace("?px ",Q())),R-=.25*D*(De-ge)}if(M.bolds===!0){var _e=le.indexOf("b|")>-1,Pe=fe.indexOf("b|")>-1;!_e&&Pe&&(ue=Fe?ue.replace("italic ","italic bold "):"bold "+ue),_e&&!Pe&&(ue=ue.replace("bold ",""))}if(M.italics===!0){var Fe=le.indexOf("i|")>-1,ze=fe.indexOf("i|")>-1;!Fe&&ze&&(ue="italic "+ue),Fe&&!ze&&(ue=ue.replace("italic ",""))}T.font=ue}for(k=0;k<J;++k){var ee=O[k]+`
`;for(I=0,R=k*D,V=A,G="",L=0;L<ee.length;++L){var ie=L+j<S.length?S[L+j]:S[S.length-1];b===ie?G+=ee[L]:(W(),G=ee[L],ie!==void 0&&($(b,ie),b=ie))}W(),j+=ee.length;var ae=0|Math.round(I+2*B);F<ae&&(F=ae)}var oe=F,de=N+D*J;return h(T.getImageData(0,0,oe,de).data,[de,oe,4]).pick(-1,-1,0).transpose(1,0)}(c,f,a,d,m,y),g,d)},z.exports.processPixels=s;var t=n("surface-nets"),h=n("ndarray"),p=n("simplify-planar-graph"),l=n("clean-pslg"),e=n("cdt2d"),o=n("planar-graph-to-polyline");function r(a,c,f,g){for(var d="<"+a+">",m="</"+a+">",y=d.length,v=m.length,T=c[0]==="+"||c[0]==="-",w=0,A=-v;w>-1&&(w=f.indexOf(d,w))!==-1&&(A=f.indexOf(m,w+y))!==-1&&!(A<=w);){for(var E=w;E<A+v;++E)if(E<w+y||E>=A)g[E]=null,f=f.substr(0,E)+" "+f.substr(E+1);else if(g[E]!==null){var M=g[E].indexOf(c[0]);M===-1?g[E]+=c:T&&(g[E]=g[E].substr(0,M+1)+(1+parseInt(g[E][M+1]))+g[E].substr(M+2))}var b=w+y,_=f.substr(b,A-b).indexOf(d);w=_!==-1?_:A+v}return g}function i(a,c){var f=t(a,128);return c?p(f.cells,f.positions,.25):{edges:f.cells,positions:f.positions}}function u(a,c,f,g){var d=i(a,g),m=function(k,L,I){for(var R=L.textAlign||"start",V=L.textBaseline||"alphabetic",O=[1<<30,1<<30],J=[0,0],D=k.length,B=0;B<D;++B)for(var N=k[B],F=0;F<2;++F)O[F]=0|Math.min(O[F],N[F]),J[F]=0|Math.max(J[F],N[F]);var H=0;switch(R){case"center":H=-.5*(O[0]+J[0]);break;case"right":case"end":H=-J[0];break;case"left":case"start":H=-O[0];break;default:throw new Error("vectorize-text: Unrecognized textAlign: '"+R+"'")}var j=0;switch(V){case"hanging":case"top":j=-O[1];break;case"middle":j=-.5*(O[1]+J[1]);break;case"alphabetic":case"ideographic":j=-3*I;break;case"bottom":j=-J[1];break;default:throw new Error("vectorize-text: Unrecoginized textBaseline: '"+V+"'")}var G=1/I;return"lineHeight"in L?G*=+L.lineHeight:"width"in L?G=L.width/(J[0]-O[0]):"height"in L&&(G=L.height/(J[1]-O[1])),k.map(function(W){return[G*(W[0]+H),G*(W[1]+j)]})}(d.positions,c,f),y=d.edges,v=c.orientation==="ccw";if(l(m,y),c.polygons||c.polygon||c.polyline){for(var T=o(y,m),w=new Array(T.length),A=0;A<T.length;++A){for(var E=T[A],M=new Array(E.length),b=0;b<E.length;++b){for(var _=E[b],S=new Array(_.length),C=0;C<_.length;++C)S[C]=m[_[C]].slice();v&&S.reverse(),M[b]=S}w[A]=M}return w}return c.triangles||c.triangulate||c.triangle?{cells:e(m,y,{delaunay:!1,exterior:!1,interior:!0}),positions:m}:{edges:y,positions:m}}function s(a,c,f){try{return u(a,c,f,!0)}catch{}try{return u(a,c,f,!1)}catch{}return c.polygons||c.polyline||c.polygon?[]:c.triangles||c.triangulate||c.triangle?{cells:[],positions:[]}:{edges:[],positions:[]}}},{cdt2d:112,"clean-pslg":121,ndarray:495,"planar-graph-to-polyline":514,"simplify-planar-graph":562,"surface-nets":570}],602:[function(n,z,q){(function(){"use strict";if(typeof ses>"u"||!ses.ok||ses.ok()){typeof ses<"u"&&(ses.weakMapPermitHostObjects=d);var t=!1;if(typeof WeakMap=="function"){var h=WeakMap;if(!(typeof navigator<"u"&&/Firefox/.test(navigator.userAgent))){var p=new h,l=Object.freeze({});if(p.set(l,1),p.get(l)===1)return void(z.exports=WeakMap);t=!0}}var e=Object.getOwnPropertyNames,o=Object.defineProperty,r=Object.isExtensible,i="weakmap:ident:"+Math.random()+"___";if(typeof crypto<"u"&&typeof crypto.getRandomValues=="function"&&typeof ArrayBuffer=="function"&&typeof Uint8Array=="function"){var u=new ArrayBuffer(25),s=new Uint8Array(u);crypto.getRandomValues(s),i="weakmap:rand:"+Array.prototype.map.call(s,function(w){return(w%36).toString(36)}).join("")+"___"}if(o(Object,"getOwnPropertyNames",{value:function(w){return e(w).filter(m)}}),"getPropertyNames"in Object){var a=Object.getPropertyNames;o(Object,"getPropertyNames",{value:function(w){return a(w).filter(m)}})}(function(){var w=Object.freeze;o(Object,"freeze",{value:function(M){return y(M),w(M)}});var A=Object.seal;o(Object,"seal",{value:function(M){return y(M),A(M)}});var E=Object.preventExtensions;o(Object,"preventExtensions",{value:function(M){return y(M),E(M)}})})();var c=!1,f=0,g=function(){this instanceof g||T();var w=[],A=[],E=f++;return Object.create(g.prototype,{get___:{value:v(function(M,b){var _,S=y(M);return S?E in S?S[E]:b:(_=w.indexOf(M))>=0?A[_]:b})},has___:{value:v(function(M){var b=y(M);return b?E in b:w.indexOf(M)>=0})},set___:{value:v(function(M,b){var _,S=y(M);return S?S[E]=b:(_=w.indexOf(M))>=0?A[_]=b:(_=w.length,A[_]=b,w[_]=M),this})},delete___:{value:v(function(M){var b,_,S=y(M);return S?E in S&&delete S[E]:!((b=w.indexOf(M))<0)&&(_=w.length-1,w[b]=void 0,A[b]=A[_],w[b]=w[_],w.length=_,A.length=_,!0)})}})};g.prototype=Object.create(Object.prototype,{get:{value:function(w,A){return this.get___(w,A)},writable:!0,configurable:!0},has:{value:function(w){return this.has___(w)},writable:!0,configurable:!0},set:{value:function(w,A){return this.set___(w,A)},writable:!0,configurable:!0},delete:{value:function(w){return this.delete___(w)},writable:!0,configurable:!0}}),typeof h=="function"?function(){function w(){this instanceof g||T();var A,E=new h,M=void 0,b=!1;return A=t?function(_,S){return E.set(_,S),E.has(_)||(M||(M=new g),M.set(_,S)),this}:function(_,S){if(b)try{E.set(_,S)}catch{M||(M=new g),M.set___(_,S)}else E.set(_,S);return this},Object.create(g.prototype,{get___:{value:v(function(_,S){return M?E.has(_)?E.get(_):M.get___(_,S):E.get(_,S)})},has___:{value:v(function(_){return E.has(_)||!!M&&M.has___(_)})},set___:{value:v(A)},delete___:{value:v(function(_){var S=!!E.delete(_);return M&&M.delete___(_)||S})},permitHostObjects___:{value:v(function(_){if(_!==d)throw new Error("bogus call to permitHostObjects___");b=!0})}})}t&&typeof Proxy<"u"&&(Proxy=void 0),w.prototype=g.prototype,z.exports=w,Object.defineProperty(WeakMap.prototype,"constructor",{value:WeakMap,enumerable:!1,configurable:!0,writable:!0})}():(typeof Proxy<"u"&&(Proxy=void 0),z.exports=g)}function d(w){w.permitHostObjects___&&w.permitHostObjects___(d)}function m(w){return!(w.substr(0,8)=="weakmap:"&&w.substr(w.length-3)==="___")}function y(w){if(w!==Object(w))throw new TypeError("Not an object: "+w);var A=w[i];if(A&&A.key===w)return A;if(r(w)){A={key:w};try{return o(w,i,{value:A,writable:!1,enumerable:!1,configurable:!1}),A}catch{return}}}function v(w){return w.prototype=null,Object.freeze(w)}function T(){c||typeof console>"u"||(c=!0,console.warn("WeakMap should be invoked as new WeakMap(), not WeakMap(). This will be an error in the future."))}})()},{}],603:[function(n,z,q){var t=n("./hidden-store.js");z.exports=function(){var h={};return function(p){if((typeof p!="object"||p===null)&&typeof p!="function")throw new Error("Weakmap-shim: Key must be object");var l=p.valueOf(h);return l&&l.identity===h?l:t(p,h)}}},{"./hidden-store.js":604}],604:[function(n,z,q){z.exports=function(t,h){var p={identity:h},l=t.valueOf;return Object.defineProperty(t,"valueOf",{value:function(e){return e!==h?l.apply(this,arguments):p},writable:!0}),p}},{}],605:[function(n,z,q){var t=n("./create-store.js");z.exports=function(){var h=t();return{get:function(p,l){var e=h(p);return e.hasOwnProperty("value")?e.value:l},set:function(p,l){return h(p).value=l,this},has:function(p){return"value"in h(p)},delete:function(p){return delete h(p).value}}}},{"./create-store.js":603}],606:[function(n,z,q){var t=n("get-canvas-context");z.exports=function(h){return t("webgl",h)}},{"get-canvas-context":249}],607:[function(n,z,q){var t=n("../main"),h=n("object-assign"),p=t.instance();function l(a){this.local=this.regionalOptions[a||""]||this.regionalOptions[""]}l.prototype=new t.baseCalendar,h(l.prototype,{name:"Chinese",jdEpoch:17214255e-1,hasYearZero:!1,minMonth:0,firstMonth:0,minDay:1,regionalOptions:{"":{name:"Chinese",epochs:["BEC","EC"],monthNumbers:function(a,c){if(typeof a=="string"){var f=a.match(o);return f?f[0]:""}var g=this._validateYear(a),d=a.month(),m=""+this.toChineseMonth(g,d);return c&&m.length<2&&(m="0"+m),this.isIntercalaryMonth(g,d)&&(m+="i"),m},monthNames:function(a){if(typeof a=="string"){var c=a.match(r);return c?c[0]:""}var f=this._validateYear(a),g=a.month(),d=["\u4E00\u6708","\u4E8C\u6708","\u4E09\u6708","\u56DB\u6708","\u4E94\u6708","\u516D\u6708","\u4E03\u6708","\u516B\u6708","\u4E5D\u6708","\u5341\u6708","\u5341\u4E00\u6708","\u5341\u4E8C\u6708"][this.toChineseMonth(f,g)-1];return this.isIntercalaryMonth(f,g)&&(d="\u95F0"+d),d},monthNamesShort:function(a){if(typeof a=="string"){var c=a.match(i);return c?c[0]:""}var f=this._validateYear(a),g=a.month(),d=["\u4E00","\u4E8C","\u4E09","\u56DB","\u4E94","\u516D","\u4E03","\u516B","\u4E5D","\u5341","\u5341\u4E00","\u5341\u4E8C"][this.toChineseMonth(f,g)-1];return this.isIntercalaryMonth(f,g)&&(d="\u95F0"+d),d},parseMonth:function(a,c){a=this._validateYear(a);var f,g=parseInt(c);if(isNaN(g))c[0]==="\u95F0"&&(f=!0,c=c.substring(1)),c[c.length-1]==="\u6708"&&(c=c.substring(0,c.length-1)),g=1+["\u4E00","\u4E8C","\u4E09","\u56DB","\u4E94","\u516D","\u4E03","\u516B","\u4E5D","\u5341","\u5341\u4E00","\u5341\u4E8C"].indexOf(c);else{var d=c[c.length-1];f=d==="i"||d==="I"}return this.toMonthIndex(a,g,f)},dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:1,isRTL:!1}},_validateYear:function(a,c){if(a.year&&(a=a.year()),typeof a!="number"||a<1888||a>2111)throw c.replace(/\{0\}/,this.local.name);return a},toMonthIndex:function(a,c,f){var g=this.intercalaryMonth(a);if(f&&c!==g||c<1||c>12)throw t.local.invalidMonth.replace(/\{0\}/,this.local.name);return g?!f&&c<=g?c-1:c:c-1},toChineseMonth:function(a,c){a.year&&(c=(a=a.year()).month());var f=this.intercalaryMonth(a);if(c<0||c>(f?12:11))throw t.local.invalidMonth.replace(/\{0\}/,this.local.name);return f?c<f?c+1:c:c+1},intercalaryMonth:function(a){return a=this._validateYear(a),u[a-u[0]]>>13},isIntercalaryMonth:function(a,c){a.year&&(c=(a=a.year()).month());var f=this.intercalaryMonth(a);return!!f&&f===c},leapYear:function(a){return this.intercalaryMonth(a)!==0},weekOfYear:function(a,c,f){var g,d=this._validateYear(a,t.local.invalidyear),m=s[d-s[0]],y=m>>9&4095,v=m>>5&15,T=31&m;(g=p.newDate(y,v,T)).add(4-(g.dayOfWeek()||7),"d");var w=this.toJD(a,c,f)-g.toJD();return 1+Math.floor(w/7)},monthsInYear:function(a){return this.leapYear(a)?13:12},daysInMonth:function(a,c){a.year&&(c=a.month(),a=a.year()),a=this._validateYear(a);var f=u[a-u[0]];if(c>(f>>13?12:11))throw t.local.invalidMonth.replace(/\{0\}/,this.local.name);return f&1<<12-c?30:29},weekDay:function(a,c,f){return(this.dayOfWeek(a,c,f)||7)<6},toJD:function(a,c,f){var g=this._validate(a,m,f,t.local.invalidDate);a=this._validateYear(g.year()),c=g.month(),f=g.day();var d=this.isIntercalaryMonth(a,c),m=this.toChineseMonth(a,c),y=function(v,T,w,A,E){var M,b,_;if(typeof v=="object")b=v,M=T||{};else{var S;if(!(typeof v=="number"&&v>=1888&&v<=2111))throw new Error("Lunar year outside range 1888-2111");if(!(typeof T=="number"&&T>=1&&T<=12))throw new Error("Lunar month outside range 1 - 12");if(!(typeof w=="number"&&w>=1&&w<=30))throw new Error("Lunar day outside range 1 - 30");typeof A=="object"?(S=!1,M=A):(S=!!A,M=E||{}),b={year:v,month:T,day:w,isIntercalary:S}}_=b.day-1;var C,k=u[b.year-u[0]],L=k>>13;C=L&&(b.month>L||b.isIntercalary)?b.month:b.month-1;for(var I=0;I<C;I++)_+=k&1<<12-I?30:29;var R=s[b.year-s[0]],V=new Date(R>>9&4095,(R>>5&15)-1,(31&R)+_);return M.year=V.getFullYear(),M.month=1+V.getMonth(),M.day=V.getDate(),M}(a,m,f,d);return p.toJD(y.year,y.month,y.day)},fromJD:function(a){var c=p.fromJD(a),f=function(d,m,y,v){var T,w;if(typeof d=="object")T=d,w=m||{};else{if(!(typeof d=="number"&&d>=1888&&d<=2111))throw new Error("Solar year outside range 1888-2111");if(!(typeof m=="number"&&m>=1&&m<=12))throw new Error("Solar month outside range 1 - 12");if(!(typeof y=="number"&&y>=1&&y<=31))throw new Error("Solar day outside range 1 - 31");T={year:d,month:m,day:y},w=v||{}}var A=s[T.year-s[0]],E=T.year<<9|T.month<<5|T.day;w.year=E>=A?T.year:T.year-1,A=s[w.year-s[0]];var M,b=new Date(A>>9&4095,(A>>5&15)-1,31&A),_=new Date(T.year,T.month-1,T.day);M=Math.round((_-b)/864e5);var S,C=u[w.year-u[0]];for(S=0;S<13;S++){var k=C&1<<12-S?30:29;if(M<k)break;M-=k}var L=C>>13;return!L||S<L?(w.isIntercalary=!1,w.month=1+S):S===L?(w.isIntercalary=!0,w.month=S):(w.isIntercalary=!1,w.month=S),w.day=1+M,w}(c.year(),c.month(),c.day()),g=this.toMonthIndex(f.year,f.month,f.isIntercalary);return this.newDate(f.year,g,f.day)},fromString:function(a){var c=a.match(e),f=this._validateYear(+c[1]),g=+c[2],d=!!c[3],m=this.toMonthIndex(f,g,d),y=+c[4];return this.newDate(f,m,y)},add:function(a,c,f){var g=a.year(),d=a.month(),m=this.isIntercalaryMonth(g,d),y=this.toChineseMonth(g,d),v=Object.getPrototypeOf(l.prototype).add.call(this,a,c,f);if(f==="y"){var T=v.year(),w=v.month(),A=this.isIntercalaryMonth(T,y),E=m&&A?this.toMonthIndex(T,y,!0):this.toMonthIndex(T,y,!1);E!==w&&v.month(E)}return v}});var e=/^\s*(-?\d\d\d\d|\d\d)[-/](\d?\d)([iI]?)[-/](\d?\d)/m,o=/^\d?\d[iI]?/m,r=/^\u95f0?\u5341?[\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d]?\u6708/m,i=/^\u95f0?\u5341?[\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d]?/m;t.calendars.chinese=l;var u=[1887,5780,5802,19157,2742,50359,1198,2646,46378,7466,3412,30122,5482,67949,2396,5294,43597,6732,6954,36181,2772,4954,18781,2396,54427,5274,6730,47781,5800,6868,21210,4790,59703,2350,5270,46667,3402,3496,38325,1388,4782,18735,2350,52374,6804,7498,44457,2906,1388,29294,4700,63789,6442,6804,56138,5802,2772,38235,1210,4698,22827,5418,63125,3476,5802,43701,2484,5302,27223,2646,70954,7466,3412,54698,5482,2412,38062,5294,2636,32038,6954,60245,2772,4826,43357,2394,5274,39501,6730,72357,5800,5844,53978,4790,2358,38039,5270,87627,3402,3496,54708,5484,4782,43311,2350,3222,27978,7498,68965,2904,5484,45677,4700,6444,39573,6804,6986,19285,2772,62811,1210,4698,47403,5418,5780,38570,5546,76469,2420,5302,51799,2646,5414,36501,3412,5546,18869,2412,54446,5276,6732,48422,6822,2900,28010,4826,92509,2394,5274,55883,6730,6820,47956,5812,2778,18779,2358,62615,5270,5450,46757,3492,5556,27318,4718,67887,2350,3222,52554,7498,3428,38252,5468,4700,31022,6444,64149,6804,6986,43861,2772,5338,35421,2650,70955,5418,5780,54954,5546,2740,38074,5302,2646,29991,3366,61011,3412,5546,43445,2412,5294,35406,6732,72998,6820,6996,52586,2778,2396,38045,5274,6698,23333,6820,64338,5812,2746,43355,2358,5270,39499,5450,79525,3492,5548],s=[1887,966732,967231,967733,968265,968766,969297,969798,970298,970829,971330,971830,972362,972863,973395,973896,974397,974928,975428,975929,976461,976962,977462,977994,978494,979026,979526,980026,980558,981059,981559,982091,982593,983124,983624,984124,984656,985157,985656,986189,986690,987191,987722,988222,988753,989254,989754,990286,990788,991288,991819,992319,992851,993352,993851,994383,994885,995385,995917,996418,996918,997450,997949,998481,998982,999483,1000014,1000515,1001016,1001548,1002047,1002578,1003080,1003580,1004111,1004613,1005113,1005645,1006146,1006645,1007177,1007678,1008209,1008710,1009211,1009743,1010243,1010743,1011275,1011775,1012306,1012807,1013308,1013840,1014341,1014841,1015373,1015874,1016404,1016905,1017405,1017937,1018438,1018939,1019471,1019972,1020471,1021002,1021503,1022035,1022535,1023036,1023568,1024069,1024568,1025100,1025601,1026102,1026633,1027133,1027666,1028167,1028666,1029198,1029699,1030199,1030730,1031231,1031763,1032264,1032764,1033296,1033797,1034297,1034828,1035329,1035830,1036362,1036861,1037393,1037894,1038394,1038925,1039427,1039927,1040459,1040959,1041491,1041992,1042492,1043023,1043524,1044024,1044556,1045057,1045558,1046090,1046590,1047121,1047622,1048122,1048654,1049154,1049655,1050187,1050689,1051219,1051720,1052220,1052751,1053252,1053752,1054284,1054786,1055285,1055817,1056317,1056849,1057349,1057850,1058382,1058883,1059383,1059915,1060415,1060947,1061447,1061947,1062479,1062981,1063480,1064012,1064514,1065014,1065545,1066045,1066577,1067078,1067578,1068110,1068611,1069112,1069642,1070142,1070674,1071175,1071675,1072207,1072709,1073209,1073740,1074241,1074741,1075273,1075773,1076305,1076807,1077308,1077839,1078340,1078840,1079372,1079871,1080403,1080904]},{"../main":621,"object-assign":499}],608:[function(n,z,q){var t=n("../main"),h=n("object-assign");function p(l){this.local=this.regionalOptions[l||""]||this.regionalOptions[""]}p.prototype=new t.baseCalendar,h(p.prototype,{name:"Coptic",jdEpoch:18250295e-1,daysPerMonth:[30,30,30,30,30,30,30,30,30,30,30,30,5],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Coptic",epochs:["BAM","AM"],monthNames:["Thout","Paopi","Hathor","Koiak","Tobi","Meshir","Paremhat","Paremoude","Pashons","Paoni","Epip","Mesori","Pi Kogi Enavot"],monthNamesShort:["Tho","Pao","Hath","Koi","Tob","Mesh","Pat","Pad","Pash","Pao","Epi","Meso","PiK"],dayNames:["Tkyriaka","Pesnau","Pshoment","Peftoou","Ptiou","Psoou","Psabbaton"],dayNamesShort:["Tky","Pes","Psh","Pef","Pti","Pso","Psa"],dayNamesMin:["Tk","Pes","Psh","Pef","Pt","Pso","Psa"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(l){var e=this._validate(l,this.minMonth,this.minDay,t.local.invalidYear);return(l=e.year()+(e.year()<0?1:0))%4==3||l%4==-1},monthsInYear:function(l){return this._validate(l,this.minMonth,this.minDay,t.local.invalidYear||t.regionalOptions[""].invalidYear),13},weekOfYear:function(l,e,o){var r=this.newDate(l,e,o);return r.add(-r.dayOfWeek(),"d"),Math.floor((r.dayOfYear()-1)/7)+1},daysInMonth:function(l,e){var o=this._validate(l,e,this.minDay,t.local.invalidMonth);return this.daysPerMonth[o.month()-1]+(o.month()===13&&this.leapYear(o.year())?1:0)},weekDay:function(l,e,o){return(this.dayOfWeek(l,e,o)||7)<6},toJD:function(l,e,o){var r=this._validate(l,e,o,t.local.invalidDate);return(l=r.year())<0&&l++,r.day()+30*(r.month()-1)+365*(l-1)+Math.floor(l/4)+this.jdEpoch-1},fromJD:function(l){var e=Math.floor(l)+.5-this.jdEpoch,o=Math.floor((e-Math.floor((e+366)/1461))/365)+1;o<=0&&o--,e=Math.floor(l)+.5-this.newDate(o,1,1).toJD();var r=Math.floor(e/30)+1,i=e-30*(r-1)+1;return this.newDate(o,r,i)}}),t.calendars.coptic=p},{"../main":621,"object-assign":499}],609:[function(n,z,q){var t=n("../main"),h=n("object-assign");function p(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}p.prototype=new t.baseCalendar,h(p.prototype,{name:"Discworld",jdEpoch:17214255e-1,daysPerMonth:[16,32,32,32,32,32,32,32,32,32,32,32,32],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Discworld",epochs:["BUC","UC"],monthNames:["Ick","Offle","February","March","April","May","June","Grune","August","Spune","Sektober","Ember","December"],monthNamesShort:["Ick","Off","Feb","Mar","Apr","May","Jun","Gru","Aug","Spu","Sek","Emb","Dec"],dayNames:["Sunday","Octeday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Oct","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Oc","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:2,isRTL:!1}},leapYear:function(e){return this._validate(e,this.minMonth,this.minDay,t.local.invalidYear),!1},monthsInYear:function(e){return this._validate(e,this.minMonth,this.minDay,t.local.invalidYear),13},daysInYear:function(e){return this._validate(e,this.minMonth,this.minDay,t.local.invalidYear),400},weekOfYear:function(e,o,r){var i=this.newDate(e,o,r);return i.add(-i.dayOfWeek(),"d"),Math.floor((i.dayOfYear()-1)/8)+1},daysInMonth:function(e,o){var r=this._validate(e,o,this.minDay,t.local.invalidMonth);return this.daysPerMonth[r.month()-1]},daysInWeek:function(){return 8},dayOfWeek:function(e,o,r){return(this._validate(e,o,r,t.local.invalidDate).day()+1)%8},weekDay:function(e,o,r){var i=this.dayOfWeek(e,o,r);return i>=2&&i<=6},extraInfo:function(e,o,r){var i=this._validate(e,o,r,t.local.invalidDate);return{century:l[Math.floor((i.year()-1)/100)+1]||""}},toJD:function(e,o,r){var i=this._validate(e,o,r,t.local.invalidDate);return e=i.year()+(i.year()<0?1:0),o=i.month(),(r=i.day())+(o>1?16:0)+(o>2?32*(o-2):0)+400*(e-1)+this.jdEpoch-1},fromJD:function(e){e=Math.floor(e+.5)-Math.floor(this.jdEpoch)-1;var o=Math.floor(e/400)+1;e-=400*(o-1),e+=e>15?16:0;var r=Math.floor(e/32)+1,i=e-32*(r-1)+1;return this.newDate(o<=0?o-1:o,r,i)}});var l={20:"Fruitbat",21:"Anchovy"};t.calendars.discworld=p},{"../main":621,"object-assign":499}],610:[function(n,z,q){var t=n("../main"),h=n("object-assign");function p(l){this.local=this.regionalOptions[l||""]||this.regionalOptions[""]}p.prototype=new t.baseCalendar,h(p.prototype,{name:"Ethiopian",jdEpoch:17242205e-1,daysPerMonth:[30,30,30,30,30,30,30,30,30,30,30,30,5],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Ethiopian",epochs:["BEE","EE"],monthNames:["Meskerem","Tikemet","Hidar","Tahesas","Tir","Yekatit","Megabit","Miazia","Genbot","Sene","Hamle","Nehase","Pagume"],monthNamesShort:["Mes","Tik","Hid","Tah","Tir","Yek","Meg","Mia","Gen","Sen","Ham","Neh","Pag"],dayNames:["Ehud","Segno","Maksegno","Irob","Hamus","Arb","Kidame"],dayNamesShort:["Ehu","Seg","Mak","Iro","Ham","Arb","Kid"],dayNamesMin:["Eh","Se","Ma","Ir","Ha","Ar","Ki"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(l){var e=this._validate(l,this.minMonth,this.minDay,t.local.invalidYear);return(l=e.year()+(e.year()<0?1:0))%4==3||l%4==-1},monthsInYear:function(l){return this._validate(l,this.minMonth,this.minDay,t.local.invalidYear||t.regionalOptions[""].invalidYear),13},weekOfYear:function(l,e,o){var r=this.newDate(l,e,o);return r.add(-r.dayOfWeek(),"d"),Math.floor((r.dayOfYear()-1)/7)+1},daysInMonth:function(l,e){var o=this._validate(l,e,this.minDay,t.local.invalidMonth);return this.daysPerMonth[o.month()-1]+(o.month()===13&&this.leapYear(o.year())?1:0)},weekDay:function(l,e,o){return(this.dayOfWeek(l,e,o)||7)<6},toJD:function(l,e,o){var r=this._validate(l,e,o,t.local.invalidDate);return(l=r.year())<0&&l++,r.day()+30*(r.month()-1)+365*(l-1)+Math.floor(l/4)+this.jdEpoch-1},fromJD:function(l){var e=Math.floor(l)+.5-this.jdEpoch,o=Math.floor((e-Math.floor((e+366)/1461))/365)+1;o<=0&&o--,e=Math.floor(l)+.5-this.newDate(o,1,1).toJD();var r=Math.floor(e/30)+1,i=e-30*(r-1)+1;return this.newDate(o,r,i)}}),t.calendars.ethiopian=p},{"../main":621,"object-assign":499}],611:[function(n,z,q){var t=n("../main"),h=n("object-assign");function p(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}function l(e,o){return e-o*Math.floor(e/o)}p.prototype=new t.baseCalendar,h(p.prototype,{name:"Hebrew",jdEpoch:347995.5,daysPerMonth:[30,29,30,29,30,29,30,29,30,29,30,29,29],hasYearZero:!1,minMonth:1,firstMonth:7,minDay:1,regionalOptions:{"":{name:"Hebrew",epochs:["BAM","AM"],monthNames:["Nisan","Iyar","Sivan","Tammuz","Av","Elul","Tishrei","Cheshvan","Kislev","Tevet","Shevat","Adar","Adar II"],monthNamesShort:["Nis","Iya","Siv","Tam","Av","Elu","Tis","Che","Kis","Tev","She","Ada","Ad2"],dayNames:["Yom Rishon","Yom Sheni","Yom Shlishi","Yom Revi'i","Yom Chamishi","Yom Shishi","Yom Shabbat"],dayNamesShort:["Ris","She","Shl","Rev","Cha","Shi","Sha"],dayNamesMin:["Ri","She","Shl","Re","Ch","Shi","Sha"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(e){var o=this._validate(e,this.minMonth,this.minDay,t.local.invalidYear);return this._leapYear(o.year())},_leapYear:function(e){return l(7*(e=e<0?e+1:e)+1,19)<7},monthsInYear:function(e){return this._validate(e,this.minMonth,this.minDay,t.local.invalidYear),this._leapYear(e.year?e.year():e)?13:12},weekOfYear:function(e,o,r){var i=this.newDate(e,o,r);return i.add(-i.dayOfWeek(),"d"),Math.floor((i.dayOfYear()-1)/7)+1},daysInYear:function(e){return e=this._validate(e,this.minMonth,this.minDay,t.local.invalidYear).year(),this.toJD(e===-1?1:e+1,7,1)-this.toJD(e,7,1)},daysInMonth:function(e,o){return e.year&&(o=e.month(),e=e.year()),this._validate(e,o,this.minDay,t.local.invalidMonth),o===12&&this.leapYear(e)||o===8&&l(this.daysInYear(e),10)===5?30:o===9&&l(this.daysInYear(e),10)===3?29:this.daysPerMonth[o-1]},weekDay:function(e,o,r){return this.dayOfWeek(e,o,r)!==6},extraInfo:function(e,o,r){var i=this._validate(e,o,r,t.local.invalidDate);return{yearType:(this.leapYear(i)?"embolismic":"common")+" "+["deficient","regular","complete"][this.daysInYear(i)%10-3]}},toJD:function(e,o,r){var i=this._validate(e,o,r,t.local.invalidDate);e=i.year(),o=i.month(),r=i.day();var u=e<=0?e+1:e,s=this.jdEpoch+this._delay1(u)+this._delay2(u)+r+1;if(o<7){for(var a=7;a<=this.monthsInYear(e);a++)s+=this.daysInMonth(e,a);for(a=1;a<o;a++)s+=this.daysInMonth(e,a)}else for(a=7;a<o;a++)s+=this.daysInMonth(e,a);return s},_delay1:function(e){var o=Math.floor((235*e-234)/19),r=12084+13753*o,i=29*o+Math.floor(r/25920);return l(3*(i+1),7)<3&&i++,i},_delay2:function(e){var o=this._delay1(e-1),r=this._delay1(e);return this._delay1(e+1)-r==356?2:r-o==382?1:0},fromJD:function(e){e=Math.floor(e)+.5;for(var o=Math.floor(98496*(e-this.jdEpoch)/35975351)-1;e>=this.toJD(o===-1?1:o+1,7,1);)o++;for(var r=e<this.toJD(o,1,1)?7:1;e>this.toJD(o,r,this.daysInMonth(o,r));)r++;var i=e-this.toJD(o,r,1)+1;return this.newDate(o,r,i)}}),t.calendars.hebrew=p},{"../main":621,"object-assign":499}],612:[function(n,z,q){var t=n("../main"),h=n("object-assign");function p(l){this.local=this.regionalOptions[l||""]||this.regionalOptions[""]}p.prototype=new t.baseCalendar,h(p.prototype,{name:"Islamic",jdEpoch:19484395e-1,daysPerMonth:[30,29,30,29,30,29,30,29,30,29,30,29],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Islamic",epochs:["BH","AH"],monthNames:["Muharram","Safar","Rabi' al-awwal","Rabi' al-thani","Jumada al-awwal","Jumada al-thani","Rajab","Sha'aban","Ramadan","Shawwal","Dhu al-Qi'dah","Dhu al-Hijjah"],monthNamesShort:["Muh","Saf","Rab1","Rab2","Jum1","Jum2","Raj","Sha'","Ram","Shaw","DhuQ","DhuH"],dayNames:["Yawm al-ahad","Yawm al-ithnayn","Yawm ath-thulaathaa'","Yawm al-arbi'aa'","Yawm al-kham\u012Bs","Yawm al-jum'a","Yawm as-sabt"],dayNamesShort:["Aha","Ith","Thu","Arb","Kha","Jum","Sab"],dayNamesMin:["Ah","It","Th","Ar","Kh","Ju","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!1}},leapYear:function(l){return(11*this._validate(l,this.minMonth,this.minDay,t.local.invalidYear).year()+14)%30<11},weekOfYear:function(l,e,o){var r=this.newDate(l,e,o);return r.add(-r.dayOfWeek(),"d"),Math.floor((r.dayOfYear()-1)/7)+1},daysInYear:function(l){return this.leapYear(l)?355:354},daysInMonth:function(l,e){var o=this._validate(l,e,this.minDay,t.local.invalidMonth);return this.daysPerMonth[o.month()-1]+(o.month()===12&&this.leapYear(o.year())?1:0)},weekDay:function(l,e,o){return this.dayOfWeek(l,e,o)!==5},toJD:function(l,e,o){var r=this._validate(l,e,o,t.local.invalidDate);return l=r.year(),e=r.month(),l=l<=0?l+1:l,(o=r.day())+Math.ceil(29.5*(e-1))+354*(l-1)+Math.floor((3+11*l)/30)+this.jdEpoch-1},fromJD:function(l){l=Math.floor(l)+.5;var e=Math.floor((30*(l-this.jdEpoch)+10646)/10631);e=e<=0?e-1:e;var o=Math.min(12,Math.ceil((l-29-this.toJD(e,1,1))/29.5)+1),r=l-this.toJD(e,o,1)+1;return this.newDate(e,o,r)}}),t.calendars.islamic=p},{"../main":621,"object-assign":499}],613:[function(n,z,q){var t=n("../main"),h=n("object-assign");function p(l){this.local=this.regionalOptions[l||""]||this.regionalOptions[""]}p.prototype=new t.baseCalendar,h(p.prototype,{name:"Julian",jdEpoch:17214235e-1,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Julian",epochs:["BC","AD"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"mm/dd/yyyy",firstDay:0,isRTL:!1}},leapYear:function(l){var e=this._validate(l,this.minMonth,this.minDay,t.local.invalidYear);return(l=e.year()<0?e.year()+1:e.year())%4==0},weekOfYear:function(l,e,o){var r=this.newDate(l,e,o);return r.add(4-(r.dayOfWeek()||7),"d"),Math.floor((r.dayOfYear()-1)/7)+1},daysInMonth:function(l,e){var o=this._validate(l,e,this.minDay,t.local.invalidMonth);return this.daysPerMonth[o.month()-1]+(o.month()===2&&this.leapYear(o.year())?1:0)},weekDay:function(l,e,o){return(this.dayOfWeek(l,e,o)||7)<6},toJD:function(l,e,o){var r=this._validate(l,e,o,t.local.invalidDate);return l=r.year(),e=r.month(),o=r.day(),l<0&&l++,e<=2&&(l--,e+=12),Math.floor(365.25*(l+4716))+Math.floor(30.6001*(e+1))+o-1524.5},fromJD:function(l){var e=Math.floor(l+.5)+1524,o=Math.floor((e-122.1)/365.25),r=Math.floor(365.25*o),i=Math.floor((e-r)/30.6001),u=i-Math.floor(i<14?1:13),s=o-Math.floor(u>2?4716:4715),a=e-r-Math.floor(30.6001*i);return s<=0&&s--,this.newDate(s,u,a)}}),t.calendars.julian=p},{"../main":621,"object-assign":499}],614:[function(n,z,q){var t=n("../main"),h=n("object-assign");function p(o){this.local=this.regionalOptions[o||""]||this.regionalOptions[""]}function l(o,r){return o-r*Math.floor(o/r)}function e(o,r){return l(o-1,r)+1}p.prototype=new t.baseCalendar,h(p.prototype,{name:"Mayan",jdEpoch:584282.5,hasYearZero:!0,minMonth:0,firstMonth:0,minDay:0,regionalOptions:{"":{name:"Mayan",epochs:["",""],monthNames:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17"],monthNamesShort:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17"],dayNames:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],dayNamesShort:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],dayNamesMin:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],digits:null,dateFormat:"YYYY.m.d",firstDay:0,isRTL:!1,haabMonths:["Pop","Uo","Zip","Zotz","Tzec","Xul","Yaxkin","Mol","Chen","Yax","Zac","Ceh","Mac","Kankin","Muan","Pax","Kayab","Cumku","Uayeb"],tzolkinMonths:["Imix","Ik","Akbal","Kan","Chicchan","Cimi","Manik","Lamat","Muluc","Oc","Chuen","Eb","Ben","Ix","Men","Cib","Caban","Etznab","Cauac","Ahau"]}},leapYear:function(o){return this._validate(o,this.minMonth,this.minDay,t.local.invalidYear),!1},formatYear:function(o){o=this._validate(o,this.minMonth,this.minDay,t.local.invalidYear).year();var r=Math.floor(o/400);return o%=400,o+=o<0?400:0,r+"."+Math.floor(o/20)+"."+o%20},forYear:function(o){if((o=o.split(".")).length<3)throw"Invalid Mayan year";for(var r=0,i=0;i<o.length;i++){var u=parseInt(o[i],10);if(Math.abs(u)>19||i>0&&u<0)throw"Invalid Mayan year";r=20*r+u}return r},monthsInYear:function(o){return this._validate(o,this.minMonth,this.minDay,t.local.invalidYear),18},weekOfYear:function(o,r,i){return this._validate(o,r,i,t.local.invalidDate),0},daysInYear:function(o){return this._validate(o,this.minMonth,this.minDay,t.local.invalidYear),360},daysInMonth:function(o,r){return this._validate(o,r,this.minDay,t.local.invalidMonth),20},daysInWeek:function(){return 5},dayOfWeek:function(o,r,i){return this._validate(o,r,i,t.local.invalidDate).day()},weekDay:function(o,r,i){return this._validate(o,r,i,t.local.invalidDate),!0},extraInfo:function(o,r,i){var u=this._validate(o,r,i,t.local.invalidDate).toJD(),s=this._toHaab(u),a=this._toTzolkin(u);return{haabMonthName:this.local.haabMonths[s[0]-1],haabMonth:s[0],haabDay:s[1],tzolkinDayName:this.local.tzolkinMonths[a[0]-1],tzolkinDay:a[0],tzolkinTrecena:a[1]}},_toHaab:function(o){var r=l((o-=this.jdEpoch)+8+340,365);return[Math.floor(r/20)+1,l(r,20)]},_toTzolkin:function(o){return[e((o-=this.jdEpoch)+20,20),e(o+4,13)]},toJD:function(o,r,i){var u=this._validate(o,r,i,t.local.invalidDate);return u.day()+20*u.month()+360*u.year()+this.jdEpoch},fromJD:function(o){o=Math.floor(o)+.5-this.jdEpoch;var r=Math.floor(o/360);o%=360,o+=o<0?360:0;var i=Math.floor(o/20),u=o%20;return this.newDate(r,i,u)}}),t.calendars.mayan=p},{"../main":621,"object-assign":499}],615:[function(n,z,q){var t=n("../main"),h=n("object-assign");function p(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}p.prototype=new t.baseCalendar;var l=t.instance("gregorian");h(p.prototype,{name:"Nanakshahi",jdEpoch:22576735e-1,daysPerMonth:[31,31,31,31,31,30,30,30,30,30,30,30],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Nanakshahi",epochs:["BN","AN"],monthNames:["Chet","Vaisakh","Jeth","Harh","Sawan","Bhadon","Assu","Katak","Maghar","Poh","Magh","Phagun"],monthNamesShort:["Che","Vai","Jet","Har","Saw","Bha","Ass","Kat","Mgr","Poh","Mgh","Pha"],dayNames:["Somvaar","Mangalvar","Budhvaar","Veervaar","Shukarvaar","Sanicharvaar","Etvaar"],dayNamesShort:["Som","Mangal","Budh","Veer","Shukar","Sanichar","Et"],dayNamesMin:["So","Ma","Bu","Ve","Sh","Sa","Et"],digits:null,dateFormat:"dd-mm-yyyy",firstDay:0,isRTL:!1}},leapYear:function(e){var o=this._validate(e,this.minMonth,this.minDay,t.local.invalidYear||t.regionalOptions[""].invalidYear);return l.leapYear(o.year()+(o.year()<1?1:0)+1469)},weekOfYear:function(e,o,r){var i=this.newDate(e,o,r);return i.add(1-(i.dayOfWeek()||7),"d"),Math.floor((i.dayOfYear()-1)/7)+1},daysInMonth:function(e,o){var r=this._validate(e,o,this.minDay,t.local.invalidMonth);return this.daysPerMonth[r.month()-1]+(r.month()===12&&this.leapYear(r.year())?1:0)},weekDay:function(e,o,r){return(this.dayOfWeek(e,o,r)||7)<6},toJD:function(e,o,r){var i=this._validate(e,o,r,t.local.invalidMonth);(e=i.year())<0&&e++;for(var u=i.day(),s=1;s<i.month();s++)u+=this.daysPerMonth[s-1];return u+l.toJD(e+1468,3,13)},fromJD:function(e){e=Math.floor(e+.5);for(var o=Math.floor((e-(this.jdEpoch-1))/366);e>=this.toJD(o+1,1,1);)o++;for(var r=e-Math.floor(this.toJD(o,1,1)+.5)+1,i=1;r>this.daysInMonth(o,i);)r-=this.daysInMonth(o,i),i++;return this.newDate(o,i,r)}}),t.calendars.nanakshahi=p},{"../main":621,"object-assign":499}],616:[function(n,z,q){var t=n("../main"),h=n("object-assign");function p(l){this.local=this.regionalOptions[l||""]||this.regionalOptions[""]}p.prototype=new t.baseCalendar,h(p.prototype,{name:"Nepali",jdEpoch:17007095e-1,daysPerMonth:[31,31,32,32,31,30,30,29,30,29,30,30],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,daysPerYear:365,regionalOptions:{"":{name:"Nepali",epochs:["BBS","ABS"],monthNames:["Baisakh","Jestha","Ashadh","Shrawan","Bhadra","Ashwin","Kartik","Mangsir","Paush","Mangh","Falgun","Chaitra"],monthNamesShort:["Bai","Je","As","Shra","Bha","Ash","Kar","Mang","Pau","Ma","Fal","Chai"],dayNames:["Aaitabaar","Sombaar","Manglbaar","Budhabaar","Bihibaar","Shukrabaar","Shanibaar"],dayNamesShort:["Aaita","Som","Mangl","Budha","Bihi","Shukra","Shani"],dayNamesMin:["Aai","So","Man","Bu","Bi","Shu","Sha"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:1,isRTL:!1}},leapYear:function(l){return this.daysInYear(l)!==this.daysPerYear},weekOfYear:function(l,e,o){var r=this.newDate(l,e,o);return r.add(-r.dayOfWeek(),"d"),Math.floor((r.dayOfYear()-1)/7)+1},daysInYear:function(l){if(l=this._validate(l,this.minMonth,this.minDay,t.local.invalidYear).year(),typeof this.NEPALI_CALENDAR_DATA[l]>"u")return this.daysPerYear;for(var e=0,o=this.minMonth;o<=12;o++)e+=this.NEPALI_CALENDAR_DATA[l][o];return e},daysInMonth:function(l,e){return l.year&&(e=l.month(),l=l.year()),this._validate(l,e,this.minDay,t.local.invalidMonth),typeof this.NEPALI_CALENDAR_DATA[l]>"u"?this.daysPerMonth[e-1]:this.NEPALI_CALENDAR_DATA[l][e]},weekDay:function(l,e,o){return this.dayOfWeek(l,e,o)!==6},toJD:function(l,e,o){var r=this._validate(l,e,o,t.local.invalidDate);l=r.year(),e=r.month(),o=r.day();var i=t.instance(),u=0,s=e,a=l;this._createMissingCalendarData(l);var c=l-(s>9||s===9&&o>=this.NEPALI_CALENDAR_DATA[a][0]?56:57);for(e!==9&&(u=o,s--);s!==9;)s<=0&&(s=12,a--),u+=this.NEPALI_CALENDAR_DATA[a][s],s--;return e===9?(u+=o-this.NEPALI_CALENDAR_DATA[a][0])<0&&(u+=i.daysInYear(c)):u+=this.NEPALI_CALENDAR_DATA[a][9]-this.NEPALI_CALENDAR_DATA[a][0],i.newDate(c,1,1).add(u,"d").toJD()},fromJD:function(l){var e=t.instance().fromJD(l),o=e.year(),r=e.dayOfYear(),i=o+56;this._createMissingCalendarData(i);for(var u=9,s=this.NEPALI_CALENDAR_DATA[i][0],a=this.NEPALI_CALENDAR_DATA[i][u]-s+1;r>a;)++u>12&&(u=1,i++),a+=this.NEPALI_CALENDAR_DATA[i][u];var c=this.NEPALI_CALENDAR_DATA[i][u]-(a-r);return this.newDate(i,u,c)},_createMissingCalendarData:function(l){var e=this.daysPerMonth.slice(0);e.unshift(17);for(var o=l-1;o<l+2;o++)typeof this.NEPALI_CALENDAR_DATA[o]>"u"&&(this.NEPALI_CALENDAR_DATA[o]=e)},NEPALI_CALENDAR_DATA:{1970:[18,31,31,32,31,31,31,30,29,30,29,30,30],1971:[18,31,31,32,31,32,30,30,29,30,29,30,30],1972:[17,31,32,31,32,31,30,30,30,29,29,30,30],1973:[19,30,32,31,32,31,30,30,30,29,30,29,31],1974:[19,31,31,32,30,31,31,30,29,30,29,30,30],1975:[18,31,31,32,32,30,31,30,29,30,29,30,30],1976:[17,31,32,31,32,31,30,30,30,29,29,30,31],1977:[18,31,32,31,32,31,31,29,30,29,30,29,31],1978:[18,31,31,32,31,31,31,30,29,30,29,30,30],1979:[18,31,31,32,32,31,30,30,29,30,29,30,30],1980:[17,31,32,31,32,31,30,30,30,29,29,30,31],1981:[18,31,31,31,32,31,31,29,30,30,29,30,30],1982:[18,31,31,32,31,31,31,30,29,30,29,30,30],1983:[18,31,31,32,32,31,30,30,29,30,29,30,30],1984:[17,31,32,31,32,31,30,30,30,29,29,30,31],1985:[18,31,31,31,32,31,31,29,30,30,29,30,30],1986:[18,31,31,32,31,31,31,30,29,30,29,30,30],1987:[18,31,32,31,32,31,30,30,29,30,29,30,30],1988:[17,31,32,31,32,31,30,30,30,29,29,30,31],1989:[18,31,31,31,32,31,31,30,29,30,29,30,30],1990:[18,31,31,32,31,31,31,30,29,30,29,30,30],1991:[18,31,32,31,32,31,30,30,29,30,29,30,30],1992:[17,31,32,31,32,31,30,30,30,29,30,29,31],1993:[18,31,31,31,32,31,31,30,29,30,29,30,30],1994:[18,31,31,32,31,31,31,30,29,30,29,30,30],1995:[17,31,32,31,32,31,30,30,30,29,29,30,30],1996:[17,31,32,31,32,31,30,30,30,29,30,29,31],1997:[18,31,31,32,31,31,31,30,29,30,29,30,30],1998:[18,31,31,32,31,31,31,30,29,30,29,30,30],1999:[17,31,32,31,32,31,30,30,30,29,29,30,31],2e3:[17,30,32,31,32,31,30,30,30,29,30,29,31],2001:[18,31,31,32,31,31,31,30,29,30,29,30,30],2002:[18,31,31,32,32,31,30,30,29,30,29,30,30],2003:[17,31,32,31,32,31,30,30,30,29,29,30,31],2004:[17,30,32,31,32,31,30,30,30,29,30,29,31],2005:[18,31,31,32,31,31,31,30,29,30,29,30,30],2006:[18,31,31,32,32,31,30,30,29,30,29,30,30],2007:[17,31,32,31,32,31,30,30,30,29,29,30,31],2008:[17,31,31,31,32,31,31,29,30,30,29,29,31],2009:[18,31,31,32,31,31,31,30,29,30,29,30,30],2010:[18,31,31,32,32,31,30,30,29,30,29,30,30],2011:[17,31,32,31,32,31,30,30,30,29,29,30,31],2012:[17,31,31,31,32,31,31,29,30,30,29,30,30],2013:[18,31,31,32,31,31,31,30,29,30,29,30,30],2014:[18,31,31,32,32,31,30,30,29,30,29,30,30],2015:[17,31,32,31,32,31,30,30,30,29,29,30,31],2016:[17,31,31,31,32,31,31,29,30,30,29,30,30],2017:[18,31,31,32,31,31,31,30,29,30,29,30,30],2018:[18,31,32,31,32,31,30,30,29,30,29,30,30],2019:[17,31,32,31,32,31,30,30,30,29,30,29,31],2020:[17,31,31,31,32,31,31,30,29,30,29,30,30],2021:[18,31,31,32,31,31,31,30,29,30,29,30,30],2022:[17,31,32,31,32,31,30,30,30,29,29,30,30],2023:[17,31,32,31,32,31,30,30,30,29,30,29,31],2024:[17,31,31,31,32,31,31,30,29,30,29,30,30],2025:[18,31,31,32,31,31,31,30,29,30,29,30,30],2026:[17,31,32,31,32,31,30,30,30,29,29,30,31],2027:[17,30,32,31,32,31,30,30,30,29,30,29,31],2028:[17,31,31,32,31,31,31,30,29,30,29,30,30],2029:[18,31,31,32,31,32,30,30,29,30,29,30,30],2030:[17,31,32,31,32,31,30,30,30,30,30,30,31],2031:[17,31,32,31,32,31,31,31,31,31,31,31,31],2032:[17,32,32,32,32,32,32,32,32,32,32,32,32],2033:[18,31,31,32,32,31,30,30,29,30,29,30,30],2034:[17,31,32,31,32,31,30,30,30,29,29,30,31],2035:[17,30,32,31,32,31,31,29,30,30,29,29,31],2036:[17,31,31,32,31,31,31,30,29,30,29,30,30],2037:[18,31,31,32,32,31,30,30,29,30,29,30,30],2038:[17,31,32,31,32,31,30,30,30,29,29,30,31],2039:[17,31,31,31,32,31,31,29,30,30,29,30,30],2040:[17,31,31,32,31,31,31,30,29,30,29,30,30],2041:[18,31,31,32,32,31,30,30,29,30,29,30,30],2042:[17,31,32,31,32,31,30,30,30,29,29,30,31],2043:[17,31,31,31,32,31,31,29,30,30,29,30,30],2044:[17,31,31,32,31,31,31,30,29,30,29,30,30],2045:[18,31,32,31,32,31,30,30,29,30,29,30,30],2046:[17,31,32,31,32,31,30,30,30,29,29,30,31],2047:[17,31,31,31,32,31,31,30,29,30,29,30,30],2048:[17,31,31,32,31,31,31,30,29,30,29,30,30],2049:[17,31,32,31,32,31,30,30,30,29,29,30,30],2050:[17,31,32,31,32,31,30,30,30,29,30,29,31],2051:[17,31,31,31,32,31,31,30,29,30,29,30,30],2052:[17,31,31,32,31,31,31,30,29,30,29,30,30],2053:[17,31,32,31,32,31,30,30,30,29,29,30,30],2054:[17,31,32,31,32,31,30,30,30,29,30,29,31],2055:[17,31,31,32,31,31,31,30,29,30,30,29,30],2056:[17,31,31,32,31,32,30,30,29,30,29,30,30],2057:[17,31,32,31,32,31,30,30,30,29,29,30,31],2058:[17,30,32,31,32,31,30,30,30,29,30,29,31],2059:[17,31,31,32,31,31,31,30,29,30,29,30,30],2060:[17,31,31,32,32,31,30,30,29,30,29,30,30],2061:[17,31,32,31,32,31,30,30,30,29,29,30,31],2062:[17,30,32,31,32,31,31,29,30,29,30,29,31],2063:[17,31,31,32,31,31,31,30,29,30,29,30,30],2064:[17,31,31,32,32,31,30,30,29,30,29,30,30],2065:[17,31,32,31,32,31,30,30,30,29,29,30,31],2066:[17,31,31,31,32,31,31,29,30,30,29,29,31],2067:[17,31,31,32,31,31,31,30,29,30,29,30,30],2068:[17,31,31,32,32,31,30,30,29,30,29,30,30],2069:[17,31,32,31,32,31,30,30,30,29,29,30,31],2070:[17,31,31,31,32,31,31,29,30,30,29,30,30],2071:[17,31,31,32,31,31,31,30,29,30,29,30,30],2072:[17,31,32,31,32,31,30,30,29,30,29,30,30],2073:[17,31,32,31,32,31,30,30,30,29,29,30,31],2074:[17,31,31,31,32,31,31,30,29,30,29,30,30],2075:[17,31,31,32,31,31,31,30,29,30,29,30,30],2076:[16,31,32,31,32,31,30,30,30,29,29,30,30],2077:[17,31,32,31,32,31,30,30,30,29,30,29,31],2078:[17,31,31,31,32,31,31,30,29,30,29,30,30],2079:[17,31,31,32,31,31,31,30,29,30,29,30,30],2080:[16,31,32,31,32,31,30,30,30,29,29,30,30],2081:[17,31,31,32,32,31,30,30,30,29,30,30,30],2082:[17,31,32,31,32,31,30,30,30,29,30,30,30],2083:[17,31,31,32,31,31,30,30,30,29,30,30,30],2084:[17,31,31,32,31,31,30,30,30,29,30,30,30],2085:[17,31,32,31,32,31,31,30,30,29,30,30,30],2086:[17,31,32,31,32,31,30,30,30,29,30,30,30],2087:[16,31,31,32,31,31,31,30,30,29,30,30,30],2088:[16,30,31,32,32,30,31,30,30,29,30,30,30],2089:[17,31,32,31,32,31,30,30,30,29,30,30,30],2090:[17,31,32,31,32,31,30,30,30,29,30,30,30],2091:[16,31,31,32,31,31,31,30,30,29,30,30,30],2092:[16,31,31,32,32,31,30,30,30,29,30,30,30],2093:[17,31,32,31,32,31,30,30,30,29,30,30,30],2094:[17,31,31,32,31,31,30,30,30,29,30,30,30],2095:[17,31,31,32,31,31,31,30,29,30,30,30,30],2096:[17,30,31,32,32,31,30,30,29,30,29,30,30],2097:[17,31,32,31,32,31,30,30,30,29,30,30,30],2098:[17,31,31,32,31,31,31,29,30,29,30,30,31],2099:[17,31,31,32,31,31,31,30,29,29,30,30,30],2100:[17,31,32,31,32,30,31,30,29,30,29,30,30]}}),t.calendars.nepali=p},{"../main":621,"object-assign":499}],617:[function(n,z,q){var t=n("../main"),h=n("object-assign");function p(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}function l(e,o){return e-o*Math.floor(e/o)}p.prototype=new t.baseCalendar,h(p.prototype,{name:"Persian",jdEpoch:19483205e-1,daysPerMonth:[31,31,31,31,31,31,30,30,30,30,30,29],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Persian",epochs:["BP","AP"],monthNames:["Farvardin","Ordibehesht","Khordad","Tir","Mordad","Shahrivar","Mehr","Aban","Azar","Day","Bahman","Esfand"],monthNamesShort:["Far","Ord","Kho","Tir","Mor","Sha","Meh","Aba","Aza","Day","Bah","Esf"],dayNames:["Yekshambe","Doshambe","Seshambe","Ch\xE6harshambe","Panjshambe","Jom'e","Shambe"],dayNamesShort:["Yek","Do","Se","Ch\xE6","Panj","Jom","Sha"],dayNamesMin:["Ye","Do","Se","Ch","Pa","Jo","Sh"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!1}},leapYear:function(e){var o=this._validate(e,this.minMonth,this.minDay,t.local.invalidYear);return 682*((o.year()-(o.year()>0?474:473))%2820+474+38)%2816<682},weekOfYear:function(e,o,r){var i=this.newDate(e,o,r);return i.add(-(i.dayOfWeek()+1)%7,"d"),Math.floor((i.dayOfYear()-1)/7)+1},daysInMonth:function(e,o){var r=this._validate(e,o,this.minDay,t.local.invalidMonth);return this.daysPerMonth[r.month()-1]+(r.month()===12&&this.leapYear(r.year())?1:0)},weekDay:function(e,o,r){return this.dayOfWeek(e,o,r)!==5},toJD:function(e,o,r){var i=this._validate(e,o,r,t.local.invalidDate);e=i.year(),o=i.month(),r=i.day();var u=e-(e>=0?474:473),s=474+l(u,2820);return r+(o<=7?31*(o-1):30*(o-1)+6)+Math.floor((682*s-110)/2816)+365*(s-1)+1029983*Math.floor(u/2820)+this.jdEpoch-1},fromJD:function(e){var o=(e=Math.floor(e)+.5)-this.toJD(475,1,1),r=Math.floor(o/1029983),i=l(o,1029983),u=2820;if(i!==1029982){var s=Math.floor(i/366),a=l(i,366);u=Math.floor((2134*s+2816*a+2815)/1028522)+s+1}var c=u+2820*r+474;c=c<=0?c-1:c;var f=e-this.toJD(c,1,1)+1,g=f<=186?Math.ceil(f/31):Math.ceil((f-6)/30),d=e-this.toJD(c,g,1)+1;return this.newDate(c,g,d)}}),t.calendars.persian=p,t.calendars.jalali=p},{"../main":621,"object-assign":499}],618:[function(n,z,q){var t=n("../main"),h=n("object-assign"),p=t.instance();function l(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}l.prototype=new t.baseCalendar,h(l.prototype,{name:"Taiwan",jdEpoch:24194025e-1,yearsOffset:1911,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Taiwan",epochs:["BROC","ROC"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:1,isRTL:!1}},leapYear:function(e){var o=this._validate(e,this.minMonth,this.minDay,t.local.invalidYear);return e=this._t2gYear(o.year()),p.leapYear(e)},weekOfYear:function(e,o,r){var i=this._validate(e,this.minMonth,this.minDay,t.local.invalidYear);return e=this._t2gYear(i.year()),p.weekOfYear(e,i.month(),i.day())},daysInMonth:function(e,o){var r=this._validate(e,o,this.minDay,t.local.invalidMonth);return this.daysPerMonth[r.month()-1]+(r.month()===2&&this.leapYear(r.year())?1:0)},weekDay:function(e,o,r){return(this.dayOfWeek(e,o,r)||7)<6},toJD:function(e,o,r){var i=this._validate(e,o,r,t.local.invalidDate);return e=this._t2gYear(i.year()),p.toJD(e,i.month(),i.day())},fromJD:function(e){var o=p.fromJD(e),r=this._g2tYear(o.year());return this.newDate(r,o.month(),o.day())},_t2gYear:function(e){return e+this.yearsOffset+(e>=-this.yearsOffset&&e<=-1?1:0)},_g2tYear:function(e){return e-this.yearsOffset-(e>=1&&e<=this.yearsOffset?1:0)}}),t.calendars.taiwan=l},{"../main":621,"object-assign":499}],619:[function(n,z,q){var t=n("../main"),h=n("object-assign"),p=t.instance();function l(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}l.prototype=new t.baseCalendar,h(l.prototype,{name:"Thai",jdEpoch:15230985e-1,yearsOffset:543,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Thai",epochs:["BBE","BE"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(e){var o=this._validate(e,this.minMonth,this.minDay,t.local.invalidYear);return e=this._t2gYear(o.year()),p.leapYear(e)},weekOfYear:function(e,o,r){var i=this._validate(e,this.minMonth,this.minDay,t.local.invalidYear);return e=this._t2gYear(i.year()),p.weekOfYear(e,i.month(),i.day())},daysInMonth:function(e,o){var r=this._validate(e,o,this.minDay,t.local.invalidMonth);return this.daysPerMonth[r.month()-1]+(r.month()===2&&this.leapYear(r.year())?1:0)},weekDay:function(e,o,r){return(this.dayOfWeek(e,o,r)||7)<6},toJD:function(e,o,r){var i=this._validate(e,o,r,t.local.invalidDate);return e=this._t2gYear(i.year()),p.toJD(e,i.month(),i.day())},fromJD:function(e){var o=p.fromJD(e),r=this._g2tYear(o.year());return this.newDate(r,o.month(),o.day())},_t2gYear:function(e){return e-this.yearsOffset-(e>=1&&e<=this.yearsOffset?1:0)},_g2tYear:function(e){return e+this.yearsOffset+(e>=-this.yearsOffset&&e<=-1?1:0)}}),t.calendars.thai=l},{"../main":621,"object-assign":499}],620:[function(n,z,q){var t=n("../main"),h=n("object-assign");function p(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}p.prototype=new t.baseCalendar,h(p.prototype,{name:"UmmAlQura",hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Umm al-Qura",epochs:["BH","AH"],monthNames:["Al-Muharram","Safar","Rabi' al-awwal","Rabi' Al-Thani","Jumada Al-Awwal","Jumada Al-Thani","Rajab","Sha'aban","Ramadan","Shawwal","Dhu al-Qi'dah","Dhu al-Hijjah"],monthNamesShort:["Muh","Saf","Rab1","Rab2","Jum1","Jum2","Raj","Sha'","Ram","Shaw","DhuQ","DhuH"],dayNames:["Yawm al-Ahad","Yawm al-Ithnain","Yawm al-Thal\u0101th\u0101\u2019","Yawm al-Arba\u2018\u0101\u2019","Yawm al-Kham\u012Bs","Yawm al-Jum\u2018a","Yawm al-Sabt"],dayNamesMin:["Ah","Ith","Th","Ar","Kh","Ju","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!0}},leapYear:function(e){var o=this._validate(e,this.minMonth,this.minDay,t.local.invalidYear);return this.daysInYear(o.year())===355},weekOfYear:function(e,o,r){var i=this.newDate(e,o,r);return i.add(-i.dayOfWeek(),"d"),Math.floor((i.dayOfYear()-1)/7)+1},daysInYear:function(e){for(var o=0,r=1;r<=12;r++)o+=this.daysInMonth(e,r);return o},daysInMonth:function(e,o){for(var r=this._validate(e,o,this.minDay,t.local.invalidMonth).toJD()-24e5+.5,i=0,u=0;u<l.length;u++){if(l[u]>r)return l[i]-l[i-1];i++}return 30},weekDay:function(e,o,r){return this.dayOfWeek(e,o,r)!==5},toJD:function(e,o,r){var i=this._validate(e,o,r,t.local.invalidDate),u=12*(i.year()-1)+i.month()-15292;return i.day()+l[u-1]-1+24e5-.5},fromJD:function(e){for(var o=e-24e5+.5,r=0,i=0;i<l.length&&!(l[i]>o);i++)r++;var u=r+15292,s=Math.floor((u-1)/12),a=s+1,c=u-12*s,f=o-l[r-1]+1;return this.newDate(a,c,f)},isValid:function(e,o,r){var i=t.baseCalendar.prototype.isValid.apply(this,arguments);return i&&(i=(e=e.year!=null?e.year:e)>=1276&&e<=1500),i},_validate:function(e,o,r,i){var u=t.baseCalendar.prototype._validate.apply(this,arguments);if(u.year<1276||u.year>1500)throw i.replace(/\{0\}/,this.local.name);return u}}),t.calendars.ummalqura=p;var l=[20,50,79,109,138,168,197,227,256,286,315,345,374,404,433,463,492,522,551,581,611,641,670,700,729,759,788,818,847,877,906,936,965,995,1024,1054,1083,1113,1142,1172,1201,1231,1260,1290,1320,1350,1379,1409,1438,1468,1497,1527,1556,1586,1615,1645,1674,1704,1733,1763,1792,1822,1851,1881,1910,1940,1969,1999,2028,2058,2087,2117,2146,2176,2205,2235,2264,2294,2323,2353,2383,2413,2442,2472,2501,2531,2560,2590,2619,2649,2678,2708,2737,2767,2796,2826,2855,2885,2914,2944,2973,3003,3032,3062,3091,3121,3150,3180,3209,3239,3268,3298,3327,3357,3386,3416,3446,3476,3505,3535,3564,3594,3623,3653,3682,3712,3741,3771,3800,3830,3859,3889,3918,3948,3977,4007,4036,4066,4095,4125,4155,4185,4214,4244,4273,4303,4332,4362,4391,4421,4450,4480,4509,4539,4568,4598,4627,4657,4686,4716,4745,4775,4804,4834,4863,4893,4922,4952,4981,5011,5040,5070,5099,5129,5158,5188,5218,5248,5277,5307,5336,5366,5395,5425,5454,5484,5513,5543,5572,5602,5631,5661,5690,5720,5749,5779,5808,5838,5867,5897,5926,5956,5985,6015,6044,6074,6103,6133,6162,6192,6221,6251,6281,6311,6340,6370,6399,6429,6458,6488,6517,6547,6576,6606,6635,6665,6694,6724,6753,6783,6812,6842,6871,6901,6930,6960,6989,7019,7048,7078,7107,7137,7166,7196,7225,7255,7284,7314,7344,7374,7403,7433,7462,7492,7521,7551,7580,7610,7639,7669,7698,7728,7757,7787,7816,7846,7875,7905,7934,7964,7993,8023,8053,8083,8112,8142,8171,8201,8230,8260,8289,8319,8348,8378,8407,8437,8466,8496,8525,8555,8584,8614,8643,8673,8702,8732,8761,8791,8821,8850,8880,8909,8938,8968,8997,9027,9056,9086,9115,9145,9175,9205,9234,9264,9293,9322,9352,9381,9410,9440,9470,9499,9529,9559,9589,9618,9648,9677,9706,9736,9765,9794,9824,9853,9883,9913,9943,9972,10002,10032,10061,10090,10120,10149,10178,10208,10237,10267,10297,10326,10356,10386,10415,10445,10474,10504,10533,10562,10592,10621,10651,10680,10710,10740,10770,10799,10829,10858,10888,10917,10947,10976,11005,11035,11064,11094,11124,11153,11183,11213,11242,11272,11301,11331,11360,11389,11419,11448,11478,11507,11537,11567,11596,11626,11655,11685,11715,11744,11774,11803,11832,11862,11891,11921,11950,11980,12010,12039,12069,12099,12128,12158,12187,12216,12246,12275,12304,12334,12364,12393,12423,12453,12483,12512,12542,12571,12600,12630,12659,12688,12718,12747,12777,12807,12837,12866,12896,12926,12955,12984,13014,13043,13072,13102,13131,13161,13191,13220,13250,13280,13310,13339,13368,13398,13427,13456,13486,13515,13545,13574,13604,13634,13664,13693,13723,13752,13782,13811,13840,13870,13899,13929,13958,13988,14018,14047,14077,14107,14136,14166,14195,14224,14254,14283,14313,14342,14372,14401,14431,14461,14490,14520,14550,14579,14609,14638,14667,14697,14726,14756,14785,14815,14844,14874,14904,14933,14963,14993,15021,15051,15081,15110,15140,15169,15199,15228,15258,15287,15317,15347,15377,15406,15436,15465,15494,15524,15553,15582,15612,15641,15671,15701,15731,15760,15790,15820,15849,15878,15908,15937,15966,15996,16025,16055,16085,16114,16144,16174,16204,16233,16262,16292,16321,16350,16380,16409,16439,16468,16498,16528,16558,16587,16617,16646,16676,16705,16734,16764,16793,16823,16852,16882,16912,16941,16971,17001,17030,17060,17089,17118,17148,17177,17207,17236,17266,17295,17325,17355,17384,17414,17444,17473,17502,17532,17561,17591,17620,17650,17679,17709,17738,17768,17798,17827,17857,17886,17916,17945,17975,18004,18034,18063,18093,18122,18152,18181,18211,18241,18270,18300,18330,18359,18388,18418,18447,18476,18506,18535,18565,18595,18625,18654,18684,18714,18743,18772,18802,18831,18860,18890,18919,18949,18979,19008,19038,19068,19098,19127,19156,19186,19215,19244,19274,19303,19333,19362,19392,19422,19452,19481,19511,19540,19570,19599,19628,19658,19687,19717,19746,19776,19806,19836,19865,19895,19924,19954,19983,20012,20042,20071,20101,20130,20160,20190,20219,20249,20279,20308,20338,20367,20396,20426,20455,20485,20514,20544,20573,20603,20633,20662,20692,20721,20751,20780,20810,20839,20869,20898,20928,20957,20987,21016,21046,21076,21105,21135,21164,21194,21223,21253,21282,21312,21341,21371,21400,21430,21459,21489,21519,21548,21578,21607,21637,21666,21696,21725,21754,21784,21813,21843,21873,21902,21932,21962,21991,22021,22050,22080,22109,22138,22168,22197,22227,22256,22286,22316,22346,22375,22405,22434,22464,22493,22522,22552,22581,22611,22640,22670,22700,22730,22759,22789,22818,22848,22877,22906,22936,22965,22994,23024,23054,23083,23113,23143,23173,23202,23232,23261,23290,23320,23349,23379,23408,23438,23467,23497,23527,23556,23586,23616,23645,23674,23704,23733,23763,23792,23822,23851,23881,23910,23940,23970,23999,24029,24058,24088,24117,24147,24176,24206,24235,24265,24294,24324,24353,24383,24413,24442,24472,24501,24531,24560,24590,24619,24648,24678,24707,24737,24767,24796,24826,24856,24885,24915,24944,24974,25003,25032,25062,25091,25121,25150,25180,25210,25240,25269,25299,25328,25358,25387,25416,25446,25475,25505,25534,25564,25594,25624,25653,25683,25712,25742,25771,25800,25830,25859,25888,25918,25948,25977,26007,26037,26067,26096,26126,26155,26184,26214,26243,26272,26302,26332,26361,26391,26421,26451,26480,26510,26539,26568,26598,26627,26656,26686,26715,26745,26775,26805,26834,26864,26893,26923,26952,26982,27011,27041,27070,27099,27129,27159,27188,27218,27248,27277,27307,27336,27366,27395,27425,27454,27484,27513,27542,27572,27602,27631,27661,27691,27720,27750,27779,27809,27838,27868,27897,27926,27956,27985,28015,28045,28074,28104,28134,28163,28193,28222,28252,28281,28310,28340,28369,28399,28428,28458,28488,28517,28547,28577,28607,28636,28665,28695,28724,28754,28783,28813,28843,28872,28901,28931,28960,28990,29019,29049,29078,29108,29137,29167,29196,29226,29255,29285,29315,29345,29375,29404,29434,29463,29492,29522,29551,29580,29610,29640,29669,29699,29729,29759,29788,29818,29847,29876,29906,29935,29964,29994,30023,30053,30082,30112,30141,30171,30200,30230,30259,30289,30318,30348,30378,30408,30437,30467,30496,30526,30555,30585,30614,30644,30673,30703,30732,30762,30791,30821,30850,30880,30909,30939,30968,30998,31027,31057,31086,31116,31145,31175,31204,31234,31263,31293,31322,31352,31381,31411,31441,31471,31500,31530,31559,31589,31618,31648,31676,31706,31736,31766,31795,31825,31854,31884,31913,31943,31972,32002,32031,32061,32090,32120,32150,32180,32209,32239,32268,32298,32327,32357,32386,32416,32445,32475,32504,32534,32563,32593,32622,32652,32681,32711,32740,32770,32799,32829,32858,32888,32917,32947,32976,33006,33035,33065,33094,33124,33153,33183,33213,33243,33272,33302,33331,33361,33390,33420,33450,33479,33509,33539,33568,33598,33627,33657,33686,33716,33745,33775,33804,33834,33863,33893,33922,33952,33981,34011,34040,34069,34099,34128,34158,34187,34217,34247,34277,34306,34336,34365,34395,34424,34454,34483,34512,34542,34571,34601,34631,34660,34690,34719,34749,34778,34808,34837,34867,34896,34926,34955,34985,35015,35044,35074,35103,35133,35162,35192,35222,35251,35280,35310,35340,35370,35399,35429,35458,35488,35517,35547,35576,35605,35635,35665,35694,35723,35753,35782,35811,35841,35871,35901,35930,35960,35989,36019,36048,36078,36107,36136,36166,36195,36225,36254,36284,36314,36343,36373,36403,36433,36462,36492,36521,36551,36580,36610,36639,36669,36698,36728,36757,36786,36816,36845,36875,36904,36934,36963,36993,37022,37052,37081,37111,37141,37170,37200,37229,37259,37288,37318,37347,37377,37406,37436,37465,37495,37524,37554,37584,37613,37643,37672,37701,37731,37760,37790,37819,37849,37878,37908,37938,37967,37997,38027,38056,38085,38115,38144,38174,38203,38233,38262,38292,38322,38351,38381,38410,38440,38469,38499,38528,38558,38587,38617,38646,38676,38705,38735,38764,38794,38823,38853,38882,38912,38941,38971,39001,39030,39059,39089,39118,39148,39178,39208,39237,39267,39297,39326,39355,39385,39414,39444,39473,39503,39532,39562,39592,39621,39650,39680,39709,39739,39768,39798,39827,39857,39886,39916,39946,39975,40005,40035,40064,40094,40123,40153,40182,40212,40241,40271,40300,40330,40359,40389,40418,40448,40477,40507,40536,40566,40595,40625,40655,40685,40714,40744,40773,40803,40832,40862,40892,40921,40951,40980,41009,41039,41068,41098,41127,41157,41186,41216,41245,41275,41304,41334,41364,41393,41422,41452,41481,41511,41540,41570,41599,41629,41658,41688,41718,41748,41777,41807,41836,41865,41894,41924,41953,41983,42012,42042,42072,42102,42131,42161,42190,42220,42249,42279,42308,42337,42367,42397,42426,42456,42485,42515,42545,42574,42604,42633,42662,42692,42721,42751,42780,42810,42839,42869,42899,42929,42958,42988,43017,43046,43076,43105,43135,43164,43194,43223,43253,43283,43312,43342,43371,43401,43430,43460,43489,43519,43548,43578,43607,43637,43666,43696,43726,43755,43785,43814,43844,43873,43903,43932,43962,43991,44021,44050,44080,44109,44139,44169,44198,44228,44258,44287,44317,44346,44375,44405,44434,44464,44493,44523,44553,44582,44612,44641,44671,44700,44730,44759,44788,44818,44847,44877,44906,44936,44966,44996,45025,45055,45084,45114,45143,45172,45202,45231,45261,45290,45320,45350,45380,45409,45439,45468,45498,45527,45556,45586,45615,45644,45674,45704,45733,45763,45793,45823,45852,45882,45911,45940,45970,45999,46028,46058,46088,46117,46147,46177,46206,46236,46265,46295,46324,46354,46383,46413,46442,46472,46501,46531,46560,46590,46620,46649,46679,46708,46738,46767,46797,46826,46856,46885,46915,46944,46974,47003,47033,47063,47092,47122,47151,47181,47210,47240,47269,47298,47328,47357,47387,47417,47446,47476,47506,47535,47565,47594,47624,47653,47682,47712,47741,47771,47800,47830,47860,47890,47919,47949,47978,48008,48037,48066,48096,48125,48155,48184,48214,48244,48273,48303,48333,48362,48392,48421,48450,48480,48509,48538,48568,48598,48627,48657,48687,48717,48746,48776,48805,48834,48864,48893,48922,48952,48982,49011,49041,49071,49100,49130,49160,49189,49218,49248,49277,49306,49336,49365,49395,49425,49455,49484,49514,49543,49573,49602,49632,49661,49690,49720,49749,49779,49809,49838,49868,49898,49927,49957,49986,50016,50045,50075,50104,50133,50163,50192,50222,50252,50281,50311,50340,50370,50400,50429,50459,50488,50518,50547,50576,50606,50635,50665,50694,50724,50754,50784,50813,50843,50872,50902,50931,50960,50990,51019,51049,51078,51108,51138,51167,51197,51227,51256,51286,51315,51345,51374,51403,51433,51462,51492,51522,51552,51582,51611,51641,51670,51699,51729,51758,51787,51816,51846,51876,51906,51936,51965,51995,52025,52054,52083,52113,52142,52171,52200,52230,52260,52290,52319,52349,52379,52408,52438,52467,52497,52526,52555,52585,52614,52644,52673,52703,52733,52762,52792,52822,52851,52881,52910,52939,52969,52998,53028,53057,53087,53116,53146,53176,53205,53235,53264,53294,53324,53353,53383,53412,53441,53471,53500,53530,53559,53589,53619,53648,53678,53708,53737,53767,53796,53825,53855,53884,53913,53943,53973,54003,54032,54062,54092,54121,54151,54180,54209,54239,54268,54297,54327,54357,54387,54416,54446,54476,54505,54535,54564,54593,54623,54652,54681,54711,54741,54770,54800,54830,54859,54889,54919,54948,54977,55007,55036,55066,55095,55125,55154,55184,55213,55243,55273,55302,55332,55361,55391,55420,55450,55479,55508,55538,55567,55597,55627,55657,55686,55716,55745,55775,55804,55834,55863,55892,55922,55951,55981,56011,56040,56070,56100,56129,56159,56188,56218,56247,56276,56306,56335,56365,56394,56424,56454,56483,56513,56543,56572,56601,56631,56660,56690,56719,56749,56778,56808,56837,56867,56897,56926,56956,56985,57015,57044,57074,57103,57133,57162,57192,57221,57251,57280,57310,57340,57369,57399,57429,57458,57487,57517,57546,57576,57605,57634,57664,57694,57723,57753,57783,57813,57842,57871,57901,57930,57959,57989,58018,58048,58077,58107,58137,58167,58196,58226,58255,58285,58314,58343,58373,58402,58432,58461,58491,58521,58551,58580,58610,58639,58669,58698,58727,58757,58786,58816,58845,58875,58905,58934,58964,58994,59023,59053,59082,59111,59141,59170,59200,59229,59259,59288,59318,59348,59377,59407,59436,59466,59495,59525,59554,59584,59613,59643,59672,59702,59731,59761,59791,59820,59850,59879,59909,59939,59968,59997,60027,60056,60086,60115,60145,60174,60204,60234,60264,60293,60323,60352,60381,60411,60440,60469,60499,60528,60558,60588,60618,60648,60677,60707,60736,60765,60795,60824,60853,60883,60912,60942,60972,61002,61031,61061,61090,61120,61149,61179,61208,61237,61267,61296,61326,61356,61385,61415,61445,61474,61504,61533,61563,61592,61621,61651,61680,61710,61739,61769,61799,61828,61858,61888,61917,61947,61976,62006,62035,62064,62094,62123,62153,62182,62212,62242,62271,62301,62331,62360,62390,62419,62448,62478,62507,62537,62566,62596,62625,62655,62685,62715,62744,62774,62803,62832,62862,62891,62921,62950,62980,63009,63039,63069,63099,63128,63157,63187,63216,63246,63275,63305,63334,63363,63393,63423,63453,63482,63512,63541,63571,63600,63630,63659,63689,63718,63747,63777,63807,63836,63866,63895,63925,63955,63984,64014,64043,64073,64102,64131,64161,64190,64220,64249,64279,64309,64339,64368,64398,64427,64457,64486,64515,64545,64574,64603,64633,64663,64692,64722,64752,64782,64811,64841,64870,64899,64929,64958,64987,65017,65047,65076,65106,65136,65166,65195,65225,65254,65283,65313,65342,65371,65401,65431,65460,65490,65520,65549,65579,65608,65638,65667,65697,65726,65755,65785,65815,65844,65874,65903,65933,65963,65992,66022,66051,66081,66110,66140,66169,66199,66228,66258,66287,66317,66346,66376,66405,66435,66465,66494,66524,66553,66583,66612,66641,66671,66700,66730,66760,66789,66819,66849,66878,66908,66937,66967,66996,67025,67055,67084,67114,67143,67173,67203,67233,67262,67292,67321,67351,67380,67409,67439,67468,67497,67527,67557,67587,67617,67646,67676,67705,67735,67764,67793,67823,67852,67882,67911,67941,67971,68e3,68030,68060,68089,68119,68148,68177,68207,68236,68266,68295,68325,68354,68384,68414,68443,68473,68502,68532,68561,68591,68620,68650,68679,68708,68738,68768,68797,68827,68857,68886,68916,68946,68975,69004,69034,69063,69092,69122,69152,69181,69211,69240,69270,69300,69330,69359,69388,69418,69447,69476,69506,69535,69565,69595,69624,69654,69684,69713,69743,69772,69802,69831,69861,69890,69919,69949,69978,70008,70038,70067,70097,70126,70156,70186,70215,70245,70274,70303,70333,70362,70392,70421,70451,70481,70510,70540,70570,70599,70629,70658,70687,70717,70746,70776,70805,70835,70864,70894,70924,70954,70983,71013,71042,71071,71101,71130,71159,71189,71218,71248,71278,71308,71337,71367,71397,71426,71455,71485,71514,71543,71573,71602,71632,71662,71691,71721,71751,71781,71810,71839,71869,71898,71927,71957,71986,72016,72046,72075,72105,72135,72164,72194,72223,72253,72282,72311,72341,72370,72400,72429,72459,72489,72518,72548,72577,72607,72637,72666,72695,72725,72754,72784,72813,72843,72872,72902,72931,72961,72991,73020,73050,73080,73109,73139,73168,73197,73227,73256,73286,73315,73345,73375,73404,73434,73464,73493,73523,73552,73581,73611,73640,73669,73699,73729,73758,73788,73818,73848,73877,73907,73936,73965,73995,74024,74053,74083,74113,74142,74172,74202,74231,74261,74291,74320,74349,74379,74408,74437,74467,74497,74526,74556,74586,74615,74645,74675,74704,74733,74763,74792,74822,74851,74881,74910,74940,74969,74999,75029,75058,75088,75117,75147,75176,75206,75235,75264,75294,75323,75353,75383,75412,75442,75472,75501,75531,75560,75590,75619,75648,75678,75707,75737,75766,75796,75826,75856,75885,75915,75944,75974,76003,76032,76062,76091,76121,76150,76180,76210,76239,76269,76299,76328,76358,76387,76416,76446,76475,76505,76534,76564,76593,76623,76653,76682,76712,76741,76771,76801,76830,76859,76889,76918,76948,76977,77007,77036,77066,77096,77125,77155,77185,77214,77243,77273,77302,77332,77361,77390,77420,77450,77479,77509,77539,77569,77598,77627,77657,77686,77715,77745,77774,77804,77833,77863,77893,77923,77952,77982,78011,78041,78070,78099,78129,78158,78188,78217,78247,78277,78307,78336,78366,78395,78425,78454,78483,78513,78542,78572,78601,78631,78661,78690,78720,78750,78779,78808,78838,78867,78897,78926,78956,78985,79015,79044,79074,79104,79133,79163,79192,79222,79251,79281,79310,79340,79369,79399,79428,79458,79487,79517,79546,79576,79606,79635,79665,79695,79724,79753,79783,79812,79841,79871,79900,79930,79960,79990]},{"../main":621,"object-assign":499}],621:[function(n,z,q){var t=n("object-assign");function h(){this.regionalOptions=[],this.regionalOptions[""]={invalidCalendar:"Calendar {0} not found",invalidDate:"Invalid {0} date",invalidMonth:"Invalid {0} month",invalidYear:"Invalid {0} year",differentCalendars:"Cannot mix {0} and {1} dates"},this.local=this.regionalOptions[""],this.calendars={},this._localCals={}}function p(i,u,s,a){if(this._calendar=i,this._year=u,this._month=s,this._day=a,this._calendar._validateLevel===0&&!this._calendar.isValid(this._year,this._month,this._day))throw(r.local.invalidDate||r.regionalOptions[""].invalidDate).replace(/\{0\}/,this._calendar.local.name)}function l(i,u){return"000000".substring(0,u-(i=""+i).length)+i}function e(){this.shortYearCutoff="+10"}function o(i){this.local=this.regionalOptions[i]||this.regionalOptions[""]}t(h.prototype,{instance:function(i,u){i=(i||"gregorian").toLowerCase(),u=u||"";var s=this._localCals[i+"-"+u];if(!s&&this.calendars[i]&&(s=new this.calendars[i](u),this._localCals[i+"-"+u]=s),!s)throw(this.local.invalidCalendar||this.regionalOptions[""].invalidCalendar).replace(/\{0\}/,i);return s},newDate:function(i,u,s,a,c){return(a=(i!=null&&i.year?i.calendar():typeof a=="string"?this.instance(a,c):a)||this.instance()).newDate(i,u,s)},substituteDigits:function(i){return function(u){return(u+"").replace(/[0-9]/g,function(s){return i[s]})}},substituteChineseDigits:function(i,u){return function(s){for(var a="",c=0;s>0;){var f=s%10;a=(f===0?"":i[f]+u[c])+a,c++,s=Math.floor(s/10)}return a.indexOf(i[1]+u[1])===0&&(a=a.substr(1)),a||i[0]}}}),t(p.prototype,{newDate:function(i,u,s){return this._calendar.newDate(i??this,u,s)},year:function(i){return arguments.length===0?this._year:this.set(i,"y")},month:function(i){return arguments.length===0?this._month:this.set(i,"m")},day:function(i){return arguments.length===0?this._day:this.set(i,"d")},date:function(i,u,s){if(!this._calendar.isValid(i,u,s))throw(r.local.invalidDate||r.regionalOptions[""].invalidDate).replace(/\{0\}/,this._calendar.local.name);return this._year=i,this._month=u,this._day=s,this},leapYear:function(){return this._calendar.leapYear(this)},epoch:function(){return this._calendar.epoch(this)},formatYear:function(){return this._calendar.formatYear(this)},monthOfYear:function(){return this._calendar.monthOfYear(this)},weekOfYear:function(){return this._calendar.weekOfYear(this)},daysInYear:function(){return this._calendar.daysInYear(this)},dayOfYear:function(){return this._calendar.dayOfYear(this)},daysInMonth:function(){return this._calendar.daysInMonth(this)},dayOfWeek:function(){return this._calendar.dayOfWeek(this)},weekDay:function(){return this._calendar.weekDay(this)},extraInfo:function(){return this._calendar.extraInfo(this)},add:function(i,u){return this._calendar.add(this,i,u)},set:function(i,u){return this._calendar.set(this,i,u)},compareTo:function(i){if(this._calendar.name!==i._calendar.name)throw(r.local.differentCalendars||r.regionalOptions[""].differentCalendars).replace(/\{0\}/,this._calendar.local.name).replace(/\{1\}/,i._calendar.local.name);var u=this._year!==i._year?this._year-i._year:this._month!==i._month?this.monthOfYear()-i.monthOfYear():this._day-i._day;return u===0?0:u<0?-1:1},calendar:function(){return this._calendar},toJD:function(){return this._calendar.toJD(this)},fromJD:function(i){return this._calendar.fromJD(i)},toJSDate:function(){return this._calendar.toJSDate(this)},fromJSDate:function(i){return this._calendar.fromJSDate(i)},toString:function(){return(this.year()<0?"-":"")+l(Math.abs(this.year()),4)+"-"+l(this.month(),2)+"-"+l(this.day(),2)}}),t(e.prototype,{_validateLevel:0,newDate:function(i,u,s){return i==null?this.today():(i.year&&(this._validate(i,u,s,r.local.invalidDate||r.regionalOptions[""].invalidDate),s=i.day(),u=i.month(),i=i.year()),new p(this,i,u,s))},today:function(){return this.fromJSDate(new Date)},epoch:function(i){return this._validate(i,this.minMonth,this.minDay,r.local.invalidYear||r.regionalOptions[""].invalidYear).year()<0?this.local.epochs[0]:this.local.epochs[1]},formatYear:function(i){var u=this._validate(i,this.minMonth,this.minDay,r.local.invalidYear||r.regionalOptions[""].invalidYear);return(u.year()<0?"-":"")+l(Math.abs(u.year()),4)},monthsInYear:function(i){return this._validate(i,this.minMonth,this.minDay,r.local.invalidYear||r.regionalOptions[""].invalidYear),12},monthOfYear:function(i,u){var s=this._validate(i,u,this.minDay,r.local.invalidMonth||r.regionalOptions[""].invalidMonth);return(s.month()+this.monthsInYear(s)-this.firstMonth)%this.monthsInYear(s)+this.minMonth},fromMonthOfYear:function(i,u){var s=(u+this.firstMonth-2*this.minMonth)%this.monthsInYear(i)+this.minMonth;return this._validate(i,s,this.minDay,r.local.invalidMonth||r.regionalOptions[""].invalidMonth),s},daysInYear:function(i){var u=this._validate(i,this.minMonth,this.minDay,r.local.invalidYear||r.regionalOptions[""].invalidYear);return this.leapYear(u)?366:365},dayOfYear:function(i,u,s){var a=this._validate(i,u,s,r.local.invalidDate||r.regionalOptions[""].invalidDate);return a.toJD()-this.newDate(a.year(),this.fromMonthOfYear(a.year(),this.minMonth),this.minDay).toJD()+1},daysInWeek:function(){return 7},dayOfWeek:function(i,u,s){var a=this._validate(i,u,s,r.local.invalidDate||r.regionalOptions[""].invalidDate);return(Math.floor(this.toJD(a))+2)%this.daysInWeek()},extraInfo:function(i,u,s){return this._validate(i,u,s,r.local.invalidDate||r.regionalOptions[""].invalidDate),{}},add:function(i,u,s){return this._validate(i,this.minMonth,this.minDay,r.local.invalidDate||r.regionalOptions[""].invalidDate),this._correctAdd(i,this._add(i,u,s),u,s)},_add:function(i,u,s){if(this._validateLevel++,s==="d"||s==="w"){var a=i.toJD()+u*(s==="w"?this.daysInWeek():1),c=i.calendar().fromJD(a);return this._validateLevel--,[c.year(),c.month(),c.day()]}try{var f=i.year()+(s==="y"?u:0),g=i.monthOfYear()+(s==="m"?u:0);c=i.day(),s==="y"?(i.month()!==this.fromMonthOfYear(f,g)&&(g=this.newDate(f,i.month(),this.minDay).monthOfYear()),g=Math.min(g,this.monthsInYear(f)),c=Math.min(c,this.daysInMonth(f,this.fromMonthOfYear(f,g)))):s==="m"&&(function(m){for(;g<m.minMonth;)f--,g+=m.monthsInYear(f);for(var y=m.monthsInYear(f);g>y-1+m.minMonth;)f++,g-=y,y=m.monthsInYear(f)}(this),c=Math.min(c,this.daysInMonth(f,this.fromMonthOfYear(f,g))));var d=[f,this.fromMonthOfYear(f,g),c];return this._validateLevel--,d}catch(m){throw this._validateLevel--,m}},_correctAdd:function(i,u,s,a){if(!(this.hasYearZero||a!=="y"&&a!=="m"||u[0]!==0&&i.year()>0==u[0]>0)){var c={y:[1,1,"y"],m:[1,this.monthsInYear(-1),"m"],w:[this.daysInWeek(),this.daysInYear(-1),"d"],d:[1,this.daysInYear(-1),"d"]}[a],f=s<0?-1:1;u=this._add(i,s*c[0]+f*c[1],c[2])}return i.date(u[0],u[1],u[2])},set:function(i,u,s){this._validate(i,this.minMonth,this.minDay,r.local.invalidDate||r.regionalOptions[""].invalidDate);var a=s==="y"?u:i.year(),c=s==="m"?u:i.month(),f=s==="d"?u:i.day();return s!=="y"&&s!=="m"||(f=Math.min(f,this.daysInMonth(a,c))),i.date(a,c,f)},isValid:function(i,u,s){this._validateLevel++;var a=this.hasYearZero||i!==0;if(a){var c=this.newDate(i,u,this.minDay);a=u>=this.minMonth&&u-this.minMonth<this.monthsInYear(c)&&s>=this.minDay&&s-this.minDay<this.daysInMonth(c)}return this._validateLevel--,a},toJSDate:function(i,u,s){var a=this._validate(i,u,s,r.local.invalidDate||r.regionalOptions[""].invalidDate);return r.instance().fromJD(this.toJD(a)).toJSDate()},fromJSDate:function(i){return this.fromJD(r.instance().fromJSDate(i).toJD())},_validate:function(i,u,s,a){if(i.year){if(this._validateLevel===0&&this.name!==i.calendar().name)throw(r.local.differentCalendars||r.regionalOptions[""].differentCalendars).replace(/\{0\}/,this.local.name).replace(/\{1\}/,i.calendar().local.name);return i}try{if(this._validateLevel++,this._validateLevel===1&&!this.isValid(i,u,s))throw a.replace(/\{0\}/,this.local.name);var c=this.newDate(i,u,s);return this._validateLevel--,c}catch(f){throw this._validateLevel--,f}}}),o.prototype=new e,t(o.prototype,{name:"Gregorian",jdEpoch:17214255e-1,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Gregorian",epochs:["BCE","CE"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"mm/dd/yyyy",firstDay:0,isRTL:!1}},leapYear:function(i){var u=this._validate(i,this.minMonth,this.minDay,r.local.invalidYear||r.regionalOptions[""].invalidYear);return(i=u.year()+(u.year()<0?1:0))%4==0&&(i%100!=0||i%400==0)},weekOfYear:function(i,u,s){var a=this.newDate(i,u,s);return a.add(4-(a.dayOfWeek()||7),"d"),Math.floor((a.dayOfYear()-1)/7)+1},daysInMonth:function(i,u){var s=this._validate(i,u,this.minDay,r.local.invalidMonth||r.regionalOptions[""].invalidMonth);return this.daysPerMonth[s.month()-1]+(s.month()===2&&this.leapYear(s.year())?1:0)},weekDay:function(i,u,s){return(this.dayOfWeek(i,u,s)||7)<6},toJD:function(i,u,s){var a=this._validate(i,u,s,r.local.invalidDate||r.regionalOptions[""].invalidDate);i=a.year(),u=a.month(),s=a.day(),i<0&&i++,u<3&&(u+=12,i--);var c=Math.floor(i/100),f=2-c+Math.floor(c/4);return Math.floor(365.25*(i+4716))+Math.floor(30.6001*(u+1))+s+f-1524.5},fromJD:function(i){var u=Math.floor(i+.5),s=Math.floor((u-186721625e-2)/36524.25),a=(s=u+1+s-Math.floor(s/4))+1524,c=Math.floor((a-122.1)/365.25),f=Math.floor(365.25*c),g=Math.floor((a-f)/30.6001),d=a-f-Math.floor(30.6001*g),m=g-(g>13.5?13:1),y=c-(m>2.5?4716:4715);return y<=0&&y--,this.newDate(y,m,d)},toJSDate:function(i,u,s){var a=this._validate(i,u,s,r.local.invalidDate||r.regionalOptions[""].invalidDate),c=new Date(a.year(),a.month()-1,a.day());return c.setHours(0),c.setMinutes(0),c.setSeconds(0),c.setMilliseconds(0),c.setHours(c.getHours()>12?c.getHours()+2:0),c},fromJSDate:function(i){return this.newDate(i.getFullYear(),i.getMonth()+1,i.getDate())}});var r=z.exports=new h;r.cdate=p,r.baseCalendar=e,r.calendars.gregorian=o},{"object-assign":499}],622:[function(n,z,q){var t=n("object-assign"),h=n("./main");t(h.regionalOptions[""],{invalidArguments:"Invalid arguments",invalidFormat:"Cannot format a date from another calendar",missingNumberAt:"Missing number at position {0}",unknownNameAt:"Unknown name at position {0}",unexpectedLiteralAt:"Unexpected literal at position {0}",unexpectedText:"Additional text found at end"}),h.local=h.regionalOptions[""],t(h.cdate.prototype,{formatDate:function(p,l){return typeof p!="string"&&(l=p,p=""),this._calendar.formatDate(p||"",this,l)}}),t(h.baseCalendar.prototype,{UNIX_EPOCH:h.instance().newDate(1970,1,1).toJD(),SECS_PER_DAY:86400,TICKS_EPOCH:h.instance().jdEpoch,TICKS_PER_DAY:864e9,ATOM:"yyyy-mm-dd",COOKIE:"D, dd M yyyy",FULL:"DD, MM d, yyyy",ISO_8601:"yyyy-mm-dd",JULIAN:"J",RFC_822:"D, d M yy",RFC_850:"DD, dd-M-yy",RFC_1036:"D, d M yy",RFC_1123:"D, d M yyyy",RFC_2822:"D, d M yyyy",RSS:"D, d M yy",TICKS:"!",TIMESTAMP:"@",W3C:"yyyy-mm-dd",formatDate:function(p,l,e){if(typeof p!="string"&&(e=l,l=p,p=""),!l)return"";if(l.calendar()!==this)throw h.local.invalidFormat||h.regionalOptions[""].invalidFormat;p=p||this.local.dateFormat;for(var o,r,i,u,s=(e=e||{}).dayNamesShort||this.local.dayNamesShort,a=e.dayNames||this.local.dayNames,c=e.monthNumbers||this.local.monthNumbers,f=e.monthNamesShort||this.local.monthNamesShort,g=e.monthNames||this.local.monthNames,d=(e.calculateWeek||this.local.calculateWeek,function(_,S){for(var C=1;b+C<p.length&&p.charAt(b+C)===_;)C++;return b+=C-1,Math.floor(C/(S||1))>1}),m=function(_,S,C,k){var L=""+S;if(d(_,k))for(;L.length<C;)L="0"+L;return L},y=this,v=function(_){return typeof c=="function"?c.call(y,_,d("m")):A(m("m",_.month(),2))},T=function(_,S){return S?typeof g=="function"?g.call(y,_):g[_.month()-y.minMonth]:typeof f=="function"?f.call(y,_):f[_.month()-y.minMonth]},w=this.local.digits,A=function(_){return e.localNumbers&&w?w(_):_},E="",M=!1,b=0;b<p.length;b++)if(M)p.charAt(b)!=="'"||d("'")?E+=p.charAt(b):M=!1;else switch(p.charAt(b)){case"d":E+=A(m("d",l.day(),2));break;case"D":E+=(o="D",r=l.dayOfWeek(),i=s,u=a,d(o)?u[r]:i[r]);break;case"o":E+=m("o",l.dayOfYear(),3);break;case"w":E+=m("w",l.weekOfYear(),2);break;case"m":E+=v(l);break;case"M":E+=T(l,d("M"));break;case"y":E+=d("y",2)?l.year():(l.year()%100<10?"0":"")+l.year()%100;break;case"Y":d("Y",2),E+=l.formatYear();break;case"J":E+=l.toJD();break;case"@":E+=(l.toJD()-this.UNIX_EPOCH)*this.SECS_PER_DAY;break;case"!":E+=(l.toJD()-this.TICKS_EPOCH)*this.TICKS_PER_DAY;break;case"'":d("'")?E+="'":M=!0;break;default:E+=p.charAt(b)}return E},parseDate:function(p,l,e){if(l==null)throw h.local.invalidArguments||h.regionalOptions[""].invalidArguments;if((l=typeof l=="object"?l.toString():l+"")==="")return null;p=p||this.local.dateFormat;var o=(e=e||{}).shortYearCutoff||this.shortYearCutoff;o=typeof o!="string"?o:this.today().year()%100+parseInt(o,10);for(var r=e.dayNamesShort||this.local.dayNamesShort,i=e.dayNames||this.local.dayNames,u=e.parseMonth||this.local.parseMonth,s=e.monthNumbers||this.local.monthNumbers,a=e.monthNamesShort||this.local.monthNamesShort,c=e.monthNames||this.local.monthNames,f=-1,g=-1,d=-1,m=-1,y=-1,v=!1,T=!1,w=function(R,V){for(var O=1;k+O<p.length&&p.charAt(k+O)===R;)O++;return k+=O-1,Math.floor(O/(V||1))>1},A=function(R,V){var O=w(R,V),J=[2,3,O?4:2,O?4:2,10,11,20]["oyYJ@!".indexOf(R)+1],D=new RegExp("^-?\\d{1,"+J+"}"),B=l.substring(C).match(D);if(!B)throw(h.local.missingNumberAt||h.regionalOptions[""].missingNumberAt).replace(/\{0\}/,C);return C+=B[0].length,parseInt(B[0],10)},E=this,M=function(){if(typeof s=="function"){w("m");var R=s.call(E,l.substring(C));return C+=R.length,R}return A("m")},b=function(R,V,O,J){for(var D=w(R,J)?O:V,B=0;B<D.length;B++)if(l.substr(C,D[B].length).toLowerCase()===D[B].toLowerCase())return C+=D[B].length,B+E.minMonth;throw(h.local.unknownNameAt||h.regionalOptions[""].unknownNameAt).replace(/\{0\}/,C)},_=function(){if(typeof c=="function"){var R=w("M")?c.call(E,l.substring(C)):a.call(E,l.substring(C));return C+=R.length,R}return b("M",a,c)},S=function(){if(l.charAt(C)!==p.charAt(k))throw(h.local.unexpectedLiteralAt||h.regionalOptions[""].unexpectedLiteralAt).replace(/\{0\}/,C);C++},C=0,k=0;k<p.length;k++)if(T)p.charAt(k)!=="'"||w("'")?S():T=!1;else switch(p.charAt(k)){case"d":m=A("d");break;case"D":b("D",r,i);break;case"o":y=A("o");break;case"w":A("w");break;case"m":d=M();break;case"M":d=_();break;case"y":var L=k;v=!w("y",2),k=L,g=A("y",2);break;case"Y":g=A("Y",2);break;case"J":f=A("J")+.5,l.charAt(C)==="."&&(C++,A("J"));break;case"@":f=A("@")/this.SECS_PER_DAY+this.UNIX_EPOCH;break;case"!":f=A("!")/this.TICKS_PER_DAY+this.TICKS_EPOCH;break;case"*":C=l.length;break;case"'":w("'")?S():T=!0;break;default:S()}if(C<l.length)throw h.local.unexpectedText||h.regionalOptions[""].unexpectedText;if(g===-1?g=this.today().year():g<100&&v&&(g+=o===-1?1900:this.today().year()-this.today().year()%100-(g<=o?0:100)),typeof d=="string"&&(d=u.call(this,g,d)),y>-1){d=1,m=y;for(var I=this.daysInMonth(g,d);m>I;I=this.daysInMonth(g,d))d++,m-=I}return f>-1?this.fromJD(f):this.newDate(g,d,m)},determineDate:function(p,l,e,o,r){e&&typeof e!="object"&&(r=o,o=e,e=null),typeof o!="string"&&(r=o,o="");var i=this;return l=l?l.newDate():null,p=p==null?l:typeof p=="string"?function(u){try{return i.parseDate(o,u,r)}catch{}for(var s=((u=u.toLowerCase()).match(/^c/)&&e?e.newDate():null)||i.today(),a=/([+-]?[0-9]+)\s*(d|w|m|y)?/g,c=a.exec(u);c;)s.add(parseInt(c[1],10),c[2]||"d"),c=a.exec(u);return s}(p):typeof p=="number"?isNaN(p)||p===1/0||p===-1/0?l:i.today().add(p,"d"):i.newDate(p)}})},{"./main":621,"object-assign":499}],623:[function(n,z,q){z.exports=n("cwise-compiler")({args:["array",{offset:[1],array:0},"scalar","scalar","index"],pre:{body:"{}",args:[],thisVars:[],localVars:[]},post:{body:"{}",args:[],thisVars:[],localVars:[]},body:{body:`{
        var _inline_1_da = _inline_1_arg0_ - _inline_1_arg3_
        var _inline_1_db = _inline_1_arg1_ - _inline_1_arg3_
        if((_inline_1_da >= 0) !== (_inline_1_db >= 0)) {
          _inline_1_arg2_.push(_inline_1_arg4_[0] + 0.5 + 0.5 * (_inline_1_da + _inline_1_db) / (_inline_1_da - _inline_1_db))
        }
      }`,args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_1_arg2_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_1_arg3_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg4_",lvalue:!1,rvalue:!0,count:1}],thisVars:[],localVars:["_inline_1_da","_inline_1_db"]},funcName:"zeroCrossings"})},{"cwise-compiler":151}],624:[function(n,z,q){"use strict";z.exports=function(h,p){var l=[];return p=+p||0,t(h.hi(h.shape[0]-1),l,p),l};var t=n("./lib/zc-core")},{"./lib/zc-core":623}],625:[function(n,z,q){"use strict";z.exports=[{path:"",backoff:0},{path:"M-2.4,-3V3L0.6,0Z",backoff:.6},{path:"M-3.7,-2.5V2.5L1.3,0Z",backoff:1.3},{path:"M-4.45,-3L-1.65,-0.2V0.2L-4.45,3L1.55,0Z",backoff:1.55},{path:"M-2.2,-2.2L-0.2,-0.2V0.2L-2.2,2.2L-1.4,3L1.6,0L-1.4,-3Z",backoff:1.6},{path:"M-4.4,-2.1L-0.6,-0.2V0.2L-4.4,2.1L-4,3L2,0L-4,-3Z",backoff:2},{path:"M2,0A2,2 0 1,1 0,-2A2,2 0 0,1 2,0Z",backoff:0,noRotate:!0},{path:"M2,2V-2H-2V2Z",backoff:0,noRotate:!0}]},{}],626:[function(n,z,q){"use strict";var t=n("./arrow_paths"),h=n("../../plots/font_attributes"),p=n("../../plots/cartesian/constants"),l=n("../../plot_api/plot_template").templatedArray;n("../../constants/axis_placeable_objects"),z.exports=l("annotation",{visible:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},text:{valType:"string",editType:"calc+arraydraw"},textangle:{valType:"angle",dflt:0,editType:"calc+arraydraw"},font:h({editType:"calc+arraydraw",colorEditType:"arraydraw"}),width:{valType:"number",min:1,dflt:null,editType:"calc+arraydraw"},height:{valType:"number",min:1,dflt:null,editType:"calc+arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},align:{valType:"enumerated",values:["left","center","right"],dflt:"center",editType:"arraydraw"},valign:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle",editType:"arraydraw"},bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},bordercolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},borderpad:{valType:"number",min:0,dflt:1,editType:"calc+arraydraw"},borderwidth:{valType:"number",min:0,dflt:1,editType:"calc+arraydraw"},showarrow:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},arrowcolor:{valType:"color",editType:"arraydraw"},arrowhead:{valType:"integer",min:0,max:t.length,dflt:1,editType:"arraydraw"},startarrowhead:{valType:"integer",min:0,max:t.length,dflt:1,editType:"arraydraw"},arrowside:{valType:"flaglist",flags:["end","start"],extras:["none"],dflt:"end",editType:"arraydraw"},arrowsize:{valType:"number",min:.3,dflt:1,editType:"calc+arraydraw"},startarrowsize:{valType:"number",min:.3,dflt:1,editType:"calc+arraydraw"},arrowwidth:{valType:"number",min:.1,editType:"calc+arraydraw"},standoff:{valType:"number",min:0,dflt:0,editType:"calc+arraydraw"},startstandoff:{valType:"number",min:0,dflt:0,editType:"calc+arraydraw"},ax:{valType:"any",editType:"calc+arraydraw"},ay:{valType:"any",editType:"calc+arraydraw"},axref:{valType:"enumerated",dflt:"pixel",values:["pixel",p.idRegex.x.toString()],editType:"calc"},ayref:{valType:"enumerated",dflt:"pixel",values:["pixel",p.idRegex.y.toString()],editType:"calc"},xref:{valType:"enumerated",values:["paper",p.idRegex.x.toString()],editType:"calc"},x:{valType:"any",editType:"calc+arraydraw"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"auto",editType:"calc+arraydraw"},xshift:{valType:"number",dflt:0,editType:"calc+arraydraw"},yref:{valType:"enumerated",values:["paper",p.idRegex.y.toString()],editType:"calc"},y:{valType:"any",editType:"calc+arraydraw"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"auto",editType:"calc+arraydraw"},yshift:{valType:"number",dflt:0,editType:"calc+arraydraw"},clicktoshow:{valType:"enumerated",values:[!1,"onoff","onout"],dflt:!1,editType:"arraydraw"},xclick:{valType:"any",editType:"arraydraw"},yclick:{valType:"any",editType:"arraydraw"},hovertext:{valType:"string",editType:"arraydraw"},hoverlabel:{bgcolor:{valType:"color",editType:"arraydraw"},bordercolor:{valType:"color",editType:"arraydraw"},font:h({editType:"arraydraw"}),editType:"arraydraw"},captureevents:{valType:"boolean",editType:"arraydraw"},editType:"calc",_deprecated:{ref:{valType:"string",editType:"calc"}}})},{"../../constants/axis_placeable_objects":746,"../../plot_api/plot_template":817,"../../plots/cartesian/constants":834,"../../plots/font_attributes":856,"./arrow_paths":625}],627:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../../plots/cartesian/axes"),p=n("./draw").draw;function l(o){var r=o._fullLayout;t.filterVisible(r.annotations).forEach(function(i){var u=h.getFromId(o,i.xref),s=h.getFromId(o,i.yref),a=h.getRefType(i.xref),c=h.getRefType(i.yref);i._extremes={},a==="range"&&e(i,u),c==="range"&&e(i,s)})}function e(o,r){var i,u=r._id,s=u.charAt(0),a=o[s],c=o["a"+s],f=o[s+"ref"],g=o["a"+s+"ref"],d=o["_"+s+"padplus"],m=o["_"+s+"padminus"],y={x:1,y:-1}[s]*o[s+"shift"],v=3*o.arrowsize*o.arrowwidth||0,T=v+y,w=v-y,A=3*o.startarrowsize*o.arrowwidth||0,E=A+y,M=A-y;if(g===f){var b=h.findExtremes(r,[r.r2c(a)],{ppadplus:T,ppadminus:w}),_=h.findExtremes(r,[r.r2c(c)],{ppadplus:Math.max(d,E),ppadminus:Math.max(m,M)});i={min:[b.min[0],_.min[0]],max:[b.max[0],_.max[0]]}}else E=c?E+c:E,M=c?M-c:M,i=h.findExtremes(r,[r.r2c(a)],{ppadplus:Math.max(d,T,E),ppadminus:Math.max(m,w,M)});o._extremes[u]=i}z.exports=function(o){var r=o._fullLayout;if(t.filterVisible(r.annotations).length&&o._fullData.length)return t.syncOrAsync([p,l],o)}},{"../../lib":778,"../../plots/cartesian/axes":828,"./draw":632}],628:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../../registry"),p=n("../../plot_api/plot_template").arrayEditor;function l(o,r){var i,u,s,a,c,f,g,d=o._fullLayout.annotations,m=[],y=[],v=[],T=(r||[]).length;for(i=0;i<d.length;i++)if(a=(s=d[i]).clicktoshow){for(u=0;u<T;u++)if(f=(c=r[u]).xaxis,g=c.yaxis,f._id===s.xref&&g._id===s.yref&&f.d2r(c.x)===e(s._xclick,f)&&g.d2r(c.y)===e(s._yclick,g)){(s.visible?a==="onout"?y:v:m).push(i);break}u===T&&s.visible&&a==="onout"&&y.push(i)}return{on:m,off:y,explicitOff:v}}function e(o,r){return r.type==="log"?r.l2r(o):r.d2r(o)}z.exports={hasClickToShow:function(o,r){var i=l(o,r);return i.on.length>0||i.explicitOff.length>0},onClick:function(o,r){var i,u,s=l(o,r),a=s.on,c=s.off.concat(s.explicitOff),f={},g=o._fullLayout.annotations;if(!(!a.length&&!c.length)){for(i=0;i<a.length;i++)(u=p(o.layout,"annotations",g[a[i]])).modifyItem("visible",!0),t.extendFlat(f,u.getUpdateObj());for(i=0;i<c.length;i++)(u=p(o.layout,"annotations",g[c[i]])).modifyItem("visible",!1),t.extendFlat(f,u.getUpdateObj());return h.call("update",o,{},f)}}}},{"../../lib":778,"../../plot_api/plot_template":817,"../../registry":911}],629:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../color");z.exports=function(p,l,e,o){o("opacity");var r=o("bgcolor"),i=o("bordercolor"),u=h.opacity(i);o("borderpad");var s=o("borderwidth"),a=o("showarrow");if(o("text",a?" ":e._dfltTitle.annotation),o("textangle"),t.coerceFont(o,"font",e.font),o("width"),o("align"),o("height")&&o("valign"),a){var c,f,g=o("arrowside");g.indexOf("end")!==-1&&(c=o("arrowhead"),f=o("arrowsize")),g.indexOf("start")!==-1&&(o("startarrowhead",c),o("startarrowsize",f)),o("arrowcolor",u?l.bordercolor:h.defaultLine),o("arrowwidth",2*(u&&s||1)),o("standoff"),o("startstandoff")}var d=o("hovertext"),m=e.hoverlabel||{};if(d){var y=o("hoverlabel.bgcolor",m.bgcolor||(h.opacity(r)?h.rgb(r):h.defaultLine)),v=o("hoverlabel.bordercolor",m.bordercolor||h.contrast(y));t.coerceFont(o,"hoverlabel.font",{family:m.font.family,size:m.font.size,color:m.font.color||v})}o("captureevents",!!d)}},{"../../lib":778,"../color":643}],630:[function(n,z,q){"use strict";var t=n("fast-isnumeric"),h=n("../../lib/to_log_range");z.exports=function(p,l,e,o){l=l||{};var r=e==="log"&&l.type==="linear",i=e==="linear"&&l.type==="log";if(r||i)for(var u,s,a=p._fullLayout.annotations,c=l._id.charAt(0),f=0;f<a.length;f++)u=a[f],s="annotations["+f+"].",u[c+"ref"]===l._id&&g(c),u["a"+c+"ref"]===l._id&&g("a"+c);function g(d){var m=u[d],y=null;y=r?h(m,l.range):Math.pow(10,m),t(y)||(y=null),o(s+d,y)}}},{"../../lib/to_log_range":805,"fast-isnumeric":241}],631:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../../plots/cartesian/axes"),p=n("../../plots/array_container_defaults"),l=n("./common_defaults"),e=n("./attributes");function o(r,i,u){function s(_,S){return t.coerce(r,i,e,_,S)}var a=s("visible"),c=s("clicktoshow");if(a||c){l(r,i,u,s);for(var f=i.showarrow,g=["x","y"],d=[-10,-30],m={_fullLayout:u},y=0;y<2;y++){var v=g[y],T=h.coerceRef(r,i,m,v,"","paper");if(T!=="paper"&&h.getFromId(m,T)._annIndices.push(i._index),h.coercePosition(i,m,s,T,v,.5),f){var w="a"+v,A=h.coerceRef(r,i,m,w,"pixel",["pixel","paper"]);A!=="pixel"&&A!==T&&(A=i[w]="pixel");var E=A==="pixel"?d[y]:.4;h.coercePosition(i,m,s,A,w,E)}s(v+"anchor"),s(v+"shift")}if(t.noneOrAll(r,i,["x","y"]),f&&t.noneOrAll(r,i,["ax","ay"]),c){var M=s("xclick"),b=s("yclick");i._xclick=M===void 0?i.x:h.cleanPosition(M,m,i.xref),i._yclick=b===void 0?i.y:h.cleanPosition(b,m,i.yref)}}}z.exports=function(r,i){p(r,i,{name:"annotations",handleItemDefaults:o})}},{"../../lib":778,"../../plots/array_container_defaults":823,"../../plots/cartesian/axes":828,"./attributes":626,"./common_defaults":629}],632:[function(n,z,q){"use strict";var t=n("d3"),h=n("../../registry"),p=n("../../plots/plots"),l=n("../../lib"),e=l.strTranslate,o=n("../../plots/cartesian/axes"),r=n("../color"),i=n("../drawing"),u=n("../fx"),s=n("../../lib/svg_text_utils"),a=n("../../lib/setcursor"),c=n("../dragelement"),f=n("../../plot_api/plot_template").arrayEditor,g=n("./draw_arrow_head");function d(v,T){var w=v._fullLayout.annotations[T]||{},A=o.getFromId(v,w.xref),E=o.getFromId(v,w.yref);A&&A.setScale(),E&&E.setScale(),y(v,w,T,!1,A,E)}function m(v,T,w,A,E){var M=E[w],b=E[w+"ref"],_=w.indexOf("y")!==-1,S=o.getRefType(b)==="domain",C=_?A.h:A.w;return v?S?M+(_?-T:T)/v._length:v.p2r(v.r2p(M)+T):M+(_?-T:T)/C}function y(v,T,w,A,E,M){var b,_,S=v._fullLayout,C=v._fullLayout._size,k=v._context.edits;A?(b="annotation-"+A,_=A+".annotations"):(b="annotation",_="annotations");var L=f(v.layout,_,T),I=L.modifyBase,R=L.modifyItem,V=L.getUpdateObj;S._infolayer.selectAll("."+b+'[data-index="'+w+'"]').remove();var O="clip"+S._uid+"_ann"+w;if(T._input&&T.visible!==!1){var J={x:{},y:{}},D=+T.textangle||0,B=S._infolayer.append("g").classed(b,!0).attr("data-index",String(w)).style("opacity",T.opacity),N=B.append("g").classed("annotation-text-g",!0),F=k[T.showarrow?"annotationTail":"annotationPosition"],H=T.captureevents||k.annotationText||F,j=N.append("g").style("pointer-events",H?"all":null).call(a,"pointer").on("click",function(){v._dragging=!1,v.emit("plotly_clickannotation",le(t.event))});T.hovertext&&j.on("mouseover",function(){var we=T.hoverlabel,Ae=we.font,Se=this.getBoundingClientRect(),ke=v.getBoundingClientRect();u.loneHover({x0:Se.left-ke.left,x1:Se.right-ke.left,y:(Se.top+Se.bottom)/2-ke.top,text:T.hovertext,color:we.bgcolor,borderColor:we.bordercolor,fontFamily:Ae.family,fontSize:Ae.size,fontColor:Ae.color},{container:S._hoverlayer.node(),outerContainer:S._paper.node(),gd:v})}).on("mouseout",function(){u.loneUnhover(S._hoverlayer.node())});var G=T.borderwidth,W=T.borderpad,Q=G+W,$=j.append("rect").attr("class","bg").style("stroke-width",G+"px").call(r.stroke,T.bordercolor).call(r.fill,T.bgcolor),ee=T.width||T.height,ie=S._topclips.selectAll("#"+O).data(ee?[0]:[]);ie.enter().append("clipPath").classed("annclip",!0).attr("id",O).append("rect"),ie.exit().remove();var ae=T.font,oe=S._meta?l.templateString(T.text,S._meta):T.text,de=j.append("text").classed("annotation-text",!0).text(oe);k.annotationText?de.call(s.makeEditable,{delegate:j,gd:v}).call(fe).on("edit",function(we){T.text=we,this.call(fe),R("text",we),E&&E.autorange&&I(E._name+".autorange",!0),M&&M.autorange&&I(M._name+".autorange",!0),h.call("_guiRelayout",v,V())}):de.call(fe)}else t.selectAll("#"+O).remove();function le(we){var Ae={index:w,annotation:T._input,fullAnnotation:T,event:we};return A&&(Ae.subplotId=A),Ae}function fe(we){return we.call(i.font,ae).attr({"text-anchor":{left:"start",right:"end"}[T.align]||"middle"}),s.convertToTspans(we,v,ue),we}function ue(){var we=de.selectAll("a");we.size()===1&&we.text()===de.text()&&j.insert("a",":first-child").attr({"xlink:xlink:href":we.attr("xlink:href"),"xlink:xlink:show":we.attr("xlink:show")}).style({cursor:"pointer"}).node().appendChild($.node());var Ae=j.select(".annotation-text-math-group"),Se=!Ae.empty(),ke=i.bBox((Se?Ae:de).node()),Me=ke.width,ve=ke.height,ge=T.width||Me,De=T.height||ve,_e=Math.round(ge+2*Q),Pe=Math.round(De+2*Q);function Fe(It,Nt){return Nt==="auto"&&(Nt=It<1/3?"left":It>2/3?"right":"center"),{center:0,middle:0,left:.5,bottom:-.5,right:-.5,top:.5}[Nt]}for(var ze=!1,He=["x","y"],et=0;et<He.length;et++){var Re,Ze,Ke,$e,rt,at=He[et],lt=T[at+"ref"]||at,gt=T["a"+at+"ref"],Ie={x:E,y:M}[at],be=(D+(at==="x"?0:-90))*Math.PI/180,We=_e*Math.cos(be),Ge=Pe*Math.sin(be),st=Math.abs(We)+Math.abs(Ge),ot=T[at+"anchor"],Ce=T[at+"shift"]*(at==="x"?1:-1),Ue=J[at],Ye=o.getRefType(lt);if(Ie&&Ye!=="domain"){var xe=Ie.r2fraction(T[at]);(xe<0||xe>1)&&(gt===lt?((xe=Ie.r2fraction(T["a"+at]))<0||xe>1)&&(ze=!0):ze=!0),Re=Ie._offset+Ie.r2p(T[at]),$e=.5}else{var Ee=Ye==="domain";at==="x"?(Ke=T[at],Re=Ee?Ie._offset+Ie._length*Ke:Re=C.l+C.w*Ke):(Ke=1-T[at],Re=Ee?Ie._offset+Ie._length*Ke:Re=C.t+C.h*Ke),$e=T.showarrow?.5:Ke}if(T.showarrow){Ue.head=Re;var Je=T["a"+at];if(rt=We*Fe(.5,T.xanchor)-Ge*Fe(.5,T.yanchor),gt===lt){var it=o.getRefType(gt);it==="domain"?(at==="y"&&(Je=1-Je),Ue.tail=Ie._offset+Ie._length*Je):it==="paper"?at==="y"?(Je=1-Je,Ue.tail=C.t+C.h*Je):Ue.tail=C.l+C.w*Je:Ue.tail=Ie._offset+Ie.r2p(Je),Ze=rt}else Ue.tail=Re+Je,Ze=rt+Je;Ue.text=Ue.tail+rt;var ht=S[at==="x"?"width":"height"];if(lt==="paper"&&(Ue.head=l.constrain(Ue.head,1,ht-1)),gt==="pixel"){var ct=-Math.max(Ue.tail-3,Ue.text),mt=Math.min(Ue.tail+3,Ue.text)-ht;ct>0?(Ue.tail+=ct,Ue.text+=ct):mt>0&&(Ue.tail-=mt,Ue.text-=mt)}Ue.tail+=Ce,Ue.head+=Ce}else Ze=rt=st*Fe($e,ot),Ue.text=Re+rt;Ue.text+=Ce,rt+=Ce,Ze+=Ce,T["_"+at+"padplus"]=st/2+Ze,T["_"+at+"padminus"]=st/2-Ze,T["_"+at+"size"]=st,T["_"+at+"shift"]=rt}if(ze)j.remove();else{var bt=0,Et=0;if(T.align!=="left"&&(bt=(ge-Me)*(T.align==="center"?.5:1)),T.valign!=="top"&&(Et=(De-ve)*(T.valign==="middle"?.5:1)),Se)Ae.select("svg").attr({x:Q+bt-1,y:Q+Et}).call(i.setClipUrl,ee?O:null,v);else{var Mt=Q+Et-ke.top,_t=Q+bt-ke.left;de.call(s.positionText,_t,Mt).call(i.setClipUrl,ee?O:null,v)}ie.select("rect").call(i.setRect,Q,Q,ge,De),$.call(i.setRect,G/2,G/2,_e-G,Pe-G),j.call(i.setTranslate,Math.round(J.x.text-_e/2),Math.round(J.y.text-Pe/2)),N.attr({transform:"rotate("+D+","+J.x.text+","+J.y.text+")"});var xt,At=function(It,Nt){B.selectAll(".annotation-arrow-g").remove();var Ot=J.x.head,Yt=J.y.head,Pt=J.x.tail+It,Ne=J.y.tail+Nt,ut=J.x.text+It,wt=J.y.text+Nt,Bt=l.rotationXYMatrix(D,ut,wt),Jt=l.apply2DTransform(Bt),er=l.apply2DTransform2(Bt),or=+$.attr("width"),zt=+$.attr("height"),Qt=ut-.5*or,cr=Qt+or,Dt=wt-.5*zt,Ut=Dt+zt,ur=[[Qt,Dt,Qt,Ut],[Qt,Ut,cr,Ut],[cr,Ut,cr,Dt],[cr,Dt,Qt,Dt]].map(er);if(!ur.reduce(function(Br,on){return Br^!!l.segmentsIntersect(Ot,Yt,Ot+1e6,Yt+1e6,on[0],on[1],on[2],on[3])},!1)){ur.forEach(function(Br){var on=l.segmentsIntersect(Pt,Ne,Ot,Yt,Br[0],Br[1],Br[2],Br[3]);on&&(Pt=on.x,Ne=on.y)});var Sr=T.arrowwidth,Lr=T.arrowcolor,Hr=T.arrowside,Kr=B.append("g").style({opacity:r.opacity(Lr)}).classed("annotation-arrow-g",!0),Ir=Kr.append("path").attr("d","M"+Pt+","+Ne+"L"+Ot+","+Yt).style("stroke-width",Sr+"px").call(r.stroke,r.rgb(Lr));if(g(Ir,Hr,T),k.annotationPosition&&Ir.node().parentNode&&!A){var kr=Ot,rn=Yt;if(T.standoff){var Qr=Math.sqrt(Math.pow(Ot-Pt,2)+Math.pow(Yt-Ne,2));kr+=T.standoff*(Pt-Ot)/Qr,rn+=T.standoff*(Ne-Yt)/Qr}var nn,Xr,Nr=Kr.append("path").classed("annotation-arrow",!0).classed("anndrag",!0).classed("cursor-move",!0).attr({d:"M3,3H-3V-3H3ZM0,0L"+(Pt-kr)+","+(Ne-rn),transform:e(kr,rn)}).style("stroke-width",Sr+6+"px").call(r.stroke,"rgba(0,0,0,0)").call(r.fill,"rgba(0,0,0,0)");c.init({element:Nr.node(),gd:v,prepFn:function(){var Br=i.getTranslate(j);nn=Br.x,Xr=Br.y,E&&E.autorange&&I(E._name+".autorange",!0),M&&M.autorange&&I(M._name+".autorange",!0)},moveFn:function(Br,on){var cn=Jt(nn,Xr),un=cn[0]+Br,Zr=cn[1]+on;j.call(i.setTranslate,un,Zr),R("x",m(E,Br,"x",C,T)),R("y",m(M,on,"y",C,T)),T.axref===T.xref&&R("ax",m(E,Br,"ax",C,T)),T.ayref===T.yref&&R("ay",m(M,on,"ay",C,T)),Kr.attr("transform",e(Br,on)),N.attr({transform:"rotate("+D+","+un+","+Zr+")"})},doneFn:function(){h.call("_guiRelayout",v,V());var Br=document.querySelector(".js-notes-box-panel");Br&&Br.redraw(Br.selectedObj)}})}}};T.showarrow&&At(0,0),F&&c.init({element:j.node(),gd:v,prepFn:function(){xt=N.attr("transform")},moveFn:function(It,Nt){var Ot="pointer";if(T.showarrow)T.axref===T.xref?R("ax",m(E,It,"ax",C,T)):R("ax",T.ax+It),T.ayref===T.yref?R("ay",m(M,Nt,"ay",C.w,T)):R("ay",T.ay+Nt),At(It,Nt);else{if(A)return;var Yt,Pt;if(E)Yt=m(E,It,"x",C,T);else{var Ne=T._xsize/C.w,ut=T.x+(T._xshift-T.xshift)/C.w-Ne/2;Yt=c.align(ut+It/C.w,Ne,0,1,T.xanchor)}if(M)Pt=m(M,Nt,"y",C,T);else{var wt=T._ysize/C.h,Bt=T.y-(T._yshift+T.yshift)/C.h-wt/2;Pt=c.align(Bt-Nt/C.h,wt,0,1,T.yanchor)}R("x",Yt),R("y",Pt),E&&M||(Ot=c.getCursor(E?.5:Yt,M?.5:Pt,T.xanchor,T.yanchor))}N.attr({transform:e(It,Nt)+xt}),a(j,Ot)},clickFn:function(It,Nt){T.captureevents&&v.emit("plotly_clickannotation",le(Nt))},doneFn:function(){a(j),h.call("_guiRelayout",v,V());var It=document.querySelector(".js-notes-box-panel");It&&It.redraw(It.selectedObj)}})}}}z.exports={draw:function(v){var T=v._fullLayout;T._infolayer.selectAll(".annotation").remove();for(var w=0;w<T.annotations.length;w++)T.annotations[w].visible&&d(v,w);return p.previousPromises(v)},drawOne:d,drawRaw:y}},{"../../lib":778,"../../lib/setcursor":799,"../../lib/svg_text_utils":803,"../../plot_api/plot_template":817,"../../plots/cartesian/axes":828,"../../plots/plots":891,"../../registry":911,"../color":643,"../dragelement":662,"../drawing":665,"../fx":683,"./draw_arrow_head":633,d3:169}],633:[function(n,z,q){"use strict";var t=n("d3"),h=n("../color"),p=n("./arrow_paths"),l=n("../../lib"),e=l.strScale,o=l.strRotate,r=l.strTranslate;z.exports=function(i,u,s){var a,c,f,g,d=i.node(),m=p[s.arrowhead||0],y=p[s.startarrowhead||0],v=(s.arrowwidth||1)*(s.arrowsize||1),T=(s.arrowwidth||1)*(s.startarrowsize||1),w=u.indexOf("start")>=0,A=u.indexOf("end")>=0,E=m.backoff*v+s.standoff,M=y.backoff*T+s.startstandoff;if(d.nodeName==="line"){a={x:+i.attr("x1"),y:+i.attr("y1")},c={x:+i.attr("x2"),y:+i.attr("y2")};var b=a.x-c.x,_=a.y-c.y;if(g=(f=Math.atan2(_,b))+Math.PI,E&&M&&E+M>Math.sqrt(b*b+_*_))return void B();if(E){if(E*E>b*b+_*_)return void B();var S=E*Math.cos(f),C=E*Math.sin(f);c.x+=S,c.y+=C,i.attr({x2:c.x,y2:c.y})}if(M){if(M*M>b*b+_*_)return void B();var k=M*Math.cos(f),L=M*Math.sin(f);a.x-=k,a.y-=L,i.attr({x1:a.x,y1:a.y})}}else if(d.nodeName==="path"){var I=d.getTotalLength(),R="";if(I<E+M)return void B();var V=d.getPointAtLength(0),O=d.getPointAtLength(.1);f=Math.atan2(V.y-O.y,V.x-O.x),a=d.getPointAtLength(Math.min(M,I)),R="0px,"+M+"px,";var J=d.getPointAtLength(I),D=d.getPointAtLength(I-.1);g=Math.atan2(J.y-D.y,J.x-D.x),c=d.getPointAtLength(Math.max(0,I-E)),R+=I-(R?M+E:E)+"px,"+I+"px",i.style("stroke-dasharray",R)}function B(){i.style("stroke-dasharray","0px,100px")}function N(F,H,j,G){F.path&&(F.noRotate&&(j=0),t.select(d.parentNode).append("path").attr({class:i.attr("class"),d:F.path,transform:r(H.x,H.y)+o(180*j/Math.PI)+e(G)}).style({fill:h.rgb(s.arrowcolor),"stroke-width":0}))}w&&N(y,a,f,T),A&&N(m,c,g,v)}},{"../../lib":778,"../color":643,"./arrow_paths":625,d3:169}],634:[function(n,z,q){"use strict";var t=n("./draw"),h=n("./click");z.exports={moduleType:"component",name:"annotations",layoutAttributes:n("./attributes"),supplyLayoutDefaults:n("./defaults"),includeBasePlot:n("../../plots/cartesian/include_components")("annotations"),calcAutorange:n("./calc_autorange"),draw:t.draw,drawOne:t.drawOne,drawRaw:t.drawRaw,hasClickToShow:h.hasClickToShow,onClick:h.onClick,convertCoords:n("./convert_coords")}},{"../../plots/cartesian/include_components":840,"./attributes":626,"./calc_autorange":627,"./click":628,"./convert_coords":630,"./defaults":631,"./draw":632}],635:[function(n,z,q){"use strict";var t=n("../annotations/attributes"),h=n("../../plot_api/edit_types").overrideAll,p=n("../../plot_api/plot_template").templatedArray;z.exports=h(p("annotation",{visible:t.visible,x:{valType:"any"},y:{valType:"any"},z:{valType:"any"},ax:{valType:"number"},ay:{valType:"number"},xanchor:t.xanchor,xshift:t.xshift,yanchor:t.yanchor,yshift:t.yshift,text:t.text,textangle:t.textangle,font:t.font,width:t.width,height:t.height,opacity:t.opacity,align:t.align,valign:t.valign,bgcolor:t.bgcolor,bordercolor:t.bordercolor,borderpad:t.borderpad,borderwidth:t.borderwidth,showarrow:t.showarrow,arrowcolor:t.arrowcolor,arrowhead:t.arrowhead,startarrowhead:t.startarrowhead,arrowside:t.arrowside,arrowsize:t.arrowsize,startarrowsize:t.startarrowsize,arrowwidth:t.arrowwidth,standoff:t.standoff,startstandoff:t.startstandoff,hovertext:t.hovertext,hoverlabel:t.hoverlabel,captureevents:t.captureevents}),"calc","from-root")},{"../../plot_api/edit_types":810,"../../plot_api/plot_template":817,"../annotations/attributes":626}],636:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../../plots/cartesian/axes");function p(l,e){var o=e.fullSceneLayout.domain,r=e.fullLayout._size,i={pdata:null,type:"linear",autorange:!1,range:[-1/0,1/0]};l._xa={},t.extendFlat(l._xa,i),h.setConvert(l._xa),l._xa._offset=r.l+o.x[0]*r.w,l._xa.l2p=function(){return .5*(1+l._pdata[0]/l._pdata[3])*r.w*(o.x[1]-o.x[0])},l._ya={},t.extendFlat(l._ya,i),h.setConvert(l._ya),l._ya._offset=r.t+(1-o.y[1])*r.h,l._ya.l2p=function(){return .5*(1-l._pdata[1]/l._pdata[3])*r.h*(o.y[1]-o.y[0])}}z.exports=function(l){for(var e=l.fullSceneLayout.annotations,o=0;o<e.length;o++)p(e[o],l);l.fullLayout._infolayer.selectAll(".annotation-"+l.id).remove()}},{"../../lib":778,"../../plots/cartesian/axes":828}],637:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../../plots/cartesian/axes"),p=n("../../plots/array_container_defaults"),l=n("../annotations/common_defaults"),e=n("./attributes");function o(r,i,u,s){function a(f,g){return t.coerce(r,i,e,f,g)}function c(f){var g=f+"axis",d={_fullLayout:{}};return d._fullLayout[g]=u[g],h.coercePosition(i,d,a,f,f,.5)}a("visible")&&(l(r,i,s.fullLayout,a),c("x"),c("y"),c("z"),t.noneOrAll(r,i,["x","y","z"]),i.xref="x",i.yref="y",i.zref="z",a("xanchor"),a("yanchor"),a("xshift"),a("yshift"),i.showarrow&&(i.axref="pixel",i.ayref="pixel",a("ax",-10),a("ay",-30),t.noneOrAll(r,i,["ax","ay"])))}z.exports=function(r,i,u){p(r,i,{name:"annotations",handleItemDefaults:o,fullLayout:u.fullLayout})}},{"../../lib":778,"../../plots/array_container_defaults":823,"../../plots/cartesian/axes":828,"../annotations/common_defaults":629,"./attributes":635}],638:[function(n,z,q){"use strict";var t=n("../annotations/draw").drawRaw,h=n("../../plots/gl3d/project"),p=["x","y","z"];z.exports=function(l){for(var e=l.fullSceneLayout,o=l.dataScale,r=e.annotations,i=0;i<r.length;i++){for(var u=r[i],s=!1,a=0;a<3;a++){var c=p[a],f=u[c],g=e[c+"axis"].r2fraction(f);if(g<0||g>1){s=!0;break}}s?l.fullLayout._infolayer.select(".annotation-"+l.id+'[data-index="'+i+'"]').remove():(u._pdata=h(l.glplot.cameraParams,[e.xaxis.r2l(u.x)*o[0],e.yaxis.r2l(u.y)*o[1],e.zaxis.r2l(u.z)*o[2]]),t(l.graphDiv,u,i,l.id,u._xa,u._ya))}}},{"../../plots/gl3d/project":879,"../annotations/draw":632}],639:[function(n,z,q){"use strict";var t=n("../../registry"),h=n("../../lib");z.exports={moduleType:"component",name:"annotations3d",schema:{subplots:{scene:{annotations:n("./attributes")}}},layoutAttributes:n("./attributes"),handleDefaults:n("./defaults"),includeBasePlot:function(p,l){var e=t.subplotsRegistry.gl3d;if(e)for(var o=e.attrRegex,r=Object.keys(p),i=0;i<r.length;i++){var u=r[i];o.test(u)&&(p[u].annotations||[]).length&&(h.pushUnique(l._basePlotModules,e),h.pushUnique(l._subplots.gl3d,u))}},convert:n("./convert"),draw:n("./draw")}},{"../../lib":778,"../../registry":911,"./attributes":635,"./convert":636,"./defaults":637,"./draw":638}],640:[function(n,z,q){"use strict";z.exports=n("world-calendars/dist/main"),n("world-calendars/dist/plus"),n("world-calendars/dist/calendars/chinese"),n("world-calendars/dist/calendars/coptic"),n("world-calendars/dist/calendars/discworld"),n("world-calendars/dist/calendars/ethiopian"),n("world-calendars/dist/calendars/hebrew"),n("world-calendars/dist/calendars/islamic"),n("world-calendars/dist/calendars/julian"),n("world-calendars/dist/calendars/mayan"),n("world-calendars/dist/calendars/nanakshahi"),n("world-calendars/dist/calendars/nepali"),n("world-calendars/dist/calendars/persian"),n("world-calendars/dist/calendars/taiwan"),n("world-calendars/dist/calendars/thai"),n("world-calendars/dist/calendars/ummalqura")},{"world-calendars/dist/calendars/chinese":607,"world-calendars/dist/calendars/coptic":608,"world-calendars/dist/calendars/discworld":609,"world-calendars/dist/calendars/ethiopian":610,"world-calendars/dist/calendars/hebrew":611,"world-calendars/dist/calendars/islamic":612,"world-calendars/dist/calendars/julian":613,"world-calendars/dist/calendars/mayan":614,"world-calendars/dist/calendars/nanakshahi":615,"world-calendars/dist/calendars/nepali":616,"world-calendars/dist/calendars/persian":617,"world-calendars/dist/calendars/taiwan":618,"world-calendars/dist/calendars/thai":619,"world-calendars/dist/calendars/ummalqura":620,"world-calendars/dist/main":621,"world-calendars/dist/plus":622}],641:[function(n,z,q){"use strict";var t=n("./calendars"),h=n("../../lib"),p=n("../../constants/numerical"),l=p.EPOCHJD,e=p.ONEDAY,o={valType:"enumerated",values:Object.keys(t.calendars),editType:"calc",dflt:"gregorian"},r=function(y,v,T,w){var A={};return A[T]=o,h.coerce(y,v,A,T,w)},i={d:{0:"dd","-":"d"},e:{0:"d","-":"d"},a:{0:"D","-":"D"},A:{0:"DD","-":"DD"},j:{0:"oo","-":"o"},W:{0:"ww","-":"w"},m:{0:"mm","-":"m"},b:{0:"M","-":"M"},B:{0:"MM","-":"MM"},y:{0:"yy","-":"yy"},Y:{0:"yyyy","-":"yyyy"},U:"##",w:"##",c:{0:"D M d %X yyyy","-":"D M d %X yyyy"},x:{0:"mm/dd/yyyy","-":"mm/dd/yyyy"}},u={};function s(y){var v=u[y];return v||(v=u[y]=t.instance(y))}function a(y){return h.extendFlat({},o,{description:y})}function c(y){return"Sets the calendar system to use with `"+y+"` date data."}var f={xcalendar:a(c("x"))},g=h.extendFlat({},f,{ycalendar:a(c("y"))}),d=h.extendFlat({},g,{zcalendar:a(c("z"))}),m=a(["Sets the calendar system to use for `range` and `tick0`","if this is a date axis. This does not set the calendar for","interpreting data on this axis, that's specified in the trace","or via the global `layout.calendar`"].join(" "));z.exports={moduleType:"component",name:"calendars",schema:{traces:{scatter:g,bar:g,box:g,heatmap:g,contour:g,histogram:g,histogram2d:g,histogram2dcontour:g,scatter3d:d,surface:d,mesh3d:d,scattergl:g,ohlc:f,candlestick:f},layout:{calendar:a(["Sets the default calendar system to use for interpreting and","displaying dates throughout the plot."].join(" "))},subplots:{xaxis:{calendar:m},yaxis:{calendar:m},scene:{xaxis:{calendar:m},yaxis:{calendar:m},zaxis:{calendar:m}},polar:{radialaxis:{calendar:m}}},transforms:{filter:{valuecalendar:a(["Sets the calendar system to use for `value`, if it is a date."].join(" ")),targetcalendar:a(["Sets the calendar system to use for `target`, if it is an","array of dates. If `target` is a string (eg *x*) we use the","corresponding trace attribute (eg `xcalendar`) if it exists,","even if `targetcalendar` is provided."].join(" "))}}},layoutAttributes:o,handleDefaults:r,handleTraceDefaults:function(y,v,T,w){for(var A=0;A<T.length;A++)r(y,v,T[A]+"calendar",w.calendar)},CANONICAL_SUNDAY:{chinese:"2000-01-02",coptic:"2000-01-03",discworld:"2000-01-03",ethiopian:"2000-01-05",hebrew:"5000-01-01",islamic:"1000-01-02",julian:"2000-01-03",mayan:"5000-01-01",nanakshahi:"1000-01-05",nepali:"2000-01-05",persian:"1000-01-01",jalali:"1000-01-01",taiwan:"1000-01-04",thai:"2000-01-04",ummalqura:"1400-01-06"},CANONICAL_TICK:{chinese:"2000-01-01",coptic:"2000-01-01",discworld:"2000-01-01",ethiopian:"2000-01-01",hebrew:"5000-01-01",islamic:"1000-01-01",julian:"2000-01-01",mayan:"5000-01-01",nanakshahi:"1000-01-01",nepali:"2000-01-01",persian:"1000-01-01",jalali:"1000-01-01",taiwan:"1000-01-01",thai:"2000-01-01",ummalqura:"1400-01-01"},DFLTRANGE:{chinese:["2000-01-01","2001-01-01"],coptic:["1700-01-01","1701-01-01"],discworld:["1800-01-01","1801-01-01"],ethiopian:["2000-01-01","2001-01-01"],hebrew:["5700-01-01","5701-01-01"],islamic:["1400-01-01","1401-01-01"],julian:["2000-01-01","2001-01-01"],mayan:["5200-01-01","5201-01-01"],nanakshahi:["0500-01-01","0501-01-01"],nepali:["2000-01-01","2001-01-01"],persian:["1400-01-01","1401-01-01"],jalali:["1400-01-01","1401-01-01"],taiwan:["0100-01-01","0101-01-01"],thai:["2500-01-01","2501-01-01"],ummalqura:["1400-01-01","1401-01-01"]},getCal:s,worldCalFmt:function(y,v,T){for(var w,A,E,M,b,_=Math.floor((v+.05)/e)+l,S=s(T).fromJD(_),C=0;(C=y.indexOf("%",C))!==-1;)(w=y.charAt(C+1))==="0"||w==="-"||w==="_"?(E=3,A=y.charAt(C+2),w==="_"&&(w="-")):(A=w,w="0",E=2),(M=i[A])?(b=M==="##"?"##":S.formatDate(M[w]),y=y.substr(0,C)+b+y.substr(C+E),C+=b.length):C+=E;return y}}},{"../../constants/numerical":753,"../../lib":778,"./calendars":640}],642:[function(n,z,q){"use strict";q.defaults=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],q.defaultLine="#444",q.lightLine="#eee",q.background="#fff",q.borderLine="#BEC8D9",q.lightFraction=1e3/11},{}],643:[function(n,z,q){"use strict";var t=n("tinycolor2"),h=n("fast-isnumeric"),p=z.exports={},l=n("./attributes");p.defaults=l.defaults;var e=p.defaultLine=l.defaultLine;p.lightLine=l.lightLine;var o=p.background=l.background;function r(i){if(h(i)||typeof i!="string")return i;var u=i.trim();if(u.substr(0,3)!=="rgb")return i;var s=u.match(/^rgba?\s*\(([^()]*)\)$/);if(!s)return i;var a=s[1].trim().split(/\s*[\s,]\s*/),c=u.charAt(3)==="a"&&a.length===4;if(!c&&a.length!==3)return i;for(var f=0;f<a.length;f++){if(!a[f].length||(a[f]=Number(a[f]),!(a[f]>=0)))return i;if(f===3)a[f]>1&&(a[f]=1);else if(a[f]>=1)return i}var g=Math.round(255*a[0])+", "+Math.round(255*a[1])+", "+Math.round(255*a[2]);return c?"rgba("+g+", "+a[3]+")":"rgb("+g+")"}p.tinyRGB=function(i){var u=i.toRgb();return"rgb("+Math.round(u.r)+", "+Math.round(u.g)+", "+Math.round(u.b)+")"},p.rgb=function(i){return p.tinyRGB(t(i))},p.opacity=function(i){return i?t(i).getAlpha():0},p.addOpacity=function(i,u){var s=t(i).toRgb();return"rgba("+Math.round(s.r)+", "+Math.round(s.g)+", "+Math.round(s.b)+", "+u+")"},p.combine=function(i,u){var s=t(i).toRgb();if(s.a===1)return t(i).toRgbString();var a=t(u||o).toRgb(),c=a.a===1?a:{r:255*(1-a.a)+a.r*a.a,g:255*(1-a.a)+a.g*a.a,b:255*(1-a.a)+a.b*a.a},f={r:c.r*(1-s.a)+s.r*s.a,g:c.g*(1-s.a)+s.g*s.a,b:c.b*(1-s.a)+s.b*s.a};return t(f).toRgbString()},p.contrast=function(i,u,s){var a=t(i);return a.getAlpha()!==1&&(a=t(p.combine(i,o))),(a.isDark()?u?a.lighten(u):o:s?a.darken(s):e).toString()},p.stroke=function(i,u){var s=t(u);i.style({stroke:p.tinyRGB(s),"stroke-opacity":s.getAlpha()})},p.fill=function(i,u){var s=t(u);i.style({fill:p.tinyRGB(s),"fill-opacity":s.getAlpha()})},p.clean=function(i){if(i&&typeof i=="object"){var u,s,a,c,f=Object.keys(i);for(u=0;u<f.length;u++)if(c=i[a=f[u]],a.substr(a.length-5)==="color")if(Array.isArray(c))for(s=0;s<c.length;s++)c[s]=r(c[s]);else i[a]=r(c);else if(a.substr(a.length-10)==="colorscale"&&Array.isArray(c))for(s=0;s<c.length;s++)Array.isArray(c[s])&&(c[s][1]=r(c[s][1]));else if(Array.isArray(c)){var g=c[0];if(!Array.isArray(g)&&g&&typeof g=="object")for(s=0;s<c.length;s++)p.clean(c[s])}else c&&typeof c=="object"&&p.clean(c)}}},{"./attributes":642,"fast-isnumeric":241,tinycolor2:576}],644:[function(n,z,q){"use strict";var t=n("../../plots/cartesian/layout_attributes"),h=n("../../plots/font_attributes"),p=n("../../lib/extend").extendFlat,l=n("../../plot_api/edit_types").overrideAll;z.exports=l({thicknessmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"pixels"},thickness:{valType:"number",min:0,dflt:30},lenmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"fraction"},len:{valType:"number",min:0,dflt:1},x:{valType:"number",dflt:1.02,min:-2,max:3},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left"},xpad:{valType:"number",min:0,dflt:10},y:{valType:"number",dflt:.5,min:-2,max:3},yanchor:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle"},ypad:{valType:"number",min:0,dflt:10},outlinecolor:t.linecolor,outlinewidth:t.linewidth,bordercolor:t.linecolor,borderwidth:{valType:"number",min:0,dflt:0},bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)"},tickmode:t.tickmode,nticks:t.nticks,tick0:t.tick0,dtick:t.dtick,tickvals:t.tickvals,ticktext:t.ticktext,ticks:p({},t.ticks,{dflt:""}),ticklabelposition:{valType:"enumerated",values:["outside","inside","outside top","inside top","outside bottom","inside bottom"],dflt:"outside"},ticklen:t.ticklen,tickwidth:t.tickwidth,tickcolor:t.tickcolor,showticklabels:t.showticklabels,tickfont:h({}),tickangle:t.tickangle,tickformat:t.tickformat,tickformatstops:t.tickformatstops,tickprefix:t.tickprefix,showtickprefix:t.showtickprefix,ticksuffix:t.ticksuffix,showticksuffix:t.showticksuffix,separatethousands:t.separatethousands,exponentformat:t.exponentformat,minexponent:t.minexponent,showexponent:t.showexponent,title:{text:{valType:"string"},font:h({}),side:{valType:"enumerated",values:["right","top","bottom"],dflt:"top"}},_deprecated:{title:{valType:"string"},titlefont:h({}),titleside:{valType:"enumerated",values:["right","top","bottom"],dflt:"top"}}},"colorbars","from-root")},{"../../lib/extend":768,"../../plot_api/edit_types":810,"../../plots/cartesian/layout_attributes":842,"../../plots/font_attributes":856}],645:[function(n,z,q){"use strict";z.exports={cn:{colorbar:"colorbar",cbbg:"cbbg",cbfill:"cbfill",cbfills:"cbfills",cbline:"cbline",cblines:"cblines",cbaxis:"cbaxis",cbtitleunshift:"cbtitleunshift",cbtitle:"cbtitle",cboutline:"cboutline",crisp:"crisp",jsPlaceholder:"js-placeholder"}}},{}],646:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../../plot_api/plot_template"),p=n("../../plots/cartesian/tick_value_defaults"),l=n("../../plots/cartesian/tick_mark_defaults"),e=n("../../plots/cartesian/tick_label_defaults"),o=n("./attributes");z.exports=function(r,i,u){var s=h.newContainer(i,"colorbar"),a=r.colorbar||{};function c(y,v){return t.coerce(a,s,o,y,v)}var f=c("thicknessmode");c("thickness",f==="fraction"?30/(u.width-u.margin.l-u.margin.r):30);var g=c("lenmode");c("len",g==="fraction"?1:u.height-u.margin.t-u.margin.b),c("x"),c("xanchor"),c("xpad"),c("y"),c("yanchor"),c("ypad"),t.noneOrAll(a,s,["x","y"]),c("outlinecolor"),c("outlinewidth"),c("bordercolor"),c("borderwidth"),c("bgcolor");var d=c("ticklabelposition");p(a,s,c,"linear");var m={outerTicks:!1,font:u.font};d.indexOf("inside")!==-1&&(m.bgColor="black"),e(a,s,c,"linear",m),l(a,s,c,"linear",m),c("title.text",u._dfltTitle.colorbar),t.coerceFont(c,"title.font",u.font),c("title.side")}},{"../../lib":778,"../../plot_api/plot_template":817,"../../plots/cartesian/tick_label_defaults":849,"../../plots/cartesian/tick_mark_defaults":850,"../../plots/cartesian/tick_value_defaults":851,"./attributes":644}],647:[function(n,z,q){"use strict";var t=n("d3"),h=n("tinycolor2"),p=n("../../plots/plots"),l=n("../../registry"),e=n("../../plots/cartesian/axes"),o=n("../dragelement"),r=n("../../lib"),i=r.strTranslate,u=n("../../lib/extend").extendFlat,s=n("../../lib/setcursor"),a=n("../drawing"),c=n("../color"),f=n("../titles"),g=n("../../lib/svg_text_utils"),d=n("../colorscale/helpers").flipScale,m=n("../../plots/cartesian/axis_defaults"),y=n("../../plots/cartesian/position_defaults"),v=n("../../plots/cartesian/layout_attributes"),T=n("../../constants/alignment"),w=T.LINE_SPACING,A=T.FROM_TL,E=T.FROM_BR,M=n("./constants").cn;z.exports={draw:function(b){var _=b._fullLayout._infolayer.selectAll("g."+M.colorbar).data(function(S){var C,k,L,I,R=S._fullLayout,V=S.calcdata,O=[];function J(ee){return u(ee,{_fillcolor:null,_line:{color:null,width:null,dash:null},_levels:{start:null,end:null,size:null},_filllevels:null,_fillgradient:null,_zrange:null})}function D(){typeof I.calc=="function"?I.calc(S,L,C):(C._fillgradient=k.reversescale?d(k.colorscale):k.colorscale,C._zrange=[k[I.min],k[I.max]])}for(var B=0;B<V.length;B++){var N=V[B],F=(L=N[0].trace)._module.colorbar;if(L.visible===!0&&F)for(var H=Array.isArray(F),j=H?F:[F],G=0;G<j.length;G++){var W=(I=j[G]).container;(k=W?L[W]:L)&&k.showscale&&((C=J(k.colorbar))._id="cb"+L.uid+(H&&W?"-"+W:""),C._traceIndex=L.index,C._propPrefix=(W?W+".":"")+"colorbar.",C._meta=L._meta,D(),O.push(C))}}for(var Q in R._colorAxes)if((k=R[Q]).showscale){var $=R._colorAxes[Q];(C=J(k.colorbar))._id="cb"+Q,C._propPrefix=Q+".colorbar.",C._meta=R._meta,I={min:"cmin",max:"cmax"},$[0]!=="heatmap"&&(L=$[1],I.calc=L._module.colorbar.calc),D(),O.push(C)}return O}(b),function(S){return S._id});_.enter().append("g").attr("class",function(S){return S._id}).classed(M.colorbar,!0),_.each(function(S){var C=t.select(this);r.ensureSingle(C,"rect",M.cbbg),r.ensureSingle(C,"g",M.cbfills),r.ensureSingle(C,"g",M.cblines),r.ensureSingle(C,"g",M.cbaxis,function(L){L.classed(M.crisp,!0)}),r.ensureSingle(C,"g",M.cbtitleunshift,function(L){L.append("g").classed(M.cbtitle,!0)}),r.ensureSingle(C,"rect",M.cboutline);var k=function(L,I,R){var V=R._fullLayout,O=V._size,J=I._fillcolor,D=I._line,B=I.title,N=B.side,F=I._zrange||t.extent((typeof J=="function"?J:D.color).domain()),H=typeof D.color=="function"?D.color:function(){return D.color},j=typeof J=="function"?J:function(){return J},G=I._levels,W=function(Re,Ze,Ke){var $e,rt,at=Ze._levels,lt=[],gt=[],Ie=at.end+at.size/100,be=at.size,We=1.001*Ke[0]-.001*Ke[1],Ge=1.001*Ke[1]-.001*Ke[0];for(rt=0;rt<1e5&&($e=at.start+rt*be,!(be>0?$e>=Ie:$e<=Ie));rt++)$e>We&&$e<Ge&&lt.push($e);if(Ze._fillgradient)gt=[0];else if(typeof Ze._fillcolor=="function"){var st=Ze._filllevels;if(st)for(Ie=st.end+st.size/100,be=st.size,rt=0;rt<1e5&&($e=st.start+rt*be,!(be>0?$e>=Ie:$e<=Ie));rt++)$e>Ke[0]&&$e<Ke[1]&&gt.push($e);else(gt=lt.map(function(ot){return ot-at.size/2})).push(gt[gt.length-1]+at.size)}else Ze._fillcolor&&typeof Ze._fillcolor=="string"&&(gt=[0]);return at.size<0&&(lt.reverse(),gt.reverse()),{line:lt,fill:gt}}(0,I,F),Q=W.fill,$=W.line,ee=Math.round(I.thickness*(I.thicknessmode==="fraction"?O.w:1)),ie=ee/O.w,ae=Math.round(I.len*(I.lenmode==="fraction"?O.h:1)),oe=ae/O.h,de=I.xpad/O.w,le=(I.borderwidth+I.outlinewidth)/2,fe=I.ypad/O.h,ue=Math.round(I.x*O.w+I.xpad),we=I.x-ie*({middle:.5,right:1}[I.xanchor]||0),Ae=I.y+oe*(({top:-.5,bottom:.5}[I.yanchor]||0)-.5),Se=Math.round(O.h*(1-Ae)),ke=Se-ae;I._lenFrac=oe,I._thickFrac=ie,I._xLeftFrac=we,I._yBottomFrac=Ae;var Me=I._axis=function(Re,Ze,Ke){var $e=Re._fullLayout,rt={type:"linear",range:Ke,tickmode:Ze.tickmode,nticks:Ze.nticks,tick0:Ze.tick0,dtick:Ze.dtick,tickvals:Ze.tickvals,ticktext:Ze.ticktext,ticks:Ze.ticks,ticklen:Ze.ticklen,tickwidth:Ze.tickwidth,tickcolor:Ze.tickcolor,showticklabels:Ze.showticklabels,ticklabelposition:Ze.ticklabelposition,tickfont:Ze.tickfont,tickangle:Ze.tickangle,tickformat:Ze.tickformat,exponentformat:Ze.exponentformat,minexponent:Ze.minexponent,separatethousands:Ze.separatethousands,showexponent:Ze.showexponent,showtickprefix:Ze.showtickprefix,tickprefix:Ze.tickprefix,showticksuffix:Ze.showticksuffix,ticksuffix:Ze.ticksuffix,title:Ze.title,showline:!0,anchor:"free",side:"right",position:1},at={type:"linear",_id:"y"+Ze._id},lt={letter:"y",font:$e.font,noHover:!0,noTickson:!0,noTicklabelmode:!0,calendar:$e.calendar};function gt(Ie,be){return r.coerce(rt,at,v,Ie,be)}return m(rt,at,gt,lt,$e),y(rt,at,gt,lt),at}(R,I,F);if(Me.position=I.x+de+ie,["top","bottom"].indexOf(N)!==-1&&(Me.title.side=N,Me.titlex=I.x+de,Me.titley=Ae+(B.side==="top"?oe-fe:fe)),D.color&&I.tickmode==="auto"){Me.tickmode="linear",Me.tick0=G.start;var ve=G.size,ge=r.constrain((Se-ke)/50,4,15)+1,De=(F[1]-F[0])/((I.nticks||ge)*ve);if(De>1){var _e=Math.pow(10,Math.floor(Math.log(De)/Math.LN10));ve*=_e*r.roundUp(De/_e,[2,5,10]),(Math.abs(G.start)/G.size+1e-6)%1<2e-6&&(Me.tick0=0)}Me.dtick=ve}Me.domain=[Ae+fe,Ae+oe-fe],Me.setScale(),L.attr("transform",i(Math.round(O.l),Math.round(O.t)));var Pe,Fe=L.select("."+M.cbtitleunshift).attr("transform",i(-Math.round(O.l),-Math.round(O.t))),ze=L.select("."+M.cbaxis),He=0;function et(Re,Ze){var Ke={propContainer:Me,propName:I._propPrefix+"title",traceIndex:I._traceIndex,_meta:I._meta,placeholder:V._dfltTitle.colorbar,containerGroup:L.select("."+M.cbtitle)},$e=Re.charAt(0)==="h"?Re.substr(1):"h"+Re;L.selectAll("."+$e+",."+$e+"-math-group").remove(),f.draw(R,Re,u(Ke,Ze||{}))}return r.syncOrAsync([p.previousPromises,function(){if(["top","bottom"].indexOf(N)!==-1){var Re,Ze=O.l+(I.x+de)*O.w,Ke=Me.title.font.size;Re=N==="top"?(1-(Ae+oe-fe))*O.h+O.t+3+.75*Ke:(1-(Ae+fe))*O.h+O.t-3-.25*Ke,et(Me._id+"title",{attributes:{x:Ze,y:Re,"text-anchor":"start"}})}},function(){if(["top","bottom"].indexOf(N)!==-1){var Re=L.select("."+M.cbtitle),Ze=Re.select("text"),Ke=[-I.outlinewidth/2,I.outlinewidth/2],$e=Re.select(".h"+Me._id+"title-math-group").node(),rt=15.6;if(Ze.node()&&(rt=parseInt(Ze.node().style.fontSize,10)*w),$e?(He=a.bBox($e).height)>rt&&(Ke[1]-=(He-rt)/2):Ze.node()&&!Ze.classed(M.jsPlaceholder)&&(He=a.bBox(Ze.node()).height),He){if(He+=5,N==="top")Me.domain[1]-=He/O.h,Ke[1]*=-1;else{Me.domain[0]+=He/O.h;var at=g.lineCount(Ze);Ke[1]+=(1-at)*rt}Re.attr("transform",i(Ke[0],Ke[1])),Me.setScale()}}L.selectAll("."+M.cbfills+",."+M.cblines).attr("transform",i(0,Math.round(O.h*(1-Me.domain[1])))),ze.attr("transform",i(0,Math.round(-O.t)));var lt=L.select("."+M.cbfills).selectAll("rect."+M.cbfill).attr("style","").data(Q);lt.enter().append("rect").classed(M.cbfill,!0).style("stroke","none"),lt.exit().remove();var gt=F.map(Me.c2p).map(Math.round).sort(function(st,ot){return st-ot});lt.each(function(st,ot){var Ce=[ot===0?F[0]:(Q[ot]+Q[ot-1])/2,ot===Q.length-1?F[1]:(Q[ot]+Q[ot+1])/2].map(Me.c2p).map(Math.round);Ce[1]=r.constrain(Ce[1]+(Ce[1]>Ce[0])?1:-1,gt[0],gt[1]);var Ue=t.select(this).attr({x:ue,width:Math.max(ee,2),y:t.min(Ce),height:Math.max(t.max(Ce)-t.min(Ce),2)});if(I._fillgradient)a.gradient(Ue,R,I._id,"vertical",I._fillgradient,"fill");else{var Ye=j(st).replace("e-","");Ue.attr("fill",h(Ye).toHexString())}});var Ie=L.select("."+M.cblines).selectAll("path."+M.cbline).data(D.color&&D.width?$:[]);Ie.enter().append("path").classed(M.cbline,!0),Ie.exit().remove(),Ie.each(function(st){t.select(this).attr("d","M"+ue+","+(Math.round(Me.c2p(st))+D.width/2%1)+"h"+ee).call(a.lineGroupStyle,D.width,H(st),D.dash)}),ze.selectAll("g."+Me._id+"tick,path").remove();var be=ue+ee+(I.outlinewidth||0)/2-(I.ticks==="outside"?1:0),We=e.calcTicks(Me),Ge=e.getTickSigns(Me)[2];return e.drawTicks(R,Me,{vals:Me.ticks==="inside"?e.clipEnds(Me,We):We,layer:ze,path:e.makeTickPath(Me,be,Ge),transFn:e.makeTransTickFn(Me)}),e.drawLabels(R,Me,{vals:We,layer:ze,transFn:e.makeTransTickLabelFn(Me),labelFns:e.makeLabelFns(Me,be)})},function(){if(["top","bottom"].indexOf(N)===-1){var Re=Me.title.font.size,Ze=Me._offset+Me._length/2,Ke=O.l+(Me.position||0)*O.w+(Me.side==="right"?10+Re*(Me.showticklabels?1:.5):-10-Re*(Me.showticklabels?.5:0));et("h"+Me._id+"title",{avoid:{selection:t.select(R).selectAll("g."+Me._id+"tick"),side:N,offsetLeft:O.l,offsetTop:0,maxShift:V.width},attributes:{x:Ke,y:Ze,"text-anchor":"middle"},transform:{rotate:"-90",offset:0}})}},p.previousPromises,function(){var Re=ee+I.outlinewidth/2;if(Me.ticklabelposition.indexOf("inside")===-1&&(Re+=a.bBox(ze.node()).width),(Pe=Fe.select("text")).node()&&!Pe.classed(M.jsPlaceholder)){var Ze,Ke=Fe.select(".h"+Me._id+"title-math-group").node();Ze=Ke&&["top","bottom"].indexOf(N)!==-1?a.bBox(Ke).width:a.bBox(Fe.node()).right-ue-O.l,Re=Math.max(Re,Ze)}var $e=2*I.xpad+Re+I.borderwidth+I.outlinewidth/2,rt=Se-ke;L.select("."+M.cbbg).attr({x:ue-I.xpad-(I.borderwidth+I.outlinewidth)/2,y:ke-le,width:Math.max($e,2),height:Math.max(rt+2*le,2)}).call(c.fill,I.bgcolor).call(c.stroke,I.bordercolor).style("stroke-width",I.borderwidth),L.selectAll("."+M.cboutline).attr({x:ue,y:ke+I.ypad+(N==="top"?He:0),width:Math.max(ee,2),height:Math.max(rt-2*I.ypad-He,2)}).call(c.stroke,I.outlinecolor).style({fill:"none","stroke-width":I.outlinewidth});var at=({center:.5,right:1}[I.xanchor]||0)*$e;L.attr("transform",i(O.l-at,O.t));var lt={},gt=A[I.yanchor],Ie=E[I.yanchor];I.lenmode==="pixels"?(lt.y=I.y,lt.t=rt*gt,lt.b=rt*Ie):(lt.t=lt.b=0,lt.yt=I.y+I.len*gt,lt.yb=I.y-I.len*Ie);var be=A[I.xanchor],We=E[I.xanchor];if(I.thicknessmode==="pixels")lt.x=I.x,lt.l=$e*be,lt.r=$e*We;else{var Ge=$e-ee;lt.l=Ge*be,lt.r=Ge*We,lt.xl=I.x-I.thickness*be,lt.xr=I.x+I.thickness*We}p.autoMargin(R,I._id,lt)}],R)}(C,S,b);k&&k.then&&(b._promises||[]).push(k),b._context.edits.colorbarPosition&&function(L,I,R){var V,O,J,D=R._fullLayout._size;o.init({element:L.node(),gd:R,prepFn:function(){V=L.attr("transform"),s(L)},moveFn:function(B,N){L.attr("transform",V+i(B,N)),O=o.align(I._xLeftFrac+B/D.w,I._thickFrac,0,1,I.xanchor),J=o.align(I._yBottomFrac-N/D.h,I._lenFrac,0,1,I.yanchor);var F=o.getCursor(O,J,I.xanchor,I.yanchor);s(L,F)},doneFn:function(){if(s(L),O!==void 0&&J!==void 0){var B={};B[I._propPrefix+"x"]=O,B[I._propPrefix+"y"]=J,I._traceIndex!==void 0?l.call("_guiRestyle",R,B,I._traceIndex):l.call("_guiRelayout",R,B)}}})}(C,S,b)}),_.exit().each(function(S){p.autoMargin(b,S._id)}).remove(),_.order()}}},{"../../constants/alignment":745,"../../lib":778,"../../lib/extend":768,"../../lib/setcursor":799,"../../lib/svg_text_utils":803,"../../plots/cartesian/axes":828,"../../plots/cartesian/axis_defaults":830,"../../plots/cartesian/layout_attributes":842,"../../plots/cartesian/position_defaults":845,"../../plots/plots":891,"../../registry":911,"../color":643,"../colorscale/helpers":654,"../dragelement":662,"../drawing":665,"../titles":738,"./constants":645,d3:169,tinycolor2:576}],648:[function(n,z,q){"use strict";var t=n("../../lib");z.exports=function(h){return t.isPlainObject(h.colorbar)}},{"../../lib":778}],649:[function(n,z,q){"use strict";z.exports={moduleType:"component",name:"colorbar",attributes:n("./attributes"),supplyDefaults:n("./defaults"),draw:n("./draw").draw,hasColorbar:n("./has_colorbar")}},{"./attributes":644,"./defaults":646,"./draw":647,"./has_colorbar":648}],650:[function(n,z,q){"use strict";var t=n("../colorbar/attributes"),h=n("../../lib/regex").counter,p=n("./scales.js").scales;Object.keys(p);function l(e){return"`"+e+"`"}z.exports=function(e,o){e=e||"";var r,i=(o=o||{}).cLetter||"c",u=("onlyIfNumerical"in o&&o.onlyIfNumerical,"noScale"in o?o.noScale:e==="marker.line"),s="showScaleDflt"in o?o.showScaleDflt:i==="z",a=typeof o.colorscaleDflt=="string"?p[o.colorscaleDflt]:null,c=o.editTypeOverride||"",f=e?e+".":"";"colorAttr"in o?(r=o.colorAttr,o.colorAttr):l(f+(r={z:"z",c:"color"}[i]));var g=i+"auto",d=i+"min",m=i+"max",y=i+"mid",v=(l(f+g),l(f+d),l(f+m),{});v[d]=v[m]=void 0;var T={};T[g]=!1;var w={};return r==="color"&&(w.color={valType:"color",arrayOk:!0,editType:c||"style"},o.anim&&(w.color.anim=!0)),w[g]={valType:"boolean",dflt:!0,editType:"calc",impliedEdits:v},w[d]={valType:"number",dflt:null,editType:c||"plot",impliedEdits:T},w[m]={valType:"number",dflt:null,editType:c||"plot",impliedEdits:T},w[y]={valType:"number",dflt:null,editType:"calc",impliedEdits:v},w.colorscale={valType:"colorscale",editType:"calc",dflt:a,impliedEdits:{autocolorscale:!1}},w.autocolorscale={valType:"boolean",dflt:o.autoColorDflt!==!1,editType:"calc",impliedEdits:{colorscale:void 0}},w.reversescale={valType:"boolean",dflt:!1,editType:"plot"},u||(w.showscale={valType:"boolean",dflt:s,editType:"calc"},w.colorbar=t),o.noColorAxis||(w.coloraxis={valType:"subplotid",regex:h("coloraxis"),dflt:null,editType:"calc"}),w}},{"../../lib/regex":795,"../colorbar/attributes":644,"./scales.js":658}],651:[function(n,z,q){"use strict";var t=n("fast-isnumeric"),h=n("../../lib"),p=n("./helpers").extractOpts;z.exports=function(l,e,o){var r,i=l._fullLayout,u=o.vals,s=o.containerStr,a=s?h.nestedProperty(e,s).get():e,c=p(a),f=c.auto!==!1,g=c.min,d=c.max,m=c.mid,y=function(){return h.aggNums(Math.min,null,u)},v=function(){return h.aggNums(Math.max,null,u)};g===void 0?g=y():f&&(g=a._colorAx&&t(g)?Math.min(g,y()):y()),d===void 0?d=v():f&&(d=a._colorAx&&t(d)?Math.max(d,v()):v()),f&&m!==void 0&&(d-m>m-g?g=m-(d-m):d-m<m-g&&(d=m+(m-g))),g===d&&(g-=.5,d+=.5),c._sync("min",g),c._sync("max",d),c.autocolorscale&&(r=g*d<0?i.colorscale.diverging:g>=0?i.colorscale.sequential:i.colorscale.sequentialminus,c._sync("colorscale",r))}},{"../../lib":778,"./helpers":654,"fast-isnumeric":241}],652:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("./helpers").hasColorscale,p=n("./helpers").extractOpts;z.exports=function(l,e){function o(f,g){var d=f["_"+g];d!==void 0&&(f[g]=d)}function r(f,g){var d=g.container?t.nestedProperty(f,g.container).get():f;if(d)if(d.coloraxis)d._colorAx=e[d.coloraxis];else{var m=p(d),y=m.auto;(y||m.min===void 0)&&o(d,g.min),(y||m.max===void 0)&&o(d,g.max),m.autocolorscale&&o(d,"colorscale")}}for(var i=0;i<l.length;i++){var u=l[i],s=u._module.colorbar;if(s)if(Array.isArray(s))for(var a=0;a<s.length;a++)r(u,s[a]);else r(u,s);h(u,"marker.line")&&r(u,{container:"marker.line",min:"cmin",max:"cmax"})}for(var c in e._colorAxes)r(e[c],{min:"cmin",max:"cmax"})}},{"../../lib":778,"./helpers":654}],653:[function(n,z,q){"use strict";var t=n("fast-isnumeric"),h=n("../../lib"),p=n("../colorbar/has_colorbar"),l=n("../colorbar/defaults"),e=n("./scales").isValid,o=n("../../registry").traceIs;function r(i,u){var s=u.slice(0,u.length-1);return u?h.nestedProperty(i,s).get()||{}:i}z.exports=function i(u,s,a,c,f){var g=f.prefix,d=f.cLetter,m="_module"in s,y=r(u,g),v=r(s,g),T=r(s._template||{},g)||{},w=function(){return delete u.coloraxis,delete s.coloraxis,i(u,s,a,c,f)};if(m){var A=a._colorAxes||{},E=c(g+"coloraxis");if(E){var M=o(s,"contour")&&h.nestedProperty(s,"contours.coloring").get()||"heatmap",b=A[E];return void(b?(b[2].push(w),b[0]!==M&&(b[0]=!1,h.warn(["Ignoring coloraxis:",E,"setting","as it is linked to incompatible colorscales."].join(" ")))):A[E]=[M,s,[w]])}}var _=y[d+"min"],S=y[d+"max"],C=t(_)&&t(S)&&_<S;c(g+d+"auto",!C)?c(g+d+"mid"):(c(g+d+"min"),c(g+d+"max"));var k,L,I=y.colorscale,R=T.colorscale;I!==void 0&&(k=!e(I)),R!==void 0&&(k=!e(R)),c(g+"autocolorscale",k),c(g+"colorscale"),c(g+"reversescale"),g!=="marker.line."&&(g&&m&&(L=p(y)),c(g+"showscale",L)&&(g&&T&&(v._template=T),l(y,v,a)))}},{"../../lib":778,"../../registry":911,"../colorbar/defaults":646,"../colorbar/has_colorbar":648,"./scales":658,"fast-isnumeric":241}],654:[function(n,z,q){"use strict";var t=n("d3"),h=n("tinycolor2"),p=n("fast-isnumeric"),l=n("../../lib"),e=n("../color"),o=n("./scales").isValid,r=["showscale","autocolorscale","colorscale","reversescale","colorbar"],i=["min","max","mid","auto"];function u(g){var d,m,y,v=g._colorAx,T=v||g,w={};for(m=0;m<r.length;m++)w[y=r[m]]=T[y];if(v)for(d="c",m=0;m<i.length;m++)w[y=i[m]]=T["c"+y];else{var A;for(m=0;m<i.length;m++)((A="c"+(y=i[m]))in T||(A="z"+y)in T)&&(w[y]=T[A]);d=A.charAt(0)}return w._sync=function(E,M){var b=i.indexOf(E)!==-1?d+E:E;T[b]=T["_"+b]=M},w}function s(g){for(var d=u(g),m=d.min,y=d.max,v=d.reversescale?a(d.colorscale):d.colorscale,T=v.length,w=new Array(T),A=new Array(T),E=0;E<T;E++){var M=v[E];w[E]=m+M[0]*(y-m),A[E]=M[1]}return{domain:w,range:A}}function a(g){for(var d=g.length,m=new Array(d),y=d-1,v=0;y>=0;y--,v++){var T=g[y];m[v]=[1-T[0],T[1]]}return m}function c(g,d){d=d||{};for(var m=g.domain,y=g.range,v=y.length,T=new Array(v),w=0;w<v;w++){var A=h(y[w]).toRgb();T[w]=[A.r,A.g,A.b,A.a]}var E,M=t.scale.linear().domain(m).range(T).clamp(!0),b=d.noNumericCheck,_=d.returnArray;return(E=b&&_?M:b?function(S){return f(M(S))}:_?function(S){return p(S)?M(S):h(S).isValid()?S:e.defaultLine}:function(S){return p(S)?f(M(S)):h(S).isValid()?S:e.defaultLine}).domain=M.domain,E.range=function(){return y},E}function f(g){var d={r:g[0],g:g[1],b:g[2],a:g[3]};return h(d).toRgbString()}z.exports={hasColorscale:function(g,d,m){var y=d?l.nestedProperty(g,d).get()||{}:g,v=y[m||"color"],T=!1;if(l.isArrayOrTypedArray(v)){for(var w=0;w<v.length;w++)if(p(v[w])){T=!0;break}}return l.isPlainObject(y)&&(T||y.showscale===!0||p(y.cmin)&&p(y.cmax)||o(y.colorscale)||l.isPlainObject(y.colorbar))},extractOpts:u,extractScale:s,flipScale:a,makeColorScaleFunc:c,makeColorScaleFuncFromTrace:function(g,d){return c(s(g),d)}}},{"../../lib":778,"../color":643,"./scales":658,d3:169,"fast-isnumeric":241,tinycolor2:576}],655:[function(n,z,q){"use strict";var t=n("./scales"),h=n("./helpers");z.exports={moduleType:"component",name:"colorscale",attributes:n("./attributes"),layoutAttributes:n("./layout_attributes"),supplyLayoutDefaults:n("./layout_defaults"),handleDefaults:n("./defaults"),crossTraceDefaults:n("./cross_trace_defaults"),calc:n("./calc"),scales:t.scales,defaultScale:t.defaultScale,getScale:t.get,isValidScale:t.isValid,hasColorscale:h.hasColorscale,extractOpts:h.extractOpts,extractScale:h.extractScale,flipScale:h.flipScale,makeColorScaleFunc:h.makeColorScaleFunc,makeColorScaleFuncFromTrace:h.makeColorScaleFuncFromTrace}},{"./attributes":650,"./calc":651,"./cross_trace_defaults":652,"./defaults":653,"./helpers":654,"./layout_attributes":656,"./layout_defaults":657,"./scales":658}],656:[function(n,z,q){"use strict";var t=n("../../lib/extend").extendFlat,h=n("./attributes"),p=n("./scales").scales;z.exports={editType:"calc",colorscale:{editType:"calc",sequential:{valType:"colorscale",dflt:p.Reds,editType:"calc"},sequentialminus:{valType:"colorscale",dflt:p.Blues,editType:"calc"},diverging:{valType:"colorscale",dflt:p.RdBu,editType:"calc"}},coloraxis:t({_isSubplotObj:!0,editType:"calc"},h("",{colorAttr:"corresponding trace color array(s)",noColorAxis:!0,showScaleDflt:!0}))}},{"../../lib/extend":768,"./attributes":650,"./scales":658}],657:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../../plot_api/plot_template"),p=n("./layout_attributes"),l=n("./defaults");z.exports=function(e,o){function r(d,m){return t.coerce(e,o,p,d,m)}r("colorscale.sequential"),r("colorscale.sequentialminus"),r("colorscale.diverging");var i,u,s=o._colorAxes;function a(d,m){return t.coerce(i,u,p.coloraxis,d,m)}for(var c in s){var f=s[c];if(f[0])i=e[c]||{},(u=h.newContainer(o,c,"coloraxis"))._name=c,l(i,u,o,a,{prefix:"",cLetter:"c"});else{for(var g=0;g<f[2].length;g++)f[2][g]();delete o._colorAxes[c]}}}},{"../../lib":778,"../../plot_api/plot_template":817,"./defaults":653,"./layout_attributes":656}],658:[function(n,z,q){"use strict";var t=n("tinycolor2"),h={Greys:[[0,"rgb(0,0,0)"],[1,"rgb(255,255,255)"]],YlGnBu:[[0,"rgb(8,29,88)"],[.125,"rgb(37,52,148)"],[.25,"rgb(34,94,168)"],[.375,"rgb(29,145,192)"],[.5,"rgb(65,182,196)"],[.625,"rgb(127,205,187)"],[.75,"rgb(199,233,180)"],[.875,"rgb(237,248,217)"],[1,"rgb(255,255,217)"]],Greens:[[0,"rgb(0,68,27)"],[.125,"rgb(0,109,44)"],[.25,"rgb(35,139,69)"],[.375,"rgb(65,171,93)"],[.5,"rgb(116,196,118)"],[.625,"rgb(161,217,155)"],[.75,"rgb(199,233,192)"],[.875,"rgb(229,245,224)"],[1,"rgb(247,252,245)"]],YlOrRd:[[0,"rgb(128,0,38)"],[.125,"rgb(189,0,38)"],[.25,"rgb(227,26,28)"],[.375,"rgb(252,78,42)"],[.5,"rgb(253,141,60)"],[.625,"rgb(254,178,76)"],[.75,"rgb(254,217,118)"],[.875,"rgb(255,237,160)"],[1,"rgb(255,255,204)"]],Bluered:[[0,"rgb(0,0,255)"],[1,"rgb(255,0,0)"]],RdBu:[[0,"rgb(5,10,172)"],[.35,"rgb(106,137,247)"],[.5,"rgb(190,190,190)"],[.6,"rgb(220,170,132)"],[.7,"rgb(230,145,90)"],[1,"rgb(178,10,28)"]],Reds:[[0,"rgb(220,220,220)"],[.2,"rgb(245,195,157)"],[.4,"rgb(245,160,105)"],[1,"rgb(178,10,28)"]],Blues:[[0,"rgb(5,10,172)"],[.35,"rgb(40,60,190)"],[.5,"rgb(70,100,245)"],[.6,"rgb(90,120,245)"],[.7,"rgb(106,137,247)"],[1,"rgb(220,220,220)"]],Picnic:[[0,"rgb(0,0,255)"],[.1,"rgb(51,153,255)"],[.2,"rgb(102,204,255)"],[.3,"rgb(153,204,255)"],[.4,"rgb(204,204,255)"],[.5,"rgb(255,255,255)"],[.6,"rgb(255,204,255)"],[.7,"rgb(255,153,255)"],[.8,"rgb(255,102,204)"],[.9,"rgb(255,102,102)"],[1,"rgb(255,0,0)"]],Rainbow:[[0,"rgb(150,0,90)"],[.125,"rgb(0,0,200)"],[.25,"rgb(0,25,255)"],[.375,"rgb(0,152,255)"],[.5,"rgb(44,255,150)"],[.625,"rgb(151,255,0)"],[.75,"rgb(255,234,0)"],[.875,"rgb(255,111,0)"],[1,"rgb(255,0,0)"]],Portland:[[0,"rgb(12,51,131)"],[.25,"rgb(10,136,186)"],[.5,"rgb(242,211,56)"],[.75,"rgb(242,143,56)"],[1,"rgb(217,30,30)"]],Jet:[[0,"rgb(0,0,131)"],[.125,"rgb(0,60,170)"],[.375,"rgb(5,255,255)"],[.625,"rgb(255,255,0)"],[.875,"rgb(250,0,0)"],[1,"rgb(128,0,0)"]],Hot:[[0,"rgb(0,0,0)"],[.3,"rgb(230,0,0)"],[.6,"rgb(255,210,0)"],[1,"rgb(255,255,255)"]],Blackbody:[[0,"rgb(0,0,0)"],[.2,"rgb(230,0,0)"],[.4,"rgb(230,210,0)"],[.7,"rgb(255,255,255)"],[1,"rgb(160,200,255)"]],Earth:[[0,"rgb(0,0,130)"],[.1,"rgb(0,180,180)"],[.2,"rgb(40,210,40)"],[.4,"rgb(230,230,50)"],[.6,"rgb(120,70,20)"],[1,"rgb(255,255,255)"]],Electric:[[0,"rgb(0,0,0)"],[.15,"rgb(30,0,100)"],[.4,"rgb(120,0,100)"],[.6,"rgb(160,90,0)"],[.8,"rgb(230,200,0)"],[1,"rgb(255,250,220)"]],Viridis:[[0,"#440154"],[.06274509803921569,"#48186a"],[.12549019607843137,"#472d7b"],[.18823529411764706,"#424086"],[.25098039215686274,"#3b528b"],[.3137254901960784,"#33638d"],[.3764705882352941,"#2c728e"],[.4392156862745098,"#26828e"],[.5019607843137255,"#21918c"],[.5647058823529412,"#1fa088"],[.6274509803921569,"#28ae80"],[.6901960784313725,"#3fbc73"],[.7529411764705882,"#5ec962"],[.8156862745098039,"#84d44b"],[.8784313725490196,"#addc30"],[.9411764705882353,"#d8e219"],[1,"#fde725"]],Cividis:[[0,"rgb(0,32,76)"],[.058824,"rgb(0,42,102)"],[.117647,"rgb(0,52,110)"],[.176471,"rgb(39,63,108)"],[.235294,"rgb(60,74,107)"],[.294118,"rgb(76,85,107)"],[.352941,"rgb(91,95,109)"],[.411765,"rgb(104,106,112)"],[.470588,"rgb(117,117,117)"],[.529412,"rgb(131,129,120)"],[.588235,"rgb(146,140,120)"],[.647059,"rgb(161,152,118)"],[.705882,"rgb(176,165,114)"],[.764706,"rgb(192,177,109)"],[.823529,"rgb(209,191,102)"],[.882353,"rgb(225,204,92)"],[.941176,"rgb(243,219,79)"],[1,"rgb(255,233,69)"]]},p=h.RdBu;function l(e){var o=0;if(!Array.isArray(e)||e.length<2||!e[0]||!e[e.length-1]||+e[0][0]!=0||+e[e.length-1][0]!=1)return!1;for(var r=0;r<e.length;r++){var i=e[r];if(i.length!==2||+i[0]<o||!t(i[1]).isValid())return!1;o=+i[0]}return!0}z.exports={scales:h,defaultScale:p,get:function(e,o){if(o||(o=p),!e)return o;function r(){try{e=h[e]||JSON.parse(e)}catch{e=o}}return typeof e=="string"&&(r(),typeof e=="string"&&r()),l(e)?e:o},isValid:function(e){return h[e]!==void 0||l(e)}}},{tinycolor2:576}],659:[function(n,z,q){"use strict";z.exports=function(t,h,p,l,e){var o=(t-p)/(l-p),r=o+h/(l-p),i=(o+r)/2;return e==="left"||e==="bottom"?o:e==="center"||e==="middle"?i:e==="right"||e==="top"?r:o<2/3-i?o:r>4/3-i?r:i}},{}],660:[function(n,z,q){"use strict";var t=n("../../lib"),h=[["sw-resize","s-resize","se-resize"],["w-resize","move","e-resize"],["nw-resize","n-resize","ne-resize"]];z.exports=function(p,l,e,o){return p=e==="left"?0:e==="center"?1:e==="right"?2:t.constrain(Math.floor(3*p),0,2),l=o==="bottom"?0:o==="middle"?1:o==="top"?2:t.constrain(Math.floor(3*l),0,2),h[l][p]}},{"../../lib":778}],661:[function(n,z,q){"use strict";q.selectMode=function(t){return t==="lasso"||t==="select"},q.drawMode=function(t){return t==="drawclosedpath"||t==="drawopenpath"||t==="drawline"||t==="drawrect"||t==="drawcircle"},q.openMode=function(t){return t==="drawline"||t==="drawopenpath"},q.rectMode=function(t){return t==="select"||t==="drawline"||t==="drawrect"||t==="drawcircle"},q.freeMode=function(t){return t==="lasso"||t==="drawclosedpath"||t==="drawopenpath"},q.selectingOrDrawing=function(t){return q.freeMode(t)||q.rectMode(t)}},{}],662:[function(n,z,q){"use strict";var t=n("mouse-event-offset"),h=n("has-hover"),p=n("has-passive-events"),l=n("../../lib").removeElement,e=n("../../plots/cartesian/constants"),o=z.exports={};o.align=n("./align"),o.getCursor=n("./cursor");var r=n("./unhover");function i(){var s=document.createElement("div");s.className="dragcover";var a=s.style;return a.position="fixed",a.left=0,a.right=0,a.top=0,a.bottom=0,a.zIndex=999999999,a.background="none",document.body.appendChild(s),s}function u(s){return t(s.changedTouches?s.changedTouches[0]:s,document.body)}o.unhover=r.wrapped,o.unhoverRaw=r.raw,o.init=function(s){var a,c,f,g,d,m,y,v,T=s.gd,w=1,A=T._context.doubleClickDelay,E=s.element;T._mouseDownTime||(T._mouseDownTime=0),E.style.pointerEvents="all",E.onmousedown=b,p?(E._ontouchstart&&E.removeEventListener("touchstart",E._ontouchstart),E._ontouchstart=b,E.addEventListener("touchstart",b,{passive:!1})):E.ontouchstart=b;var M=s.clampFn||function(C,k,L){return Math.abs(C)<L&&(C=0),Math.abs(k)<L&&(k=0),[C,k]};function b(C){T._dragged=!1,T._dragging=!0;var k=u(C);a=k[0],c=k[1],y=C.target,m=C,v=C.buttons===2||C.ctrlKey,typeof C.clientX>"u"&&typeof C.clientY>"u"&&(C.clientX=a,C.clientY=c),(f=new Date().getTime())-T._mouseDownTime<A?w+=1:(w=1,T._mouseDownTime=f),s.prepFn&&s.prepFn(C,a,c),h&&!v?(d=i()).style.cursor=window.getComputedStyle(E).cursor:h||(d=document,g=window.getComputedStyle(document.documentElement).cursor,document.documentElement.style.cursor=window.getComputedStyle(E).cursor),document.addEventListener("mouseup",S),document.addEventListener("touchend",S),s.dragmode!==!1&&(C.preventDefault(),document.addEventListener("mousemove",_),document.addEventListener("touchmove",_,{passive:!1}))}function _(C){C.preventDefault();var k=u(C),L=s.minDrag||e.MINDRAG,I=M(k[0]-a,k[1]-c,L),R=I[0],V=I[1];(R||V)&&(T._dragged=!0,o.unhover(T)),T._dragged&&s.moveFn&&!v&&(T._dragdata={element:E,dx:R,dy:V},s.moveFn(R,V))}function S(C){if(delete T._dragdata,s.dragmode!==!1&&(C.preventDefault(),document.removeEventListener("mousemove",_),document.removeEventListener("touchmove",_)),document.removeEventListener("mouseup",S),document.removeEventListener("touchend",S),h?l(d):g&&(d.documentElement.style.cursor=g,g=null),T._dragging){if(T._dragging=!1,new Date().getTime()-T._mouseDownTime>A&&(w=Math.max(w-1,1)),T._dragged)s.doneFn&&s.doneFn();else if(s.clickFn&&s.clickFn(w,m),!v){var k;try{k=new MouseEvent("click",C)}catch{var L=u(C);(k=document.createEvent("MouseEvents")).initMouseEvent("click",C.bubbles,C.cancelable,C.view,C.detail,C.screenX,C.screenY,L[0],L[1],C.ctrlKey,C.altKey,C.shiftKey,C.metaKey,C.button,C.relatedTarget)}y.dispatchEvent(k)}T._dragging=!1,T._dragged=!1}else T._dragged=!1}},o.coverSlip=i},{"../../lib":778,"../../plots/cartesian/constants":834,"./align":659,"./cursor":660,"./unhover":663,"has-hover":440,"has-passive-events":441,"mouse-event-offset":484}],663:[function(n,z,q){"use strict";var t=n("../../lib/events"),h=n("../../lib/throttle"),p=n("../../lib/dom").getGraphDiv,l=n("../fx/constants"),e=z.exports={};e.wrapped=function(o,r,i){(o=p(o))._fullLayout&&h.clear(o._fullLayout._uid+l.HOVERID),e.raw(o,r,i)},e.raw=function(o,r){var i=o._fullLayout,u=o._hoverdata;r||(r={}),r.target&&t.triggerHandler(o,"plotly_beforehover",r)===!1||(i._hoverlayer.selectAll("g").remove(),i._hoverlayer.selectAll("line").remove(),i._hoverlayer.selectAll("circle").remove(),o._hoverdata=void 0,r.target&&u&&o.emit("plotly_unhover",{event:r,points:u}))}},{"../../lib/dom":766,"../../lib/events":767,"../../lib/throttle":804,"../fx/constants":677}],664:[function(n,z,q){"use strict";q.dash={valType:"string",values:["solid","dot","dash","longdash","dashdot","longdashdot"],dflt:"solid",editType:"style"}},{}],665:[function(n,z,q){"use strict";var t=n("d3"),h=n("fast-isnumeric"),p=n("tinycolor2"),l=n("../../registry"),e=n("../color"),o=n("../colorscale"),r=n("../../lib"),i=r.strTranslate,u=n("../../lib/svg_text_utils"),s=n("../../constants/xmlns_namespaces"),a=n("../../constants/alignment").LINE_SPACING,c=n("../../constants/interactions").DESELECTDIM,f=n("../../traces/scatter/subtypes"),g=n("../../traces/scatter/make_bubble_size_func"),d=n("../../components/fx/helpers").appendArrayPointValue,m=z.exports={};m.font=function(D,B,N,F){r.isPlainObject(B)&&(F=B.color,N=B.size,B=B.family),B&&D.style("font-family",B),N+1&&D.style("font-size",N+"px"),F&&D.call(e.fill,F)},m.setPosition=function(D,B,N){D.attr("x",B).attr("y",N)},m.setSize=function(D,B,N){D.attr("width",B).attr("height",N)},m.setRect=function(D,B,N,F,H){D.call(m.setPosition,B,N).call(m.setSize,F,H)},m.translatePoint=function(D,B,N,F){var H=N.c2p(D.x),j=F.c2p(D.y);return!!(h(H)&&h(j)&&B.node())&&(B.node().nodeName==="text"?B.attr("x",H).attr("y",j):B.attr("transform",i(H,j)),!0)},m.translatePoints=function(D,B,N){D.each(function(F){var H=t.select(this);m.translatePoint(F,H,B,N)})},m.hideOutsideRangePoint=function(D,B,N,F,H,j){B.attr("display",N.isPtWithinRange(D,H)&&F.isPtWithinRange(D,j)?null:"none")},m.hideOutsideRangePoints=function(D,B){if(B._hasClipOnAxisFalse){var N=B.xaxis,F=B.yaxis;D.each(function(H){var j=H[0].trace,G=j.xcalendar,W=j.ycalendar,Q=l.traceIs(j,"bar-like")?".bartext":".point,.textpoint";D.selectAll(Q).each(function($){m.hideOutsideRangePoint($,t.select(this),N,F,G,W)})})}},m.crispRound=function(D,B,N){return B&&h(B)?D._context.staticPlot?B:B<1?1:Math.round(B):N||0},m.singleLineStyle=function(D,B,N,F,H){B.style("fill","none");var j=(((D||[])[0]||{}).trace||{}).line||{},G=N||j.width||0,W=H||j.dash||"";e.stroke(B,F||j.color),m.dashLine(B,W,G)},m.lineGroupStyle=function(D,B,N,F){D.style("fill","none").each(function(H){var j=(((H||[])[0]||{}).trace||{}).line||{},G=B||j.width||0,W=F||j.dash||"";t.select(this).call(e.stroke,N||j.color).call(m.dashLine,W,G)})},m.dashLine=function(D,B,N){N=+N||0,B=m.dashStyle(B,N),D.style({"stroke-dasharray":B,"stroke-width":N+"px"})},m.dashStyle=function(D,B){B=+B||1;var N=Math.max(B,3);return D==="solid"?D="":D==="dot"?D=N+"px,"+N+"px":D==="dash"?D=3*N+"px,"+3*N+"px":D==="longdash"?D=5*N+"px,"+5*N+"px":D==="dashdot"?D=3*N+"px,"+N+"px,"+N+"px,"+N+"px":D==="longdashdot"&&(D=5*N+"px,"+2*N+"px,"+N+"px,"+2*N+"px"),D},m.singleFillStyle=function(D){var B=(((t.select(D.node()).data()[0]||[])[0]||{}).trace||{}).fillcolor;B&&D.call(e.fill,B)},m.fillGroupStyle=function(D){D.style("stroke-width",0).each(function(B){var N=t.select(this);B[0].trace&&N.call(e.fill,B[0].trace.fillcolor)})};var y=n("./symbol_defs");m.symbolNames=[],m.symbolFuncs=[],m.symbolNeedLines={},m.symbolNoDot={},m.symbolNoFill={},m.symbolList=[],Object.keys(y).forEach(function(D){var B=y[D],N=B.n;m.symbolList.push(N,String(N),D,N+100,String(N+100),D+"-open"),m.symbolNames[N]=D,m.symbolFuncs[N]=B.f,B.needLine&&(m.symbolNeedLines[N]=!0),B.noDot?m.symbolNoDot[N]=!0:m.symbolList.push(N+200,String(N+200),D+"-dot",N+300,String(N+300),D+"-open-dot"),B.noFill&&(m.symbolNoFill[N]=!0)});var v=m.symbolNames.length;function T(D,B){var N=D%100;return m.symbolFuncs[N](B)+(D>=200?"M0,0.5L0.5,0L0,-0.5L-0.5,0Z":"")}m.symbolNumber=function(D){if(h(D))D=+D;else if(typeof D=="string"){var B=0;D.indexOf("-open")>0&&(B=100,D=D.replace("-open","")),D.indexOf("-dot")>0&&(B+=200,D=D.replace("-dot","")),(D=m.symbolNames.indexOf(D))>=0&&(D+=B)}return D%100>=v||D>=400?0:Math.floor(Math.max(D,0))};var w={x1:1,x2:0,y1:0,y2:0},A={x1:0,x2:0,y1:1,y2:0},E=t.format("~.1f"),M={radial:{node:"radialGradient"},radialreversed:{node:"radialGradient",reversed:!0},horizontal:{node:"linearGradient",attrs:w},horizontalreversed:{node:"linearGradient",attrs:w,reversed:!0},vertical:{node:"linearGradient",attrs:A},verticalreversed:{node:"linearGradient",attrs:A,reversed:!0}};m.gradient=function(D,B,N,F,H,j){for(var G=H.length,W=M[F],Q=new Array(G),$=0;$<G;$++)W.reversed?Q[G-1-$]=[E(100*(1-H[$][0])),H[$][1]]:Q[$]=[E(100*H[$][0]),H[$][1]];var ee=B._fullLayout,ie="g"+ee._uid+"-"+N,ae=ee._defs.select(".gradients").selectAll("#"+ie).data([F+Q.join(";")],r.identity);ae.exit().remove(),ae.enter().append(W.node).each(function(){var le=t.select(this);W.attrs&&le.attr(W.attrs),le.attr("id",ie);var fe=le.selectAll("stop").data(Q);fe.exit().remove(),fe.enter().append("stop"),fe.each(function(ue){var we=p(ue[1]);t.select(this).attr({offset:ue[0]+"%","stop-color":e.tinyRGB(we),"stop-opacity":we.getAlpha()})})}),D.style(j,V(ie,B)).style(j+"-opacity",null);var oe=function(le){return"."+le.attr("class").replace(/\s/g,".")},de=oe(t.select(D.node().parentNode))+">"+oe(D);ee._gradientUrlQueryParts[de]=1},m.initGradients=function(D){var B=D._fullLayout;r.ensureSingle(B._defs,"g","gradients").selectAll("linearGradient,radialGradient").remove(),B._gradientUrlQueryParts={}},m.pointStyle=function(D,B,N){if(D.size()){var F=m.makePointStyleFns(B);D.each(function(H){m.singlePointStyle(H,t.select(this),B,F,N)})}},m.singlePointStyle=function(D,B,N,F,H){var j=N.marker,G=j.line;if(B.style("opacity",F.selectedOpacityFn?F.selectedOpacityFn(D):D.mo===void 0?j.opacity:D.mo),F.ms2mrc){var W;W=D.ms==="various"||j.size==="various"?3:F.ms2mrc(D.ms),D.mrc=W,F.selectedSizeFn&&(W=D.mrc=F.selectedSizeFn(D));var Q=m.symbolNumber(D.mx||j.symbol)||0;D.om=Q%200>=100,B.attr("d",T(Q,W))}var $,ee,ie,ae=!1;if(D.so)ie=G.outlierwidth,ee=G.outliercolor,$=j.outliercolor;else{var oe=(G||{}).width;ie=(D.mlw+1||oe+1||(D.trace?(D.trace.marker.line||{}).width:0)+1)-1||0,ee="mlc"in D?D.mlcc=F.lineScale(D.mlc):r.isArrayOrTypedArray(G.color)?e.defaultLine:G.color,r.isArrayOrTypedArray(j.color)&&($=e.defaultLine,ae=!0),$="mc"in D?D.mcc=F.markerScale(D.mc):j.color||"rgba(0,0,0,0)",F.selectedColorFn&&($=F.selectedColorFn(D))}if(D.om)B.call(e.stroke,$).style({"stroke-width":(ie||1)+"px",fill:"none"});else{B.style("stroke-width",(D.isBlank?0:ie)+"px");var de=j.gradient,le=D.mgt;if(le?ae=!0:le=de&&de.type,Array.isArray(le)&&(le=le[0],M[le]||(le=0)),le&&le!=="none"){var fe=D.mgc;fe?ae=!0:fe=de.color;var ue=N.uid;ae&&(ue+="-"+D.i),m.gradient(B,H,ue,le,[[0,fe],[1,$]],"fill")}else e.fill(B,$);ie&&e.stroke(B,ee)}},m.makePointStyleFns=function(D){var B={},N=D.marker;return B.markerScale=m.tryColorscale(N,""),B.lineScale=m.tryColorscale(N,"line"),l.traceIs(D,"symbols")&&(B.ms2mrc=f.isBubble(D)?g(D):function(){return(N.size||6)/2}),D.selectedpoints&&r.extendFlat(B,m.makeSelectedPointStyleFns(D)),B},m.makeSelectedPointStyleFns=function(D){var B={},N=D.selected||{},F=D.unselected||{},H=D.marker||{},j=N.marker||{},G=F.marker||{},W=H.opacity,Q=j.opacity,$=G.opacity,ee=Q!==void 0,ie=$!==void 0;(r.isArrayOrTypedArray(W)||ee||ie)&&(B.selectedOpacityFn=function(Se){var ke=Se.mo===void 0?H.opacity:Se.mo;return Se.selected?ee?Q:ke:ie?$:c*ke});var ae=H.color,oe=j.color,de=G.color;(oe||de)&&(B.selectedColorFn=function(Se){var ke=Se.mcc||ae;return Se.selected?oe||ke:de||ke});var le=H.size,fe=j.size,ue=G.size,we=fe!==void 0,Ae=ue!==void 0;return l.traceIs(D,"symbols")&&(we||Ae)&&(B.selectedSizeFn=function(Se){var ke=Se.mrc||le/2;return Se.selected?we?fe/2:ke:Ae?ue/2:ke}),B},m.makeSelectedTextStyleFns=function(D){var B={},N=D.selected||{},F=D.unselected||{},H=D.textfont||{},j=N.textfont||{},G=F.textfont||{},W=H.color,Q=j.color,$=G.color;return B.selectedTextColorFn=function(ee){var ie=ee.tc||W;return ee.selected?Q||ie:$||(Q?ie:e.addOpacity(ie,c))},B},m.selectedPointStyle=function(D,B){if(D.size()&&B.selectedpoints){var N=m.makeSelectedPointStyleFns(B),F=B.marker||{},H=[];N.selectedOpacityFn&&H.push(function(j,G){j.style("opacity",N.selectedOpacityFn(G))}),N.selectedColorFn&&H.push(function(j,G){e.fill(j,N.selectedColorFn(G))}),N.selectedSizeFn&&H.push(function(j,G){var W=G.mx||F.symbol||0,Q=N.selectedSizeFn(G);j.attr("d",T(m.symbolNumber(W),Q)),G.mrc2=Q}),H.length&&D.each(function(j){for(var G=t.select(this),W=0;W<H.length;W++)H[W](G,j)})}},m.tryColorscale=function(D,B){var N=B?r.nestedProperty(D,B).get():D;if(N){var F=N.color;if((N.colorscale||N._colorAx)&&r.isArrayOrTypedArray(F))return o.makeColorScaleFuncFromTrace(N)}return r.identity};var b={start:1,end:-1,middle:0,bottom:1,top:-1};function _(D,B,N,F){var H=t.select(D.node().parentNode),j=B.indexOf("top")!==-1?"top":B.indexOf("bottom")!==-1?"bottom":"middle",G=B.indexOf("left")!==-1?"end":B.indexOf("right")!==-1?"start":"middle",W=F?F/.8+1:0,Q=(u.lineCount(D)-1)*a+1,$=b[G]*W,ee=.75*N+b[j]*W+(b[j]-1)*Q*N/2;D.attr("text-anchor",G),H.attr("transform",i($,ee))}function S(D,B){var N=D.ts||B.textfont.size;return h(N)&&N>0?N:0}m.textPointStyle=function(D,B,N){if(D.size()){var F;if(B.selectedpoints){var H=m.makeSelectedTextStyleFns(B);F=H.selectedTextColorFn}var j=B.texttemplate,G=N._fullLayout;D.each(function(W){var Q=t.select(this),$=j?r.extractOption(W,B,"txt","texttemplate"):r.extractOption(W,B,"tx","text");if($||$===0){if(j){var ee=B._module.formatLabels?B._module.formatLabels(W,B,G):{},ie={};d(ie,B,W.i);var ae=B._meta||{};$=r.texttemplateString($,ee,G._d3locale,ie,W,ae)}var oe=W.tp||B.textposition,de=S(W,B),le=F?F(W):W.tc||B.textfont.color;Q.call(m.font,W.tf||B.textfont.family,de,le).text($).call(u.convertToTspans,N).call(_,oe,de,W.mrc)}else Q.remove()})}},m.selectedTextStyle=function(D,B){if(D.size()&&B.selectedpoints){var N=m.makeSelectedTextStyleFns(B);D.each(function(F){var H=t.select(this),j=N.selectedTextColorFn(F),G=F.tp||B.textposition,W=S(F,B);e.fill(H,j),_(H,G,W,F.mrc2||F.mrc)})}};function C(D,B,N,F){var H=D[0]-B[0],j=D[1]-B[1],G=N[0]-B[0],W=N[1]-B[1],Q=Math.pow(H*H+j*j,.25),$=Math.pow(G*G+W*W,.25),ee=($*$*H-Q*Q*G)*F,ie=($*$*j-Q*Q*W)*F,ae=3*$*(Q+$),oe=3*Q*(Q+$);return[[t.round(B[0]+(ae&&ee/ae),2),t.round(B[1]+(ae&&ie/ae),2)],[t.round(B[0]-(oe&&ee/oe),2),t.round(B[1]-(oe&&ie/oe),2)]]}m.smoothopen=function(D,B){if(D.length<3)return"M"+D.join("L");var N,F="M"+D[0],H=[];for(N=1;N<D.length-1;N++)H.push(C(D[N-1],D[N],D[N+1],B));for(F+="Q"+H[0][0]+" "+D[1],N=2;N<D.length-1;N++)F+="C"+H[N-2][1]+" "+H[N-1][0]+" "+D[N];return F+="Q"+H[D.length-3][1]+" "+D[D.length-1]},m.smoothclosed=function(D,B){if(D.length<3)return"M"+D.join("L")+"Z";var N,F="M"+D[0],H=D.length-1,j=[C(D[H],D[0],D[1],B)];for(N=1;N<H;N++)j.push(C(D[N-1],D[N],D[N+1],B));for(j.push(C(D[H-1],D[H],D[0],B)),N=1;N<=H;N++)F+="C"+j[N-1][1]+" "+j[N][0]+" "+D[N];return F+="C"+j[H][1]+" "+j[0][0]+" "+D[0]+"Z"};var k={hv:function(D,B){return"H"+t.round(B[0],2)+"V"+t.round(B[1],2)},vh:function(D,B){return"V"+t.round(B[1],2)+"H"+t.round(B[0],2)},hvh:function(D,B){return"H"+t.round((D[0]+B[0])/2,2)+"V"+t.round(B[1],2)+"H"+t.round(B[0],2)},vhv:function(D,B){return"V"+t.round((D[1]+B[1])/2,2)+"H"+t.round(B[0],2)+"V"+t.round(B[1],2)}},L=function(D,B){return"L"+t.round(B[0],2)+","+t.round(B[1],2)};m.steps=function(D){var B=k[D]||L;return function(N){for(var F="M"+t.round(N[0][0],2)+","+t.round(N[0][1],2),H=1;H<N.length;H++)F+=B(N[H-1],N[H]);return F}},m.makeTester=function(){var D=r.ensureSingleById(t.select("body"),"svg","js-plotly-tester",function(N){N.attr(s.svgAttrs).style({position:"absolute",left:"-10000px",top:"-10000px",width:"9000px",height:"9000px","z-index":"1"})}),B=r.ensureSingle(D,"path","js-reference-point",function(N){N.attr("d","M0,0H1V1H0Z").style({"stroke-width":0,fill:"black"})});m.tester=D,m.testref=B},m.savedBBoxes={};var I=0;function R(D){var B=D.getAttribute("data-unformatted");if(B!==null)return B+D.getAttribute("data-math")+D.getAttribute("text-anchor")+D.getAttribute("style")}function V(D,B){if(!D)return null;var N=B._context;return"url('"+(N._exportedPlot?"":N._baseUrl||"")+"#"+D+"')"}m.bBox=function(D,B,N){var F,H,j;if(N||(N=R(D)),N){if(F=m.savedBBoxes[N])return r.extendFlat({},F)}else if(D.childNodes.length===1){var G=D.childNodes[0];if(N=R(G)){var W=+G.getAttribute("x")||0,Q=+G.getAttribute("y")||0,$=G.getAttribute("transform");if(!$){var ee=m.bBox(G,!1,N);return W&&(ee.left+=W,ee.right+=W),Q&&(ee.top+=Q,ee.bottom+=Q),ee}if(N+="~"+W+"~"+Q+"~"+$,F=m.savedBBoxes[N])return r.extendFlat({},F)}}B?H=D:(j=m.tester.node(),H=D.cloneNode(!0),j.appendChild(H)),t.select(H).attr("transform",null).call(u.positionText,0,0);var ie=H.getBoundingClientRect(),ae=m.testref.node().getBoundingClientRect();B||j.removeChild(H);var oe={height:ie.height,width:ie.width,left:ie.left-ae.left,top:ie.top-ae.top,right:ie.right-ae.left,bottom:ie.bottom-ae.top};return I>=1e4&&(m.savedBBoxes={},I=0),N&&(m.savedBBoxes[N]=oe),I++,r.extendFlat({},oe)},m.setClipUrl=function(D,B,N){D.attr("clip-path",V(B,N))},m.getTranslate=function(D){var B=(D[D.attr?"attr":"getAttribute"]("transform")||"").replace(/.*\btranslate\((-?\d*\.?\d*)[^-\d]*(-?\d*\.?\d*)[^\d].*/,function(N,F,H){return[F,H].join(" ")}).split(" ");return{x:+B[0]||0,y:+B[1]||0}},m.setTranslate=function(D,B,N){var F=D.attr?"attr":"getAttribute",H=D.attr?"attr":"setAttribute",j=D[F]("transform")||"";return B=B||0,N=N||0,j=j.replace(/(\btranslate\(.*?\);?)/,"").trim(),j=(j+=i(B,N)).trim(),D[H]("transform",j),j},m.getScale=function(D){var B=(D[D.attr?"attr":"getAttribute"]("transform")||"").replace(/.*\bscale\((\d*\.?\d*)[^\d]*(\d*\.?\d*)[^\d].*/,function(N,F,H){return[F,H].join(" ")}).split(" ");return{x:+B[0]||1,y:+B[1]||1}},m.setScale=function(D,B,N){var F=D.attr?"attr":"getAttribute",H=D.attr?"attr":"setAttribute",j=D[F]("transform")||"";return B=B||1,N=N||1,j=j.replace(/(\bscale\(.*?\);?)/,"").trim(),j=(j+="scale("+B+","+N+")").trim(),D[H]("transform",j),j};var O=/\s*sc.*/;m.setPointGroupScale=function(D,B,N){if(B=B||1,N=N||1,D){var F=B===1&&N===1?"":"scale("+B+","+N+")";D.each(function(){var H=(this.getAttribute("transform")||"").replace(O,"");H=(H+=F).trim(),this.setAttribute("transform",H)})}};var J=/translate\([^)]*\)\s*$/;m.setTextPointsScale=function(D,B,N){D&&D.each(function(){var F,H=t.select(this),j=H.select("text");if(j.node()){var G=parseFloat(j.attr("x")||0),W=parseFloat(j.attr("y")||0),Q=(H.attr("transform")||"").match(J);F=B===1&&N===1?[]:[i(G,W),"scale("+B+","+N+")",i(-G,-W)],Q&&F.push(Q),H.attr("transform",F.join(""))}})}},{"../../components/fx/helpers":679,"../../constants/alignment":745,"../../constants/interactions":752,"../../constants/xmlns_namespaces":754,"../../lib":778,"../../lib/svg_text_utils":803,"../../registry":911,"../../traces/scatter/make_bubble_size_func":1204,"../../traces/scatter/subtypes":1212,"../color":643,"../colorscale":655,"./symbol_defs":666,d3:169,"fast-isnumeric":241,tinycolor2:576}],666:[function(n,z,q){"use strict";var t=n("d3");z.exports={circle:{n:0,f:function(h){var p=t.round(h,2);return"M"+p+",0A"+p+","+p+" 0 1,1 0,-"+p+"A"+p+","+p+" 0 0,1 "+p+",0Z"}},square:{n:1,f:function(h){var p=t.round(h,2);return"M"+p+","+p+"H-"+p+"V-"+p+"H"+p+"Z"}},diamond:{n:2,f:function(h){var p=t.round(1.3*h,2);return"M"+p+",0L0,"+p+"L-"+p+",0L0,-"+p+"Z"}},cross:{n:3,f:function(h){var p=t.round(.4*h,2),l=t.round(1.2*h,2);return"M"+l+","+p+"H"+p+"V"+l+"H-"+p+"V"+p+"H-"+l+"V-"+p+"H-"+p+"V-"+l+"H"+p+"V-"+p+"H"+l+"Z"}},x:{n:4,f:function(h){var p=t.round(.8*h/Math.sqrt(2),2),l="l"+p+","+p,e="l"+p+",-"+p,o="l-"+p+",-"+p,r="l-"+p+","+p;return"M0,"+p+l+e+o+e+o+r+o+r+l+r+l+"Z"}},"triangle-up":{n:5,f:function(h){var p=t.round(2*h/Math.sqrt(3),2);return"M-"+p+","+t.round(h/2,2)+"H"+p+"L0,-"+t.round(h,2)+"Z"}},"triangle-down":{n:6,f:function(h){var p=t.round(2*h/Math.sqrt(3),2);return"M-"+p+",-"+t.round(h/2,2)+"H"+p+"L0,"+t.round(h,2)+"Z"}},"triangle-left":{n:7,f:function(h){var p=t.round(2*h/Math.sqrt(3),2);return"M"+t.round(h/2,2)+",-"+p+"V"+p+"L-"+t.round(h,2)+",0Z"}},"triangle-right":{n:8,f:function(h){var p=t.round(2*h/Math.sqrt(3),2);return"M-"+t.round(h/2,2)+",-"+p+"V"+p+"L"+t.round(h,2)+",0Z"}},"triangle-ne":{n:9,f:function(h){var p=t.round(.6*h,2),l=t.round(1.2*h,2);return"M-"+l+",-"+p+"H"+p+"V"+l+"Z"}},"triangle-se":{n:10,f:function(h){var p=t.round(.6*h,2),l=t.round(1.2*h,2);return"M"+p+",-"+l+"V"+p+"H-"+l+"Z"}},"triangle-sw":{n:11,f:function(h){var p=t.round(.6*h,2),l=t.round(1.2*h,2);return"M"+l+","+p+"H-"+p+"V-"+l+"Z"}},"triangle-nw":{n:12,f:function(h){var p=t.round(.6*h,2),l=t.round(1.2*h,2);return"M-"+p+","+l+"V-"+p+"H"+l+"Z"}},pentagon:{n:13,f:function(h){var p=t.round(.951*h,2),l=t.round(.588*h,2),e=t.round(-h,2),o=t.round(-.309*h,2);return"M"+p+","+o+"L"+l+","+t.round(.809*h,2)+"H-"+l+"L-"+p+","+o+"L0,"+e+"Z"}},hexagon:{n:14,f:function(h){var p=t.round(h,2),l=t.round(h/2,2),e=t.round(h*Math.sqrt(3)/2,2);return"M"+e+",-"+l+"V"+l+"L0,"+p+"L-"+e+","+l+"V-"+l+"L0,-"+p+"Z"}},hexagon2:{n:15,f:function(h){var p=t.round(h,2),l=t.round(h/2,2),e=t.round(h*Math.sqrt(3)/2,2);return"M-"+l+","+e+"H"+l+"L"+p+",0L"+l+",-"+e+"H-"+l+"L-"+p+",0Z"}},octagon:{n:16,f:function(h){var p=t.round(.924*h,2),l=t.round(.383*h,2);return"M-"+l+",-"+p+"H"+l+"L"+p+",-"+l+"V"+l+"L"+l+","+p+"H-"+l+"L-"+p+","+l+"V-"+l+"Z"}},star:{n:17,f:function(h){var p=1.4*h,l=t.round(.225*p,2),e=t.round(.951*p,2),o=t.round(.363*p,2),r=t.round(.588*p,2),i=t.round(-p,2),u=t.round(-.309*p,2),s=t.round(.118*p,2),a=t.round(.809*p,2);return"M"+l+","+u+"H"+e+"L"+o+","+s+"L"+r+","+a+"L0,"+t.round(.382*p,2)+"L-"+r+","+a+"L-"+o+","+s+"L-"+e+","+u+"H-"+l+"L0,"+i+"Z"}},hexagram:{n:18,f:function(h){var p=t.round(.66*h,2),l=t.round(.38*h,2),e=t.round(.76*h,2);return"M-"+e+",0l-"+l+",-"+p+"h"+e+"l"+l+",-"+p+"l"+l+","+p+"h"+e+"l-"+l+","+p+"l"+l+","+p+"h-"+e+"l-"+l+","+p+"l-"+l+",-"+p+"h-"+e+"Z"}},"star-triangle-up":{n:19,f:function(h){var p=t.round(h*Math.sqrt(3)*.8,2),l=t.round(.8*h,2),e=t.round(1.6*h,2),o=t.round(4*h,2),r="A "+o+","+o+" 0 0 1 ";return"M-"+p+","+l+r+p+","+l+r+"0,-"+e+r+"-"+p+","+l+"Z"}},"star-triangle-down":{n:20,f:function(h){var p=t.round(h*Math.sqrt(3)*.8,2),l=t.round(.8*h,2),e=t.round(1.6*h,2),o=t.round(4*h,2),r="A "+o+","+o+" 0 0 1 ";return"M"+p+",-"+l+r+"-"+p+",-"+l+r+"0,"+e+r+p+",-"+l+"Z"}},"star-square":{n:21,f:function(h){var p=t.round(1.1*h,2),l=t.round(2*h,2),e="A "+l+","+l+" 0 0 1 ";return"M-"+p+",-"+p+e+"-"+p+","+p+e+p+","+p+e+p+",-"+p+e+"-"+p+",-"+p+"Z"}},"star-diamond":{n:22,f:function(h){var p=t.round(1.4*h,2),l=t.round(1.9*h,2),e="A "+l+","+l+" 0 0 1 ";return"M-"+p+",0"+e+"0,"+p+e+p+",0"+e+"0,-"+p+e+"-"+p+",0Z"}},"diamond-tall":{n:23,f:function(h){var p=t.round(.7*h,2),l=t.round(1.4*h,2);return"M0,"+l+"L"+p+",0L0,-"+l+"L-"+p+",0Z"}},"diamond-wide":{n:24,f:function(h){var p=t.round(1.4*h,2),l=t.round(.7*h,2);return"M0,"+l+"L"+p+",0L0,-"+l+"L-"+p+",0Z"}},hourglass:{n:25,f:function(h){var p=t.round(h,2);return"M"+p+","+p+"H-"+p+"L"+p+",-"+p+"H-"+p+"Z"},noDot:!0},bowtie:{n:26,f:function(h){var p=t.round(h,2);return"M"+p+","+p+"V-"+p+"L-"+p+","+p+"V-"+p+"Z"},noDot:!0},"circle-cross":{n:27,f:function(h){var p=t.round(h,2);return"M0,"+p+"V-"+p+"M"+p+",0H-"+p+"M"+p+",0A"+p+","+p+" 0 1,1 0,-"+p+"A"+p+","+p+" 0 0,1 "+p+",0Z"},needLine:!0,noDot:!0},"circle-x":{n:28,f:function(h){var p=t.round(h,2),l=t.round(h/Math.sqrt(2),2);return"M"+l+","+l+"L-"+l+",-"+l+"M"+l+",-"+l+"L-"+l+","+l+"M"+p+",0A"+p+","+p+" 0 1,1 0,-"+p+"A"+p+","+p+" 0 0,1 "+p+",0Z"},needLine:!0,noDot:!0},"square-cross":{n:29,f:function(h){var p=t.round(h,2);return"M0,"+p+"V-"+p+"M"+p+",0H-"+p+"M"+p+","+p+"H-"+p+"V-"+p+"H"+p+"Z"},needLine:!0,noDot:!0},"square-x":{n:30,f:function(h){var p=t.round(h,2);return"M"+p+","+p+"L-"+p+",-"+p+"M"+p+",-"+p+"L-"+p+","+p+"M"+p+","+p+"H-"+p+"V-"+p+"H"+p+"Z"},needLine:!0,noDot:!0},"diamond-cross":{n:31,f:function(h){var p=t.round(1.3*h,2);return"M"+p+",0L0,"+p+"L-"+p+",0L0,-"+p+"ZM0,-"+p+"V"+p+"M-"+p+",0H"+p},needLine:!0,noDot:!0},"diamond-x":{n:32,f:function(h){var p=t.round(1.3*h,2),l=t.round(.65*h,2);return"M"+p+",0L0,"+p+"L-"+p+",0L0,-"+p+"ZM-"+l+",-"+l+"L"+l+","+l+"M-"+l+","+l+"L"+l+",-"+l},needLine:!0,noDot:!0},"cross-thin":{n:33,f:function(h){var p=t.round(1.4*h,2);return"M0,"+p+"V-"+p+"M"+p+",0H-"+p},needLine:!0,noDot:!0,noFill:!0},"x-thin":{n:34,f:function(h){var p=t.round(h,2);return"M"+p+","+p+"L-"+p+",-"+p+"M"+p+",-"+p+"L-"+p+","+p},needLine:!0,noDot:!0,noFill:!0},asterisk:{n:35,f:function(h){var p=t.round(1.2*h,2),l=t.round(.85*h,2);return"M0,"+p+"V-"+p+"M"+p+",0H-"+p+"M"+l+","+l+"L-"+l+",-"+l+"M"+l+",-"+l+"L-"+l+","+l},needLine:!0,noDot:!0,noFill:!0},hash:{n:36,f:function(h){var p=t.round(h/2,2),l=t.round(h,2);return"M"+p+","+l+"V-"+l+"m-"+l+",0V"+l+"M"+l+","+p+"H-"+l+"m0,-"+l+"H"+l},needLine:!0,noFill:!0},"y-up":{n:37,f:function(h){var p=t.round(1.2*h,2),l=t.round(1.6*h,2),e=t.round(.8*h,2);return"M-"+p+","+e+"L0,0M"+p+","+e+"L0,0M0,-"+l+"L0,0"},needLine:!0,noDot:!0,noFill:!0},"y-down":{n:38,f:function(h){var p=t.round(1.2*h,2),l=t.round(1.6*h,2),e=t.round(.8*h,2);return"M-"+p+",-"+e+"L0,0M"+p+",-"+e+"L0,0M0,"+l+"L0,0"},needLine:!0,noDot:!0,noFill:!0},"y-left":{n:39,f:function(h){var p=t.round(1.2*h,2),l=t.round(1.6*h,2),e=t.round(.8*h,2);return"M"+e+","+p+"L0,0M"+e+",-"+p+"L0,0M-"+l+",0L0,0"},needLine:!0,noDot:!0,noFill:!0},"y-right":{n:40,f:function(h){var p=t.round(1.2*h,2),l=t.round(1.6*h,2),e=t.round(.8*h,2);return"M-"+e+","+p+"L0,0M-"+e+",-"+p+"L0,0M"+l+",0L0,0"},needLine:!0,noDot:!0,noFill:!0},"line-ew":{n:41,f:function(h){var p=t.round(1.4*h,2);return"M"+p+",0H-"+p},needLine:!0,noDot:!0,noFill:!0},"line-ns":{n:42,f:function(h){var p=t.round(1.4*h,2);return"M0,"+p+"V-"+p},needLine:!0,noDot:!0,noFill:!0},"line-ne":{n:43,f:function(h){var p=t.round(h,2);return"M"+p+",-"+p+"L-"+p+","+p},needLine:!0,noDot:!0,noFill:!0},"line-nw":{n:44,f:function(h){var p=t.round(h,2);return"M"+p+","+p+"L-"+p+",-"+p},needLine:!0,noDot:!0,noFill:!0},"arrow-up":{n:45,f:function(h){var p=t.round(h,2);return"M0,0L-"+p+","+t.round(2*h,2)+"H"+p+"Z"},noDot:!0},"arrow-down":{n:46,f:function(h){var p=t.round(h,2);return"M0,0L-"+p+",-"+t.round(2*h,2)+"H"+p+"Z"},noDot:!0},"arrow-left":{n:47,f:function(h){var p=t.round(2*h,2),l=t.round(h,2);return"M0,0L"+p+",-"+l+"V"+l+"Z"},noDot:!0},"arrow-right":{n:48,f:function(h){var p=t.round(2*h,2),l=t.round(h,2);return"M0,0L-"+p+",-"+l+"V"+l+"Z"},noDot:!0},"arrow-bar-up":{n:49,f:function(h){var p=t.round(h,2);return"M-"+p+",0H"+p+"M0,0L-"+p+","+t.round(2*h,2)+"H"+p+"Z"},needLine:!0,noDot:!0},"arrow-bar-down":{n:50,f:function(h){var p=t.round(h,2);return"M-"+p+",0H"+p+"M0,0L-"+p+",-"+t.round(2*h,2)+"H"+p+"Z"},needLine:!0,noDot:!0},"arrow-bar-left":{n:51,f:function(h){var p=t.round(2*h,2),l=t.round(h,2);return"M0,-"+l+"V"+l+"M0,0L"+p+",-"+l+"V"+l+"Z"},needLine:!0,noDot:!0},"arrow-bar-right":{n:52,f:function(h){var p=t.round(2*h,2),l=t.round(h,2);return"M0,-"+l+"V"+l+"M0,0L-"+p+",-"+l+"V"+l+"Z"},needLine:!0,noDot:!0}}},{d3:169}],667:[function(n,z,q){"use strict";z.exports={visible:{valType:"boolean",editType:"calc"},type:{valType:"enumerated",values:["percent","constant","sqrt","data"],editType:"calc"},symmetric:{valType:"boolean",editType:"calc"},array:{valType:"data_array",editType:"calc"},arrayminus:{valType:"data_array",editType:"calc"},value:{valType:"number",min:0,dflt:10,editType:"calc"},valueminus:{valType:"number",min:0,dflt:10,editType:"calc"},traceref:{valType:"integer",min:0,dflt:0,editType:"style"},tracerefminus:{valType:"integer",min:0,dflt:0,editType:"style"},copy_ystyle:{valType:"boolean",editType:"plot"},copy_zstyle:{valType:"boolean",editType:"style"},color:{valType:"color",editType:"style"},thickness:{valType:"number",min:0,dflt:2,editType:"style"},width:{valType:"number",min:0,editType:"plot"},editType:"calc",_deprecated:{opacity:{valType:"number",editType:"style"}}}},{}],668:[function(n,z,q){"use strict";var t=n("fast-isnumeric"),h=n("../../registry"),p=n("../../plots/cartesian/axes"),l=n("../../lib"),e=n("./compute_error");function o(r,i,u,s){var a=i["error_"+s]||{},c=[];if(a.visible&&["linear","log"].indexOf(u.type)!==-1){for(var f=e(a),g=0;g<r.length;g++){var d=r[g],m=d.i;if(m===void 0)m=g;else if(m===null)continue;var y=d[s];if(t(u.c2l(y))){var v=f(y,m);if(t(v[0])&&t(v[1])){var T=d[s+"s"]=y-v[0],w=d[s+"h"]=y+v[1];c.push(T,w)}}}var A=u._id,E=i._extremes[A],M=p.findExtremes(u,c,l.extendFlat({tozero:E.opts.tozero},{padded:!0}));E.min=E.min.concat(M.min),E.max=E.max.concat(M.max)}}z.exports=function(r){for(var i=r.calcdata,u=0;u<i.length;u++){var s=i[u],a=s[0].trace;if(a.visible===!0&&h.traceIs(a,"errorBarsOK")){var c=p.getFromId(r,a.xaxis),f=p.getFromId(r,a.yaxis);o(s,a,c,"x"),o(s,a,f,"y")}}}},{"../../lib":778,"../../plots/cartesian/axes":828,"../../registry":911,"./compute_error":669,"fast-isnumeric":241}],669:[function(n,z,q){"use strict";function t(h,p){return h==="percent"?function(l){return Math.abs(l*p/100)}:h==="constant"?function(){return Math.abs(p)}:h==="sqrt"?function(l){return Math.sqrt(Math.abs(l))}:void 0}z.exports=function(h){var p=h.type,l=h.symmetric;if(p==="data"){var e=h.array||[];if(l)return function(u,s){var a=+e[s];return[a,a]};var o=h.arrayminus||[];return function(u,s){var a=+e[s],c=+o[s];return isNaN(a)&&isNaN(c)?[NaN,NaN]:[c||0,a||0]}}var r=t(p,h.value),i=t(p,h.valueminus);return l||h.valueminus===void 0?function(u){var s=r(u);return[s,s]}:function(u){return[i(u),r(u)]}}},{}],670:[function(n,z,q){"use strict";var t=n("fast-isnumeric"),h=n("../../registry"),p=n("../../lib"),l=n("../../plot_api/plot_template"),e=n("./attributes");z.exports=function(o,r,i,u){var s="error_"+u.axis,a=l.newContainer(r,s),c=o[s]||{};function f(y,v){return p.coerce(c,a,e,y,v)}if(f("visible",c.array!==void 0||c.value!==void 0||c.type==="sqrt")!==!1){var g=f("type","array"in c?"data":"percent"),d=!0;g!=="sqrt"&&(d=f("symmetric",!((g==="data"?"arrayminus":"valueminus")in c))),g==="data"?(f("array"),f("traceref"),d||(f("arrayminus"),f("tracerefminus"))):g!=="percent"&&g!=="constant"||(f("value"),d||f("valueminus"));var m="copy_"+u.inherit+"style";u.inherit&&(r["error_"+u.inherit]||{}).visible&&f(m,!(c.color||t(c.thickness)||t(c.width))),u.inherit&&a[m]||(f("color",i),f("thickness"),f("width",h.traceIs(r,"gl3d")?0:4))}}},{"../../lib":778,"../../plot_api/plot_template":817,"../../registry":911,"./attributes":667,"fast-isnumeric":241}],671:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../../plot_api/edit_types").overrideAll,p=n("./attributes"),l={error_x:t.extendFlat({},p),error_y:t.extendFlat({},p)};delete l.error_x.copy_zstyle,delete l.error_y.copy_zstyle,delete l.error_y.copy_ystyle;var e={error_x:t.extendFlat({},p),error_y:t.extendFlat({},p),error_z:t.extendFlat({},p)};delete e.error_x.copy_ystyle,delete e.error_y.copy_ystyle,delete e.error_z.copy_ystyle,delete e.error_z.copy_zstyle,z.exports={moduleType:"component",name:"errorbars",schema:{traces:{scatter:l,bar:l,histogram:l,scatter3d:h(e,"calc","nested"),scattergl:h(l,"calc","nested")}},supplyDefaults:n("./defaults"),calc:n("./calc"),makeComputeError:n("./compute_error"),plot:n("./plot"),style:n("./style"),hoverInfo:function(o,r,i){(r.error_y||{}).visible&&(i.yerr=o.yh-o.y,r.error_y.symmetric||(i.yerrneg=o.y-o.ys)),(r.error_x||{}).visible&&(i.xerr=o.xh-o.x,r.error_x.symmetric||(i.xerrneg=o.x-o.xs))}}},{"../../lib":778,"../../plot_api/edit_types":810,"./attributes":667,"./calc":668,"./compute_error":669,"./defaults":670,"./plot":672,"./style":673}],672:[function(n,z,q){"use strict";var t=n("d3"),h=n("fast-isnumeric"),p=n("../drawing"),l=n("../../traces/scatter/subtypes");z.exports=function(e,o,r,i){var u=r.xaxis,s=r.yaxis,a=i&&i.duration>0;o.each(function(c){var f,g=c[0].trace,d=g.error_x||{},m=g.error_y||{};g.ids&&(f=function(w){return w.id});var y=l.hasMarkers(g)&&g.marker.maxdisplayed>0;m.visible||d.visible||(c=[]);var v=t.select(this).selectAll("g.errorbar").data(c,f);if(v.exit().remove(),c.length){d.visible||v.selectAll("path.xerror").remove(),m.visible||v.selectAll("path.yerror").remove(),v.style("opacity",1);var T=v.enter().append("g").classed("errorbar",!0);a&&T.style("opacity",0).transition().duration(i.duration).style("opacity",1),p.setClipUrl(v,r.layerClipId,e),v.each(function(w){var A=t.select(this),E=function(k,L,I){var R={x:L.c2p(k.x),y:I.c2p(k.y)};return k.yh!==void 0&&(R.yh=I.c2p(k.yh),R.ys=I.c2p(k.ys),h(R.ys)||(R.noYS=!0,R.ys=I.c2p(k.ys,!0))),k.xh!==void 0&&(R.xh=L.c2p(k.xh),R.xs=L.c2p(k.xs),h(R.xs)||(R.noXS=!0,R.xs=L.c2p(k.xs,!0))),R}(w,u,s);if(!y||w.vis){var M,b=A.select("path.yerror");if(m.visible&&h(E.x)&&h(E.yh)&&h(E.ys)){var _=m.width;M="M"+(E.x-_)+","+E.yh+"h"+2*_+"m-"+_+",0V"+E.ys,E.noYS||(M+="m-"+_+",0h"+2*_),b.size()?a&&(b=b.transition().duration(i.duration).ease(i.easing)):b=A.append("path").style("vector-effect","non-scaling-stroke").classed("yerror",!0),b.attr("d",M)}else b.remove();var S=A.select("path.xerror");if(d.visible&&h(E.y)&&h(E.xh)&&h(E.xs)){var C=(d.copy_ystyle?m:d).width;M="M"+E.xh+","+(E.y-C)+"v"+2*C+"m0,-"+C+"H"+E.xs,E.noXS||(M+="m0,-"+C+"v"+2*C),S.size()?a&&(S=S.transition().duration(i.duration).ease(i.easing)):S=A.append("path").style("vector-effect","non-scaling-stroke").classed("xerror",!0),S.attr("d",M)}else S.remove()}})}})}},{"../../traces/scatter/subtypes":1212,"../drawing":665,d3:169,"fast-isnumeric":241}],673:[function(n,z,q){"use strict";var t=n("d3"),h=n("../color");z.exports=function(p){p.each(function(l){var e=l[0].trace,o=e.error_y||{},r=e.error_x||{},i=t.select(this);i.selectAll("path.yerror").style("stroke-width",o.thickness+"px").call(h.stroke,o.color),r.copy_ystyle&&(r=o),i.selectAll("path.xerror").style("stroke-width",r.thickness+"px").call(h.stroke,r.color)})}},{"../color":643,d3:169}],674:[function(n,z,q){"use strict";var t=n("../../plots/font_attributes"),h=n("./layout_attributes").hoverlabel,p=n("../../lib/extend").extendFlat;z.exports={hoverlabel:{bgcolor:p({},h.bgcolor,{arrayOk:!0}),bordercolor:p({},h.bordercolor,{arrayOk:!0}),font:t({arrayOk:!0,editType:"none"}),align:p({},h.align,{arrayOk:!0}),namelength:p({},h.namelength,{arrayOk:!0}),editType:"none"}}},{"../../lib/extend":768,"../../plots/font_attributes":856,"./layout_attributes":684}],675:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../../registry");function p(l,e,o,r){r=r||t.identity,Array.isArray(l)&&(e[0][o]=r(l))}z.exports=function(l){var e=l.calcdata,o=l._fullLayout;function r(c){return function(f){return t.coerceHoverinfo({hoverinfo:f},{_module:c._module},o)}}for(var i=0;i<e.length;i++){var u=e[i],s=u[0].trace;if(!h.traceIs(s,"pie-like")){var a=h.traceIs(s,"2dMap")?p:t.fillArray;a(s.hoverinfo,u,"hi",r(s)),s.hovertemplate&&a(s.hovertemplate,u,"ht"),s.hoverlabel&&(a(s.hoverlabel.bgcolor,u,"hbg"),a(s.hoverlabel.bordercolor,u,"hbc"),a(s.hoverlabel.font.size,u,"hts"),a(s.hoverlabel.font.color,u,"htc"),a(s.hoverlabel.font.family,u,"htf"),a(s.hoverlabel.namelength,u,"hnl"),a(s.hoverlabel.align,u,"hta"))}}}},{"../../lib":778,"../../registry":911}],676:[function(n,z,q){"use strict";var t=n("../../registry"),h=n("./hover").hover;z.exports=function(p,l,e){var o=t.getComponentMethod("annotations","onClick")(p,p._hoverdata);function r(){p.emit("plotly_click",{points:p._hoverdata,event:l})}e!==void 0&&h(p,l,e,!0),p._hoverdata&&l&&l.target&&(o&&o.then?o.then(r):r(),l.stopImmediatePropagation&&l.stopImmediatePropagation())}},{"../../registry":911,"./hover":680}],677:[function(n,z,q){"use strict";z.exports={YANGLE:60,HOVERARROWSIZE:6,HOVERTEXTPAD:3,HOVERFONTSIZE:13,HOVERFONT:"Arial, sans-serif",HOVERMINTIME:50,HOVERID:"-hover"}},{}],678:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("./attributes"),p=n("./hoverlabel_defaults");z.exports=function(l,e,o,r){var i=t.extendFlat({},r.hoverlabel);e.hovertemplate&&(i.namelength=-1),p(l,e,function(u,s){return t.coerce(l,e,h,u,s)},i)}},{"../../lib":778,"./attributes":674,"./hoverlabel_defaults":681}],679:[function(n,z,q){"use strict";var t=n("../../lib");q.getSubplot=function(r){return r.subplot||r.xaxis+r.yaxis||r.geo},q.isTraceInSubplots=function(r,i){if(r.type==="splom"){for(var u=r.xaxes||[],s=r.yaxes||[],a=0;a<u.length;a++)for(var c=0;c<s.length;c++)if(i.indexOf(u[a]+s[c])!==-1)return!0;return!1}return i.indexOf(q.getSubplot(r))!==-1},q.flat=function(r,i){for(var u=new Array(r.length),s=0;s<r.length;s++)u[s]=i;return u},q.p2c=function(r,i){for(var u=new Array(r.length),s=0;s<r.length;s++)u[s]=r[s].p2c(i);return u},q.getDistanceFunction=function(r,i,u,s){return r==="closest"?s||q.quadrature(i,u):r.charAt(0)==="x"?i:u},q.getClosest=function(r,i,u){if(u.index!==!1)u.index>=0&&u.index<r.length?u.distance=0:u.index=!1;else for(var s=0;s<r.length;s++){var a=i(r[s]);a<=u.distance&&(u.index=s,u.distance=a)}return u},q.inbox=function(r,i,u){return r*i<0||r===0?u:1/0},q.quadrature=function(r,i){return function(u){var s=r(u),a=i(u);return Math.sqrt(s*s+a*a)}},q.makeEventData=function(r,i,u){var s="index"in r?r.index:r.pointNumber,a={data:i._input,fullData:i,curveNumber:i.index,pointNumber:s};if(i._indexToPoints){var c=i._indexToPoints[s];c.length===1?a.pointIndex=c[0]:a.pointIndices=c}else a.pointIndex=s;return i._module.eventData?a=i._module.eventData(a,r,i,u,s):("xVal"in r?a.x=r.xVal:"x"in r&&(a.x=r.x),"yVal"in r?a.y=r.yVal:"y"in r&&(a.y=r.y),r.xa&&(a.xaxis=r.xa),r.ya&&(a.yaxis=r.ya),r.zLabelVal!==void 0&&(a.z=r.zLabelVal)),q.appendArrayPointValue(a,i,s),a},q.appendArrayPointValue=function(r,i,u){var s=i._arrayAttrs;if(s)for(var a=0;a<s.length;a++){var c=s[a],f=p(c);if(r[f]===void 0){var g=l(t.nestedProperty(i,c).get(),u);g!==void 0&&(r[f]=g)}}},q.appendArrayMultiPointValues=function(r,i,u){var s=i._arrayAttrs;if(s)for(var a=0;a<s.length;a++){var c=s[a],f=p(c);if(r[f]===void 0){for(var g=t.nestedProperty(i,c).get(),d=new Array(u.length),m=0;m<u.length;m++)d[m]=l(g,u[m]);r[f]=d}}};var h={ids:"id",locations:"location",labels:"label",values:"value","marker.colors":"color",parents:"parent"};function p(r){return h[r]||r}function l(r,i){return Array.isArray(i)?Array.isArray(r)&&Array.isArray(r[i[0]])?r[i[0]][i[1]]:void 0:r[i]}var e={x:!0,y:!0},o={"x unified":!0,"y unified":!0};q.isUnifiedHover=function(r){return typeof r=="string"&&!!o[r]},q.isXYhover=function(r){return typeof r=="string"&&!!e[r]}},{"../../lib":778}],680:[function(n,z,q){"use strict";var t=n("d3"),h=n("fast-isnumeric"),p=n("tinycolor2"),l=n("../../lib"),e=l.strTranslate,o=l.strRotate,r=n("../../lib/events"),i=n("../../lib/svg_text_utils"),u=n("../../lib/override_cursor"),s=n("../drawing"),a=n("../color"),c=n("../dragelement"),f=n("../../plots/cartesian/axes"),g=n("../../registry"),d=n("./helpers"),m=n("./constants"),y=n("../legend/defaults"),v=n("../legend/draw"),T=m.YANGLE,w=Math.PI*T/180,A=1/Math.sin(w),E=Math.cos(w),M=Math.sin(w),b=m.HOVERARROWSIZE,_=m.HOVERTEXTPAD;function S(D){return[D.trace.index,D.index,D.x0,D.y0,D.name,D.attr,D.xa,D.ya||""].join(",")}q.hover=function(D,B,N,F){D=l.getGraphDiv(D),l.throttle(D._fullLayout._uid+m.HOVERID,m.HOVERMINTIME,function(){(function(H,j,G,W){G||(G="xy");var Q=Array.isArray(G)?G:[G],$=H._fullLayout,ee=$._plots||[],ie=ee[G],ae=$._has("cartesian");if(ie){var oe=ie.overlays.map(function(er){return er.id});Q=Q.concat(oe)}for(var de=Q.length,le=new Array(de),fe=new Array(de),ue=!1,we=0;we<de;we++){var Ae=Q[we];if(ee[Ae])ue=!0,le[we]=ee[Ae].xaxis,fe[we]=ee[Ae].yaxis;else{if(!$[Ae]||!$[Ae]._subplot)return void l.warn("Unrecognized subplot: "+Ae);var Se=$[Ae]._subplot;le[we]=Se.xaxis,fe[we]=Se.yaxis}}var ke=j.hovermode||$.hovermode;if(ke&&!ue&&(ke="closest"),["x","y","closest","x unified","y unified"].indexOf(ke)===-1||!H.calcdata||H.querySelector(".zoombox")||H._dragging)return c.unhoverRaw(H,j);var Me,ve,ge,De,_e,Pe,Fe,ze,He,et,Re,Ze,Ke,$e=$.hoverdistance===-1?1/0:$.hoverdistance,rt=$.spikedistance===-1?1/0:$.spikedistance,at=[],lt=[],gt={hLinePoint:null,vLinePoint:null},Ie=!1;if(Array.isArray(j))for(ke="array",ge=0;ge<j.length;ge++)(_e=H.calcdata[j[ge].curveNumber||0])&&(Pe=_e[0].trace,_e[0].trace.hoverinfo!=="skip"&&(lt.push(_e),Pe.orientation==="h"&&(Ie=!0)));else{for(De=0;De<H.calcdata.length;De++)_e=H.calcdata[De],(Pe=_e[0].trace).hoverinfo!=="skip"&&d.isTraceInSubplots(Pe,Q)&&(lt.push(_e),Pe.orientation==="h"&&(Ie=!0));var be,We;if(!j.target)be="xpx"in j?j.xpx:le[0]._length/2,We="ypx"in j?j.ypx:fe[0]._length/2;else{if(r.triggerHandler(H,"plotly_beforehover",j)===!1)return;var Ge=j.target.getBoundingClientRect();be=j.clientX-Ge.left,We=j.clientY-Ge.top,$._calcInverseTransform(H);var st=l.apply3DTransform($._invTransform)(be,We);if(be=st[0],We=st[1],be<0||be>le[0]._length||We<0||We>fe[0]._length)return c.unhoverRaw(H,j)}if(j.pointerX=be+le[0]._offset,j.pointerY=We+fe[0]._offset,Me="xval"in j?d.flat(Q,j.xval):d.p2c(le,be),ve="yval"in j?d.flat(Q,j.yval):d.p2c(fe,We),!h(Me[0])||!h(ve[0]))return l.warn("Fx.hover failed",j,H),c.unhoverRaw(H,j)}var ot=1/0;function Ce(er,or){for(De=0;De<lt.length;De++)if((_e=lt[De])&&_e[0]&&_e[0].trace&&(Pe=_e[0].trace).visible===!0&&Pe._length!==0&&["carpet","contourcarpet"].indexOf(Pe._module.name)===-1){if(Pe.type==="splom"?Fe=Q[ze=0]:(Fe=d.getSubplot(Pe),ze=Q.indexOf(Fe)),He=ke,d.isUnifiedHover(He)&&(He=He.charAt(0)),Ze={cd:_e,trace:Pe,xa:le[ze],ya:fe[ze],maxHoverDistance:$e,maxSpikeDistance:rt,index:!1,distance:Math.min(ot,$e),spikeDistance:1/0,xSpike:void 0,ySpike:void 0,color:a.defaultLine,name:Pe.name,x0:void 0,x1:void 0,y0:void 0,y1:void 0,xLabelVal:void 0,yLabelVal:void 0,zLabelVal:void 0,text:void 0},$[Fe]&&(Ze.subplot=$[Fe]._subplot),$._splomScenes&&$._splomScenes[Pe.uid]&&(Ze.scene=$._splomScenes[Pe.uid]),Ke=at.length,He==="array"){var zt=j[De];"pointNumber"in zt?(Ze.index=zt.pointNumber,He="closest"):(He="","xval"in zt&&(et=zt.xval,He="x"),"yval"in zt&&(Re=zt.yval,He=He?"closest":"y"))}else er!==void 0&&or!==void 0?(et=er,Re=or):(et=Me[ze],Re=ve[ze]);if($e!==0)if(Pe._module&&Pe._module.hoverPoints){var Qt=Pe._module.hoverPoints(Ze,et,Re,He,$._hoverlayer);if(Qt)for(var cr,Dt=0;Dt<Qt.length;Dt++)cr=Qt[Dt],h(cr.x0)&&h(cr.y0)&&at.push(R(cr,ke))}else l.log("Unrecognized trace type in hover:",Pe);if(ke==="closest"&&at.length>Ke&&(at.splice(0,Ke),ot=at[0].distance),ae&&rt!==0&&at.length===0){Ze.distance=rt,Ze.index=!1;var Ut=Pe._module.hoverPoints(Ze,et,Re,"closest",$._hoverlayer);if(Ut&&(Ut=Ut.filter(function(Ir){return Ir.spikeDistance<=rt})),Ut&&Ut.length){var ur,Sr=Ut.filter(function(Ir){return Ir.xa.showspikes&&Ir.xa.spikesnap!=="hovered data"});if(Sr.length){var Lr=Sr[0];h(Lr.x0)&&h(Lr.y0)&&(ur=Ye(Lr),(!gt.vLinePoint||gt.vLinePoint.spikeDistance>ur.spikeDistance)&&(gt.vLinePoint=ur))}var Hr=Ut.filter(function(Ir){return Ir.ya.showspikes&&Ir.ya.spikesnap!=="hovered data"});if(Hr.length){var Kr=Hr[0];h(Kr.x0)&&h(Kr.y0)&&(ur=Ye(Kr),(!gt.hLinePoint||gt.hLinePoint.spikeDistance>ur.spikeDistance)&&(gt.hLinePoint=ur))}}}}}function Ue(er,or){for(var zt,Qt=null,cr=1/0,Dt=0;Dt<er.length;Dt++)(zt=er[Dt].spikeDistance)<=cr&&zt<=or&&(Qt=er[Dt],cr=zt);return Qt}function Ye(er){return er?{xa:er.xa,ya:er.ya,x:er.xSpike!==void 0?er.xSpike:(er.x0+er.x1)/2,y:er.ySpike!==void 0?er.ySpike:(er.y0+er.y1)/2,distance:er.distance,spikeDistance:er.spikeDistance,curveNumber:er.trace.index,color:er.color,pointNumber:er.index}:null}Ce();var xe={fullLayout:$,container:$._hoverlayer,outerContainer:$._paperdiv,event:j},Ee=H._spikepoints,Je={vLinePoint:gt.vLinePoint,hLinePoint:gt.hLinePoint};if(H._spikepoints=Je,ae&&rt!==0&&at.length!==0){var it=Ue(at.filter(function(er){return er.ya.showspikes}),rt);gt.hLinePoint=Ye(it);var ht=Ue(at.filter(function(er){return er.xa.showspikes}),rt);gt.vLinePoint=Ye(ht)}if(at.length===0){var ct=c.unhoverRaw(H,j);return!ae||gt.hLinePoint===null&&gt.vLinePoint===null||O(Ee)&&V(H,gt,xe),ct}if(ae&&O(Ee)&&V(H,gt,xe),at.sort(function(er,or){return er.distance-or.distance}),d.isXYhover(He)&&at[0].length!==0&&at[0].trace.type!=="splom"){var mt=at[0],bt=mt.cd[mt.index],Et=$.boxmode==="group"||$.violinmode==="group",Mt=mt.xVal,_t=mt.xa;_t.type==="category"&&(Mt=_t._categoriesMap[Mt]),_t.type==="date"&&(Mt=_t.d2c(Mt)),bt&&bt.t&&bt.t.posLetter===_t._id&&Et&&(Mt+=bt.t.dPos);var xt=mt.yVal;(_t=mt.ya).type==="category"&&(xt=_t._categoriesMap[xt]),_t.type==="date"&&(xt=_t.d2c(xt)),bt&&bt.t&&bt.t.posLetter===_t._id&&Et&&(xt+=bt.t.dPos),Ce(Mt,xt);var At={};at=at.filter(function(er){var or=S(er);if(!At[or])return At[or]=!0,At[or]})}var It=H._hoverdata,Nt=[];for(ge=0;ge<at.length;ge++){var Ot=at[ge],Yt=d.makeEventData(Ot,Ot.trace,Ot.cd);if(Ot.hovertemplate!==!1){var Pt=!1;Ot.cd[Ot.index]&&Ot.cd[Ot.index].ht&&(Pt=Ot.cd[Ot.index].ht),Ot.hovertemplate=Pt||Ot.trace.hovertemplate||!1}Ot.eventData=[Yt],Nt.push(Yt)}H._hoverdata=Nt;var Ne=ke==="y"&&(lt.length>1||at.length>1)||ke==="closest"&&Ie&&at.length>1,ut=a.combine($.plot_bgcolor||a.background,$.paper_bgcolor),wt={hovermode:ke,rotateLabels:Ne,bgColor:ut,container:$._hoverlayer,outerContainer:$._paperdiv,commonLabelOpts:$.hoverlabel,hoverdistance:$.hoverdistance},Bt=k(at,wt,H);if(d.isUnifiedHover(ke)||(function(er,or,zt){var Qt,cr,Dt,Ut,ur,Sr,Lr,Hr=0,Kr=1,Ir=er.size(),kr=new Array(Ir),rn=0;function Qr(Zr){var yn=Zr[0],In=Zr[Zr.length-1];if(cr=yn.pmin-yn.pos-yn.dp+yn.size,Dt=In.pos+In.dp+In.size-yn.pmax,cr>.01){for(ur=Zr.length-1;ur>=0;ur--)Zr[ur].dp+=cr;Qt=!1}if(!(Dt<.01)){if(cr<-.01){for(ur=Zr.length-1;ur>=0;ur--)Zr[ur].dp-=Dt;Qt=!1}if(Qt){var Un=0;for(Ut=0;Ut<Zr.length;Ut++)(Sr=Zr[Ut]).pos+Sr.dp+Sr.size>yn.pmax&&Un++;for(Ut=Zr.length-1;Ut>=0&&!(Un<=0);Ut--)(Sr=Zr[Ut]).pos>yn.pmax-1&&(Sr.del=!0,Un--);for(Ut=0;Ut<Zr.length&&!(Un<=0);Ut++)if((Sr=Zr[Ut]).pos<yn.pmin+1)for(Sr.del=!0,Un--,Dt=2*Sr.size,ur=Zr.length-1;ur>=0;ur--)Zr[ur].dp-=Dt;for(Ut=Zr.length-1;Ut>=0&&!(Un<=0);Ut--)(Sr=Zr[Ut]).pos+Sr.dp+Sr.size>yn.pmax&&(Sr.del=!0,Un--)}}}for(er.each(function(Zr){var yn=Zr[or],In=yn._id.charAt(0)==="x",Un=yn.range;rn===0&&Un&&Un[0]>Un[1]!==In&&(Kr=-1),kr[rn++]=[{datum:Zr,traceIndex:Zr.trace.index,dp:0,pos:Zr.pos,posref:Zr.posref,size:Zr.by*(In?A:1)/2,pmin:0,pmax:In?zt.width:zt.height}]}),kr.sort(function(Zr,yn){return Zr[0].posref-yn[0].posref||Kr*(yn[0].traceIndex-Zr[0].traceIndex)});!Qt&&Hr<=Ir;){for(Hr++,Qt=!0,Ut=0;Ut<kr.length-1;){var nn=kr[Ut],Xr=kr[Ut+1],Nr=nn[nn.length-1],Br=Xr[0];if((cr=Nr.pos+Nr.dp+Nr.size-Br.pos-Br.dp+Br.size)>.01&&Nr.pmin===Br.pmin&&Nr.pmax===Br.pmax){for(ur=Xr.length-1;ur>=0;ur--)Xr[ur].dp+=cr;for(nn.push.apply(nn,Xr),kr.splice(Ut+1,1),Lr=0,ur=nn.length-1;ur>=0;ur--)Lr+=nn[ur].dp;for(Dt=Lr/nn.length,ur=nn.length-1;ur>=0;ur--)nn[ur].dp-=Dt;Qt=!1}else Ut++}kr.forEach(Qr)}for(Ut=kr.length-1;Ut>=0;Ut--){var on=kr[Ut];for(ur=on.length-1;ur>=0;ur--){var cn=on[ur],un=cn.datum;un.offset=cn.dp,un.del=cn.del}}}(Bt,Ne?"xa":"ya",$),I(Bt,Ne,$._invScaleX,$._invScaleY)),j.target&&j.target.tagName){var Jt=g.getComponentMethod("annotations","hasClickToShow")(H,Nt);u(t.select(j.target),Jt?"pointer":"")}!j.target||W||!function(er,or,zt){if(!zt||zt.length!==er._hoverdata.length)return!0;for(var Qt=zt.length-1;Qt>=0;Qt--){var cr=zt[Qt],Dt=er._hoverdata[Qt];if(cr.curveNumber!==Dt.curveNumber||String(cr.pointNumber)!==String(Dt.pointNumber)||String(cr.pointNumbers)!==String(Dt.pointNumbers))return!0}return!1}(H,0,It)||(It&&H.emit("plotly_unhover",{event:j,points:It}),H.emit("plotly_hover",{event:j,points:H._hoverdata,xaxes:le,yaxes:fe,xvals:Me,yvals:ve}))})(D,B,N,F)})},q.loneHover=function(D,B){var N=!0;Array.isArray(D)||(N=!1,D=[D]);var F=D.map(function(ae){return{color:ae.color||a.defaultLine,x0:ae.x0||ae.x||0,x1:ae.x1||ae.x||0,y0:ae.y0||ae.y||0,y1:ae.y1||ae.y||0,xLabel:ae.xLabel,yLabel:ae.yLabel,zLabel:ae.zLabel,text:ae.text,name:ae.name,idealAlign:ae.idealAlign,borderColor:ae.borderColor,fontFamily:ae.fontFamily,fontSize:ae.fontSize,fontColor:ae.fontColor,nameLength:ae.nameLength,textAlign:ae.textAlign,trace:ae.trace||{index:0,hoverinfo:""},xa:{_offset:0},ya:{_offset:0},index:0,hovertemplate:ae.hovertemplate||!1,eventData:ae.eventData||!1,hovertemplateLabels:ae.hovertemplateLabels||!1}}),H=t.select(B.container),j=B.outerContainer?t.select(B.outerContainer):H,G={hovermode:"closest",rotateLabels:!1,bgColor:B.bgColor||a.background,container:H,outerContainer:j},W=k(F,G,B.gd),Q=0,$=0;W.sort(function(ae,oe){return ae.y0-oe.y0}).each(function(ae,oe){var de=ae.y0-ae.by/2;ae.offset=de-5<Q?Q-de+5:0,Q=de+ae.by+ae.offset,oe===B.anchorIndex&&($=ae.offset)}).each(function(ae){ae.offset-=$});var ee=B.gd._fullLayout._invScaleX,ie=B.gd._fullLayout._invScaleY;return I(W,G.rotateLabels,ee,ie),N?W:W.node()};var C=/<extra>([\s\S]*)<\/extra>/;function k(D,B,N){var F=N._fullLayout,H=B.hovermode,j=B.rotateLabels,G=B.bgColor,W=B.container,Q=B.outerContainer,$=B.commonLabelOpts||{},ee=B.fontFamily||m.HOVERFONT,ie=B.fontSize||m.HOVERFONTSIZE,ae=D[0],oe=ae.xa,de=ae.ya,le=H.charAt(0)==="y"?"yLabel":"xLabel",fe=ae[le],ue=(String(fe)||"").split(" ")[0],we=Q.node().getBoundingClientRect(),Ae=we.top,Se=we.width,ke=we.height,Me=fe!==void 0&&ae.distance<=B.hoverdistance&&(H==="x"||H==="y");if(Me){var ve,ge,De=!0;for(ve=0;ve<D.length;ve++)if(De&&D[ve].zLabel===void 0&&(De=!1),ge=D[ve].hoverinfo||D[ve].trace.hoverinfo){var _e=Array.isArray(ge)?ge:ge.split("+");if(_e.indexOf("all")===-1&&_e.indexOf(H)===-1){Me=!1;break}}De&&(Me=!1)}var Pe=W.selectAll("g.axistext").data(Me?[0]:[]);function Fe(Ce){return Ce.filter(function(Ue){return Ue.zLabelVal!==void 0||(Ue[le]||"").split(" ")[0]===ue})}if(Pe.enter().append("g").classed("axistext",!0),Pe.exit().remove(),Pe.each(function(){var Ce=t.select(this),Ue=l.ensureSingle(Ce,"path","",function(Ne){Ne.style({"stroke-width":"1px"})}),Ye=l.ensureSingle(Ce,"text","",function(Ne){Ne.attr("data-notex",1)}),xe=$.bgcolor||a.defaultLine,Ee=$.bordercolor||a.contrast(xe),Je=a.contrast(xe),it={family:$.font.family||ee,size:$.font.size||ie,color:$.font.color||Je};Ue.style({fill:xe,stroke:Ee}),Ye.text(fe).call(s.font,it).call(i.positionText,0,0).call(i.convertToTspans,N),Ce.attr("transform","");var ht,ct,mt=Ye.node().getBoundingClientRect();if(H==="x"){var bt=oe.side==="top"?"-":"";Ye.attr("text-anchor","middle").call(i.positionText,0,oe.side==="top"?Ae-mt.bottom-b-_:Ae-mt.top+b+_),ht=oe._offset+(ae.x0+ae.x1)/2,ct=de._offset+(oe.side==="top"?0:de._length);var Et=mt.width/2+_;ht<Et?(ht=Et,Ue.attr("d","M-"+(Et-b)+",0L-"+(Et-2*b)+","+bt+b+"H"+(_+mt.width/2)+"v"+bt+(2*_+mt.height)+"H-"+Et+"V"+bt+b+"Z")):ht>F.width-Et?(ht=F.width-Et,Ue.attr("d","M"+(Et-b)+",0L"+Et+","+bt+b+"v"+bt+(2*_+mt.height)+"H-"+Et+"V"+bt+b+"H"+(Et-2*b)+"Z")):Ue.attr("d","M0,0L"+b+","+bt+b+"H"+(_+mt.width/2)+"v"+bt+(2*_+mt.height)+"H-"+(_+mt.width/2)+"V"+bt+b+"H-"+b+"Z")}else{var Mt,_t,xt;de.side==="right"?(Mt="start",_t=1,xt="",ht=oe._offset+oe._length):(Mt="end",_t=-1,xt="-",ht=oe._offset),ct=de._offset+(ae.y0+ae.y1)/2,Ye.attr("text-anchor",Mt),Ue.attr("d","M0,0L"+xt+b+","+b+"V"+(_+mt.height/2)+"h"+xt+(2*_+mt.width)+"V-"+(_+mt.height/2)+"H"+xt+b+"V-"+b+"Z");var At,It=mt.height/2,Nt=Ae-mt.top-It,Ot="clip"+F._uid+"commonlabel"+de._id;if(ht<mt.width+2*_+b){At="M-"+(b+_)+"-"+It+"h-"+(mt.width-_)+"V"+It+"h"+(mt.width-_)+"Z";var Yt=mt.width-ht+_;i.positionText(Ye,Yt,Nt),Mt==="end"&&Ye.selectAll("tspan").each(function(){var Ne=t.select(this),ut=s.tester.append("text").text(Ne.text()).call(s.font,it),wt=ut.node().getBoundingClientRect();Math.round(wt.width)<Math.round(mt.width)&&Ne.attr("x",Yt-wt.width),ut.remove()})}else i.positionText(Ye,_t*(_+b),Nt),At=null;var Pt=F._topclips.selectAll("#"+Ot).data(At?[0]:[]);Pt.enter().append("clipPath").attr("id",Ot).append("path"),Pt.exit().remove(),Pt.select("path").attr("d",At),s.setClipUrl(Ye,At?Ot:null,N)}Ce.attr("transform",e(ht,ct)),D=Fe(D)}),d.isUnifiedHover(H)){if(W.selectAll("g.hovertext").remove(),fe!==void 0&&ae.distance<=B.hoverdistance&&(D=Fe(D)),D.length===0)return;var ze={showlegend:!0,legend:{title:{text:fe,font:F.hoverlabel.font},font:F.hoverlabel.font,bgcolor:F.hoverlabel.bgcolor,bordercolor:F.hoverlabel.bordercolor,borderwidth:1,tracegroupgap:7,traceorder:F.legend?F.legend.traceorder:void 0,orientation:"v"}},He={};y(ze,He,N._fullData);var et=He.legend;et.entries=[];for(var Re=0;Re<D.length;Re++){var Ze=L(D[Re],!0,H,F,fe),Ke=Ze[0],$e=Ze[1],rt=D[Re];rt.name=$e,rt.text=$e!==""?$e+" : "+Ke:Ke;var at=rt.cd[rt.index];at&&(at.mc&&(rt.mc=at.mc),at.mcc&&(rt.mc=at.mcc),at.mlc&&(rt.mlc=at.mlc),at.mlcc&&(rt.mlc=at.mlcc),at.mlw&&(rt.mlw=at.mlw),at.mrc&&(rt.mrc=at.mrc),at.dir&&(rt.dir=at.dir)),rt._distinct=!0,et.entries.push([rt])}et.entries.sort(function(Ce,Ue){return Ce[0].trace.index-Ue[0].trace.index}),et.layer=W,v(N,et);var lt=l.mean(D.map(function(Ce){return(Ce.y0+Ce.y1)/2})),gt=l.mean(D.map(function(Ce){return(Ce.x0+Ce.x1)/2})),Ie=W.select("g.legend"),be=Ie.node().getBoundingClientRect();gt+=oe._offset,lt+=de._offset-be.height/2;var We=be.width+2*_;!(gt+We<=Se)&&gt-We>=0?gt-=We:gt+=2*_;var Ge=be.height+2*_,st=lt+Ge>=ke;return Ge<=ke&&(lt<=Ae?lt=de._offset+2*_:st&&(lt=ke-Ge)),Ie.attr("transform",e(gt,lt)),Ie}var ot=W.selectAll("g.hovertext").data(D,function(Ce){return S(Ce)});return ot.enter().append("g").classed("hovertext",!0).each(function(){var Ce=t.select(this);Ce.append("rect").call(a.fill,a.addOpacity(G,.8)),Ce.append("text").classed("name",!0),Ce.append("path").style("stroke-width","1px"),Ce.append("text").classed("nums",!0).call(s.font,ee,ie)}),ot.exit().remove(),ot.each(function(Ce){var Ue=t.select(this).attr("transform",""),Ye=Ce.color;Array.isArray(Ye)&&(Ye=Ye[Ce.eventData[0].pointNumber]);var xe=Ce.bgcolor||Ye,Ee=a.combine(a.opacity(xe)?xe:a.defaultLine,G),Je=a.combine(a.opacity(Ye)?Ye:a.defaultLine,G),it=Ce.borderColor||a.contrast(Ee),ht=L(Ce,Me,H,F,fe,Ue),ct=ht[0],mt=ht[1],bt=Ue.select("text.nums").call(s.font,Ce.fontFamily||ee,Ce.fontSize||ie,Ce.fontColor||it).text(ct).attr("data-notex",1).call(i.positionText,0,0).call(i.convertToTspans,N),Et=Ue.select("text.name"),Mt=0,_t=0;if(mt&&mt!==ct){Et.call(s.font,Ce.fontFamily||ee,Ce.fontSize||ie,Je).text(mt).attr("data-notex",1).call(i.positionText,0,0).call(i.convertToTspans,N);var xt=Et.node().getBoundingClientRect();Mt=xt.width+2*_,_t=xt.height+2*_}else Et.remove(),Ue.select("rect").remove();Ue.select("path").style({fill:Ee,stroke:it});var At,It,Nt=bt.node().getBoundingClientRect(),Ot=Ce.xa._offset+(Ce.x0+Ce.x1)/2,Yt=Ce.ya._offset+(Ce.y0+Ce.y1)/2,Pt=Math.abs(Ce.x1-Ce.x0),Ne=Math.abs(Ce.y1-Ce.y0),ut=Nt.width+b+_+Mt;if(Ce.ty0=Ae-Nt.top,Ce.bx=Nt.width+2*_,Ce.by=Math.max(Nt.height+2*_,_t),Ce.anchor="start",Ce.txwidth=Nt.width,Ce.tx2width=Mt,Ce.offset=0,j)Ce.pos=Ot,At=Yt+Ne/2+ut<=ke,It=Yt-Ne/2-ut>=0,Ce.idealAlign!=="top"&&At||!It?At?(Yt+=Ne/2,Ce.anchor="start"):Ce.anchor="middle":(Yt-=Ne/2,Ce.anchor="end");else if(Ce.pos=Yt,At=Ot+Pt/2+ut<=Se,It=Ot-Pt/2-ut>=0,Ce.idealAlign!=="left"&&At||!It)if(At)Ot+=Pt/2,Ce.anchor="start";else{Ce.anchor="middle";var wt=ut/2,Bt=Ot+wt-Se,Jt=Ot-wt;Bt>0&&(Ot-=Bt),Jt<0&&(Ot+=-Jt)}else Ot-=Pt/2,Ce.anchor="end";bt.attr("text-anchor",Ce.anchor),Mt&&Et.attr("text-anchor",Ce.anchor),Ue.attr("transform",e(Ot,Yt)+(j?o(T):""))}),ot}function L(D,B,N,F,H,j){var G="",W="";D.nameOverride!==void 0&&(D.name=D.nameOverride),D.name&&(D.trace._meta&&(D.name=l.templateString(D.name,D.trace._meta)),G=J(D.name,D.nameLength)),D.zLabel!==void 0?(D.xLabel!==void 0&&(W+="x: "+D.xLabel+"<br>"),D.yLabel!==void 0&&(W+="y: "+D.yLabel+"<br>"),D.trace.type!=="choropleth"&&D.trace.type!=="choroplethmapbox"&&(W+=(W?"z: ":"")+D.zLabel)):B&&D[N.charAt(0)+"Label"]===H?W=D[(N.charAt(0)==="x"?"y":"x")+"Label"]||"":D.xLabel===void 0?D.yLabel!==void 0&&D.trace.type!=="scattercarpet"&&(W=D.yLabel):W=D.yLabel===void 0?D.xLabel:"("+D.xLabel+", "+D.yLabel+")",!D.text&&D.text!==0||Array.isArray(D.text)||(W+=(W?"<br>":"")+D.text),D.extraText!==void 0&&(W+=(W?"<br>":"")+D.extraText),j&&W===""&&!D.hovertemplate&&(G===""&&j.remove(),W=G);var Q=F._d3locale,$=D.hovertemplate||!1,ee=D.hovertemplateLabels||D,ie=D.eventData[0]||{};return $&&(W=(W=l.hovertemplateString($,ee,Q,ie,D.trace._meta)).replace(C,function(ae,oe){return G=J(oe,D.nameLength),""})),[W,G]}function I(D,B,N,F){var H=function(G){return G*N},j=function(G){return G*F};D.each(function(G){var W=t.select(this);if(G.del)return W.remove();var Q=W.select("text.nums"),$=G.anchor,ee=$==="end"?-1:1,ie={start:1,end:-1,middle:0}[$],ae=ie*(b+_),oe=ae+ie*(G.txwidth+_),de=0,le=G.offset,fe=$==="middle";fe&&(ae-=G.tx2width/2,oe+=G.txwidth/2+_),B&&(le*=-M,de=G.offset*E),W.select("path").attr("d",fe?"M-"+H(G.bx/2+G.tx2width/2)+","+j(le-G.by/2)+"h"+H(G.bx)+"v"+j(G.by)+"h-"+H(G.bx)+"Z":"M0,0L"+H(ee*b+de)+","+j(b+le)+"v"+j(G.by/2-b)+"h"+H(ee*G.bx)+"v-"+j(G.by)+"H"+H(ee*b+de)+"V"+j(le-b)+"Z");var ue=de+ae,we=le+G.ty0-G.by/2+_,Ae=G.textAlign||"auto";Ae!=="auto"&&(Ae==="left"&&$!=="start"?(Q.attr("text-anchor","start"),ue=fe?-G.bx/2-G.tx2width/2+_:-G.bx-_):Ae==="right"&&$!=="end"&&(Q.attr("text-anchor","end"),ue=fe?G.bx/2-G.tx2width/2-_:G.bx+_)),Q.call(i.positionText,H(ue),j(we)),G.tx2width&&(W.select("text.name").call(i.positionText,H(oe+ie*_+de),j(le+G.ty0-G.by/2+_)),W.select("rect").call(s.setRect,H(oe+(ie-1)*G.tx2width/2+de),j(le-G.by/2-1),H(G.tx2width),j(G.by+2)))})}function R(D,B){var N=D.index,F=D.trace||{},H=D.cd[0],j=D.cd[N]||{};function G(ae){return ae||h(ae)&&ae===0}var W=Array.isArray(N)?function(ae,oe){var de=l.castOption(H,N,ae);return G(de)?de:l.extractOption({},F,"",oe)}:function(ae,oe){return l.extractOption(j,F,ae,oe)};function Q(ae,oe,de){var le=W(oe,de);G(le)&&(D[ae]=le)}if(Q("hoverinfo","hi","hoverinfo"),Q("bgcolor","hbg","hoverlabel.bgcolor"),Q("borderColor","hbc","hoverlabel.bordercolor"),Q("fontFamily","htf","hoverlabel.font.family"),Q("fontSize","hts","hoverlabel.font.size"),Q("fontColor","htc","hoverlabel.font.color"),Q("nameLength","hnl","hoverlabel.namelength"),Q("textAlign","hta","hoverlabel.align"),D.posref=B==="y"||B==="closest"&&F.orientation==="h"?D.xa._offset+(D.x0+D.x1)/2:D.ya._offset+(D.y0+D.y1)/2,D.x0=l.constrain(D.x0,0,D.xa._length),D.x1=l.constrain(D.x1,0,D.xa._length),D.y0=l.constrain(D.y0,0,D.ya._length),D.y1=l.constrain(D.y1,0,D.ya._length),D.xLabelVal!==void 0&&(D.xLabel="xLabel"in D?D.xLabel:f.hoverLabelText(D.xa,D.xLabelVal),D.xVal=D.xa.c2d(D.xLabelVal)),D.yLabelVal!==void 0&&(D.yLabel="yLabel"in D?D.yLabel:f.hoverLabelText(D.ya,D.yLabelVal),D.yVal=D.ya.c2d(D.yLabelVal)),D.zLabelVal!==void 0&&D.zLabel===void 0&&(D.zLabel=String(D.zLabelVal)),!(isNaN(D.xerr)||D.xa.type==="log"&&D.xerr<=0)){var $=f.tickText(D.xa,D.xa.c2l(D.xerr),"hover").text;D.xerrneg!==void 0?D.xLabel+=" +"+$+" / -"+f.tickText(D.xa,D.xa.c2l(D.xerrneg),"hover").text:D.xLabel+=" \xB1 "+$,B==="x"&&(D.distance+=1)}if(!(isNaN(D.yerr)||D.ya.type==="log"&&D.yerr<=0)){var ee=f.tickText(D.ya,D.ya.c2l(D.yerr),"hover").text;D.yerrneg!==void 0?D.yLabel+=" +"+ee+" / -"+f.tickText(D.ya,D.ya.c2l(D.yerrneg),"hover").text:D.yLabel+=" \xB1 "+ee,B==="y"&&(D.distance+=1)}var ie=D.hoverinfo||D.trace.hoverinfo;return ie&&ie!=="all"&&((ie=Array.isArray(ie)?ie:ie.split("+")).indexOf("x")===-1&&(D.xLabel=void 0),ie.indexOf("y")===-1&&(D.yLabel=void 0),ie.indexOf("z")===-1&&(D.zLabel=void 0),ie.indexOf("text")===-1&&(D.text=void 0),ie.indexOf("name")===-1&&(D.name=void 0)),D}function V(D,B,N){var F,H,j=N.container,G=N.fullLayout,W=G._size,Q=N.event,$=!!B.hLinePoint,ee=!!B.vLinePoint;if(j.selectAll(".spikeline").remove(),ee||$){var ie=a.combine(G.plot_bgcolor,G.paper_bgcolor);if($){var ae,oe,de=B.hLinePoint;F=de&&de.xa,(H=de&&de.ya).spikesnap==="cursor"?(ae=Q.pointerX,oe=Q.pointerY):(ae=F._offset+de.x,oe=H._offset+de.y);var le,fe,ue=p.readability(de.color,ie)<1.5?a.contrast(ie):de.color,we=H.spikemode,Ae=H.spikethickness,Se=H.spikecolor||ue,ke=f.getPxPosition(D,H);if(we.indexOf("toaxis")!==-1||we.indexOf("across")!==-1){if(we.indexOf("toaxis")!==-1&&(le=ke,fe=ae),we.indexOf("across")!==-1){var Me=H._counterDomainMin,ve=H._counterDomainMax;H.anchor==="free"&&(Me=Math.min(Me,H.position),ve=Math.max(ve,H.position)),le=W.l+Me*W.w,fe=W.l+ve*W.w}j.insert("line",":first-child").attr({x1:le,x2:fe,y1:oe,y2:oe,"stroke-width":Ae,stroke:Se,"stroke-dasharray":s.dashStyle(H.spikedash,Ae)}).classed("spikeline",!0).classed("crisp",!0),j.insert("line",":first-child").attr({x1:le,x2:fe,y1:oe,y2:oe,"stroke-width":Ae+2,stroke:ie}).classed("spikeline",!0).classed("crisp",!0)}we.indexOf("marker")!==-1&&j.insert("circle",":first-child").attr({cx:ke+(H.side!=="right"?Ae:-Ae),cy:oe,r:Ae,fill:Se}).classed("spikeline",!0)}if(ee){var ge,De,_e=B.vLinePoint;F=_e&&_e.xa,H=_e&&_e.ya,F.spikesnap==="cursor"?(ge=Q.pointerX,De=Q.pointerY):(ge=F._offset+_e.x,De=H._offset+_e.y);var Pe,Fe,ze=p.readability(_e.color,ie)<1.5?a.contrast(ie):_e.color,He=F.spikemode,et=F.spikethickness,Re=F.spikecolor||ze,Ze=f.getPxPosition(D,F);if(He.indexOf("toaxis")!==-1||He.indexOf("across")!==-1){if(He.indexOf("toaxis")!==-1&&(Pe=Ze,Fe=De),He.indexOf("across")!==-1){var Ke=F._counterDomainMin,$e=F._counterDomainMax;F.anchor==="free"&&(Ke=Math.min(Ke,F.position),$e=Math.max($e,F.position)),Pe=W.t+(1-$e)*W.h,Fe=W.t+(1-Ke)*W.h}j.insert("line",":first-child").attr({x1:ge,x2:ge,y1:Pe,y2:Fe,"stroke-width":et,stroke:Re,"stroke-dasharray":s.dashStyle(F.spikedash,et)}).classed("spikeline",!0).classed("crisp",!0),j.insert("line",":first-child").attr({x1:ge,x2:ge,y1:Pe,y2:Fe,"stroke-width":et+2,stroke:ie}).classed("spikeline",!0).classed("crisp",!0)}He.indexOf("marker")!==-1&&j.insert("circle",":first-child").attr({cx:ge,cy:Ze-(F.side!=="top"?et:-et),r:et,fill:Re}).classed("spikeline",!0)}}}function O(D,B){return!B||B.vLinePoint!==D._spikepoints.vLinePoint||B.hLinePoint!==D._spikepoints.hLinePoint}function J(D,B){return i.plainText(D||"",{len:B,allowedTags:["br","sub","sup","b","i","em"]})}},{"../../lib":778,"../../lib/events":767,"../../lib/override_cursor":789,"../../lib/svg_text_utils":803,"../../plots/cartesian/axes":828,"../../registry":911,"../color":643,"../dragelement":662,"../drawing":665,"../legend/defaults":695,"../legend/draw":696,"./constants":677,"./helpers":679,d3:169,"fast-isnumeric":241,tinycolor2:576}],681:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../color"),p=n("./helpers").isUnifiedHover;z.exports=function(l,e,o,r){function i(u){r.font[u]||(r.font[u]=e.legend?e.legend.font[u]:e.font[u])}r=r||{},e&&p(e.hovermode)&&(r.font||(r.font={}),i("size"),i("family"),i("color"),e.legend?(r.bgcolor||(r.bgcolor=h.combine(e.legend.bgcolor,e.paper_bgcolor)),r.bordercolor||(r.bordercolor=e.legend.bordercolor)):r.bgcolor||(r.bgcolor=e.paper_bgcolor)),o("hoverlabel.bgcolor",r.bgcolor),o("hoverlabel.bordercolor",r.bordercolor),o("hoverlabel.namelength",r.namelength),t.coerceFont(o,"hoverlabel.font",r.font),o("hoverlabel.align",r.align)}},{"../../lib":778,"../color":643,"./helpers":679}],682:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("./layout_attributes");z.exports=function(p,l,e){function o(u,s){return l[u]!==void 0?l[u]:t.coerce(p,l,h,u,s)}var r,i=o("clickmode");return l._has("cartesian")?i.indexOf("select")>-1?r="closest":(l._isHoriz=function(u,s){for(var a=s._scatterStackOpts||{},c=0;c<u.length;c++){var f=u[c],g=f.xaxis+f.yaxis,d=(a[g]||{})[f.stackgroup]||{};if(f.orientation!=="h"&&d.orientation!=="h")return!1}return!0}(e,l),r=l._isHoriz?"y":"x"):r="closest",o("hovermode",r)}},{"../../lib":778,"./layout_attributes":684}],683:[function(n,z,q){"use strict";var t=n("d3"),h=n("../../lib"),p=n("../dragelement"),l=n("./helpers"),e=n("./layout_attributes"),o=n("./hover");z.exports={moduleType:"component",name:"fx",constants:n("./constants"),schema:{layout:e},attributes:n("./attributes"),layoutAttributes:e,supplyLayoutGlobalDefaults:n("./layout_global_defaults"),supplyDefaults:n("./defaults"),supplyLayoutDefaults:n("./layout_defaults"),calc:n("./calc"),getDistanceFunction:l.getDistanceFunction,getClosest:l.getClosest,inbox:l.inbox,quadrature:l.quadrature,appendArrayPointValue:l.appendArrayPointValue,castHoverOption:function(r,i,u){return h.castOption(r,i,"hoverlabel."+u)},castHoverinfo:function(r,i,u){return h.castOption(r,u,"hoverinfo",function(s){return h.coerceHoverinfo({hoverinfo:s},{_module:r._module},i)})},hover:o.hover,unhover:p.unhover,loneHover:o.loneHover,loneUnhover:function(r){var i=h.isD3Selection(r)?r:t.select(r);i.selectAll("g.hovertext").remove(),i.selectAll(".spikeline").remove()},click:n("./click")}},{"../../lib":778,"../dragelement":662,"./attributes":674,"./calc":675,"./click":676,"./constants":677,"./defaults":678,"./helpers":679,"./hover":680,"./layout_attributes":684,"./layout_defaults":685,"./layout_global_defaults":686,d3:169}],684:[function(n,z,q){"use strict";var t=n("./constants"),h=n("../../plots/font_attributes")({editType:"none"});h.family.dflt=t.HOVERFONT,h.size.dflt=t.HOVERFONTSIZE,z.exports={clickmode:{valType:"flaglist",flags:["event","select"],dflt:"event",editType:"plot",extras:["none"]},dragmode:{valType:"enumerated",values:["zoom","pan","select","lasso","drawclosedpath","drawopenpath","drawline","drawrect","drawcircle","orbit","turntable",!1],dflt:"zoom",editType:"modebar"},hovermode:{valType:"enumerated",values:["x","y","closest",!1,"x unified","y unified"],editType:"modebar"},hoverdistance:{valType:"integer",min:-1,dflt:20,editType:"none"},spikedistance:{valType:"integer",min:-1,dflt:20,editType:"none"},hoverlabel:{bgcolor:{valType:"color",editType:"none"},bordercolor:{valType:"color",editType:"none"},font:h,align:{valType:"enumerated",values:["left","right","auto"],dflt:"auto",editType:"none"},namelength:{valType:"integer",min:-1,dflt:15,editType:"none"},editType:"none"},selectdirection:{valType:"enumerated",values:["h","v","d","any"],dflt:"any",editType:"none"}}},{"../../plots/font_attributes":856,"./constants":677}],685:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("./helpers").isUnifiedHover,p=n("./layout_attributes"),l=n("./hovermode_defaults"),e=n("./hoverlabel_defaults");z.exports=function(o,r,i){function u(g,d){return t.coerce(o,r,p,g,d)}var s=l(o,r,i);s&&(u("hoverdistance"),u("spikedistance",h(s)?-1:void 0)),u("dragmode")==="select"&&u("selectdirection");var a=r._has("mapbox"),c=r._has("geo"),f=r._basePlotModules.length;r.dragmode==="zoom"&&((a||c)&&f===1||a&&c&&f===2)&&(r.dragmode="pan"),e(o,r,u)}},{"../../lib":778,"./helpers":679,"./hoverlabel_defaults":681,"./hovermode_defaults":682,"./layout_attributes":684}],686:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("./hoverlabel_defaults"),p=n("./layout_attributes");z.exports=function(l,e){h(l,e,function(o,r){return t.coerce(l,e,p,o,r)})}},{"../../lib":778,"./hoverlabel_defaults":681,"./layout_attributes":684}],687:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../../lib/regex").counter,p=n("../../plots/domain").attributes,l=n("../../plots/cartesian/constants").idRegex,e=n("../../plot_api/plot_template"),o={rows:{valType:"integer",min:1,editType:"plot"},roworder:{valType:"enumerated",values:["top to bottom","bottom to top"],dflt:"top to bottom",editType:"plot"},columns:{valType:"integer",min:1,editType:"plot"},subplots:{valType:"info_array",freeLength:!0,dimensions:2,items:{valType:"enumerated",values:[h("xy").toString(),""],editType:"plot"},editType:"plot"},xaxes:{valType:"info_array",freeLength:!0,items:{valType:"enumerated",values:[l.x.toString(),""],editType:"plot"},editType:"plot"},yaxes:{valType:"info_array",freeLength:!0,items:{valType:"enumerated",values:[l.y.toString(),""],editType:"plot"},editType:"plot"},pattern:{valType:"enumerated",values:["independent","coupled"],dflt:"coupled",editType:"plot"},xgap:{valType:"number",min:0,max:1,editType:"plot"},ygap:{valType:"number",min:0,max:1,editType:"plot"},domain:p({name:"grid",editType:"plot",noGridCell:!0},{}),xside:{valType:"enumerated",values:["bottom","bottom plot","top plot","top"],dflt:"bottom plot",editType:"plot"},yside:{valType:"enumerated",values:["left","left plot","right plot","right"],dflt:"left plot",editType:"plot"},editType:"plot"};function r(s,a,c){var f=a[c+"axes"],g=Object.keys((s._splomAxes||{})[c]||{});return Array.isArray(f)?f:g.length?g:void 0}function i(s,a,c,f,g,d){var m=a(s+"gap",c),y=a("domain."+s);a(s+"side",f);for(var v=new Array(g),T=y[0],w=(y[1]-T)/(g-m),A=w*(1-m),E=0;E<g;E++){var M=T+w*E;v[d?g-1-E:E]=[M,M+A]}return v}function u(s,a,c,f,g){var d,m=new Array(c);function y(v,T){a.indexOf(T)!==-1&&f[T]===void 0?(m[v]=T,f[T]=v):m[v]=""}if(Array.isArray(s))for(d=0;d<c;d++)y(d,s[d]);else for(y(0,g),d=1;d<c;d++)y(d,g+(d+1));return m}z.exports={moduleType:"component",name:"grid",schema:{layout:{grid:o}},layoutAttributes:o,sizeDefaults:function(s,a){var c=s.grid||{},f=r(a,c,"x"),g=r(a,c,"y");if(s.grid||f||g){var d,m,y=Array.isArray(c.subplots)&&Array.isArray(c.subplots[0]),v=Array.isArray(f),T=Array.isArray(g),w=v&&f!==c.xaxes&&T&&g!==c.yaxes;y?(d=c.subplots.length,m=c.subplots[0].length):(T&&(d=g.length),v&&(m=f.length));var A=e.newContainer(a,"grid"),E=L("rows",d),M=L("columns",m);if(E*M>1){!y&&!v&&!T&&L("pattern")==="independent"&&(y=!0),A._hasSubplotGrid=y;var b,_,S=L("roworder")==="top to bottom",C=y?.2:.1,k=y?.3:.1;w&&a._splomGridDflt&&(b=a._splomGridDflt.xside,_=a._splomGridDflt.yside),A._domains={x:i("x",L,C,b,M),y:i("y",L,k,_,E,S)}}else delete a.grid}function L(I,R){return t.coerce(c,A,o,I,R)}},contentDefaults:function(s,a){var c=a.grid;if(c&&c._domains){var f,g,d,m,y,v,T,w=s.grid||{},A=a._subplots,E=c._hasSubplotGrid,M=c.rows,b=c.columns,_=c.pattern==="independent",S=c._axisMap={};if(E){var C=w.subplots||[];v=c.subplots=new Array(M);var k=1;for(f=0;f<M;f++){var L=v[f]=new Array(b),I=C[f]||[];for(g=0;g<b;g++)if(_?(y=k===1?"xy":"x"+k+"y"+k,k++):y=I[g],L[g]="",A.cartesian.indexOf(y)!==-1){if(T=y.indexOf("y"),d=y.slice(0,T),m=y.slice(T),S[d]!==void 0&&S[d]!==g||S[m]!==void 0&&S[m]!==f)continue;L[g]=y,S[d]=g,S[m]=f}}}else{var R=r(a,w,"x"),V=r(a,w,"y");c.xaxes=u(R,A.xaxis,b,S,"x"),c.yaxes=u(V,A.yaxis,M,S,"y")}var O=c._anchors={},J=c.roworder==="top to bottom";for(var D in S){var B,N,F,H=D.charAt(0),j=c[H+"side"];if(j.length<8)O[D]="free";else if(H==="x"){if(j.charAt(0)==="t"===J?(B=0,N=1,F=M):(B=M-1,N=-1,F=-1),E){var G=S[D];for(f=B;f!==F;f+=N)if((y=v[f][G])&&(T=y.indexOf("y"),y.slice(0,T)===D)){O[D]=y.slice(T);break}}else for(f=B;f!==F;f+=N)if(m=c.yaxes[f],A.cartesian.indexOf(D+m)!==-1){O[D]=m;break}}else if(j.charAt(0)==="l"?(B=0,N=1,F=b):(B=b-1,N=-1,F=-1),E){var W=S[D];for(f=B;f!==F;f+=N)if((y=v[W][f])&&(T=y.indexOf("y"),y.slice(T)===D)){O[D]=y.slice(0,T);break}}else for(f=B;f!==F;f+=N)if(d=c.xaxes[f],A.cartesian.indexOf(d+D)!==-1){O[D]=d;break}}}}}},{"../../lib":778,"../../lib/regex":795,"../../plot_api/plot_template":817,"../../plots/cartesian/constants":834,"../../plots/domain":855}],688:[function(n,z,q){"use strict";var t=n("../../plots/cartesian/constants"),h=n("../../plot_api/plot_template").templatedArray;n("../../constants/axis_placeable_objects"),z.exports=h("image",{visible:{valType:"boolean",dflt:!0,editType:"arraydraw"},source:{valType:"string",editType:"arraydraw"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"arraydraw"},sizex:{valType:"number",dflt:0,editType:"arraydraw"},sizey:{valType:"number",dflt:0,editType:"arraydraw"},sizing:{valType:"enumerated",values:["fill","contain","stretch"],dflt:"contain",editType:"arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},x:{valType:"any",dflt:0,editType:"arraydraw"},y:{valType:"any",dflt:0,editType:"arraydraw"},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left",editType:"arraydraw"},yanchor:{valType:"enumerated",values:["top","middle","bottom"],dflt:"top",editType:"arraydraw"},xref:{valType:"enumerated",values:["paper",t.idRegex.x.toString()],dflt:"paper",editType:"arraydraw"},yref:{valType:"enumerated",values:["paper",t.idRegex.y.toString()],dflt:"paper",editType:"arraydraw"},editType:"arraydraw"})},{"../../constants/axis_placeable_objects":746,"../../plot_api/plot_template":817,"../../plots/cartesian/constants":834}],689:[function(n,z,q){"use strict";var t=n("fast-isnumeric"),h=n("../../lib/to_log_range");z.exports=function(p,l,e,o){l=l||{};var r=e==="log"&&l.type==="linear",i=e==="linear"&&l.type==="log";if(r||i){for(var u,s,a=p._fullLayout.images,c=l._id.charAt(0),f=0;f<a.length;f++)if(s="images["+f+"].",(u=a[f])[c+"ref"]===l._id){var g=u[c],d=u["size"+c],m=null,y=null;if(r){m=h(g,l.range);var v=d/Math.pow(10,m)/2;y=2*Math.log(v+Math.sqrt(1+v*v))/Math.LN10}else y=(m=Math.pow(10,g))*(Math.pow(10,d/2)-Math.pow(10,-d/2));t(m)?t(y)||(y=null):(m=null,y=null),o(s+c,m),o(s+"size"+c,y)}}}},{"../../lib/to_log_range":805,"fast-isnumeric":241}],690:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../../plots/cartesian/axes"),p=n("../../plots/array_container_defaults"),l=n("./attributes");function e(o,r,i){function u(m,y){return t.coerce(o,r,l,m,y)}var s=u("source");if(!u("visible",!!s))return r;u("layer"),u("xanchor"),u("yanchor"),u("sizex"),u("sizey"),u("sizing"),u("opacity");for(var a={_fullLayout:i},c=["x","y"],f=0;f<2;f++){var g=c[f],d=h.coerceRef(o,r,a,g,"paper",void 0);d!=="paper"&&h.getFromId(a,d)._imgIndices.push(r._index),h.coercePosition(r,a,u,d,g,0)}return r}z.exports=function(o,r){p(o,r,{name:"images",handleItemDefaults:e})}},{"../../lib":778,"../../plots/array_container_defaults":823,"../../plots/cartesian/axes":828,"./attributes":688}],691:[function(n,z,q){"use strict";var t=n("d3"),h=n("../drawing"),p=n("../../plots/cartesian/axes"),l=n("../../plots/cartesian/axis_ids"),e=n("../../constants/xmlns_namespaces");z.exports=function(o){var r,i,u=o._fullLayout,s=[],a={},c=[];for(i=0;i<u.images.length;i++){var f=u.images[i];if(f.visible)if(f.layer==="below"&&f.xref!=="paper"&&f.yref!=="paper"){r=l.ref2id(f.xref)+l.ref2id(f.yref);var g=u._plots[r];if(!g){c.push(f);continue}g.mainplot&&(r=g.mainplot.id),a[r]||(a[r]=[]),a[r].push(f)}else f.layer==="above"?s.push(f):c.push(f)}var d={left:{sizing:"xMin",offset:0},center:{sizing:"xMid",offset:-.5},right:{sizing:"xMax",offset:-1}},m={top:{sizing:"YMin",offset:0},middle:{sizing:"YMid",offset:-.5},bottom:{sizing:"YMax",offset:-1}};function y(b){var _=t.select(this);if(this._imgSrc!==b.source)if(_.attr("xmlns",e.svg),b.source&&b.source.slice(0,5)==="data:")_.attr("xlink:href",b.source),this._imgSrc=b.source;else{var S=new Promise(function(C){var k=new Image;function L(){_.remove(),C()}this.img=k,k.setAttribute("crossOrigin","anonymous"),k.onerror=L,k.onload=function(){var I=document.createElement("canvas");I.width=this.width,I.height=this.height,I.getContext("2d").drawImage(this,0,0);var R=I.toDataURL("image/png");_.attr("xlink:href",R),C()},_.on("error",L),k.src=b.source,this._imgSrc=b.source}.bind(this));o._promises.push(S)}}function v(b){var _,S,C=t.select(this),k=p.getFromId(o,b.xref),L=p.getFromId(o,b.yref),I=p.getRefType(b.xref)==="domain",R=p.getRefType(b.yref)==="domain",V=u._size;_=k!==void 0?typeof b.xref=="string"&&I?k._length*b.sizex:Math.abs(k.l2p(b.sizex)-k.l2p(0)):b.sizex*V.w,S=L!==void 0?typeof b.yref=="string"&&R?L._length*b.sizey:Math.abs(L.l2p(b.sizey)-L.l2p(0)):b.sizey*V.h;var O,J,D=_*d[b.xanchor].offset,B=S*m[b.yanchor].offset,N=d[b.xanchor].sizing+m[b.yanchor].sizing;switch(O=k!==void 0?typeof b.xref=="string"&&I?k._length*b.x+k._offset:k.r2p(b.x)+k._offset:b.x*V.w+V.l,O+=D,J=L!==void 0?typeof b.yref=="string"&&R?L._length*(1-b.y)+L._offset:L.r2p(b.y)+L._offset:V.h-b.y*V.h+V.t,J+=B,b.sizing){case"fill":N+=" slice";break;case"stretch":N="none"}C.attr({x:O,y:J,width:_,height:S,preserveAspectRatio:N,opacity:b.opacity});var F=(k&&p.getRefType(b.xref)!=="domain"?k._id:"")+(L&&p.getRefType(b.yref)!=="domain"?L._id:"");h.setClipUrl(C,F?"clip"+u._uid+F:null,o)}var T=u._imageLowerLayer.selectAll("image").data(c),w=u._imageUpperLayer.selectAll("image").data(s);T.enter().append("image"),w.enter().append("image"),T.exit().remove(),w.exit().remove(),T.each(function(b){y.bind(this)(b),v.bind(this)(b)}),w.each(function(b){y.bind(this)(b),v.bind(this)(b)});var A=Object.keys(u._plots);for(i=0;i<A.length;i++){r=A[i];var E=u._plots[r];if(E.imagelayer){var M=E.imagelayer.selectAll("image").data(a[r]||[]);M.enter().append("image"),M.exit().remove(),M.each(function(b){y.bind(this)(b),v.bind(this)(b)})}}}},{"../../constants/xmlns_namespaces":754,"../../plots/cartesian/axes":828,"../../plots/cartesian/axis_ids":831,"../drawing":665,d3:169}],692:[function(n,z,q){"use strict";z.exports={moduleType:"component",name:"images",layoutAttributes:n("./attributes"),supplyLayoutDefaults:n("./defaults"),includeBasePlot:n("../../plots/cartesian/include_components")("images"),draw:n("./draw"),convertCoords:n("./convert_coords")}},{"../../plots/cartesian/include_components":840,"./attributes":688,"./convert_coords":689,"./defaults":690,"./draw":691}],693:[function(n,z,q){"use strict";var t=n("../../plots/font_attributes"),h=n("../color/attributes");z.exports={bgcolor:{valType:"color",editType:"legend"},bordercolor:{valType:"color",dflt:h.defaultLine,editType:"legend"},borderwidth:{valType:"number",min:0,dflt:0,editType:"legend"},font:t({editType:"legend"}),orientation:{valType:"enumerated",values:["v","h"],dflt:"v",editType:"legend"},traceorder:{valType:"flaglist",flags:["reversed","grouped"],extras:["normal"],editType:"legend"},tracegroupgap:{valType:"number",min:0,dflt:10,editType:"legend"},itemsizing:{valType:"enumerated",values:["trace","constant"],dflt:"trace",editType:"legend"},itemwidth:{valType:"number",min:30,dflt:30,editType:"legend"},itemclick:{valType:"enumerated",values:["toggle","toggleothers",!1],dflt:"toggle",editType:"legend"},itemdoubleclick:{valType:"enumerated",values:["toggle","toggleothers",!1],dflt:"toggleothers",editType:"legend"},x:{valType:"number",min:-2,max:3,editType:"legend"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left",editType:"legend"},y:{valType:"number",min:-2,max:3,editType:"legend"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],editType:"legend"},uirevision:{valType:"any",editType:"none"},valign:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle",editType:"legend"},title:{text:{valType:"string",dflt:"",editType:"legend"},font:t({editType:"legend"}),side:{valType:"enumerated",values:["top","left","top left"],editType:"legend"},editType:"legend"},editType:"legend"}},{"../../plots/font_attributes":856,"../color/attributes":642}],694:[function(n,z,q){"use strict";z.exports={scrollBarWidth:6,scrollBarMinHeight:20,scrollBarColor:"#808BA4",scrollBarMargin:4,scrollBarEnterAttrs:{rx:20,ry:3,width:0,height:0},titlePad:2,itemGap:5}},{}],695:[function(n,z,q){"use strict";var t=n("../../registry"),h=n("../../lib"),p=n("../../plot_api/plot_template"),l=n("./attributes"),e=n("../../plots/layout_attributes"),o=n("./helpers");z.exports=function(r,i,u){for(var s=r.legend||{},a=0,c=!1,f="normal",g=0;g<u.length;g++){var d=u[g];d.visible&&((d.showlegend||d._dfltShowLegend&&!(d._module&&d._module.attributes&&d._module.attributes.showlegend&&d._module.attributes.showlegend.dflt===!1))&&(a++,d.showlegend&&(c=!0,(t.traceIs(d,"pie-like")||d._input.showlegend===!0)&&a++)),(t.traceIs(d,"bar")&&i.barmode==="stack"||["tonextx","tonexty"].indexOf(d.fill)!==-1)&&(f=o.isGrouped({traceorder:f})?"grouped+reversed":"reversed"),d.legendgroup!==void 0&&d.legendgroup!==""&&(f=o.isReversed({traceorder:f})?"reversed+grouped":"grouped"))}var m=h.coerce(r,i,e,"showlegend",c&&a>1);if(m!==!1||s.uirevision){var y=p.newContainer(i,"legend");if(E("uirevision",i.uirevision),m!==!1){E("bgcolor",i.paper_bgcolor),E("bordercolor"),E("borderwidth"),h.coerceFont(E,"font",i.font);var v,T,w,A=E("orientation");A==="h"?(v=0,t.getComponentMethod("rangeslider","isVisible")(r.xaxis)?(T=1.1,w="bottom"):(T=-.1,w="top")):(v=1.02,T=1,w="auto"),E("traceorder",f),o.isGrouped(i.legend)&&E("tracegroupgap"),E("itemsizing"),E("itemwidth"),E("itemclick"),E("itemdoubleclick"),E("x",v),E("xanchor"),E("y",T),E("yanchor",w),E("valign"),h.noneOrAll(s,y,["x","y"]),E("title.text")&&(E("title.side",A==="h"?"left":"top"),h.coerceFont(E,"title.font",i.font))}}function E(M,b){return h.coerce(s,y,l,M,b)}}},{"../../lib":778,"../../plot_api/plot_template":817,"../../plots/layout_attributes":882,"../../registry":911,"./attributes":693,"./helpers":699}],696:[function(n,z,q){"use strict";var t=n("d3"),h=n("../../lib"),p=n("../../plots/plots"),l=n("../../registry"),e=n("../../lib/events"),o=n("../dragelement"),r=n("../drawing"),i=n("../color"),u=n("../../lib/svg_text_utils"),s=n("./handle_click"),a=n("./constants"),c=n("../../constants/alignment"),f=c.LINE_SPACING,g=c.FROM_TL,d=c.FROM_BR,m=n("./get_legend_data"),y=n("./style"),v=n("./helpers");function T(S,C,k,L,I){var R=k.data()[0][0].trace,V={event:I,node:k.node(),curveNumber:R.index,expandedIndex:R._expandedIndex,data:S.data,layout:S.layout,frames:S._transitionData._frames,config:S._context,fullData:S._fullData,fullLayout:S._fullLayout};R._group&&(V.group=R._group),l.traceIs(R,"pie-like")&&(V.label=k.datum()[0].label),e.triggerHandler(S,"plotly_legendclick",V)!==!1&&(L===1?C._clickTimeout=setTimeout(function(){s(k,S,L)},S._context.doubleClickDelay):L===2&&(C._clickTimeout&&clearTimeout(C._clickTimeout),S._legendMouseDownTime=0,e.triggerHandler(S,"plotly_legenddoubleclick",V)!==!1&&s(k,S,L)))}function w(S,C,k){var L,I=S.data()[0][0],R=I.trace,V=l.traceIs(R,"pie-like"),O=R.index,J=k._main&&C._context.edits.legendText&&!V,D=k._maxNameLength;k.entries?L=I.text:(L=V?I.label:R.name,R._meta&&(L=h.templateString(L,R._meta)));var B=h.ensureSingle(S,"text","legendtext");B.attr("text-anchor","start").call(r.font,k.font).text(J?A(L,D):L);var N=k.itemwidth+2*a.itemGap;u.positionText(B,N,0),J?B.call(u.makeEditable,{gd:C,text:L}).call(M,S,C,k).on("edit",function(F){this.text(A(F,D)).call(M,S,C,k);var H=I.trace._fullInput||{},j={};if(l.hasTransform(H,"groupby")){var G=l.getTransformIndices(H,"groupby"),W=G[G.length-1],Q=h.keyedContainer(H,"transforms["+W+"].styles","target","value.name");Q.set(I.trace._group,F),j=Q.constructUpdate()}else j.name=F;return l.call("_guiRestyle",C,j,O)}):M(B,S,C,k)}function A(S,C){var k=Math.max(4,C);if(S&&S.trim().length>=k/2)return S;for(var L=k-(S=S||"").length;L>0;L--)S+=" ";return S}function E(S,C){var k,L=C._context.doubleClickDelay,I=1,R=h.ensureSingle(S,"rect","legendtoggle",function(V){C._context.staticPlot||V.style("cursor","pointer").attr("pointer-events","all"),V.call(i.fill,"rgba(0,0,0,0)")});C._context.staticPlot||(R.on("mousedown",function(){(k=new Date().getTime())-C._legendMouseDownTime<L?I+=1:(I=1,C._legendMouseDownTime=k)}),R.on("mouseup",function(){if(!C._dragged&&!C._editing){var V=C._fullLayout.legend;new Date().getTime()-C._legendMouseDownTime>L&&(I=Math.max(I-1,1)),T(C,V,S,I,t.event)}}))}function M(S,C,k,L){L._main||S.attr("data-notex",!0),u.convertToTspans(S,k,function(){(function(I,R,V){var O=I.data()[0][0];if(V._main&&O&&!O.trace.showlegend)return void I.remove();var J=I.select("g[class*=math-group]"),D=J.node();V||(V=R._fullLayout.legend);var B,N,F=V.borderwidth,H=(O?V:V.title).font.size*f;if(D){var j=r.bBox(D);B=j.height,N=j.width,O?r.setTranslate(J,0,.25*B):r.setTranslate(J,F,.75*B+F)}else{var G=I.select(O?".legendtext":".legendtitletext"),W=u.lineCount(G),Q=G.node();B=H*W,N=Q?r.bBox(Q).width:0;var $=H*((W-1)/2-.3);if(O){var ee=V.itemwidth+2*a.itemGap;u.positionText(G,ee,-$)}else u.positionText(G,a.titlePad+F,H+F)}O?(O.lineHeight=H,O.height=Math.max(B,16)+3,O.width=N):(V._titleWidth=N,V._titleHeight=B)})(C,k,L)})}function b(S){return h.isRightAnchor(S)?"right":h.isCenterAnchor(S)?"center":"left"}function _(S){return h.isBottomAnchor(S)?"bottom":h.isMiddleAnchor(S)?"middle":"top"}z.exports=function(S,C){var k,L=S._fullLayout,I="legend"+L._uid;if(C?(k=C.layer,I+="-hover"):((C=L.legend||{})._main=!0,k=L._infolayer),k){var R;if(S._legendMouseDownTime||(S._legendMouseDownTime=0),C._main){if(!S.calcdata)return;R=L.showlegend&&m(S.calcdata,C)}else{if(!C.entries)return;R=m(C.entries,C)}var V=L.hiddenlabels||[];if(C._main&&(!L.showlegend||!R.length))return k.selectAll(".legend").remove(),L._topdefs.select("#"+I).remove(),p.autoMargin(S,"legend");var O=h.ensureSingle(k,"g","legend",function(W){C._main&&W.attr("pointer-events","all")}),J=h.ensureSingleById(L._topdefs,"clipPath",I,function(W){W.append("rect")}),D=h.ensureSingle(O,"rect","bg",function(W){W.attr("shape-rendering","crispEdges")});D.call(i.stroke,C.bordercolor).call(i.fill,C.bgcolor).style("stroke-width",C.borderwidth+"px");var B=h.ensureSingle(O,"g","scrollbox"),N=C.title;if(C._titleWidth=0,C._titleHeight=0,N.text){var F=h.ensureSingle(B,"text","legendtitletext");F.attr("text-anchor","start").call(r.font,N.font).text(N.text),M(F,B,S,C)}else B.selectAll(".legendtitletext").remove();var H=h.ensureSingle(O,"rect","scrollbar",function(W){W.attr(a.scrollBarEnterAttrs).call(i.fill,a.scrollBarColor)}),j=B.selectAll("g.groups").data(R);j.enter().append("g").attr("class","groups"),j.exit().remove();var G=j.selectAll("g.traces").data(h.identity);G.enter().append("g").attr("class","traces"),G.exit().remove(),G.style("opacity",function(W){var Q=W[0].trace;return l.traceIs(Q,"pie-like")?V.indexOf(W[0].label)!==-1?.5:1:Q.visible==="legendonly"?.5:1}).each(function(){t.select(this).call(w,S,C)}).call(y,S,C).each(function(){C._main&&t.select(this).call(E,S)}),h.syncOrAsync([p.previousPromises,function(){return function(W,Q,$,ee){var ie=W._fullLayout;ee||(ee=ie.legend);var ae=ie._size,oe=v.isVertical(ee),de=v.isGrouped(ee),le=ee.borderwidth,fe=2*le,ue=a.itemGap,we=ee.itemwidth+2*ue,Ae=2*(le+ue),Se=_(ee),ke=ee.y<0||ee.y===0&&Se==="top",Me=ee.y>1||ee.y===1&&Se==="bottom";ee._maxHeight=Math.max(ke||Me?ie.height/2:ae.h,30);var ve=0;ee._width=0,ee._height=0;var ge=function(st){var ot=0,Ce=0,Ue=st.title.side;return Ue&&(Ue.indexOf("left")!==-1&&(ot=st._titleWidth),Ue.indexOf("top")!==-1&&(Ce=st._titleHeight)),[ot,Ce]}(ee);if(oe)$.each(function(st){var ot=st[0].height;r.setTranslate(this,le+ge[0],le+ge[1]+ee._height+ot/2+ue),ee._height+=ot,ee._width=Math.max(ee._width,st[0].width)}),ve=we+ee._width,ee._width+=ue+we+fe,ee._height+=Ae,de&&(Q.each(function(st,ot){r.setTranslate(this,0,ot*ee.tracegroupgap)}),ee._height+=(ee._lgroupsLength-1)*ee.tracegroupgap);else{var De=b(ee),_e=ee.x<0||ee.x===0&&De==="right",Pe=ee.x>1||ee.x===1&&De==="left",Fe=Me||ke,ze=ie.width/2;ee._maxWidth=Math.max(_e?Fe&&De==="left"?ae.l+ae.w:ze:Pe?Fe&&De==="right"?ae.r+ae.w:ze:ae.w,2*we);var He=0,et=0;$.each(function(st){var ot=st[0].width+we;He=Math.max(He,ot),et+=ot}),ve=null;var Re=0;if(de){var Ze=0,Ke=0,$e=0;Q.each(function(){var st=0,ot=0;t.select(this).selectAll("g.traces").each(function(Ue){var Ye=Ue[0].height;r.setTranslate(this,ge[0],ge[1]+le+ue+Ye/2+ot),ot+=Ye,st=Math.max(st,we+Ue[0].width)}),Ze=Math.max(Ze,ot);var Ce=st+ue;Ce+le+Ke>ee._maxWidth&&(Re=Math.max(Re,Ke),Ke=0,$e+=Ze+ee.tracegroupgap,Ze=ot),r.setTranslate(this,Ke,$e),Ke+=Ce}),ee._width=Math.max(Re,Ke)+le,ee._height=$e+Ze+Ae}else{var rt=$.size(),at=et+fe+(rt-1)*ue<ee._maxWidth,lt=0,gt=0,Ie=0,be=0;$.each(function(st){var ot=st[0].height,Ce=we+st[0].width,Ue=(at?Ce:He)+ue;Ue+le+gt-ue>=ee._maxWidth&&(Re=Math.max(Re,be),gt=0,Ie+=lt,ee._height+=lt,lt=0),r.setTranslate(this,ge[0]+le+gt,ge[1]+le+Ie+ot/2+ue),be=gt+Ce+ue,gt+=Ue,lt=Math.max(lt,ot)}),at?(ee._width=gt+fe,ee._height=lt+Ae):(ee._width=Math.max(Re,be)+fe,ee._height+=lt+Ae)}}ee._width=Math.ceil(Math.max(ee._width+ge[0],ee._titleWidth+2*(le+a.titlePad))),ee._height=Math.ceil(Math.max(ee._height+ge[1],ee._titleHeight+2*(le+a.itemGap))),ee._effHeight=Math.min(ee._height,ee._maxHeight);var We=W._context.edits,Ge=We.legendText||We.legendPosition;$.each(function(st){var ot=t.select(this).select(".legendtoggle"),Ce=st[0].height,Ue=Ge?we:ve||we+st[0].width;oe||(Ue+=ue/2),r.setRect(ot,0,-Ce/2,Ue,Ce)})}(S,j,G,C)},function(){if(!C._main||!function(ze){var He=ze._fullLayout.legend,et=b(He),Re=_(He);return p.autoMargin(ze,"legend",{x:He.x,y:He.y,l:He._width*g[et],r:He._width*d[et],b:He._effHeight*d[Re],t:He._effHeight*g[Re]})}(S)){var W,Q,$,ee,ie=L._size,ae=C.borderwidth,oe=ie.l+ie.w*C.x-g[b(C)]*C._width,de=ie.t+ie.h*(1-C.y)-g[_(C)]*C._effHeight;if(C._main&&L.margin.autoexpand){var le=oe,fe=de;oe=h.constrain(oe,0,L.width-C._width),de=h.constrain(de,0,L.height-C._effHeight),oe!==le&&h.log("Constrain legend.x to make legend fit inside graph"),de!==fe&&h.log("Constrain legend.y to make legend fit inside graph")}if(C._main&&r.setTranslate(O,oe,de),H.on(".drag",null),O.on("wheel",null),!C._main||C._height<=C._maxHeight||S._context.staticPlot){var ue=C._effHeight;C._main||(ue=C._height),D.attr({width:C._width-ae,height:ue-ae,x:ae/2,y:ae/2}),r.setTranslate(B,0,0),J.select("rect").attr({width:C._width-2*ae,height:ue-2*ae,x:ae,y:ae}),r.setClipUrl(B,I,S),r.setRect(H,0,0,0,0),delete C._scrollY}else{var we,Ae,Se,ke=Math.max(a.scrollBarMinHeight,C._effHeight*C._effHeight/C._height),Me=C._effHeight-ke-2*a.scrollBarMargin,ve=C._height-C._effHeight,ge=Me/ve,De=Math.min(C._scrollY||0,ve);D.attr({width:C._width-2*ae+a.scrollBarWidth+a.scrollBarMargin,height:C._effHeight-ae,x:ae/2,y:ae/2}),J.select("rect").attr({width:C._width-2*ae+a.scrollBarWidth+a.scrollBarMargin,height:C._effHeight-2*ae,x:ae,y:ae+De}),r.setClipUrl(B,I,S),Fe(De,ke,ge),O.on("wheel",function(){Fe(De=h.constrain(C._scrollY+t.event.deltaY/Me*ve,0,ve),ke,ge),De!==0&&De!==ve&&t.event.preventDefault()});var _e=t.behavior.drag().on("dragstart",function(){var ze=t.event.sourceEvent;we=ze.type==="touchstart"?ze.changedTouches[0].clientY:ze.clientY,Se=De}).on("drag",function(){var ze=t.event.sourceEvent;ze.buttons===2||ze.ctrlKey||(Ae=ze.type==="touchmove"?ze.changedTouches[0].clientY:ze.clientY,Fe(De=function(He,et,Re){var Ze=(Re-et)/ge+He;return h.constrain(Ze,0,ve)}(Se,we,Ae),ke,ge))});H.call(_e);var Pe=t.behavior.drag().on("dragstart",function(){var ze=t.event.sourceEvent;ze.type==="touchstart"&&(we=ze.changedTouches[0].clientY,Se=De)}).on("drag",function(){var ze=t.event.sourceEvent;ze.type==="touchmove"&&(Ae=ze.changedTouches[0].clientY,Fe(De=function(He,et,Re){var Ze=(et-Re)/ge+He;return h.constrain(Ze,0,ve)}(Se,we,Ae),ke,ge))});B.call(Pe)}S._context.edits.legendPosition&&(O.classed("cursor-move",!0),o.init({element:O.node(),gd:S,prepFn:function(){var ze=r.getTranslate(O);$=ze.x,ee=ze.y},moveFn:function(ze,He){var et=$+ze,Re=ee+He;r.setTranslate(O,et,Re),W=o.align(et,0,ie.l,ie.l+ie.w,C.xanchor),Q=o.align(Re,0,ie.t+ie.h,ie.t,C.yanchor)},doneFn:function(){W!==void 0&&Q!==void 0&&l.call("_guiRelayout",S,{"legend.x":W,"legend.y":Q})},clickFn:function(ze,He){var et=k.selectAll("g.traces").filter(function(){var Re=this.getBoundingClientRect();return He.clientX>=Re.left&&He.clientX<=Re.right&&He.clientY>=Re.top&&He.clientY<=Re.bottom});et.size()>0&&T(S,O,et,ze,He)}}))}function Fe(ze,He,et){C._scrollY=S._fullLayout.legend._scrollY=ze,r.setTranslate(B,0,-ze),r.setRect(H,C._width,a.scrollBarMargin+ze*et,a.scrollBarWidth,He),J.select("rect").attr("y",ae+ze)}}],S)}}},{"../../constants/alignment":745,"../../lib":778,"../../lib/events":767,"../../lib/svg_text_utils":803,"../../plots/plots":891,"../../registry":911,"../color":643,"../dragelement":662,"../drawing":665,"./constants":694,"./get_legend_data":697,"./handle_click":698,"./helpers":699,"./style":701,d3:169}],697:[function(n,z,q){"use strict";var t=n("../../registry"),h=n("./helpers");z.exports=function(p,l){var e,o,r={},i=[],u=!1,s={},a=0,c=0,f=l._main;function g(M,b){if(M!==""&&h.isGrouped(l))i.indexOf(M)===-1?(i.push(M),u=!0,r[M]=[[b]]):r[M].push([b]);else{var _="~~i"+a;i.push(_),r[_]=[[b]],a++}}for(e=0;e<p.length;e++){var d=p[e],m=d[0],y=m.trace,v=y.legendgroup;if(!f||y.visible&&y.showlegend)if(t.traceIs(y,"pie-like"))for(s[v]||(s[v]={}),o=0;o<d.length;o++){var T=d[o].label;s[v][T]||(g(v,{label:T,color:d[o].color,i:d[o].i,trace:y,pts:d[o].pts}),s[v][T]=!0,c=Math.max(c,(T||"").length))}else g(v,m),c=Math.max(c,(y.name||"").length)}if(!i.length)return[];var w,A,E=i.length;if(u&&h.isGrouped(l))for(A=new Array(E),e=0;e<E;e++)w=r[i[e]],A[e]=h.isReversed(l)?w.reverse():w;else{for(A=[new Array(E)],e=0;e<E;e++)w=r[i[e]][0],A[0][h.isReversed(l)?E-e-1:e]=w;E=1}return l._lgroupsLength=E,l._maxNameLength=c,A}},{"../../registry":911,"./helpers":699}],698:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../../registry"),p=!0;z.exports=function(l,e,o){var r=e._fullLayout;if(!e._dragged&&!e._editing){var i,u=r.legend.itemclick,s=r.legend.itemdoubleclick;if(o===1&&u==="toggle"&&s==="toggleothers"&&p&&e.data&&e._context.showTips&&t.notifier(t._(e,"Double-click on legend to isolate one trace"),"long"),p=!1,o===1?i=u:o===2&&(i=s),i){var a,c,f,g,d,m=r.hiddenlabels?r.hiddenlabels.slice():[],y=l.data()[0][0],v=e._fullData,T=y.trace,w=T.legendgroup,A={},E=[],M=[],b=[];if(h.traceIs(T,"pie-like")){var _=y.label,S=m.indexOf(_);i==="toggle"?S===-1?m.push(_):m.splice(S,1):i==="toggleothers"&&(m=[],e.calcdata[0].forEach(function(j){_!==j.label&&m.push(j.label)}),e._fullLayout.hiddenlabels&&e._fullLayout.hiddenlabels.length===m.length&&S===-1&&(m=[])),h.call("_guiRelayout",e,"hiddenlabels",m)}else{var C,k=w&&w.length,L=[];if(k)for(a=0;a<v.length;a++)(C=v[a]).visible&&C.legendgroup===w&&L.push(a);if(i==="toggle"){var I;switch(T.visible){case!0:I="legendonly";break;case!1:I=!1;break;case"legendonly":I=!0}if(k)for(a=0;a<v.length;a++)v[a].visible!==!1&&v[a].legendgroup===w&&H(v[a],I);else H(T,I)}else if(i==="toggleothers"){var R,V,O,J,D=!0;for(a=0;a<v.length;a++)if(R=v[a]===T,O=v[a].showlegend!==!0,!(R||O||(V=k&&v[a].legendgroup===w)||v[a].visible!==!0||h.traceIs(v[a],"notLegendIsolatable"))){D=!1;break}for(a=0;a<v.length;a++)if(v[a].visible!==!1&&!h.traceIs(v[a],"notLegendIsolatable"))switch(T.visible){case"legendonly":H(v[a],!0);break;case!0:J=!!D||"legendonly",R=v[a]===T,O=v[a].showlegend!==!0&&!v[a].legendgroup,V=R||k&&v[a].legendgroup===w,H(v[a],!(!V&&!O)||J)}}for(a=0;a<M.length;a++)if(f=M[a]){var B=f.constructUpdate(),N=Object.keys(B);for(c=0;c<N.length;c++)g=N[c],(A[g]=A[g]||[])[b[a]]=B[g]}for(d=Object.keys(A),a=0;a<d.length;a++)for(g=d[a],c=0;c<E.length;c++)A[g].hasOwnProperty(c)||(A[g][c]=void 0);h.call("_guiRestyle",e,A,E)}}}function F(j,G,W){var Q=E.indexOf(j),$=A[G];return $||($=A[G]=[]),E.indexOf(j)===-1&&(E.push(j),Q=E.length-1),$[Q]=W,Q}function H(j,G){var W=j._fullInput;if(h.hasTransform(W,"groupby")){var Q=M[W.index];if(!Q){var $=h.getTransformIndices(W,"groupby"),ee=$[$.length-1];Q=t.keyedContainer(W,"transforms["+ee+"].styles","target","value.visible"),M[W.index]=Q}var ie=Q.get(j._group);ie===void 0&&(ie=!0),ie!==!1&&Q.set(j._group,G),b[W.index]=F(W.index,"visible",W.visible!==!1)}else{var ae=W.visible!==!1&&G;F(W.index,"visible",ae)}}}},{"../../lib":778,"../../registry":911}],699:[function(n,z,q){"use strict";q.isGrouped=function(t){return(t.traceorder||"").indexOf("grouped")!==-1},q.isVertical=function(t){return t.orientation!=="h"},q.isReversed=function(t){return(t.traceorder||"").indexOf("reversed")!==-1}},{}],700:[function(n,z,q){"use strict";z.exports={moduleType:"component",name:"legend",layoutAttributes:n("./attributes"),supplyLayoutDefaults:n("./defaults"),draw:n("./draw"),style:n("./style")}},{"./attributes":693,"./defaults":695,"./draw":696,"./style":701}],701:[function(n,z,q){"use strict";var t=n("d3"),h=n("../../registry"),p=n("../../lib"),l=p.strTranslate,e=n("../drawing"),o=n("../color"),r=n("../colorscale/helpers").extractOpts,i=n("../../traces/scatter/subtypes"),u=n("../../traces/pie/style_one"),s=n("../../traces/pie/helpers").castOption,a=n("./constants");function c(f,g){return(g?"radial":"horizontal")+(f?"":"reversed")}z.exports=function(f,g,d){var m=g._fullLayout;d||(d=m.legend);var y=d.itemsizing==="constant",v=d.itemwidth,T=(v+2*a.itemGap)/2,w=l(T,0),A=function(b,_,S,C){var k;if(b+1)k=b;else{if(!(_&&_.width>0))return 0;k=_.width}return y?C:Math.min(k,S)};function E(b,_,S){var C=b[0].trace,k=C.marker||{},L=k.line||{},I=S?C.visible&&C.type===S:h.traceIs(C,"bar"),R=t.select(_).select("g.legendpoints").selectAll("path.legend"+S).data(I?[b]:[]);R.enter().append("path").classed("legend"+S,!0).attr("d","M6,6H-6V-6H6Z").attr("transform",w),R.exit().remove(),R.each(function(V){var O=t.select(this),J=V[0],D=A(J.mlw,k.line,5,2);O.style("stroke-width",D+"px").call(o.fill,J.mc||k.color),D&&o.stroke(O,J.mlc||L.color)})}function M(b,_,S){var C=b[0],k=C.trace,L=S?k.visible&&k.type===S:h.traceIs(k,S),I=t.select(_).select("g.legendpoints").selectAll("path.legend"+S).data(L?[b]:[]);if(I.enter().append("path").classed("legend"+S,!0).attr("d","M6,6H-6V-6H6Z").attr("transform",w),I.exit().remove(),I.size()){var R=(k.marker||{}).line,V=A(s(R.width,C.pts),R,5,2),O=p.minExtend(k,{marker:{line:{width:V}}});O.marker.line.color=R.color;var J=p.minExtend(C,{trace:O});u(I,J,O)}}f.each(function(b){var _=t.select(this),S=p.ensureSingle(_,"g","layers");S.style("opacity",b[0].trace.opacity);var C=d.valign,k=b[0].lineHeight,L=b[0].height;if(C!=="middle"&&k&&L){var I={top:1,bottom:-1}[C]*(.5*(k-L+3));S.attr("transform",l(0,I))}else S.attr("transform",null);S.selectAll("g.legendfill").data([b]).enter().append("g").classed("legendfill",!0),S.selectAll("g.legendlines").data([b]).enter().append("g").classed("legendlines",!0);var R=S.selectAll("g.legendsymbols").data([b]);R.enter().append("g").classed("legendsymbols",!0),R.selectAll("g.legendpoints").data([b]).enter().append("g").classed("legendpoints",!0)}).each(function(b){var _,S=b[0].trace,C=[];if(S.visible)switch(S.type){case"histogram2d":case"heatmap":C=[["M-15,-2V4H15V-2Z"]],_=!0;break;case"choropleth":case"choroplethmapbox":C=[["M-6,-6V6H6V-6Z"]],_=!0;break;case"densitymapbox":C=[["M-6,0 a6,6 0 1,0 12,0 a 6,6 0 1,0 -12,0"]],_="radial";break;case"cone":C=[["M-6,2 A2,2 0 0,0 -6,6 V6L6,4Z"],["M-6,-6 A2,2 0 0,0 -6,-2 L6,-4Z"],["M-6,-2 A2,2 0 0,0 -6,2 L6,0Z"]],_=!1;break;case"streamtube":C=[["M-6,2 A2,2 0 0,0 -6,6 H6 A2,2 0 0,1 6,2 Z"],["M-6,-6 A2,2 0 0,0 -6,-2 H6 A2,2 0 0,1 6,-6 Z"],["M-6,-2 A2,2 0 0,0 -6,2 H6 A2,2 0 0,1 6,-2 Z"]],_=!1;break;case"surface":C=[["M-6,-6 A2,3 0 0,0 -6,0 H6 A2,3 0 0,1 6,-6 Z"],["M-6,1 A2,3 0 0,1 -6,6 H6 A2,3 0 0,0 6,0 Z"]],_=!0;break;case"mesh3d":C=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6H6L0,6Z"]],_=!1;break;case"volume":C=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6H6L0,6Z"]],_=!0;break;case"isosurface":C=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6 A12,24 0 0,0 6,-6 L0,6Z"]],_=!1}var k=t.select(this).select("g.legendpoints").selectAll("path.legend3dandfriends").data(C);k.enter().append("path").classed("legend3dandfriends",!0).attr("transform",w).style("stroke-miterlimit",1),k.exit().remove(),k.each(function(L,I){var R,V=t.select(this),O=r(S),J=O.colorscale,D=O.reversescale;if(J){if(!_){var B=J.length;R=I===0?J[D?B-1:0][1]:I===1?J[D?0:B-1][1]:J[Math.floor((B-1)/2)][1]}}else{var N=S.vertexcolor||S.facecolor||S.color;R=p.isArrayOrTypedArray(N)?N[I]||N[0]:N}V.attr("d",L[0]),R?V.call(o.fill,R):V.call(function(F){if(F.size()){var H="legendfill-"+S.uid;e.gradient(F,g,H,c(D,_==="radial"),J,"fill")}})})}).each(function(b){var _=b[0].trace,S=_.type==="waterfall";if(b[0]._distinct&&S){var C=b[0].trace[b[0].dir].marker;return b[0].mc=C.color,b[0].mlw=C.line.width,b[0].mlc=C.line.color,E(b,this,"waterfall")}var k=[];_.visible&&S&&(k=b[0].hasTotals?[["increasing","M-6,-6V6H0Z"],["totals","M6,6H0L-6,-6H-0Z"],["decreasing","M6,6V-6H0Z"]]:[["increasing","M-6,-6V6H6Z"],["decreasing","M6,6V-6H-6Z"]]);var L=t.select(this).select("g.legendpoints").selectAll("path.legendwaterfall").data(k);L.enter().append("path").classed("legendwaterfall",!0).attr("transform",w).style("stroke-miterlimit",1),L.exit().remove(),L.each(function(I){var R=t.select(this),V=_[I[0]].marker,O=A(void 0,V.line,5,2);R.attr("d",I[1]).style("stroke-width",O+"px").call(o.fill,V.color),O&&R.call(o.stroke,V.line.color)})}).each(function(b){E(b,this,"funnel")}).each(function(b){E(b,this)}).each(function(b){var _=b[0].trace,S=t.select(this).select("g.legendpoints").selectAll("path.legendbox").data(_.visible&&h.traceIs(_,"box-violin")?[b]:[]);S.enter().append("path").classed("legendbox",!0).attr("d","M6,6H-6V-6H6Z").attr("transform",w),S.exit().remove(),S.each(function(){var C=t.select(this);if(_.boxpoints!=="all"&&_.points!=="all"||o.opacity(_.fillcolor)!==0||o.opacity((_.line||{}).color)!==0){var k=A(void 0,_.line,5,2);C.style("stroke-width",k+"px").call(o.fill,_.fillcolor),k&&o.stroke(C,_.line.color)}else{var L=p.minExtend(_,{marker:{size:y?12:p.constrain(_.marker.size,2,16),sizeref:1,sizemin:1,sizemode:"diameter"}});S.call(e.pointStyle,L,g)}})}).each(function(b){M(b,this,"funnelarea")}).each(function(b){M(b,this,"pie")}).each(function(b){var _,S,C=b[0],k=C.trace,L=k.visible&&k.fill&&k.fill!=="none",I=i.hasLines(k),R=k.contours,V=!1,O=!1,J=r(k),D=J.colorscale,B=J.reversescale;if(R){var N=R.coloring;N==="lines"?V=!0:I=N==="none"||N==="heatmap"||R.showlines,R.type==="constraint"?L=R._operation!=="=":N!=="fill"&&N!=="heatmap"||(O=!0)}var F=i.hasMarkers(k)||i.hasText(k),H=L||O,j=I||V,G=F||!H?"M5,0":j?"M5,-2":"M5,-3",W=t.select(this),Q=W.select(".legendfill").selectAll("path").data(L||O?[b]:[]);if(Q.enter().append("path").classed("js-fill",!0),Q.exit().remove(),Q.attr("d",G+"h"+v+"v6h-"+v+"z").call(L?e.fillGroupStyle:function(ie){if(ie.size()){var ae="legendfill-"+k.uid;e.gradient(ie,g,ae,c(B),D,"fill")}}),I||V){var $=A(void 0,k.line,10,5);S=p.minExtend(k,{line:{width:$}}),_=[p.minExtend(C,{trace:S})]}var ee=W.select(".legendlines").selectAll("path").data(I||V?[_]:[]);ee.enter().append("path").classed("js-line",!0),ee.exit().remove(),ee.attr("d",G+(V?"l"+v+",0.0001":"h"+v)).call(I?e.lineGroupStyle:function(ie){if(ie.size()){var ae="legendline-"+k.uid;e.lineGroupStyle(ie),e.gradient(ie,g,ae,c(B),D,"stroke")}})}).each(function(b){var _,S,C=b[0],k=C.trace,L=i.hasMarkers(k),I=i.hasText(k),R=i.hasLines(k);function V(j,G,W,Q){var $=p.nestedProperty(k,j).get(),ee=p.isArrayOrTypedArray($)&&G?G($):$;if(y&&ee&&Q!==void 0&&(ee=Q),W){if(ee<W[0])return W[0];if(ee>W[1])return W[1]}return ee}function O(j){return C._distinct&&C.index&&j[C.index]?j[C.index]:j[0]}if(L||I||R){var J={},D={};if(L){J.mc=V("marker.color",O),J.mx=V("marker.symbol",O),J.mo=V("marker.opacity",p.mean,[.2,1]),J.mlc=V("marker.line.color",O),J.mlw=V("marker.line.width",p.mean,[0,5],2),D.marker={sizeref:1,sizemin:1,sizemode:"diameter"};var B=V("marker.size",p.mean,[2,16],12);J.ms=B,D.marker.size=B}R&&(D.line={width:V("line.width",O,[0,10],5)}),I&&(J.tx="Aa",J.tp=V("textposition",O),J.ts=10,J.tc=V("textfont.color",O),J.tf=V("textfont.family",O)),_=[p.minExtend(C,J)],(S=p.minExtend(k,D)).selectedpoints=null,S.texttemplate=null}var N=t.select(this).select("g.legendpoints"),F=N.selectAll("path.scatterpts").data(L?_:[]);F.enter().insert("path",":first-child").classed("scatterpts",!0).attr("transform",w),F.exit().remove(),F.call(e.pointStyle,S,g),L&&(_[0].mrc=3);var H=N.selectAll("g.pointtext").data(I?_:[]);H.enter().append("g").classed("pointtext",!0).append("text").attr("transform",w),H.exit().remove(),H.selectAll("text").call(e.textPointStyle,S,g)}).each(function(b){var _=b[0].trace,S=t.select(this).select("g.legendpoints").selectAll("path.legendcandle").data(_.visible&&_.type==="candlestick"?[b,b]:[]);S.enter().append("path").classed("legendcandle",!0).attr("d",function(C,k){return k?"M-15,0H-8M-8,6V-6H8Z":"M15,0H8M8,-6V6H-8Z"}).attr("transform",w).style("stroke-miterlimit",1),S.exit().remove(),S.each(function(C,k){var L=t.select(this),I=_[k?"increasing":"decreasing"],R=A(void 0,I.line,5,2);L.style("stroke-width",R+"px").call(o.fill,I.fillcolor),R&&o.stroke(L,I.line.color)})}).each(function(b){var _=b[0].trace,S=t.select(this).select("g.legendpoints").selectAll("path.legendohlc").data(_.visible&&_.type==="ohlc"?[b,b]:[]);S.enter().append("path").classed("legendohlc",!0).attr("d",function(C,k){return k?"M-15,0H0M-8,-6V0":"M15,0H0M8,6V0"}).attr("transform",w).style("stroke-miterlimit",1),S.exit().remove(),S.each(function(C,k){var L=t.select(this),I=_[k?"increasing":"decreasing"],R=A(void 0,I.line,5,2);L.style("fill","none").call(e.dashLine,I.line.dash,R),R&&o.stroke(L,I.line.color)})})}},{"../../lib":778,"../../registry":911,"../../traces/pie/helpers":1166,"../../traces/pie/style_one":1172,"../../traces/scatter/subtypes":1212,"../color":643,"../colorscale/helpers":654,"../drawing":665,"./constants":694,d3:169}],702:[function(n,z,q){"use strict";var t=n("../../registry"),h=n("../../plots/plots"),p=n("../../plots/cartesian/axis_ids"),l=n("../../fonts/ploticon"),e=n("../shapes/draw").eraseActiveShape,o=n("../../lib"),r=o._,i=z.exports={};function u(v,T){var w,A,E=T.currentTarget,M=E.getAttribute("data-attr"),b=E.getAttribute("data-val")||!0,_=v._fullLayout,S={},C=p.list(v,null,!0),k=_._cartesianSpikesEnabled;if(M==="zoom"){var L,I=b==="in"?.5:2,R=(1+I)/2,V=(1-I)/2;for(A=0;A<C.length;A++)if(!(w=C[A]).fixedrange)if(L=w._name,b==="auto")S[L+".autorange"]=!0;else if(b==="reset"){if(w._rangeInitial===void 0)S[L+".autorange"]=!0;else{var O=w._rangeInitial.slice();S[L+".range[0]"]=O[0],S[L+".range[1]"]=O[1]}w._showSpikeInitial!==void 0&&(S[L+".showspikes"]=w._showSpikeInitial,k!=="on"||w._showSpikeInitial||(k="off"))}else{var J=[w.r2l(w.range[0]),w.r2l(w.range[1])],D=[R*J[0]+V*J[1],R*J[1]+V*J[0]];S[L+".range[0]"]=w.l2r(D[0]),S[L+".range[1]"]=w.l2r(D[1])}}else M!=="hovermode"||b!=="x"&&b!=="y"||(b=_._isHoriz?"y":"x",E.setAttribute("data-val",b)),S[M]=b;_._cartesianSpikesEnabled=k,t.call("_guiRelayout",v,S)}function s(v,T){for(var w=T.currentTarget,A=w.getAttribute("data-attr"),E=w.getAttribute("data-val")||!0,M=v._fullLayout._subplots.gl3d||[],b={},_=A.split("."),S=0;S<M.length;S++)b[M[S]+"."+_[1]]=E;var C=E==="pan"?E:"zoom";b.dragmode=C,t.call("_guiRelayout",v,b)}function a(v,T){for(var w=T.currentTarget.getAttribute("data-attr"),A=w==="resetLastSave",E=w==="resetDefault",M=v._fullLayout,b=M._subplots.gl3d||[],_={},S=0;S<b.length;S++){var C,k=b[S],L=k+".camera",I=k+".aspectratio",R=k+".aspectmode",V=M[k]._scene;A?(_[L+".up"]=V.viewInitial.up,_[L+".eye"]=V.viewInitial.eye,_[L+".center"]=V.viewInitial.center,C=!0):E&&(_[L+".up"]=null,_[L+".eye"]=null,_[L+".center"]=null,C=!0),C&&(_[I+".x"]=V.viewInitial.aspectratio.x,_[I+".y"]=V.viewInitial.aspectratio.y,_[I+".z"]=V.viewInitial.aspectratio.z,_[R]=V.viewInitial.aspectmode)}t.call("_guiRelayout",v,_)}function c(v,T){var w=T.currentTarget,A=w._previousVal,E=v._fullLayout,M=E._subplots.gl3d||[],b=["xaxis","yaxis","zaxis"],_={},S={};if(A)S=A,w._previousVal=null;else{for(var C=0;C<M.length;C++){var k=M[C],L=E[k],I=k+".hovermode";_[I]=L.hovermode,S[I]=!1;for(var R=0;R<3;R++){var V=b[R],O=k+"."+V+".showspikes";S[O]=!1,_[O]=L[V].showspikes}}w._previousVal=_}return S}function f(v,T){for(var w=T.currentTarget,A=w.getAttribute("data-attr"),E=w.getAttribute("data-val")||!0,M=v._fullLayout,b=M._subplots.geo||[],_=0;_<b.length;_++){var S=b[_],C=M[S];if(A==="zoom"){var k=C.projection.scale,L=E==="in"?2*k:.5*k;t.call("_guiRelayout",v,S+".projection.scale",L)}}A==="reset"&&y(v,"geo")}function g(v){var T=v._fullLayout;return!T.hovermode&&(T._has("cartesian")?T._isHoriz?"y":"x":"closest")}function d(v){var T=g(v);t.call("_guiRelayout",v,"hovermode",T)}function m(v,T){for(var w=T.currentTarget.getAttribute("data-val"),A=v._fullLayout,E=A._subplots.mapbox||[],M={},b=0;b<E.length;b++){var _=E[b],S=A[_].zoom,C=w==="in"?1.05*S:S/1.05;M[_+".zoom"]=C}t.call("_guiRelayout",v,M)}function y(v,T){for(var w=v._fullLayout,A=w._subplots[T]||[],E={},M=0;M<A.length;M++)for(var b=A[M],_=w[b]._subplot.viewInitial,S=Object.keys(_),C=0;C<S.length;C++){var k=S[C];E[b+"."+k]=_[k]}t.call("_guiRelayout",v,E)}i.toImage={name:"toImage",title:function(v){var T=(v._context.toImageButtonOptions||{}).format||"png";return r(v,T==="png"?"Download plot as a png":"Download plot")},icon:l.camera,click:function(v){var T=v._context.toImageButtonOptions,w={format:T.format||"png"};o.notifier(r(v,"Taking snapshot - this may take a few seconds"),"long"),w.format!=="svg"&&o.isIE()&&(o.notifier(r(v,"IE only supports svg.  Changing format to svg."),"long"),w.format="svg"),["filename","width","height","scale"].forEach(function(A){A in T&&(w[A]=T[A])}),t.call("downloadImage",v,w).then(function(A){o.notifier(r(v,"Snapshot succeeded")+" - "+A,"long")}).catch(function(){o.notifier(r(v,"Sorry, there was a problem downloading your snapshot!"),"long")})}},i.sendDataToCloud={name:"sendDataToCloud",title:function(v){return r(v,"Edit in Chart Studio")},icon:l.disk,click:function(v){h.sendDataToCloud(v)}},i.editInChartStudio={name:"editInChartStudio",title:function(v){return r(v,"Edit in Chart Studio")},icon:l.pencil,click:function(v){h.sendDataToCloud(v)}},i.zoom2d={name:"zoom2d",title:function(v){return r(v,"Zoom")},attr:"dragmode",val:"zoom",icon:l.zoombox,click:u},i.pan2d={name:"pan2d",title:function(v){return r(v,"Pan")},attr:"dragmode",val:"pan",icon:l.pan,click:u},i.select2d={name:"select2d",title:function(v){return r(v,"Box Select")},attr:"dragmode",val:"select",icon:l.selectbox,click:u},i.lasso2d={name:"lasso2d",title:function(v){return r(v,"Lasso Select")},attr:"dragmode",val:"lasso",icon:l.lasso,click:u},i.drawclosedpath={name:"drawclosedpath",title:function(v){return r(v,"Draw closed freeform")},attr:"dragmode",val:"drawclosedpath",icon:l.drawclosedpath,click:u},i.drawopenpath={name:"drawopenpath",title:function(v){return r(v,"Draw open freeform")},attr:"dragmode",val:"drawopenpath",icon:l.drawopenpath,click:u},i.drawline={name:"drawline",title:function(v){return r(v,"Draw line")},attr:"dragmode",val:"drawline",icon:l.drawline,click:u},i.drawrect={name:"drawrect",title:function(v){return r(v,"Draw rectangle")},attr:"dragmode",val:"drawrect",icon:l.drawrect,click:u},i.drawcircle={name:"drawcircle",title:function(v){return r(v,"Draw circle")},attr:"dragmode",val:"drawcircle",icon:l.drawcircle,click:u},i.eraseshape={name:"eraseshape",title:function(v){return r(v,"Erase active shape")},icon:l.eraseshape,click:e},i.zoomIn2d={name:"zoomIn2d",title:function(v){return r(v,"Zoom in")},attr:"zoom",val:"in",icon:l.zoom_plus,click:u},i.zoomOut2d={name:"zoomOut2d",title:function(v){return r(v,"Zoom out")},attr:"zoom",val:"out",icon:l.zoom_minus,click:u},i.autoScale2d={name:"autoScale2d",title:function(v){return r(v,"Autoscale")},attr:"zoom",val:"auto",icon:l.autoscale,click:u},i.resetScale2d={name:"resetScale2d",title:function(v){return r(v,"Reset axes")},attr:"zoom",val:"reset",icon:l.home,click:u},i.hoverClosestCartesian={name:"hoverClosestCartesian",title:function(v){return r(v,"Show closest data on hover")},attr:"hovermode",val:"closest",icon:l.tooltip_basic,gravity:"ne",click:u},i.hoverCompareCartesian={name:"hoverCompareCartesian",title:function(v){return r(v,"Compare data on hover")},attr:"hovermode",val:function(v){return v._fullLayout._isHoriz?"y":"x"},icon:l.tooltip_compare,gravity:"ne",click:u},i.zoom3d={name:"zoom3d",title:function(v){return r(v,"Zoom")},attr:"scene.dragmode",val:"zoom",icon:l.zoombox,click:s},i.pan3d={name:"pan3d",title:function(v){return r(v,"Pan")},attr:"scene.dragmode",val:"pan",icon:l.pan,click:s},i.orbitRotation={name:"orbitRotation",title:function(v){return r(v,"Orbital rotation")},attr:"scene.dragmode",val:"orbit",icon:l["3d_rotate"],click:s},i.tableRotation={name:"tableRotation",title:function(v){return r(v,"Turntable rotation")},attr:"scene.dragmode",val:"turntable",icon:l["z-axis"],click:s},i.resetCameraDefault3d={name:"resetCameraDefault3d",title:function(v){return r(v,"Reset camera to default")},attr:"resetDefault",icon:l.home,click:a},i.resetCameraLastSave3d={name:"resetCameraLastSave3d",title:function(v){return r(v,"Reset camera to last save")},attr:"resetLastSave",icon:l.movie,click:a},i.hoverClosest3d={name:"hoverClosest3d",title:function(v){return r(v,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:l.tooltip_basic,gravity:"ne",click:function(v,T){var w=c(v,T);t.call("_guiRelayout",v,w)}},i.zoomInGeo={name:"zoomInGeo",title:function(v){return r(v,"Zoom in")},attr:"zoom",val:"in",icon:l.zoom_plus,click:f},i.zoomOutGeo={name:"zoomOutGeo",title:function(v){return r(v,"Zoom out")},attr:"zoom",val:"out",icon:l.zoom_minus,click:f},i.resetGeo={name:"resetGeo",title:function(v){return r(v,"Reset")},attr:"reset",val:null,icon:l.autoscale,click:f},i.hoverClosestGeo={name:"hoverClosestGeo",title:function(v){return r(v,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:l.tooltip_basic,gravity:"ne",click:d},i.hoverClosestGl2d={name:"hoverClosestGl2d",title:function(v){return r(v,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:l.tooltip_basic,gravity:"ne",click:d},i.hoverClosestPie={name:"hoverClosestPie",title:function(v){return r(v,"Toggle show closest data on hover")},attr:"hovermode",val:"closest",icon:l.tooltip_basic,gravity:"ne",click:d},i.resetViewSankey={name:"resetSankeyGroup",title:function(v){return r(v,"Reset view")},icon:l.home,click:function(v){for(var T={"node.groups":[],"node.x":[],"node.y":[]},w=0;w<v._fullData.length;w++){var A=v._fullData[w]._viewInitial;T["node.groups"].push(A.node.groups.slice()),T["node.x"].push(A.node.x.slice()),T["node.y"].push(A.node.y.slice())}t.call("restyle",v,T)}},i.toggleHover={name:"toggleHover",title:function(v){return r(v,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:l.tooltip_basic,gravity:"ne",click:function(v,T){var w=c(v,T);w.hovermode=g(v),t.call("_guiRelayout",v,w)}},i.resetViews={name:"resetViews",title:function(v){return r(v,"Reset views")},icon:l.home,click:function(v,T){var w=T.currentTarget;w.setAttribute("data-attr","zoom"),w.setAttribute("data-val","reset"),u(v,T),w.setAttribute("data-attr","resetLastSave"),a(v,T),y(v,"geo"),y(v,"mapbox")}},i.toggleSpikelines={name:"toggleSpikelines",title:function(v){return r(v,"Toggle Spike Lines")},icon:l.spikeline,attr:"_cartesianSpikesEnabled",val:"on",click:function(v){var T=v._fullLayout,w=T._cartesianSpikesEnabled;T._cartesianSpikesEnabled=w==="on"?"off":"on",t.call("_guiRelayout",v,function(A){for(var E=A._fullLayout._cartesianSpikesEnabled==="on",M=p.list(A,null,!0),b={},_=0;_<M.length;_++){var S=M[_];b[S._name+".showspikes"]=!!E||S._showSpikeInitial}return b}(v))}},i.resetViewMapbox={name:"resetViewMapbox",title:function(v){return r(v,"Reset view")},attr:"reset",icon:l.home,click:function(v){y(v,"mapbox")}},i.zoomInMapbox={name:"zoomInMapbox",title:function(v){return r(v,"Zoom in")},attr:"zoom",val:"in",icon:l.zoom_plus,click:m},i.zoomOutMapbox={name:"zoomOutMapbox",title:function(v){return r(v,"Zoom out")},attr:"zoom",val:"out",icon:l.zoom_minus,click:m}},{"../../fonts/ploticon":757,"../../lib":778,"../../plots/cartesian/axis_ids":831,"../../plots/plots":891,"../../registry":911,"../shapes/draw":724}],703:[function(n,z,q){"use strict";q.manage=n("./manage")},{"./manage":704}],704:[function(n,z,q){"use strict";var t=n("../../plots/cartesian/axis_ids"),h=n("../../traces/scatter/subtypes"),p=n("../../registry"),l=n("../fx/helpers").isUnifiedHover,e=n("./modebar"),o=n("./buttons");z.exports=function(i){var u=i._fullLayout,s=i._context,a=u._modeBar;if(s.displayModeBar||s.watermark){if(!Array.isArray(s.modeBarButtonsToRemove))throw new Error(["*modeBarButtonsToRemove* configuration options","must be an array."].join(" "));if(!Array.isArray(s.modeBarButtonsToAdd))throw new Error(["*modeBarButtonsToAdd* configuration options","must be an array."].join(" "));var c,f=s.modeBarButtons;c=Array.isArray(f)&&f.length?function(g){for(var d=0;d<g.length;d++)for(var m=g[d],y=0;y<m.length;y++){var v=m[y];if(typeof v=="string"){if(o[v]===void 0)throw new Error(["*modeBarButtons* configuration options","invalid button name"].join(" "));g[d][y]=o[v]}}return g}(f):!s.displayModeBar&&s.watermark?[]:function(g){var d=g._fullLayout,m=g._fullData,y=g._context,v=y.modeBarButtonsToRemove,T=y.modeBarButtonsToAdd,w=d._has("cartesian"),A=d._has("gl3d"),E=d._has("geo"),M=d._has("pie"),b=d._has("funnelarea"),_=d._has("gl2d"),S=d._has("ternary"),C=d._has("mapbox"),k=d._has("polar"),L=d._has("sankey"),I=function(W){for(var Q=t.list({_fullLayout:W},null,!0),$=0;$<Q.length;$++)if(!Q[$].fixedrange)return!1;return!0}(d),R=l(d.hovermode),V=[];function O(W){if(W.length){for(var Q=[],$=0;$<W.length;$++){var ee=W[$];v.indexOf(ee)===-1&&Q.push(o[ee])}V.push(Q)}}var J=["toImage"];y.showEditInChartStudio?J.push("editInChartStudio"):y.showSendToCloud&&J.push("sendDataToCloud"),O(J);var D=[],B=[],N=[],F=[];if((w||_||M||b||S)+E+A+C+k>1?(B=["toggleHover"],N=["resetViews"]):E?(D=["zoomInGeo","zoomOutGeo"],B=["hoverClosestGeo"],N=["resetGeo"]):A?(B=["hoverClosest3d"],N=["resetCameraDefault3d","resetCameraLastSave3d"]):C?(D=["zoomInMapbox","zoomOutMapbox"],B=["toggleHover"],N=["resetViewMapbox"]):_?B=["hoverClosestGl2d"]:M?B=["hoverClosestPie"]:L?(B=["hoverClosestCartesian","hoverCompareCartesian"],N=["resetViewSankey"]):B=["toggleHover"],w&&(B=["toggleSpikelines","hoverClosestCartesian","hoverCompareCartesian"]),(function(W){for(var Q=0;Q<W.length;Q++)if(!p.traceIs(W[Q],"noHover"))return!1;return!0}(m)||R)&&(B=[]),!w&&!_||I||(D=["zoomIn2d","zoomOut2d","autoScale2d"],N[0]!=="resetViews"&&(N=["resetScale2d"])),A?F=["zoom3d","pan3d","orbitRotation","tableRotation"]:(w||_)&&!I||S?F=["zoom2d","pan2d"]:C||E?F=["pan2d"]:k&&(F=["zoom2d"]),function(W){for(var Q=!1,$=0;$<W.length&&!Q;$++){var ee=W[$];ee._module&&ee._module.selectPoints&&(p.traceIs(ee,"scatter-like")?(h.hasMarkers(ee)||h.hasText(ee))&&(Q=!0):p.traceIs(ee,"box-violin")&&ee.boxpoints!=="all"&&ee.points!=="all"||(Q=!0))}return Q}(m)&&F.push("select2d","lasso2d"),Array.isArray(T)){for(var H=[],j=0;j<T.length;j++){var G=T[j];typeof G=="string"?r.indexOf(G)!==-1&&(d._has("mapbox")||d._has("cartesian"))&&F.push(G):H.push(G)}T=H}return O(F),O(D.concat(N)),O(B),function(W,Q){if(Q.length)if(Array.isArray(Q[0]))for(var $=0;$<Q.length;$++)W.push(Q[$]);else W.push(Q);return W}(V,T)}(i),a?a.update(i,c):u._modeBar=e(i,c)}else a&&(a.destroy(),delete u._modeBar)};var r=["drawline","drawopenpath","drawclosedpath","drawcircle","drawrect","eraseshape"]},{"../../plots/cartesian/axis_ids":831,"../../registry":911,"../../traces/scatter/subtypes":1212,"../fx/helpers":679,"./buttons":702,"./modebar":705}],705:[function(n,z,q){"use strict";var t=n("d3"),h=n("fast-isnumeric"),p=n("../../lib"),l=n("../../fonts/ploticon"),e=new DOMParser;function o(i){this.container=i.container,this.element=document.createElement("div"),this.update(i.graphInfo,i.buttons),this.container.appendChild(this.element)}var r=o.prototype;r.update=function(i,u){this.graphInfo=i;var s=this.graphInfo._context,a=this.graphInfo._fullLayout,c="modebar-"+a._uid;this.element.setAttribute("id",c),this._uid=c,this.element.className="modebar",s.displayModeBar==="hover"&&(this.element.className+=" modebar--hover ease-bg"),a.modebar.orientation==="v"&&(this.element.className+=" vertical",u=u.reverse());var f=a.modebar,g=s.displayModeBar==="hover"?".js-plotly-plot .plotly:hover ":"";p.deleteRelatedStyleRule(c),p.addRelatedStyleRule(c,g+"#"+c+" .modebar-group","background-color: "+f.bgcolor),p.addRelatedStyleRule(c,"#"+c+" .modebar-btn .icon path","fill: "+f.color),p.addRelatedStyleRule(c,"#"+c+" .modebar-btn:hover .icon path","fill: "+f.activecolor),p.addRelatedStyleRule(c,"#"+c+" .modebar-btn.active .icon path","fill: "+f.activecolor);var d=!this.hasButtons(u),m=this.hasLogo!==s.displaylogo,y=this.locale!==s.locale;if(this.locale=s.locale,(d||m||y)&&(this.removeAllButtons(),this.updateButtons(u),s.watermark||s.displaylogo)){var v=this.getLogo();s.watermark&&(v.className=v.className+" watermark"),a.modebar.orientation==="v"?this.element.insertBefore(v,this.element.childNodes[0]):this.element.appendChild(v),this.hasLogo=!0}this.updateActiveButton()},r.updateButtons=function(i){var u=this;this.buttons=i,this.buttonElements=[],this.buttonsNames=[],this.buttons.forEach(function(s){var a=u.createGroup();s.forEach(function(c){var f=c.name;if(!f)throw new Error("must provide button 'name' in button config");if(u.buttonsNames.indexOf(f)!==-1)throw new Error("button name '"+f+"' is taken");u.buttonsNames.push(f);var g=u.createButton(c);u.buttonElements.push(g),a.appendChild(g)}),u.element.appendChild(a)})},r.createGroup=function(){var i=document.createElement("div");return i.className="modebar-group",i},r.createButton=function(i){var u=this,s=document.createElement("a");s.setAttribute("rel","tooltip"),s.className="modebar-btn";var a=i.title;a===void 0?a=i.name:typeof a=="function"&&(a=a(this.graphInfo)),(a||a===0)&&s.setAttribute("data-title",a),i.attr!==void 0&&s.setAttribute("data-attr",i.attr);var c=i.val;if(c!==void 0&&(typeof c=="function"&&(c=c(this.graphInfo)),s.setAttribute("data-val",c)),typeof i.click!="function")throw new Error("must provide button 'click' function in button config");s.addEventListener("click",function(g){i.click(u.graphInfo,g),u.updateActiveButton(g.currentTarget)}),s.setAttribute("data-toggle",i.toggle||!1),i.toggle&&t.select(s).classed("active",!0);var f=i.icon;return typeof f=="function"?s.appendChild(f()):s.appendChild(this.createIcon(f||l.question)),s.setAttribute("data-gravity",i.gravity||"n"),s},r.createIcon=function(i){var u,s=h(i.height)?Number(i.height):i.ascent-i.descent,a="http://www.w3.org/2000/svg";if(i.path){(u=document.createElementNS(a,"svg")).setAttribute("viewBox",[0,0,i.width,s].join(" ")),u.setAttribute("class","icon");var c=document.createElementNS(a,"path");c.setAttribute("d",i.path),i.transform?c.setAttribute("transform",i.transform):i.ascent!==void 0&&c.setAttribute("transform","matrix(1 0 0 -1 0 "+i.ascent+")"),u.appendChild(c)}return i.svg&&(u=e.parseFromString(i.svg,"application/xml").childNodes[0]),u.setAttribute("height","1em"),u.setAttribute("width","1em"),u},r.updateActiveButton=function(i){var u=this.graphInfo._fullLayout,s=i!==void 0?i.getAttribute("data-attr"):null;this.buttonElements.forEach(function(a){var c=a.getAttribute("data-val")||!0,f=a.getAttribute("data-attr"),g=a.getAttribute("data-toggle")==="true",d=t.select(a);if(g)f===s&&d.classed("active",!d.classed("active"));else{var m=f===null?f:p.nestedProperty(u,f).get();d.classed("active",m===c)}})},r.hasButtons=function(i){var u=this.buttons;if(!u||i.length!==u.length)return!1;for(var s=0;s<i.length;++s){if(i[s].length!==u[s].length)return!1;for(var a=0;a<i[s].length;a++)if(i[s][a].name!==u[s][a].name)return!1}return!0},r.getLogo=function(){var i=this.createGroup(),u=document.createElement("a");return u.href="https://plotly.com/",u.target="_blank",u.setAttribute("data-title",p._(this.graphInfo,"Produced with Plotly")),u.className="modebar-btn plotlyjsicon modebar-btn--logo",u.appendChild(this.createIcon(l.newplotlylogo)),i.appendChild(u),i},r.removeAllButtons=function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.hasLogo=!1},r.destroy=function(){p.removeElement(this.container.querySelector(".modebar")),p.deleteRelatedStyleRule(this._uid)},z.exports=function(i,u){var s=i._fullLayout,a=new o({graphInfo:i,container:s._modebardiv.node(),buttons:u});return s._privateplot&&t.select(a.element).append("span").classed("badge-private float--left",!0).text("PRIVATE"),a}},{"../../fonts/ploticon":757,"../../lib":778,d3:169,"fast-isnumeric":241}],706:[function(n,z,q){"use strict";var t=n("../../plots/font_attributes"),h=n("../color/attributes"),p=(0,n("../../plot_api/plot_template").templatedArray)("button",{visible:{valType:"boolean",dflt:!0,editType:"plot"},step:{valType:"enumerated",values:["month","year","day","hour","minute","second","all"],dflt:"month",editType:"plot"},stepmode:{valType:"enumerated",values:["backward","todate"],dflt:"backward",editType:"plot"},count:{valType:"number",min:0,dflt:1,editType:"plot"},label:{valType:"string",editType:"plot"},editType:"plot"});z.exports={visible:{valType:"boolean",editType:"plot"},buttons:p,x:{valType:"number",min:-2,max:3,editType:"plot"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left",editType:"plot"},y:{valType:"number",min:-2,max:3,editType:"plot"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"bottom",editType:"plot"},font:t({editType:"plot"}),bgcolor:{valType:"color",dflt:h.lightLine,editType:"plot"},activecolor:{valType:"color",editType:"plot"},bordercolor:{valType:"color",dflt:h.defaultLine,editType:"plot"},borderwidth:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"plot"}},{"../../plot_api/plot_template":817,"../../plots/font_attributes":856,"../color/attributes":642}],707:[function(n,z,q){"use strict";z.exports={yPad:.02,minButtonWidth:30,rx:3,ry:3,lightAmount:25,darkAmount:10}},{}],708:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../color"),p=n("../../plot_api/plot_template"),l=n("../../plots/array_container_defaults"),e=n("./attributes"),o=n("./constants");function r(i,u,s,a){var c=a.calendar;function f(d,m){return t.coerce(i,u,e.buttons,d,m)}if(f("visible")){var g=f("step");g!=="all"&&(!c||c==="gregorian"||g!=="month"&&g!=="year"?f("stepmode"):u.stepmode="backward",f("count")),f("label")}}z.exports=function(i,u,s,a,c){var f=i.rangeselector||{},g=p.newContainer(u,"rangeselector");function d(v,T){return t.coerce(f,g,e,v,T)}if(d("visible",l(f,g,{name:"buttons",handleItemDefaults:r,calendar:c}).length>0)){var m=function(v,T,w){for(var A=w.filter(function(_){return T[_].anchor===v._id}),E=0,M=0;M<A.length;M++){var b=T[A[M]].domain;b&&(E=Math.max(b[1],E))}return[v.domain[0],E+o.yPad]}(u,s,a);d("x",m[0]),d("y",m[1]),t.noneOrAll(i,u,["x","y"]),d("xanchor"),d("yanchor"),t.coerceFont(d,"font",s.font);var y=d("bgcolor");d("activecolor",h.contrast(y,o.lightAmount,o.darkAmount)),d("bordercolor"),d("borderwidth")}}},{"../../lib":778,"../../plot_api/plot_template":817,"../../plots/array_container_defaults":823,"../color":643,"./attributes":706,"./constants":707}],709:[function(n,z,q){"use strict";var t=n("d3"),h=n("../../registry"),p=n("../../plots/plots"),l=n("../color"),e=n("../drawing"),o=n("../../lib"),r=o.strTranslate,i=n("../../lib/svg_text_utils"),u=n("../../plots/cartesian/axis_ids"),s=n("../../constants/alignment"),a=s.LINE_SPACING,c=s.FROM_TL,f=s.FROM_BR,g=n("./constants"),d=n("./get_update_object");function m(T){return T._id}function y(T,w,A){var E=o.ensureSingle(T,"rect","selector-rect",function(M){M.attr("shape-rendering","crispEdges")});E.attr({rx:g.rx,ry:g.ry}),E.call(l.stroke,w.bordercolor).call(l.fill,function(M,b){return b._isActive||b._isHovered?M.activecolor:M.bgcolor}(w,A)).style("stroke-width",w.borderwidth+"px")}function v(T,w,A,E){o.ensureSingle(T,"text","selector-text",function(M){M.attr("text-anchor","middle")}).call(e.font,w.font).text(function(M,b){return M.label?b?o.templateString(M.label,b):M.label:M.step==="all"?"all":M.count+M.step.charAt(0)}(A,E._fullLayout._meta)).call(function(M){i.convertToTspans(M,E)})}z.exports=function(T){var w=T._fullLayout._infolayer.selectAll(".rangeselector").data(function(A){for(var E=u.list(A,"x",!0),M=[],b=0;b<E.length;b++){var _=E[b];_.rangeselector&&_.rangeselector.visible&&M.push(_)}return M}(T),m);w.enter().append("g").classed("rangeselector",!0),w.exit().remove(),w.style({cursor:"pointer","pointer-events":"all"}),w.each(function(A){var E=t.select(this),M=A,b=M.rangeselector,_=E.selectAll("g.button").data(o.filterVisible(b.buttons));_.enter().append("g").classed("button",!0),_.exit().remove(),_.each(function(S){var C=t.select(this),k=d(M,S);S._isActive=function(L,I,R){if(I.step==="all")return L.autorange===!0;var V=Object.keys(R);return L.range[0]===R[V[0]]&&L.range[1]===R[V[1]]}(M,S,k),C.call(y,b,S),C.call(v,b,S,T),C.on("click",function(){T._dragged||h.call("_guiRelayout",T,k)}),C.on("mouseover",function(){S._isHovered=!0,C.call(y,b,S)}),C.on("mouseout",function(){S._isHovered=!1,C.call(y,b,S)})}),function(S,C,k,L,I){var R=0,V=0,O=k.borderwidth;C.each(function(){var H=t.select(this).select(".selector-text"),j=k.font.size*a,G=Math.max(j*i.lineCount(H),16)+3;V=Math.max(V,G)}),C.each(function(){var H=t.select(this),j=H.select(".selector-rect"),G=H.select(".selector-text"),W=G.node()&&e.bBox(G.node()).width,Q=k.font.size*a,$=i.lineCount(G),ee=Math.max(W+10,g.minButtonWidth);H.attr("transform",r(O+R,O)),j.attr({x:0,y:0,width:ee,height:V}),i.positionText(G,ee/2,V/2-($-1)*Q/2+3),R+=ee+5});var J=S._fullLayout._size,D=J.l+J.w*k.x,B=J.t+J.h*(1-k.y),N="left";o.isRightAnchor(k)&&(D-=R,N="right"),o.isCenterAnchor(k)&&(D-=R/2,N="center");var F="top";o.isBottomAnchor(k)&&(B-=V,F="bottom"),o.isMiddleAnchor(k)&&(B-=V/2,F="middle"),R=Math.ceil(R),V=Math.ceil(V),D=Math.round(D),B=Math.round(B),p.autoMargin(S,L+"-range-selector",{x:k.x,y:k.y,l:R*c[N],r:R*f[N],b:V*f[F],t:V*c[F]}),I.attr("transform",r(D,B))}(T,_,b,M._name,E)})}},{"../../constants/alignment":745,"../../lib":778,"../../lib/svg_text_utils":803,"../../plots/cartesian/axis_ids":831,"../../plots/plots":891,"../../registry":911,"../color":643,"../drawing":665,"./constants":707,"./get_update_object":710,d3:169}],710:[function(n,z,q){"use strict";var t=n("d3");z.exports=function(h,p){var l=h._name,e={};if(p.step==="all")e[l+".autorange"]=!0;else{var o=function(r,i){var u,s=r.range,a=new Date(r.r2l(s[1])),c=i.step,f=i.count;switch(i.stepmode){case"backward":u=r.l2r(+t.time[c].utc.offset(a,-f));break;case"todate":var g=t.time[c].utc.offset(a,-f);u=r.l2r(+t.time[c].utc.ceil(g))}var d=s[1];return[u,d]}(h,p);e[l+".range[0]"]=o[0],e[l+".range[1]"]=o[1]}return e}},{d3:169}],711:[function(n,z,q){"use strict";z.exports={moduleType:"component",name:"rangeselector",schema:{subplots:{xaxis:{rangeselector:n("./attributes")}}},layoutAttributes:n("./attributes"),handleDefaults:n("./defaults"),draw:n("./draw")}},{"./attributes":706,"./defaults":708,"./draw":709}],712:[function(n,z,q){"use strict";var t=n("../color/attributes");z.exports={bgcolor:{valType:"color",dflt:t.background,editType:"plot"},bordercolor:{valType:"color",dflt:t.defaultLine,editType:"plot"},borderwidth:{valType:"integer",dflt:0,min:0,editType:"plot"},autorange:{valType:"boolean",dflt:!0,editType:"calc",impliedEdits:{"range[0]":void 0,"range[1]":void 0}},range:{valType:"info_array",items:[{valType:"any",editType:"calc",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"calc",impliedEdits:{"^autorange":!1}}],editType:"calc",impliedEdits:{autorange:!1}},thickness:{valType:"number",dflt:.15,min:0,max:1,editType:"plot"},visible:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"}},{"../color/attributes":642}],713:[function(n,z,q){"use strict";var t=n("../../plots/cartesian/axis_ids").list,h=n("../../plots/cartesian/autorange").getAutoRange,p=n("./constants");z.exports=function(l){for(var e=t(l,"x",!0),o=0;o<e.length;o++){var r=e[o],i=r[p.name];i&&i.visible&&i.autorange&&(i._input.autorange=!0,i._input.range=i.range=h(l,r))}}},{"../../plots/cartesian/autorange":827,"../../plots/cartesian/axis_ids":831,"./constants":714}],714:[function(n,z,q){"use strict";z.exports={name:"rangeslider",containerClassName:"rangeslider-container",bgClassName:"rangeslider-bg",rangePlotClassName:"rangeslider-rangeplot",maskMinClassName:"rangeslider-mask-min",maskMaxClassName:"rangeslider-mask-max",slideBoxClassName:"rangeslider-slidebox",grabberMinClassName:"rangeslider-grabber-min",grabAreaMinClassName:"rangeslider-grabarea-min",handleMinClassName:"rangeslider-handle-min",grabberMaxClassName:"rangeslider-grabber-max",grabAreaMaxClassName:"rangeslider-grabarea-max",handleMaxClassName:"rangeslider-handle-max",maskMinOppAxisClassName:"rangeslider-mask-min-opp-axis",maskMaxOppAxisClassName:"rangeslider-mask-max-opp-axis",maskColor:"rgba(0,0,0,0.4)",maskOppAxisColor:"rgba(0,0,0,0.2)",slideBoxFill:"transparent",slideBoxCursor:"ew-resize",grabAreaFill:"transparent",grabAreaCursor:"col-resize",grabAreaWidth:10,handleWidth:4,handleRadius:1,handleStrokeWidth:1,extraPad:15}},{}],715:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../../plot_api/plot_template"),p=n("../../plots/cartesian/axis_ids"),l=n("./attributes"),e=n("./oppaxis_attributes");z.exports=function(o,r,i){var u=o[i],s=r[i];if(u.rangeslider||r._requestRangeslider[s._id]){t.isPlainObject(u.rangeslider)||(u.rangeslider={});var a,c,f=u.rangeslider,g=h.newContainer(s,"rangeslider");if(E("visible")){E("bgcolor",r.plot_bgcolor),E("bordercolor"),E("borderwidth"),E("thickness"),E("autorange",!s.isValidRange(f.range)),E("range");var d=r._subplots;if(d)for(var m=d.cartesian.filter(function(b){return b.substr(0,b.indexOf("y"))===p.name2id(i)}).map(function(b){return b.substr(b.indexOf("y"),b.length)}),y=t.simpleMap(m,p.id2name),v=0;v<y.length;v++){var T=y[v];a=f[T]||{},c=h.newContainer(g,T,"yaxis");var w,A=r[T];a.range&&A.isValidRange(a.range)&&(w="fixed"),M("rangemode",w)!=="match"&&M("range",A.range.slice())}g._input=f}}function E(b,_){return t.coerce(f,g,l,b,_)}function M(b,_){return t.coerce(a,c,e,b,_)}}},{"../../lib":778,"../../plot_api/plot_template":817,"../../plots/cartesian/axis_ids":831,"./attributes":712,"./oppaxis_attributes":719}],716:[function(n,z,q){"use strict";var t=n("d3"),h=n("../../registry"),p=n("../../plots/plots"),l=n("../../lib"),e=l.strTranslate,o=n("../drawing"),r=n("../color"),i=n("../titles"),u=n("../../plots/cartesian"),s=n("../../plots/cartesian/axis_ids"),a=n("../dragelement"),c=n("../../lib/setcursor"),f=n("./constants");function g(w,A,E,M){var b=l.ensureSingle(w,"rect",f.bgClassName,function(k){k.attr({x:0,y:0,"shape-rendering":"crispEdges"})}),_=M.borderwidth%2==0?M.borderwidth:M.borderwidth-1,S=-M._offsetShift,C=o.crispRound(A,M.borderwidth);b.attr({width:M._width+_,height:M._height+_,transform:e(S,S),fill:M.bgcolor,stroke:M.bordercolor,"stroke-width":C})}function d(w,A,E,M){var b=A._fullLayout;l.ensureSingleById(b._topdefs,"clipPath",M._clipId,function(_){_.append("rect").attr({x:0,y:0})}).select("rect").attr({width:M._width,height:M._height})}function m(w,A,E,M){var b,_=A.calcdata,S=w.selectAll("g."+f.rangePlotClassName).data(E._subplotsWith,l.identity);S.enter().append("g").attr("class",function(C){return f.rangePlotClassName+" "+C}).call(o.setClipUrl,M._clipId,A),S.order(),S.exit().remove(),S.each(function(C,k){var L=t.select(this),I=k===0,R=s.getFromId(A,C,"y"),V=R._name,O=M[V],J={data:[],layout:{xaxis:{type:E.type,domain:[0,1],range:M.range.slice(),calendar:E.calendar},width:M._width,height:M._height,margin:{t:0,b:0,l:0,r:0}},_context:A._context};E.rangebreaks&&(J.layout.xaxis.rangebreaks=E.rangebreaks),J.layout[V]={type:R.type,domain:[0,1],range:O.rangemode!=="match"?O.range.slice():R.range.slice(),calendar:R.calendar},R.rangebreaks&&(J.layout[V].rangebreaks=R.rangebreaks),p.supplyDefaults(J);var D=J._fullLayout.xaxis,B=J._fullLayout[V];D.clearCalc(),D.setScale(),B.clearCalc(),B.setScale();var N={id:C,plotgroup:L,xaxis:D,yaxis:B,isRangePlot:!0};I?b=N:(N.mainplot="xy",N.mainplotinfo=b),u.rangePlot(A,N,function(F,H){for(var j=[],G=0;G<F.length;G++){var W=F[G],Q=W[0].trace;Q.xaxis+Q.yaxis===H&&j.push(W)}return j}(_,C))})}function y(w,A,E,M,b){l.ensureSingle(w,"rect",f.maskMinClassName,function(_){_.attr({x:0,y:0,"shape-rendering":"crispEdges"})}).attr("height",M._height).call(r.fill,f.maskColor),l.ensureSingle(w,"rect",f.maskMaxClassName,function(_){_.attr({y:0,"shape-rendering":"crispEdges"})}).attr("height",M._height).call(r.fill,f.maskColor),b.rangemode!=="match"&&(l.ensureSingle(w,"rect",f.maskMinOppAxisClassName,function(_){_.attr({y:0,"shape-rendering":"crispEdges"})}).attr("width",M._width).call(r.fill,f.maskOppAxisColor),l.ensureSingle(w,"rect",f.maskMaxOppAxisClassName,function(_){_.attr({y:0,"shape-rendering":"crispEdges"})}).attr("width",M._width).style("border-top",f.maskOppBorder).call(r.fill,f.maskOppAxisColor))}function v(w,A,E,M){A._context.staticPlot||l.ensureSingle(w,"rect",f.slideBoxClassName,function(b){b.attr({y:0,cursor:f.slideBoxCursor,"shape-rendering":"crispEdges"})}).attr({height:M._height,fill:f.slideBoxFill})}function T(w,A,E,M){var b=l.ensureSingle(w,"g",f.grabberMinClassName),_=l.ensureSingle(w,"g",f.grabberMaxClassName),S={x:0,width:f.handleWidth,rx:f.handleRadius,fill:r.background,stroke:r.defaultLine,"stroke-width":f.handleStrokeWidth,"shape-rendering":"crispEdges"},C={y:Math.round(M._height/4),height:Math.round(M._height/2)};l.ensureSingle(b,"rect",f.handleMinClassName,function(L){L.attr(S)}).attr(C),l.ensureSingle(_,"rect",f.handleMaxClassName,function(L){L.attr(S)}).attr(C);var k={width:f.grabAreaWidth,x:0,y:0,fill:f.grabAreaFill,cursor:A._context.staticPlot?void 0:f.grabAreaCursor};l.ensureSingle(b,"rect",f.grabAreaMinClassName,function(L){L.attr(k)}).attr("height",M._height),l.ensureSingle(_,"rect",f.grabAreaMaxClassName,function(L){L.attr(k)}).attr("height",M._height)}z.exports=function(w){for(var A=w._fullLayout,E=A._rangeSliderData,M=0;M<E.length;M++){var b=E[M][f.name];b._clipId=b._id+"-"+A._uid}var _=A._infolayer.selectAll("g."+f.containerClassName).data(E,function(S){return S._name});_.exit().each(function(S){var C=S[f.name];A._topdefs.select("#"+C._clipId).remove()}).remove(),E.length!==0&&(_.enter().append("g").classed(f.containerClassName,!0).attr("pointer-events","all"),_.each(function(S){var C=t.select(this),k=S[f.name],L=A[s.id2name(S.anchor)],I=k[s.id2name(S.anchor)];if(k.range){var R,V=l.simpleMap(k.range,S.r2l),O=l.simpleMap(S.range,S.r2l);R=O[0]<O[1]?[Math.min(V[0],O[0]),Math.max(V[1],O[1])]:[Math.max(V[0],O[0]),Math.min(V[1],O[1])],k.range=k._input.range=l.simpleMap(R,S.l2r)}S.cleanRange("rangeslider.range");var J=A._size,D=S.domain;k._width=J.w*(D[1]-D[0]);var B=Math.round(J.l+J.w*D[0]),N=Math.round(J.t+J.h*(1-S._counterDomainMin)+(S.side==="bottom"?S._depth:0)+k._offsetShift+f.extraPad);C.attr("transform",e(B,N)),k._rl=l.simpleMap(k.range,S.r2l);var F=k._rl[0],H=k._rl[1],j=H-F;if(k.p2d=function(de){return de/k._width*j+F},k.d2p=function(de){return(de-F)/j*k._width},S.rangebreaks){var G=S.locateBreaks(F,H);if(G.length){var W,Q,$=0;for(W=0;W<G.length;W++)$+=(Q=G[W]).max-Q.min;var ee=k._width/(H-F-$),ie=[-ee*F];for(W=0;W<G.length;W++)Q=G[W],ie.push(ie[ie.length-1]-ee*(Q.max-Q.min));for(k.d2p=function(de){for(var le=ie[0],fe=0;fe<G.length;fe++){var ue=G[fe];if(de>=ue.max)le=ie[fe+1];else if(de<ue.min)break}return le+ee*de},W=0;W<G.length;W++)(Q=G[W]).pmin=k.d2p(Q.min),Q.pmax=k.d2p(Q.max);k.p2d=function(de){for(var le=ie[0],fe=0;fe<G.length;fe++){var ue=G[fe];if(de>=ue.pmax)le=ie[fe+1];else if(de<ue.pmin)break}return(de-le)/ee}}}if(I.rangemode!=="match"){var ae=L.r2l(I.range[0]),oe=L.r2l(I.range[1])-ae;k.d2pOppAxis=function(de){return(de-ae)/oe*k._height}}C.call(g,w,S,k).call(d,w,S,k).call(m,w,S,k).call(y,w,S,k,I).call(v,w,S,k).call(T,w,S,k),function(de,le,fe,ue){if(le._context.staticPlot)return;var we=de.select("rect."+f.slideBoxClassName).node(),Ae=de.select("rect."+f.grabAreaMinClassName).node(),Se=de.select("rect."+f.grabAreaMaxClassName).node();function ke(){var Me=t.event,ve=Me.target,ge=Me.clientX||Me.touches[0].clientX,De=ge-de.node().getBoundingClientRect().left,_e=ue.d2p(fe._rl[0]),Pe=ue.d2p(fe._rl[1]),Fe=a.coverSlip();function ze(et){var Re,Ze,Ke,$e=+(et.clientX||et.touches[0].clientX)-ge;switch(ve){case we:Ke="ew-resize",Re=_e+$e,Ze=Pe+$e;break;case Ae:Ke="col-resize",Re=_e+$e,Ze=Pe;break;case Se:Ke="col-resize",Re=_e,Ze=Pe+$e;break;default:Ke="ew-resize",Re=De,Ze=De+$e}if(Ze<Re){var rt=Ze;Ze=Re,Re=rt}ue._pixelMin=Re,ue._pixelMax=Ze,c(t.select(Fe),Ke),function(at,lt,gt,Ie){function be(st){return gt.l2r(l.constrain(st,Ie._rl[0],Ie._rl[1]))}var We=be(Ie.p2d(Ie._pixelMin)),Ge=be(Ie.p2d(Ie._pixelMax));window.requestAnimationFrame(function(){h.call("_guiRelayout",lt,gt._name+".range",[We,Ge])})}(0,le,fe,ue)}function He(){Fe.removeEventListener("mousemove",ze),Fe.removeEventListener("mouseup",He),this.removeEventListener("touchmove",ze),this.removeEventListener("touchend",He),l.removeElement(Fe)}this.addEventListener("touchmove",ze),this.addEventListener("touchend",He),Fe.addEventListener("mousemove",ze),Fe.addEventListener("mouseup",He)}de.on("mousedown",ke),de.on("touchstart",ke)}(C,w,S,k),function(de,le,fe,ue,we,Ae){var Se=f.handleWidth/2;function ke(He){return l.constrain(He,0,ue._width)}function Me(He){return l.constrain(He,0,ue._height)}function ve(He){return l.constrain(He,-Se,ue._width+Se)}var ge=ke(ue.d2p(fe._rl[0])),De=ke(ue.d2p(fe._rl[1]));if(de.select("rect."+f.slideBoxClassName).attr("x",ge).attr("width",De-ge),de.select("rect."+f.maskMinClassName).attr("width",ge),de.select("rect."+f.maskMaxClassName).attr("x",De).attr("width",ue._width-De),Ae.rangemode!=="match"){var _e=ue._height-Me(ue.d2pOppAxis(we._rl[1])),Pe=ue._height-Me(ue.d2pOppAxis(we._rl[0]));de.select("rect."+f.maskMinOppAxisClassName).attr("x",ge).attr("height",_e).attr("width",De-ge),de.select("rect."+f.maskMaxOppAxisClassName).attr("x",ge).attr("y",Pe).attr("height",ue._height-Pe).attr("width",De-ge),de.select("rect."+f.slideBoxClassName).attr("y",_e).attr("height",Pe-_e)}var Fe=Math.round(ve(ge-Se))-.5,ze=Math.round(ve(De-Se))+.5;de.select("g."+f.grabberMinClassName).attr("transform",e(Fe,.5)),de.select("g."+f.grabberMaxClassName).attr("transform",e(ze,.5))}(C,0,S,k,L,I),S.side==="bottom"&&i.draw(w,S._id+"title",{propContainer:S,propName:S._name+".title",placeholder:A._dfltTitle.x,attributes:{x:S._offset+S._length/2,y:N+k._height+k._offsetShift+10+1.5*S.title.font.size,"text-anchor":"middle"}})}))}},{"../../lib":778,"../../lib/setcursor":799,"../../plots/cartesian":841,"../../plots/cartesian/axis_ids":831,"../../plots/plots":891,"../../registry":911,"../color":643,"../dragelement":662,"../drawing":665,"../titles":738,"./constants":714,d3:169}],717:[function(n,z,q){"use strict";var t=n("../../plots/cartesian/axis_ids"),h=n("../../lib/svg_text_utils"),p=n("./constants"),l=n("../../constants/alignment").LINE_SPACING,e=p.name;function o(r){var i=r&&r[e];return i&&i.visible}q.isVisible=o,q.makeData=function(r){var i=t.list({_fullLayout:r},"x",!0),u=r.margin,s=[];if(!r._has("gl2d"))for(var a=0;a<i.length;a++){var c=i[a];if(o(c)){s.push(c);var f=c[e];f._id=e+c._id,f._height=(r.height-u.b-u.t)*f.thickness,f._offsetShift=Math.floor(f.borderwidth/2)}}r._rangeSliderData=s},q.autoMarginOpts=function(r,i){var u=r._fullLayout,s=i[e],a=i._id.charAt(0),c=0,f=0;return i.side==="bottom"&&(c=i._depth,i.title.text!==u._dfltTitle[a]&&(f=1.5*i.title.font.size+10+s._offsetShift,f+=(i.title.text.match(h.BR_TAG_ALL)||[]).length*i.title.font.size*l)),{x:0,y:i._counterDomainMin,l:0,r:0,t:0,b:s._height+c+Math.max(u.margin.b,f),pad:p.extraPad+2*s._offsetShift}}},{"../../constants/alignment":745,"../../lib/svg_text_utils":803,"../../plots/cartesian/axis_ids":831,"./constants":714}],718:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("./attributes"),p=n("./oppaxis_attributes"),l=n("./helpers");z.exports={moduleType:"component",name:"rangeslider",schema:{subplots:{xaxis:{rangeslider:t.extendFlat({},h,{yaxis:p})}}},layoutAttributes:n("./attributes"),handleDefaults:n("./defaults"),calcAutorange:n("./calc_autorange"),draw:n("./draw"),isVisible:l.isVisible,makeData:l.makeData,autoMarginOpts:l.autoMarginOpts}},{"../../lib":778,"./attributes":712,"./calc_autorange":713,"./defaults":715,"./draw":716,"./helpers":717,"./oppaxis_attributes":719}],719:[function(n,z,q){"use strict";z.exports={_isSubplotObj:!0,rangemode:{valType:"enumerated",values:["auto","fixed","match"],dflt:"match",editType:"calc"},range:{valType:"info_array",items:[{valType:"any",editType:"plot"},{valType:"any",editType:"plot"}],editType:"plot"},editType:"calc"}},{}],720:[function(n,z,q){"use strict";var t=n("../annotations/attributes"),h=n("../../traces/scatter/attributes").line,p=n("../drawing/attributes").dash,l=n("../../lib/extend").extendFlat,e=n("../../plot_api/plot_template").templatedArray;n("../../constants/axis_placeable_objects"),z.exports=e("shape",{visible:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},type:{valType:"enumerated",values:["circle","rect","path","line"],editType:"calc+arraydraw"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"arraydraw"},xref:l({},t.xref,{}),xsizemode:{valType:"enumerated",values:["scaled","pixel"],dflt:"scaled",editType:"calc+arraydraw"},xanchor:{valType:"any",editType:"calc+arraydraw"},x0:{valType:"any",editType:"calc+arraydraw"},x1:{valType:"any",editType:"calc+arraydraw"},yref:l({},t.yref,{}),ysizemode:{valType:"enumerated",values:["scaled","pixel"],dflt:"scaled",editType:"calc+arraydraw"},yanchor:{valType:"any",editType:"calc+arraydraw"},y0:{valType:"any",editType:"calc+arraydraw"},y1:{valType:"any",editType:"calc+arraydraw"},path:{valType:"string",editType:"calc+arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},line:{color:l({},h.color,{editType:"arraydraw"}),width:l({},h.width,{editType:"calc+arraydraw"}),dash:l({},p,{editType:"arraydraw"}),editType:"calc+arraydraw"},fillcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},fillrule:{valType:"enumerated",values:["evenodd","nonzero"],dflt:"evenodd",editType:"arraydraw"},editable:{valType:"boolean",dflt:!1,editType:"calc+arraydraw"},editType:"arraydraw"})},{"../../constants/axis_placeable_objects":746,"../../lib/extend":768,"../../plot_api/plot_template":817,"../../traces/scatter/attributes":1187,"../annotations/attributes":626,"../drawing/attributes":664}],721:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../../plots/cartesian/axes"),p=n("./constants"),l=n("./helpers");function e(u){return r(u.line.width,u.xsizemode,u.x0,u.x1,u.path,!1)}function o(u){return r(u.line.width,u.ysizemode,u.y0,u.y1,u.path,!0)}function r(u,s,a,c,f,g){var d=u/2,m=g;if(s==="pixel"){var y=f?l.extractPathCoords(f,g?p.paramIsY:p.paramIsX):[a,c],v=t.aggNums(Math.max,null,y),T=t.aggNums(Math.min,null,y),w=T<0?Math.abs(T)+d:d,A=v>0?v+d:d;return{ppad:d,ppadplus:m?w:A,ppadminus:m?A:w}}return{ppad:d}}function i(u,s,a,c,f){var g=u.type==="category"||u.type==="multicategory"?u.r2c:u.d2c;if(s!==void 0)return[g(s),g(a)];if(c){var d,m,y,v,T=1/0,w=-1/0,A=c.match(p.segmentRE);for(u.type==="date"&&(g=l.decodeDate(g)),d=0;d<A.length;d++)(m=f[A[d].charAt(0)].drawn)!==void 0&&(!(y=A[d].substr(1).match(p.paramRE))||y.length<m||((v=g(y[m]))<T&&(T=v),v>w&&(w=v)));return w>=T?[T,w]:void 0}}z.exports=function(u){var s=u._fullLayout,a=t.filterVisible(s.shapes);if(a.length&&u._fullData.length)for(var c=0;c<a.length;c++){var f,g,d=a[c];d._extremes={};var m=h.getRefType(d.xref),y=h.getRefType(d.yref);if(d.xref!=="paper"&&m!=="domain"){var v=d.xsizemode==="pixel"?d.xanchor:d.x0,T=d.xsizemode==="pixel"?d.xanchor:d.x1;(g=i(f=h.getFromId(u,d.xref),v,T,d.path,p.paramIsX))&&(d._extremes[f._id]=h.findExtremes(f,g,e(d)))}if(d.yref!=="paper"&&y!=="domain"){var w=d.ysizemode==="pixel"?d.yanchor:d.y0,A=d.ysizemode==="pixel"?d.yanchor:d.y1;(g=i(f=h.getFromId(u,d.yref),w,A,d.path,p.paramIsY))&&(d._extremes[f._id]=h.findExtremes(f,g,o(d)))}}}},{"../../lib":778,"../../plots/cartesian/axes":828,"./constants":722,"./helpers":731}],722:[function(n,z,q){"use strict";z.exports={segmentRE:/[MLHVQCTSZ][^MLHVQCTSZ]*/g,paramRE:/[^\s,]+/g,paramIsX:{M:{0:!0,drawn:0},L:{0:!0,drawn:0},H:{0:!0,drawn:0},V:{},Q:{0:!0,2:!0,drawn:2},C:{0:!0,2:!0,4:!0,drawn:4},T:{0:!0,drawn:0},S:{0:!0,2:!0,drawn:2},Z:{}},paramIsY:{M:{1:!0,drawn:1},L:{1:!0,drawn:1},H:{},V:{0:!0,drawn:0},Q:{1:!0,3:!0,drawn:3},C:{1:!0,3:!0,5:!0,drawn:5},T:{1:!0,drawn:1},S:{1:!0,3:!0,drawn:5},Z:{}},numParams:{M:2,L:2,H:1,V:1,Q:4,C:6,T:2,S:4,Z:0}}},{}],723:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../../plots/cartesian/axes"),p=n("../../plots/array_container_defaults"),l=n("./attributes"),e=n("./helpers");function o(r,i,u){function s(I,R){return t.coerce(r,i,l,I,R)}if(s("visible")){var a=s("path"),c=s("type",a?"path":"rect");i.type!=="path"&&delete i.path,s("editable"),s("layer"),s("opacity"),s("fillcolor"),s("fillrule"),s("line.width")&&(s("line.color"),s("line.dash"));for(var f=s("xsizemode"),g=s("ysizemode"),d=["x","y"],m=0;m<2;m++){var y,v,T,w=d[m],A=w+"anchor",E=w==="x"?f:g,M={_fullLayout:u},b=h.coerceRef(r,i,M,w,void 0,"paper");if(h.getRefType(b)==="range"?((y=h.getFromId(M,b))._shapeIndices.push(i._index),T=e.rangeToShapePosition(y),v=e.shapePositionToRange(y)):v=T=t.identity,c!=="path"){var _=w+"0",S=w+"1",C=r[_],k=r[S];r[_]=v(r[_],!0),r[S]=v(r[S],!0),E==="pixel"?(s(_,0),s(S,10)):(h.coercePosition(i,M,s,b,_,.25),h.coercePosition(i,M,s,b,S,.75)),i[_]=T(i[_]),i[S]=T(i[S]),r[_]=C,r[S]=k}if(E==="pixel"){var L=r[A];r[A]=v(r[A],!0),h.coercePosition(i,M,s,b,A,.25),i[A]=T(i[A]),r[A]=L}}c==="path"?s("path"):t.noneOrAll(r,i,["x0","x1","y0","y1"])}}z.exports=function(r,i){p(r,i,{name:"shapes",handleItemDefaults:o})}},{"../../lib":778,"../../plots/array_container_defaults":823,"../../plots/cartesian/axes":828,"./attributes":720,"./helpers":731}],724:[function(n,z,q){"use strict";var t=n("../../registry"),h=n("../../lib"),p=n("../../plots/cartesian/axes"),l=n("./draw_newshape/helpers").readPaths,e=n("./draw_newshape/display_outlines"),o=n("../../plots/cartesian/handle_outline").clearOutlineControllers,r=n("../color"),i=n("../drawing"),u=n("../../plot_api/plot_template").arrayEditor,s=n("../dragelement"),a=n("../../lib/setcursor"),c=n("./constants"),f=n("./helpers");function g(E){var M=E._fullLayout;for(var b in M._shapeUpperLayer.selectAll("path").remove(),M._shapeLowerLayer.selectAll("path").remove(),M._plots){var _=M._plots[b].shapelayer;_&&_.selectAll("path").remove()}for(var S=0;S<M.shapes.length;S++)M.shapes[S].visible&&y(E,S)}function d(E){return!!E._fullLayout._drawing}function m(E){return!E._context.edits.shapePosition}function y(E,M){E._fullLayout._paperdiv.selectAll('.shapelayer [data-index="'+M+'"]').remove();var b=f.makeOptionsAndPlotinfo(E,M),_=b.options,S=b.plotinfo;_._input&&_.visible!==!1&&(_.layer!=="below"?C(E._fullLayout._shapeUpperLayer):_.xref==="paper"||_.yref==="paper"?C(E._fullLayout._shapeLowerLayer):S._hadPlotinfo?C((S.mainplotinfo||S).shapelayer):C(E._fullLayout._shapeLowerLayer));function C(k){var L=T(E,_),I={"data-index":M,"fill-rule":_.fillrule,d:L},R=_.opacity,V=_.fillcolor,O=_.line.width?_.line.color:"rgba(0,0,0,0)",J=_.line.width,D=_.line.dash;J||_.editable!==!0||(J=5,D="solid");var B=L[L.length-1]!=="Z",N=m(E)&&_.editable&&E._fullLayout._activeShapeIndex===M;N&&(V=B?"rgba(0,0,0,0)":E._fullLayout.activeshape.fillcolor,R=E._fullLayout.activeshape.opacity);var F,H=k.append("path").attr(I).style("opacity",R).call(r.stroke,O).call(r.fill,V).call(i.dashLine,D,J);if(v(H,E,_),(N||E._context.edits.shapePosition)&&(F=u(E.layout,"shapes",_)),N){H.style({cursor:"move"});var j={element:H.node(),plotinfo:S,gd:E,editHelpers:F,isActiveShape:!0},G=l(L,E);e(G,H,j)}else E._context.edits.shapePosition?function(W,Q,$,ee,ie,ae){var oe,de,le,fe,ue,we,Ae,Se,ke,Me,ve,ge,De,_e,Pe,Fe,ze=$.xsizemode==="pixel",He=$.ysizemode==="pixel",et=$.type==="line",Re=$.type==="path",Ze=ae.modifyItem,Ke=p.getFromId(W,$.xref),$e=p.getRefType($.xref),rt=p.getFromId(W,$.yref),at=p.getRefType($.yref),lt=f.getDataToPixel(W,Ke,!1,$e),gt=f.getDataToPixel(W,rt,!0,at),Ie=f.getPixelToData(W,Ke,!1,$e),be=f.getPixelToData(W,rt,!0,at),We=et?function(){var xe=Math.max($.line.width,10),Ee=ie.append("g").attr("data-index",ee);Ee.append("path").attr("d",Q.attr("d")).style({cursor:"move","stroke-width":xe,"stroke-opacity":"0"});var Je={"fill-opacity":"0"},it=Math.max(xe/2,10);return Ee.append("circle").attr({"data-line-point":"start-point",cx:ze?lt($.xanchor)+$.x0:lt($.x0),cy:He?gt($.yanchor)-$.y0:gt($.y0),r:it}).style(Je).classed("cursor-grab",!0),Ee.append("circle").attr({"data-line-point":"end-point",cx:ze?lt($.xanchor)+$.x1:lt($.x1),cy:He?gt($.yanchor)-$.y1:gt($.y1),r:it}).style(Je).classed("cursor-grab",!0),Ee}():Q,Ge={element:We.node(),gd:W,prepFn:function(xe){d(W)||(ze&&(ue=lt($.xanchor)),He&&(we=gt($.yanchor)),$.type==="path"?Pe=$.path:(oe=ze?$.x0:lt($.x0),de=He?$.y0:gt($.y0),le=ze?$.x1:lt($.x1),fe=He?$.y1:gt($.y1)),oe<le?(ke=oe,De="x0",Me=le,_e="x1"):(ke=le,De="x1",Me=oe,_e="x0"),!He&&de<fe||He&&de>fe?(Ae=de,ve="y0",Se=fe,ge="y1"):(Ae=fe,ve="y1",Se=de,ge="y0"),st(xe),Ue(ie,$),function(Ee,Je,it){var ht=Je.xref,ct=Je.yref,mt=p.getFromId(it,ht),bt=p.getFromId(it,ct),Et="";ht==="paper"||mt.autorange||(Et+=ht),ct==="paper"||bt.autorange||(Et+=ct),i.setClipUrl(Ee,Et?"clip"+it._fullLayout._uid+Et:null,it)}(Q,$,W),Ge.moveFn=Fe==="move"?ot:Ce,Ge.altKey=xe.altKey)},doneFn:function(){d(W)||(a(Q),Ye(ie),v(Q,W,$),t.call("_guiRelayout",W,ae.getUpdateObj()))},clickFn:function(){d(W)||Ye(ie)}};function st(xe){if(d(W))Fe=null;else if(et)Fe=xe.target.tagName==="path"?"move":xe.target.attributes["data-line-point"].value==="start-point"?"resize-over-start-point":"resize-over-end-point";else{var Ee=Ge.element.getBoundingClientRect(),Je=Ee.right-Ee.left,it=Ee.bottom-Ee.top,ht=xe.clientX-Ee.left,ct=xe.clientY-Ee.top,mt=!Re&&Je>10&&it>10&&!xe.shiftKey?s.getCursor(ht/Je,1-ct/it):"move";a(Q,mt),Fe=mt.split("-")[0]}}function ot(xe,Ee){if($.type==="path"){var Je=function(ct){return ct},it=Je,ht=Je;ze?Ze("xanchor",$.xanchor=Ie(ue+xe)):(it=function(ct){return Ie(lt(ct)+xe)},Ke&&Ke.type==="date"&&(it=f.encodeDate(it))),He?Ze("yanchor",$.yanchor=be(we+Ee)):(ht=function(ct){return be(gt(ct)+Ee)},rt&&rt.type==="date"&&(ht=f.encodeDate(ht))),Ze("path",$.path=w(Pe,it,ht))}else ze?Ze("xanchor",$.xanchor=Ie(ue+xe)):(Ze("x0",$.x0=Ie(oe+xe)),Ze("x1",$.x1=Ie(le+xe))),He?Ze("yanchor",$.yanchor=be(we+Ee)):(Ze("y0",$.y0=be(de+Ee)),Ze("y1",$.y1=be(fe+Ee)));Q.attr("d",T(W,$)),Ue(ie,$)}function Ce(xe,Ee){if(Re){var Je=function(Ne){return Ne},it=Je,ht=Je;ze?Ze("xanchor",$.xanchor=Ie(ue+xe)):(it=function(Ne){return Ie(lt(Ne)+xe)},Ke&&Ke.type==="date"&&(it=f.encodeDate(it))),He?Ze("yanchor",$.yanchor=be(we+Ee)):(ht=function(Ne){return be(gt(Ne)+Ee)},rt&&rt.type==="date"&&(ht=f.encodeDate(ht))),Ze("path",$.path=w(Pe,it,ht))}else if(et){if(Fe==="resize-over-start-point"){var ct=oe+xe,mt=He?de-Ee:de+Ee;Ze("x0",$.x0=ze?ct:Ie(ct)),Ze("y0",$.y0=He?mt:be(mt))}else if(Fe==="resize-over-end-point"){var bt=le+xe,Et=He?fe-Ee:fe+Ee;Ze("x1",$.x1=ze?bt:Ie(bt)),Ze("y1",$.y1=He?Et:be(Et))}}else{var Mt=function(Ne){return Fe.indexOf(Ne)!==-1},_t=Mt("n"),xt=Mt("s"),At=Mt("w"),It=Mt("e"),Nt=_t?Ae+Ee:Ae,Ot=xt?Se+Ee:Se,Yt=At?ke+xe:ke,Pt=It?Me+xe:Me;He&&(_t&&(Nt=Ae-Ee),xt&&(Ot=Se-Ee)),(!He&&Ot-Nt>10||He&&Nt-Ot>10)&&(Ze(ve,$[ve]=He?Nt:be(Nt)),Ze(ge,$[ge]=He?Ot:be(Ot))),Pt-Yt>10&&(Ze(De,$[De]=ze?Yt:Ie(Yt)),Ze(_e,$[_e]=ze?Pt:Ie(Pt)))}Q.attr("d",T(W,$)),Ue(ie,$)}function Ue(xe,Ee){(ze||He)&&function(){var Je=Ee.type!=="path",it=xe.selectAll(".visual-cue").data([0]);it.enter().append("path").attr({fill:"#fff","fill-rule":"evenodd",stroke:"#000","stroke-width":1}).classed("visual-cue",!0);var ht=lt(ze?Ee.xanchor:h.midRange(Je?[Ee.x0,Ee.x1]:f.extractPathCoords(Ee.path,c.paramIsX))),ct=gt(He?Ee.yanchor:h.midRange(Je?[Ee.y0,Ee.y1]:f.extractPathCoords(Ee.path,c.paramIsY)));if(ht=f.roundPositionForSharpStrokeRendering(ht,1),ct=f.roundPositionForSharpStrokeRendering(ct,1),ze&&He){var mt="M"+(ht-1-1)+","+(ct-1-1)+"h-8v2h8 v8h2v-8 h8v-2h-8 v-8h-2 Z";it.attr("d",mt)}else if(ze){var bt="M"+(ht-1-1)+","+(ct-9-1)+"v18 h2 v-18 Z";it.attr("d",bt)}else{var Et="M"+(ht-9-1)+","+(ct-1-1)+"h18 v2 h-18 Z";it.attr("d",Et)}}()}function Ye(xe){xe.selectAll(".visual-cue").remove()}s.init(Ge),We.node().onmousemove=st}(E,H,_,M,k,F):_.editable===!0&&H.style("pointer-events",B||r.opacity(V)*R<=.5?"stroke":"all");H.node().addEventListener("click",function(){return function(W,Q){if(m(W)){var $=+Q.node().getAttribute("data-index");if($>=0){if($===W._fullLayout._activeShapeIndex)return void A(W);W._fullLayout._activeShapeIndex=$,W._fullLayout._deactivateShape=A,g(W)}}}(E,H)})}}function v(E,M,b){var _=(b.xref+b.yref).replace(/paper/g,"").replace(/[xyz][1-9]* *domain/g,"");i.setClipUrl(E,_?"clip"+M._fullLayout._uid+_:null,M)}function T(E,M){var b,_,S,C,k,L,I,R,V=M.type,O=p.getRefType(M.xref),J=p.getRefType(M.yref),D=p.getFromId(E,M.xref),B=p.getFromId(E,M.yref),N=E._fullLayout._size;if(D?O==="domain"?_=function(ie){return D._offset+D._length*ie}:(b=f.shapePositionToRange(D),_=function(ie){return D._offset+D.r2p(b(ie,!0))}):_=function(ie){return N.l+N.w*ie},B?J==="domain"?C=function(ie){return B._offset+B._length*(1-ie)}:(S=f.shapePositionToRange(B),C=function(ie){return B._offset+B.r2p(S(ie,!0))}):C=function(ie){return N.t+N.h*(1-ie)},V==="path")return D&&D.type==="date"&&(_=f.decodeDate(_)),B&&B.type==="date"&&(C=f.decodeDate(C)),function(ie,ae,oe){var de=ie.path,le=ie.xsizemode,fe=ie.ysizemode,ue=ie.xanchor,we=ie.yanchor;return de.replace(c.segmentRE,function(Ae){var Se=0,ke=Ae.charAt(0),Me=c.paramIsX[ke],ve=c.paramIsY[ke],ge=c.numParams[ke],De=Ae.substr(1).replace(c.paramRE,function(_e){return Me[Se]?_e=le==="pixel"?ae(ue)+Number(_e):ae(_e):ve[Se]&&(_e=fe==="pixel"?oe(we)-Number(_e):oe(_e)),++Se>ge&&(_e="X"),_e});return Se>ge&&(De=De.replace(/[\s,]*X.*/,""),h.log("Ignoring extra params in segment "+Ae)),ke+De})}(M,_,C);if(M.xsizemode==="pixel"){var F=_(M.xanchor);k=F+M.x0,L=F+M.x1}else k=_(M.x0),L=_(M.x1);if(M.ysizemode==="pixel"){var H=C(M.yanchor);I=H-M.y0,R=H-M.y1}else I=C(M.y0),R=C(M.y1);if(V==="line")return"M"+k+","+I+"L"+L+","+R;if(V==="rect")return"M"+k+","+I+"H"+L+"V"+R+"H"+k+"Z";var j=(k+L)/2,G=(I+R)/2,W=Math.abs(j-k),Q=Math.abs(G-I),$="A"+W+","+Q,ee=j+W+","+G;return"M"+ee+$+" 0 1,1 "+(j+","+(G-Q))+$+" 0 0,1 "+ee+"Z"}function w(E,M,b){return E.replace(c.segmentRE,function(_){var S=0,C=_.charAt(0),k=c.paramIsX[C],L=c.paramIsY[C],I=c.numParams[C];return C+_.substr(1).replace(c.paramRE,function(R){return S>=I||(k[S]?R=M(R):L[S]&&(R=b(R)),S++),R})})}function A(E){m(E)&&E._fullLayout._activeShapeIndex>=0&&(o(E),delete E._fullLayout._activeShapeIndex,g(E))}z.exports={draw:g,drawOne:y,eraseActiveShape:function(E){if(m(E)){o(E);var M=E._fullLayout._activeShapeIndex,b=(E.layout||{}).shapes||[];if(M<b.length){for(var _=[],S=0;S<b.length;S++)S!==M&&_.push(b[S]);delete E._fullLayout._activeShapeIndex,t.call("_guiRelayout",E,{shapes:_})}}}}},{"../../lib":778,"../../lib/setcursor":799,"../../plot_api/plot_template":817,"../../plots/cartesian/axes":828,"../../plots/cartesian/handle_outline":838,"../../registry":911,"../color":643,"../dragelement":662,"../drawing":665,"./constants":722,"./draw_newshape/display_outlines":728,"./draw_newshape/helpers":729,"./helpers":731}],725:[function(n,z,q){"use strict";var t=n("../../drawing/attributes").dash,h=n("../../../lib/extend").extendFlat;z.exports={newshape:{line:{color:{valType:"color",editType:"none"},width:{valType:"number",min:0,dflt:4,editType:"none"},dash:h({},t,{dflt:"solid",editType:"none"}),editType:"none"},fillcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"none"},fillrule:{valType:"enumerated",values:["evenodd","nonzero"],dflt:"evenodd",editType:"none"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"none"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"none"},drawdirection:{valType:"enumerated",values:["ortho","horizontal","vertical","diagonal"],dflt:"diagonal",editType:"none"},editType:"none"},activeshape:{fillcolor:{valType:"color",dflt:"rgb(255,0,255)",editType:"none"},opacity:{valType:"number",min:0,max:1,dflt:.5,editType:"none"},editType:"none"}}},{"../../../lib/extend":768,"../../drawing/attributes":664}],726:[function(n,z,q){"use strict";z.exports={CIRCLE_SIDES:32,i000:0,i090:8,i180:16,i270:24,cos45:Math.cos(Math.PI/4),sin45:Math.sin(Math.PI/4),SQRT2:Math.sqrt(2)}},{}],727:[function(n,z,q){"use strict";var t=n("../../color");z.exports=function(h,p,l){if(l("newshape.drawdirection"),l("newshape.layer"),l("newshape.fillcolor"),l("newshape.fillrule"),l("newshape.opacity"),l("newshape.line.width")){var e=(h||{}).plot_bgcolor||"#FFF";l("newshape.line.color",t.contrast(e)),l("newshape.line.dash")}l("activeshape.fillcolor"),l("activeshape.opacity")}},{"../../color":643}],728:[function(n,z,q){"use strict";var t=n("../../dragelement"),h=n("../../dragelement/helpers").drawMode,p=n("../../../registry"),l=n("./constants"),e=l.i000,o=l.i090,r=l.i180,i=l.i270,u=n("../../../plots/cartesian/handle_outline").clearOutlineControllers,s=n("./helpers"),a=s.pointsShapeRectangle,c=s.pointsShapeEllipse,f=s.writePaths,g=n("./newshapes");z.exports=function d(m,y,v,T){T||(T=0);var w=v.gd;function A(){d(m,y,v,T++),c(m[0])&&E({redrawing:!0})}function E(F){v.isActiveShape=!1;var H=g(y,v);Object.keys(H).length&&p.call((F||{}).redrawing?"relayout":"_guiRelayout",w,H)}var M,b,_,S,C,k=v.isActiveShape,L=w._fullLayout._zoomlayer,I=v.dragmode;h(I)?w._fullLayout._drawing=!0:w._fullLayout._activeShapeIndex>=0&&u(w),y.attr("d",f(m)),k&&!T&&(C=function(F,H){for(var j=0;j<H.length;j++){var G=H[j];F[j]=[];for(var W=0;W<G.length;W++){F[j][W]=[];for(var Q=0;Q<G[W].length;Q++)F[j][W][Q]=G[W][Q]}}return F}([],m),function(F){M=[];for(var H=0;H<m.length;H++){var j=m[H],G=!a(j)&&c(j);M[H]=[];for(var W=0;W<j.length;W++)if(j[W][0]!=="Z"&&(!G||W===e||W===o||W===r||W===i)){var Q=j[W][1],$=j[W][2],ee=F.append("circle").classed("cursor-grab",!0).attr("data-i",H).attr("data-j",W).attr("cx",Q).attr("cy",$).attr("r",4).style({"mix-blend-mode":"luminosity",fill:"black",stroke:"white","stroke-width":1});M[H][W]={element:ee.node(),gd:w,prepFn:R,doneFn:O,clickFn:J},t.init(M[H][W])}}}(L.append("g").attr("class","outline-controllers")),function(){b=[],m.length&&(b[0]={element:y[0][0],gd:w,prepFn:B,doneFn:N},t.init(b[0]))}());function R(F){_=+F.srcElement.getAttribute("data-i"),S=+F.srcElement.getAttribute("data-j"),M[_][S].moveFn=V}function V(F,H){if(m.length){var j=C[_][S][1],G=C[_][S][2],W=m[_],Q=W.length;if(a(W)){for(var $=0;$<Q;$++)if($!==S){var ee=W[$];ee[1]===W[S][1]&&(ee[1]=j+F),ee[2]===W[S][2]&&(ee[2]=G+H)}if(W[S][1]=j+F,W[S][2]=G+H,!a(W))for(var ie=0;ie<Q;ie++)for(var ae=0;ae<W[ie].length;ae++)W[ie][ae]=C[_][ie][ae]}else W[S][1]=j+F,W[S][2]=G+H;A()}}function O(){E()}function J(F,H){if(F===2){_=+H.srcElement.getAttribute("data-i"),S=+H.srcElement.getAttribute("data-j");var j=m[_];a(j)||c(j)||function(){if(m.length&&m[_]&&m[_].length){for(var G=[],W=0;W<m[_].length;W++)W!==S&&G.push(m[_][W]);G.length>1&&(G.length!==2||G[1][0]!=="Z")&&(S===0&&(G[0][0]="M"),m[_]=G,A(),E())}}()}}function D(F,H){(function(j,G){if(m.length)for(var W=0;W<m.length;W++)for(var Q=0;Q<m[W].length;Q++)for(var $=0;$+2<m[W][Q].length;$+=2)m[W][Q][$+1]=C[W][Q][$+1]+j,m[W][Q][$+2]=C[W][Q][$+2]+G})(F,H),A()}function B(F){(_=+F.srcElement.getAttribute("data-i"))||(_=0),b[_].moveFn=D}function N(){E()}}},{"../../../plots/cartesian/handle_outline":838,"../../../registry":911,"../../dragelement":662,"../../dragelement/helpers":661,"./constants":726,"./helpers":729,"./newshapes":730}],729:[function(n,z,q){"use strict";var t=n("parse-svg-path"),h=n("./constants"),p=h.CIRCLE_SIDES,l=h.SQRT2,e=n("../../../plots/cartesian/helpers"),o=e.p2r,r=e.r2p,i=[0,3,4,5,6,1,2],u=[0,3,4,1,2];function s(c,f){return Math.abs(c-f)<=1e-6}function a(c,f){var g=f[1]-c[1],d=f[2]-c[2];return Math.sqrt(g*g+d*d)}q.writePaths=function(c){var f=c.length;if(!f)return"M0,0Z";for(var g="",d=0;d<f;d++)for(var m=c[d].length,y=0;y<m;y++){var v=c[d][y][0];if(v==="Z")g+="Z";else for(var T=c[d][y].length,w=0;w<T;w++){var A=w;v==="Q"||v==="S"?A=u[w]:v==="C"&&(A=i[w]),g+=c[d][y][A],w>0&&w<T-1&&(g+=",")}}return g},q.readPaths=function(c,f,g,d){var m,y,v,T=t(c),w=[],A=-1,E=0,M=0,b=function(){y=E,v=M};b();for(var _=0;_<T.length;_++){var S,C,k,L,I=[],R=T[_][0],V=R;switch(R){case"M":A++,w[A]=[],E=+T[_][1],M=+T[_][2],I.push([V,E,M]),b();break;case"Q":case"S":S=+T[_][1],k=+T[_][2],E=+T[_][3],M=+T[_][4],I.push([V,E,M,S,k]);break;case"C":S=+T[_][1],k=+T[_][2],C=+T[_][3],L=+T[_][4],E=+T[_][5],M=+T[_][6],I.push([V,E,M,S,k,C,L]);break;case"T":case"L":E=+T[_][1],M=+T[_][2],I.push([V,E,M]);break;case"H":V="L",E=+T[_][1],I.push([V,E,M]);break;case"V":V="L",M=+T[_][1],I.push([V,E,M]);break;case"A":V="L";var O=+T[_][1],J=+T[_][2];+T[_][4]||(O=-O,J=-J);var D=E-O,B=M;for(m=1;m<=p/2;m++){var N=2*Math.PI*m/p;I.push([V,D+O*Math.cos(N),B+J*Math.sin(N)])}break;case"Z":E===y&&M===v||(E=y,M=v,I.push([V,E,M]))}for(var F=(g||{}).domain,H=f._fullLayout._size,j=g&&g.xsizemode==="pixel",G=g&&g.ysizemode==="pixel",W=d===!1,Q=0;Q<I.length;Q++){for(m=0;m+2<7;m+=2){var $=I[Q][m+1],ee=I[Q][m+2];$!==void 0&&ee!==void 0&&(E=$,M=ee,g&&(g.xaxis&&g.xaxis.p2r?(W&&($-=g.xaxis._offset),$=j?r(g.xaxis,g.xanchor)+$:o(g.xaxis,$)):(W&&($-=H.l),F?$=F.x[0]+$/H.w:$/=H.w),g.yaxis&&g.yaxis.p2r?(W&&(ee-=g.yaxis._offset),ee=G?r(g.yaxis,g.yanchor)-ee:o(g.yaxis,ee)):(W&&(ee-=H.t),ee=F?F.y[1]-ee/H.h:1-ee/H.h)),I[Q][m+1]=$,I[Q][m+2]=ee)}w[A].push(I[Q].slice())}}return w},q.pointsShapeRectangle=function(c){if(c.length!==5)return!1;for(var f=1;f<3;f++)if(!s(c[0][f]-c[1][f],c[3][f]-c[2][f])||!s(c[0][f]-c[3][f],c[1][f]-c[2][f]))return!1;return!(!s(c[0][1],c[1][1])&&!s(c[0][1],c[3][1]))&&!!(a(c[0],c[1])*a(c[0],c[3]))},q.pointsShapeEllipse=function(c){var f=c.length;if(f!==p+1)return!1;f=p;for(var g=0;g<f;g++){var d=(2*f-g)%f,m=(f/2+d)%f,y=(f/2+g)%f;if(!s(a(c[g],c[y]),a(c[d],c[m])))return!1}return!0},q.handleEllipse=function(c,f,g){if(!c)return[f,g];var d=q.ellipseOver({x0:f[0],y0:f[1],x1:g[0],y1:g[1]}),m=(d.x1+d.x0)/2,y=(d.y1+d.y0)/2,v=(d.x1-d.x0)/2,T=(d.y1-d.y0)/2;v||(v=T/=l),T||(T=v/=l);for(var w=[],A=0;A<p;A++){var E=2*A*Math.PI/p;w.push([m+v*Math.cos(E),y+T*Math.sin(E)])}return w},q.ellipseOver=function(c){var f=c.x0,g=c.y0,d=c.x1,m=c.y1,y=d-f,v=m-g,T=((f-=y)+d)/2,w=((g-=v)+m)/2;return{x0:T-(y*=l),y0:w-(v*=l),x1:T+y,y1:w+v}}},{"../../../plots/cartesian/helpers":839,"./constants":726,"parse-svg-path":505}],730:[function(n,z,q){"use strict";var t=n("../../dragelement/helpers"),h=t.drawMode,p=t.openMode,l=n("./constants"),e=l.i000,o=l.i090,r=l.i180,i=l.i270,u=l.cos45,s=l.sin45,a=n("../../../plots/cartesian/helpers"),c=a.p2r,f=a.r2p,g=n("../../../plots/cartesian/handle_outline").clearSelect,d=n("./helpers"),m=d.readPaths,y=d.writePaths,v=d.ellipseOver;z.exports=function(T,w){if(T.length){var A=T[0][0];if(A){var E=A.getAttribute("d"),M=w.gd,b=M._fullLayout.newshape,_=w.plotinfo,S=_.xaxis,C=_.yaxis,k=!!_.domain||!_.xaxis,L=!!_.domain||!_.yaxis,I=w.isActiveShape,R=w.dragmode,V=(M.layout||{}).shapes||[];if(!h(R)&&I!==void 0){var O=M._fullLayout._activeShapeIndex;if(O<V.length)switch(M._fullLayout.shapes[O].type){case"rect":R="drawrect";break;case"circle":R="drawcircle";break;case"line":R="drawline";break;case"path":var J=V[O].path||"";R=J[J.length-1]==="Z"?"drawclosedpath":"drawopenpath"}}var D,B=p(R),N=m(E,M,_,I),F={editable:!0,xref:k?"paper":S._id,yref:L?"paper":C._id,layer:b.layer,opacity:b.opacity,line:{color:b.line.color,width:b.line.width,dash:b.line.dash}};if(B||(F.fillcolor=b.fillcolor,F.fillrule=b.fillrule),N.length===1&&(D=N[0]),D&&R==="drawrect")F.type="rect",F.x0=D[0][1],F.y0=D[0][2],F.x1=D[2][1],F.y1=D[2][2];else if(D&&R==="drawline")F.type="line",F.x0=D[0][1],F.y0=D[0][2],F.x1=D[1][1],F.y1=D[1][2];else if(D&&R==="drawcircle"){F.type="circle";var H=D[e][1],j=D[o][1],G=D[r][1],W=D[i][1],Q=D[e][2],$=D[o][2],ee=D[r][2],ie=D[i][2],ae=_.xaxis&&(_.xaxis.type==="date"||_.xaxis.type==="log"),oe=_.yaxis&&(_.yaxis.type==="date"||_.yaxis.type==="log");ae&&(H=f(_.xaxis,H),j=f(_.xaxis,j),G=f(_.xaxis,G),W=f(_.xaxis,W)),oe&&(Q=f(_.yaxis,Q),$=f(_.yaxis,$),ee=f(_.yaxis,ee),ie=f(_.yaxis,ie));var de=(j+W)/2,le=(Q+ee)/2,fe=v({x0:de,y0:le,x1:de+(W-j+G-H)/2*u,y1:le+(ie-$+ee-Q)/2*s});ae&&(fe.x0=c(_.xaxis,fe.x0),fe.x1=c(_.xaxis,fe.x1)),oe&&(fe.y0=c(_.yaxis,fe.y0),fe.y1=c(_.yaxis,fe.y1)),F.x0=fe.x0,F.y0=fe.y0,F.x1=fe.x1,F.y1=fe.y1}else F.type="path",S&&C&&function(ve,ge,De){var _e=ge.type==="date",Pe=De.type==="date";if(!_e&&!Pe)return ve;for(var Fe=0;Fe<ve.length;Fe++)for(var ze=0;ze<ve[Fe].length;ze++)for(var He=0;He+2<ve[Fe][ze].length;He+=2)_e&&(ve[Fe][ze][He+1]=ve[Fe][ze][He+1].replace(" ","_")),Pe&&(ve[Fe][ze][He+2]=ve[Fe][ze][He+2].replace(" ","_"))}(N,S,C),F.path=y(N),D=null;g(M);for(var ue=w.editHelpers,we=(ue||{}).modifyItem,Ae=[],Se=0;Se<V.length;Se++){var ke=M._fullLayout.shapes[Se];if(Ae[Se]=ke._input,I!==void 0&&Se===M._fullLayout._activeShapeIndex){var Me=F;switch(ke.type){case"line":case"rect":case"circle":we("x0",Me.x0),we("x1",Me.x1),we("y0",Me.y0),we("y1",Me.y1);break;case"path":we("path",Me.path)}}}return I===void 0?(Ae.push(F),Ae):ue?ue.getUpdateObj():{}}}}},{"../../../plots/cartesian/handle_outline":838,"../../../plots/cartesian/helpers":839,"../../dragelement/helpers":661,"./constants":726,"./helpers":729}],731:[function(n,z,q){"use strict";var t=n("./constants"),h=n("../../lib");q.rangeToShapePosition=function(p){return p.type==="log"?p.r2d:function(l){return l}},q.shapePositionToRange=function(p){return p.type==="log"?p.d2r:function(l){return l}},q.decodeDate=function(p){return function(l){return l.replace&&(l=l.replace("_"," ")),p(l)}},q.encodeDate=function(p){return function(l){return p(l).replace(" ","_")}},q.extractPathCoords=function(p,l){var e=[];return p.match(t.segmentRE).forEach(function(o){var r=l[o.charAt(0)].drawn;if(r!==void 0){var i=o.substr(1).match(t.paramRE);!i||i.length<r||e.push(h.cleanNumber(i[r]))}}),e},q.getDataToPixel=function(p,l,e,o){var r,i=p._fullLayout._size;if(l)if(o==="domain")r=function(s){return l._length*(e?1-s:s)+l._offset};else{var u=q.shapePositionToRange(l);r=function(s){return l._offset+l.r2p(u(s,!0))},l.type==="date"&&(r=q.decodeDate(r))}else r=e?function(s){return i.t+i.h*(1-s)}:function(s){return i.l+i.w*s};return r},q.getPixelToData=function(p,l,e,o){var r,i=p._fullLayout._size;if(l)if(o==="domain")r=function(s){var a=(s-l._offset)/l._length;return e?1-a:a};else{var u=q.rangeToShapePosition(l);r=function(s){return u(l.p2r(s-l._offset))}}else r=e?function(s){return 1-(s-i.t)/i.h}:function(s){return(s-i.l)/i.w};return r},q.roundPositionForSharpStrokeRendering=function(p,l){var e=Math.round(l%2)===1,o=Math.round(p);return e?o+.5:o},q.makeOptionsAndPlotinfo=function(p,l){var e=p._fullLayout.shapes[l]||{},o=p._fullLayout._plots[e.xref+e.yref];return o?o._hadPlotinfo=!0:(o={},e.xref&&e.xref!=="paper"&&(o.xaxis=p._fullLayout[e.xref+"axis"]),e.yref&&e.yref!=="paper"&&(o.yaxis=p._fullLayout[e.yref+"axis"])),o.xsizemode=e.xsizemode,o.ysizemode=e.ysizemode,o.xanchor=e.xanchor,o.yanchor=e.yanchor,{options:e,plotinfo:o}}},{"../../lib":778,"./constants":722}],732:[function(n,z,q){"use strict";var t=n("./draw");z.exports={moduleType:"component",name:"shapes",layoutAttributes:n("./attributes"),supplyLayoutDefaults:n("./defaults"),supplyDrawNewShapeDefaults:n("./draw_newshape/defaults"),includeBasePlot:n("../../plots/cartesian/include_components")("shapes"),calcAutorange:n("./calc_autorange"),draw:t.draw,drawOne:t.drawOne}},{"../../plots/cartesian/include_components":840,"./attributes":720,"./calc_autorange":721,"./defaults":723,"./draw":724,"./draw_newshape/defaults":727}],733:[function(n,z,q){"use strict";var t=n("../../plots/font_attributes"),h=n("../../plots/pad_attributes"),p=n("../../lib/extend").extendDeepAll,l=n("../../plot_api/edit_types").overrideAll,e=n("../../plots/animation_attributes"),o=n("../../plot_api/plot_template").templatedArray,r=n("./constants"),i=o("step",{visible:{valType:"boolean",dflt:!0},method:{valType:"enumerated",values:["restyle","relayout","animate","update","skip"],dflt:"restyle"},args:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},label:{valType:"string"},value:{valType:"string"},execute:{valType:"boolean",dflt:!0}});z.exports=l(o("slider",{visible:{valType:"boolean",dflt:!0},active:{valType:"number",min:0,dflt:0},steps:i,lenmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"fraction"},len:{valType:"number",min:0,dflt:1},x:{valType:"number",min:-2,max:3,dflt:0},pad:p(h({editType:"arraydraw"}),{},{t:{dflt:20}}),xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left"},y:{valType:"number",min:-2,max:3,dflt:0},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"top"},transition:{duration:{valType:"number",min:0,dflt:150},easing:{valType:"enumerated",values:e.transition.easing.values,dflt:"cubic-in-out"}},currentvalue:{visible:{valType:"boolean",dflt:!0},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left"},offset:{valType:"number",dflt:10},prefix:{valType:"string"},suffix:{valType:"string"},font:t({})},font:t({}),activebgcolor:{valType:"color",dflt:r.gripBgActiveColor},bgcolor:{valType:"color",dflt:r.railBgColor},bordercolor:{valType:"color",dflt:r.railBorderColor},borderwidth:{valType:"number",min:0,dflt:r.railBorderWidth},ticklen:{valType:"number",min:0,dflt:r.tickLength},tickcolor:{valType:"color",dflt:r.tickColor},tickwidth:{valType:"number",min:0,dflt:1},minorticklen:{valType:"number",min:0,dflt:r.minorTickLength}}),"arraydraw","from-root")},{"../../lib/extend":768,"../../plot_api/edit_types":810,"../../plot_api/plot_template":817,"../../plots/animation_attributes":822,"../../plots/font_attributes":856,"../../plots/pad_attributes":890,"./constants":734}],734:[function(n,z,q){"use strict";z.exports={name:"sliders",containerClassName:"slider-container",groupClassName:"slider-group",inputAreaClass:"slider-input-area",railRectClass:"slider-rail-rect",railTouchRectClass:"slider-rail-touch-rect",gripRectClass:"slider-grip-rect",tickRectClass:"slider-tick-rect",inputProxyClass:"slider-input-proxy",labelsClass:"slider-labels",labelGroupClass:"slider-label-group",labelClass:"slider-label",currentValueClass:"slider-current-value",railHeight:5,menuIndexAttrName:"slider-active-index",autoMarginIdRoot:"slider-",minWidth:30,minHeight:30,textPadX:40,arrowOffsetX:4,railRadius:2,railWidth:5,railBorder:4,railBorderWidth:1,railBorderColor:"#bec8d9",railBgColor:"#f8fafc",railInset:8,stepInset:10,gripRadius:10,gripWidth:20,gripHeight:20,gripBorder:20,gripBorderWidth:1,gripBorderColor:"#bec8d9",gripBgColor:"#f6f8fa",gripBgActiveColor:"#dbdde0",labelPadding:8,labelOffset:0,tickWidth:1,tickColor:"#333",tickOffset:25,tickLength:7,minorTickOffset:25,minorTickColor:"#333",minorTickLength:4,currentValuePadding:8,currentValueInset:0}},{}],735:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../../plots/array_container_defaults"),p=n("./attributes"),l=n("./constants").name,e=p.steps;function o(i,u,s){function a(m,y){return t.coerce(i,u,p,m,y)}for(var c=h(i,u,{name:"steps",handleItemDefaults:r}),f=0,g=0;g<c.length;g++)c[g].visible&&f++;if(f<2?u.visible=!1:a("visible")){u._stepCount=f;var d=u._visibleSteps=t.filterVisible(c);(c[a("active")]||{}).visible||(u.active=d[0]._index),a("x"),a("y"),t.noneOrAll(i,u,["x","y"]),a("xanchor"),a("yanchor"),a("len"),a("lenmode"),a("pad.t"),a("pad.r"),a("pad.b"),a("pad.l"),t.coerceFont(a,"font",s.font),a("currentvalue.visible")&&(a("currentvalue.xanchor"),a("currentvalue.prefix"),a("currentvalue.suffix"),a("currentvalue.offset"),t.coerceFont(a,"currentvalue.font",u.font)),a("transition.duration"),a("transition.easing"),a("bgcolor"),a("activebgcolor"),a("bordercolor"),a("borderwidth"),a("ticklen"),a("tickwidth"),a("tickcolor"),a("minorticklen")}}function r(i,u){function s(c,f){return t.coerce(i,u,e,c,f)}if(i.method==="skip"||Array.isArray(i.args)?s("visible"):u.visible=!1){s("method"),s("args");var a=s("label","step-"+u._index);s("value",a),s("execute")}}z.exports=function(i,u){h(i,u,{name:l,handleItemDefaults:o})}},{"../../lib":778,"../../plots/array_container_defaults":823,"./attributes":733,"./constants":734}],736:[function(n,z,q){"use strict";var t=n("d3"),h=n("../../plots/plots"),p=n("../color"),l=n("../drawing"),e=n("../../lib"),o=e.strTranslate,r=n("../../lib/svg_text_utils"),i=n("../../plot_api/plot_template").arrayEditor,u=n("./constants"),s=n("../../constants/alignment"),a=s.LINE_SPACING,c=s.FROM_TL,f=s.FROM_BR;function g(I){return u.autoMarginIdRoot+I._index}function d(I){return I._index}function m(I,R){var V=l.tester.selectAll("g."+u.labelGroupClass).data(R._visibleSteps);V.enter().append("g").classed(u.labelGroupClass,!0);var O=0,J=0;V.each(function(Q){var $=T(t.select(this),{step:Q},R).node();if($){var ee=l.bBox($);J=Math.max(J,ee.height),O=Math.max(O,ee.width)}}),V.remove();var D=R._dims={};D.inputAreaWidth=Math.max(u.railWidth,u.gripHeight);var B=I._fullLayout._size;D.lx=B.l+B.w*R.x,D.ly=B.t+B.h*(1-R.y),R.lenmode==="fraction"?D.outerLength=Math.round(B.w*R.len):D.outerLength=R.len,D.inputAreaStart=0,D.inputAreaLength=Math.round(D.outerLength-R.pad.l-R.pad.r);var N=(D.inputAreaLength-2*u.stepInset)/(R._stepCount-1),F=O+u.labelPadding;if(D.labelStride=Math.max(1,Math.ceil(F/N)),D.labelHeight=J,D.currentValueMaxWidth=0,D.currentValueHeight=0,D.currentValueTotalHeight=0,D.currentValueMaxLines=1,R.currentvalue.visible){var H=l.tester.append("g");V.each(function(Q){var $=y(H,R,Q.label),ee=$.node()&&l.bBox($.node())||{width:0,height:0},ie=r.lineCount($);D.currentValueMaxWidth=Math.max(D.currentValueMaxWidth,Math.ceil(ee.width)),D.currentValueHeight=Math.max(D.currentValueHeight,Math.ceil(ee.height)),D.currentValueMaxLines=Math.max(D.currentValueMaxLines,ie)}),D.currentValueTotalHeight=D.currentValueHeight+R.currentvalue.offset,H.remove()}D.height=D.currentValueTotalHeight+u.tickOffset+R.ticklen+u.labelOffset+D.labelHeight+R.pad.t+R.pad.b;var j="left";e.isRightAnchor(R)&&(D.lx-=D.outerLength,j="right"),e.isCenterAnchor(R)&&(D.lx-=D.outerLength/2,j="center");var G="top";e.isBottomAnchor(R)&&(D.ly-=D.height,G="bottom"),e.isMiddleAnchor(R)&&(D.ly-=D.height/2,G="middle"),D.outerLength=Math.ceil(D.outerLength),D.height=Math.ceil(D.height),D.lx=Math.round(D.lx),D.ly=Math.round(D.ly);var W={y:R.y,b:D.height*f[G],t:D.height*c[G]};R.lenmode==="fraction"?(W.l=0,W.xl=R.x-R.len*c[j],W.r=0,W.xr=R.x+R.len*f[j]):(W.x=R.x,W.l=D.outerLength*c[j],W.r=D.outerLength*f[j]),h.autoMargin(I,g(R),W)}function y(I,R,V){if(R.currentvalue.visible){var O,J,D=R._dims;switch(R.currentvalue.xanchor){case"right":O=D.inputAreaLength-u.currentValueInset-D.currentValueMaxWidth,J="left";break;case"center":O=.5*D.inputAreaLength,J="middle";break;default:O=u.currentValueInset,J="left"}var B=e.ensureSingle(I,"text",u.labelClass,function(W){W.attr({"text-anchor":J,"data-notex":1})}),N=R.currentvalue.prefix?R.currentvalue.prefix:"";if(typeof V=="string")N+=V;else{var F=R.steps[R.active].label,H=R._gd._fullLayout._meta;H&&(F=e.templateString(F,H)),N+=F}R.currentvalue.suffix&&(N+=R.currentvalue.suffix),B.call(l.font,R.currentvalue.font).text(N).call(r.convertToTspans,R._gd);var j=r.lineCount(B),G=(D.currentValueMaxLines+1-j)*R.currentvalue.font.size*a;return r.positionText(B,O,G),B}}function v(I,R,V){e.ensureSingle(I,"rect",u.gripRectClass,function(O){O.call(M,R,I,V).style("pointer-events","all")}).attr({width:u.gripWidth,height:u.gripHeight,rx:u.gripRadius,ry:u.gripRadius}).call(p.stroke,V.bordercolor).call(p.fill,V.bgcolor).style("stroke-width",V.borderwidth+"px")}function T(I,R,V){var O=e.ensureSingle(I,"text",u.labelClass,function(B){B.attr({"text-anchor":"middle","data-notex":1})}),J=R.step.label,D=V._gd._fullLayout._meta;return D&&(J=e.templateString(J,D)),O.call(l.font,V.font).text(J).call(r.convertToTspans,V._gd),O}function w(I,R){var V=e.ensureSingle(I,"g",u.labelsClass),O=R._dims,J=V.selectAll("g."+u.labelGroupClass).data(O.labelSteps);J.enter().append("g").classed(u.labelGroupClass,!0),J.exit().remove(),J.each(function(D){var B=t.select(this);B.call(T,D,R),l.setTranslate(B,S(R,D.fraction),u.tickOffset+R.ticklen+R.font.size*a+u.labelOffset+O.currentValueTotalHeight)})}function A(I,R,V,O,J){var D=Math.round(O*(V._stepCount-1)),B=V._visibleSteps[D]._index;B!==V.active&&E(I,R,V,B,!0,J)}function E(I,R,V,O,J,D){var B=V.active;V.active=O,i(I.layout,u.name,V).applyUpdate("active",O);var N=V.steps[V.active];R.call(_,V,D),R.call(y,V),I.emit("plotly_sliderchange",{slider:V,step:V.steps[V.active],interaction:J,previousActive:B}),N&&N.method&&J&&(R._nextMethod?(R._nextMethod.step=N,R._nextMethod.doCallback=J,R._nextMethod.doTransition=D):(R._nextMethod={step:N,doCallback:J,doTransition:D},R._nextMethodRaf=window.requestAnimationFrame(function(){var F=R._nextMethod.step;F.method&&(F.execute&&h.executeAPICommand(I,F.method,F.args),R._nextMethod=null,R._nextMethodRaf=null)})))}function M(I,R,V){var O=V.node(),J=t.select(R);function D(){return V.data()[0]}I.on("mousedown",function(){var B=D();R.emit("plotly_sliderstart",{slider:B});var N=V.select("."+u.gripRectClass);t.event.stopPropagation(),t.event.preventDefault(),N.call(p.fill,B.activebgcolor);var F=C(B,t.mouse(O)[0]);A(R,V,B,F,!0),B._dragging=!0,J.on("mousemove",function(){var H=D(),j=C(H,t.mouse(O)[0]);A(R,V,H,j,!1)}),J.on("mouseup",function(){var H=D();H._dragging=!1,N.call(p.fill,H.bgcolor),J.on("mouseup",null),J.on("mousemove",null),R.emit("plotly_sliderend",{slider:H,step:H.steps[H.active]})})})}function b(I,R){var V=I.selectAll("rect."+u.tickRectClass).data(R._visibleSteps),O=R._dims;V.enter().append("rect").classed(u.tickRectClass,!0),V.exit().remove(),V.attr({width:R.tickwidth+"px","shape-rendering":"crispEdges"}),V.each(function(J,D){var B=D%O.labelStride==0,N=t.select(this);N.attr({height:B?R.ticklen:R.minorticklen}).call(p.fill,R.tickcolor),l.setTranslate(N,S(R,D/(R._stepCount-1))-.5*R.tickwidth,(B?u.tickOffset:u.minorTickOffset)+O.currentValueTotalHeight)})}function _(I,R,V){for(var O=I.select("rect."+u.gripRectClass),J=0,D=0;D<R._stepCount;D++)if(R._visibleSteps[D]._index===R.active){J=D;break}var B=S(R,J/(R._stepCount-1));if(!R._invokingCommand){var N=O;V&&R.transition.duration>0&&(N=N.transition().duration(R.transition.duration).ease(R.transition.easing)),N.attr("transform",o(B-.5*u.gripWidth,R._dims.currentValueTotalHeight))}}function S(I,R){var V=I._dims;return V.inputAreaStart+u.stepInset+(V.inputAreaLength-2*u.stepInset)*Math.min(1,Math.max(0,R))}function C(I,R){var V=I._dims;return Math.min(1,Math.max(0,(R-u.stepInset-V.inputAreaStart)/(V.inputAreaLength-2*u.stepInset-2*V.inputAreaStart)))}function k(I,R,V){var O=V._dims,J=e.ensureSingle(I,"rect",u.railTouchRectClass,function(D){D.call(M,R,I,V).style("pointer-events","all")});J.attr({width:O.inputAreaLength,height:Math.max(O.inputAreaWidth,u.tickOffset+V.ticklen+O.labelHeight)}).call(p.fill,V.bgcolor).attr("opacity",0),l.setTranslate(J,0,O.currentValueTotalHeight)}function L(I,R){var V=R._dims,O=V.inputAreaLength-2*u.railInset,J=e.ensureSingle(I,"rect",u.railRectClass);J.attr({width:O,height:u.railWidth,rx:u.railRadius,ry:u.railRadius,"shape-rendering":"crispEdges"}).call(p.stroke,R.bordercolor).call(p.fill,R.bgcolor).style("stroke-width",R.borderwidth+"px"),l.setTranslate(J,u.railInset,.5*(V.inputAreaWidth-u.railWidth)+V.currentValueTotalHeight)}z.exports=function(I){var R=I._fullLayout,V=function(F,H){for(var j=F[u.name],G=[],W=0;W<j.length;W++){var Q=j[W];Q.visible&&(Q._gd=H,G.push(Q))}return G}(R,I),O=R._infolayer.selectAll("g."+u.containerClassName).data(V.length>0?[0]:[]);function J(F){F._commandObserver&&(F._commandObserver.remove(),delete F._commandObserver),h.autoMargin(I,g(F))}if(O.enter().append("g").classed(u.containerClassName,!0).style("cursor","ew-resize"),O.exit().each(function(){t.select(this).selectAll("g."+u.groupClassName).each(J)}).remove(),V.length!==0){var D=O.selectAll("g."+u.groupClassName).data(V,d);D.enter().append("g").classed(u.groupClassName,!0),D.exit().each(J).remove();for(var B=0;B<V.length;B++){var N=V[B];m(I,N)}D.each(function(F){var H=t.select(this);(function(j){var G=j._dims;G.labelSteps=[];for(var W=j._stepCount,Q=0;Q<W;Q+=G.labelStride)G.labelSteps.push({fraction:Q/(W-1),step:j._visibleSteps[Q]})})(F),h.manageCommandObserver(I,F,F._visibleSteps,function(j){var G=H.data()[0];G.active!==j.index&&(G._dragging||E(I,H,G,j.index,!1,!0))}),function(j,G,W){(W.steps[W.active]||{}).visible||(W.active=W._visibleSteps[0]._index),G.call(y,W).call(L,W).call(w,W).call(b,W).call(k,j,W).call(v,j,W);var Q=W._dims;l.setTranslate(G,Q.lx+W.pad.l,Q.ly+W.pad.t),G.call(_,W,!1),G.call(y,W)}(I,t.select(this),F)})}}},{"../../constants/alignment":745,"../../lib":778,"../../lib/svg_text_utils":803,"../../plot_api/plot_template":817,"../../plots/plots":891,"../color":643,"../drawing":665,"./constants":734,d3:169}],737:[function(n,z,q){"use strict";var t=n("./constants");z.exports={moduleType:"component",name:t.name,layoutAttributes:n("./attributes"),supplyLayoutDefaults:n("./defaults"),draw:n("./draw")}},{"./attributes":733,"./constants":734,"./defaults":735,"./draw":736}],738:[function(n,z,q){"use strict";var t=n("d3"),h=n("fast-isnumeric"),p=n("../../plots/plots"),l=n("../../registry"),e=n("../../lib"),o=e.strTranslate,r=n("../drawing"),i=n("../color"),u=n("../../lib/svg_text_utils"),s=n("../../constants/interactions"),a=n("../../constants/alignment").OPPOSITE_SIDE,c=/ [XY][0-9]* /;z.exports={draw:function(f,g,d){var m,y=d.propContainer,v=d.propName,T=d.placeholder,w=d.traceIndex,A=d.avoid||{},E=d.attributes,M=d.transform,b=d.containerGroup,_=f._fullLayout,S=1,C=!1,k=y.title,L=(k&&k.text?k.text:"").trim(),I=k&&k.font?k.font:{},R=I.family,V=I.size,O=I.color;v==="title.text"?m="titleText":v.indexOf("axis")!==-1?m="axisTitleText":v.indexOf(!0)&&(m="colorbarTitleText");var J=f._context.edits[m];L===""?S=0:L.replace(c," % ")===T.replace(c," % ")&&(S=.2,C=!0,J||(L="")),d._meta?L=e.templateString(L,d._meta):_._meta&&(L=e.templateString(L,_._meta));var D=L||J;b||(b=e.ensureSingle(_._infolayer,"g","g-"+g));var B=b.selectAll("text").data(D?[0]:[]);if(B.enter().append("text"),B.text(L).attr("class",g),B.exit().remove(),!D)return b;function N(j){e.syncOrAsync([F,H],j)}function F(j){var G;return M?(G="",M.rotate&&(G+="rotate("+[M.rotate,E.x,E.y]+")"),M.offset&&(G+=o(0,M.offset))):G=null,j.attr("transform",G),j.style({"font-family":R,"font-size":t.round(V,2)+"px",fill:i.rgb(O),opacity:S*i.opacity(O),"font-weight":p.fontWeight}).attr(E).call(u.convertToTspans,f),p.previousPromises(f)}function H(j){var G=t.select(j.node().parentNode);if(A&&A.selection&&A.side&&L){G.attr("transform",null);var W=a[A.side],Q=A.side==="left"||A.side==="top"?-1:1,$=h(A.pad)?A.pad:2,ee=r.bBox(G.node()),ie={left:0,top:0,right:_.width,bottom:_.height},ae=A.maxShift||Q*(ie[A.side]-ee[A.side]),oe=0;if(ae<0)oe=ae;else{var de=A.offsetLeft||0,le=A.offsetTop||0;ee.left-=de,ee.right-=de,ee.top-=le,ee.bottom-=le,A.selection.each(function(){var ue=r.bBox(this);e.bBoxIntersect(ee,ue,$)&&(oe=Math.max(oe,Q*(ue[A.side]-ee[W])+$))}),oe=Math.min(ae,oe)}if(oe>0||ae<0){var fe={left:[-oe,0],right:[oe,0],top:[0,-oe],bottom:[0,oe]}[A.side];G.attr("transform",o(fe[0],fe[1]))}}}return B.call(N),J&&(L?B.on(".opacity",null):(S=0,C=!0,B.text(T).on("mouseover.opacity",function(){t.select(this).transition().duration(s.SHOW_PLACEHOLDER).style("opacity",1)}).on("mouseout.opacity",function(){t.select(this).transition().duration(s.HIDE_PLACEHOLDER).style("opacity",0)})),B.call(u.makeEditable,{gd:f}).on("edit",function(j){w!==void 0?l.call("_guiRestyle",f,v,j,w):l.call("_guiRelayout",f,v,j)}).on("cancel",function(){this.text(this.attr("data-unformatted")).call(N)}).on("input",function(j){this.text(j||" ").call(u.positionText,E.x,E.y)})),B.classed("js-placeholder",C),b}}},{"../../constants/alignment":745,"../../constants/interactions":752,"../../lib":778,"../../lib/svg_text_utils":803,"../../plots/plots":891,"../../registry":911,"../color":643,"../drawing":665,d3:169,"fast-isnumeric":241}],739:[function(n,z,q){"use strict";var t=n("../../plots/font_attributes"),h=n("../color/attributes"),p=n("../../lib/extend").extendFlat,l=n("../../plot_api/edit_types").overrideAll,e=n("../../plots/pad_attributes"),o=n("../../plot_api/plot_template").templatedArray,r=o("button",{visible:{valType:"boolean"},method:{valType:"enumerated",values:["restyle","relayout","animate","update","skip"],dflt:"restyle"},args:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},args2:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},label:{valType:"string",dflt:""},execute:{valType:"boolean",dflt:!0}});z.exports=l(o("updatemenu",{_arrayAttrRegexps:[/^updatemenus\[(0|[1-9][0-9]+)\]\.buttons/],visible:{valType:"boolean"},type:{valType:"enumerated",values:["dropdown","buttons"],dflt:"dropdown"},direction:{valType:"enumerated",values:["left","right","up","down"],dflt:"down"},active:{valType:"integer",min:-1,dflt:0},showactive:{valType:"boolean",dflt:!0},buttons:r,x:{valType:"number",min:-2,max:3,dflt:-.05},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"right"},y:{valType:"number",min:-2,max:3,dflt:1},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"top"},pad:p(e({editType:"arraydraw"}),{}),font:t({}),bgcolor:{valType:"color"},bordercolor:{valType:"color",dflt:h.borderLine},borderwidth:{valType:"number",min:0,dflt:1,editType:"arraydraw"}}),"arraydraw","from-root")},{"../../lib/extend":768,"../../plot_api/edit_types":810,"../../plot_api/plot_template":817,"../../plots/font_attributes":856,"../../plots/pad_attributes":890,"../color/attributes":642}],740:[function(n,z,q){"use strict";z.exports={name:"updatemenus",containerClassName:"updatemenu-container",headerGroupClassName:"updatemenu-header-group",headerClassName:"updatemenu-header",headerArrowClassName:"updatemenu-header-arrow",dropdownButtonGroupClassName:"updatemenu-dropdown-button-group",dropdownButtonClassName:"updatemenu-dropdown-button",buttonClassName:"updatemenu-button",itemRectClassName:"updatemenu-item-rect",itemTextClassName:"updatemenu-item-text",menuIndexAttrName:"updatemenu-active-index",autoMarginIdRoot:"updatemenu-",blankHeaderOpts:{label:"  "},minWidth:30,minHeight:30,textPadX:24,arrowPadX:16,rx:2,ry:2,textOffsetX:12,textOffsetY:3,arrowOffsetX:4,gapButtonHeader:5,gapButton:2,activeColor:"#F4FAFF",hoverColor:"#F4FAFF",arrowSymbol:{left:"\u25C4",right:"\u25BA",up:"\u25B2",down:"\u25BC"}}},{}],741:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../../plots/array_container_defaults"),p=n("./attributes"),l=n("./constants").name,e=p.buttons;function o(i,u,s){function a(c,f){return t.coerce(i,u,p,c,f)}a("visible",h(i,u,{name:"buttons",handleItemDefaults:r}).length>0)&&(a("active"),a("direction"),a("type"),a("showactive"),a("x"),a("y"),t.noneOrAll(i,u,["x","y"]),a("xanchor"),a("yanchor"),a("pad.t"),a("pad.r"),a("pad.b"),a("pad.l"),t.coerceFont(a,"font",s.font),a("bgcolor",s.paper_bgcolor),a("bordercolor"),a("borderwidth"))}function r(i,u){function s(a,c){return t.coerce(i,u,e,a,c)}s("visible",i.method==="skip"||Array.isArray(i.args))&&(s("method"),s("args"),s("args2"),s("label"),s("execute"))}z.exports=function(i,u){h(i,u,{name:l,handleItemDefaults:o})}},{"../../lib":778,"../../plots/array_container_defaults":823,"./attributes":739,"./constants":740}],742:[function(n,z,q){"use strict";var t=n("d3"),h=n("../../plots/plots"),p=n("../color"),l=n("../drawing"),e=n("../../lib"),o=n("../../lib/svg_text_utils"),r=n("../../plot_api/plot_template").arrayEditor,i=n("../../constants/alignment").LINE_SPACING,u=n("./constants"),s=n("./scrollbox");function a(S){return S._index}function c(S,C){return+S.attr(u.menuIndexAttrName)===C._index}function f(S,C,k,L,I,R,V,O){C.active=V,r(S.layout,u.name,C).applyUpdate("active",V),C.type==="buttons"?d(S,L,null,null,C):C.type==="dropdown"&&(I.attr(u.menuIndexAttrName,"-1"),g(S,L,I,R,C),O||d(S,L,I,R,C))}function g(S,C,k,L,I){var R=e.ensureSingle(C,"g",u.headerClassName,function(N){N.style("pointer-events","all")}),V=I._dims,O=I.active,J=I.buttons[O]||u.blankHeaderOpts,D={y:I.pad.t,yPad:0,x:I.pad.l,xPad:0,index:0},B={width:V.headerWidth,height:V.headerHeight};R.call(m,I,J,S).call(b,I,D,B),e.ensureSingle(C,"text",u.headerArrowClassName,function(N){N.attr("text-anchor","end").call(l.font,I.font).text(u.arrowSymbol[I.direction])}).attr({x:V.headerWidth-u.arrowOffsetX+I.pad.l,y:V.headerHeight/2+u.textOffsetY+I.pad.t}),R.on("click",function(){k.call(_,String(c(k,I)?-1:I._index)),d(S,C,k,L,I)}),R.on("mouseover",function(){R.call(w)}),R.on("mouseout",function(){R.call(A,I)}),l.setTranslate(C,V.lx,V.ly)}function d(S,C,k,L,I){k||(k=C).attr("pointer-events","all");var R=function(W){return+W.attr(u.menuIndexAttrName)==-1}(k)&&I.type!=="buttons"?[]:I.buttons,V=I.type==="dropdown"?u.dropdownButtonClassName:u.buttonClassName,O=k.selectAll("g."+V).data(e.filterVisible(R)),J=O.enter().append("g").classed(V,!0),D=O.exit();I.type==="dropdown"?(J.attr("opacity","0").transition().attr("opacity","1"),D.transition().attr("opacity","0").remove()):D.remove();var B=0,N=0,F=I._dims,H=["up","down"].indexOf(I.direction)!==-1;I.type==="dropdown"&&(H?N=F.headerHeight+u.gapButtonHeader:B=F.headerWidth+u.gapButtonHeader),I.type==="dropdown"&&I.direction==="up"&&(N=-u.gapButtonHeader+u.gapButton-F.openHeight),I.type==="dropdown"&&I.direction==="left"&&(B=-u.gapButtonHeader+u.gapButton-F.openWidth);var j={x:F.lx+B+I.pad.l,y:F.ly+N+I.pad.t,yPad:u.gapButton,xPad:u.gapButton,index:0},G={l:j.x+I.borderwidth,t:j.y+I.borderwidth};O.each(function(W,Q){var $=t.select(this);$.call(m,I,W,S).call(b,I,j),$.on("click",function(){t.event.defaultPrevented||(W.execute&&(W.args2&&I.active===Q?(f(S,I,0,C,k,L,-1),h.executeAPICommand(S,W.method,W.args2)):(f(S,I,0,C,k,L,Q),h.executeAPICommand(S,W.method,W.args))),S.emit("plotly_buttonclicked",{menu:I,button:W,active:I.active}))}),$.on("mouseover",function(){$.call(w)}),$.on("mouseout",function(){$.call(A,I),O.call(T,I)})}),O.call(T,I),H?(G.w=Math.max(F.openWidth,F.headerWidth),G.h=j.y-G.t):(G.w=j.x-G.l,G.h=Math.max(F.openHeight,F.headerHeight)),G.direction=I.direction,L&&(O.size()?function(W,Q,$,ee,ie,ae){var oe,de,le,fe=ie.direction,ue=fe==="up"||fe==="down",we=ie._dims,Ae=ie.active;if(ue)for(de=0,le=0;le<Ae;le++)de+=we.heights[le]+u.gapButton;else for(oe=0,le=0;le<Ae;le++)oe+=we.widths[le]+u.gapButton;ee.enable(ae,oe,de),ee.hbar&&ee.hbar.attr("opacity","0").transition().attr("opacity","1"),ee.vbar&&ee.vbar.attr("opacity","0").transition().attr("opacity","1")}(0,0,0,L,I,G):function(W){var Q=!!W.hbar,$=!!W.vbar;Q&&W.hbar.transition().attr("opacity","0").each("end",function(){Q=!1,$||W.disable()}),$&&W.vbar.transition().attr("opacity","0").each("end",function(){$=!1,Q||W.disable()})}(L))}function m(S,C,k,L){S.call(y,C).call(v,C,k,L)}function y(S,C){e.ensureSingle(S,"rect",u.itemRectClassName,function(k){k.attr({rx:u.rx,ry:u.ry,"shape-rendering":"crispEdges"})}).call(p.stroke,C.bordercolor).call(p.fill,C.bgcolor).style("stroke-width",C.borderwidth+"px")}function v(S,C,k,L){var I=e.ensureSingle(S,"text",u.itemTextClassName,function(O){O.attr({"text-anchor":"start","data-notex":1})}),R=k.label,V=L._fullLayout._meta;V&&(R=e.templateString(R,V)),I.call(l.font,C.font).text(R).call(o.convertToTspans,L)}function T(S,C){var k=C.active;S.each(function(L,I){var R=t.select(this);I===k&&C.showactive&&R.select("rect."+u.itemRectClassName).call(p.fill,u.activeColor)})}function w(S){S.select("rect."+u.itemRectClassName).call(p.fill,u.hoverColor)}function A(S,C){S.select("rect."+u.itemRectClassName).call(p.fill,C.bgcolor)}function E(S,C){var k=C._dims={width1:0,height1:0,heights:[],widths:[],totalWidth:0,totalHeight:0,openWidth:0,openHeight:0,lx:0,ly:0},L=l.tester.selectAll("g."+u.dropdownButtonClassName).data(e.filterVisible(C.buttons));L.enter().append("g").classed(u.dropdownButtonClassName,!0);var I=["up","down"].indexOf(C.direction)!==-1;L.each(function(B,N){var F=t.select(this);F.call(m,C,B,S);var H=F.select("."+u.itemTextClassName),j=H.node()&&l.bBox(H.node()).width,G=Math.max(j+u.textPadX,u.minWidth),W=C.font.size*i,Q=o.lineCount(H),$=Math.max(W*Q,u.minHeight)+u.textOffsetY;$=Math.ceil($),G=Math.ceil(G),k.widths[N]=G,k.heights[N]=$,k.height1=Math.max(k.height1,$),k.width1=Math.max(k.width1,G),I?(k.totalWidth=Math.max(k.totalWidth,G),k.openWidth=k.totalWidth,k.totalHeight+=$+u.gapButton,k.openHeight+=$+u.gapButton):(k.totalWidth+=G+u.gapButton,k.openWidth+=G+u.gapButton,k.totalHeight=Math.max(k.totalHeight,$),k.openHeight=k.totalHeight)}),I?k.totalHeight-=u.gapButton:k.totalWidth-=u.gapButton,k.headerWidth=k.width1+u.arrowPadX,k.headerHeight=k.height1,C.type==="dropdown"&&(I?(k.width1+=u.arrowPadX,k.totalHeight=k.height1):k.totalWidth=k.width1,k.totalWidth+=u.arrowPadX),L.remove();var R=k.totalWidth+C.pad.l+C.pad.r,V=k.totalHeight+C.pad.t+C.pad.b,O=S._fullLayout._size;k.lx=O.l+O.w*C.x,k.ly=O.t+O.h*(1-C.y);var J="left";e.isRightAnchor(C)&&(k.lx-=R,J="right"),e.isCenterAnchor(C)&&(k.lx-=R/2,J="center");var D="top";e.isBottomAnchor(C)&&(k.ly-=V,D="bottom"),e.isMiddleAnchor(C)&&(k.ly-=V/2,D="middle"),k.totalWidth=Math.ceil(k.totalWidth),k.totalHeight=Math.ceil(k.totalHeight),k.lx=Math.round(k.lx),k.ly=Math.round(k.ly),h.autoMargin(S,M(C),{x:C.x,y:C.y,l:R*({right:1,center:.5}[J]||0),r:R*({left:1,center:.5}[J]||0),b:V*({top:1,middle:.5}[D]||0),t:V*({bottom:1,middle:.5}[D]||0)})}function M(S){return u.autoMarginIdRoot+S._index}function b(S,C,k,L){L=L||{};var I=S.select("."+u.itemRectClassName),R=S.select("."+u.itemTextClassName),V=C.borderwidth,O=k.index,J=C._dims;l.setTranslate(S,V+k.x,V+k.y);var D=["up","down"].indexOf(C.direction)!==-1,B=L.height||(D?J.heights[O]:J.height1);I.attr({x:0,y:0,width:L.width||(D?J.width1:J.widths[O]),height:B});var N=C.font.size*i,F=(o.lineCount(R)-1)*N/2;o.positionText(R,u.textOffsetX,B/2-F+u.textOffsetY),D?k.y+=J.heights[O]+k.yPad:k.x+=J.widths[O]+k.xPad,k.index++}function _(S,C){S.attr(u.menuIndexAttrName,C||"-1").selectAll("g."+u.dropdownButtonClassName).remove()}z.exports=function(S){var C=S._fullLayout,k=e.filterVisible(C[u.name]);function L(N){h.autoMargin(S,M(N))}var I=C._menulayer.selectAll("g."+u.containerClassName).data(k.length>0?[0]:[]);if(I.enter().append("g").classed(u.containerClassName,!0).style("cursor","pointer"),I.exit().each(function(){t.select(this).selectAll("g."+u.headerGroupClassName).each(L)}).remove(),k.length!==0){var R=I.selectAll("g."+u.headerGroupClassName).data(k,a);R.enter().append("g").classed(u.headerGroupClassName,!0);for(var V=e.ensureSingle(I,"g",u.dropdownButtonGroupClassName,function(N){N.style("pointer-events","all")}),O=0;O<k.length;O++){var J=k[O];E(S,J)}var D="updatemenus"+C._uid,B=new s(S,V,D);R.enter().size()&&(V.node().parentNode.appendChild(V.node()),V.call(_)),R.exit().each(function(N){V.call(_),L(N)}).remove(),R.each(function(N){var F=t.select(this),H=N.type==="dropdown"?V:null;h.manageCommandObserver(S,N,N.buttons,function(j){f(S,N,N.buttons[j.index],F,H,B,j.index,!0)}),N.type==="dropdown"?(g(S,F,V,B,N),c(V,N)&&d(S,F,V,B,N)):d(S,F,null,null,N)})}}},{"../../constants/alignment":745,"../../lib":778,"../../lib/svg_text_utils":803,"../../plot_api/plot_template":817,"../../plots/plots":891,"../color":643,"../drawing":665,"./constants":740,"./scrollbox":744,d3:169}],743:[function(n,z,q){arguments[4][737][0].apply(q,arguments)},{"./attributes":739,"./constants":740,"./defaults":741,"./draw":742,dup:737}],744:[function(n,z,q){"use strict";z.exports=e;var t=n("d3"),h=n("../color"),p=n("../drawing"),l=n("../../lib");function e(o,r,i){this.gd=o,this.container=r,this.id=i,this.position=null,this.translateX=null,this.translateY=null,this.hbar=null,this.vbar=null,this.bg=this.container.selectAll("rect.scrollbox-bg").data([0]),this.bg.exit().on(".drag",null).on("wheel",null).remove(),this.bg.enter().append("rect").classed("scrollbox-bg",!0).style("pointer-events","all").attr({opacity:0,x:0,y:0,width:0,height:0})}e.barWidth=2,e.barLength=20,e.barRadius=2,e.barPad=1,e.barColor="#808BA4",e.prototype.enable=function(o,r,i){var u=this.gd._fullLayout,s=u.width,a=u.height;this.position=o;var c,f,g,d,m=this.position.l,y=this.position.w,v=this.position.t,T=this.position.h,w=this.position.direction,A=w==="down",E=w==="left",M=w==="up",b=y,_=T;A||E||w==="right"||M||(this.position.direction="down",A=!0),A||M?(f=(c=m)+b,A?(g=v,_=(d=Math.min(g+_,a))-g):_=(d=v+_)-(g=Math.max(d-_,0))):(d=(g=v)+_,E?b=(f=m+b)-(c=Math.max(f-b,0)):(c=m,b=(f=Math.min(c+b,s))-c)),this._box={l:c,t:g,w:b,h:_};var S=y>b,C=e.barLength+2*e.barPad,k=e.barWidth+2*e.barPad,L=m,I=v+T;I+k>a&&(I=a-k);var R=this.container.selectAll("rect.scrollbar-horizontal").data(S?[0]:[]);R.exit().on(".drag",null).remove(),R.enter().append("rect").classed("scrollbar-horizontal",!0).call(h.fill,e.barColor),S?(this.hbar=R.attr({rx:e.barRadius,ry:e.barRadius,x:L,y:I,width:C,height:k}),this._hbarXMin=L+C/2,this._hbarTranslateMax=b-C):(delete this.hbar,delete this._hbarXMin,delete this._hbarTranslateMax);var V=T>_,O=e.barWidth+2*e.barPad,J=e.barLength+2*e.barPad,D=m+y,B=v;D+O>s&&(D=s-O);var N=this.container.selectAll("rect.scrollbar-vertical").data(V?[0]:[]);N.exit().on(".drag",null).remove(),N.enter().append("rect").classed("scrollbar-vertical",!0).call(h.fill,e.barColor),V?(this.vbar=N.attr({rx:e.barRadius,ry:e.barRadius,x:D,y:B,width:O,height:J}),this._vbarYMin=B+J/2,this._vbarTranslateMax=_-J):(delete this.vbar,delete this._vbarYMin,delete this._vbarTranslateMax);var F=this.id,H=c-.5,j=V?f+O+.5:f+.5,G=g-.5,W=S?d+k+.5:d+.5,Q=u._topdefs.selectAll("#"+F).data(S||V?[0]:[]);if(Q.exit().remove(),Q.enter().append("clipPath").attr("id",F).append("rect"),S||V?(this._clipRect=Q.select("rect").attr({x:Math.floor(H),y:Math.floor(G),width:Math.ceil(j)-Math.floor(H),height:Math.ceil(W)-Math.floor(G)}),this.container.call(p.setClipUrl,F,this.gd),this.bg.attr({x:m,y:v,width:y,height:T})):(this.bg.attr({width:0,height:0}),this.container.on("wheel",null).on(".drag",null).call(p.setClipUrl,null),delete this._clipRect),S||V){var $=t.behavior.drag().on("dragstart",function(){t.event.sourceEvent.preventDefault()}).on("drag",this._onBoxDrag.bind(this));this.container.on("wheel",null).on("wheel",this._onBoxWheel.bind(this)).on(".drag",null).call($);var ee=t.behavior.drag().on("dragstart",function(){t.event.sourceEvent.preventDefault(),t.event.sourceEvent.stopPropagation()}).on("drag",this._onBarDrag.bind(this));S&&this.hbar.on(".drag",null).call(ee),V&&this.vbar.on(".drag",null).call(ee)}this.setTranslate(r,i)},e.prototype.disable=function(){(this.hbar||this.vbar)&&(this.bg.attr({width:0,height:0}),this.container.on("wheel",null).on(".drag",null).call(p.setClipUrl,null),delete this._clipRect),this.hbar&&(this.hbar.on(".drag",null),this.hbar.remove(),delete this.hbar,delete this._hbarXMin,delete this._hbarTranslateMax),this.vbar&&(this.vbar.on(".drag",null),this.vbar.remove(),delete this.vbar,delete this._vbarYMin,delete this._vbarTranslateMax)},e.prototype._onBoxDrag=function(){var o=this.translateX,r=this.translateY;this.hbar&&(o-=t.event.dx),this.vbar&&(r-=t.event.dy),this.setTranslate(o,r)},e.prototype._onBoxWheel=function(){var o=this.translateX,r=this.translateY;this.hbar&&(o+=t.event.deltaY),this.vbar&&(r+=t.event.deltaY),this.setTranslate(o,r)},e.prototype._onBarDrag=function(){var o=this.translateX,r=this.translateY;if(this.hbar){var i=o+this._hbarXMin,u=i+this._hbarTranslateMax;o=(l.constrain(t.event.x,i,u)-i)/(u-i)*(this.position.w-this._box.w)}if(this.vbar){var s=r+this._vbarYMin,a=s+this._vbarTranslateMax;r=(l.constrain(t.event.y,s,a)-s)/(a-s)*(this.position.h-this._box.h)}this.setTranslate(o,r)},e.prototype.setTranslate=function(o,r){var i=this.position.w-this._box.w,u=this.position.h-this._box.h;if(o=l.constrain(o||0,0,i),r=l.constrain(r||0,0,u),this.translateX=o,this.translateY=r,this.container.call(p.setTranslate,this._box.l-this.position.l-o,this._box.t-this.position.t-r),this._clipRect&&this._clipRect.attr({x:Math.floor(this.position.l+o-.5),y:Math.floor(this.position.t+r-.5)}),this.hbar){var s=o/i;this.hbar.call(p.setTranslate,o+s*this._hbarTranslateMax,r)}if(this.vbar){var a=r/u;this.vbar.call(p.setTranslate,o,r+a*this._vbarTranslateMax)}}},{"../../lib":778,"../color":643,"../drawing":665,d3:169}],745:[function(n,z,q){"use strict";z.exports={FROM_BL:{left:0,center:.5,right:1,bottom:0,middle:.5,top:1},FROM_TL:{left:0,center:.5,right:1,bottom:1,middle:.5,top:0},FROM_BR:{left:1,center:.5,right:0,bottom:0,middle:.5,top:1},LINE_SPACING:1.3,CAP_SHIFT:.7,MID_SHIFT:.35,OPPOSITE_SIDE:{left:"right",right:"left",top:"bottom",bottom:"top"}}},{}],746:[function(n,z,q){"use strict";z.exports={axisRefDescription:function(t,h,p){return["If set to a",t,"axis id (e.g. *"+t+"* or","*"+t+"2*), the `"+t+"` position refers to a",t,"coordinate. If set to *paper*, the `"+t+"`","position refers to the distance from the",h,"of the plotting","area in normalized coordinates where *0* (*1*) corresponds to the",h,"("+p+"). If set to a",t,"axis ID followed by","*domain* (separated by a space), the position behaves like for","*paper*, but refers to the distance in fractions of the domain","length from the",h,"of the domain of that axis: e.g.,","*"+t+"2 domain* refers to the domain of the second",t," axis and a",t,"position of 0.5 refers to the","point between the",h,"and the",p,"of the domain of the","second",t,"axis."].join(" ")}}},{}],747:[function(n,z,q){"use strict";z.exports={INCREASING:{COLOR:"#3D9970",SYMBOL:"\u25B2"},DECREASING:{COLOR:"#FF4136",SYMBOL:"\u25BC"}}},{}],748:[function(n,z,q){"use strict";z.exports={FORMAT_LINK:"https://github.com/d3/d3-3.x-api-reference/blob/master/Formatting.md#d3_format",DATE_FORMAT_LINK:"https://github.com/d3/d3-time-format#locale_format"}},{}],749:[function(n,z,q){"use strict";z.exports={COMPARISON_OPS:["=","!=","<",">=",">","<="],COMPARISON_OPS2:["=","<",">=",">","<="],INTERVAL_OPS:["[]","()","[)","(]","][",")(","](",")["],SET_OPS:["{}","}{"],CONSTRAINT_REDUCTION:{"=":"=","<":"<","<=":"<",">":">",">=":">","[]":"[]","()":"[]","[)":"[]","(]":"[]","][":"][",")(":"][","](":"][",")[":"]["}}},{}],750:[function(n,z,q){"use strict";z.exports={solid:[[],0],dot:[[.5,1],200],dash:[[.5,1],50],longdash:[[.5,1],10],dashdot:[[.5,.625,.875,1],50],longdashdot:[[.5,.7,.8,1],10]}},{}],751:[function(n,z,q){"use strict";z.exports={circle:"\u25CF","circle-open":"\u25CB",square:"\u25A0","square-open":"\u25A1",diamond:"\u25C6","diamond-open":"\u25C7",cross:"+",x:"\u274C"}},{}],752:[function(n,z,q){"use strict";z.exports={SHOW_PLACEHOLDER:100,HIDE_PLACEHOLDER:1e3,DESELECTDIM:.2}},{}],753:[function(n,z,q){"use strict";z.exports={BADNUM:void 0,FP_SAFE:Number.MAX_VALUE/1e4,ONEMAXYEAR:316224e5,ONEAVGYEAR:315576e5,ONEMINYEAR:31536e6,ONEMAXQUARTER:79488e5,ONEAVGQUARTER:78894e5,ONEMINQUARTER:76896e5,ONEMAXMONTH:26784e5,ONEAVGMONTH:26298e5,ONEMINMONTH:24192e5,ONEWEEK:6048e5,ONEDAY:864e5,ONEHOUR:36e5,ONEMIN:6e4,ONESEC:1e3,EPOCHJD:24405875e-1,ALMOST_EQUAL:.999999,LOG_CLIP:10,MINUS_SIGN:"\u2212"}},{}],754:[function(n,z,q){"use strict";q.xmlns="http://www.w3.org/2000/xmlns/",q.svg="http://www.w3.org/2000/svg",q.xlink="http://www.w3.org/1999/xlink",q.svgAttrs={xmlns:q.svg,"xmlns:xlink":q.xlink}},{}],755:[function(n,z,q){"use strict";q.version=n("./version").version,n("es6-promise").polyfill(),n("../build/plotcss"),n("./fonts/mathjax_config")();for(var t=n("./registry"),h=q.register=t.register,p=n("./plot_api"),l=Object.keys(p),e=0;e<l.length;e++){var o=l[e];o.charAt(0)!=="_"&&(q[o]=p[o]),h({moduleType:"apiMethod",name:o,fn:p[o]})}h(n("./traces/scatter")),h([n("./components/legend"),n("./components/fx"),n("./components/annotations"),n("./components/annotations3d"),n("./components/shapes"),n("./components/images"),n("./components/updatemenus"),n("./components/sliders"),n("./components/rangeslider"),n("./components/rangeselector"),n("./components/grid"),n("./components/errorbars"),n("./components/colorscale"),n("./components/colorbar")]),h([n("./locale-en"),n("./locale-en-us")]),window.PlotlyLocales&&Array.isArray(window.PlotlyLocales)&&(h(window.PlotlyLocales),delete window.PlotlyLocales),q.Icons=n("./fonts/ploticon"),q.Plots=n("./plots/plots"),q.Fx=n("./components/fx"),q.Snapshot=n("./snapshot"),q.PlotSchema=n("./plot_api/plot_schema"),q.Queue=n("./lib/queue"),q.d3=n("d3")},{"../build/plotcss":1,"./components/annotations":634,"./components/annotations3d":639,"./components/colorbar":649,"./components/colorscale":655,"./components/errorbars":671,"./components/fx":683,"./components/grid":687,"./components/images":692,"./components/legend":700,"./components/rangeselector":711,"./components/rangeslider":718,"./components/shapes":732,"./components/sliders":737,"./components/updatemenus":743,"./fonts/mathjax_config":756,"./fonts/ploticon":757,"./lib/queue":794,"./locale-en":808,"./locale-en-us":807,"./plot_api":812,"./plot_api/plot_schema":816,"./plots/plots":891,"./registry":911,"./snapshot":916,"./traces/scatter":1199,"./version":1370,d3:169,"es6-promise":224}],756:[function(n,z,q){"use strict";z.exports=function(){typeof MathJax<"u"&&(window.PlotlyConfig||{}).MathJaxConfig!=="local"&&(MathJax.Hub.Config({messageStyle:"none",skipStartupTypeset:!0,displayAlign:"left",tex2jax:{inlineMath:[["$","$"],["\\(","\\)"]]}}),MathJax.Hub.Configured())}},{}],757:[function(n,z,q){"use strict";z.exports={undo:{width:857.1,height:1e3,path:"m857 350q0-87-34-166t-91-137-137-92-166-34q-96 0-183 41t-147 114q-4 6-4 13t5 11l76 77q6 5 14 5 9-1 13-7 41-53 100-82t126-29q58 0 110 23t92 61 61 91 22 111-22 111-61 91-92 61-110 23q-55 0-105-20t-90-57l77-77q17-16 8-38-10-23-33-23h-250q-15 0-25 11t-11 25v250q0 24 22 33 22 10 39-8l72-72q60 57 137 88t159 31q87 0 166-34t137-92 91-137 34-166z",transform:"matrix(1 0 0 -1 0 850)"},home:{width:928.6,height:1e3,path:"m786 296v-267q0-15-11-26t-25-10h-214v214h-143v-214h-214q-15 0-25 10t-11 26v267q0 1 0 2t0 2l321 264 321-264q1-1 1-4z m124 39l-34-41q-5-5-12-6h-2q-7 0-12 3l-386 322-386-322q-7-4-13-4-7 2-12 7l-35 41q-4 5-3 13t6 12l401 334q18 15 42 15t43-15l136-114v109q0 8 5 13t13 5h107q8 0 13-5t5-13v-227l122-102q5-5 6-12t-4-13z",transform:"matrix(1 0 0 -1 0 850)"},"camera-retro":{width:1e3,height:1e3,path:"m518 386q0 8-5 13t-13 5q-37 0-63-27t-26-63q0-8 5-13t13-5 12 5 5 13q0 23 16 38t38 16q8 0 13 5t5 13z m125-73q0-59-42-101t-101-42-101 42-42 101 42 101 101 42 101-42 42-101z m-572-320h858v71h-858v-71z m643 320q0 89-62 152t-152 62-151-62-63-152 63-151 151-63 152 63 62 151z m-571 358h214v72h-214v-72z m-72-107h858v143h-462l-36-71h-360v-72z m929 143v-714q0-30-21-51t-50-21h-858q-29 0-50 21t-21 51v714q0 30 21 51t50 21h858q29 0 50-21t21-51z",transform:"matrix(1 0 0 -1 0 850)"},zoombox:{width:1e3,height:1e3,path:"m1000-25l-250 251c40 63 63 138 63 218 0 224-182 406-407 406-224 0-406-182-406-406s183-406 407-406c80 0 155 22 218 62l250-250 125 125z m-812 250l0 438 437 0 0-438-437 0z m62 375l313 0 0-312-313 0 0 312z",transform:"matrix(1 0 0 -1 0 850)"},pan:{width:1e3,height:1e3,path:"m1000 350l-187 188 0-125-250 0 0 250 125 0-188 187-187-187 125 0 0-250-250 0 0 125-188-188 186-187 0 125 252 0 0-250-125 0 187-188 188 188-125 0 0 250 250 0 0-126 187 188z",transform:"matrix(1 0 0 -1 0 850)"},zoom_plus:{width:875,height:1e3,path:"m1 787l0-875 875 0 0 875-875 0z m687-500l-187 0 0-187-125 0 0 187-188 0 0 125 188 0 0 187 125 0 0-187 187 0 0-125z",transform:"matrix(1 0 0 -1 0 850)"},zoom_minus:{width:875,height:1e3,path:"m0 788l0-876 875 0 0 876-875 0z m688-500l-500 0 0 125 500 0 0-125z",transform:"matrix(1 0 0 -1 0 850)"},autoscale:{width:1e3,height:1e3,path:"m250 850l-187 0-63 0 0-62 0-188 63 0 0 188 187 0 0 62z m688 0l-188 0 0-62 188 0 0-188 62 0 0 188 0 62-62 0z m-875-938l0 188-63 0 0-188 0-62 63 0 187 0 0 62-187 0z m875 188l0-188-188 0 0-62 188 0 62 0 0 62 0 188-62 0z m-125 188l-1 0-93-94-156 156 156 156 92-93 2 0 0 250-250 0 0-2 93-92-156-156-156 156 94 92 0 2-250 0 0-250 0 0 93 93 157-156-157-156-93 94 0 0 0-250 250 0 0 0-94 93 156 157 156-157-93-93 0 0 250 0 0 250z",transform:"matrix(1 0 0 -1 0 850)"},tooltip_basic:{width:1500,height:1e3,path:"m375 725l0 0-375-375 375-374 0-1 1125 0 0 750-1125 0z",transform:"matrix(1 0 0 -1 0 850)"},tooltip_compare:{width:1125,height:1e3,path:"m187 786l0 2-187-188 188-187 0 0 937 0 0 373-938 0z m0-499l0 1-187-188 188-188 0 0 937 0 0 376-938-1z",transform:"matrix(1 0 0 -1 0 850)"},plotlylogo:{width:1542,height:1e3,path:"m0-10h182v-140h-182v140z m228 146h183v-286h-183v286z m225 714h182v-1000h-182v1000z m225-285h182v-715h-182v715z m225 142h183v-857h-183v857z m231-428h182v-429h-182v429z m225-291h183v-138h-183v138z",transform:"matrix(1 0 0 -1 0 850)"},"z-axis":{width:1e3,height:1e3,path:"m833 5l-17 108v41l-130-65 130-66c0 0 0 38 0 39 0-1 36-14 39-25 4-15-6-22-16-30-15-12-39-16-56-20-90-22-187-23-279-23-261 0-341 34-353 59 3 60 228 110 228 110-140-8-351-35-351-116 0-120 293-142 474-142 155 0 477 22 477 142 0 50-74 79-163 96z m-374 94c-58-5-99-21-99-40 0-24 65-43 144-43 79 0 143 19 143 43 0 19-42 34-98 40v216h87l-132 135-133-135h88v-216z m167 515h-136v1c16 16 31 34 46 52l84 109v54h-230v-71h124v-1c-16-17-28-32-44-51l-89-114v-51h245v72z",transform:"matrix(1 0 0 -1 0 850)"},"3d_rotate":{width:1e3,height:1e3,path:"m922 660c-5 4-9 7-14 11-359 263-580-31-580-31l-102 28 58-400c0 1 1 1 2 2 118 108 351 249 351 249s-62 27-100 42c88 83 222 183 347 122 16-8 30-17 44-27-2 1-4 2-6 4z m36-329c0 0 64 229-88 296-62 27-124 14-175-11 157-78 225-208 249-266 8-19 11-31 11-31 2 5 6 15 11 32-5-13-8-20-8-20z m-775-239c70-31 117-50 198-32-121 80-199 346-199 346l-96-15-58-12c0 0 55-226 155-287z m603 133l-317-139c0 0 4-4 19-14 7-5 24-15 24-15s-177-147-389 4c235-287 536-112 536-112l31-22 100 299-4-1z m-298-153c6-4 14-9 24-15 0 0-17 10-24 15z",transform:"matrix(1 0 0 -1 0 850)"},camera:{width:1e3,height:1e3,path:"m500 450c-83 0-150-67-150-150 0-83 67-150 150-150 83 0 150 67 150 150 0 83-67 150-150 150z m400 150h-120c-16 0-34 13-39 29l-31 93c-6 15-23 28-40 28h-340c-16 0-34-13-39-28l-31-94c-6-15-23-28-40-28h-120c-55 0-100-45-100-100v-450c0-55 45-100 100-100h800c55 0 100 45 100 100v450c0 55-45 100-100 100z m-400-550c-138 0-250 112-250 250 0 138 112 250 250 250 138 0 250-112 250-250 0-138-112-250-250-250z m365 380c-19 0-35 16-35 35 0 19 16 35 35 35 19 0 35-16 35-35 0-19-16-35-35-35z",transform:"matrix(1 0 0 -1 0 850)"},movie:{width:1e3,height:1e3,path:"m938 413l-188-125c0 37-17 71-44 94 64 38 107 107 107 187 0 121-98 219-219 219-121 0-219-98-219-219 0-61 25-117 66-156h-115c30 33 49 76 49 125 0 103-84 187-187 187s-188-84-188-187c0-57 26-107 65-141-38-22-65-62-65-109v-250c0-70 56-126 125-126h500c69 0 125 56 125 126l188-126c34 0 62 28 62 63v375c0 35-28 63-62 63z m-750 0c-69 0-125 56-125 125s56 125 125 125 125-56 125-125-56-125-125-125z m406-1c-87 0-157 70-157 157 0 86 70 156 157 156s156-70 156-156-70-157-156-157z",transform:"matrix(1 0 0 -1 0 850)"},question:{width:857.1,height:1e3,path:"m500 82v107q0 8-5 13t-13 5h-107q-8 0-13-5t-5-13v-107q0-8 5-13t13-5h107q8 0 13 5t5 13z m143 375q0 49-31 91t-77 65-95 23q-136 0-207-119-9-14 4-24l74-55q4-4 10-4 9 0 14 7 30 38 48 51 19 14 48 14 27 0 48-15t21-33q0-21-11-34t-38-25q-35-16-65-48t-29-70v-20q0-8 5-13t13-5h107q8 0 13 5t5 13q0 10 12 27t30 28q18 10 28 16t25 19 25 27 16 34 7 45z m214-107q0-117-57-215t-156-156-215-58-216 58-155 156-58 215 58 215 155 156 216 58 215-58 156-156 57-215z",transform:"matrix(1 0 0 -1 0 850)"},disk:{width:857.1,height:1e3,path:"m214-7h429v214h-429v-214z m500 0h72v500q0 8-6 21t-11 20l-157 156q-5 6-19 12t-22 5v-232q0-22-15-38t-38-16h-322q-22 0-37 16t-16 38v232h-72v-714h72v232q0 22 16 38t37 16h465q22 0 38-16t15-38v-232z m-214 518v178q0 8-5 13t-13 5h-107q-7 0-13-5t-5-13v-178q0-8 5-13t13-5h107q7 0 13 5t5 13z m357-18v-518q0-22-15-38t-38-16h-750q-23 0-38 16t-16 38v750q0 22 16 38t38 16h517q23 0 50-12t42-26l156-157q16-15 27-42t11-49z",transform:"matrix(1 0 0 -1 0 850)"},drawopenpath:{width:70,height:70,path:"M33.21,85.65a7.31,7.31,0,0,1-2.59-.48c-8.16-3.11-9.27-19.8-9.88-41.3-.1-3.58-.19-6.68-.35-9-.15-2.1-.67-3.48-1.43-3.79-2.13-.88-7.91,2.32-12,5.86L3,32.38c1.87-1.64,11.55-9.66,18.27-6.9,2.13.87,4.75,3.14,5.17,9,.17,2.43.26,5.59.36,9.25a224.17,224.17,0,0,0,1.5,23.4c1.54,10.76,4,12.22,4.48,12.4.84.32,2.79-.46,5.76-3.59L43,80.07C41.53,81.57,37.68,85.64,33.21,85.65ZM74.81,69a11.34,11.34,0,0,0,6.09-6.72L87.26,44.5,74.72,32,56.9,38.35c-2.37.86-5.57,3.42-6.61,6L38.65,72.14l8.42,8.43ZM55,46.27a7.91,7.91,0,0,1,3.64-3.17l14.8-5.3,8,8L76.11,60.6l-.06.19a6.37,6.37,0,0,1-3,3.43L48.25,74.59,44.62,71Zm16.57,7.82A6.9,6.9,0,1,0,64.64,61,6.91,6.91,0,0,0,71.54,54.09Zm-4.05,0a2.85,2.85,0,1,1-2.85-2.85A2.86,2.86,0,0,1,67.49,54.09Zm-4.13,5.22L60.5,56.45,44.26,72.7l2.86,2.86ZM97.83,35.67,84.14,22l-8.57,8.57L89.26,44.24Zm-13.69-8,8,8-2.85,2.85-8-8Z",transform:"matrix(1 0 0 1 -15 -15)"},drawclosedpath:{width:90,height:90,path:"M88.41,21.12a26.56,26.56,0,0,0-36.18,0l-2.07,2-2.07-2a26.57,26.57,0,0,0-36.18,0,23.74,23.74,0,0,0,0,34.8L48,90.12a3.22,3.22,0,0,0,4.42,0l36-34.21a23.73,23.73,0,0,0,0-34.79ZM84,51.24,50.16,83.35,16.35,51.25a17.28,17.28,0,0,1,0-25.47,20,20,0,0,1,27.3,0l4.29,4.07a3.23,3.23,0,0,0,4.44,0l4.29-4.07a20,20,0,0,1,27.3,0,17.27,17.27,0,0,1,0,25.46ZM66.76,47.68h-33v6.91h33ZM53.35,35H46.44V68h6.91Z",transform:"matrix(1 0 0 1 -5 -5)"},lasso:{width:1031,height:1e3,path:"m1018 538c-36 207-290 336-568 286-277-48-473-256-436-463 10-57 36-108 76-151-13-66 11-137 68-183 34-28 75-41 114-42l-55-70 0 0c-2-1-3-2-4-3-10-14-8-34 5-45 14-11 34-8 45 4 1 1 2 3 2 5l0 0 113 140c16 11 31 24 45 40 4 3 6 7 8 11 48-3 100 0 151 9 278 48 473 255 436 462z m-624-379c-80 14-149 48-197 96 42 42 109 47 156 9 33-26 47-66 41-105z m-187-74c-19 16-33 37-39 60 50-32 109-55 174-68-42-25-95-24-135 8z m360 75c-34-7-69-9-102-8 8 62-16 128-68 170-73 59-175 54-244-5-9 20-16 40-20 61-28 159 121 317 333 354s407-60 434-217c28-159-121-318-333-355z",transform:"matrix(1 0 0 -1 0 850)"},selectbox:{width:1e3,height:1e3,path:"m0 850l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m285 0l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m-857-286l0-143 143 0 0 143-143 0z m857 0l0-143 143 0 0 143-143 0z m-857-285l0-143 143 0 0 143-143 0z m857 0l0-143 143 0 0 143-143 0z m-857-286l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m285 0l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z",transform:"matrix(1 0 0 -1 0 850)"},drawline:{width:70,height:70,path:"M60.64,62.3a11.29,11.29,0,0,0,6.09-6.72l6.35-17.72L60.54,25.31l-17.82,6.4c-2.36.86-5.57,3.41-6.6,6L24.48,65.5l8.42,8.42ZM40.79,39.63a7.89,7.89,0,0,1,3.65-3.17l14.79-5.31,8,8L61.94,54l-.06.19a6.44,6.44,0,0,1-3,3.43L34.07,68l-3.62-3.63Zm16.57,7.81a6.9,6.9,0,1,0-6.89,6.9A6.9,6.9,0,0,0,57.36,47.44Zm-4,0a2.86,2.86,0,1,1-2.85-2.85A2.86,2.86,0,0,1,53.32,47.44Zm-4.13,5.22L46.33,49.8,30.08,66.05l2.86,2.86ZM83.65,29,70,15.34,61.4,23.9,75.09,37.59ZM70,21.06l8,8-2.84,2.85-8-8ZM87,80.49H10.67V87H87Z",transform:"matrix(1 0 0 1 -15 -15)"},drawrect:{width:80,height:80,path:"M78,22V79H21V22H78m9-9H12V88H87V13ZM68,46.22H31V54H68ZM53,32H45.22V69H53Z",transform:"matrix(1 0 0 1 -10 -10)"},drawcircle:{width:80,height:80,path:"M50,84.72C26.84,84.72,8,69.28,8,50.3S26.84,15.87,50,15.87,92,31.31,92,50.3,73.16,84.72,50,84.72Zm0-60.59c-18.6,0-33.74,11.74-33.74,26.17S31.4,76.46,50,76.46,83.74,64.72,83.74,50.3,68.6,24.13,50,24.13Zm17.15,22h-34v7.11h34Zm-13.8-13H46.24v34h7.11Z",transform:"matrix(1 0 0 1 -10 -10)"},eraseshape:{width:80,height:80,path:"M82.77,78H31.85L6,49.57,31.85,21.14H82.77a8.72,8.72,0,0,1,8.65,8.77V69.24A8.72,8.72,0,0,1,82.77,78ZM35.46,69.84H82.77a.57.57,0,0,0,.49-.6V29.91a.57.57,0,0,0-.49-.61H35.46L17,49.57Zm32.68-34.7-24,24,5,5,24-24Zm-19,.53-5,5,24,24,5-5Z",transform:"matrix(1 0 0 1 -10 -10)"},spikeline:{width:1e3,height:1e3,path:"M512 409c0-57-46-104-103-104-57 0-104 47-104 104 0 57 47 103 104 103 57 0 103-46 103-103z m-327-39l92 0 0 92-92 0z m-185 0l92 0 0 92-92 0z m370-186l92 0 0 93-92 0z m0-184l92 0 0 92-92 0z",transform:"matrix(1.5 0 0 -1.5 0 850)"},pencil:{width:1792,height:1792,path:"M491 1536l91-91-235-235-91 91v107h128v128h107zm523-928q0-22-22-22-10 0-17 7l-542 542q-7 7-7 17 0 22 22 22 10 0 17-7l542-542q7-7 7-17zm-54-192l416 416-832 832h-416v-416zm683 96q0 53-37 90l-166 166-416-416 166-165q36-38 90-38 53 0 91 38l235 234q37 39 37 91z",transform:"matrix(1 0 0 1 0 1)"},newplotlylogo:{name:"newplotlylogo",svg:"<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 132 132'><defs><style>.cls-1 {fill: #3f4f75;} .cls-2 {fill: #80cfbe;} .cls-3 {fill: #fff;}</style></defs><title>plotly-logomark</title><g id='symbol'><rect class='cls-1' width='132' height='132' rx='6' ry='6'/><circle class='cls-2' cx='78' cy='54' r='6'/><circle class='cls-2' cx='102' cy='30' r='6'/><circle class='cls-2' cx='78' cy='30' r='6'/><circle class='cls-2' cx='54' cy='30' r='6'/><circle class='cls-2' cx='30' cy='30' r='6'/><circle class='cls-2' cx='30' cy='54' r='6'/><path class='cls-3' d='M30,72a6,6,0,0,0-6,6v24a6,6,0,0,0,12,0V78A6,6,0,0,0,30,72Z'/><path class='cls-3' d='M78,72a6,6,0,0,0-6,6v24a6,6,0,0,0,12,0V78A6,6,0,0,0,78,72Z'/><path class='cls-3' d='M54,48a6,6,0,0,0-6,6v48a6,6,0,0,0,12,0V54A6,6,0,0,0,54,48Z'/><path class='cls-3' d='M102,48a6,6,0,0,0-6,6v48a6,6,0,0,0,12,0V54A6,6,0,0,0,102,48Z'/></g></svg>"}}},{}],758:[function(n,z,q){"use strict";q.isLeftAnchor=function(t){return t.xanchor==="left"||t.xanchor==="auto"&&t.x<=1/3},q.isCenterAnchor=function(t){return t.xanchor==="center"||t.xanchor==="auto"&&t.x>1/3&&t.x<2/3},q.isRightAnchor=function(t){return t.xanchor==="right"||t.xanchor==="auto"&&t.x>=2/3},q.isTopAnchor=function(t){return t.yanchor==="top"||t.yanchor==="auto"&&t.y>=2/3},q.isMiddleAnchor=function(t){return t.yanchor==="middle"||t.yanchor==="auto"&&t.y>1/3&&t.y<2/3},q.isBottomAnchor=function(t){return t.yanchor==="bottom"||t.yanchor==="auto"&&t.y<=1/3}},{}],759:[function(n,z,q){"use strict";var t=n("./mod"),h=t.mod,p=t.modHalf,l=Math.PI,e=2*l;function o(s){return Math.abs(s[1]-s[0])>e-1e-14}function r(s,a){return p(a-s,e)}function i(s,a){if(o(a))return!0;var c,f;a[0]<a[1]?(c=a[0],f=a[1]):(c=a[1],f=a[0]),(c=h(c,e))>(f=h(f,e))&&(f+=e);var g=h(s,e),d=g+e;return g>=c&&g<=f||d>=c&&d<=f}function u(s,a,c,f,g,d,m){g=g||0,d=d||0;var y,v,T,w,A,E=o([c,f]);function M(C,k){return[C*Math.cos(k)+g,d-C*Math.sin(k)]}E?(y=0,v=l,T=e):c<f?(y=c,T=f):(y=f,T=c),s<a?(w=s,A=a):(w=a,A=s);var b,_=Math.abs(T-y)<=l?0:1;function S(C,k,L){return"A"+[C,C]+" "+[0,_,L]+" "+M(C,k)}return E?b=w===null?"M"+M(A,y)+S(A,v,0)+S(A,T,0)+"Z":"M"+M(w,y)+S(w,v,0)+S(w,T,0)+"ZM"+M(A,y)+S(A,v,1)+S(A,T,1)+"Z":w===null?(b="M"+M(A,y)+S(A,T,0),m&&(b+="L0,0Z")):b="M"+M(w,y)+"L"+M(A,y)+S(A,T,0)+"L"+M(w,T)+S(w,y,1)+"Z",b}z.exports={deg2rad:function(s){return s/180*l},rad2deg:function(s){return s/l*180},angleDelta:r,angleDist:function(s,a){return Math.abs(r(s,a))},isFullCircle:o,isAngleInsideSector:i,isPtInsideSector:function(s,a,c,f){return!!i(a,f)&&(c[0]<c[1]?(g=c[0],d=c[1]):(g=c[1],d=c[0]),s>=g&&s<=d);var g,d},pathArc:function(s,a,c,f,g){return u(null,s,a,c,f,g,0)},pathSector:function(s,a,c,f,g){return u(null,s,a,c,f,g,1)},pathAnnulus:function(s,a,c,f,g,d){return u(s,a,c,f,g,d,1)}}},{"./mod":785}],760:[function(n,z,q){"use strict";var t=Array.isArray,h=typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer:{isView:function(){return!1}},p=typeof DataView>"u"?function(){}:DataView;function l(r){return h.isView(r)&&!(r instanceof p)}function e(r){return t(r)||l(r)}function o(r,i,u){if(e(r)){if(e(r[0])){for(var s=u,a=0;a<r.length;a++)s=i(s,r[a].length);return s}return r.length}return 0}q.isTypedArray=l,q.isArrayOrTypedArray=e,q.isArray1D=function(r){return!e(r[0])},q.ensureArray=function(r,i){return t(r)||(r=[]),r.length=i,r},q.concat=function(){var r,i,u,s,a,c,f,g,d=[],m=!0,y=0;for(u=0;u<arguments.length;u++)(c=(s=arguments[u]).length)&&(i?d.push(s):(i=s,a=c),t(s)?r=!1:(m=!1,y?r!==s.constructor&&(r=!1):r=s.constructor),y+=c);if(!y)return[];if(!d.length)return i;if(m)return i.concat.apply(i,d);if(r){for((f=new r(y)).set(i),u=0;u<d.length;u++)s=d[u],f.set(s,a),a+=s.length;return f}for(f=new Array(y),g=0;g<i.length;g++)f[g]=i[g];for(u=0;u<d.length;u++){for(s=d[u],g=0;g<s.length;g++)f[a+g]=s[g];a+=g}return f},q.maxRowLength=function(r){return o(r,Math.max,0)},q.minRowLength=function(r){return o(r,Math.min,1/0)}},{}],761:[function(n,z,q){"use strict";var t=n("fast-isnumeric"),h=n("../constants/numerical").BADNUM,p=/^['"%,$#\s']+|[, ]|['"%,$#\s']+$/g;z.exports=function(l){return typeof l=="string"&&(l=l.replace(p,"")),t(l)?Number(l):h}},{"../constants/numerical":753,"fast-isnumeric":241}],762:[function(n,z,q){"use strict";z.exports=function(t){var h=t._fullLayout;h._glcanvas&&h._glcanvas.size()&&h._glcanvas.each(function(p){p.regl&&p.regl.clear({color:!0,depth:!0})})}},{}],763:[function(n,z,q){"use strict";z.exports=function(t){t._responsiveChartHandler&&(window.removeEventListener("resize",t._responsiveChartHandler),delete t._responsiveChartHandler)}},{}],764:[function(n,z,q){"use strict";var t=n("fast-isnumeric"),h=n("tinycolor2"),p=n("../plots/attributes"),l=n("../components/colorscale/scales"),e=n("../constants/interactions").DESELECTDIM,o=n("./nested_property"),r=n("./regex").counter,i=n("./mod").modHalf,u=n("./array").isArrayOrTypedArray;function s(a,c){var f=q.valObjectMeta[c.valType];if(c.arrayOk&&u(a))return!0;if(f.validateFunction)return f.validateFunction(a,c);var g={},d=g,m={set:function(y){d=y}};return f.coerceFunction(a,m,g,c),d!==g}q.valObjectMeta={data_array:{coerceFunction:function(a,c,f){u(a)?c.set(a):f!==void 0&&c.set(f)}},enumerated:{coerceFunction:function(a,c,f,g){g.coerceNumber&&(a=+a),g.values.indexOf(a)===-1?c.set(f):c.set(a)},validateFunction:function(a,c){c.coerceNumber&&(a=+a);for(var f=c.values,g=0;g<f.length;g++){var d=String(f[g]);if(d.charAt(0)==="/"&&d.charAt(d.length-1)==="/"){if(new RegExp(d.substr(1,d.length-2)).test(a))return!0}else if(a===f[g])return!0}return!1}},boolean:{coerceFunction:function(a,c,f){a===!0||a===!1?c.set(a):c.set(f)}},number:{coerceFunction:function(a,c,f,g){!t(a)||g.min!==void 0&&a<g.min||g.max!==void 0&&a>g.max?c.set(f):c.set(+a)}},integer:{coerceFunction:function(a,c,f,g){a%1||!t(a)||g.min!==void 0&&a<g.min||g.max!==void 0&&a>g.max?c.set(f):c.set(+a)}},string:{coerceFunction:function(a,c,f,g){if(typeof a!="string"){var d=typeof a=="number";g.strict!==!0&&d?c.set(String(a)):c.set(f)}else g.noBlank&&!a?c.set(f):c.set(a)}},color:{coerceFunction:function(a,c,f){h(a).isValid()?c.set(a):c.set(f)}},colorlist:{coerceFunction:function(a,c,f){Array.isArray(a)&&a.length&&a.every(function(g){return h(g).isValid()})?c.set(a):c.set(f)}},colorscale:{coerceFunction:function(a,c,f){c.set(l.get(a,f))}},angle:{coerceFunction:function(a,c,f){a==="auto"?c.set("auto"):t(a)?c.set(i(+a,360)):c.set(f)}},subplotid:{coerceFunction:function(a,c,f,g){var d=g.regex||r(f);typeof a=="string"&&d.test(a)?c.set(a):c.set(f)},validateFunction:function(a,c){var f=c.dflt;return a===f||typeof a=="string"&&!!r(f).test(a)}},flaglist:{coerceFunction:function(a,c,f,g){if(typeof a=="string")if((g.extras||[]).indexOf(a)===-1){for(var d=a.split("+"),m=0;m<d.length;){var y=d[m];g.flags.indexOf(y)===-1||d.indexOf(y)<m?d.splice(m,1):m++}d.length?c.set(d.join("+")):c.set(f)}else c.set(a);else c.set(f)}},any:{coerceFunction:function(a,c,f){a===void 0?c.set(f):c.set(a)}},info_array:{coerceFunction:function(a,c,f,g){function d(L,I,R){var V,O={set:function(J){V=J}};return R===void 0&&(R=I.dflt),q.valObjectMeta[I.valType].coerceFunction(L,O,R,I),V}var m=g.dimensions===2||g.dimensions==="1-2"&&Array.isArray(a)&&Array.isArray(a[0]);if(Array.isArray(a)){var y,v,T,w,A,E,M=g.items,b=[],_=Array.isArray(M),S=_&&m&&Array.isArray(M[0]),C=m&&_&&!S,k=_&&!C?M.length:a.length;if(f=Array.isArray(f)?f:[],m)for(y=0;y<k;y++)for(b[y]=[],T=Array.isArray(a[y])?a[y]:[],A=C?M.length:_?M[y].length:T.length,v=0;v<A;v++)w=C?M[v]:_?M[y][v]:M,(E=d(T[v],w,(f[y]||[])[v]))!==void 0&&(b[y][v]=E);else for(y=0;y<k;y++)(E=d(a[y],_?M[y]:M,f[y]))!==void 0&&(b[y]=E);c.set(b)}else c.set(f)},validateFunction:function(a,c){if(!Array.isArray(a))return!1;var f=c.items,g=Array.isArray(f),d=c.dimensions===2;if(!c.freeLength&&a.length!==f.length)return!1;for(var m=0;m<a.length;m++)if(d){if(!Array.isArray(a[m])||!c.freeLength&&a[m].length!==f[m].length)return!1;for(var y=0;y<a[m].length;y++)if(!s(a[m][y],g?f[m][y]:f))return!1}else if(!s(a[m],g?f[m]:f))return!1;return!0}}},q.coerce=function(a,c,f,g,d){var m=o(f,g).get(),y=o(a,g),v=o(c,g),T=y.get(),w=c._template;if(T===void 0&&w&&(T=o(w,g).get(),w=0),d===void 0&&(d=m.dflt),m.arrayOk&&u(T))return v.set(T),T;var A=q.valObjectMeta[m.valType].coerceFunction;A(T,v,d,m);var E=v.get();return w&&E===d&&!s(T,m)&&(A(T=o(w,g).get(),v,d,m),E=v.get()),E},q.coerce2=function(a,c,f,g,d){var m=o(a,g),y=q.coerce(a,c,f,g,d),v=m.get();return v!=null&&y},q.coerceFont=function(a,c,f){var g={};return f=f||{},g.family=a(c+".family",f.family),g.size=a(c+".size",f.size),g.color=a(c+".color",f.color),g},q.coerceHoverinfo=function(a,c,f){var g,d=c._module.attributes,m=d.hoverinfo?d:p,y=m.hoverinfo;if(f._dataLength===1){var v=y.dflt==="all"?y.flags.slice():y.dflt.split("+");v.splice(v.indexOf("name"),1),g=v.join("+")}return q.coerce(a,c,m,"hoverinfo",g)},q.coerceSelectionMarkerOpacity=function(a,c){if(a.marker){var f,g,d=a.marker.opacity;d!==void 0&&(u(d)||a.selected||a.unselected||(f=d,g=e*d),c("selected.marker.opacity",f),c("unselected.marker.opacity",g))}},q.validate=s},{"../components/colorscale/scales":658,"../constants/interactions":752,"../plots/attributes":824,"./array":760,"./mod":785,"./nested_property":786,"./regex":795,"fast-isnumeric":241,tinycolor2:576}],765:[function(n,z,q){"use strict";var t,h,p=n("d3-time-format").timeFormat,l=n("fast-isnumeric"),e=n("./loggers"),o=n("./mod").mod,r=n("../constants/numerical"),i=r.BADNUM,u=r.ONEDAY,s=r.ONEHOUR,a=r.ONEMIN,c=r.ONESEC,f=r.EPOCHJD,g=n("../registry"),d=n("d3-time-format").utcFormat,m=/^\s*(-?\d\d\d\d|\d\d)(-(\d?\d)(-(\d?\d)([ Tt]([01]?\d|2[0-3])(:([0-5]\d)(:([0-5]\d(\.\d+)?))?(Z|z|[+\-]\d\d(:?\d\d)?)?)?)?)?)?\s*$/m,y=/^\s*(-?\d\d\d\d|\d\d)(-(\d?\di?)(-(\d?\d)([ Tt]([01]?\d|2[0-3])(:([0-5]\d)(:([0-5]\d(\.\d+)?))?(Z|z|[+\-]\d\d(:?\d\d)?)?)?)?)?)?\s*$/m,v=new Date().getFullYear()-70;function T(L){return L&&g.componentsRegistry.calendars&&typeof L=="string"&&L!=="gregorian"}function w(L,I){return String(L+Math.pow(10,I)).substr(1)}q.dateTick0=function(L,I){var R=function(O,J){return T(O)?J?g.getComponentMethod("calendars","CANONICAL_SUNDAY")[O]:g.getComponentMethod("calendars","CANONICAL_TICK")[O]:J?"2000-01-02":"2000-01-01"}(L,!!I);if(I<2)return R;var V=q.dateTime2ms(R,L);return V+=u*(I-1),q.ms2DateTime(V,0,L)},q.dfltRange=function(L){return T(L)?g.getComponentMethod("calendars","DFLTRANGE")[L]:["2000-01-01","2001-01-01"]},q.isJSDate=function(L){return typeof L=="object"&&L!==null&&typeof L.getTime=="function"},q.dateTime2ms=function(L,I){if(q.isJSDate(L)){var R=L.getTimezoneOffset()*a,V=(L.getUTCMinutes()-L.getMinutes())*a+(L.getUTCSeconds()-L.getSeconds())*c+(L.getUTCMilliseconds()-L.getMilliseconds());if(V){var O=3*a;R=R-O/2+o(V-R+O/2,O)}return(L=Number(L)-R)>=t&&L<=h?L:i}if(typeof L!="string"&&typeof L!="number")return i;L=String(L);var J=T(I),D=L.charAt(0);!J||D!=="G"&&D!=="g"||(L=L.substr(1),I="");var B=J&&I.substr(0,7)==="chinese",N=L.match(B?y:m);if(!N)return i;var F=N[1],H=N[3]||"1",j=Number(N[5]||1),G=Number(N[7]||0),W=Number(N[9]||0),Q=Number(N[11]||0);if(J){if(F.length===2)return i;var $;F=Number(F);try{var ee=g.getComponentMethod("calendars","getCal")(I);if(B){var ie=H.charAt(H.length-1)==="i";H=parseInt(H,10),$=ee.newDate(F,ee.toMonthIndex(F,H,ie),j)}else $=ee.newDate(F,Number(H),j)}catch{return i}return $?($.toJD()-f)*u+G*s+W*a+Q*c:i}F=F.length===2?(Number(F)+2e3-v)%100+v:Number(F),H-=1;var ae=new Date(Date.UTC(2e3,H,j,G,W));return ae.setUTCFullYear(F),ae.getUTCMonth()!==H||ae.getUTCDate()!==j?i:ae.getTime()+Q*c},t=q.MIN_MS=q.dateTime2ms("-9999"),h=q.MAX_MS=q.dateTime2ms("9999-12-31 23:59:59.9999"),q.isDateTime=function(L,I){return q.dateTime2ms(L,I)!==i};var A=90*u,E=3*s,M=5*a;function b(L,I,R,V,O){if((I||R||V||O)&&(L+=" "+w(I,2)+":"+w(R,2),(V||O)&&(L+=":"+w(V,2),O))){for(var J=4;O%10==0;)J-=1,O/=10;L+="."+w(O,J)}return L}q.ms2DateTime=function(L,I,R){if(typeof L!="number"||!(L>=t&&L<=h))return i;I||(I=0);var V,O,J,D,B,N,F=Math.floor(10*o(L+.05,1)),H=Math.round(L-F/10);if(T(R)){var j=Math.floor(H/u)+f,G=Math.floor(o(L,u));try{V=g.getComponentMethod("calendars","getCal")(R).fromJD(j).formatDate("yyyy-mm-dd")}catch{V=d("G%Y-%m-%d")(new Date(H))}if(V.charAt(0)==="-")for(;V.length<11;)V="-0"+V.substr(1);else for(;V.length<10;)V="0"+V;O=I<A?Math.floor(G/s):0,J=I<A?Math.floor(G%s/a):0,D=I<E?Math.floor(G%a/c):0,B=I<M?G%c*10+F:0}else N=new Date(H),V=d("%Y-%m-%d")(N),O=I<A?N.getUTCHours():0,J=I<A?N.getUTCMinutes():0,D=I<E?N.getUTCSeconds():0,B=I<M?10*N.getUTCMilliseconds()+F:0;return b(V,O,J,D,B)},q.ms2DateTimeLocal=function(L){if(!(L>=t+u&&L<=h-u))return i;var I=Math.floor(10*o(L+.05,1)),R=new Date(Math.round(L-I/10));return b(p("%Y-%m-%d")(R),R.getHours(),R.getMinutes(),R.getSeconds(),10*R.getUTCMilliseconds()+I)},q.cleanDate=function(L,I,R){if(L===i)return I;if(q.isJSDate(L)||typeof L=="number"&&isFinite(L)){if(T(R))return e.error("JS Dates and milliseconds are incompatible with world calendars",L),I;if(!(L=q.ms2DateTimeLocal(+L))&&I!==void 0)return I}else if(!q.isDateTime(L,R))return e.error("unrecognized date",L),I;return L};var _=/%\d?f/g;function S(L,I,R,V){L=L.replace(_,function(J){var D=Math.min(+J.charAt(1)||6,6);return(I/1e3%1+2).toFixed(D).substr(2).replace(/0+$/,"")||"0"});var O=new Date(Math.floor(I+.05));if(T(V))try{L=g.getComponentMethod("calendars","worldCalFmt")(L,I,V)}catch{return"Invalid"}return R(L)(O)}var C=[59,59.9,59.99,59.999,59.9999];q.formatDate=function(L,I,R,V,O,J){if(O=T(O)&&O,!I)if(R==="y")I=J.year;else if(R==="m")I=J.month;else{if(R!=="d")return function(D,B){var N=o(D+.05,u),F=w(Math.floor(N/s),2)+":"+w(o(Math.floor(N/a),60),2);if(B!=="M"){l(B)||(B=0);var H=(100+Math.min(o(D/c,60),C[B])).toFixed(B).substr(1);B>0&&(H=H.replace(/0+$/,"").replace(/[\.]$/,"")),F+=":"+H}return F}(L,R)+`
`+S(J.dayMonthYear,L,V,O);I=J.dayMonth+`
`+J.year}return S(I,L,V,O)};var k=3*u;q.incrementMonth=function(L,I,R){R=T(R)&&R;var V=o(L,u);if(L=Math.round(L-V),R)try{var O=Math.round(L/u)+f,J=g.getComponentMethod("calendars","getCal")(R),D=J.fromJD(O);return I%12?J.add(D,I,"m"):J.add(D,I/12,"y"),(D.toJD()-f)*u+V}catch{e.error("invalid ms "+L+" in calendar "+R)}var B=new Date(L+k);return B.setUTCMonth(B.getUTCMonth()+I)+V-k},q.findExactDates=function(L,I){for(var R,V,O=0,J=0,D=0,B=0,N=T(I)&&g.getComponentMethod("calendars","getCal")(I),F=0;F<L.length;F++)if(V=L[F],l(V)){if(!(V%u))if(N)try{(R=N.fromJD(V/u+f)).day()===1?R.month()===1?O++:J++:D++}catch{}else(R=new Date(V)).getUTCDate()===1?R.getUTCMonth()===0?O++:J++:D++}else B++;D+=J+=O;var H=L.length-B;return{exactYears:O/H,exactMonths:J/H,exactDays:D/H}}},{"../constants/numerical":753,"../registry":911,"./loggers":782,"./mod":785,"d3-time-format":166,"fast-isnumeric":241}],766:[function(n,z,q){"use strict";var t=n("d3"),h=n("./loggers"),p=n("./matrix"),l=n("gl-mat4");function e(s){var a=s&&s.parentNode;a&&a.removeChild(s)}function o(s,a,c){var f="plotly.js-style-"+s,g=document.getElementById(f);g||((g=document.createElement("style")).setAttribute("id",f),g.appendChild(document.createTextNode("")),document.head.appendChild(g));var d=g.sheet;d.insertRule?d.insertRule(a+"{"+c+"}",0):d.addRule?d.addRule(a,c,0):h.warn("addStyleRule failed")}function r(s){var a=window.getComputedStyle(s,null),c=a.getPropertyValue("-webkit-transform")||a.getPropertyValue("-moz-transform")||a.getPropertyValue("-ms-transform")||a.getPropertyValue("-o-transform")||a.getPropertyValue("transform");return c==="none"?null:c.replace("matrix","").replace("3d","").slice(1,-1).split(",").map(function(f){return+f})}function i(s){for(var a=[];u(s);)a.push(s),s=s.parentNode;return a}function u(s){return s&&(s instanceof Element||s instanceof HTMLElement)}z.exports={getGraphDiv:function(s){var a;if(typeof s=="string"){if((a=document.getElementById(s))===null)throw new Error("No DOM element with id '"+s+"' exists on the page.");return a}if(s==null)throw new Error("DOM element provided is null or undefined");return s},isPlotDiv:function(s){var a=t.select(s);return a.node()instanceof HTMLElement&&a.size()&&a.classed("js-plotly-plot")},removeElement:e,addStyleRule:function(s,a){o("global",s,a)},addRelatedStyleRule:o,deleteRelatedStyleRule:function(s){var a="plotly.js-style-"+s,c=document.getElementById(a);c&&e(c)},getFullTransformMatrix:function(s){var a=i(s),c=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return a.forEach(function(f){var g=r(f);if(g){var d=p.convertCssMatrix(g);c=l.multiply(c,c,d)}}),c},getElementTransformMatrix:r,getElementAndAncestors:i,equalDomRects:function(s,a){return s&&a&&s.x===a.x&&s.y===a.y&&s.top===a.top&&s.left===a.left&&s.right===a.right&&s.bottom===a.bottom}}},{"./loggers":782,"./matrix":784,d3:169,"gl-mat4":292}],767:[function(n,z,q){"use strict";var t=n("events").EventEmitter,h={init:function(p){if(p._ev instanceof t)return p;var l=new t,e=new t;return p._ev=l,p._internalEv=e,p.on=l.on.bind(l),p.once=l.once.bind(l),p.removeListener=l.removeListener.bind(l),p.removeAllListeners=l.removeAllListeners.bind(l),p._internalOn=e.on.bind(e),p._internalOnce=e.once.bind(e),p._removeInternalListener=e.removeListener.bind(e),p._removeAllInternalListeners=e.removeAllListeners.bind(e),p.emit=function(o,r){typeof jQuery<"u"&&jQuery(p).trigger(o,r),l.emit(o,r),e.emit(o,r)},p},triggerHandler:function(p,l,e){var o,r;typeof jQuery<"u"&&(o=jQuery(p).triggerHandler(l,e));var i=p._ev;if(!i)return o;var u,s=i._events[l];if(!s)return o;function a(c){return c.listener?(i.removeListener(l,c.listener),c.fired?void 0:(c.fired=!0,c.listener.apply(i,[e]))):c.apply(i,[e])}for(s=Array.isArray(s)?s:[s],u=0;u<s.length-1;u++)a(s[u]);return r=a(s[u]),o!==void 0?o:r},purge:function(p){return delete p._ev,delete p.on,delete p.once,delete p.removeListener,delete p.removeAllListeners,delete p.emit,delete p._ev,delete p._internalEv,delete p._internalOn,delete p._internalOnce,delete p._removeInternalListener,delete p._removeAllInternalListeners,p}};z.exports=h},{events:110}],768:[function(n,z,q){"use strict";var t=n("./is_plain_object.js"),h=Array.isArray;function p(l,e,o,r){var i,u,s,a,c,f,g=l[0],d=l.length;if(d===2&&h(g)&&h(l[1])&&g.length===0){if(function(y,v){var T,w;for(T=0;T<y.length;T++){if((w=y[T])!==null&&typeof w=="object")return!1;w!==void 0&&(v[T]=w)}return!0}(l[1],g))return g;g.splice(0,g.length)}for(var m=1;m<d;m++)for(u in i=l[m])s=g[u],a=i[u],r&&h(a)?g[u]=a:e&&a&&(t(a)||(c=h(a)))?(c?(c=!1,f=s&&h(s)?s:[]):f=s&&t(s)?s:{},g[u]=p([f,a],e,o,r)):(typeof a<"u"||o)&&(g[u]=a);return g}q.extendFlat=function(){return p(arguments,!1,!1,!1)},q.extendDeep=function(){return p(arguments,!0,!1,!1)},q.extendDeepAll=function(){return p(arguments,!0,!0,!1)},q.extendDeepNoArrays=function(){return p(arguments,!0,!1,!0)}},{"./is_plain_object.js":779}],769:[function(n,z,q){"use strict";z.exports=function(t){for(var h={},p=[],l=0,e=0;e<t.length;e++){var o=t[e];h[o]!==1&&(h[o]=1,p[l++]=o)}return p}},{}],770:[function(n,z,q){"use strict";function t(p){return p.visible===!0}function h(p){var l=p[0].trace;return l.visible===!0&&l._length!==0}z.exports=function(p){for(var l,e=(l=p,Array.isArray(l)&&Array.isArray(l[0])&&l[0][0]&&l[0][0].trace?h:t),o=[],r=0;r<p.length;r++){var i=p[r];e(i)&&o.push(i)}return o}},{}],771:[function(n,z,q){"use strict";var t=n("d3"),h=n("country-regex"),p=n("@turf/area"),l=n("@turf/centroid"),e=n("@turf/bbox"),o=n("./identity"),r=n("./loggers"),i=n("./is_plain_object"),u=n("./nested_property"),s=n("./polygon"),a=Object.keys(h),c={"ISO-3":o,"USA-states":o,"country names":function(g){for(var d=0;d<a.length;d++){var m=a[d];if(new RegExp(h[m]).test(g.trim().toLowerCase()))return m}return r.log("Unrecognized country name: "+g+"."),!1}};function f(g){var d=g.geojson,m=window.PlotlyGeoAssets||{},y=typeof d=="string"?m[d]:d;return i(y)?y:(r.error("Oops ... something went wrong when fetching "+d),!1)}z.exports={locationToFeature:function(g,d,m){if(!d||typeof d!="string")return!1;var y,v,T,w=c[g](d);if(w){if(g==="USA-states")for(y=[],T=0;T<m.length;T++)(v=m[T]).properties&&v.properties.gu&&v.properties.gu==="USA"&&y.push(v);else y=m;for(T=0;T<y.length;T++)if((v=y[T]).id===w)return v;r.log(["Location with id",w,"does not have a matching topojson feature at this resolution."].join(" "))}return!1},feature2polygons:function(g){var d,m,y,v,T=g.geometry,w=T.coordinates,A=g.id,E=[];function M(b){for(var _=0;_<b.length-1;_++)if(b[_][0]>0&&b[_+1][0]<0)return _;return null}switch(d=A==="RUS"||A==="FJI"?function(b){var _;if(M(b)===null)_=b;else for(_=new Array(b.length),v=0;v<b.length;v++)_[v]=[b[v][0]<0?b[v][0]+360:b[v][0],b[v][1]];E.push(s.tester(_))}:A==="ATA"?function(b){var _=M(b);if(_===null)return E.push(s.tester(b));var S=new Array(b.length+1),C=0;for(v=0;v<b.length;v++)v>_?S[C++]=[b[v][0]+360,b[v][1]]:v===_?(S[C++]=b[v],S[C++]=[b[v][0],-90]):S[C++]=b[v];var k=s.tester(S);k.pts.pop(),E.push(k)}:function(b){E.push(s.tester(b))},T.type){case"MultiPolygon":for(m=0;m<w.length;m++)for(y=0;y<w[m].length;y++)d(w[m][y]);break;case"Polygon":for(m=0;m<w.length;m++)d(w[m])}return E},getTraceGeojson:f,extractTraceFeature:function(g){var d=g[0].trace,m=f(d);if(!m)return!1;var y,v={},T=[];for(y=0;y<d._length;y++){var w=g[y];(w.loc||w.loc===0)&&(v[w.loc]=w)}function A(b){var _=u(b,d.featureidkey||"id").get(),S=v[_];if(S){var C=b.geometry;if(C.type==="Polygon"||C.type==="MultiPolygon"){var k={type:"Feature",id:_,geometry:C,properties:{}};k.properties.ct=function(L){var I,R=L.geometry;if(R.type==="MultiPolygon")for(var V=R.coordinates,O=0,J=0;J<V.length;J++){var D={type:"Polygon",coordinates:V[J]},B=p.default(D);B>O&&(O=B,I=D)}else I=R;return l.default(I).geometry.coordinates}(k),S.fIn=b,S.fOut=k,T.push(k)}else r.log(["Location",S.loc,"does not have a valid GeoJSON geometry.","Traces with locationmode *geojson-id* only support","*Polygon* and *MultiPolygon* geometries."].join(" "))}delete v[_]}switch(m.type){case"FeatureCollection":var E=m.features;for(y=0;y<E.length;y++)A(E[y]);break;case"Feature":A(m);break;default:return r.warn(["Invalid GeoJSON type",(m.type||"none")+".","Traces with locationmode *geojson-id* only support","*FeatureCollection* and *Feature* types."].join(" ")),!1}for(var M in v)r.log(["Location *"+M+"*","does not have a matching feature with id-key","*"+d.featureidkey+"*."].join(" "));return T},fetchTraceGeoData:function(g){var d=window.PlotlyGeoAssets||{},m=[];function y(A){return new Promise(function(E,M){t.json(A,function(b,_){if(b){delete d[A];var S=b.status===404?'GeoJSON at URL "'+A+'" does not exist.':"Unexpected error while fetching from "+A;return M(new Error(S))}return d[A]=_,E(_)})})}function v(A){return new Promise(function(E,M){var b=0,_=setInterval(function(){return d[A]&&d[A]!=="pending"?(clearInterval(_),E(d[A])):b>100?(clearInterval(_),M("Unexpected error while fetching from "+A)):void b++},50)})}for(var T=0;T<g.length;T++){var w=g[T][0].trace.geojson;typeof w=="string"&&(d[w]?d[w]==="pending"&&m.push(v(w)):(d[w]="pending",m.push(y(w))))}return m},computeBbox:function(g){return e.default(g)}}},{"./identity":776,"./is_plain_object":779,"./loggers":782,"./nested_property":786,"./polygon":790,"@turf/area":59,"@turf/bbox":60,"@turf/centroid":61,"country-regex":139,d3:169}],772:[function(n,z,q){"use strict";var t=n("../constants/numerical").BADNUM;q.calcTraceToLineCoords=function(h){for(var p=h[0].trace.connectgaps,l=[],e=[],o=0;o<h.length;o++){var r=h[o].lonlat;r[0]!==t?e.push(r):!p&&e.length>0&&(l.push(e),e=[])}return e.length>0&&l.push(e),l},q.makeLine=function(h){return h.length===1?{type:"LineString",coordinates:h[0]}:{type:"MultiLineString",coordinates:h}},q.makePolygon=function(h){if(h.length===1)return{type:"Polygon",coordinates:h};for(var p=new Array(h.length),l=0;l<h.length;l++)p[l]=[h[l]];return{type:"MultiPolygon",coordinates:p}},q.makeBlank=function(){return{type:"Point",coordinates:[]}}},{"../constants/numerical":753}],773:[function(n,z,q){"use strict";var t,h,p,l=n("./mod").mod;function e(r,i,u,s,a,c,f,g){var d=u-r,m=a-r,y=f-a,v=s-i,T=c-i,w=g-c,A=d*w-y*v;if(A===0)return null;var E=(m*w-y*T)/A,M=(m*v-d*T)/A;return M<0||M>1||E<0||E>1?null:{x:r+d*E,y:i+v*E}}function o(r,i,u,s,a){var c=s*r+a*i;if(c<0)return s*s+a*a;if(c>u){var f=s-r,g=a-i;return f*f+g*g}var d=s*i-a*r;return d*d/u}q.segmentsIntersect=e,q.segmentDistance=function(r,i,u,s,a,c,f,g){if(e(r,i,u,s,a,c,f,g))return 0;var d=u-r,m=s-i,y=f-a,v=g-c,T=d*d+m*m,w=y*y+v*v,A=Math.min(o(d,m,T,a-r,c-i),o(d,m,T,f-r,g-i),o(y,v,w,r-a,i-c),o(y,v,w,u-a,s-c));return Math.sqrt(A)},q.getTextLocation=function(r,i,u,s){if(r===h&&s===p||(t={},h=r,p=s),t[u])return t[u];var a=r.getPointAtLength(l(u-s/2,i)),c=r.getPointAtLength(l(u+s/2,i)),f=Math.atan((c.y-a.y)/(c.x-a.x)),g=r.getPointAtLength(l(u,i)),d={x:(4*g.x+a.x+c.x)/6,y:(4*g.y+a.y+c.y)/6,theta:f};return t[u]=d,d},q.clearLocationCache=function(){h=null},q.getVisibleSegment=function(r,i,u){var s,a,c=i.left,f=i.right,g=i.top,d=i.bottom,m=0,y=r.getTotalLength(),v=y;function T(A){var E=r.getPointAtLength(A);A===0?s=E:A===y&&(a=E);var M=E.x<c?c-E.x:E.x>f?E.x-f:0,b=E.y<g?g-E.y:E.y>d?E.y-d:0;return Math.sqrt(M*M+b*b)}for(var w=T(m);w;){if((m+=w+u)>v)return;w=T(m)}for(w=T(v);w;){if(m>(v-=w+u))return;w=T(v)}return{min:m,max:v,len:v-m,total:y,isClosed:m===0&&v===y&&Math.abs(s.x-a.x)<.1&&Math.abs(s.y-a.y)<.1}},q.findPointOnPath=function(r,i,u,s){for(var a,c,f,g=(s=s||{}).pathLength||r.getTotalLength(),d=s.tolerance||.001,m=s.iterationLimit||30,y=r.getPointAtLength(0)[u]>r.getPointAtLength(g)[u]?-1:1,v=0,T=0,w=g;v<m;){if(a=(T+w)/2,f=(c=r.getPointAtLength(a))[u]-i,Math.abs(f)<d)return c;y*f>0?w=a:T=a,v++}return c}},{"./mod":785}],774:[function(n,z,q){"use strict";var t=n("fast-isnumeric"),h=n("tinycolor2"),p=n("color-normalize"),l=n("../components/colorscale"),e=n("../components/color/attributes").defaultLine,o=n("./array").isArrayOrTypedArray,r=p(e);function i(a,c){var f=a;return f[3]*=c,f}function u(a){if(t(a))return r;var c=p(a);return c.length?c:r}function s(a){return t(a)?a:1}z.exports={formatColor:function(a,c,f){var g,d,m,y,v,T=a.color,w=o(T),A=o(c),E=l.extractOpts(a),M=[];if(g=E.colorscale!==void 0?l.makeColorScaleFuncFromTrace(a):u,d=w?function(_,S){return _[S]===void 0?r:p(g(_[S]))}:u,m=A?function(_,S){return _[S]===void 0?1:s(_[S])}:s,w||A)for(var b=0;b<f;b++)y=d(T,b),v=m(c,b),M[b]=i(y,v);else M=i(p(T),c);return M},parseColorScale:function(a){var c=l.extractOpts(a),f=c.colorscale;return c.reversescale&&(f=l.flipScale(c.colorscale)),f.map(function(g){var d=g[0],m=h(g[1]).toRgb();return{index:d,rgb:[m.r,m.g,m.b,m.a]}})}}},{"../components/color/attributes":642,"../components/colorscale":655,"./array":760,"color-normalize":125,"fast-isnumeric":241,tinycolor2:576}],775:[function(n,z,q){"use strict";var t=n("./identity");function h(p){return[p]}z.exports={keyFun:function(p){return p.key},repeat:h,descend:t,wrap:h,unwrap:function(p){return p[0]}}},{"./identity":776}],776:[function(n,z,q){"use strict";z.exports=function(t){return t}},{}],777:[function(n,z,q){"use strict";z.exports=function(t,h){if(!h)return t;var p=1/Math.abs(h),l=p>1?(p*t+p*h)/p:t+h,e=String(l).length;if(e>16){var o=String(h).length;if(e>=String(t).length+o){var r=parseFloat(l).toPrecision(12);r.indexOf("e+")===-1&&(l=+r)}}return l}},{}],778:[function(n,z,q){"use strict";var t=n("d3"),h=n("d3-time-format").utcFormat,p=n("fast-isnumeric"),l=n("../constants/numerical"),e=l.FP_SAFE,o=l.BADNUM,r=z.exports={};r.nestedProperty=n("./nested_property"),r.keyedContainer=n("./keyed_container"),r.relativeAttr=n("./relative_attr"),r.isPlainObject=n("./is_plain_object"),r.toLogRange=n("./to_log_range"),r.relinkPrivateKeys=n("./relink_private");var i=n("./array");r.isTypedArray=i.isTypedArray,r.isArrayOrTypedArray=i.isArrayOrTypedArray,r.isArray1D=i.isArray1D,r.ensureArray=i.ensureArray,r.concat=i.concat,r.maxRowLength=i.maxRowLength,r.minRowLength=i.minRowLength;var u=n("./mod");r.mod=u.mod,r.modHalf=u.modHalf;var s=n("./coerce");r.valObjectMeta=s.valObjectMeta,r.coerce=s.coerce,r.coerce2=s.coerce2,r.coerceFont=s.coerceFont,r.coerceHoverinfo=s.coerceHoverinfo,r.coerceSelectionMarkerOpacity=s.coerceSelectionMarkerOpacity,r.validate=s.validate;var a=n("./dates");r.dateTime2ms=a.dateTime2ms,r.isDateTime=a.isDateTime,r.ms2DateTime=a.ms2DateTime,r.ms2DateTimeLocal=a.ms2DateTimeLocal,r.cleanDate=a.cleanDate,r.isJSDate=a.isJSDate,r.formatDate=a.formatDate,r.incrementMonth=a.incrementMonth,r.dateTick0=a.dateTick0,r.dfltRange=a.dfltRange,r.findExactDates=a.findExactDates,r.MIN_MS=a.MIN_MS,r.MAX_MS=a.MAX_MS;var c=n("./search");r.findBin=c.findBin,r.sorterAsc=c.sorterAsc,r.sorterDes=c.sorterDes,r.distinctVals=c.distinctVals,r.roundUp=c.roundUp,r.sort=c.sort,r.findIndexOfMin=c.findIndexOfMin;var f=n("./stats");r.aggNums=f.aggNums,r.len=f.len,r.mean=f.mean,r.median=f.median,r.midRange=f.midRange,r.variance=f.variance,r.stdev=f.stdev,r.interp=f.interp;var g=n("./matrix");r.init2dArray=g.init2dArray,r.transposeRagged=g.transposeRagged,r.dot=g.dot,r.translationMatrix=g.translationMatrix,r.rotationMatrix=g.rotationMatrix,r.rotationXYMatrix=g.rotationXYMatrix,r.apply3DTransform=g.apply3DTransform,r.apply2DTransform=g.apply2DTransform,r.apply2DTransform2=g.apply2DTransform2,r.convertCssMatrix=g.convertCssMatrix,r.inverseTransformMatrix=g.inverseTransformMatrix;var d=n("./angles");r.deg2rad=d.deg2rad,r.rad2deg=d.rad2deg,r.angleDelta=d.angleDelta,r.angleDist=d.angleDist,r.isFullCircle=d.isFullCircle,r.isAngleInsideSector=d.isAngleInsideSector,r.isPtInsideSector=d.isPtInsideSector,r.pathArc=d.pathArc,r.pathSector=d.pathSector,r.pathAnnulus=d.pathAnnulus;var m=n("./anchor_utils");r.isLeftAnchor=m.isLeftAnchor,r.isCenterAnchor=m.isCenterAnchor,r.isRightAnchor=m.isRightAnchor,r.isTopAnchor=m.isTopAnchor,r.isMiddleAnchor=m.isMiddleAnchor,r.isBottomAnchor=m.isBottomAnchor;var y=n("./geometry2d");r.segmentsIntersect=y.segmentsIntersect,r.segmentDistance=y.segmentDistance,r.getTextLocation=y.getTextLocation,r.clearLocationCache=y.clearLocationCache,r.getVisibleSegment=y.getVisibleSegment,r.findPointOnPath=y.findPointOnPath;var v=n("./extend");r.extendFlat=v.extendFlat,r.extendDeep=v.extendDeep,r.extendDeepAll=v.extendDeepAll,r.extendDeepNoArrays=v.extendDeepNoArrays;var T=n("./loggers");r.log=T.log,r.warn=T.warn,r.error=T.error;var w=n("./regex");r.counterRegex=w.counter;var A=n("./throttle");r.throttle=A.throttle,r.throttleDone=A.done,r.clearThrottle=A.clear;var E=n("./dom");function M(D){var B={};for(var N in D)for(var F=D[N],H=0;H<F.length;H++)B[F[H]]=+N;return B}r.getGraphDiv=E.getGraphDiv,r.isPlotDiv=E.isPlotDiv,r.removeElement=E.removeElement,r.addStyleRule=E.addStyleRule,r.addRelatedStyleRule=E.addRelatedStyleRule,r.deleteRelatedStyleRule=E.deleteRelatedStyleRule,r.getFullTransformMatrix=E.getFullTransformMatrix,r.getElementTransformMatrix=E.getElementTransformMatrix,r.getElementAndAncestors=E.getElementAndAncestors,r.equalDomRects=E.equalDomRects,r.clearResponsive=n("./clear_responsive"),r.preserveDrawingBuffer=n("./preserve_drawing_buffer"),r.makeTraceGroups=n("./make_trace_groups"),r._=n("./localize"),r.notifier=n("./notifier"),r.filterUnique=n("./filter_unique"),r.filterVisible=n("./filter_visible"),r.pushUnique=n("./push_unique"),r.increment=n("./increment"),r.cleanNumber=n("./clean_number"),r.ensureNumber=function(D){return p(D)?(D=Number(D))<-e||D>e?o:p(D)?Number(D):o:o},r.isIndex=function(D,B){return!(B!==void 0&&D>=B)&&p(D)&&D>=0&&D%1==0},r.noop=n("./noop"),r.identity=n("./identity"),r.repeat=function(D,B){for(var N=new Array(B),F=0;F<B;F++)N[F]=D;return N},r.swapAttrs=function(D,B,N,F){N||(N="x"),F||(F="y");for(var H=0;H<B.length;H++){var j=B[H],G=r.nestedProperty(D,j.replace("?",N)),W=r.nestedProperty(D,j.replace("?",F)),Q=G.get();G.set(W.get()),W.set(Q)}},r.raiseToTop=function(D){D.parentNode.appendChild(D)},r.cancelTransition=function(D){return D.transition().duration(0)},r.constrain=function(D,B,N){return B>N?Math.max(N,Math.min(B,D)):Math.max(B,Math.min(N,D))},r.bBoxIntersect=function(D,B,N){return N=N||0,D.left<=B.right+N&&B.left<=D.right+N&&D.top<=B.bottom+N&&B.top<=D.bottom+N},r.simpleMap=function(D,B,N,F,H){for(var j=D.length,G=new Array(j),W=0;W<j;W++)G[W]=B(D[W],N,F,H);return G},r.randstr=function D(B,N,F,H){if(F||(F=16),N===void 0&&(N=24),N<=0)return"0";var j,G,W=Math.log(Math.pow(2,N))/Math.log(F),Q="";for(j=2;W===1/0;j*=2)W=Math.log(Math.pow(2,N/j))/Math.log(F)*j;var $=W-Math.floor(W);for(j=0;j<Math.floor(W);j++)Q=Math.floor(Math.random()*F).toString(F)+Q;$&&(G=Math.pow(F,$),Q=Math.floor(Math.random()*G).toString(F)+Q);var ee=parseInt(Q,F);return B&&B[Q]||ee!==1/0&&ee>=Math.pow(2,N)?H>10?(r.warn("randstr failed uniqueness"),Q):D(B,N,F,(H||0)+1):Q},r.OptionControl=function(D,B){D||(D={}),B||(B="opt");var N={optionList:[],_newoption:function(F){F[B]=D,N[F.name]=F,N.optionList.push(F)}};return N["_"+B]=D,N},r.smooth=function(D,B){if((B=Math.round(B)||0)<2)return D;var N,F,H,j,G=D.length,W=2*G,Q=2*B-1,$=new Array(Q),ee=new Array(G);for(N=0;N<Q;N++)$[N]=(1-Math.cos(Math.PI*(N+1)/B))/(2*B);for(N=0;N<G;N++){for(j=0,F=0;F<Q;F++)(H=N+F+1-B)<-G?H-=W*Math.round(H/W):H>=W&&(H-=W*Math.floor(H/W)),H<0?H=-1-H:H>=G&&(H=W-1-H),j+=D[H]*$[F];ee[N]=j}return ee},r.syncOrAsync=function(D,B,N){var F;function H(){return r.syncOrAsync(D,B,N)}for(;D.length;)if((F=(0,D.splice(0,1)[0])(B))&&F.then)return F.then(H).then(void 0,r.promiseError);return N&&N(B)},r.stripTrailingSlash=function(D){return D.substr(-1)==="/"?D.substr(0,D.length-1):D},r.noneOrAll=function(D,B,N){if(D){var F,H=!1,j=!0;for(F=0;F<N.length;F++)D[N[F]]!=null?H=!0:j=!1;if(H&&!j)for(F=0;F<N.length;F++)D[N[F]]=B[N[F]]}},r.mergeArray=function(D,B,N,F){var H=typeof F=="function";if(r.isArrayOrTypedArray(D))for(var j=Math.min(D.length,B.length),G=0;G<j;G++){var W=D[G];B[G][N]=H?F(W):W}},r.mergeArrayCastPositive=function(D,B,N){return r.mergeArray(D,B,N,function(F){var H=+F;return isFinite(H)&&H>0?H:0})},r.fillArray=function(D,B,N,F){if(F=F||r.identity,r.isArrayOrTypedArray(D))for(var H=0;H<B.length;H++)B[H][N]=F(D[H])},r.castOption=function(D,B,N,F){F=F||r.identity;var H=r.nestedProperty(D,N).get();return r.isArrayOrTypedArray(H)?Array.isArray(B)&&r.isArrayOrTypedArray(H[B[0]])?F(H[B[0]][B[1]]):F(H[B]):H},r.extractOption=function(D,B,N,F){if(N in D)return D[N];var H=r.nestedProperty(B,F).get();return Array.isArray(H)?void 0:H},r.tagSelected=function(D,B,N){var F,H,j=B.selectedpoints,G=B._indexToPoints;G&&(F=M(G));for(var W=0;W<j.length;W++){var Q=j[W];if(r.isIndex(Q)||r.isArrayOrTypedArray(Q)&&r.isIndex(Q[0])&&r.isIndex(Q[1])){var $=F?F[Q]:Q,ee=N?N[$]:$;(H=ee)!==void 0&&H<D.length&&(D[ee].selected=1)}}},r.selIndices2selPoints=function(D){var B=D.selectedpoints,N=D._indexToPoints;if(N){for(var F=M(N),H=[],j=0;j<B.length;j++){var G=B[j];if(r.isIndex(G)){var W=F[G];r.isIndex(W)&&H.push(W)}}return H}return B},r.getTargetArray=function(D,B){var N=B.target;if(typeof N=="string"&&N){var F=r.nestedProperty(D,N).get();return!!Array.isArray(F)&&F}return!!Array.isArray(N)&&N},r.minExtend=function(D,B){var N={};typeof B!="object"&&(B={});var F,H,j,G=Object.keys(D);for(F=0;F<G.length;F++)j=D[H=G[F]],H.charAt(0)!=="_"&&typeof j!="function"&&(H==="module"?N[H]=j:Array.isArray(j)?N[H]=H==="colorscale"?j.slice():j.slice(0,3):r.isTypedArray(j)?N[H]=j.subarray(0,3):N[H]=j&&typeof j=="object"?r.minExtend(D[H],B[H]):j);for(G=Object.keys(B),F=0;F<G.length;F++)typeof(j=B[H=G[F]])=="object"&&H in N&&typeof N[H]=="object"||(N[H]=j);return N},r.titleCase=function(D){return D.charAt(0).toUpperCase()+D.substr(1)},r.containsAny=function(D,B){for(var N=0;N<B.length;N++)if(D.indexOf(B[N])!==-1)return!0;return!1},r.isIE=function(){return typeof window.navigator.msSaveBlob<"u"};var b=/MSIE [1-9]\./;r.isIE9orBelow=function(){return r.isIE()&&b.test(window.navigator.userAgent)};var _=/Version\/[\d\.]+.*Safari/;r.isSafari=function(){return _.test(window.navigator.userAgent)};var S=/iPad|iPhone|iPod/;r.isIOS=function(){return S.test(window.navigator.userAgent)},r.isD3Selection=function(D){return D&&typeof D.classed=="function"},r.ensureSingle=function(D,B,N,F){var H=D.select(B+(N?"."+N:""));if(H.size())return H;var j=D.append(B);return N&&j.classed(N,!0),F&&j.call(F),j},r.ensureSingleById=function(D,B,N,F){var H=D.select(B+"#"+N);if(H.size())return H;var j=D.append(B).attr("id",N);return F&&j.call(F),j},r.objectFromPath=function(D,B){for(var N,F=D.split("."),H=N={},j=0;j<F.length;j++){var G=F[j],W=null,Q=F[j].match(/(.*)\[([0-9]+)\]/);Q?(G=Q[1],W=Q[2],N=N[G]=[],j===F.length-1?N[W]=B:N[W]={},N=N[W]):(j===F.length-1?N[G]=B:N[G]={},N=N[G])}return H};var C=/^([^\[\.]+)\.(.+)?/,k=/^([^\.]+)\[([0-9]+)\](\.)?(.+)?/;r.expandObjectPaths=function(D){var B,N,F,H,j,G,W;if(typeof D=="object"&&!Array.isArray(D))for(N in D)D.hasOwnProperty(N)&&((B=N.match(C))?(H=D[N],F=B[1],delete D[N],D[F]=r.extendDeepNoArrays(D[F]||{},r.objectFromPath(N,r.expandObjectPaths(H))[F])):(B=N.match(k))?(H=D[N],F=B[1],j=parseInt(B[2]),delete D[N],D[F]=D[F]||[],B[3]==="."?(W=B[4],G=D[F][j]=D[F][j]||{},r.extendDeepNoArrays(G,r.objectFromPath(W,r.expandObjectPaths(H)))):D[F][j]=r.expandObjectPaths(H)):D[N]=r.expandObjectPaths(D[N]));return D},r.numSeparate=function(D,B,N){if(N||(N=!1),typeof B!="string"||B.length===0)throw new Error("Separator string required for formatting!");typeof D=="number"&&(D=String(D));var F=/(\d+)(\d{3})/,H=B.charAt(0),j=B.charAt(1),G=D.split("."),W=G[0],Q=G.length>1?H+G[1]:"";if(j&&(G.length>1||W.length>4||N))for(;F.test(W);)W=W.replace(F,"$1"+j+"$2");return W+Q},r.TEMPLATE_STRING_REGEX=/%{([^\s%{}:]*)([:|\|][^}]*)?}/g;var L=/^\w*$/;r.templateString=function(D,B){var N={};return D.replace(r.TEMPLATE_STRING_REGEX,function(F,H){var j;return L.test(H)?j=B[H]:(N[H]=N[H]||r.nestedProperty(B,H).get,j=N[H]()),r.isValidTextValue(j)?j:""})};var I={max:10,count:0,name:"hovertemplate"};r.hovertemplateString=function(){return O.apply(I,arguments)};var R={max:10,count:0,name:"texttemplate"};r.texttemplateString=function(){return O.apply(R,arguments)};var V=/^[:|\|]/;function O(D,B,N){var F=this,H=arguments;B||(B={});var j={};return D.replace(r.TEMPLATE_STRING_REGEX,function(G,W,Q){var $,ee,ie,ae;for(ie=3;ie<H.length;ie++)if($=H[ie]){if($.hasOwnProperty(W)){ee=$[W];break}if(L.test(W)||(ee=j[W]||r.nestedProperty($,W).get())&&(j[W]=ee),ee!==void 0)break}if(ee===void 0&&F)return F.count<F.max&&(r.warn("Variable '"+W+"' in "+F.name+" could not be found!"),ee=G),F.count===F.max&&r.warn("Too many "+F.name+" warnings - additional warnings will be suppressed"),F.count++,G;if(Q){if(Q[0]===":"&&(ee=(ae=N?N.numberFormat:t.format)(Q.replace(V,""))(ee)),Q[0]==="|"){ae=N?N.timeFormat:h;var oe=r.dateTime2ms(ee);ee=r.formatDate(oe,Q.replace(V,""),!1,ae)}}else B.hasOwnProperty(W+"Label")&&(ee=B[W+"Label"]);return ee})}r.subplotSort=function(D,B){for(var N=Math.min(D.length,B.length)+1,F=0,H=0,j=0;j<N;j++){var G=D.charCodeAt(j)||0,W=B.charCodeAt(j)||0,Q=G>=48&&G<=57,$=W>=48&&W<=57;if(Q&&(F=10*F+G-48),$&&(H=10*H+W-48),!Q||!$){if(F!==H)return F-H;if(G!==W)return G-W}}return H-F};var J=2e9;r.seedPseudoRandom=function(){J=2e9},r.pseudoRandom=function(){var D=J;return J=(69069*J+1)%4294967296,Math.abs(J-D)<429496729?r.pseudoRandom():J/4294967296},r.fillText=function(D,B,N){var F=Array.isArray(N)?function(G){N.push(G)}:function(G){N.text=G},H=r.extractOption(D,B,"htx","hovertext");if(r.isValidTextValue(H))return F(H);var j=r.extractOption(D,B,"tx","text");return r.isValidTextValue(j)?F(j):void 0},r.isValidTextValue=function(D){return D||D===0},r.formatPercent=function(D,B){B=B||0;for(var N=(Math.round(100*D*Math.pow(10,B))*Math.pow(.1,B)).toFixed(B)+"%",F=0;F<B;F++)N.indexOf(".")!==-1&&(N=(N=N.replace("0%","%")).replace(".%","%"));return N},r.isHidden=function(D){var B=window.getComputedStyle(D).display;return!B||B==="none"},r.strTranslate=function(D,B){return D||B?"translate("+D+","+B+")":""},r.strRotate=function(D){return D?"rotate("+D+")":""},r.strScale=function(D){return D!==1?"scale("+D+")":""},r.getTextTransform=function(D){var B=D.noCenter,N=D.textX,F=D.textY,H=D.targetX,j=D.targetY,G=D.anchorX||0,W=D.anchorY||0,Q=D.rotate,$=D.scale;return $?$>1&&($=1):$=0,r.strTranslate(H-$*(N+G),j-$*(F+W))+r.strScale($)+(Q?"rotate("+Q+(B?"":" "+N+" "+F)+")":"")},r.ensureUniformFontSize=function(D,B){var N=r.extendFlat({},B);return N.size=Math.max(B.size,D._fullLayout.uniformtext.minsize||0),N},r.join2=function(D,B,N){var F=D.length;return F>1?D.slice(0,-1).join(B)+N+D[F-1]:D.join(B)}},{"../constants/numerical":753,"./anchor_utils":758,"./angles":759,"./array":760,"./clean_number":761,"./clear_responsive":763,"./coerce":764,"./dates":765,"./dom":766,"./extend":768,"./filter_unique":769,"./filter_visible":770,"./geometry2d":773,"./identity":776,"./increment":777,"./is_plain_object":779,"./keyed_container":780,"./localize":781,"./loggers":782,"./make_trace_groups":783,"./matrix":784,"./mod":785,"./nested_property":786,"./noop":787,"./notifier":788,"./preserve_drawing_buffer":792,"./push_unique":793,"./regex":795,"./relative_attr":796,"./relink_private":797,"./search":798,"./stats":801,"./throttle":804,"./to_log_range":805,d3:169,"d3-time-format":166,"fast-isnumeric":241}],779:[function(n,z,q){"use strict";z.exports=function(t){return window&&window.process&&window.process.versions?Object.prototype.toString.call(t)==="[object Object]":Object.prototype.toString.call(t)==="[object Object]"&&Object.getPrototypeOf(t)===Object.prototype}},{}],780:[function(n,z,q){"use strict";var t=n("./nested_property"),h=/^\w*$/;z.exports=function(p,l,e,o){var r,i,u;e=e||"name",o=o||"value";var s={};l&&l.length?(u=t(p,l),i=u.get()):i=p,l=l||"";var a={};if(i)for(r=0;r<i.length;r++)a[i[r][e]]=r;var c=h.test(o),f={set:function(g,d){var m=d===null?4:0;if(!i){if(!u||m===4)return;i=[],u.set(i)}var y=a[g];if(y===void 0){if(m===4)return;m|=3,y=i.length,a[g]=y}else d!==(c?i[y][o]:t(i[y],o).get())&&(m|=2);var v=i[y]=i[y]||{};return v[e]=g,c?v[o]=d:t(v,o).set(d),d!==null&&(m&=-5),s[y]=s[y]|m,f},get:function(g){if(i){var d=a[g];return d===void 0?void 0:c?i[d][o]:t(i[d],o).get()}},rename:function(g,d){var m=a[g];return m===void 0||(s[m]=1|s[m],a[d]=m,delete a[g],i[m][e]=d),f},remove:function(g){var d=a[g];if(d===void 0)return f;var m=i[d];if(Object.keys(m).length>2)return s[d]=2|s[d],f.set(g,null);if(c){for(r=d;r<i.length;r++)s[r]=3|s[r];for(r=d;r<i.length;r++)a[i[r][e]]--;i.splice(d,1),delete a[g]}else t(m,o).set(null),s[d]=6|s[d];return f},constructUpdate:function(){for(var g,d,m={},y=Object.keys(s),v=0;v<y.length;v++)d=y[v],g=l+"["+d+"]",i[d]?(1&s[d]&&(m[g+"."+e]=i[d][e]),2&s[d]&&(m[g+"."+o]=c?4&s[d]?null:i[d][o]:4&s[d]?null:t(i[d],o).get())):m[g]=null;return m}};return f}},{"./nested_property":786}],781:[function(n,z,q){"use strict";var t=n("../registry");z.exports=function(h,p){for(var l=h._context.locale,e=0;e<2;e++){for(var o=h._context.locales,r=0;r<2;r++){var i=(o[l]||{}).dictionary;if(i){var u=i[p];if(u)return u}o=t.localeRegistry}var s=l.split("-")[0];if(s===l)break;l=s}return p}},{"../registry":911}],782:[function(n,z,q){"use strict";var t=n("../plot_api/plot_config").dfltConfig,h=n("./notifier"),p=z.exports={};function l(e,o){if(e&&e.apply)try{return void e.apply(console,o)}catch{}for(var r=0;r<o.length;r++)try{e(o[r])}catch{console.log(o[r])}}p.log=function(){var e;if(t.logging>1){var o=["LOG:"];for(e=0;e<arguments.length;e++)o.push(arguments[e]);l(console.trace||console.log,o)}if(t.notifyOnLogging>1){var r=[];for(e=0;e<arguments.length;e++)r.push(arguments[e]);h(r.join("<br>"),"long")}},p.warn=function(){var e;if(t.logging>0){var o=["WARN:"];for(e=0;e<arguments.length;e++)o.push(arguments[e]);l(console.trace||console.log,o)}if(t.notifyOnLogging>0){var r=[];for(e=0;e<arguments.length;e++)r.push(arguments[e]);h(r.join("<br>"),"stick")}},p.error=function(){var e;if(t.logging>0){var o=["ERROR:"];for(e=0;e<arguments.length;e++)o.push(arguments[e]);l(console.error,o)}if(t.notifyOnLogging>0){var r=[];for(e=0;e<arguments.length;e++)r.push(arguments[e]);h(r.join("<br>"),"stick")}}},{"../plot_api/plot_config":815,"./notifier":788}],783:[function(n,z,q){"use strict";var t=n("d3");z.exports=function(h,p,l){var e=h.selectAll("g."+l.replace(/\s/g,".")).data(p,function(r){return r[0].trace.uid});e.exit().remove(),e.enter().append("g").attr("class",l),e.order();var o=h.classed("rangeplot")?"nodeRangePlot3":"node3";return e.each(function(r){r[0][o]=t.select(this)}),e}},{d3:169}],784:[function(n,z,q){"use strict";var t=n("gl-mat4");q.init2dArray=function(h,p){for(var l=new Array(h),e=0;e<h;e++)l[e]=new Array(p);return l},q.transposeRagged=function(h){var p,l,e=0,o=h.length;for(p=0;p<o;p++)e=Math.max(e,h[p].length);var r=new Array(e);for(p=0;p<e;p++)for(r[p]=new Array(o),l=0;l<o;l++)r[p][l]=h[l][p];return r},q.dot=function(h,p){if(!h.length||!p.length||h.length!==p.length)return null;var l,e,o=h.length;if(h[0].length)for(l=new Array(o),e=0;e<o;e++)l[e]=q.dot(h[e],p);else if(p[0].length){var r=q.transposeRagged(p);for(l=new Array(r.length),e=0;e<r.length;e++)l[e]=q.dot(h,r[e])}else for(l=0,e=0;e<o;e++)l+=h[e]*p[e];return l},q.translationMatrix=function(h,p){return[[1,0,h],[0,1,p],[0,0,1]]},q.rotationMatrix=function(h){var p=h*Math.PI/180;return[[Math.cos(p),-Math.sin(p),0],[Math.sin(p),Math.cos(p),0],[0,0,1]]},q.rotationXYMatrix=function(h,p,l){return q.dot(q.dot(q.translationMatrix(p,l),q.rotationMatrix(h)),q.translationMatrix(-p,-l))},q.apply3DTransform=function(h){return function(){var p=arguments,l=arguments.length===1?p[0]:[p[0],p[1],p[2]||0];return q.dot(h,[l[0],l[1],l[2],1]).slice(0,3)}},q.apply2DTransform=function(h){return function(){var p=arguments;p.length===3&&(p=p[0]);var l=arguments.length===1?p[0]:[p[0],p[1]];return q.dot(h,[l[0],l[1],1]).slice(0,2)}},q.apply2DTransform2=function(h){var p=q.apply2DTransform(h);return function(l){return p(l.slice(0,2)).concat(p(l.slice(2,4)))}},q.convertCssMatrix=function(h){if(h){var p=h.length;if(p===16)return h;if(p===6)return[h[0],h[1],0,0,h[2],h[3],0,0,0,0,1,0,h[4],h[5],0,1]}return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},q.inverseTransformMatrix=function(h){var p=[];return t.invert(p,h),[[p[0],p[1],p[2],p[3]],[p[4],p[5],p[6],p[7]],[p[8],p[9],p[10],p[11]],[p[12],p[13],p[14],p[15]]]}},{"gl-mat4":292}],785:[function(n,z,q){"use strict";z.exports={mod:function(t,h){var p=t%h;return p<0?p+h:p},modHalf:function(t,h){return Math.abs(t)>h/2?t-Math.round(t/h)*h:t}}},{}],786:[function(n,z,q){"use strict";var t=n("fast-isnumeric"),h=n("./array").isArrayOrTypedArray;function p(s,a){return function(){var c,f,g,d,m,y=s;for(d=0;d<a.length-1;d++){if((c=a[d])===-1){for(f=!0,g=[],m=0;m<y.length;m++)g[m]=p(y[m],a.slice(d+1))(),g[m]!==g[0]&&(f=!1);return f?g[0]:g}if(typeof c=="number"&&!h(y)||typeof(y=y[c])!="object"||y===null)return}if(typeof y=="object"&&y!==null&&(g=y[a[d]])!==null)return g}}z.exports=function(s,a){if(t(a))a=String(a);else if(typeof a!="string"||a.substr(a.length-4)==="[-1]")throw"bad property string";for(var c,f,g,d=0,m=a.split(".");d<m.length;){if(c=String(m[d]).match(/^([^\[\]]*)((\[\-?[0-9]*\])+)$/)){if(c[1])m[d]=c[1];else{if(d!==0)throw"bad property string";m.splice(0,1)}for(f=c[2].substr(1,c[2].length-2).split("]["),g=0;g<f.length;g++)d++,m.splice(d,0,Number(f[g]))}d++}return typeof s!="object"?function(y,v,T){return{set:function(){throw"bad container"},get:function(){},astr:v,parts:T,obj:y}}(s,a,m):{set:o(s,m,a),get:p(s,m),astr:a,parts:m,obj:s}};var l=/(^|\.)args\[/;function e(s,a){return s===void 0||s===null&&!a.match(l)}function o(s,a,c){return function(f){var g,d,m=s,y="",v=[[s,y]],T=e(f,c);for(d=0;d<a.length-1;d++){if(typeof(g=a[d])=="number"&&!h(m))throw"array index but container is not an array";if(g===-1){if(T=!i(m,a.slice(d+1),f,c))break;return}if(!u(m,g,a[d+1],T))break;if(typeof(m=m[g])!="object"||m===null)throw"container is not an object";y=r(y,g),v.push([m,y])}if(T){if(d===a.length-1&&(delete m[a[d]],Array.isArray(m)&&+a[d]==m.length-1))for(;m.length&&m[m.length-1]===void 0;)m.pop()}else m[a[d]]=f}}function r(s,a){var c=a;return t(a)?c="["+a+"]":s&&(c="."+a),s+c}function i(s,a,c,f){var g,d=h(c),m=!0,y=c,v=f.replace("-1",0),T=!d&&e(c,v),w=a[0];for(g=0;g<s.length;g++)v=f.replace("-1",g),d&&(T=e(y=c[g%c.length],v)),T&&(m=!1),u(s,g,w,T)&&o(s[g],a,f.replace("-1",g))(y);return m}function u(s,a,c,f){if(s[a]===void 0){if(f)return!1;s[a]=typeof c=="number"?[]:{}}return!0}},{"./array":760,"fast-isnumeric":241}],787:[function(n,z,q){"use strict";z.exports=function(){}},{}],788:[function(n,z,q){"use strict";var t=n("d3"),h=n("fast-isnumeric"),p=[];z.exports=function(l,e){if(p.indexOf(l)===-1){p.push(l);var o=1e3;h(e)?o=e:e==="long"&&(o=3e3);var r=t.select("body").selectAll(".plotly-notifier").data([0]);r.enter().append("div").classed("plotly-notifier",!0),r.selectAll(".notifier-note").data(p).enter().append("div").classed("notifier-note",!0).style("opacity",0).each(function(u){var s=t.select(this);s.append("button").classed("notifier-close",!0).html("&times;").on("click",function(){s.transition().call(i)});for(var a=s.append("p"),c=u.split(/<br\s*\/?>/g),f=0;f<c.length;f++)f&&a.append("br"),a.append("span").text(c[f]);e==="stick"?s.transition().duration(350).style("opacity",1):s.transition().duration(700).style("opacity",1).transition().delay(o).call(i)})}function i(u){u.duration(700).style("opacity",0).each("end",function(s){var a=p.indexOf(s);a!==-1&&p.splice(a,1),t.select(this).remove()})}}},{d3:169,"fast-isnumeric":241}],789:[function(n,z,q){"use strict";var t=n("./setcursor"),h="data-savedcursor";z.exports=function(p,l){var e=p.attr(h);if(l){if(!e){for(var o=(p.attr("class")||"").split(" "),r=0;r<o.length;r++){var i=o[r];i.indexOf("cursor-")===0&&p.attr(h,i.substr(7)).classed(i,!1)}p.attr(h)||p.attr(h,"!!")}t(p,l)}else e&&(p.attr(h,null),e==="!!"?t(p):t(p,e))}},{"./setcursor":799}],790:[function(n,z,q){"use strict";var t=n("./matrix").dot,h=n("../constants/numerical").BADNUM,p=z.exports={};p.tester=function(l){var e,o=l.slice(),r=o[0][0],i=r,u=o[0][1],s=u;for(o.push(o[0]),e=1;e<o.length;e++)r=Math.min(r,o[e][0]),i=Math.max(i,o[e][0]),u=Math.min(u,o[e][1]),s=Math.max(s,o[e][1]);var a,c=!1;o.length===5&&(o[0][0]===o[1][0]?o[2][0]===o[3][0]&&o[0][1]===o[3][1]&&o[1][1]===o[2][1]&&(c=!0,a=function(d){return d[0]===o[0][0]}):o[0][1]===o[1][1]&&o[2][1]===o[3][1]&&o[0][0]===o[3][0]&&o[1][0]===o[2][0]&&(c=!0,a=function(d){return d[1]===o[0][1]}));var f=!0,g=o[0];for(e=1;e<o.length;e++)if(g[0]!==o[e][0]||g[1]!==o[e][1]){f=!1;break}return{xmin:r,xmax:i,ymin:u,ymax:s,pts:o,contains:c?function(d,m){var y=d[0],v=d[1];return!(y===h||y<r||y>i||v===h||v<u||v>s)&&(!m||!a(d))}:function(d,m){var y=d[0],v=d[1];if(y===h||y<r||y>i||v===h||v<u||v>s)return!1;var T,w,A,E,M,b=o.length,_=o[0][0],S=o[0][1],C=0;for(T=1;T<b;T++)if(w=_,A=S,_=o[T][0],S=o[T][1],!(y<(E=Math.min(w,_))||y>Math.max(w,_)||v>Math.max(A,S)))if(v<Math.min(A,S))y!==E&&C++;else{if(v===(M=_===w?v:A+(y-w)*(S-A)/(_-w)))return T!==1||!m;v<=M&&y!==E&&C++}return C%2==1},isRect:c,degenerate:f}},p.isSegmentBent=function(l,e,o,r){var i,u,s,a=l[e],c=[l[o][0]-a[0],l[o][1]-a[1]],f=t(c,c),g=Math.sqrt(f),d=[-c[1]/g,c[0]/g];for(i=e+1;i<o;i++)if(u=[l[i][0]-a[0],l[i][1]-a[1]],(s=t(u,c))<0||s>f||Math.abs(t(u,d))>r)return!0;return!1},p.filter=function(l,e){var o=[l[0]],r=0,i=0;function u(s){l.push(s);var a=o.length,c=r;o.splice(i+1);for(var f=c+1;f<l.length;f++)(f===l.length-1||p.isSegmentBent(l,c,f+1,e))&&(o.push(l[f]),o.length<a-2&&(r=f,i=o.length-1),c=f)}return l.length>1&&u(l.pop()),{addPt:u,raw:l,filtered:o}}},{"../constants/numerical":753,"./matrix":784}],791:[function(n,z,q){(function(t){(function(){"use strict";var h=n("./show_no_webgl_msg"),p=n("regl");z.exports=function(l,e){var o=l._fullLayout,r=!0;return o._glcanvas.each(function(i){if(!i.regl&&(!i.pick||o._has("parcoords"))){try{i.regl=p({canvas:this,attributes:{antialias:!i.pick,preserveDrawingBuffer:!0},pixelRatio:l._context.plotGlPixelRatio||t.devicePixelRatio,extensions:e||[]})}catch{r=!1}i.regl||(r=!1),r&&this.addEventListener("webglcontextlost",function(u){l&&l.emit&&l.emit("plotly_webglcontextlost",{event:u,layer:i.key})},!1)}}),r||h({container:o._glcontainer.node()}),r}}).call(this)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{"./show_no_webgl_msg":800,regl:540}],792:[function(n,z,q){"use strict";var t=n("fast-isnumeric"),h=n("is-mobile");z.exports=function(p){var l;if(typeof(l=p&&p.hasOwnProperty("userAgent")?p.userAgent:function(){var a;return typeof navigator<"u"&&(a=navigator.userAgent),a&&a.headers&&typeof a.headers["user-agent"]=="string"&&(a=a.headers["user-agent"]),a}())!="string")return!0;var e=h({ua:{headers:{"user-agent":l}},tablet:!0,featureDetect:!1});if(!e){for(var o=l.split(" "),r=1;r<o.length;r++)if(o[r].indexOf("Safari")!==-1)for(var i=r-1;i>-1;i--){var u=o[i];if(u.substr(0,8)==="Version/"){var s=u.substr(8).split(".")[0];if(t(s)&&(s=+s),s>=13)return!0}}}return e}},{"fast-isnumeric":241,"is-mobile":467}],793:[function(n,z,q){"use strict";z.exports=function(t,h){if(h instanceof RegExp){for(var p=h.toString(),l=0;l<t.length;l++)if(t[l]instanceof RegExp&&t[l].toString()===p)return t;t.push(h)}else!h&&h!==0||t.indexOf(h)!==-1||t.push(h);return t}},{}],794:[function(n,z,q){"use strict";var t=n("../lib"),h=n("../plot_api/plot_config").dfltConfig,p={add:function(l,e,o,r,i){var u,s;l.undoQueue=l.undoQueue||{index:0,queue:[],sequence:!1},s=l.undoQueue.index,l.autoplay?l.undoQueue.inSequence||(l.autoplay=!1):(!l.undoQueue.sequence||l.undoQueue.beginSequence?(u={undo:{calls:[],args:[]},redo:{calls:[],args:[]}},l.undoQueue.queue.splice(s,l.undoQueue.queue.length-s,u),l.undoQueue.index+=1):u=l.undoQueue.queue[s-1],l.undoQueue.beginSequence=!1,u&&(u.undo.calls.unshift(e),u.undo.args.unshift(o),u.redo.calls.push(r),u.redo.args.push(i)),l.undoQueue.queue.length>h.queueLength&&(l.undoQueue.queue.shift(),l.undoQueue.index--))},startSequence:function(l){l.undoQueue=l.undoQueue||{index:0,queue:[],sequence:!1},l.undoQueue.sequence=!0,l.undoQueue.beginSequence=!0},stopSequence:function(l){l.undoQueue=l.undoQueue||{index:0,queue:[],sequence:!1},l.undoQueue.sequence=!1,l.undoQueue.beginSequence=!1},undo:function(l){var e,o;if(l.framework&&l.framework.isPolar)l.framework.undo();else if(!(l.undoQueue===void 0||isNaN(l.undoQueue.index)||l.undoQueue.index<=0)){for(l.undoQueue.index--,e=l.undoQueue.queue[l.undoQueue.index],l.undoQueue.inSequence=!0,o=0;o<e.undo.calls.length;o++)p.plotDo(l,e.undo.calls[o],e.undo.args[o]);l.undoQueue.inSequence=!1,l.autoplay=!1}},redo:function(l){var e,o;if(l.framework&&l.framework.isPolar)l.framework.redo();else if(!(l.undoQueue===void 0||isNaN(l.undoQueue.index)||l.undoQueue.index>=l.undoQueue.queue.length)){for(e=l.undoQueue.queue[l.undoQueue.index],l.undoQueue.inSequence=!0,o=0;o<e.redo.calls.length;o++)p.plotDo(l,e.redo.calls[o],e.redo.args[o]);l.undoQueue.inSequence=!1,l.autoplay=!1,l.undoQueue.index++}}};p.plotDo=function(l,e,o){l.autoplay=!0,o=function(r,i){for(var u,s=[],a=0;a<i.length;a++)u=i[a],s[a]=u===r?u:typeof u=="object"?Array.isArray(u)?t.extendDeep([],u):t.extendDeepAll({},u):u;return s}(l,o),e.apply(null,o)},z.exports=p},{"../lib":778,"../plot_api/plot_config":815}],795:[function(n,z,q){"use strict";q.counter=function(t,h,p,l){var e=(h||"")+(p?"":"$"),o=l===!1?"":"^";return t==="xy"?new RegExp(o+"x([2-9]|[1-9][0-9]+)?y([2-9]|[1-9][0-9]+)?"+e):new RegExp(o+t+"([2-9]|[1-9][0-9]+)?"+e)}},{}],796:[function(n,z,q){"use strict";var t=/^(.*)(\.[^\.\[\]]+|\[\d\])$/,h=/^[^\.\[\]]+$/;z.exports=function(p,l){for(;l;){var e=p.match(t);if(e)p=e[1];else{if(!p.match(h))throw new Error("bad relativeAttr call:"+[p,l]);p=""}if(l.charAt(0)!=="^")break;l=l.slice(1)}return p&&l.charAt(0)!=="["?p+"."+l:p+l}},{}],797:[function(n,z,q){"use strict";var t=n("./array").isArrayOrTypedArray,h=n("./is_plain_object");z.exports=function p(l,e){for(var o in e){var r=e[o],i=l[o];if(i!==r)if(o.charAt(0)==="_"||typeof r=="function"){if(o in l)continue;l[o]=r}else if(t(r)&&t(i)&&h(r[0])){if(o==="customdata"||o==="ids")continue;for(var u=Math.min(r.length,i.length),s=0;s<u;s++)i[s]!==r[s]&&h(r[s])&&h(i[s])&&p(i[s],r[s])}else h(r)&&h(i)&&(p(i,r),Object.keys(i).length||delete l[o])}}},{"./array":760,"./is_plain_object":779}],798:[function(n,z,q){"use strict";var t=n("fast-isnumeric"),h=n("./loggers"),p=n("./identity"),l=n("../constants/numerical").BADNUM;function e(u,s){return u<s}function o(u,s){return u<=s}function r(u,s){return u>s}function i(u,s){return u>=s}q.findBin=function(u,s,a){if(t(s.start))return a?Math.ceil((u-s.start)/s.size-1e-9)-1:Math.floor((u-s.start)/s.size+1e-9);var c,f,g=0,d=s.length,m=0,y=d>1?(s[d-1]-s[0])/(d-1):1;for(f=y>=0?a?e:o:a?i:r,u+=1e-9*y*(a?-1:1)*(y>=0?1:-1);g<d&&m++<100;)f(s[c=Math.floor((g+d)/2)],u)?g=c+1:d=c;return m>90&&h.log("Long binary search..."),g-1},q.sorterAsc=function(u,s){return u-s},q.sorterDes=function(u,s){return s-u},q.distinctVals=function(u,s){var a,c=(s||{}).unitMinDiff,f=u.slice();for(f.sort(q.sorterAsc),a=f.length-1;a>-1&&f[a]===l;a--);var g=1;c||(g=f[a]-f[0]||1);for(var d,m=g/(a||1)/1e4,y=[],v=0;v<=a;v++){var T=f[v],w=T-d;d===void 0?(y.push(T),d=T):w>m&&(g=Math.min(g,w),y.push(T),d=T)}return{vals:y,minDiff:g}},q.roundUp=function(u,s,a){for(var c,f=0,g=s.length-1,d=0,m=a?0:1,y=a?1:0,v=a?Math.ceil:Math.floor;f<g&&d++<100;)s[c=v((f+g)/2)]<=u?f=c+m:g=c-y;return s[f]},q.sort=function(u,s){for(var a=0,c=0,f=1;f<u.length;f++){var g=s(u[f],u[f-1]);if(g<0?a=1:g>0&&(c=1),a&&c)return u.sort(s)}return c?u:u.reverse()},q.findIndexOfMin=function(u,s){s=s||p;for(var a,c=1/0,f=0;f<u.length;f++){var g=s(u[f]);g<c&&(c=g,a=f)}return a}},{"../constants/numerical":753,"./identity":776,"./loggers":782,"fast-isnumeric":241}],799:[function(n,z,q){"use strict";z.exports=function(t,h){(t.attr("class")||"").split(" ").forEach(function(p){p.indexOf("cursor-")===0&&t.classed(p,!1)}),h&&t.classed("cursor-"+h,!0)}},{}],800:[function(n,z,q){"use strict";var t=n("../components/color"),h=function(){};z.exports=function(p){for(var l in p)typeof p[l]=="function"&&(p[l]=h);p.destroy=function(){p.container.parentNode.removeChild(p.container)};var e=document.createElement("div");e.className="no-webgl",e.style.cursor="pointer",e.style.fontSize="24px",e.style.color=t.defaults[0],e.style.position="absolute",e.style.left=e.style.top="0px",e.style.width=e.style.height="100%",e.style["background-color"]=t.lightLine,e.style["z-index"]=30;var o=document.createElement("p");return o.textContent="WebGL is not supported by your browser - visit https://get.webgl.org for more info",o.style.position="relative",o.style.top="50%",o.style.left="50%",o.style.height="30%",o.style.width="50%",o.style.margin="-15% 0 0 -25%",e.appendChild(o),p.container.appendChild(e),p.container.style.background="#FFFFFF",p.container.onclick=function(){window.open("https://get.webgl.org")},!1}},{"../components/color":643}],801:[function(n,z,q){"use strict";var t=n("fast-isnumeric"),h=n("./array").isArrayOrTypedArray;q.aggNums=function(p,l,e,o){var r,i;if((!o||o>e.length)&&(o=e.length),t(l)||(l=!1),h(e[0])){for(i=new Array(o),r=0;r<o;r++)i[r]=q.aggNums(p,l,e[r]);e=i}for(r=0;r<o;r++)t(l)?t(e[r])&&(l=p(+l,+e[r])):l=e[r];return l},q.len=function(p){return q.aggNums(function(l){return l+1},0,p)},q.mean=function(p,l){return l||(l=q.len(p)),q.aggNums(function(e,o){return e+o},0,p)/l},q.midRange=function(p){if(p!==void 0&&p.length!==0)return(q.aggNums(Math.max,null,p)+q.aggNums(Math.min,null,p))/2},q.variance=function(p,l,e){return l||(l=q.len(p)),t(e)||(e=q.mean(p,l)),q.aggNums(function(o,r){return o+Math.pow(r-e,2)},0,p)/l},q.stdev=function(p,l,e){return Math.sqrt(q.variance(p,l,e))},q.median=function(p){var l=p.slice().sort();return q.interp(l,.5)},q.interp=function(p,l){if(!t(l))throw"n should be a finite number";if((l=l*p.length-.5)<0)return p[0];if(l>p.length-1)return p[p.length-1];var e=l%1;return e*p[Math.ceil(l)]+(1-e)*p[Math.floor(l)]}},{"./array":760,"fast-isnumeric":241}],802:[function(n,z,q){"use strict";var t=n("color-normalize");z.exports=function(h){return h?t(h):[0,0,0,1]}},{"color-normalize":125}],803:[function(n,z,q){"use strict";var t=n("d3"),h=n("../lib"),p=h.strTranslate,l=n("../constants/xmlns_namespaces"),e=n("../constants/alignment").LINE_SPACING;function o(L,I){return L.node().getBoundingClientRect()[I]}var r=/([^$]*)([$]+[^$]*[$]+)([^$]*)/;q.convertToTspans=function(L,I,R){var V=L.text(),O=!L.attr("data-notex")&&typeof MathJax<"u"&&V.match(r),J=t.select(L.node().parentNode);if(!J.empty()){var D=L.attr("class")?L.attr("class").split(" ")[0]:"text";return D+="-math",J.selectAll("svg."+D).remove(),J.selectAll("g."+D+"-group").remove(),L.style("display",null).attr({"data-unformatted":V,"data-math":"N"}),O?(I&&I._promises||[]).push(new Promise(function(N){L.style("display","none");var F=parseInt(L.node().style.fontSize,10),H={fontSize:F};(function(j,G,W){var Q,$,ee,ie;MathJax.Hub.Queue(function(){return $=h.extendDeepAll({},MathJax.Hub.config),ee=MathJax.Hub.processSectionDelay,MathJax.Hub.processSectionDelay!==void 0&&(MathJax.Hub.processSectionDelay=0),MathJax.Hub.Config({messageStyle:"none",tex2jax:{inlineMath:[["$","$"],["\\(","\\)"]]},displayAlign:"left"})},function(){if((Q=MathJax.Hub.config.menuSettings.renderer)!=="SVG")return MathJax.Hub.setRenderer("SVG")},function(){var ae="math-output-"+h.randstr({},64);return ie=t.select("body").append("div").attr({id:ae}).style({visibility:"hidden",position:"absolute"}).style({"font-size":G.fontSize+"px"}).text(j.replace(i,"\\lt ").replace(u,"\\gt ")),MathJax.Hub.Typeset(ie.node())},function(){var ae=t.select("body").select("#MathJax_SVG_glyphs");if(ie.select(".MathJax_SVG").empty()||!ie.select("svg").node())h.log("There was an error in the tex syntax.",j),W();else{var oe=ie.select("svg").node().getBoundingClientRect();W(ie.select(".MathJax_SVG"),ae,oe)}if(ie.remove(),Q!=="SVG")return MathJax.Hub.setRenderer(Q)},function(){return ee!==void 0&&(MathJax.Hub.processSectionDelay=ee),MathJax.Hub.Config($)})})(O[2],H,function(j,G,W){J.selectAll("svg."+D).remove(),J.selectAll("g."+D+"-group").remove();var Q=j&&j.select("svg");if(!Q||!Q.node())return B(),void N();var $=J.append("g").classed(D+"-group",!0).attr({"pointer-events":"none","data-unformatted":V,"data-math":"Y"});$.node().appendChild(Q.node()),G&&G.node()&&Q.node().insertBefore(G.node().cloneNode(!0),Q.node().firstChild),Q.attr({class:D,height:W.height,preserveAspectRatio:"xMinYMin meet"}).style({overflow:"visible","pointer-events":"none"});var ee=L.node().style.fill||"black",ie=Q.select("g");ie.attr({fill:ee,stroke:ee});var ae=o(ie,"width"),oe=o(ie,"height"),de=+L.attr("x")-ae*{start:0,middle:.5,end:1}[L.attr("text-anchor")||"start"],le=-(F||o(L,"height"))/4;D[0]==="y"?($.attr({transform:"rotate("+[-90,+L.attr("x"),+L.attr("y")]+")"+p(-ae/2,le-oe/2)}),Q.attr({x:+L.attr("x"),y:+L.attr("y")})):D[0]==="l"?Q.attr({x:L.attr("x"),y:le-oe/2}):D[0]==="a"&&D.indexOf("atitle")!==0?Q.attr({x:0,y:le}):Q.attr({x:de,y:+L.attr("y")+le-oe/2}),R&&R.call(L,$),N($)})})):B(),L}function B(){J.empty()||(D=L.attr("class")+"-math",J.select("svg."+D).remove()),L.text("").style("white-space","pre"),function(N,F){F=F.replace(g," ");var H,j=!1,G=[],W=-1;function Q(){W++;var ve=document.createElementNS(l.svg,"tspan");t.select(ve).attr({class:"line",dy:W*e+"em"}),N.appendChild(ve),H=ve;var ge=G;if(G=[{node:ve}],ge.length>1)for(var De=1;De<ge.length;De++)$(ge[De])}function $(ve){var ge,De=ve.type,_e={};if(De==="a"){ge="a";var Pe=ve.target,Fe=ve.href,ze=ve.popup;Fe&&(_e={"xlink:xlink:show":Pe==="_blank"||Pe.charAt(0)!=="_"?"new":"replace",target:Pe,"xlink:xlink:href":Fe},ze&&(_e.onclick='window.open(this.href.baseVal,this.target.baseVal,"'+ze+'");return false;'))}else ge="tspan";ve.style&&(_e.style=ve.style);var He=document.createElementNS(l.svg,ge);if(De==="sup"||De==="sub"){ee(H,"\u200B"),H.appendChild(He);var et=document.createElementNS(l.svg,"tspan");ee(et,"\u200B"),t.select(et).attr("dy",c[De]),_e.dy=a[De],H.appendChild(He),H.appendChild(et)}else H.appendChild(He);t.select(He).attr(_e),H=ve.node=He,G.push(ve)}function ee(ve,ge){ve.appendChild(document.createTextNode(ge))}function ie(ve){if(G.length!==1){var ge=G.pop();ve!==ge.type&&h.log("Start tag <"+ge.type+"> doesnt match end tag <"+ve+">. Pretending it did match.",F),H=G[G.length-1].node}else h.log("Ignoring unexpected end tag </"+ve+">.",F)}y.test(F)?Q():(H=N,G=[{node:N}]);for(var ae=F.split(d),oe=0;oe<ae.length;oe++){var de=ae[oe],le=de.match(m),fe=le&&le[2].toLowerCase(),ue=s[fe];if(fe==="br")Q();else if(ue===void 0)ee(H,S(de));else if(le[1])ie(fe);else{var we=le[4],Ae={type:fe},Se=E(we,v);if(Se?(Se=Se.replace(M,"$1 fill:"),ue&&(Se+=";"+ue)):ue&&(Se=ue),Se&&(Ae.style=Se),fe==="a"){j=!0;var ke=E(we,T);if(ke){var Me=C(ke);Me&&(Ae.href=Me,Ae.target=E(we,w)||"_blank",Ae.popup=E(we,A))}}$(Ae)}}return j}(L.node(),V)&&L.style("pointer-events","all"),q.positionText(L),R&&R.call(L)}};var i=/(<|&lt;|&#60;)/g,u=/(>|&gt;|&#62;)/g,s={sup:"font-size:70%",sub:"font-size:70%",b:"font-weight:bold",i:"font-style:italic",a:"cursor:pointer",span:"",em:"font-style:italic;font-weight:bold"},a={sub:"0.3em",sup:"-0.6em"},c={sub:"-0.21em",sup:"0.42em"},f=["http:","https:","mailto:","",void 0,":"],g=q.NEWLINES=/(\r\n?|\n)/g,d=/(<[^<>]*>)/,m=/<(\/?)([^ >]*)(\s+(.*))?>/i,y=/<br(\s+.*)?>/i;q.BR_TAG_ALL=/<br(\s+.*)?>/gi;var v=/(^|[\s"'])style\s*=\s*("([^"]*);?"|'([^']*);?')/i,T=/(^|[\s"'])href\s*=\s*("([^"]*)"|'([^']*)')/i,w=/(^|[\s"'])target\s*=\s*("([^"\s]*)"|'([^'\s]*)')/i,A=/(^|[\s"'])popup\s*=\s*("([\w=,]*)"|'([\w=,]*)')/i;function E(L,I){if(!L)return null;var R=L.match(I),V=R&&(R[3]||R[4]);return V&&S(V)}var M=/(^|;)\s*color:/;q.plainText=function(L,I){for(var R=(I=I||{}).len!==void 0&&I.len!==-1?I.len:1/0,V=I.allowedTags!==void 0?I.allowedTags:["br"],O=3,J=L.split(d),D=[],B="",N=0,F=0;F<J.length;F++){var H=J[F],j=H.match(m),G=j&&j[2].toLowerCase();if(G)V.indexOf(G)!==-1&&(D.push(H),B=G);else{var W=H.length;if(N+W<R)D.push(H),N+=W;else if(N<R){var Q=R-N;B&&(B!=="br"||Q<=O||W<=O)&&D.pop(),R>O?D.push(H.substr(0,Q-O)+"..."):D.push(H.substr(0,Q));break}B=""}}return D.join("")};var b={mu:"\u03BC",amp:"&",lt:"<",gt:">",nbsp:"\xA0",times:"\xD7",plusmn:"\xB1",deg:"\xB0"},_=/&(#\d+|#x[\da-fA-F]+|[a-z]+);/g;function S(L){return L.replace(_,function(I,R){return(R.charAt(0)==="#"?function(V){if(!(V>1114111)){var O=String.fromCodePoint;if(O)return O(V);var J=String.fromCharCode;return V<=65535?J(V):J(55232+(V>>10),V%1024+56320)}}(R.charAt(1)==="x"?parseInt(R.substr(2),16):parseInt(R.substr(1),10)):b[R])||I})}function C(L){var I=encodeURI(decodeURI(L)),R=document.createElement("a"),V=document.createElement("a");R.href=L,V.href=I;var O=R.protocol,J=V.protocol;return f.indexOf(O)!==-1&&f.indexOf(J)!==-1?I:""}function k(L,I,R){var V,O,J,D=R.horizontalAlign,B=R.verticalAlign||"top",N=L.node().getBoundingClientRect(),F=I.node().getBoundingClientRect();return O=B==="bottom"?function(){return N.bottom-V.height}:B==="middle"?function(){return N.top+(N.height-V.height)/2}:function(){return N.top},J=D==="right"?function(){return N.right-V.width}:D==="center"?function(){return N.left+(N.width-V.width)/2}:function(){return N.left},function(){V=this.node().getBoundingClientRect();var H=J()-F.left,j=O()-F.top,G=R.gd||{};if(R.gd){G._fullLayout._calcInverseTransform(G);var W=h.apply3DTransform(G._fullLayout._invTransform)(H,j);H=W[0],j=W[1]}return this.style({top:j+"px",left:H+"px","z-index":1e3}),this}}q.convertEntities=S,q.sanitizeHTML=function(L){L=L.replace(g," ");for(var I=document.createElement("p"),R=I,V=[],O=L.split(d),J=0;J<O.length;J++){var D=O[J],B=D.match(m),N=B&&B[2].toLowerCase();if(N in s)if(B[1])V.length&&(R=V.pop());else{var F=B[4],H=E(F,v),j=H?{style:H}:{};if(N==="a"){var G=E(F,T);if(G){var W=C(G);if(W){j.href=W;var Q=E(F,w);Q&&(j.target=Q)}}}var $=document.createElement(N);R.appendChild($),t.select($).attr(j),R=$,V.push($)}else R.appendChild(document.createTextNode(S(D)))}return I.innerHTML},q.lineCount=function(L){return L.selectAll("tspan.line").size()||1},q.positionText=function(L,I,R){return L.each(function(){var V=t.select(this);function O(B,N){return N===void 0?(N=V.attr(B))===null&&(V.attr(B,0),N=0):V.attr(B,N),N}var J=O("x",I),D=O("y",R);this.nodeName==="text"&&V.selectAll("tspan.line").attr({x:J,y:D})})},q.makeEditable=function(L,I){var R=I.gd,V=I.delegate,O=t.dispatch("edit","input","cancel"),J=V||L;if(L.style({"pointer-events":V?"none":"all"}),L.size()!==1)throw new Error("boo");function D(){(function(){var H=t.select(R).select(".svg-container"),j=H.append("div"),G=L.node().style,W=parseFloat(G.fontSize||12),Q=I.text;Q===void 0&&(Q=L.attr("data-unformatted")),j.classed("plugin-editable editable",!0).style({position:"absolute","font-family":G.fontFamily||"Arial","font-size":W,color:I.fill||G.fill||"black",opacity:1,"background-color":I.background||"transparent",outline:"#ffffff33 1px solid",margin:[-W/8+1,0,0,-1].join("px ")+"px",padding:"0","box-sizing":"border-box"}).attr({contenteditable:!0}).text(Q).call(k(L,H,I)).on("blur",function(){R._editing=!1,L.text(this.textContent).style({opacity:1});var $,ee=t.select(this).attr("class");($=ee?"."+ee.split(" ")[0]+"-math-group":"[class*=-math-group]")&&t.select(L.node().parentNode).select($).style({opacity:0});var ie=this.textContent;t.select(this).transition().duration(0).remove(),t.select(document).on("mouseup",null),O.edit.call(L,ie)}).on("focus",function(){var $=this;R._editing=!0,t.select(document).on("mouseup",function(){if(t.event.target===$)return!1;document.activeElement===j.node()&&j.node().blur()})}).on("keyup",function(){t.event.which===27?(R._editing=!1,L.style({opacity:1}),t.select(this).style({opacity:0}).on("blur",function(){return!1}).transition().remove(),O.cancel.call(L,this.textContent)):(O.input.call(L,this.textContent),t.select(this).call(k(L,H,I)))}).on("keydown",function(){t.event.which===13&&this.blur()}).call(B)})(),L.style({opacity:0});var N,F=J.attr("class");(N=F?"."+F.split(" ")[0]+"-math-group":"[class*=-math-group]")&&t.select(L.node().parentNode).select(N).style({opacity:0})}function B(N){var F=N.node(),H=document.createRange();H.selectNodeContents(F);var j=window.getSelection();j.removeAllRanges(),j.addRange(H),F.focus()}return I.immediate?D():J.on("click",D),t.rebind(L,O,"on")}},{"../constants/alignment":745,"../constants/xmlns_namespaces":754,"../lib":778,d3:169}],804:[function(n,z,q){"use strict";var t={};function h(p){p&&p.timer!==null&&(clearTimeout(p.timer),p.timer=null)}q.throttle=function(p,l,e){var o=t[p],r=Date.now();if(!o){for(var i in t)t[i].ts<r-6e4&&delete t[i];o=t[p]={ts:0,timer:null}}function u(){e(),o.ts=Date.now(),o.onDone&&(o.onDone(),o.onDone=null)}h(o),r>o.ts+l?u():o.timer=setTimeout(function(){u(),o.timer=null},l)},q.done=function(p){var l=t[p];return l&&l.timer?new Promise(function(e){var o=l.onDone;l.onDone=function(){o&&o(),e(),l.onDone=null}}):Promise.resolve()},q.clear=function(p){if(p)h(t[p]),delete t[p];else for(var l in t)q.clear(l)}},{}],805:[function(n,z,q){"use strict";var t=n("fast-isnumeric");z.exports=function(h,p){if(h>0)return Math.log(h)/Math.LN10;var l=Math.log(Math.min(p[0],p[1]))/Math.LN10;return t(l)||(l=Math.log(Math.max(p[0],p[1]))/Math.LN10-6),l}},{"fast-isnumeric":241}],806:[function(n,z,q){"use strict";var t=z.exports={},h=n("../plots/geo/constants").locationmodeToLayer,p=n("topojson-client").feature;t.getTopojsonName=function(l){return[l.scope.replace(/ /g,"-"),"_",l.resolution.toString(),"m"].join("")},t.getTopojsonPath=function(l,e){return l+e+".json"},t.getTopojsonFeatures=function(l,e){var o=h[l.locationmode],r=e.objects[o];return p(e,r).features}},{"../plots/geo/constants":858,"topojson-client":579}],807:[function(n,z,q){"use strict";z.exports={moduleType:"locale",name:"en-US",dictionary:{"Click to enter Colorscale title":"Click to enter Colorscale title"},format:{date:"%m/%d/%Y"}}},{}],808:[function(n,z,q){"use strict";z.exports={moduleType:"locale",name:"en",dictionary:{"Click to enter Colorscale title":"Click to enter Colourscale title"},format:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],periods:["AM","PM"],dateTime:"%a %b %e %X %Y",date:"%d/%m/%Y",time:"%H:%M:%S",decimal:".",thousands:",",grouping:[3],currency:["$",""],year:"%Y",month:"%b %Y",dayMonth:"%b %-d",dayMonthYear:"%b %-d, %Y"}}},{}],809:[function(n,z,q){"use strict";var t=n("../registry");z.exports=function(h){for(var p,l,e=t.layoutArrayContainers,o=t.layoutArrayRegexes,r=h.split("[")[0],i=0;i<o.length;i++)if((l=h.match(o[i]))&&l.index===0){p=l[0];break}if(p||(p=e[e.indexOf(r)]),!p)return!1;var u=h.substr(p.length);return u?!!(l=u.match(/^\[(0|[1-9][0-9]*)\](\.(.+))?$/))&&{array:p,index:Number(l[1]),property:l[3]||""}:{array:p,index:"",property:""}}},{"../registry":911}],810:[function(n,z,q){"use strict";var t=n("../lib"),h=t.extendFlat,p=t.isPlainObject,l={valType:"flaglist",extras:["none"],flags:["calc","clearAxisTypes","plot","style","markerSize","colorbars"]},e={valType:"flaglist",extras:["none"],flags:["calc","plot","legend","ticks","axrange","layoutstyle","modebar","camera","arraydraw","colorbars"]},o=l.flags.slice().concat(["fullReplot"]),r=e.flags.slice().concat("layoutReplot");function i(a){for(var c={},f=0;f<a.length;f++)c[a[f]]=!1;return c}function u(a,c,f){var g=h({},a);for(var d in g){var m=g[d];p(m)&&(g[d]=s(m,c,f,d))}return f==="from-root"&&(g.editType=c),g}function s(a,c,f,g){if(a.valType){var d=h({},a);if(d.editType=c,Array.isArray(a.items)){d.items=new Array(a.items.length);for(var m=0;m<a.items.length;m++)d.items[m]=s(a.items[m],c,"from-root")}return d}return u(a,c,g.charAt(0)==="_"?"nested":"from-root")}z.exports={traces:l,layout:e,traceFlags:function(){return i(o)},layoutFlags:function(){return i(r)},update:function(a,c){var f=c.editType;if(f&&f!=="none")for(var g=f.split("+"),d=0;d<g.length;d++)a[g[d]]=!0},overrideAll:u}},{"../lib":778}],811:[function(n,z,q){"use strict";var t=n("fast-isnumeric"),h=n("gl-mat4/fromQuat"),p=n("../registry"),l=n("../lib"),e=n("../plots/plots"),o=n("../plots/cartesian/axis_ids"),r=n("../components/color"),i=o.cleanId,u=o.getFromTrace,s=p.traceIs;function a(w,A){var E=w[A],M=A.charAt(0);E&&E!=="paper"&&(w[A]=i(E,M,!0))}function c(w){function A(E,M){var b=w[E],_=w.title&&w.title[M];b&&!_&&(w.title||(w.title={}),w.title[M]=w[E],delete w[E])}w&&(typeof w.title!="string"&&typeof w.title!="number"||(w.title={text:w.title}),A("titlefont","font"),A("titleposition","position"),A("titleside","side"),A("titleoffset","offset"))}function f(w){if(!l.isPlainObject(w))return!1;var A=w.name;return delete w.name,delete w.showlegend,(typeof A=="string"||typeof A=="number")&&String(A)}function g(w,A,E,M){if(E&&!M)return w;if(M&&!E||!w.trim())return A;if(!A.trim())return w;var b,_=Math.min(w.length,A.length);for(b=0;b<_&&w.charAt(b)===A.charAt(b);b++);return w.substr(0,b).trim()}function d(w){var A="middle",E="center";return typeof w=="string"&&(w.indexOf("top")!==-1?A="top":w.indexOf("bottom")!==-1&&(A="bottom"),w.indexOf("left")!==-1?E="left":w.indexOf("right")!==-1&&(E="right")),A+" "+E}function m(w,A){return A in w&&typeof w[A]=="object"&&Object.keys(w[A]).length===0}q.clearPromiseQueue=function(w){Array.isArray(w._promises)&&w._promises.length>0&&l.log("Clearing previous rejected promises from queue."),w._promises=[]},q.cleanLayout=function(w){var A,E;w||(w={}),w.xaxis1&&(w.xaxis||(w.xaxis=w.xaxis1),delete w.xaxis1),w.yaxis1&&(w.yaxis||(w.yaxis=w.yaxis1),delete w.yaxis1),w.scene1&&(w.scene||(w.scene=w.scene1),delete w.scene1);var M=(e.subplotsRegistry.cartesian||{}).attrRegex,b=(e.subplotsRegistry.polar||{}).attrRegex,_=(e.subplotsRegistry.ternary||{}).attrRegex,S=(e.subplotsRegistry.gl3d||{}).attrRegex,C=Object.keys(w);for(A=0;A<C.length;A++){var k=C[A];if(M&&M.test(k)){var L=w[k];L.anchor&&L.anchor!=="free"&&(L.anchor=i(L.anchor)),L.overlaying&&(L.overlaying=i(L.overlaying)),L.type||(L.isdate?L.type="date":L.islog?L.type="log":L.isdate===!1&&L.islog===!1&&(L.type="linear")),L.autorange!=="withzero"&&L.autorange!=="tozero"||(L.autorange=!0,L.rangemode="tozero"),delete L.islog,delete L.isdate,delete L.categories,m(L,"domain")&&delete L.domain,L.autotick!==void 0&&(L.tickmode===void 0&&(L.tickmode=L.autotick?"auto":"linear"),delete L.autotick),c(L)}else if(b&&b.test(k))c(w[k].radialaxis);else if(_&&_.test(k)){var I=w[k];c(I.aaxis),c(I.baxis),c(I.caxis)}else if(S&&S.test(k)){var R=w[k],V=R.cameraposition;if(Array.isArray(V)&&V[0].length===4){var O=V[0],J=V[1],D=V[2],B=h([],O),N=[];for(E=0;E<3;++E)N[E]=J[E]+D*B[2+4*E];R.camera={eye:{x:N[0],y:N[1],z:N[2]},center:{x:J[0],y:J[1],z:J[2]},up:{x:0,y:0,z:1}},delete R.cameraposition}c(R.xaxis),c(R.yaxis),c(R.zaxis)}}var F=Array.isArray(w.annotations)?w.annotations.length:0;for(A=0;A<F;A++){var H=w.annotations[A];l.isPlainObject(H)&&(H.ref&&(H.ref==="paper"?(H.xref="paper",H.yref="paper"):H.ref==="data"&&(H.xref="x",H.yref="y"),delete H.ref),a(H,"xref"),a(H,"yref"))}var j=Array.isArray(w.shapes)?w.shapes.length:0;for(A=0;A<j;A++){var G=w.shapes[A];l.isPlainObject(G)&&(a(G,"xref"),a(G,"yref"))}var W=Array.isArray(w.images)?w.images.length:0;for(A=0;A<W;A++){var Q=w.images[A];l.isPlainObject(Q)&&(a(Q,"xref"),a(Q,"yref"))}var $=w.legend;return $&&($.x>3?($.x=1.02,$.xanchor="left"):$.x<-2&&($.x=-.02,$.xanchor="right"),$.y>3?($.y=1.02,$.yanchor="bottom"):$.y<-2&&($.y=-.02,$.yanchor="top")),c(w),w.dragmode==="rotate"&&(w.dragmode="orbit"),r.clean(w),w.template&&w.template.layout&&q.cleanLayout(w.template.layout),w},q.cleanData=function(w){for(var A=0;A<w.length;A++){var E,M=w[A];if(M.type==="histogramy"&&"xbins"in M&&!("ybins"in M)&&(M.ybins=M.xbins,delete M.xbins),M.error_y&&"opacity"in M.error_y){var b=r.defaults,_=M.error_y.color||(s(M,"bar")?r.defaultLine:b[A%b.length]);M.error_y.color=r.addOpacity(r.rgb(_),r.opacity(_)*M.error_y.opacity),delete M.error_y.opacity}if("bardir"in M&&(M.bardir!=="h"||!s(M,"bar")&&M.type.substr(0,9)!=="histogram"||(M.orientation="h",q.swapXYData(M)),delete M.bardir),M.type==="histogramy"&&q.swapXYData(M),M.type!=="histogramx"&&M.type!=="histogramy"||(M.type="histogram"),"scl"in M&&!("colorscale"in M)&&(M.colorscale=M.scl,delete M.scl),"reversescl"in M&&!("reversescale"in M)&&(M.reversescale=M.reversescl,delete M.reversescl),M.xaxis&&(M.xaxis=i(M.xaxis,"x")),M.yaxis&&(M.yaxis=i(M.yaxis,"y")),s(M,"gl3d")&&M.scene&&(M.scene=e.subplotsRegistry.gl3d.cleanId(M.scene)),!s(M,"pie-like")&&!s(M,"bar-like"))if(Array.isArray(M.textposition))for(E=0;E<M.textposition.length;E++)M.textposition[E]=d(M.textposition[E]);else M.textposition&&(M.textposition=d(M.textposition));var S=p.getModule(M);if(S&&S.colorbar){var C=S.colorbar.container,k=C?M[C]:M;k&&k.colorscale&&(k.colorscale==="YIGnBu"&&(k.colorscale="YlGnBu"),k.colorscale==="YIOrRd"&&(k.colorscale="YlOrRd"))}if(M.type==="surface"&&l.isPlainObject(M.contours)){var L=["x","y","z"];for(E=0;E<L.length;E++){var I=M.contours[L[E]];l.isPlainObject(I)&&(I.highlightColor&&(I.highlightcolor=I.highlightColor,delete I.highlightColor),I.highlightWidth&&(I.highlightwidth=I.highlightWidth,delete I.highlightWidth))}}if(M.type==="candlestick"||M.type==="ohlc"){var R=(M.increasing||{}).showlegend!==!1,V=(M.decreasing||{}).showlegend!==!1,O=f(M.increasing),J=f(M.decreasing);if(O!==!1&&J!==!1){var D=g(O,J,R,V);D&&(M.name=D)}else!O&&!J||M.name||(M.name=O||J)}if(Array.isArray(M.transforms)){var B=M.transforms;for(E=0;E<B.length;E++){var N=B[E];if(l.isPlainObject(N))switch(N.type){case"filter":N.filtersrc&&(N.target=N.filtersrc,delete N.filtersrc),N.calendar&&(N.valuecalendar||(N.valuecalendar=N.calendar),delete N.calendar);break;case"groupby":if(N.styles=N.styles||N.style,N.styles&&!Array.isArray(N.styles)){var F=N.styles,H=Object.keys(F);N.styles=[];for(var j=0;j<H.length;j++)N.styles.push({target:H[j],value:F[H[j]]})}}}}m(M,"line")&&delete M.line,"marker"in M&&(m(M.marker,"line")&&delete M.marker.line,m(M,"marker")&&delete M.marker),r.clean(M),M.autobinx&&(delete M.autobinx,delete M.xbins),M.autobiny&&(delete M.autobiny,delete M.ybins),c(M),M.colorbar&&c(M.colorbar),M.marker&&M.marker.colorbar&&c(M.marker.colorbar),M.line&&M.line.colorbar&&c(M.line.colorbar),M.aaxis&&c(M.aaxis),M.baxis&&c(M.baxis)}},q.swapXYData=function(w){var A;if(l.swapAttrs(w,["?","?0","d?","?bins","nbins?","autobin?","?src","error_?"]),Array.isArray(w.z)&&Array.isArray(w.z[0])&&(w.transpose?delete w.transpose:w.transpose=!0),w.error_x&&w.error_y){var E=w.error_y,M="copy_ystyle"in E?E.copy_ystyle:!(E.color||E.thickness||E.width);l.swapAttrs(w,["error_?.copy_ystyle"]),M&&l.swapAttrs(w,["error_?.color","error_?.thickness","error_?.width"])}if(typeof w.hoverinfo=="string"){var b=w.hoverinfo.split("+");for(A=0;A<b.length;A++)b[A]==="x"?b[A]="y":b[A]==="y"&&(b[A]="x");w.hoverinfo=b.join("+")}},q.coerceTraceIndices=function(w,A){if(t(A))return[A];if(!Array.isArray(A)||!A.length)return w.data.map(function(b,_){return _});if(Array.isArray(A)){for(var E=[],M=0;M<A.length;M++)l.isIndex(A[M],w.data.length)?E.push(A[M]):l.warn("trace index (",A[M],") is not a number or is out of bounds");return E}return A},q.manageArrayContainers=function(w,A,E){var M=w.obj,b=w.parts,_=b.length,S=b[_-1],C=t(S);if(C&&A===null){var k=b.slice(0,_-1).join(".");l.nestedProperty(M,k).get().splice(S,1)}else C&&w.get()===void 0&&w.get()===void 0&&(E[w.astr]=null),w.set(A)};var y=/(\.[^\[\]\.]+|\[[^\[\]\.]+\])$/;function v(w){var A=w.search(y);if(A>0)return w.substr(0,A)}q.hasParent=function(w,A){for(var E=v(A);E;){if(E in w)return!0;E=v(E)}return!1};var T=["x","y","z"];q.clearAxisTypes=function(w,A,E){for(var M=0;M<A.length;M++)for(var b=w._fullData[M],_=0;_<3;_++){var S=u(w,b,T[_]);if(S&&S.type!=="log"){var C=S._name,k=S._id.substr(1);if(k.substr(0,5)==="scene"){if(E[k]!==void 0)continue;C=k+"."+C}var L=C+".type";E[C]===void 0&&E[L]===void 0&&l.nestedProperty(w.layout,L).set(null)}}}},{"../components/color":643,"../lib":778,"../plots/cartesian/axis_ids":831,"../plots/plots":891,"../registry":911,"fast-isnumeric":241,"gl-mat4/fromQuat":282}],812:[function(n,z,q){"use strict";var t=n("./plot_api");q.plot=t.plot,q.newPlot=t.newPlot,q.restyle=t.restyle,q.relayout=t.relayout,q.redraw=t.redraw,q.update=t.update,q._guiRestyle=t._guiRestyle,q._guiRelayout=t._guiRelayout,q._guiUpdate=t._guiUpdate,q._storeDirectGUIEdit=t._storeDirectGUIEdit,q.react=t.react,q.extendTraces=t.extendTraces,q.prependTraces=t.prependTraces,q.addTraces=t.addTraces,q.deleteTraces=t.deleteTraces,q.moveTraces=t.moveTraces,q.purge=t.purge,q.addFrames=t.addFrames,q.deleteFrames=t.deleteFrames,q.animate=t.animate,q.setPlotConfig=t.setPlotConfig,q.toImage=n("./to_image"),q.validate=n("./validate"),q.downloadImage=n("../snapshot/download");var h=n("./template_api");q.makeTemplate=h.makeTemplate,q.validateTemplate=h.validateTemplate},{"../snapshot/download":913,"./plot_api":814,"./template_api":819,"./to_image":820,"./validate":821}],813:[function(n,z,q){"use strict";var t=n("../lib/is_plain_object"),h=n("../lib/noop"),p=n("../lib/loggers"),l=n("../lib/search").sorterAsc,e=n("../registry");q.containerArrayMatch=n("./container_array_match");var o=q.isAddVal=function(i){return i==="add"||t(i)},r=q.isRemoveVal=function(i){return i===null||i==="remove"};q.applyContainerArrayChanges=function(i,u,s,a,c){var f=u.astr,g=e.getComponentMethod(f,"supplyLayoutDefaults"),d=e.getComponentMethod(f,"draw"),m=e.getComponentMethod(f,"drawOne"),y=a.replot||a.recalc||g===h||d===h,v=i.layout,T=i._fullLayout;if(s[""]){Object.keys(s).length>1&&p.warn("Full array edits are incompatible with other edits",f);var w=s[""][""];if(r(w))u.set(null);else{if(!Array.isArray(w))return p.warn("Unrecognized full array edit value",f,w),!0;u.set(w)}return!y&&(g(v,T),d(i),!0)}var A,E,M,b,_,S,C,k,L=Object.keys(s).map(Number).sort(l),I=u.get(),R=I||[],V=c(T,f).get(),O=[],J=-1,D=R.length;for(A=0;A<L.length;A++)if(b=s[M=L[A]],_=Object.keys(b),S=b[""],C=o(S),M<0||M>R.length-(C?0:1))p.warn("index out of range",f,M);else if(S!==void 0)_.length>1&&p.warn("Insertion & removal are incompatible with edits to the same index.",f,M),r(S)?O.push(M):C?(S==="add"&&(S={}),R.splice(M,0,S),V&&V.splice(M,0,{})):p.warn("Unrecognized full object edit value",f,M,S),J===-1&&(J=M);else for(E=0;E<_.length;E++)k=f+"["+M+"].",c(R[M],_[E],k).set(b[_[E]]);for(A=O.length-1;A>=0;A--)R.splice(O[A],1),V&&V.splice(O[A],1);if(R.length?I||u.set(R):u.set(null),y)return!1;if(g(v,T),m!==h){var B;if(J===-1)B=L;else{for(D=Math.max(R.length,D),B=[],A=0;A<L.length&&!((M=L[A])>=J);A++)B.push(M);for(A=J;A<D;A++)B.push(A)}for(A=0;A<B.length;A++)m(i,B[A])}else d(i);return!0}},{"../lib/is_plain_object":779,"../lib/loggers":782,"../lib/noop":787,"../lib/search":798,"../registry":911,"./container_array_match":809}],814:[function(n,z,q){"use strict";var t=n("d3"),h=n("fast-isnumeric"),p=n("has-hover"),l=n("../lib"),e=l.nestedProperty,o=n("../lib/events"),r=n("../lib/queue"),i=n("../registry"),u=n("./plot_schema"),s=n("../plots/plots"),a=n("../plots/polar/legacy"),c=n("../plots/cartesian/axes"),f=n("../components/drawing"),g=n("../components/color"),d=n("../plots/cartesian/graph_interact").initInteractions,m=n("../constants/xmlns_namespaces"),y=n("../lib/svg_text_utils"),v=n("../plots/cartesian/select").clearSelect,T=n("./plot_config").dfltConfig,w=n("./manage_arrays"),A=n("./helpers"),E=n("./subroutines"),M=n("./edit_types"),b=n("../plots/cartesian/constants").AX_NAME_PATTERN,_=0;function S(_e){var Pe=_e._fullLayout;Pe._redrawFromAutoMarginCount?Pe._redrawFromAutoMarginCount--:_e.emit("plotly_afterplot")}function C(_e,Pe){try{_e._fullLayout._paper.style("background",Pe)}catch(Fe){l.error(Fe)}}function k(_e,Pe){C(_e,g.combine(Pe,"white"))}function L(_e,Pe){if(!_e._context){_e._context=l.extendDeep({},T);var Fe=t.select("base");_e._context._baseUrl=Fe.size()&&Fe.attr("href")?window.location.href.split("#")[0]:""}var ze,He,et,Re=_e._context;if(Pe){for(He=Object.keys(Pe),ze=0;ze<He.length;ze++)(et=He[ze])!=="editable"&&et!=="edits"&&et in Re&&(et==="setBackground"&&Pe[et]==="opaque"?Re[et]=k:Re[et]=Pe[et]);Pe.plot3dPixelRatio&&!Re.plotGlPixelRatio&&(Re.plotGlPixelRatio=Re.plot3dPixelRatio);var Ze=Pe.editable;if(Ze!==void 0)for(Re.editable=Ze,He=Object.keys(Re.edits),ze=0;ze<He.length;ze++)Re.edits[He[ze]]=Ze;if(Pe.edits)for(He=Object.keys(Pe.edits),ze=0;ze<He.length;ze++)(et=He[ze])in Re.edits&&(Re.edits[et]=Pe.edits[et]);Re._exportedPlot=Pe._exportedPlot}Re.staticPlot&&(Re.editable=!1,Re.edits={},Re.autosizable=!1,Re.scrollZoom=!1,Re.doubleClick=!1,Re.showTips=!1,Re.showLink=!1,Re.displayModeBar=!1),Re.displayModeBar!=="hover"||p||(Re.displayModeBar=!0),Re.setBackground!=="transparent"&&typeof Re.setBackground=="function"||(Re.setBackground=C),Re._hasZeroHeight=Re._hasZeroHeight||_e.clientHeight===0,Re._hasZeroWidth=Re._hasZeroWidth||_e.clientWidth===0;var Ke=Re.scrollZoom,$e=Re._scrollZoom={};if(Ke===!0)$e.cartesian=1,$e.gl3d=1,$e.geo=1,$e.mapbox=1;else if(typeof Ke=="string"){var rt=Ke.split("+");for(ze=0;ze<rt.length;ze++)$e[rt[ze]]=1}else Ke!==!1&&($e.gl3d=1,$e.geo=1,$e.mapbox=1)}function I(_e,Pe){var Fe,ze,He=Pe+1,et=[];for(Fe=0;Fe<_e.length;Fe++)(ze=_e[Fe])<0?et.push(He+ze):et.push(ze);return et}function R(_e,Pe,Fe){var ze,He;for(ze=0;ze<Pe.length;ze++){if((He=Pe[ze])!==parseInt(He,10))throw new Error("all values in "+Fe+" must be integers");if(He>=_e.data.length||He<-_e.data.length)throw new Error(Fe+" must be valid indices for gd.data.");if(Pe.indexOf(He,ze+1)>-1||He>=0&&Pe.indexOf(-_e.data.length+He)>-1||He<0&&Pe.indexOf(_e.data.length+He)>-1)throw new Error("each index in "+Fe+" must be unique.")}}function V(_e,Pe,Fe){if(!Array.isArray(_e.data))throw new Error("gd.data must be an array.");if(typeof Pe>"u")throw new Error("currentIndices is a required argument.");if(Array.isArray(Pe)||(Pe=[Pe]),R(_e,Pe,"currentIndices"),typeof Fe>"u"||Array.isArray(Fe)||(Fe=[Fe]),typeof Fe<"u"&&R(_e,Fe,"newIndices"),typeof Fe<"u"&&Pe.length!==Fe.length)throw new Error("current and new indices must be of equal length.")}function O(_e,Pe,Fe,ze,He){(function(lt,gt,Ie,be){var We=l.isPlainObject(be);if(!Array.isArray(lt.data))throw new Error("gd.data must be an array");if(!l.isPlainObject(gt))throw new Error("update must be a key:value object");if(typeof Ie>"u")throw new Error("indices must be an integer or array of integers");for(var Ge in R(lt,Ie,"indices"),gt){if(!Array.isArray(gt[Ge])||gt[Ge].length!==Ie.length)throw new Error("attribute "+Ge+" must be an array of length equal to indices array length");if(We&&(!(Ge in be)||!Array.isArray(be[Ge])||be[Ge].length!==gt[Ge].length))throw new Error("when maxPoints is set as a key:value object it must contain a 1:1 corrispondence with the keys and number of traces in the update object")}})(_e,Pe,Fe,ze);for(var et=function(lt,gt,Ie,be){var We,Ge,st,ot,Ce,Ue=l.isPlainObject(be),Ye=[];for(var xe in Array.isArray(Ie)||(Ie=[Ie]),Ie=I(Ie,lt.data.length-1),gt)for(var Ee=0;Ee<Ie.length;Ee++){if(We=lt.data[Ie[Ee]],Ge=(st=e(We,xe)).get(),ot=gt[xe][Ee],!l.isArrayOrTypedArray(ot))throw new Error("attribute: "+xe+" index: "+Ee+" must be an array");if(!l.isArrayOrTypedArray(Ge))throw new Error("cannot extend missing or non-array attribute: "+xe);if(Ge.constructor!==ot.constructor)throw new Error("cannot extend array with an array of a different type: "+xe);Ce=Ue?be[xe][Ee]:be,h(Ce)||(Ce=-1),Ye.push({prop:st,target:Ge,insert:ot,maxp:Math.floor(Ce)})}return Ye}(_e,Pe,Fe,ze),Re={},Ze={},Ke=0;Ke<et.length;Ke++){var $e=et[Ke].prop,rt=et[Ke].maxp,at=He(et[Ke].target,et[Ke].insert,rt);$e.set(at[0]),Array.isArray(Re[$e.astr])||(Re[$e.astr]=[]),Re[$e.astr].push(at[1]),Array.isArray(Ze[$e.astr])||(Ze[$e.astr]=[]),Ze[$e.astr].push(et[Ke].target.length)}return{update:Re,maxPoints:Ze}}function J(_e,Pe){var Fe=new _e.constructor(_e.length+Pe.length);return Fe.set(_e),Fe.set(Pe,_e.length),Fe}function D(_e,Pe,Fe,ze){_e=l.getGraphDiv(_e),A.clearPromiseQueue(_e);var He={};if(typeof Pe=="string")He[Pe]=Fe;else{if(!l.isPlainObject(Pe))return l.warn("Restyle fail.",Pe,Fe,ze),Promise.reject();He=l.extendFlat({},Pe),ze===void 0&&(ze=Fe)}Object.keys(He).length&&(_e.changed=!0);var et=A.coerceTraceIndices(_e,ze),Re=H(_e,He,et),Ze=Re.flags;Ze.calc&&(_e.calcdata=void 0),Ze.clearAxisTypes&&A.clearAxisTypes(_e,et,{});var Ke=[];Ze.fullReplot?Ke.push(q.plot):(Ke.push(s.previousPromises),s.supplyDefaults(_e),Ze.markerSize&&(s.doCalcdata(_e),Q(Ke)),Ze.style&&Ke.push(E.doTraceStyle),Ze.colorbars&&Ke.push(E.doColorBars),Ke.push(S)),Ke.push(s.rehover,s.redrag),r.add(_e,D,[_e,Re.undoit,Re.traces],D,[_e,Re.redoit,Re.traces]);var $e=l.syncOrAsync(Ke,_e);return $e&&$e.then||($e=Promise.resolve()),$e.then(function(){return _e.emit("plotly_restyle",Re.eventData),_e})}function B(_e){return _e===void 0?null:_e}function N(_e,Pe){return Pe?function(Fe,ze,He){var et=e(Fe,ze),Re=et.set;return et.set=function(Ze){F((He||"")+ze,et.get(),Ze,_e),Re(Ze)},et}:e}function F(_e,Pe,Fe,ze){if(Array.isArray(Pe)||Array.isArray(Fe))for(var He=Array.isArray(Pe)?Pe:[],et=Array.isArray(Fe)?Fe:[],Re=Math.max(He.length,et.length),Ze=0;Ze<Re;Ze++)F(_e+"["+Ze+"]",He[Ze],et[Ze],ze);else if(l.isPlainObject(Pe)||l.isPlainObject(Fe)){var Ke=l.isPlainObject(Pe)?Pe:{},$e=l.isPlainObject(Fe)?Fe:{},rt=l.extendFlat({},Ke,$e);for(var at in rt)F(_e+"."+at,Ke[at],$e[at],ze)}else ze[_e]===void 0&&(ze[_e]=B(Pe))}function H(_e,Pe,Fe){var ze,He=_e._fullLayout,et=_e._fullData,Re=_e.data,Ze=He._guiEditing,Ke=N(He._preGUI,Ze),$e=l.extendDeepAll({},Pe);j(Pe);var rt,at=M.traceFlags(),lt={},gt={};function Ie(){return Fe.map(function(){})}function be(er){var or=c.id2name(er);rt.indexOf(or)===-1&&rt.push(or)}function We(er){return"LAYOUT"+er+".autorange"}function Ge(er){return"LAYOUT"+er+".range"}function st(er){for(var or=er;or<et.length;or++)if(et[or]._input===Re[er])return et[or]}function ot(er,or,zt){if(Array.isArray(er))er.forEach(function(Dt){ot(Dt,or,zt)});else if(!(er in Pe)&&!A.hasParent(Pe,er)){var Qt;if(er.substr(0,6)==="LAYOUT")Qt=Ke(_e.layout,er.replace("LAYOUT",""));else{var cr=Fe[zt];Qt=N(He._tracePreGUI[st(cr)._fullInput.uid],Ze)(Re[cr],er)}er in gt||(gt[er]=Ie()),gt[er][zt]===void 0&&(gt[er][zt]=B(Qt.get())),or!==void 0&&Qt.set(or)}}function Ce(er){return function(or){return et[or][er]}}function Ue(er){return function(or,zt){return or===!1?et[Fe[zt]][er]:null}}for(var Ye in Pe){if(A.hasParent(Pe,Ye))throw new Error("cannot set "+Ye+" and a parent attribute simultaneously");var xe,Ee,Je,it,ht,ct,mt=Pe[Ye];if(Ye!=="autobinx"&&Ye!=="autobiny"||(Ye=Ye.charAt(Ye.length-1)+"bins",mt=Array.isArray(mt)?mt.map(Ue(Ye)):mt===!1?Fe.map(Ce(Ye)):null),lt[Ye]=mt,Ye.substr(0,6)!=="LAYOUT"){for(gt[Ye]=Ie(),ze=0;ze<Fe.length;ze++)if(xe=Re[Fe[ze]],Ee=st(Fe[ze]),it=(Je=N(He._tracePreGUI[Ee._fullInput.uid],Ze)(xe,Ye)).get(),(ht=Array.isArray(mt)?mt[ze%mt.length]:mt)!==void 0){var bt=Je.parts[Je.parts.length-1],Et=Ye.substr(0,Ye.length-bt.length-1),Mt=Et?Et+".":"",_t=Et?e(Ee,Et).get():Ee;if((ct=u.getTraceValObject(Ee,Je.parts))&&ct.impliedEdits&&ht!==null)for(var xt in ct.impliedEdits)ot(l.relativeAttr(Ye,xt),ct.impliedEdits[xt],ze);else if(bt!=="thicknessmode"&&bt!=="lenmode"||it===ht||ht!=="fraction"&&ht!=="pixels"||!_t){if(Ye==="type"&&(ht==="pie"!=(it==="pie")||ht==="funnelarea"!=(it==="funnelarea"))){var At="x",It="y";ht!=="bar"&&it!=="bar"||xe.orientation!=="h"||(At="y",It="x"),l.swapAttrs(xe,["?","?src"],"labels",At),l.swapAttrs(xe,["d?","?0"],"label",At),l.swapAttrs(xe,["?","?src"],"values",It),it==="pie"||it==="funnelarea"?(e(xe,"marker.color").set(e(xe,"marker.colors").get()),He._pielayer.selectAll("g.trace").remove()):i.traceIs(xe,"cartesian")&&e(xe,"marker.colors").set(e(xe,"marker.color").get())}}else{var Nt=He._size,Ot=_t.orient,Yt=Ot==="top"||Ot==="bottom";if(bt==="thicknessmode"){var Pt=Yt?Nt.h:Nt.w;ot(Mt+"thickness",_t.thickness*(ht==="fraction"?1/Pt:Pt),ze)}else{var Ne=Yt?Nt.w:Nt.h;ot(Mt+"len",_t.len*(ht==="fraction"?1/Ne:Ne),ze)}}if(gt[Ye][ze]=B(it),["swapxy","swapxyaxes","orientation","orientationaxes"].indexOf(Ye)!==-1){if(Ye==="orientation"){Je.set(ht);var ut=xe.x&&!xe.y?"h":"v";if((Je.get()||ut)===Ee.orientation)continue}else Ye==="orientationaxes"&&(xe.orientation={v:"h",h:"v"}[Ee.orientation]);A.swapXYData(xe),at.calc=at.clearAxisTypes=!0}else s.dataArrayContainers.indexOf(Je.parts[0])!==-1?(A.manageArrayContainers(Je,ht,gt),at.calc=!0):(ct?ct.arrayOk&&!i.traceIs(Ee,"regl")&&(l.isArrayOrTypedArray(ht)||l.isArrayOrTypedArray(it))?at.calc=!0:M.update(at,ct):at.calc=!0,Je.set(ht))}if(["swapxyaxes","orientationaxes"].indexOf(Ye)!==-1&&c.swap(_e,Fe),Ye==="orientationaxes"){var wt=e(_e.layout,"hovermode"),Bt=wt.get();Bt==="x"?wt.set("y"):Bt==="y"?wt.set("x"):Bt==="x unified"?wt.set("y unified"):Bt==="y unified"&&wt.set("x unified")}if(["orientation","type"].indexOf(Ye)!==-1){for(rt=[],ze=0;ze<Fe.length;ze++){var Jt=Re[Fe[ze]];i.traceIs(Jt,"cartesian")&&(be(Jt.xaxis||"x"),be(Jt.yaxis||"y"))}ot(rt.map(We),!0,0),ot(rt.map(Ge),[0,1],0)}}else Je=Ke(_e.layout,Ye.replace("LAYOUT","")),gt[Ye]=[B(Je.get())],Je.set(Array.isArray(mt)?mt[0]:mt),at.calc=!0}return(at.calc||at.plot)&&(at.fullReplot=!0),{flags:at,undoit:gt,redoit:lt,traces:Fe,eventData:l.extendDeepNoArrays([],[$e,Fe])}}function j(_e){var Pe,Fe,ze,He=l.counterRegex("axis",".title",!1,!1),et=/colorbar\.title$/,Re=Object.keys(_e);for(Pe=0;Pe<Re.length;Pe++)Fe=Re[Pe],ze=_e[Fe],Fe!=="title"&&!He.test(Fe)&&!et.test(Fe)||typeof ze!="string"&&typeof ze!="number"?Fe.indexOf("titlefont")>-1?Ze(Fe,Fe.replace("titlefont","title.font")):Fe.indexOf("titleposition")>-1?Ze(Fe,Fe.replace("titleposition","title.position")):Fe.indexOf("titleside")>-1?Ze(Fe,Fe.replace("titleside","title.side")):Fe.indexOf("titleoffset")>-1&&Ze(Fe,Fe.replace("titleoffset","title.offset")):Ze(Fe,Fe.replace("title","title.text"));function Ze(Ke,$e){_e[$e]=_e[Ke],delete _e[Ke]}}function G(_e,Pe,Fe){if(_e=l.getGraphDiv(_e),A.clearPromiseQueue(_e),_e.framework&&_e.framework.isPolar)return Promise.resolve(_e);var ze={};if(typeof Pe=="string")ze[Pe]=Fe;else{if(!l.isPlainObject(Pe))return l.warn("Relayout fail.",Pe,Fe),Promise.reject();ze=l.extendFlat({},Pe)}Object.keys(ze).length&&(_e.changed=!0);var He=ae(_e,ze),et=He.flags;et.calc&&(_e.calcdata=void 0);var Re=[s.previousPromises];et.layoutReplot?Re.push(E.layoutReplot):Object.keys(ze).length&&(W(_e,et,He)||s.supplyDefaults(_e),et.legend&&Re.push(E.doLegend),et.layoutstyle&&Re.push(E.layoutStyles),et.axrange&&Q(Re,He.rangesAltered),et.ticks&&Re.push(E.doTicksRelayout),et.modebar&&Re.push(E.doModeBar),et.camera&&Re.push(E.doCamera),et.colorbars&&Re.push(E.doColorBars),Re.push(S)),Re.push(s.rehover,s.redrag),r.add(_e,G,[_e,He.undoit],G,[_e,He.redoit]);var Ze=l.syncOrAsync(Re,_e);return Ze&&Ze.then||(Ze=Promise.resolve(_e)),Ze.then(function(){return _e.emit("plotly_relayout",He.eventData),_e})}function W(_e,Pe,Fe){var ze=_e._fullLayout;if(!Pe.axrange)return!1;for(var He in Pe)if(He!=="axrange"&&Pe[He])return!1;for(var et in Fe.rangesAltered){var Re=c.id2name(et),Ze=_e.layout[Re],Ke=ze[Re];if(Ke.autorange=Ze.autorange,Ze.range&&(Ke.range=Ze.range.slice()),Ke.cleanRange(),Ke._matchGroup){for(var $e in Ke._matchGroup)if($e!==et){var rt=ze[c.id2name($e)];rt.autorange=Ke.autorange,rt.range=Ke.range.slice(),rt._input.range=Ke.range.slice()}}}return!0}function Q(_e,Pe){var Fe=Pe?function(ze){var He=[],et=!0;for(var Re in Pe){var Ze=c.getFromId(ze,Re);if(He.push(Re),(Ze.ticklabelposition||"").indexOf("inside")!==-1&&Ze._anchorAxis&&He.push(Ze._anchorAxis._id),Ze._matchGroup)for(var Ke in Ze._matchGroup)Pe[Ke]||He.push(Ke);Ze.automargin&&(et=!1)}return c.draw(ze,He,{skipTitle:et})}:function(ze){return c.draw(ze,"redraw")};_e.push(v,E.doAutoRangeAndConstraints,Fe,E.drawData,E.finalDraw)}var $=/^[xyz]axis[0-9]*\.range(\[[0|1]\])?$/,ee=/^[xyz]axis[0-9]*\.autorange$/,ie=/^[xyz]axis[0-9]*\.domain(\[[0|1]\])?$/;function ae(_e,Pe){var Fe,ze,He,et=_e.layout,Re=_e._fullLayout,Ze=Re._guiEditing,Ke=N(Re._preGUI,Ze),$e=Object.keys(Pe),rt=c.list(_e),at=l.extendDeepAll({},Pe),lt={};for(j(Pe),$e=Object.keys(Pe),ze=0;ze<$e.length;ze++)if($e[ze].indexOf("allaxes")===0){for(He=0;He<rt.length;He++){var gt=rt[He]._id.substr(1),Ie=gt.indexOf("scene")!==-1?gt+".":"",be=$e[ze].replace("allaxes",Ie+rt[He]._name);Pe[be]||(Pe[be]=Pe[$e[ze]])}delete Pe[$e[ze]]}var We=M.layoutFlags(),Ge={},st={};function ot(cr,Dt){if(Array.isArray(cr))cr.forEach(function(ur){ot(ur,Dt)});else if(!(cr in Pe)&&!A.hasParent(Pe,cr)){var Ut=Ke(et,cr);cr in st||(st[cr]=B(Ut.get())),Dt!==void 0&&Ut.set(Dt)}}var Ce,Ue={};function Ye(cr){var Dt=c.name2id(cr.split(".")[0]);return Ue[Dt]=1,Dt}for(var xe in Pe){if(A.hasParent(Pe,xe))throw new Error("cannot set "+xe+" and a parent attribute simultaneously");for(var Ee=Ke(et,xe),Je=Pe[xe],it=Ee.parts.length-1;it>0&&typeof Ee.parts[it]!="string";)it--;var ht=Ee.parts[it],ct=Ee.parts[it-1]+"."+ht,mt=Ee.parts.slice(0,it).join("."),bt=e(_e.layout,mt).get(),Et=e(Re,mt).get(),Mt=Ee.get();if(Je!==void 0){Ge[xe]=Je,st[xe]=ht==="reverse"?Je:B(Mt);var _t=u.getLayoutValObject(Re,Ee.parts);if(_t&&_t.impliedEdits&&Je!==null)for(var xt in _t.impliedEdits)ot(l.relativeAttr(xe,xt),_t.impliedEdits[xt]);if(["width","height"].indexOf(xe)!==-1)if(Je){ot("autosize",null);var At=xe==="height"?"width":"height";ot(At,Re[At])}else Re[xe]=_e._initialAutoSize[xe];else if(xe==="autosize")ot("width",Je?null:Re.width),ot("height",Je?null:Re.height);else if(ct.match($))Ye(ct),e(Re,mt+"._inputRange").set(null);else if(ct.match(ee)){Ye(ct),e(Re,mt+"._inputRange").set(null);var It=e(Re,mt).get();It._inputDomain&&(It._input.domain=It._inputDomain.slice())}else ct.match(ie)&&e(Re,mt+"._inputDomain").set(null);if(ht==="type"){Ce=bt;var Nt=Et.type==="linear"&&Je==="log",Ot=Et.type==="log"&&Je==="linear";if(Nt||Ot){if(Ce&&Ce.range)if(Et.autorange)Nt&&(Ce.range=Ce.range[1]>Ce.range[0]?[1,2]:[2,1]);else{var Yt=Ce.range[0],Pt=Ce.range[1];Nt?(Yt<=0&&Pt<=0&&ot(mt+".autorange",!0),Yt<=0?Yt=Pt/1e6:Pt<=0&&(Pt=Yt/1e6),ot(mt+".range[0]",Math.log(Yt)/Math.LN10),ot(mt+".range[1]",Math.log(Pt)/Math.LN10)):(ot(mt+".range[0]",Math.pow(10,Yt)),ot(mt+".range[1]",Math.pow(10,Pt)))}else ot(mt+".autorange",!0);Array.isArray(Re._subplots.polar)&&Re._subplots.polar.length&&Re[Ee.parts[0]]&&Ee.parts[1]==="radialaxis"&&delete Re[Ee.parts[0]]._subplot.viewInitial["radialaxis.range"],i.getComponentMethod("annotations","convertCoords")(_e,Et,Je,ot),i.getComponentMethod("images","convertCoords")(_e,Et,Je,ot)}else ot(mt+".autorange",!0),ot(mt+".range",null);e(Re,mt+"._inputRange").set(null)}else if(ht.match(b)){var Ne=e(Re,xe).get(),ut=(Je||{}).type;ut&&ut!=="-"||(ut="linear"),i.getComponentMethod("annotations","convertCoords")(_e,Ne,ut,ot),i.getComponentMethod("images","convertCoords")(_e,Ne,ut,ot)}var wt=w.containerArrayMatch(xe);if(wt){Fe=wt.array,ze=wt.index;var Bt=wt.property,Jt=_t||{editType:"calc"};ze!==""&&Bt===""&&(w.isAddVal(Je)?st[xe]=null:w.isRemoveVal(Je)?st[xe]=(e(et,Fe).get()||[])[ze]:l.warn("unrecognized full object value",Pe)),M.update(We,Jt),lt[Fe]||(lt[Fe]={});var er=lt[Fe][ze];er||(er=lt[Fe][ze]={}),er[Bt]=Je,delete Pe[xe]}else ht==="reverse"?(bt.range?bt.range.reverse():(ot(mt+".autorange",!0),bt.range=[1,0]),Et.autorange?We.calc=!0:We.plot=!0):(Re._has("scatter-like")&&Re._has("regl")&&xe==="dragmode"&&(Je==="lasso"||Je==="select")&&Mt!=="lasso"&&Mt!=="select"||Re._has("gl2d")?We.plot=!0:_t?M.update(We,_t):We.calc=!0,Ee.set(Je))}}for(Fe in lt)w.applyContainerArrayChanges(_e,Ke(et,Fe),lt[Fe],We,Ke)||(We.plot=!0);for(var or in Ue){var zt=(Ce=c.getFromId(_e,or))&&Ce._constraintGroup;if(zt)for(var Qt in We.calc=!0,zt)Ue[Qt]||(c.getFromId(_e,Qt)._constraintShrinkable=!0)}return(oe(_e)||Pe.height||Pe.width)&&(We.plot=!0),(We.plot||We.calc)&&(We.layoutReplot=!0),{flags:We,rangesAltered:Ue,undoit:st,redoit:Ge,eventData:at}}function oe(_e){var Pe=_e._fullLayout,Fe=Pe.width,ze=Pe.height;return _e.layout.autosize&&s.plotAutoSize(_e,_e.layout,Pe),Pe.width!==Fe||Pe.height!==ze}function de(_e,Pe,Fe,ze){if(_e=l.getGraphDiv(_e),A.clearPromiseQueue(_e),_e.framework&&_e.framework.isPolar)return Promise.resolve(_e);l.isPlainObject(Pe)||(Pe={}),l.isPlainObject(Fe)||(Fe={}),Object.keys(Pe).length&&(_e.changed=!0),Object.keys(Fe).length&&(_e.changed=!0);var He=A.coerceTraceIndices(_e,ze),et=H(_e,l.extendFlat({},Pe),He),Re=et.flags,Ze=ae(_e,l.extendFlat({},Fe)),Ke=Ze.flags;(Re.calc||Ke.calc)&&(_e.calcdata=void 0),Re.clearAxisTypes&&A.clearAxisTypes(_e,He,Fe);var $e=[];Ke.layoutReplot?$e.push(E.layoutReplot):Re.fullReplot?$e.push(q.plot):($e.push(s.previousPromises),W(_e,Ke,Ze)||s.supplyDefaults(_e),Re.style&&$e.push(E.doTraceStyle),(Re.colorbars||Ke.colorbars)&&$e.push(E.doColorBars),Ke.legend&&$e.push(E.doLegend),Ke.layoutstyle&&$e.push(E.layoutStyles),Ke.axrange&&Q($e,Ze.rangesAltered),Ke.ticks&&$e.push(E.doTicksRelayout),Ke.modebar&&$e.push(E.doModeBar),Ke.camera&&$e.push(E.doCamera),$e.push(S)),$e.push(s.rehover,s.redrag),r.add(_e,de,[_e,et.undoit,Ze.undoit,et.traces],de,[_e,et.redoit,Ze.redoit,et.traces]);var rt=l.syncOrAsync($e,_e);return rt&&rt.then||(rt=Promise.resolve(_e)),rt.then(function(){return _e.emit("plotly_update",{data:et.eventData,layout:Ze.eventData}),_e})}function le(_e){return function(Pe){Pe._fullLayout._guiEditing=!0;var Fe=_e.apply(null,arguments);return Pe._fullLayout._guiEditing=!1,Fe}}var fe=[{pattern:/^hiddenlabels/,attr:"legend.uirevision"},{pattern:/^((x|y)axis\d*)\.((auto)?range|title\.text)/},{pattern:/axis\d*\.showspikes$/,attr:"modebar.uirevision"},{pattern:/(hover|drag)mode$/,attr:"modebar.uirevision"},{pattern:/^(scene\d*)\.camera/},{pattern:/^(geo\d*)\.(projection|center|fitbounds)/},{pattern:/^(ternary\d*\.[abc]axis)\.(min|title\.text)$/},{pattern:/^(polar\d*\.radialaxis)\.((auto)?range|angle|title\.text)/},{pattern:/^(polar\d*\.angularaxis)\.rotation/},{pattern:/^(mapbox\d*)\.(center|zoom|bearing|pitch)/},{pattern:/^legend\.(x|y)$/,attr:"editrevision"},{pattern:/^(shapes|annotations)/,attr:"editrevision"},{pattern:/^title\.text$/,attr:"editrevision"}],ue=[{pattern:/^selectedpoints$/,attr:"selectionrevision"},{pattern:/(^|value\.)visible$/,attr:"legend.uirevision"},{pattern:/^dimensions\[\d+\]\.constraintrange/},{pattern:/^node\.(x|y|groups)/},{pattern:/^level$/},{pattern:/(^|value\.)name$/},{pattern:/colorbar\.title\.text$/},{pattern:/colorbar\.(x|y)$/,attr:"editrevision"}];function we(_e,Pe){for(var Fe=0;Fe<Pe.length;Fe++){var ze=Pe[Fe],He=_e.match(ze.pattern);if(He)return{head:He[1],attr:ze.attr}}}function Ae(_e,Pe){var Fe=e(Pe,_e).get();if(Fe!==void 0)return Fe;var ze=_e.split(".");for(ze.pop();ze.length>1;)if(ze.pop(),(Fe=e(Pe,ze.join(".")+".uirevision").get())!==void 0)return Fe;return Pe.uirevision}function Se(_e,Pe){for(var Fe=0;Fe<Pe.length;Fe++)if(Pe[Fe]._fullInput.uid===_e)return Fe;return-1}function ke(_e,Pe,Fe){for(var ze=0;ze<Pe.length;ze++)if(Pe[ze].uid===_e)return ze;return!Pe[Fe]||Pe[Fe].uid?-1:Fe}function Me(_e,Pe){var Fe=l.isPlainObject(_e),ze=Array.isArray(_e);return Fe||ze?(Fe&&l.isPlainObject(Pe)||ze&&Array.isArray(Pe))&&JSON.stringify(_e)===JSON.stringify(Pe):_e===Pe}function ve(_e,Pe,Fe,ze){var He,et,Re,Ze=ze.getValObject,Ke=ze.flags,$e=ze.immutable,rt=ze.inArray,at=ze.arrayIndex;function lt(){var bt=He.editType;rt&&bt.indexOf("arraydraw")!==-1?l.pushUnique(Ke.arrays[rt],at):(M.update(Ke,He),bt!=="none"&&Ke.nChanges++,ze.transition&&He.anim&&Ke.nChangesAnim++,($.test(Re)||ee.test(Re))&&(Ke.rangesAltered[Fe[0]]=1),ie.test(Re)&&e(Pe,"_inputDomain").set(null),et==="datarevision"&&(Ke.newDataRevision=1))}function gt(bt){return bt.valType==="data_array"||bt.arrayOk}for(et in _e){if(Ke.calc&&!ze.transition)return;var Ie=_e[et],be=Pe[et],We=Fe.concat(et);if(Re=We.join("."),et.charAt(0)!=="_"&&typeof Ie!="function"&&Ie!==be){if((et==="tick0"||et==="dtick")&&Fe[0]!=="geo"){var Ge=Pe.tickmode;if(Ge==="auto"||Ge==="array"||!Ge)continue}if((et!=="range"||!Pe.autorange)&&(et!=="zmin"&&et!=="zmax"||Pe.type!=="contourcarpet")&&(He=Ze(We))&&(!He._compareAsJSON||JSON.stringify(Ie)!==JSON.stringify(be))){var st,ot=He.valType,Ce=gt(He),Ue=Array.isArray(Ie),Ye=Array.isArray(be);if(Ue&&Ye){var xe="_input_"+et,Ee=_e[xe],Je=Pe[xe];if(Array.isArray(Ee)&&Ee===Je)continue}if(be===void 0)Ce&&Ue?Ke.calc=!0:lt();else if(He._isLinkedToArray){var it=[],ht=!1;rt||(Ke.arrays[et]=it);var ct=Math.min(Ie.length,be.length),mt=Math.max(Ie.length,be.length);if(ct!==mt){if(He.editType!=="arraydraw"){lt();continue}ht=!0}for(st=0;st<ct;st++)ve(Ie[st],be[st],We.concat(st),l.extendFlat({inArray:et,arrayIndex:st},ze));if(ht)for(st=ct;st<mt;st++)it.push(st)}else!ot&&l.isPlainObject(Ie)?ve(Ie,be,We,ze):Ce?Ue&&Ye?($e&&(Ke.calc=!0),($e||ze.newDataRevision)&&lt()):Ue!==Ye?Ke.calc=!0:lt():Ue&&Ye&&Ie.length===be.length&&String(Ie)===String(be)||lt()}}}for(et in Pe)if(!(et in _e)&&et.charAt(0)!=="_"&&typeof Pe[et]!="function"){if(gt(He=Ze(Fe.concat(et)))&&Array.isArray(Pe[et]))return void(Ke.calc=!0);lt()}}function ge(_e){var Pe=_e._fullLayout,Fe=_e.getBoundingClientRect();if(!l.equalDomRects(Fe,Pe._lastBBox)){var ze=Pe._invTransform=l.inverseTransformMatrix(l.getFullTransformMatrix(_e));Pe._invScaleX=Math.sqrt(ze[0][0]*ze[0][0]+ze[0][1]*ze[0][1]+ze[0][2]*ze[0][2]),Pe._invScaleY=Math.sqrt(ze[1][0]*ze[1][0]+ze[1][1]*ze[1][1]+ze[1][2]*ze[1][2]),Pe._lastBBox=Fe}}function De(_e){var Pe=t.select(_e),Fe=_e._fullLayout;if(Fe._calcInverseTransform=ge,Fe._calcInverseTransform(_e),Fe._container=Pe.selectAll(".plot-container").data([0]),Fe._container.enter().insert("div",":first-child").classed("plot-container",!0).classed("plotly",!0),Fe._paperdiv=Fe._container.selectAll(".svg-container").data([0]),Fe._paperdiv.enter().append("div").classed("user-select-none",!0).classed("svg-container",!0).style("position","relative"),Fe._glcontainer=Fe._paperdiv.selectAll(".gl-container").data([{}]),Fe._glcontainer.enter().append("div").classed("gl-container",!0),Fe._paperdiv.selectAll(".main-svg").remove(),Fe._paperdiv.select(".modebar-container").remove(),Fe._paper=Fe._paperdiv.insert("svg",":first-child").classed("main-svg",!0),Fe._toppaper=Fe._paperdiv.append("svg").classed("main-svg",!0),Fe._modebardiv=Fe._paperdiv.append("div"),delete Fe._modeBar,Fe._hoverpaper=Fe._paperdiv.append("svg").classed("main-svg",!0),!Fe._uid){var ze={};t.selectAll("defs").each(function(){this.id&&(ze[this.id.split("-")[1]]=1)}),Fe._uid=l.randstr(ze)}Fe._paperdiv.selectAll(".main-svg").attr(m.svgAttrs),Fe._defs=Fe._paper.append("defs").attr("id","defs-"+Fe._uid),Fe._clips=Fe._defs.append("g").classed("clips",!0),Fe._topdefs=Fe._toppaper.append("defs").attr("id","topdefs-"+Fe._uid),Fe._topclips=Fe._topdefs.append("g").classed("clips",!0),Fe._bgLayer=Fe._paper.append("g").classed("bglayer",!0),Fe._draggers=Fe._paper.append("g").classed("draglayer",!0);var He=Fe._paper.append("g").classed("layer-below",!0);Fe._imageLowerLayer=He.append("g").classed("imagelayer",!0),Fe._shapeLowerLayer=He.append("g").classed("shapelayer",!0),Fe._cartesianlayer=Fe._paper.append("g").classed("cartesianlayer",!0),Fe._polarlayer=Fe._paper.append("g").classed("polarlayer",!0),Fe._ternarylayer=Fe._paper.append("g").classed("ternarylayer",!0),Fe._geolayer=Fe._paper.append("g").classed("geolayer",!0),Fe._funnelarealayer=Fe._paper.append("g").classed("funnelarealayer",!0),Fe._pielayer=Fe._paper.append("g").classed("pielayer",!0),Fe._treemaplayer=Fe._paper.append("g").classed("treemaplayer",!0),Fe._sunburstlayer=Fe._paper.append("g").classed("sunburstlayer",!0),Fe._indicatorlayer=Fe._toppaper.append("g").classed("indicatorlayer",!0),Fe._glimages=Fe._paper.append("g").classed("glimages",!0);var et=Fe._toppaper.append("g").classed("layer-above",!0);Fe._imageUpperLayer=et.append("g").classed("imagelayer",!0),Fe._shapeUpperLayer=et.append("g").classed("shapelayer",!0),Fe._infolayer=Fe._toppaper.append("g").classed("infolayer",!0),Fe._menulayer=Fe._toppaper.append("g").classed("menulayer",!0),Fe._zoomlayer=Fe._toppaper.append("g").classed("zoomlayer",!0),Fe._hoverlayer=Fe._hoverpaper.append("g").classed("hoverlayer",!0),Fe._modebardiv.classed("modebar-container",!0).style("position","absolute").style("top","0px").style("right","0px"),_e.emit("plotly_framework")}q.animate=function(_e,Pe,Fe){if(_e=l.getGraphDiv(_e),!l.isPlotDiv(_e))throw new Error("This element is not a Plotly plot: "+_e+". It's likely that you've failed to create a plot before animating it. For more details, see https://plotly.com/javascript/animations/");var ze=_e._transitionData;ze._frameQueue||(ze._frameQueue=[]);var He=(Fe=s.supplyAnimationDefaults(Fe)).transition,et=Fe.frame;function Re($e){return Array.isArray(He)?$e>=He.length?He[0]:He[$e]:He}function Ze($e){return Array.isArray(et)?$e>=et.length?et[0]:et[$e]:et}function Ke($e,rt){var at=0;return function(){if($e&&++at===rt)return $e()}}return ze._frameWaitingCnt===void 0&&(ze._frameWaitingCnt=0),new Promise(function($e,rt){function at(){ze._currentFrame&&ze._currentFrame.onComplete&&ze._currentFrame.onComplete();var Ee=ze._currentFrame=ze._frameQueue.shift();if(Ee){var Je=Ee.name?Ee.name.toString():null;_e._fullLayout._currentFrame=Je,ze._lastFrameAt=Date.now(),ze._timeToNext=Ee.frameOpts.duration,s.transition(_e,Ee.frame.data,Ee.frame.layout,A.coerceTraceIndices(_e,Ee.frame.traces),Ee.frameOpts,Ee.transitionOpts).then(function(){Ee.onComplete&&Ee.onComplete()}),_e.emit("plotly_animatingframe",{name:Je,frame:Ee.frame,animation:{frame:Ee.frameOpts,transition:Ee.transitionOpts}})}else _e.emit("plotly_animated"),window.cancelAnimationFrame(ze._animationRaf),ze._animationRaf=null}function lt(){_e.emit("plotly_animating"),ze._lastFrameAt=-1/0,ze._timeToNext=0,ze._runningTransitions=0,ze._currentFrame=null;var Ee=function(){ze._animationRaf=window.requestAnimationFrame(Ee),Date.now()-ze._lastFrameAt>ze._timeToNext&&at()};Ee()}var gt,Ie,be=0;function We(Ee){return Array.isArray(He)?be>=He.length?Ee.transitionOpts=He[be]:Ee.transitionOpts=He[0]:Ee.transitionOpts=He,be++,Ee}var Ge=[],st=Pe==null,ot=Array.isArray(Pe);if(!st&&!ot&&l.isPlainObject(Pe))Ge.push({type:"object",data:We(l.extendFlat({},Pe))});else if(st||["string","number"].indexOf(typeof Pe)!==-1)for(gt=0;gt<ze._frames.length;gt++)(Ie=ze._frames[gt])&&(st||String(Ie.group)===String(Pe))&&Ge.push({type:"byname",name:String(Ie.name),data:We({name:Ie.name})});else if(ot)for(gt=0;gt<Pe.length;gt++){var Ce=Pe[gt];["number","string"].indexOf(typeof Ce)!==-1?(Ce=String(Ce),Ge.push({type:"byname",name:Ce,data:We({name:Ce})})):l.isPlainObject(Ce)&&Ge.push({type:"object",data:We(l.extendFlat({},Ce))})}for(gt=0;gt<Ge.length;gt++)if((Ie=Ge[gt]).type==="byname"&&!ze._frameHash[Ie.data.name])return l.warn('animate failure: frame not found: "'+Ie.data.name+'"'),void rt();["next","immediate"].indexOf(Fe.mode)!==-1&&function(){if(ze._frameQueue.length!==0){for(;ze._frameQueue.length;){var Ee=ze._frameQueue.pop();Ee.onInterrupt&&Ee.onInterrupt()}_e.emit("plotly_animationinterrupted",[])}}(),Fe.direction==="reverse"&&Ge.reverse();var Ue=_e._fullLayout._currentFrame;if(Ue&&Fe.fromcurrent){var Ye=-1;for(gt=0;gt<Ge.length;gt++)if((Ie=Ge[gt]).type==="byname"&&Ie.name===Ue){Ye=gt;break}if(Ye>0&&Ye<Ge.length-1){var xe=[];for(gt=0;gt<Ge.length;gt++)Ie=Ge[gt],(Ge[gt].type!=="byname"||gt>Ye)&&xe.push(Ie);Ge=xe}}Ge.length>0?function(Ee){if(Ee.length!==0){for(var Je=0;Je<Ee.length;Je++){var it;it=Ee[Je].type==="byname"?s.computeFrame(_e,Ee[Je].name):Ee[Je].data;var ht=Ze(Je),ct=Re(Je);ct.duration=Math.min(ct.duration,ht.duration);var mt={frame:it,name:Ee[Je].name,frameOpts:ht,transitionOpts:ct};Je===Ee.length-1&&(mt.onComplete=Ke($e,2),mt.onInterrupt=rt),ze._frameQueue.push(mt)}Fe.mode==="immediate"&&(ze._lastFrameAt=-1/0),ze._animationRaf||lt()}}(Ge):(_e.emit("plotly_animated"),$e())})},q.addFrames=function(_e,Pe,Fe){if(_e=l.getGraphDiv(_e),Pe==null)return Promise.resolve();if(!l.isPlotDiv(_e))throw new Error("This element is not a Plotly plot: "+_e+". It's likely that you've failed to create a plot before adding frames. For more details, see https://plotly.com/javascript/animations/");var ze,He,et,Re,Ze=_e._transitionData._frames,Ke=_e._transitionData._frameHash;if(!Array.isArray(Pe))throw new Error("addFrames failure: frameList must be an Array of frame definitions"+Pe);var $e=Ze.length+2*Pe.length,rt=[],at={};for(ze=Pe.length-1;ze>=0;ze--)if(l.isPlainObject(Pe[ze])){var lt=Pe[ze].name,gt=(Ke[lt]||at[lt]||{}).name,Ie=Pe[ze].name,be=Ke[gt]||at[gt];gt&&Ie&&typeof Ie=="number"&&be&&_<5&&(_++,l.warn('addFrames: overwriting frame "'+(Ke[gt]||at[gt]).name+'" with a frame whose name of type "number" also equates to "'+gt+'". This is valid but may potentially lead to unexpected behavior since all plotly.js frame names are stored internally as strings.'),_===5&&l.warn("addFrames: This API call has yielded too many of these warnings. For the rest of this call, further warnings about numeric frame names will be suppressed.")),at[lt]={name:lt},rt.push({frame:s.supplyFrameDefaults(Pe[ze]),index:Fe&&Fe[ze]!==void 0&&Fe[ze]!==null?Fe[ze]:$e+ze})}rt.sort(function(xe,Ee){return xe.index>Ee.index?-1:xe.index<Ee.index?1:0});var We=[],Ge=[],st=Ze.length;for(ze=rt.length-1;ze>=0;ze--){if(typeof(He=rt[ze].frame).name=="number"&&l.warn("Warning: addFrames accepts frames with numeric names, but the numbers areimplicitly cast to strings"),!He.name)for(;Ke[He.name="frame "+_e._transitionData._counter++];);if(Ke[He.name]){for(et=0;et<Ze.length&&(Ze[et]||{}).name!==He.name;et++);We.push({type:"replace",index:et,value:He}),Ge.unshift({type:"replace",index:et,value:Ze[et]})}else Re=Math.max(0,Math.min(rt[ze].index,st)),We.push({type:"insert",index:Re,value:He}),Ge.unshift({type:"delete",index:Re}),st++}var ot=s.modifyFrames,Ce=s.modifyFrames,Ue=[_e,Ge],Ye=[_e,We];return r&&r.add(_e,ot,Ue,Ce,Ye),s.modifyFrames(_e,We)},q.deleteFrames=function(_e,Pe){if(_e=l.getGraphDiv(_e),!l.isPlotDiv(_e))throw new Error("This element is not a Plotly plot: "+_e);var Fe,ze,He=_e._transitionData._frames,et=[],Re=[];if(!Pe)for(Pe=[],Fe=0;Fe<He.length;Fe++)Pe.push(Fe);for((Pe=Pe.slice()).sort(),Fe=Pe.length-1;Fe>=0;Fe--)ze=Pe[Fe],et.push({type:"delete",index:ze}),Re.unshift({type:"insert",index:ze,value:He[ze]});var Ze=s.modifyFrames,Ke=s.modifyFrames,$e=[_e,Re],rt=[_e,et];return r&&r.add(_e,Ze,$e,Ke,rt),s.modifyFrames(_e,et)},q.addTraces=function _e(Pe,Fe,ze){Pe=l.getGraphDiv(Pe);var He,et,Re=[],Ze=q.deleteTraces,Ke=_e,$e=[Pe,Re],rt=[Pe,Fe];for(function(at,lt,gt){var Ie,be;if(!Array.isArray(at.data))throw new Error("gd.data must be an array.");if(typeof lt>"u")throw new Error("traces must be defined.");for(Array.isArray(lt)||(lt=[lt]),Ie=0;Ie<lt.length;Ie++)if(typeof(be=lt[Ie])!="object"||Array.isArray(be)||be===null)throw new Error("all values in traces array must be non-array objects");if(typeof gt>"u"||Array.isArray(gt)||(gt=[gt]),typeof gt<"u"&&gt.length!==lt.length)throw new Error("if indices is specified, traces.length must equal indices.length")}(Pe,Fe,ze),Array.isArray(Fe)||(Fe=[Fe]),Fe=Fe.map(function(at){return l.extendFlat({},at)}),A.cleanData(Fe),He=0;He<Fe.length;He++)Pe.data.push(Fe[He]);for(He=0;He<Fe.length;He++)Re.push(-Fe.length+He);if(typeof ze>"u")return et=q.redraw(Pe),r.add(Pe,Ze,$e,Ke,rt),et;Array.isArray(ze)||(ze=[ze]);try{V(Pe,Re,ze)}catch(at){throw Pe.data.splice(Pe.data.length-Fe.length,Fe.length),at}return r.startSequence(Pe),r.add(Pe,Ze,$e,Ke,rt),et=q.moveTraces(Pe,Re,ze),r.stopSequence(Pe),et},q.deleteTraces=function _e(Pe,Fe){Pe=l.getGraphDiv(Pe);var ze,He,et=[],Re=q.addTraces,Ze=_e,Ke=[Pe,et,Fe],$e=[Pe,Fe];if(typeof Fe>"u")throw new Error("indices must be an integer or array of integers.");for(Array.isArray(Fe)||(Fe=[Fe]),R(Pe,Fe,"indices"),(Fe=I(Fe,Pe.data.length-1)).sort(l.sorterDes),ze=0;ze<Fe.length;ze+=1)He=Pe.data.splice(Fe[ze],1)[0],et.push(He);var rt=q.redraw(Pe);return r.add(Pe,Re,Ke,Ze,$e),rt},q.extendTraces=function _e(Pe,Fe,ze,He){function et($e,rt,at){var lt,gt;if(l.isTypedArray($e))if(at<0){var Ie=new $e.constructor(0),be=J($e,rt);at<0?(lt=be,gt=Ie):(lt=Ie,gt=be)}else if(lt=new $e.constructor(at),gt=new $e.constructor($e.length+rt.length-at),at===rt.length)lt.set(rt),gt.set($e);else if(at<rt.length){var We=rt.length-at;lt.set(rt.subarray(We)),gt.set($e),gt.set(rt.subarray(0,We),$e.length)}else{var Ge=at-rt.length,st=$e.length-Ge;lt.set($e.subarray(st)),lt.set(rt,Ge),gt.set($e.subarray(0,st))}else lt=$e.concat(rt),gt=at>=0&&at<lt.length?lt.splice(0,lt.length-at):[];return[lt,gt]}var Re=O(Pe=l.getGraphDiv(Pe),Fe,ze,He,et),Ze=q.redraw(Pe),Ke=[Pe,Re.update,ze,Re.maxPoints];return r.add(Pe,q.prependTraces,Ke,_e,arguments),Ze},q.moveTraces=function _e(Pe,Fe,ze){var He,et=[],Re=[],Ze=_e,Ke=_e,$e=[Pe=l.getGraphDiv(Pe),ze,Fe],rt=[Pe,Fe,ze];if(V(Pe,Fe,ze),Fe=Array.isArray(Fe)?Fe:[Fe],typeof ze>"u")for(ze=[],He=0;He<Fe.length;He++)ze.push(-Fe.length+He);for(ze=Array.isArray(ze)?ze:[ze],Fe=I(Fe,Pe.data.length-1),ze=I(ze,Pe.data.length-1),He=0;He<Pe.data.length;He++)Fe.indexOf(He)===-1&&et.push(Pe.data[He]);for(He=0;He<Fe.length;He++)Re.push({newIndex:ze[He],trace:Pe.data[Fe[He]]});for(Re.sort(function(lt,gt){return lt.newIndex-gt.newIndex}),He=0;He<Re.length;He+=1)et.splice(Re[He].newIndex,0,Re[He].trace);Pe.data=et;var at=q.redraw(Pe);return r.add(Pe,Ze,$e,Ke,rt),at},q.prependTraces=function _e(Pe,Fe,ze,He){function et($e,rt,at){var lt,gt;if(l.isTypedArray($e))if(at<=0){var Ie=new $e.constructor(0),be=J(rt,$e);at<0?(lt=be,gt=Ie):(lt=Ie,gt=be)}else if(lt=new $e.constructor(at),gt=new $e.constructor($e.length+rt.length-at),at===rt.length)lt.set(rt),gt.set($e);else if(at<rt.length){var We=rt.length-at;lt.set(rt.subarray(0,We)),gt.set(rt.subarray(We)),gt.set($e,We)}else{var Ge=at-rt.length;lt.set(rt),lt.set($e.subarray(0,Ge),rt.length),gt.set($e.subarray(Ge))}else lt=rt.concat($e),gt=at>=0&&at<lt.length?lt.splice(at,lt.length):[];return[lt,gt]}var Re=O(Pe=l.getGraphDiv(Pe),Fe,ze,He,et),Ze=q.redraw(Pe),Ke=[Pe,Re.update,ze,Re.maxPoints];return r.add(Pe,q.extendTraces,Ke,_e,arguments),Ze},q.newPlot=function(_e,Pe,Fe,ze){return _e=l.getGraphDiv(_e),s.cleanPlot([],{},_e._fullData||[],_e._fullLayout||{}),s.purge(_e),q.plot(_e,Pe,Fe,ze)},q.plot=function(_e,Pe,Fe,ze){var He;if(_e=l.getGraphDiv(_e),o.init(_e),l.isPlainObject(Pe)){var et=Pe;Pe=et.data,Fe=et.layout,ze=et.config,He=et.frames}if(o.triggerHandler(_e,"plotly_beforeplot",[Pe,Fe,ze])===!1)return Promise.reject();Pe||Fe||l.isPlotDiv(_e)||l.warn("Calling Plotly.plot as if redrawing but this container doesn't yet have a plot.",_e),L(_e,ze),Fe||(Fe={}),t.select(_e).classed("js-plotly-plot",!0),f.makeTester(),Array.isArray(_e._promises)||(_e._promises=[]);var Re=(_e.data||[]).length===0&&Array.isArray(Pe);Array.isArray(Pe)&&(A.cleanData(Pe),Re?_e.data=Pe:_e.data.push.apply(_e.data,Pe),_e.empty=!1),_e.layout&&!Re||(_e.layout=A.cleanLayout(Fe)),s.supplyDefaults(_e);var Ze=_e._fullLayout,Ke=Ze._has("cartesian");if(!Ze._has("polar")&&Pe&&Pe[0]&&Pe[0].r)return l.log("Legacy polar charts are deprecated!"),function(Ge,st,ot){var Ce=t.select(Ge).selectAll(".plot-container").data([0]);Ce.enter().insert("div",":first-child").classed("plot-container plotly",!0);var Ue=Ce.selectAll(".svg-container").data([0]);Ue.enter().append("div").classed("svg-container",!0).style("position","relative"),Ue.html(""),st&&(Ge.data=st),ot&&(Ge.layout=ot),a.manager.fillLayout(Ge),Ue.style({width:Ge._fullLayout.width+"px",height:Ge._fullLayout.height+"px"}),Ge.framework=a.manager.framework(Ge),Ge.framework({data:Ge.data,layout:Ge.layout},Ue.node()),Ge.framework.setUndoPoint();var Ye=Ge.framework.svg(),xe=1,Ee=Ge._fullLayout.title?Ge._fullLayout.title.text:"";Ee!==""&&Ee||(xe=0);var Je=function(){this.call(y.convertToTspans,Ge)},it=Ye.select(".title-group text").call(Je);if(Ge._context.edits.titleText){var ht=l._(Ge,"Click to enter Plot title");Ee&&Ee!==ht||(xe=.2,it.attr({"data-unformatted":ht}).text(ht).style({opacity:xe}).on("mouseover.opacity",function(){t.select(this).transition().duration(100).style("opacity",1)}).on("mouseout.opacity",function(){t.select(this).transition().duration(1e3).style("opacity",0)}));var ct=function(){this.call(y.makeEditable,{gd:Ge}).on("edit",function(mt){Ge.framework({layout:{title:{text:mt}}}),this.text(mt).call(Je),this.call(ct)}).on("cancel",function(){var mt=this.attr("data-unformatted");this.text(mt).call(Je)})};it.call(ct)}return Ge._context.setBackground(Ge,Ge._fullLayout.paper_bgcolor),s.addLinks(Ge),Promise.resolve()}(_e,Pe,Fe);Ze._replotting=!0,(Re||Ze._shouldCreateBgLayer)&&(De(_e),Ze._shouldCreateBgLayer&&delete Ze._shouldCreateBgLayer),_e.framework!==De&&(_e.framework=De,De(_e)),f.initGradients(_e),Re&&c.saveShowSpikeInitial(_e);var $e=!_e.calcdata||_e.calcdata.length!==(_e._fullData||[]).length;$e&&s.doCalcdata(_e);for(var rt=0;rt<_e.calcdata.length;rt++)_e.calcdata[rt][0].trace=_e._fullData[rt];_e._context.responsive?_e._responsiveChartHandler||(_e._responsiveChartHandler=function(){l.isHidden(_e)||s.resize(_e)},window.addEventListener("resize",_e._responsiveChartHandler)):l.clearResponsive(_e);var at=l.extendFlat({},Ze._size),lt=0;function gt(){if(s.clearAutoMarginIds(_e),E.drawMarginPushers(_e),c.allowAutoMargin(_e),Ze._has("pie"))for(var Ge=_e._fullData,st=0;st<Ge.length;st++){var ot=Ge[st];ot.type==="pie"&&ot.automargin&&s.allowAutoMargin(_e,"pie."+ot.uid+".automargin")}return s.doAutoMargin(_e),s.previousPromises(_e)}function Ie(){_e._transitioning||(E.doAutoRangeAndConstraints(_e),Re&&c.saveRangeInitial(_e),i.getComponentMethod("rangeslider","calcAutorange")(_e))}var be=[s.previousPromises,function(){if(He)return q.addFrames(_e,He)},function Ge(){for(var st=Ze._basePlotModules,ot=0;ot<st.length;ot++)st[ot].drawFramework&&st[ot].drawFramework(_e);if(!Ze._glcanvas&&Ze._has("gl")&&(Ze._glcanvas=Ze._glcontainer.selectAll(".gl-canvas").data([{key:"contextLayer",context:!0,pick:!1},{key:"focusLayer",context:!1,pick:!1},{key:"pickLayer",context:!1,pick:!0}],function(Ye){return Ye.key}),Ze._glcanvas.enter().append("canvas").attr("class",function(Ye){return"gl-canvas gl-canvas-"+Ye.key.replace("Layer","")}).style({position:"absolute",top:0,left:0,overflow:"visible","pointer-events":"none"})),Ze._glcanvas){Ze._glcanvas.attr("width",Ze.width).attr("height",Ze.height);var Ce=Ze._glcanvas.data()[0].regl;if(Ce&&(Math.floor(Ze.width)!==Ce._gl.drawingBufferWidth||Math.floor(Ze.height)!==Ce._gl.drawingBufferHeight)){var Ue="WebGL context buffer and canvas dimensions do not match due to browser/WebGL bug.";if(!lt)return l.log(Ue+" Clearing graph and plotting again."),s.cleanPlot([],{},_e._fullData,Ze),s.supplyDefaults(_e),Ze=_e._fullLayout,s.doCalcdata(_e),lt++,Ge();l.error(Ue)}}return Ze.modebar.orientation==="h"?Ze._modebardiv.style("height",null).style("width","100%"):Ze._modebardiv.style("width",null).style("height",Ze.height+"px"),s.previousPromises(_e)},gt,function(){if(s.didMarginChange(at,Ze._size))return l.syncOrAsync([gt,E.layoutStyles],_e)}];Ke&&be.push(function(){if($e)return l.syncOrAsync([i.getComponentMethod("shapes","calcAutorange"),i.getComponentMethod("annotations","calcAutorange"),Ie],_e);Ie()}),be.push(E.layoutStyles),Ke&&be.push(function(){return c.draw(_e,Re?"":"redraw")},function(Ge){Ge._fullLayout._insideTickLabelsAutorange&&G(Ge,Ge._fullLayout._insideTickLabelsAutorange).then(function(){Ge._fullLayout._insideTickLabelsAutorange=void 0})}),be.push(E.drawData,E.finalDraw,d,s.addLinks,s.rehover,s.redrag,s.doAutoMargin,function(Ge){Ge._fullLayout._insideTickLabelsAutorange&&Re&&c.saveRangeInitial(Ge,!0)},s.previousPromises);var We=l.syncOrAsync(be,_e);return We&&We.then||(We=Promise.resolve()),We.then(function(){return S(_e),_e})},q.purge=function(_e){var Pe=(_e=l.getGraphDiv(_e))._fullLayout||{},Fe=_e._fullData||[];return s.cleanPlot([],{},Fe,Pe),s.purge(_e),o.purge(_e),Pe._container&&Pe._container.remove(),delete _e._context,_e},q.react=function(_e,Pe,Fe,ze){var He,et;_e=l.getGraphDiv(_e),A.clearPromiseQueue(_e);var Re=_e._fullData,Ze=_e._fullLayout;if(l.isPlotDiv(_e)&&Re&&Ze){if(l.isPlainObject(Pe)){var Ke=Pe;Pe=Ke.data,Fe=Ke.layout,ze=Ke.config,He=Ke.frames}var $e=!1;if(ze){var rt=l.extendDeep({},_e._context);_e._context=void 0,L(_e,ze),$e=function mt(bt,Et){var Mt;for(Mt in bt)if(Mt.charAt(0)!=="_"){var _t=bt[Mt],xt=Et[Mt];if(_t!==xt)if(l.isPlainObject(_t)&&l.isPlainObject(xt)){if(mt(_t,xt))return!0}else{if(!Array.isArray(_t)||!Array.isArray(xt)||_t.length!==xt.length)return!0;for(var At=0;At<_t.length;At++)if(_t[At]!==xt[At]&&(!l.isPlainObject(_t[At])||!l.isPlainObject(xt[At])||mt(_t[At],xt[At])))return!0}}}(rt,_e._context)}_e.data=Pe||[],A.cleanData(_e.data),_e.layout=Fe||{},A.cleanLayout(_e.layout),function(mt,bt,Et,Mt){var _t,xt,At,It,Nt,Ot,Yt,Pt,Ne=Mt._preGUI,ut=[],wt={};for(_t in Ne){if(Nt=we(_t,fe)){if(xt=Nt.attr||Nt.head+".uirevision",(It=(At=e(Mt,xt).get())&&Ae(xt,bt))&&It===At&&((Ot=Ne[_t])===null&&(Ot=void 0),Me(Pt=(Yt=e(bt,_t)).get(),Ot))){Pt===void 0&&_t.substr(_t.length-9)==="autorange"&&ut.push(_t.substr(0,_t.length-10)),Yt.set(B(e(Mt,_t).get()));continue}}else l.warn("unrecognized GUI edit: "+_t);delete Ne[_t],_t.substr(_t.length-8,6)==="range["&&(wt[_t.substr(0,_t.length-9)]=1)}for(var Bt=0;Bt<ut.length;Bt++){var Jt=ut[Bt];if(wt[Jt]){var er=e(bt,Jt).get();er&&delete er.autorange}}var or=Mt._tracePreGUI;for(var zt in or){var Qt,cr=or[zt],Dt=null;for(_t in cr){if(!Dt){var Ut=Se(zt,Et);if(Ut<0){delete or[zt];break}var ur=ke(zt,mt,(Qt=Et[Ut]._fullInput).index);if(ur<0){delete or[zt];break}Dt=mt[ur]}if(Nt=we(_t,ue)){if(Nt.attr?It=(At=e(Mt,Nt.attr).get())&&Ae(Nt.attr,bt):(At=Qt.uirevision,(It=Dt.uirevision)===void 0&&(It=bt.uirevision)),It&&It===At&&((Ot=cr[_t])===null&&(Ot=void 0),Me(Pt=(Yt=e(Dt,_t)).get(),Ot))){Yt.set(B(e(Qt,_t).get()));continue}}else l.warn("unrecognized GUI edit: "+_t+" in trace uid "+zt);delete cr[_t]}}}(_e.data,_e.layout,Re,Ze),s.supplyDefaults(_e,{skipUpdateCalc:!0});var at=_e._fullData,lt=_e._fullLayout,gt=lt.datarevision===void 0,Ie=lt.transition,be=function(mt,bt,Et,Mt,_t){var xt=M.layoutFlags();function At(It){return u.getLayoutValObject(Et,It)}return xt.arrays={},xt.rangesAltered={},xt.nChanges=0,xt.nChangesAnim=0,ve(bt,Et,[],{getValObject:At,flags:xt,immutable:Mt,transition:_t,gd:mt}),(xt.plot||xt.calc)&&(xt.layoutReplot=!0),_t&&xt.nChanges&&xt.nChangesAnim&&(xt.anim=xt.nChanges===xt.nChangesAnim?"all":"some"),xt}(_e,Ze,lt,gt,Ie),We=be.newDataRevision,Ge=function(mt,bt,Et,Mt,_t,xt){var At=bt.length===Et.length;if(!_t&&!At)return{fullReplot:!0,calc:!0};var It,Nt,Ot=M.traceFlags();Ot.arrays={},Ot.nChanges=0,Ot.nChangesAnim=0;var Yt={getValObject:function(Ne){var ut=u.getTraceValObject(Nt,Ne);return!Nt._module.animatable&&ut.anim&&(ut.anim=!1),ut},flags:Ot,immutable:Mt,transition:_t,newDataRevision:xt,gd:mt},Pt={};for(It=0;It<bt.length;It++)if(Et[It]){if(Nt=Et[It]._fullInput,s.hasMakesDataTransform(Nt)&&(Nt=Et[It]),Pt[Nt.uid])continue;Pt[Nt.uid]=1,ve(bt[It]._fullInput,Nt,[],Yt)}return(Ot.calc||Ot.plot)&&(Ot.fullReplot=!0),_t&&Ot.nChanges&&Ot.nChangesAnim&&(Ot.anim=Ot.nChanges===Ot.nChangesAnim&&At?"all":"some"),Ot}(_e,Re,at,gt,Ie,We);if(oe(_e)&&(be.layoutReplot=!0),Ge.calc||be.calc){_e.calcdata=void 0;for(var st=Object.getOwnPropertyNames(lt),ot=0;ot<st.length;ot++){var Ce=st[ot],Ue=Ce.substring(0,5);if(Ue==="xaxis"||Ue==="yaxis"){var Ye=lt[Ce]._emptyCategories;Ye&&Ye()}}}else s.supplyDefaultsUpdateCalc(_e.calcdata,at);var xe=[];if(He&&(_e._transitionData={},s.createTransitionData(_e),xe.push(function(){return q.addFrames(_e,He)})),lt.transition&&!$e&&(Ge.anim||be.anim))be.ticks&&xe.push(E.doTicksRelayout),s.doCalcdata(_e),E.doAutoRangeAndConstraints(_e),xe.push(function(){return s.transitionFromReact(_e,Ge,be,Ze)});else if(Ge.fullReplot||be.layoutReplot||$e)_e._fullLayout._skipDefaults=!0,xe.push(q.plot);else{for(var Ee in be.arrays){var Je=be.arrays[Ee];if(Je.length){var it=i.getComponentMethod(Ee,"drawOne");if(it!==l.noop)for(var ht=0;ht<Je.length;ht++)it(_e,Je[ht]);else{var ct=i.getComponentMethod(Ee,"draw");if(ct===l.noop)throw new Error("cannot draw components: "+Ee);ct(_e)}}}xe.push(s.previousPromises),Ge.style&&xe.push(E.doTraceStyle),(Ge.colorbars||be.colorbars)&&xe.push(E.doColorBars),be.legend&&xe.push(E.doLegend),be.layoutstyle&&xe.push(E.layoutStyles),be.axrange&&Q(xe),be.ticks&&xe.push(E.doTicksRelayout),be.modebar&&xe.push(E.doModeBar),be.camera&&xe.push(E.doCamera),xe.push(S)}xe.push(s.rehover,s.redrag),(et=l.syncOrAsync(xe,_e))&&et.then||(et=Promise.resolve(_e))}else et=q.newPlot(_e,Pe,Fe,ze);return et.then(function(){return _e.emit("plotly_react",{data:Pe,layout:Fe}),_e})},q.redraw=function(_e){if(_e=l.getGraphDiv(_e),!l.isPlotDiv(_e))throw new Error("This element is not a Plotly plot: "+_e);return A.cleanData(_e.data),A.cleanLayout(_e.layout),_e.calcdata=void 0,q.plot(_e).then(function(){return _e.emit("plotly_redraw"),_e})},q.relayout=G,q.restyle=D,q.setPlotConfig=function(_e){return l.extendFlat(T,_e)},q.update=de,q._guiRelayout=le(G),q._guiRestyle=le(D),q._guiUpdate=le(de),q._storeDirectGUIEdit=function(_e,Pe,Fe){for(var ze in Fe)F(ze,e(_e,ze).get(),Fe[ze],Pe)}},{"../components/color":643,"../components/drawing":665,"../constants/xmlns_namespaces":754,"../lib":778,"../lib/events":767,"../lib/queue":794,"../lib/svg_text_utils":803,"../plots/cartesian/axes":828,"../plots/cartesian/constants":834,"../plots/cartesian/graph_interact":837,"../plots/cartesian/select":847,"../plots/plots":891,"../plots/polar/legacy":899,"../registry":911,"./edit_types":810,"./helpers":811,"./manage_arrays":813,"./plot_config":815,"./plot_schema":816,"./subroutines":818,d3:169,"fast-isnumeric":241,"has-hover":440}],815:[function(n,z,q){"use strict";var t={staticPlot:{valType:"boolean",dflt:!1},plotlyServerURL:{valType:"string",dflt:""},editable:{valType:"boolean",dflt:!1},edits:{annotationPosition:{valType:"boolean",dflt:!1},annotationTail:{valType:"boolean",dflt:!1},annotationText:{valType:"boolean",dflt:!1},axisTitleText:{valType:"boolean",dflt:!1},colorbarPosition:{valType:"boolean",dflt:!1},colorbarTitleText:{valType:"boolean",dflt:!1},legendPosition:{valType:"boolean",dflt:!1},legendText:{valType:"boolean",dflt:!1},shapePosition:{valType:"boolean",dflt:!1},titleText:{valType:"boolean",dflt:!1}},autosizable:{valType:"boolean",dflt:!1},responsive:{valType:"boolean",dflt:!1},fillFrame:{valType:"boolean",dflt:!1},frameMargins:{valType:"number",dflt:0,min:0,max:.5},scrollZoom:{valType:"flaglist",flags:["cartesian","gl3d","geo","mapbox"],extras:[!0,!1],dflt:"gl3d+geo+mapbox"},doubleClick:{valType:"enumerated",values:[!1,"reset","autosize","reset+autosize"],dflt:"reset+autosize"},doubleClickDelay:{valType:"number",dflt:300,min:0},showAxisDragHandles:{valType:"boolean",dflt:!0},showAxisRangeEntryBoxes:{valType:"boolean",dflt:!0},showTips:{valType:"boolean",dflt:!0},showLink:{valType:"boolean",dflt:!1},linkText:{valType:"string",dflt:"Edit chart",noBlank:!0},sendData:{valType:"boolean",dflt:!0},showSources:{valType:"any",dflt:!1},displayModeBar:{valType:"enumerated",values:["hover",!0,!1],dflt:"hover"},showSendToCloud:{valType:"boolean",dflt:!1},showEditInChartStudio:{valType:"boolean",dflt:!1},modeBarButtonsToRemove:{valType:"any",dflt:[]},modeBarButtonsToAdd:{valType:"any",dflt:[]},modeBarButtons:{valType:"any",dflt:!1},toImageButtonOptions:{valType:"any",dflt:{}},displaylogo:{valType:"boolean",dflt:!0},watermark:{valType:"boolean",dflt:!1},plotGlPixelRatio:{valType:"number",dflt:2,min:1,max:4},setBackground:{valType:"any",dflt:"transparent"},topojsonURL:{valType:"string",noBlank:!0,dflt:"https://cdn.plot.ly/"},mapboxAccessToken:{valType:"string",dflt:null},logging:{valType:"integer",min:0,max:2,dflt:1},notifyOnLogging:{valType:"integer",min:0,max:2,dflt:0},queueLength:{valType:"integer",min:0,dflt:0},globalTransforms:{valType:"any",dflt:[]},locale:{valType:"string",dflt:"en-US"},locales:{valType:"any",dflt:{}}},h={};(function p(l,e){for(var o in l){var r=l[o];r.valType?e[o]=r.dflt:(e[o]||(e[o]={}),p(r,e[o]))}})(t,h),z.exports={configAttributes:t,dfltConfig:h}},{}],816:[function(n,z,q){"use strict";var t=n("../registry"),h=n("../lib"),p=n("../plots/attributes"),l=n("../plots/layout_attributes"),e=n("../plots/frame_attributes"),o=n("../plots/animation_attributes"),r=n("./plot_config").configAttributes,i=n("../plots/polar/legacy/area_attributes"),u=n("../plots/polar/legacy/axis_attributes"),s=n("./edit_types"),a=h.extendFlat,c=h.extendDeepAll,f=h.isPlainObject,g=h.isArrayOrTypedArray,d=h.nestedProperty,m=h.valObjectMeta,y=["_isSubplotObj","_isLinkedToArray","_arrayAttrRegexps","_deprecated"];function v(_,S,C){if(!_)return!1;if(_._isLinkedToArray){if(T(S[C]))C++;else if(C<S.length)return!1}for(;C<S.length;C++){var k=_[S[C]];if(!f(k)||(_=k,C===S.length-1))break;if(_._isLinkedToArray){if(!T(S[++C]))return!1}else if(_.valType==="info_array"){var L=S[++C];if(!T(L))return!1;var I=_.items;if(Array.isArray(I)){if(L>=I.length)return!1;if(_.dimensions===2){if(C++,S.length===C)return _;var R=S[C];if(!T(R))return!1;_=I[L][R]}else _=I[L]}else _=I}}return _}function T(_){return _===Math.round(_)&&_>=0}function w(){var _,S,C={};for(_ in c(C,l),t.subplotsRegistry)if((S=t.subplotsRegistry[_]).layoutAttributes)if(Array.isArray(S.attr))for(var k=0;k<S.attr.length;k++)M(C,S,S.attr[k]);else M(C,S,S.attr==="subplot"?S.name:S.attr);for(_ in C=function(V){return a(V,{radialaxis:u.radialaxis,angularaxis:u.angularaxis}),a(V,u.layout),V}(C),t.componentsRegistry){var L=(S=t.componentsRegistry[_]).schema;if(L&&(L.subplots||L.layout)){var I=L.subplots;if(I&&I.xaxis&&!I.yaxis)for(var R in I.xaxis)delete C.yaxis[R]}else S.name==="colorscale"?c(C,S.layoutAttributes):S.layoutAttributes&&b(C,S.layoutAttributes,S.name)}return{layoutAttributes:E(C)}}function A(){var _={frames:c({},e)};return E(_),_.frames}function E(_){return function(S){q.crawl(S,function(C,k,L){q.isValObject(C)?C.valType==="data_array"?(C.role="data",L[k+"src"]={valType:"string",editType:"none"}):C.arrayOk===!0&&(L[k+"src"]={valType:"string",editType:"none"}):f(C)&&(C.role="object")})}(_),function(S){q.crawl(S,function(C,k,L){if(C){var I=C._isLinkedToArray;I&&(delete C._isLinkedToArray,L[k]={items:{}},L[k].items[I]=C,L[k].role="object")}})}(_),function(S){(function C(k){for(var L in k)if(f(k[L]))C(k[L]);else if(Array.isArray(k[L]))for(var I=0;I<k[L].length;I++)C(k[L][I]);else k[L]instanceof RegExp&&(k[L]=k[L].toString())})(S)}(_),_}function M(_,S,C){var k=d(_,C),L=c({},S.layoutAttributes);L._isSubplotObj=!0,k.set(L)}function b(_,S,C){var k=d(_,C);k.set(c(k.get()||{},S))}q.IS_SUBPLOT_OBJ="_isSubplotObj",q.IS_LINKED_TO_ARRAY="_isLinkedToArray",q.DEPRECATED="_deprecated",q.UNDERSCORE_ATTRS=y,q.get=function(){var _={};t.allTypes.concat("area").forEach(function(C){_[C]=function(k){var L,I;k==="area"?(L={attributes:i},I={}):(L=t.modules[k]._module,I=L.basePlotModule);var R={type:null},V=c({},p),O=c({},L.attributes);q.crawl(O,function(B,N,F,H,j){d(V,j).set(void 0),B===void 0&&d(O,j).set(void 0)}),c(R,V),t.traceIs(k,"noOpacity")&&delete R.opacity,t.traceIs(k,"showLegend")||(delete R.showlegend,delete R.legendgroup),t.traceIs(k,"noHover")&&(delete R.hoverinfo,delete R.hoverlabel),L.selectPoints||delete R.selectedpoints,c(R,O),I.attributes&&c(R,I.attributes),R.type=k;var J={meta:L.meta||{},categories:L.categories||{},animatable:!!L.animatable,type:k,attributes:E(R)};if(L.layoutAttributes){var D={};c(D,L.layoutAttributes),J.layoutAttributes=E(D)}return L.animatable||q.crawl(J,function(B){q.isValObject(B)&&"anim"in B&&delete B.anim}),J}(C)});var S={};return Object.keys(t.transformsRegistry).forEach(function(C){S[C]=function(k){var L=t.transformsRegistry[k],I=c({},L.attributes);return Object.keys(t.componentsRegistry).forEach(function(R){var V=t.componentsRegistry[R];V.schema&&V.schema.transforms&&V.schema.transforms[k]&&Object.keys(V.schema.transforms[k]).forEach(function(O){b(I,V.schema.transforms[k][O],O)})}),{attributes:E(I)}}(C)}),{defs:{valObjects:m,metaKeys:y.concat(["description","role","editType","impliedEdits"]),editType:{traces:s.traces,layout:s.layout},impliedEdits:{}},traces:_,layout:w(),transforms:S,frames:A(),animation:E(o),config:E(r)}},q.crawl=function(_,S,C,k){var L=C||0;k=k||"",Object.keys(_).forEach(function(I){var R=_[I];if(y.indexOf(I)===-1){var V=(k?k+".":"")+I;S(R,I,_,L,V),q.isValObject(R)||f(R)&&I!=="impliedEdits"&&q.crawl(R,S,L+1,V)}})},q.isValObject=function(_){return _&&_.valType!==void 0},q.findArrayAttributes=function(_){var S,C,k=[],L=[],I=[];function R(B,N,F,H){L=L.slice(0,H).concat([N]),I=I.slice(0,H).concat([B&&B._isLinkedToArray]),B&&(B.valType==="data_array"||B.arrayOk===!0)&&!(L[H-1]==="colorbar"&&(N==="ticktext"||N==="tickvals"))&&function j(G,W,Q){var $=G[L[W]],ee=Q+L[W];if(W===L.length-1)g($)&&k.push(C+ee);else if(I[W]){if(Array.isArray($))for(var ie=0;ie<$.length;ie++)f($[ie])&&j($[ie],W+1,ee+"["+ie+"].")}else f($)&&j($,W+1,ee+".")}(S,0,"")}S=_,C="",q.crawl(p,R),_._module&&_._module.attributes&&q.crawl(_._module.attributes,R);var V=_.transforms;if(V)for(var O=0;O<V.length;O++){var J=V[O],D=J._module;D&&(C="transforms["+O+"].",S=J,q.crawl(D.attributes,R))}return k},q.getTraceValObject=function(_,S){var C,k,L=S[0],I=1;if(L==="transforms"){if(S.length===1)return p.transforms;var R=_.transforms;if(!Array.isArray(R)||!R.length)return!1;var V=S[1];if(!T(V)||V>=R.length)return!1;k=(C=(t.transformsRegistry[R[V].type]||{}).attributes)&&C[S[2]],I=3}else if(_.type==="area")k=i[L];else{var O=_._module;if(O||(O=(t.modules[_.type||p.type.dflt]||{})._module),!O)return!1;if(!(k=(C=O.attributes)&&C[L])){var J=O.basePlotModule;J&&J.attributes&&(k=J.attributes[L])}k||(k=p[L])}return v(k,S,I)},q.getLayoutValObject=function(_,S){return v(function(C,k){var L,I,R,V,O=C._basePlotModules;if(O){var J;for(L=0;L<O.length;L++){if((R=O[L]).attrRegex&&R.attrRegex.test(k)){if(R.layoutAttrOverrides)return R.layoutAttrOverrides;!J&&R.layoutAttributes&&(J=R.layoutAttributes)}var D=R.baseLayoutAttrOverrides;if(D&&k in D)return D[k]}if(J)return J}var B=C._modules;if(B){for(L=0;L<B.length;L++)if((V=B[L].layoutAttributes)&&k in V)return V[k]}for(I in t.componentsRegistry){if((R=t.componentsRegistry[I]).name==="colorscale"&&k.indexOf("coloraxis")===0)return R.layoutAttributes[k];if(!R.schema&&k===R.name)return R.layoutAttributes}return k in l?l[k]:k==="radialaxis"||k==="angularaxis"?u[k]:u.layout[k]||!1}(_,S[0]),S,1)}},{"../lib":778,"../plots/animation_attributes":822,"../plots/attributes":824,"../plots/frame_attributes":857,"../plots/layout_attributes":882,"../plots/polar/legacy/area_attributes":897,"../plots/polar/legacy/axis_attributes":898,"../registry":911,"./edit_types":810,"./plot_config":815}],817:[function(n,z,q){"use strict";var t=n("../lib"),h=n("../plots/attributes"),p={name:{valType:"string",editType:"none"}};function l(o){return o&&typeof o=="string"}function e(o){var r=o.length-1;return o.charAt(r)!=="s"&&t.warn("bad argument to arrayDefaultKey: "+o),o.substr(0,o.length-1)+"defaults"}p.templateitemname={valType:"string",editType:"calc"},q.templatedArray=function(o,r){return r._isLinkedToArray=o,r.name=p.name,r.templateitemname=p.templateitemname,r},q.traceTemplater=function(o){var r,i,u={};for(r in o)i=o[r],Array.isArray(i)&&i.length&&(u[r]=0);return{newTrace:function(s){var a={type:r=t.coerce(s,{},h,"type"),_template:null};if(r in u){i=o[r];var c=u[r]%i.length;u[r]++,a._template=i[c]}return a}}},q.newContainer=function(o,r,i){var u=o._template,s=u&&(u[r]||i&&u[i]);return t.isPlainObject(s)||(s=null),o[r]={_template:s}},q.arrayTemplater=function(o,r,i){var u=o._template,s=u&&u[e(r)],a=u&&u[r];Array.isArray(a)&&a.length||(a=[]);var c={};return{newItem:function(f){var g={name:f.name,_input:f},d=g.templateitemname=f.templateitemname;if(!l(d))return g._template=s,g;for(var m=0;m<a.length;m++){var y=a[m];if(y.name===d)return c[d]=1,g._template=y,g}return g[i]=f[i]||!1,g._template=!1,g},defaultItems:function(){for(var f=[],g=0;g<a.length;g++){var d=a[g],m=d.name;if(l(m)&&!c[m]){var y={_template:d,name:m,_input:{_templateitemname:m}};y.templateitemname=d.templateitemname,f.push(y),c[m]=1}}return f}}},q.arrayDefaultKey=e,q.arrayEditor=function(o,r,i){var u=(t.nestedProperty(o,r).get()||[]).length,s=i._index,a=s>=u&&(i._input||{})._templateitemname;a&&(s=u);var c,f=r+"["+s+"]";function g(){c={},a&&(c[f]={},c[f].templateitemname=a)}function d(y,v){a?t.nestedProperty(c[f],y).set(v):c[f+"."+y]=v}function m(){var y=c;return g(),y}return g(),{modifyBase:function(y,v){c[y]=v},modifyItem:d,getUpdateObj:m,applyUpdate:function(y,v){y&&d(y,v);var T=m();for(var w in T)t.nestedProperty(o,w).set(T[w])}}}},{"../lib":778,"../plots/attributes":824}],818:[function(n,z,q){"use strict";var t=n("d3"),h=n("../registry"),p=n("../plots/plots"),l=n("../lib"),e=n("../lib/clear_gl_canvases"),o=n("../components/color"),r=n("../components/drawing"),i=n("../components/titles"),u=n("../components/modebar"),s=n("../plots/cartesian/axes"),a=n("../constants/alignment"),c=n("../plots/cartesian/constraints"),f=c.enforce,g=c.clean,d=n("../plots/cartesian/autorange").doAutoRange;function m(M,b,_){for(var S=0;S<_.length;S++){var C=_[S][0],k=_[S][1];if(!(C[0]>=M[1]||C[1]<=M[0])&&k[0]<b[1]&&k[1]>b[0])return!0}return!1}function y(M){var b,_,S,C,k,L,I=M._fullLayout,R=I._size,V=R.p,O=s.list(M,"",!0);if(I._paperdiv.style({width:M._context.responsive&&I.autosize&&!M._context._hasZeroWidth&&!M.layout.width?"100%":I.width+"px",height:M._context.responsive&&I.autosize&&!M._context._hasZeroHeight&&!M.layout.height?"100%":I.height+"px"}).selectAll(".main-svg").call(r.setSize,I.width,I.height),M._context.setBackground(M,I.paper_bgcolor),q.drawMainTitle(M),u.manage(M),!I._has("cartesian"))return p.previousPromises(M);function J($e,rt,at){var lt=$e._lw/2;return $e._id.charAt(0)==="x"?rt?at==="top"?rt._offset-V-lt:rt._offset+rt._length+V+lt:R.t+R.h*(1-($e.position||0))+lt%1:rt?at==="right"?rt._offset+rt._length+V+lt:rt._offset-V-lt:R.l+R.w*($e.position||0)+lt%1}for(b=0;b<O.length;b++){var D=(C=O[b])._anchorAxis;C._linepositions={},C._lw=r.crispRound(M,C.linewidth,1),C._mainLinePosition=J(C,D,C.side),C._mainMirrorPosition=C.mirror&&D?J(C,D,a.OPPOSITE_SIDE[C.side]):null}var B=[],N=[],F=[],H=o.opacity(I.paper_bgcolor)===1&&o.opacity(I.plot_bgcolor)===1&&I.paper_bgcolor===I.plot_bgcolor;for(_ in I._plots)if((S=I._plots[_]).mainplot)S.bg&&S.bg.remove(),S.bg=void 0;else{var j=S.xaxis.domain,G=S.yaxis.domain,W=S.plotgroup;if(m(j,G,F)){var Q=W.node(),$=S.bg=l.ensureSingle(W,"rect","bg");Q.insertBefore($.node(),Q.childNodes[0]),N.push(_)}else W.select("rect.bg").remove(),F.push([j,G]),H||(B.push(_),N.push(_))}var ee,ie,ae,oe,de,le,fe,ue,we,Ae,Se,ke,Me,ve=I._bgLayer.selectAll(".bg").data(B);for(ve.enter().append("rect").classed("bg",!0),ve.exit().remove(),ve.each(function($e){I._plots[$e].bg=t.select(this)}),b=0;b<N.length;b++)S=I._plots[N[b]],k=S.xaxis,L=S.yaxis,S.bg&&k._offset!==void 0&&L._offset!==void 0&&S.bg.call(r.setRect,k._offset-V,L._offset-V,k._length+2*V,L._length+2*V).call(o.fill,I.plot_bgcolor).style("stroke-width",0);if(!I._hasOnlyLargeSploms)for(_ in I._plots){S=I._plots[_],k=S.xaxis,L=S.yaxis;var ge,De,_e=S.clipId="clip"+I._uid+_+"plot",Pe=l.ensureSingleById(I._clips,"clipPath",_e,function($e){$e.classed("plotclip",!0).append("rect")});S.clipRect=Pe.select("rect").attr({width:k._length,height:L._length}),r.setTranslate(S.plot,k._offset,L._offset),S._hasClipOnAxisFalse?(ge=null,De=_e):(ge=_e,De=null),r.setClipUrl(S.plot,ge,M),S.layerClipId=De}function Fe($e){return"M"+ee+","+$e+"H"+ie}function ze($e){return"M"+k._offset+","+$e+"h"+k._length}function He($e){return"M"+$e+","+ue+"V"+fe}function et($e){return"M"+$e+","+L._offset+"v"+L._length}function Re($e,rt,at){if(!$e.showline||_!==$e._mainSubplot)return"";if(!$e._anchorAxis)return at($e._mainLinePosition);var lt=rt($e._mainLinePosition);return $e.mirror&&(lt+=rt($e._mainMirrorPosition)),lt}for(_ in I._plots){S=I._plots[_],k=S.xaxis,L=S.yaxis;var Ze="M0,0";v(k,_)&&(de=w(k,"left",L,O),ee=k._offset-(de?V+de:0),le=w(k,"right",L,O),ie=k._offset+k._length+(le?V+le:0),ae=J(k,L,"bottom"),oe=J(k,L,"top"),!(Me=!k._anchorAxis||_!==k._mainSubplot)||k.mirror!=="allticks"&&k.mirror!=="all"||(k._linepositions[_]=[ae,oe]),Ze=Re(k,Fe,ze),Me&&k.showline&&(k.mirror==="all"||k.mirror==="allticks")&&(Ze+=Fe(ae)+Fe(oe)),S.xlines.style("stroke-width",k._lw+"px").call(o.stroke,k.showline?k.linecolor:"rgba(0,0,0,0)")),S.xlines.attr("d",Ze);var Ke="M0,0";v(L,_)&&(Se=w(L,"bottom",k,O),fe=L._offset+L._length+(Se?V:0),ke=w(L,"top",k,O),ue=L._offset-(ke?V:0),we=J(L,k,"left"),Ae=J(L,k,"right"),!(Me=!L._anchorAxis||_!==L._mainSubplot)||L.mirror!=="allticks"&&L.mirror!=="all"||(L._linepositions[_]=[we,Ae]),Ke=Re(L,He,et),Me&&L.showline&&(L.mirror==="all"||L.mirror==="allticks")&&(Ke+=He(we)+He(Ae)),S.ylines.style("stroke-width",L._lw+"px").call(o.stroke,L.showline?L.linecolor:"rgba(0,0,0,0)")),S.ylines.attr("d",Ke)}return s.makeClipPaths(M),p.previousPromises(M)}function v(M,b){return(M.ticks||M.showline)&&(b===M._mainSubplot||M.mirror==="all"||M.mirror==="allticks")}function T(M,b,_){if(!_.showline||!_._lw)return!1;if(_.mirror==="all"||_.mirror==="allticks")return!0;var S=_._anchorAxis;if(!S)return!1;var C=a.FROM_BL[b];return _.side===b?S.domain[C]===M.domain[C]:_.mirror&&S.domain[1-C]===M.domain[1-C]}function w(M,b,_,S){if(T(M,b,_))return _._lw;for(var C=0;C<S.length;C++){var k=S[C];if(k._mainAxis===_._mainAxis&&T(M,b,k))return k._lw}return 0}function A(M,b){var _=M.title,S=M._size,C=0;switch(b==="start"?C=_.pad.l:b==="end"&&(C=-_.pad.r),_.xref){case"paper":return S.l+S.w*_.x+C;case"container":default:return M.width*_.x+C}}function E(M,b){var _=M.title,S=M._size,C=0;if(b!=="0em"&&b?b===a.CAP_SHIFT+"em"&&(C=_.pad.t):C=-_.pad.b,_.y==="auto")return S.t/2;switch(_.yref){case"paper":return S.t+S.h-S.h*_.y+C;case"container":default:return M.height-M.height*_.y+C}}q.layoutStyles=function(M){return l.syncOrAsync([p.doAutoMargin,y],M)},q.drawMainTitle=function(M){var b=M._fullLayout,_=function(C){var k=C.title,L="middle";return l.isRightAnchor(k)?L="end":l.isLeftAnchor(k)&&(L="start"),L}(b),S=function(C){var k=C.title,L="0em";return l.isTopAnchor(k)?L=a.CAP_SHIFT+"em":l.isMiddleAnchor(k)&&(L=a.MID_SHIFT+"em"),L}(b);i.draw(M,"gtitle",{propContainer:b,propName:"title.text",placeholder:b._dfltTitle.plot,attributes:{x:A(b,_),y:E(b,S),"text-anchor":_,dy:S}})},q.doTraceStyle=function(M){var b,_=M.calcdata,S=[];for(b=0;b<_.length;b++){var C=_[b],k=C[0]||{},L=k.trace||{},I=L._module||{},R=I.arraysToCalcdata;R&&R(C,L);var V=I.editStyle;V&&S.push({fn:V,cd0:k})}if(S.length){for(b=0;b<S.length;b++){var O=S[b];O.fn(M,O.cd0)}e(M),q.redrawReglTraces(M)}return p.style(M),h.getComponentMethod("legend","draw")(M),p.previousPromises(M)},q.doColorBars=function(M){return h.getComponentMethod("colorbar","draw")(M),p.previousPromises(M)},q.layoutReplot=function(M){var b=M.layout;return M.layout=void 0,h.call("plot",M,"",b)},q.doLegend=function(M){return h.getComponentMethod("legend","draw")(M),p.previousPromises(M)},q.doTicksRelayout=function(M){return s.draw(M,"redraw"),M._fullLayout._hasOnlyLargeSploms&&(h.subplotsRegistry.splom.updateGrid(M),e(M),q.redrawReglTraces(M)),q.drawMainTitle(M),p.previousPromises(M)},q.doModeBar=function(M){var b=M._fullLayout;u.manage(M);for(var _=0;_<b._basePlotModules.length;_++){var S=b._basePlotModules[_].updateFx;S&&S(M)}return p.previousPromises(M)},q.doCamera=function(M){for(var b=M._fullLayout,_=b._subplots.gl3d,S=0;S<_.length;S++){var C=b[_[S]];C._scene.setViewport(C)}},q.drawData=function(M){var b=M._fullLayout;e(M);for(var _=b._basePlotModules,S=0;S<_.length;S++)_[S].plot(M);return q.redrawReglTraces(M),p.style(M),h.getComponentMethod("shapes","draw")(M),h.getComponentMethod("annotations","draw")(M),h.getComponentMethod("images","draw")(M),b._replotting=!1,p.previousPromises(M)},q.redrawReglTraces=function(M){var b=M._fullLayout;if(b._has("regl")){var _,S,C=M._fullData,k=[],L=[];for(b._hasOnlyLargeSploms&&b._splomGrid.draw(),_=0;_<C.length;_++){var I=C[_];I.visible===!0&&I._length!==0&&(I.type==="splom"?b._splomScenes[I.uid].draw():I.type==="scattergl"?l.pushUnique(k,I.xaxis+I.yaxis):I.type==="scatterpolargl"&&l.pushUnique(L,I.subplot))}for(_=0;_<k.length;_++)(S=b._plots[k[_]])._scene&&S._scene.draw();for(_=0;_<L.length;_++)(S=b[L[_]]._subplot)._scene&&S._scene.draw()}},q.doAutoRangeAndConstraints=function(M){for(var b,_=s.list(M,"",!0),S={},C=0;C<_.length;C++)if(!S[(b=_[C])._id]){S[b._id]=1,g(M,b),d(M,b);var k=b._matchGroup;if(k)for(var L in k){var I=s.getFromId(M,L);d(M,I,b.range),S[L]=1}}f(M)},q.finalDraw=function(M){h.getComponentMethod("rangeslider","draw")(M),h.getComponentMethod("rangeselector","draw")(M)},q.drawMarginPushers=function(M){h.getComponentMethod("legend","draw")(M),h.getComponentMethod("rangeselector","draw")(M),h.getComponentMethod("sliders","draw")(M),h.getComponentMethod("updatemenus","draw")(M),h.getComponentMethod("colorbar","draw")(M)}},{"../components/color":643,"../components/drawing":665,"../components/modebar":703,"../components/titles":738,"../constants/alignment":745,"../lib":778,"../lib/clear_gl_canvases":762,"../plots/cartesian/autorange":827,"../plots/cartesian/axes":828,"../plots/cartesian/constraints":835,"../plots/plots":891,"../registry":911,d3:169}],819:[function(n,z,q){"use strict";var t=n("../lib"),h=t.isPlainObject,p=n("./plot_schema"),l=n("../plots/plots"),e=n("../plots/attributes"),o=n("./plot_template"),r=n("./plot_config").dfltConfig;function i(m,y){m=t.extendDeep({},m);var v,T,w=Object.keys(m).sort();function A(S,C,k){if(h(C)&&h(S))i(S,C);else if(Array.isArray(C)&&Array.isArray(S)){var L=o.arrayTemplater({_template:m},k);for(T=0;T<C.length;T++){var I=C[T],R=L.newItem(I)._template;R&&i(R,I)}var V=L.defaultItems();for(T=0;T<V.length;T++)C.push(V[T]._template);for(T=0;T<C.length;T++)delete C[T].templateitemname}}for(v=0;v<w.length;v++){var E=w[v],M=m[E];if(E in y?A(M,y[E],E):y[E]=M,u(E)===E)for(var b in y){var _=u(b);b===_||_!==E||b in m||A(M,y[b],E)}}}function u(m){return m.replace(/[0-9]+$/,"")}function s(m,y,v,T,w){var A=w&&v(w);for(var E in m){var M=m[E],b=f(m,E,T),_=f(m,E,w),S=v(_);if(!S){var C=u(E);C!==E&&(S=v(_=f(m,C,w)))}if((!A||A!==S)&&!(!S||S._noTemplating||S.valType==="data_array"||S.arrayOk&&Array.isArray(M)))if(!S.valType&&h(M))s(M,y,v,b,_);else if(S._isLinkedToArray&&Array.isArray(M))for(var k=!1,L=0,I={},R=0;R<M.length;R++){var V=M[R];if(h(V)){var O=V.name;if(O)I[O]||(s(V,y,v,f(M,L,b),f(M,L,_)),L++,I[O]=1);else if(!k){var J=f(m,o.arrayDefaultKey(E),T),D=f(M,L,b);s(V,y,v,D,f(M,L,_));var B=t.nestedProperty(y,D);t.nestedProperty(y,J).set(B.get()),B.set(null),k=!0}}}else t.nestedProperty(y,b).set(M)}}function a(m,y){return p.getLayoutValObject(m,t.nestedProperty({},y).parts)}function c(m,y){return p.getTraceValObject(m,t.nestedProperty({},y).parts)}function f(m,y,v){return v?Array.isArray(m)?v+"["+y+"]":v+"."+y:y}function g(m){for(var y=0;y<m.length;y++)if(h(m[y]))return!0}function d(m){var y;switch(m.code){case"data":y="The template has no key data.";break;case"layout":y="The template has no key layout.";break;case"missing":y=m.path?"There are no templates for item "+m.path+" with name "+m.templateitemname:"There are no templates for trace "+m.index+", of type "+m.traceType+".";break;case"unused":y=m.path?"The template item at "+m.path+" was not used in constructing the plot.":m.dataCount?"Some of the templates of type "+m.traceType+" were not used. The template has "+m.templateCount+" traces, the data only has "+m.dataCount+" of this type.":"The template has "+m.templateCount+" traces of type "+m.traceType+" but there are none in the data.";break;case"reused":y="Some of the templates of type "+m.traceType+" were used more than once. The template has "+m.templateCount+" traces, the data has "+m.dataCount+" of this type."}return m.msg=y,m}q.makeTemplate=function(m){m=t.isPlainObject(m)?m:t.getGraphDiv(m),m=t.extendDeep({_context:r},{data:m.data,layout:m.layout}),l.supplyDefaults(m);var y=m.data||[],v=m.layout||{};v._basePlotModules=m._fullLayout._basePlotModules,v._modules=m._fullLayout._modules;var T={data:{},layout:{}};y.forEach(function(L){var I={};s(L,I,c.bind(null,L));var R=t.coerce(L,{},e,"type"),V=T.data[R];V||(V=T.data[R]=[]),V.push(I)}),s(v,T.layout,a.bind(null,v)),delete T.layout.template;var w=v.template;if(h(w)){var A,E,M,b,_,S,C=w.layout;h(C)&&i(C,T.layout);var k=w.data;if(h(k)){for(E in T.data)if(M=k[E],Array.isArray(M)){for(S=(_=T.data[E]).length,b=M.length,A=0;A<S;A++)i(M[A%b],_[A]);for(A=S;A<b;A++)_.push(t.extendDeep({},M[A]))}for(E in k)E in T.data||(T.data[E]=t.extendDeep([],k[E]))}}return T},q.validateTemplate=function(m,y){var v=t.extendDeep({},{_context:r,data:m.data,layout:m.layout}),T=v.layout||{};h(y)||(y=T.template||{});var w=y.layout,A=y.data,E=[];v.layout=T,v.layout.template=y,l.supplyDefaults(v);var M=v._fullLayout,b=v._fullData,_={};if(h(w)?(function V(O,J){for(var D in O)if(D.charAt(0)!=="_"&&h(O[D])){var B,N=u(D),F=[];for(B=0;B<J.length;B++)F.push(f(O,D,J[B])),N!==D&&F.push(f(O,N,J[B]));for(B=0;B<F.length;B++)_[F[B]]=1;V(O[D],F)}}(M,["layout"]),function V(O,J){for(var D in O)if(D.indexOf("defaults")===-1&&h(O[D])){var B=f(O,D,J);_[B]?V(O[D],B):E.push({code:"unused",path:B})}}(w,"layout")):E.push({code:"layout"}),h(A)){for(var S,C={},k=0;k<b.length;k++){var L=b[k];C[S=L.type]=(C[S]||0)+1,L._fullInput._template||E.push({code:"missing",index:L._fullInput.index,traceType:S})}for(S in A){var I=A[S].length,R=C[S]||0;I>R?E.push({code:"unused",traceType:S,templateCount:I,dataCount:R}):R>I&&E.push({code:"reused",traceType:S,templateCount:I,dataCount:R})}}else E.push({code:"data"});if(function V(O,J){for(var D in O)if(D.charAt(0)!=="_"){var B=O[D],N=f(O,D,J);h(B)?(Array.isArray(O)&&B._template===!1&&B.templateitemname&&E.push({code:"missing",path:N,templateitemname:B.templateitemname}),V(B,N)):Array.isArray(B)&&g(B)&&V(B,N)}}({data:b,layout:M},""),E.length)return E.map(d)}},{"../lib":778,"../plots/attributes":824,"../plots/plots":891,"./plot_config":815,"./plot_schema":816,"./plot_template":817}],820:[function(n,z,q){"use strict";var t=n("fast-isnumeric"),h=n("./plot_api"),p=n("../plots/plots"),l=n("../lib"),e=n("../snapshot/helpers"),o=n("../snapshot/tosvg"),r=n("../snapshot/svgtoimg"),i=n("../version").version,u={format:{valType:"enumerated",values:["png","jpeg","webp","svg","full-json"],dflt:"png"},width:{valType:"number",min:1},height:{valType:"number",min:1},scale:{valType:"number",min:0,dflt:1},setBackground:{valType:"any",dflt:!1},imageDataOnly:{valType:"boolean",dflt:!1}};z.exports=function(s,a){var c,f,g,d;function m(R){return!(R in a)||l.validate(a[R],u[R])}if(a=a||{},l.isPlainObject(s)?(c=s.data||[],f=s.layout||{},g=s.config||{},d={}):(s=l.getGraphDiv(s),c=l.extendDeep([],s.data),f=l.extendDeep({},s.layout),g=s._context,d=s._fullLayout||{}),!m("width")&&a.width!==null||!m("height")&&a.height!==null)throw new Error("Height and width should be pixel values.");if(!m("format"))throw new Error("Export format is not "+l.join2(u.format.values,", "," or ")+".");var y={};function v(R,V){return l.coerce(a,y,u,R,V)}var T=v("format"),w=v("width"),A=v("height"),E=v("scale"),M=v("setBackground"),b=v("imageDataOnly"),_=document.createElement("div");_.style.position="absolute",_.style.left="-5000px",document.body.appendChild(_);var S=l.extendFlat({},f);w?S.width=w:a.width===null&&t(d.width)&&(S.width=d.width),A?S.height=A:a.height===null&&t(d.height)&&(S.height=d.height);var C=l.extendFlat({},g,{_exportedPlot:!0,staticPlot:!0,setBackground:M}),k=e.getRedrawFunc(_);function L(){return new Promise(function(R){setTimeout(R,e.getDelay(_._fullLayout))})}function I(){return new Promise(function(R,V){var O=o(_,T,E),J=_._fullLayout.width,D=_._fullLayout.height;function B(){h.purge(_),document.body.removeChild(_)}if(T==="full-json"){var N=p.graphJson(_,!1,"keepdata","object",!0,!0);return N.version=i,N=JSON.stringify(N),B(),R(b?N:e.encodeJSON(N))}if(B(),T==="svg")return R(b?O:e.encodeSVG(O));var F=document.createElement("canvas");F.id=l.randstr(),r({format:T,width:J,height:D,scale:E,canvas:F,svg:O,promise:!0}).then(R).catch(V)})}return new Promise(function(R,V){h.plot(_,c,S,C).then(k).then(L).then(I).then(function(O){R(function(J){return b?J.replace(e.IMAGE_URL_PREFIX,""):J}(O))}).catch(function(O){V(O)})})}},{"../lib":778,"../plots/plots":891,"../snapshot/helpers":915,"../snapshot/svgtoimg":917,"../snapshot/tosvg":919,"../version":1370,"./plot_api":814,"fast-isnumeric":241}],821:[function(n,z,q){"use strict";var t=n("../lib"),h=n("../plots/plots"),p=n("./plot_schema"),l=n("./plot_config").dfltConfig,e=t.isPlainObject,o=Array.isArray,r=t.isArrayOrTypedArray;function i(y,v,T,w,A,E){E=E||[];for(var M=Object.keys(y),b=0;b<M.length;b++){var _=M[b];if(_!=="transforms"){var S=E.slice();S.push(_);var C=y[_],k=v[_],L=g(T,_),I=(L||{}).valType,R=I==="info_array",V=I==="colorscale",O=(L||{}).items;if(f(T,_))if(e(C)&&e(k)&&I!=="any")i(C,k,L,w,A,S);else if(R&&o(C)){C.length>k.length&&w.push(c("unused",A,S.concat(k.length)));var J,D,B,N,F,H=k.length,j=Array.isArray(O);if(j&&(H=Math.min(H,O.length)),L.dimensions===2)for(D=0;D<H;D++)if(o(C[D])){C[D].length>k[D].length&&w.push(c("unused",A,S.concat(D,k[D].length)));var G=k[D].length;for(J=0;J<(j?Math.min(G,O[D].length):G);J++)B=j?O[D][J]:O,N=C[D][J],F=k[D][J],t.validate(N,B)?F!==N&&F!==+N&&w.push(c("dynamic",A,S.concat(D,J),N,F)):w.push(c("value",A,S.concat(D,J),N))}else w.push(c("array",A,S.concat(D),C[D]));else for(D=0;D<H;D++)B=j?O[D]:O,N=C[D],F=k[D],t.validate(N,B)?F!==N&&F!==+N&&w.push(c("dynamic",A,S.concat(D),N,F)):w.push(c("value",A,S.concat(D),N))}else if(L.items&&!R&&o(C)){var W,Q,$=O[Object.keys(O)[0]],ee=[];for(W=0;W<k.length;W++){var ie=k[W]._index||W;if((Q=S.slice()).push(ie),e(C[ie])&&e(k[W])){ee.push(ie);var ae=C[ie],oe=k[W];e(ae)&&ae.visible!==!1&&oe.visible===!1?w.push(c("invisible",A,Q)):i(ae,oe,$,w,A,Q)}}for(W=0;W<C.length;W++)(Q=S.slice()).push(W),e(C[W])?ee.indexOf(W)===-1&&w.push(c("unused",A,Q)):w.push(c("object",A,Q,C[W]))}else!e(C)&&e(k)?w.push(c("object",A,S,C)):r(C)||!r(k)||R||V?_ in v?t.validate(C,L)?L.valType==="enumerated"&&(L.coerceNumber&&C!==+k||C!==k)&&w.push(c("dynamic",A,S,C,k)):w.push(c("value",A,S,C)):w.push(c("unused",A,S,C)):w.push(c("array",A,S,C));else w.push(c("schema",A,S))}}return w}function u(y,v){for(var T=y.layout.layoutAttributes,w=0;w<v.length;w++){var A=v[w],E=y.traces[A.type],M=E.layoutAttributes;M&&(A.subplot?t.extendFlat(T[E.attributes.subplot.dflt],M):t.extendFlat(T,M))}return T}z.exports=function(y,v){y===void 0&&(y=[]),v===void 0&&(v={});var T,w,A=p.get(),E=[],M={_context:t.extendFlat({},l)};o(y)?(M.data=t.extendDeep([],y),T=y):(M.data=[],T=[],E.push(c("array","data"))),e(v)?(M.layout=t.extendDeep({},v),w=v):(M.layout={},w={},arguments.length>1&&E.push(c("object","layout"))),h.supplyDefaults(M);for(var b=M._fullData,_=T.length,S=0;S<_;S++){var C=T[S],k=["data",S];if(e(C)){var L=b[S],I=L.type,R=A.traces[I].attributes;R.type={valType:"enumerated",values:[I]},L.visible===!1&&C.visible!==!1&&E.push(c("invisible",k)),i(C,L,R,E,k);var V=C.transforms,O=L.transforms;if(V){o(V)||E.push(c("array",k,["transforms"])),k.push("transforms");for(var J=0;J<V.length;J++){var D=["transforms",J],B=V[J].type;if(e(V[J])){var N=A.transforms[B]?A.transforms[B].attributes:{};N.type={valType:"enumerated",values:Object.keys(A.transforms)},i(V[J],O[J],N,E,k,D)}else E.push(c("object",k,D))}}}else E.push(c("object",k))}var F=M._fullLayout,H=u(A,b);return i(w,F,H,E,"layout"),E.length===0?void 0:E};var s={object:function(y,v){return(y==="layout"&&v===""?"The layout argument":y[0]==="data"&&v===""?"Trace "+y[1]+" in the data argument":a(y)+"key "+v)+" must be linked to an object container"},array:function(y,v){return(y==="data"?"The data argument":a(y)+"key "+v)+" must be linked to an array container"},schema:function(y,v){return a(y)+"key "+v+" is not part of the schema"},unused:function(y,v,T){var w=e(T)?"container":"key";return a(y)+w+" "+v+" did not get coerced"},dynamic:function(y,v,T,w){return[a(y)+"key",v,"(set to '"+T+"')","got reset to","'"+w+"'","during defaults."].join(" ")},invisible:function(y,v){return(v?a(y)+"item "+v:"Trace "+y[1])+" got defaulted to be not visible"},value:function(y,v,T){return[a(y)+"key "+v,"is set to an invalid value ("+T+")"].join(" ")}};function a(y){return o(y)?"In data trace "+y[1]+", ":"In "+y+", "}function c(y,v,T,w,A){var E,M;T=T||"",o(v)?(E=v[0],M=v[1]):(E=v,M=null);var b=function(S){if(!o(S))return String(S);for(var C="",k=0;k<S.length;k++){var L=S[k];typeof L=="number"?C=C.substr(0,C.length-1)+"["+L+"]":C+=L,k<S.length-1&&(C+=".")}return C}(T),_=s[y](v,b,w,A);return t.log(_),{code:y,container:E,trace:M,path:T,astr:b,msg:_}}function f(y,v){var T=m(v),w=T.keyMinusId,A=T.id;return!!(w in y&&y[w]._isSubplotObj&&A)||v in y}function g(y,v){return v in y?y[v]:y[m(v).keyMinusId]}var d=t.counterRegex("([a-z]+)");function m(y){var v=y.match(d);return{keyMinusId:v&&v[1],id:v&&v[2]}}},{"../lib":778,"../plots/plots":891,"./plot_config":815,"./plot_schema":816}],822:[function(n,z,q){"use strict";z.exports={mode:{valType:"enumerated",dflt:"afterall",values:["immediate","next","afterall"]},direction:{valType:"enumerated",values:["forward","reverse"],dflt:"forward"},fromcurrent:{valType:"boolean",dflt:!1},frame:{duration:{valType:"number",min:0,dflt:500},redraw:{valType:"boolean",dflt:!0}},transition:{duration:{valType:"number",min:0,dflt:500,editType:"none"},easing:{valType:"enumerated",dflt:"cubic-in-out",values:["linear","quad","cubic","sin","exp","circle","elastic","back","bounce","linear-in","quad-in","cubic-in","sin-in","exp-in","circle-in","elastic-in","back-in","bounce-in","linear-out","quad-out","cubic-out","sin-out","exp-out","circle-out","elastic-out","back-out","bounce-out","linear-in-out","quad-in-out","cubic-in-out","sin-in-out","exp-in-out","circle-in-out","elastic-in-out","back-in-out","bounce-in-out"],editType:"none"},ordering:{valType:"enumerated",values:["layout first","traces first"],dflt:"layout first",editType:"none"}}}},{}],823:[function(n,z,q){"use strict";var t=n("../lib"),h=n("../plot_api/plot_template");z.exports=function(p,l,e){var o,r,i=e.name,u=e.inclusionAttr||"visible",s=l[i],a=t.isArrayOrTypedArray(p[i])?p[i]:[],c=l[i]=[],f=h.arrayTemplater(l,i,u);for(o=0;o<a.length;o++){var g=a[o];t.isPlainObject(g)?r=f.newItem(g):(r=f.newItem({}))[u]=!1,r._index=o,r[u]!==!1&&e.handleItemDefaults(g,r,l,e),c.push(r)}var d=f.defaultItems();for(o=0;o<d.length;o++)(r=d[o])._index=c.length,e.handleItemDefaults({},r,l,e,{}),c.push(r);if(t.isArrayOrTypedArray(s)){var m=Math.min(s.length,c.length);for(o=0;o<m;o++)t.relinkPrivateKeys(c[o],s[o])}return c}},{"../lib":778,"../plot_api/plot_template":817}],824:[function(n,z,q){"use strict";var t=n("../components/fx/attributes");z.exports={type:{valType:"enumerated",values:[],dflt:"scatter",editType:"calc+clearAxisTypes",_noTemplating:!0},visible:{valType:"enumerated",values:[!0,!1,"legendonly"],dflt:!0,editType:"calc"},showlegend:{valType:"boolean",dflt:!0,editType:"style"},legendgroup:{valType:"string",dflt:"",editType:"style"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"style"},name:{valType:"string",editType:"style"},uid:{valType:"string",editType:"plot",anim:!0},ids:{valType:"data_array",editType:"calc",anim:!0},customdata:{valType:"data_array",editType:"calc"},meta:{valType:"any",arrayOk:!0,editType:"plot"},selectedpoints:{valType:"any",editType:"calc"},hoverinfo:{valType:"flaglist",flags:["x","y","z","text","name"],extras:["all","none","skip"],arrayOk:!0,dflt:"all",editType:"none"},hoverlabel:t.hoverlabel,stream:{token:{valType:"string",noBlank:!0,strict:!0,editType:"calc"},maxpoints:{valType:"number",min:0,max:1e4,dflt:500,editType:"calc"},editType:"calc"},transforms:{_isLinkedToArray:"transform",editType:"calc"},uirevision:{valType:"any",editType:"none"}}},{"../components/fx/attributes":674}],825:[function(n,z,q){"use strict";var t=n("fast-isnumeric"),h=n("../../lib"),p=h.dateTime2ms,l=h.incrementMonth,e=n("../../constants/numerical").ONEAVGMONTH;z.exports=function(o,r,i,u){if(r.type!=="date")return u;var s=o[i+"periodalignment"];if(!s)return u;var a,c=o[i+"period"];if(t(c)){if((c=+c)<=0)return u}else if(typeof c=="string"&&c.charAt(0)==="M"){var f=+c.substring(1);if(!(f>0&&Math.round(f)===f))return u;a=f}for(var g=r.calendar,d=s==="start",m=s==="end",y=o[i+"period0"],v=p(y,g)||0,T=[],w=u.length,A=0;A<w;A++){var E,M,b,_=u[A];if(a){for(E=Math.round((_-v)/(a*e)),b=l(v,a*E,g);b>_;)b=l(b,-a,g);for(;b<=_;)b=l(b,a,g);M=l(b,-a,g)}else{for(b=v+(E=Math.round((_-v)/c))*c;b>_;)b-=c;for(;b<=_;)b+=c;M=b-c}T[A]=d?M:m?b:(M+b)/2}return T}},{"../../constants/numerical":753,"../../lib":778,"fast-isnumeric":241}],826:[function(n,z,q){"use strict";z.exports={xaxis:{valType:"subplotid",dflt:"x",editType:"calc+clearAxisTypes"},yaxis:{valType:"subplotid",dflt:"y",editType:"calc+clearAxisTypes"}}},{}],827:[function(n,z,q){"use strict";var t=n("fast-isnumeric"),h=n("../../lib"),p=n("../../constants/numerical").FP_SAFE,l=n("../../registry"),e=n("./axis_ids"),o=e.getFromId,r=e.isLinked;function i(v,T){var w,A,E=[],M=v._fullLayout,b=s(M,T,0),_=s(M,T,1),S=a(v,T),C=S.min,k=S.max;if(C.length===0||k.length===0)return h.simpleMap(T.range,T.r2l);var L=C[0].val,I=k[0].val;for(w=1;w<C.length&&L===I;w++)L=Math.min(L,C[w].val);for(w=1;w<k.length&&L===I;w++)I=Math.max(I,k[w].val);var R=!1;if(T.range){var V=h.simpleMap(T.range,T.r2l);R=V[1]<V[0]}T.autorange==="reversed"&&(R=!0,T.autorange=!0);var O,J,D,B,N,F,H=T.rangemode,j=H==="tozero",G=H==="nonnegative",W=T._length,Q=W/10,$=0;for(w=0;w<C.length;w++)for(O=C[w],A=0;A<k.length;A++)(F=(J=k[A]).val-O.val-u(T,O.val,J.val))>0&&((N=W-b(O)-_(J))>Q?F/N>$&&(D=O,B=J,$=F/N):F/W>$&&(D={val:O.val,nopad:1},B={val:J.val,nopad:1},$=F/W));if(L===I){var ee=L-1,ie=L+1;if(j)if(L===0)E=[0,1];else{var ae=(L>0?k:C).reduce(function(de,le){return Math.max(de,_(le))},0),oe=L/(1-Math.min(.5,ae/W));E=L>0?[0,oe]:[oe,0]}else E=G?[Math.max(0,ee),Math.max(1,ie)]:[ee,ie]}else j?(D.val>=0&&(D={val:0,nopad:1}),B.val<=0&&(B={val:0,nopad:1})):G&&(D.val-$*b(D)<0&&(D={val:0,nopad:1}),B.val<=0&&(B={val:1,nopad:1})),$=(B.val-D.val-u(T,O.val,J.val))/(W-b(D)-_(B)),E=[D.val-$*b(D),B.val+$*_(B)];return R&&E.reverse(),h.simpleMap(E,T.l2r||Number)}function u(v,T,w){var A=0;if(v.rangebreaks)for(var E=v.locateBreaks(T,w),M=0;M<E.length;M++){var b=E[M];A+=b.max-b.min}return A}function s(v,T,w){var A=.05*T._length,E=T._anchorAxis||{};if((T.ticklabelposition||"").indexOf("inside")!==-1||(E.ticklabelposition||"").indexOf("inside")!==-1){var M=T.autorange==="reversed";if(!M){var b=h.simpleMap(T.range,T.r2l);M=b[1]<b[0]}M&&(w=!w)}var _=0;return r(v,T._id)||(_=function(S,C){var k=0,L=S._anchorAxis||{};if((L.ticklabelposition||"").indexOf("inside")!==-1&&(!C&&(L.side==="left"||L.side==="bottom")||C&&(L.side==="top"||L.side==="right"))){var I=S._id.charAt(0)==="x";if(L._vals){var R=h.deg2rad(L._tickAngles[L._id+"tick"]||0),V=Math.abs(Math.cos(R)),O=Math.abs(Math.sin(R));L._vals.forEach(function(J){if(J.bb){var D=6+J.bb.width,B=6+J.bb.height;k=Math.max(k,I?Math.max(D*V,B*O):Math.max(B*V,D*O))}})}L.ticks==="inside"&&L.ticklabelposition==="inside"&&(k+=L.ticklen||0)}return k}(T,w)),A=Math.max(_,A),T.constrain==="domain"&&T._inputDomain&&(A*=(T._inputDomain[1]-T._inputDomain[0])/(T.domain[1]-T.domain[0])),function(S){return S.nopad?0:S.pad+(S.extrapad?A:_)}}z.exports={getAutoRange:i,makePadFn:s,doAutoRange:function(v,T,w){if(T.setScale(),T.autorange){T.range=w?w.slice():i(v,T),T._r=T.range.slice(),T._rl=h.simpleMap(T._r,T.r2l);var A=T._input,E={};E[T._attr+".range"]=T.range,E[T._attr+".autorange"]=T.autorange,l.call("_storeDirectGUIEdit",v.layout,v._fullLayout._preGUI,E),A.range=T.range.slice(),A.autorange=T.autorange}var M=T._anchorAxis;if(M&&M.rangeslider){var b=M.rangeslider[T._name];b&&b.rangemode==="auto"&&(b.range=i(v,T)),M._input.rangeslider[T._name]=h.extendFlat({},b)}},findExtremes:function(v,T,w){w||(w={}),v._m||v.setScale();var A,E,M,b,_,S,C,k,L,I=[],R=[],V=T.length,O=w.padded||!1,J=w.tozero&&(v.type==="linear"||v.type==="-"),D=v.type==="log",B=!1,N=w.vpadLinearized||!1;function F(ie){if(Array.isArray(ie))return B=!0,function(oe){return Math.max(Number(ie[oe]||0),0)};var ae=Math.max(Number(ie||0),0);return function(){return ae}}var H=F((v._m>0?w.ppadplus:w.ppadminus)||w.ppad||0),j=F((v._m>0?w.ppadminus:w.ppadplus)||w.ppad||0),G=F(w.vpadplus||w.vpad),W=F(w.vpadminus||w.vpad);if(!B){if(k=1/0,L=-1/0,D)for(A=0;A<V;A++)(E=T[A])<k&&E>0&&(k=E),E>L&&E<p&&(L=E);else for(A=0;A<V;A++)(E=T[A])<k&&E>-p&&(k=E),E>L&&E<p&&(L=E);T=[k,L],V=2}var Q={tozero:J,extrapad:O};function $(ie){M=T[ie],t(M)&&(S=H(ie),C=j(ie),N?(b=v.c2l(M)-W(ie),_=v.c2l(M)+G(ie)):(k=M-W(ie),L=M+G(ie),D&&k<L/10&&(k=L/10),b=v.c2l(k),_=v.c2l(L)),J&&(b=Math.min(0,b),_=Math.max(0,_)),d(b)&&c(I,b,C,Q),d(_)&&f(R,_,S,Q))}var ee=Math.min(6,V);for(A=0;A<ee;A++)$(A);for(A=V-1;A>=ee;A--)$(A);return{min:I,max:R,opts:w}},concatExtremes:a};function a(v,T,w){var A,E,M,b=T._id,_=v._fullData,S=v._fullLayout,C=[],k=[];function L(J,D){for(A=0;A<D.length;A++){var B=J[D[A]],N=(B._extremes||{})[b];if(B.visible===!0&&N){for(E=0;E<N.min.length;E++)M=N.min[E],c(C,M.val,M.pad,{extrapad:M.extrapad});for(E=0;E<N.max.length;E++)M=N.max[E],f(k,M.val,M.pad,{extrapad:M.extrapad})}}}if(L(_,T._traceIndices),L(S.annotations||[],T._annIndices||[]),L(S.shapes||[],T._shapeIndices||[]),T._matchGroup&&!w){for(var I in T._matchGroup)if(I!==T._id){var R=o(v,I),V=a(v,R,!0),O=T._length/R._length;for(E=0;E<V.min.length;E++)M=V.min[E],c(C,M.val,M.pad*O,{extrapad:M.extrapad});for(E=0;E<V.max.length;E++)M=V.max[E],f(k,M.val,M.pad*O,{extrapad:M.extrapad})}}return{min:C,max:k}}function c(v,T,w,A){g(v,T,w,A,m)}function f(v,T,w,A){g(v,T,w,A,y)}function g(v,T,w,A,E){for(var M=A.tozero,b=A.extrapad,_=!0,S=0;S<v.length&&_;S++){var C=v[S];if(E(C.val,T)&&C.pad>=w&&(C.extrapad||!b)){_=!1;break}E(T,C.val)&&C.pad<=w&&(b||!C.extrapad)&&(v.splice(S,1),S--)}if(_){var k=M&&T===0;v.push({val:T,pad:k?0:w,extrapad:!k&&b})}}function d(v){return t(v)&&Math.abs(v)<p}function m(v,T){return v<=T}function y(v,T){return v>=T}},{"../../constants/numerical":753,"../../lib":778,"../../registry":911,"./axis_ids":831,"fast-isnumeric":241}],828:[function(n,z,q){"use strict";var t=n("d3"),h=n("fast-isnumeric"),p=n("../../plots/plots"),l=n("../../registry"),e=n("../../lib"),o=e.strTranslate,r=n("../../lib/svg_text_utils"),i=n("../../components/titles"),u=n("../../components/color"),s=n("../../components/drawing"),a=n("./layout_attributes"),c=n("./clean_ticks"),f=n("../../constants/numerical"),g=f.ONEMAXYEAR,d=f.ONEAVGYEAR,m=f.ONEMINYEAR,y=f.ONEMAXQUARTER,v=f.ONEAVGQUARTER,T=f.ONEMINQUARTER,w=f.ONEMAXMONTH,A=f.ONEAVGMONTH,E=f.ONEMINMONTH,M=f.ONEWEEK,b=f.ONEDAY,_=b/2,S=f.ONEHOUR,C=f.ONEMIN,k=f.ONESEC,L=f.MINUS_SIGN,I=f.BADNUM,R=n("../../constants/alignment"),V=R.MID_SHIFT,O=R.CAP_SHIFT,J=R.LINE_SPACING,D=R.OPPOSITE_SIDE,B=z.exports={};B.setConvert=n("./set_convert");var N=n("./axis_autotype"),F=n("./axis_ids"),H=F.idSort,j=F.isLinked;B.id2name=F.id2name,B.name2id=F.name2id,B.cleanId=F.cleanId,B.list=F.list,B.listIds=F.listIds,B.getFromId=F.getFromId,B.getFromTrace=F.getFromTrace;var G=n("./autorange");B.getAutoRange=G.getAutoRange,B.findExtremes=G.findExtremes;function W(Ie){var be=1e-4*(Ie[1]-Ie[0]);return[Ie[0]-be,Ie[1]+be]}B.coerceRef=function(Ie,be,We,Ge,st,ot){var Ce=Ge.charAt(Ge.length-1),Ue=We._fullLayout._subplots[Ce+"axis"],Ye=Ge+"ref",xe={};return st||(st=Ue[0]||(typeof ot=="string"?ot:ot[0])),ot||(ot=st),Ue=Ue.concat(Ue.map(function(Ee){return Ee+" domain"})),xe[Ye]={valType:"enumerated",values:Ue.concat(ot?typeof ot=="string"?[ot]:ot:[]),dflt:st},e.coerce(Ie,be,xe,Ye)},B.getRefType=function(Ie){return Ie===void 0?Ie:Ie==="paper"?"paper":Ie==="pixel"?"pixel":/( domain)$/.test(Ie)?"domain":"range"},B.coercePosition=function(Ie,be,We,Ge,st,ot){var Ce,Ue;if(B.getRefType(Ge)!=="range")Ce=e.ensureNumber,Ue=We(st,ot);else{var Ye=B.getFromId(be,Ge);Ue=We(st,ot=Ye.fraction2r(ot)),Ce=Ye.cleanPos}Ie[st]=Ce(Ue)},B.cleanPosition=function(Ie,be,We){return(We==="paper"||We==="pixel"?e.ensureNumber:B.getFromId(be,We).cleanPos)(Ie)},B.redrawComponents=function(Ie,be){be=be||B.listIds(Ie);var We=Ie._fullLayout;function Ge(st,ot,Ce,Ue){for(var Ye=l.getComponentMethod(st,ot),xe={},Ee=0;Ee<be.length;Ee++)for(var Je=We[B.id2name(be[Ee])][Ce],it=0;it<Je.length;it++){var ht=Je[it];if(!xe[ht]&&(Ye(Ie,ht),xe[ht]=1,Ue))return}}Ge("annotations","drawOne","_annIndices"),Ge("shapes","drawOne","_shapeIndices"),Ge("images","draw","_imgIndices",!0)};var Q=B.getDataConversions=function(Ie,be,We,Ge){var st,ot=We==="x"||We==="y"||We==="z"?We:Ge;if(Array.isArray(ot)){if(st={type:N(Ge,void 0,{autotypenumbers:Ie._fullLayout.autotypenumbers}),_categories:[]},B.setConvert(st),st.type==="category")for(var Ce=0;Ce<Ge.length;Ce++)st.d2c(Ge[Ce])}else st=B.getFromTrace(Ie,be,ot);return st?{d2c:st.d2c,c2d:st.c2d}:ot==="ids"?{d2c:ee,c2d:ee}:{d2c:$,c2d:$}};function $(Ie){return+Ie}function ee(Ie){return String(Ie)}function ie(Ie){return+Ie.substring(1)}B.getDataToCoordFunc=function(Ie,be,We,Ge){return Q(Ie,be,We,Ge).d2c},B.counterLetter=function(Ie){var be=Ie.charAt(0);return be==="x"?"y":be==="y"?"x":void 0},B.minDtick=function(Ie,be,We,Ge){["log","category","multicategory"].indexOf(Ie.type)===-1&&Ge?Ie._minDtick===void 0?(Ie._minDtick=be,Ie._forceTick0=We):Ie._minDtick&&((Ie._minDtick/be+1e-6)%1<2e-6&&((We-Ie._forceTick0)/be%1+1.000001)%1<2e-6?(Ie._minDtick=be,Ie._forceTick0=We):((be/Ie._minDtick+1e-6)%1>2e-6||((We-Ie._forceTick0)/Ie._minDtick%1+1.000001)%1>2e-6)&&(Ie._minDtick=0)):Ie._minDtick=0},B.saveRangeInitial=function(Ie,be){for(var We=B.list(Ie,"",!0),Ge=!1,st=0;st<We.length;st++){var ot=We[st],Ce=ot._rangeInitial===void 0,Ue=Ce||!(ot.range[0]===ot._rangeInitial[0]&&ot.range[1]===ot._rangeInitial[1]);(Ce&&ot.autorange===!1||be&&Ue)&&(ot._rangeInitial=ot.range.slice(),Ge=!0)}return Ge},B.saveShowSpikeInitial=function(Ie,be){for(var We=B.list(Ie,"",!0),Ge=!1,st="on",ot=0;ot<We.length;ot++){var Ce=We[ot],Ue=Ce._showSpikeInitial===void 0,Ye=Ue||Ce.showspikes!==Ce._showspikes;(Ue||be&&Ye)&&(Ce._showSpikeInitial=Ce.showspikes,Ge=!0),st!=="on"||Ce.showspikes||(st="off")}return Ie._fullLayout._cartesianSpikesEnabled=st,Ge},B.autoBin=function(Ie,be,We,Ge,st,ot){var Ce,Ue=e.aggNums(Math.min,null,Ie),Ye=e.aggNums(Math.max,null,Ie);if(be.type==="category"||be.type==="multicategory")return{start:Ue-.5,end:Ye+.5,size:Math.max(1,Math.round(ot)||1),_dataSpan:Ye-Ue};if(st||(st=be.calendar),Ce=be.type==="log"?{type:"linear",range:[Ue,Ye]}:{type:be.type,range:e.simpleMap([Ue,Ye],be.c2r,0,st),calendar:st},B.setConvert(Ce),ot=ot&&c.dtick(ot,Ce.type))Ce.dtick=ot,Ce.tick0=c.tick0(void 0,Ce.type,st);else{var xe;if(We)xe=(Ye-Ue)/We;else{var Ee=e.distinctVals(Ie),Je=Math.pow(10,Math.floor(Math.log(Ee.minDiff)/Math.LN10)),it=Je*e.roundUp(Ee.minDiff/Je,[.9,1.9,4.9,9.9],!0);xe=Math.max(it,2*e.stdev(Ie)/Math.pow(Ie.length,Ge?.25:.4)),h(xe)||(xe=1)}B.autoTicks(Ce,xe)}var ht,ct=Ce.dtick,mt=B.tickIncrement(B.tickFirst(Ce),ct,"reverse",st);if(typeof ct=="number")ht=(mt=function(bt,Et,Mt,_t,xt){var At=0,It=0,Nt=0,Ot=0;function Yt(wt){return(1+100*(wt-bt)/Mt.dtick)%100<2}for(var Pt=0;Pt<Et.length;Pt++)Et[Pt]%1==0?Nt++:h(Et[Pt])||Ot++,Yt(Et[Pt])&&At++,Yt(Et[Pt]+Mt.dtick/2)&&It++;var Ne=Et.length-Ot;if(Nt===Ne&&Mt.type!=="date")Mt.dtick<1?bt=_t-.5*Mt.dtick:(bt-=.5)+Mt.dtick<_t&&(bt+=Mt.dtick);else if(It<.1*Ne&&(At>.3*Ne||Yt(_t)||Yt(xt))){var ut=Mt.dtick/2;bt+=bt+ut<_t?ut:-ut}return bt}(mt,Ie,Ce,Ue,Ye))+(1+Math.floor((Ye-mt)/ct))*ct;else for(Ce.dtick.charAt(0)==="M"&&(mt=function(bt,Et,Mt,_t,xt){var At=e.findExactDates(Et,xt);if(At.exactDays>.8){var It=Number(Mt.substr(1));At.exactYears>.8&&It%12==0?bt=B.tickIncrement(bt,"M6","reverse")+1.5*b:At.exactMonths>.8?bt=B.tickIncrement(bt,"M1","reverse")+15.5*b:bt-=_;var Nt=B.tickIncrement(bt,Mt);if(Nt<=_t)return Nt}return bt}(mt,Ie,ct,Ue,st)),ht=mt,0;ht<=Ye;)ht=B.tickIncrement(ht,ct,!1,st);return{start:be.c2r(mt,0,st),end:be.c2r(ht,0,st),size:ct,_dataSpan:Ye-Ue}},B.prepTicks=function(Ie,be){var We=e.simpleMap(Ie.range,Ie.r2l,void 0,void 0,be);if(Ie._dtickInit=Ie.dtick,Ie._tick0Init=Ie.tick0,Ie.tickmode==="auto"||!Ie.dtick){var Ge,st=Ie.nticks;st||(Ie.type==="category"||Ie.type==="multicategory"?(Ge=Ie.tickfont?1.2*(Ie.tickfont.size||12):15,st=Ie._length/Ge):(Ge=Ie._id.charAt(0)==="y"?40:80,st=e.constrain(Ie._length/Ge,4,9)+1),Ie._name==="radialaxis"&&(st*=2)),Ie.tickmode==="array"&&(st*=100),Ie._roughDTick=Math.abs(We[1]-We[0])/st,B.autoTicks(Ie,Ie._roughDTick),Ie._minDtick>0&&Ie.dtick<2*Ie._minDtick&&(Ie.dtick=Ie._minDtick,Ie.tick0=Ie.l2r(Ie._forceTick0))}Ie.ticklabelmode==="period"&&function(ot){var Ce;function Ue(){return!(h(ot.dtick)||ot.dtick.charAt(0)!=="M")}var Ye=Ue(),xe=B.getTickFormat(ot);if(xe){var Ee=ot._dtickInit!==ot.dtick;/%[fLQsSMX]/.test(xe)||(/%[HI]/.test(xe)?(Ce=S,Ee&&!Ye&&ot.dtick<S&&(ot.dtick=S)):/%p/.test(xe)?(Ce=_,Ee&&!Ye&&ot.dtick<_&&(ot.dtick=_)):/%[Aadejuwx]/.test(xe)?(Ce=b,Ee&&!Ye&&ot.dtick<b&&(ot.dtick=b)):/%[UVW]/.test(xe)?(Ce=M,Ee&&!Ye&&ot.dtick<M&&(ot.dtick=M)):/%[Bbm]/.test(xe)?(Ce=A,Ee&&(Ye?ie(ot.dtick)<1:ot.dtick<E)&&(ot.dtick="M1")):/%[q]/.test(xe)?(Ce=v,Ee&&(Ye?ie(ot.dtick)<3:ot.dtick<T)&&(ot.dtick="M3")):/%[Yy]/.test(xe)&&(Ce=d,Ee&&(Ye?ie(ot.dtick)<12:ot.dtick<m)&&(ot.dtick="M12")))}(Ye=Ue())&&ot.tick0===ot._dowTick0&&(ot.tick0=ot._rawTick0),ot._definedDelta=Ce}(Ie),Ie.tick0||(Ie.tick0=Ie.type==="date"?"2000-01-01":0),Ie.type==="date"&&Ie.dtick<.1&&(Ie.dtick=.1),Se(Ie)},B.calcTicks=function(Ie,be){B.prepTicks(Ie,be);var We=e.simpleMap(Ie.range,Ie.r2l,void 0,void 0,be);if(Ie.tickmode==="array")return function(Pt){var Ne=Pt.tickvals,ut=Pt.ticktext,wt=new Array(Ne.length),Bt=W(e.simpleMap(Pt.range,Pt.r2l)),Jt=Math.min(Bt[0],Bt[1]),er=Math.max(Bt[0],Bt[1]),or=0;Array.isArray(ut)||(ut=[]);var zt=Pt.type==="category"?Pt.d2l_noadd:Pt.d2l;Pt.type==="log"&&String(Pt.dtick).charAt(0)!=="L"&&(Pt.dtick="L"+Math.pow(10,Math.floor(Math.min(Pt.range[0],Pt.range[1]))-1));for(var Qt=0;Qt<Ne.length;Qt++){var cr=zt(Ne[Qt]);cr>Jt&&cr<er&&(ut[Qt]===void 0?wt[or]=B.tickText(Pt,cr):wt[or]=ke(Pt,cr,String(ut[Qt])),or++)}return or<Ne.length&&wt.splice(or,Ne.length-or),Pt.rangebreaks&&(wt=wt.filter(function(Dt){return Pt.maskBreaks(Dt.x)!==I})),wt}(Ie);var Ge=W(We),st=Ge[0],ot=Ge[1],Ce=We[1]<We[0],Ue=Math.min(We[0],We[1]),Ye=Math.max(We[0],We[1]),xe=Ie.type==="log"&&!(h(Ie.dtick)||Ie.dtick.charAt(0)==="L"),Ee=Ie.ticklabelmode==="period";if(Ie._tmin=B.tickFirst(Ie,be),Ie._tmin<st!==Ce)return[];Ie.type!=="category"&&Ie.type!=="multicategory"||(ot=Ce?Math.max(-.5,ot):Math.min(Ie._categories.length-.5,ot));var Je=Ie._tmin;Ie.rangebreaks&&Ie._tick0Init!==Ie.tick0&&(Je=gt(Je,Ie),Ce||(Je=B.tickIncrement(Je,Ie.dtick,!Ce,Ie.calendar))),Ee&&(Je=B.tickIncrement(Je,Ie.dtick,!Ce,Ie.calendar));for(var it,ht=Math.max(1e3,Ie._length||0),ct=[],mt=null;Ce?Je>=ot:Je<=ot;Je=B.tickIncrement(Je,Ie.dtick,Ce,Ie.calendar)){if(Ie.rangebreaks&&!Ce){if(Je<st)continue;if(Ie.maskBreaks(Je)===I&&gt(Je,Ie)>=Ye)break}if(ct.length>ht||Je===mt)break;mt=Je;var bt=!1;xe&&Je!==(0|Je)&&(bt=!0),ct.push({minor:bt,value:Je})}if(Ee&&function(Pt,Ne,ut){for(var wt=0;wt<Pt.length;wt++){var Bt=Pt[wt].value,Jt=wt,er=wt+1;wt<Pt.length-1?(Jt=wt,er=wt+1):wt>0?(Jt=wt-1,er=wt):(Jt=wt,er=wt);var or,zt=Pt[Jt].value,Qt=Pt[er].value,cr=Math.abs(Qt-zt),Dt=ut||cr,Ut=0;Dt>=m?Ut=cr>=m&&cr<=g?cr:d:ut===v&&Dt>=T?Ut=cr>=T&&cr<=y?cr:v:Dt>=E?Ut=cr>=E&&cr<=w?cr:A:ut===M&&Dt>=M?Ut=M:Dt>=b?Ut=b:ut===_&&Dt>=_?Ut=_:ut===S&&Dt>=S&&(Ut=S),Ut>=cr&&(Ut=cr,or=!0);var ur=Bt+Ut;if(Ne.rangebreaks&&Ut>0){for(var Sr=0,Lr=0;Lr<84;Lr++){var Hr=(Lr+.5)/84;Ne.maskBreaks(Bt*(1-Hr)+Hr*ur)!==I&&Sr++}(Ut*=Sr/84)||(Pt[wt].drop=!0),or&&cr>M&&(Ut=cr)}(Ut>0||wt===0)&&(Pt[wt].periodX=Bt+Ut/2)}}(ct,Ie,Ie._definedDelta),Ie.rangebreaks){var Et=Ie._id.charAt(0)==="y",Mt=1;Ie.tickmode==="auto"&&(Mt=Ie.tickfont?Ie.tickfont.size:12);var _t=NaN;for(it=ct.length-1;it>-1;it--)if(ct[it].drop)ct.splice(it,1);else{ct[it].value=gt(ct[it].value,Ie);var xt=Ie.c2p(ct[it].value);(Et?_t>xt-Mt:_t<xt+Mt)?ct.splice(Ce?it+1:it,1):_t=xt}}lt(Ie)&&Math.abs(We[1]-We[0])===360&&ct.pop(),Ie._tmax=(ct[ct.length-1]||{}).value,Ie._prevDateHead="",Ie._inCalcTicks=!0;var At,It,Nt=[];for(it=0;it<ct.length;it++){var Ot=ct[it].minor,Yt=ct[it].value;At=B.tickText(Ie,Yt,!1,Ot),(It=ct[it].periodX)!==void 0&&(At.periodX=It,(It>Ye||It<Ue)&&(It>Ye&&(At.periodX=Ye),It<Ue&&(At.periodX=Ue),At.text=" ",Ie._prevDateHead="")),Nt.push(At)}return Ie._inCalcTicks=!1,Nt};var ae=[2,5,10],oe=[1,2,3,6,12],de=[1,2,5,10,15,30],le=[1,2,3,7,14],fe=[-.046,0,.301,.477,.602,.699,.778,.845,.903,.954,1],ue=[-.301,0,.301,.699,1],we=[15,30,45,90,180];function Ae(Ie,be,We){return be*e.roundUp(Ie/be,We)}function Se(Ie){var be=Ie.dtick;if(Ie._tickexponent=0,h(be)||typeof be=="string"||(be=1),Ie.type!=="category"&&Ie.type!=="multicategory"||(Ie._tickround=null),Ie.type==="date"){var We=Ie.r2l(Ie.tick0),Ge=Ie.l2r(We).replace(/(^-|i)/g,""),st=Ge.length;if(String(be).charAt(0)==="M")st>10||Ge.substr(5)!=="01-01"?Ie._tickround="d":Ie._tickround=+be.substr(1)%12==0?"y":"m";else if(be>=b&&st<=10||be>=15*b)Ie._tickround="d";else if(be>=C&&st<=16||be>=S)Ie._tickround="M";else if(be>=k&&st<=19||be>=C)Ie._tickround="S";else{var ot=Ie.l2r(We+be).replace(/^-/,"").length;Ie._tickround=Math.max(st,ot)-20,Ie._tickround<0&&(Ie._tickround=4)}}else if(h(be)||be.charAt(0)==="L"){var Ce=Ie.range.map(Ie.r2d||Number);h(be)||(be=Number(be.substr(1))),Ie._tickround=2-Math.floor(Math.log(be)/Math.LN10+.01);var Ue=Math.max(Math.abs(Ce[0]),Math.abs(Ce[1])),Ye=Math.floor(Math.log(Ue)/Math.LN10+.01),xe=Ie.minexponent===void 0?3:Ie.minexponent;Math.abs(Ye)>xe&&(ve(Ie.exponentformat)&&!ge(Ye)?Ie._tickexponent=3*Math.round((Ye-1)/3):Ie._tickexponent=Ye)}else Ie._tickround=null}function ke(Ie,be,We){var Ge=Ie.tickfont||{};return{x:be,dx:0,dy:0,text:We||"",fontSize:Ge.size,font:Ge.family,fontColor:Ge.color}}B.autoTicks=function(Ie,be){var We;function Ge(Ee){return Math.pow(Ee,Math.floor(Math.log(be)/Math.LN10))}if(Ie.type==="date"){Ie.tick0=e.dateTick0(Ie.calendar,0);var st=2*be;if(st>d)be/=d,We=Ge(10),Ie.dtick="M"+12*Ae(be,We,ae);else if(st>A)be/=A,Ie.dtick="M"+Ae(be,1,oe);else if(st>b){Ie.dtick=Ae(be,b,Ie._hasDayOfWeekBreaks?[1,2,7,14]:le);var ot=B.getTickFormat(Ie),Ce=Ie.ticklabelmode==="period";Ce&&(Ie._rawTick0=Ie.tick0),/%[uVW]/.test(ot)?Ie.tick0=e.dateTick0(Ie.calendar,2):Ie.tick0=e.dateTick0(Ie.calendar,1),Ce&&(Ie._dowTick0=Ie.tick0)}else st>S?Ie.dtick=Ae(be,S,oe):st>C?Ie.dtick=Ae(be,C,de):st>k?Ie.dtick=Ae(be,k,de):(We=Ge(10),Ie.dtick=Ae(be,We,ae))}else if(Ie.type==="log"){Ie.tick0=0;var Ue=e.simpleMap(Ie.range,Ie.r2l);if(be>.7)Ie.dtick=Math.ceil(be);else if(Math.abs(Ue[1]-Ue[0])<1){var Ye=1.5*Math.abs((Ue[1]-Ue[0])/be);be=Math.abs(Math.pow(10,Ue[1])-Math.pow(10,Ue[0]))/Ye,We=Ge(10),Ie.dtick="L"+Ae(be,We,ae)}else Ie.dtick=be>.3?"D2":"D1"}else Ie.type==="category"||Ie.type==="multicategory"?(Ie.tick0=0,Ie.dtick=Math.ceil(Math.max(be,1))):lt(Ie)?(Ie.tick0=0,We=1,Ie.dtick=Ae(be,We,we)):(Ie.tick0=0,We=Ge(10),Ie.dtick=Ae(be,We,ae));if(Ie.dtick===0&&(Ie.dtick=1),!h(Ie.dtick)&&typeof Ie.dtick!="string"){var xe=Ie.dtick;throw Ie.dtick=1,"ax.dtick error: "+String(xe)}},B.tickIncrement=function(Ie,be,We,Ge){var st=We?-1:1;if(h(be))return e.increment(Ie,st*be);var ot=be.charAt(0),Ce=st*Number(be.substr(1));if(ot==="M")return e.incrementMonth(Ie,Ce,Ge);if(ot==="L")return Math.log(Math.pow(10,Ie)+Ce)/Math.LN10;if(ot==="D"){var Ue=be==="D2"?ue:fe,Ye=Ie+.01*st,xe=e.roundUp(e.mod(Ye,1),Ue,We);return Math.floor(Ye)+Math.log(t.round(Math.pow(10,xe),1))/Math.LN10}throw"unrecognized dtick "+String(be)},B.tickFirst=function(Ie,be){var We=Ie.r2l||Number,Ge=e.simpleMap(Ie.range,We,void 0,void 0,be),st=Ge[1]<Ge[0],ot=st?Math.floor:Math.ceil,Ce=W(Ge)[0],Ue=Ie.dtick,Ye=We(Ie.tick0);if(h(Ue)){var xe=ot((Ce-Ye)/Ue)*Ue+Ye;return Ie.type!=="category"&&Ie.type!=="multicategory"||(xe=e.constrain(xe,0,Ie._categories.length-1)),xe}var Ee=Ue.charAt(0),Je=Number(Ue.substr(1));if(Ee==="M"){for(var it,ht,ct,mt=0,bt=Ye;mt<10;){if(((it=B.tickIncrement(bt,Ue,st,Ie.calendar))-Ce)*(bt-Ce)<=0)return st?Math.min(bt,it):Math.max(bt,it);ht=(Ce-(bt+it)/2)/(it-bt),ct=Ee+(Math.abs(Math.round(ht))||1)*Je,bt=B.tickIncrement(bt,ct,ht<0?!st:st,Ie.calendar),mt++}return e.error("tickFirst did not converge",Ie),bt}if(Ee==="L")return Math.log(ot((Math.pow(10,Ce)-Ye)/Je)*Je+Ye)/Math.LN10;if(Ee==="D"){var Et=Ue==="D2"?ue:fe,Mt=e.roundUp(e.mod(Ce,1),Et,st);return Math.floor(Ce)+Math.log(t.round(Math.pow(10,Mt),1))/Math.LN10}throw"unrecognized dtick "+String(Ue)},B.tickText=function(Ie,be,We,Ge){var st,ot=ke(Ie,be),Ce=Ie.tickmode==="array",Ue=We||Ce,Ye=Ie.type,xe=Ye==="category"?Ie.d2l_noadd:Ie.d2l;if(Ce&&Array.isArray(Ie.ticktext)){var Ee=e.simpleMap(Ie.range,Ie.r2l),Je=(Math.abs(Ee[1]-Ee[0])-(Ie._lBreaks||0))/1e4;for(st=0;st<Ie.ticktext.length&&!(Math.abs(be-xe(Ie.tickvals[st]))<Je);st++);if(st<Ie.ticktext.length)return ot.text=String(Ie.ticktext[st]),ot}function it(mt){if(mt===void 0)return!0;if(We)return mt==="none";var bt={first:Ie._tmin,last:Ie._tmax}[mt];return mt!=="all"&&be!==bt}var ht=We?"never":Ie.exponentformat!=="none"&&it(Ie.showexponent)?"hide":"";if(Ye==="date"?function(mt,bt,Et,Mt){var _t=mt._tickround,xt=Et&&mt.hoverformat||B.getTickFormat(mt);Mt&&(_t=h(_t)?4:{y:"m",m:"d",d:"M",M:"S",S:4}[_t]);var At,It=e.formatDate(bt.x,xt,_t,mt._dateFormat,mt.calendar,mt._extraFormat),Nt=It.indexOf(`
`);if(Nt!==-1&&(At=It.substr(Nt+1),It=It.substr(0,Nt)),Mt&&(It==="00:00:00"||It==="00:00"?(It=At,At=""):It.length===8&&(It=It.replace(/:00$/,""))),At)if(Et)_t==="d"?It+=", "+At:It=At+(It?", "+It:"");else if(mt._inCalcTicks&&mt._prevDateHead===At){var Ot=(mt.ticklabelposition||"").indexOf("inside")!==-1,Yt=mt._realSide||mt.side;(!Ot&&Yt==="top"||Ot&&Yt==="bottom")&&(It+="<br> ")}else mt._prevDateHead=At,It+="<br>"+At;bt.text=It}(Ie,ot,We,Ue):Ye==="log"?function(mt,bt,Et,Mt,_t){var xt=mt.dtick,At=bt.x,It=mt.tickformat,Nt=typeof xt=="string"&&xt.charAt(0);if(_t==="never"&&(_t=""),Mt&&Nt!=="L"&&(xt="L3",Nt="L"),It||Nt==="L")bt.text=De(Math.pow(10,At),mt,_t,Mt);else if(h(xt)||Nt==="D"&&e.mod(At+.01,1)<.1){var Ot=Math.round(At),Yt=Math.abs(Ot),Pt=mt.exponentformat;Pt==="power"||ve(Pt)&&ge(Ot)?(bt.text=Ot===0?1:Ot===1?"10":"10<sup>"+(Ot>1?"":L)+Yt+"</sup>",bt.fontSize*=1.25):(Pt==="e"||Pt==="E")&&Yt>2?bt.text="1"+Pt+(Ot>0?"+":L)+Yt:(bt.text=De(Math.pow(10,At),mt,"","fakehover"),xt==="D1"&&mt._id.charAt(0)==="y"&&(bt.dy-=bt.fontSize/6))}else{if(Nt!=="D")throw"unrecognized dtick "+String(xt);bt.text=String(Math.round(Math.pow(10,e.mod(At,1)))),bt.fontSize*=.75}if(mt.dtick==="D1"){var Ne=String(bt.text).charAt(0);Ne!=="0"&&Ne!=="1"||(mt._id.charAt(0)==="y"?bt.dx-=bt.fontSize/4:(bt.dy+=bt.fontSize/2,bt.dx+=(mt.range[1]>mt.range[0]?1:-1)*bt.fontSize*(At<0?.5:.25)))}}(Ie,ot,0,Ue,ht):Ye==="category"?function(mt,bt){var Et=mt._categories[Math.round(bt.x)];Et===void 0&&(Et=""),bt.text=String(Et)}(Ie,ot):Ye==="multicategory"?function(mt,bt,Et){var Mt=Math.round(bt.x),_t=mt._categories[Mt]||[],xt=_t[1]===void 0?"":String(_t[1]),At=_t[0]===void 0?"":String(_t[0]);Et?bt.text=At+" - "+xt:(bt.text=xt,bt.text2=At)}(Ie,ot,We):lt(Ie)?function(mt,bt,Et,Mt,_t){if(mt.thetaunit!=="radians"||Et)bt.text=De(bt.x,mt,_t,Mt);else{var xt=bt.x/180;if(xt===0)bt.text="0";else{var At=function(Nt){function Ot(ut,wt){return Math.abs(ut-wt)<=1e-6}var Yt=function(ut){for(var wt=1;!Ot(Math.round(ut*wt)/wt,ut);)wt*=10;return wt}(Nt),Pt=Nt*Yt,Ne=Math.abs(function ut(wt,Bt){return Ot(Bt,0)?wt:ut(Bt,wt%Bt)}(Pt,Yt));return[Math.round(Pt/Ne),Math.round(Yt/Ne)]}(xt);if(At[1]>=100)bt.text=De(e.deg2rad(bt.x),mt,_t,Mt);else{var It=bt.x<0;At[1]===1?At[0]===1?bt.text="\u03C0":bt.text=At[0]+"\u03C0":bt.text=["<sup>",At[0],"</sup>","\u2044","<sub>",At[1],"</sub>","\u03C0"].join(""),It&&(bt.text=L+bt.text)}}}}(Ie,ot,We,Ue,ht):function(mt,bt,Et,Mt,_t){_t==="never"?_t="":mt.showexponent==="all"&&Math.abs(bt.x/mt.dtick)<1e-6&&(_t="hide"),bt.text=De(bt.x,mt,_t,Mt)}(Ie,ot,0,Ue,ht),Ge||(Ie.tickprefix&&!it(Ie.showtickprefix)&&(ot.text=Ie.tickprefix+ot.text),Ie.ticksuffix&&!it(Ie.showticksuffix)&&(ot.text+=Ie.ticksuffix)),Ie.tickson==="boundaries"||Ie.showdividers){var ct=function(mt){var bt=Ie.l2p(mt);return bt>=0&&bt<=Ie._length?mt:null};ot.xbnd=[ct(ot.x-.5),ct(ot.x+Ie.dtick-.5)]}return ot},B.hoverLabelText=function(Ie,be,We){if(We!==I&&We!==be)return B.hoverLabelText(Ie,be)+" - "+B.hoverLabelText(Ie,We);var Ge=Ie.type==="log"&&be<=0,st=B.tickText(Ie,Ie.c2l(Ge?-be:be),"hover").text;return Ge?be===0?"0":L+st:st};var Me=["f","p","n","\u03BC","m","","k","M","G","T"];function ve(Ie){return Ie==="SI"||Ie==="B"}function ge(Ie){return Ie>14||Ie<-15}function De(Ie,be,We,Ge){var st=Ie<0,ot=be._tickround,Ce=We||be.exponentformat||"B",Ue=be._tickexponent,Ye=B.getTickFormat(be),xe=be.separatethousands;if(Ge){var Ee={exponentformat:Ce,minexponent:be.minexponent,dtick:be.showexponent==="none"?be.dtick:h(Ie)&&Math.abs(Ie)||1,range:be.showexponent==="none"?be.range.map(be.r2d):[0,Ie||1]};Se(Ee),ot=(Number(Ee._tickround)||0)+4,Ue=Ee._tickexponent,be.hoverformat&&(Ye=be.hoverformat)}if(Ye)return be._numFormat(Ye)(Ie).replace(/-/g,L);var Je,it=Math.pow(10,-ot)/2;if(Ce==="none"&&(Ue=0),(Ie=Math.abs(Ie))<it)Ie="0",st=!1;else{if(Ie+=it,Ue&&(Ie*=Math.pow(10,-Ue),ot+=Ue),ot===0)Ie=String(Math.floor(Ie));else if(ot<0){Ie=(Ie=String(Math.round(Ie))).substr(0,Ie.length+ot);for(var ht=ot;ht<0;ht++)Ie+="0"}else{var ct=(Ie=String(Ie)).indexOf(".")+1;ct&&(Ie=Ie.substr(0,ct+ot).replace(/\.?0+$/,""))}Ie=e.numSeparate(Ie,be._separators,xe)}return Ue&&Ce!=="hide"&&(ve(Ce)&&ge(Ue)&&(Ce="power"),Je=Ue<0?L+-Ue:Ce!=="power"?"+"+Ue:String(Ue),Ce==="e"||Ce==="E"?Ie+=Ce+Je:Ce==="power"?Ie+="\xD710<sup>"+Je+"</sup>":Ce==="B"&&Ue===9?Ie+="B":ve(Ce)&&(Ie+=Me[Ue/3+5])),st?L+Ie:Ie}function _e(Ie,be){for(var We=[],Ge={},st=0;st<be.length;st++){var ot=be[st];Ge[ot.text2]?Ge[ot.text2].push(ot.x):Ge[ot.text2]=[ot.x]}for(var Ce in Ge)We.push(ke(Ie,e.interp(Ge[Ce],.5),Ce));return We}function Pe(Ie){return Ie.periodX!==void 0?Ie.periodX:Ie.x}function Fe(Ie){return[Ie.text,Ie.x,Ie.axInfo,Ie.font,Ie.fontSize,Ie.fontColor].join("_")}function ze(Ie){var be=Ie.title.font.size,We=(Ie.title.text.match(r.BR_TAG_ALL)||[]).length;return Ie.title.hasOwnProperty("standoff")?We?be*(O+We*J):be*O:We?be*(We+1)*J:be}function He(Ie,be){var We=Ie.l2p(be);return We>1&&We<Ie._length-1}function et(Ie){var be=t.select(Ie),We=be.select(".text-math-group");return We.empty()?be.select("text"):We}function Re(Ie){return Ie._id+".automargin"}function Ze(Ie){return Re(Ie)+".mirror"}function Ke(Ie){return Ie._id+".rangeslider"}function $e(Ie,be){for(var We=0;We<be.length;We++)Ie.indexOf(be[We])===-1&&Ie.push(be[We])}function rt(Ie,be,We){var Ge,st,ot=[],Ce=[],Ue=Ie.layout;for(Ge=0;Ge<be.length;Ge++)ot.push(B.getFromId(Ie,be[Ge]));for(Ge=0;Ge<We.length;Ge++)Ce.push(B.getFromId(Ie,We[Ge]));var Ye=Object.keys(a),xe=["anchor","domain","overlaying","position","side","tickangle","editType"],Ee=["linear","log"];for(Ge=0;Ge<Ye.length;Ge++){var Je=Ye[Ge],it=ot[0][Je],ht=Ce[0][Je],ct=!0,mt=!1,bt=!1;if(Je.charAt(0)!=="_"&&typeof it!="function"&&xe.indexOf(Je)===-1){for(st=1;st<ot.length&&ct;st++){var Et=ot[st][Je];Je==="type"&&Ee.indexOf(it)!==-1&&Ee.indexOf(Et)!==-1&&it!==Et?mt=!0:Et!==it&&(ct=!1)}for(st=1;st<Ce.length&&ct;st++){var Mt=Ce[st][Je];Je==="type"&&Ee.indexOf(ht)!==-1&&Ee.indexOf(Mt)!==-1&&ht!==Mt?bt=!0:Ce[st][Je]!==ht&&(ct=!1)}ct&&(mt&&(Ue[ot[0]._name].type="linear"),bt&&(Ue[Ce[0]._name].type="linear"),at(Ue,Je,ot,Ce,Ie._fullLayout._dfltTitle))}}for(Ge=0;Ge<Ie._fullLayout.annotations.length;Ge++){var _t=Ie._fullLayout.annotations[Ge];be.indexOf(_t.xref)!==-1&&We.indexOf(_t.yref)!==-1&&e.swapAttrs(Ue.annotations[Ge],["?"])}}function at(Ie,be,We,Ge,st){var ot,Ce=e.nestedProperty,Ue=Ce(Ie[We[0]._name],be).get(),Ye=Ce(Ie[Ge[0]._name],be).get();for(be==="title"&&(Ue&&Ue.text===st.x&&(Ue.text=st.y),Ye&&Ye.text===st.y&&(Ye.text=st.x)),ot=0;ot<We.length;ot++)Ce(Ie,We[ot]._name+"."+be).set(Ye);for(ot=0;ot<Ge.length;ot++)Ce(Ie,Ge[ot]._name+"."+be).set(Ue)}function lt(Ie){return Ie._id==="angularaxis"}function gt(Ie,be){for(var We=be._rangebreaks.length,Ge=0;Ge<We;Ge++){var st=be._rangebreaks[Ge];if(Ie>=st.min&&Ie<st.max)return st.max}return Ie}B.getTickFormat=function(Ie){var be,We,Ge,st,ot,Ce,Ue,Ye;function xe(it){return typeof it!="string"?it:Number(it.replace("M",""))*A}function Ee(it,ht){var ct=["L","D"];if(typeof it==typeof ht){if(typeof it=="number")return it-ht;var mt=ct.indexOf(it.charAt(0)),bt=ct.indexOf(ht.charAt(0));return mt===bt?Number(it.replace(/(L|D)/g,""))-Number(ht.replace(/(L|D)/g,"")):mt-bt}return typeof it=="number"?1:-1}function Je(it,ht){var ct=ht[0]===null,mt=ht[1]===null,bt=Ee(it,ht[0])>=0,Et=Ee(it,ht[1])<=0;return(ct||bt)&&(mt||Et)}if(Ie.tickformatstops&&Ie.tickformatstops.length>0)switch(Ie.type){case"date":case"linear":for(be=0;be<Ie.tickformatstops.length;be++)if((Ge=Ie.tickformatstops[be]).enabled&&(st=Ie.dtick,ot=Ge.dtickrange,Ce=void 0,Ue=void 0,Ye=void 0,Ce=xe||function(it){return it},Ue=ot[0],Ye=ot[1],(!Ue&&typeof Ue!="number"||Ce(Ue)<=Ce(st))&&(!Ye&&typeof Ye!="number"||Ce(Ye)>=Ce(st)))){We=Ge;break}break;case"log":for(be=0;be<Ie.tickformatstops.length;be++)if((Ge=Ie.tickformatstops[be]).enabled&&Je(Ie.dtick,Ge.dtickrange)){We=Ge;break}}return We?We.value:Ie.tickformat},B.getSubplots=function(Ie,be){var We=Ie._fullLayout._subplots,Ge=We.cartesian.concat(We.gl2d||[]),st=be?B.findSubplotsWithAxis(Ge,be):Ge;return st.sort(function(ot,Ce){var Ue=ot.substr(1).split("y"),Ye=Ce.substr(1).split("y");return Ue[0]===Ye[0]?+Ue[1]-+Ye[1]:+Ue[0]-+Ye[0]}),st},B.findSubplotsWithAxis=function(Ie,be){for(var We=new RegExp(be._id.charAt(0)==="x"?"^"+be._id+"y":be._id+"$"),Ge=[],st=0;st<Ie.length;st++){var ot=Ie[st];We.test(ot)&&Ge.push(ot)}return Ge},B.makeClipPaths=function(Ie){var be=Ie._fullLayout;if(!be._hasOnlyLargeSploms){var We,Ge,st={_offset:0,_length:be.width,_id:""},ot={_offset:0,_length:be.height,_id:""},Ce=B.list(Ie,"x",!0),Ue=B.list(Ie,"y",!0),Ye=[];for(We=0;We<Ce.length;We++)for(Ye.push({x:Ce[We],y:ot}),Ge=0;Ge<Ue.length;Ge++)We===0&&Ye.push({x:st,y:Ue[Ge]}),Ye.push({x:Ce[We],y:Ue[Ge]});var xe=be._clips.selectAll(".axesclip").data(Ye,function(Ee){return Ee.x._id+Ee.y._id});xe.enter().append("clipPath").classed("axesclip",!0).attr("id",function(Ee){return"clip"+be._uid+Ee.x._id+Ee.y._id}).append("rect"),xe.exit().remove(),xe.each(function(Ee){t.select(this).select("rect").attr({x:Ee.x._offset||0,y:Ee.y._offset||0,width:Ee.x._length||1,height:Ee.y._length||1})})}},B.draw=function(Ie,be,We){var Ge=Ie._fullLayout;be==="redraw"&&Ge._paper.selectAll("g.subplot").each(function(ot){var Ce=ot[0],Ue=Ge._plots[Ce];if(Ue){var Ye=Ue.xaxis,xe=Ue.yaxis;Ue.xaxislayer.selectAll("."+Ye._id+"tick").remove(),Ue.yaxislayer.selectAll("."+xe._id+"tick").remove(),Ue.xaxislayer.selectAll("."+Ye._id+"tick2").remove(),Ue.yaxislayer.selectAll("."+xe._id+"tick2").remove(),Ue.xaxislayer.selectAll("."+Ye._id+"divider").remove(),Ue.yaxislayer.selectAll("."+xe._id+"divider").remove(),Ue.gridlayer&&Ue.gridlayer.selectAll("path").remove(),Ue.zerolinelayer&&Ue.zerolinelayer.selectAll("path").remove(),Ge._infolayer.select(".g-"+Ye._id+"title").remove(),Ge._infolayer.select(".g-"+xe._id+"title").remove()}});var st=be&&be!=="redraw"?be:B.listIds(Ie);return e.syncOrAsync(st.map(function(ot){return function(){if(ot){var Ce=B.getFromId(Ie,ot),Ue=B.drawOne(Ie,Ce,We);return Ce._r=Ce.range.slice(),Ce._rl=e.simpleMap(Ce._r,Ce.r2l),Ue}}}))},B.drawOne=function(Ie,be,We){var Ge,st,ot;We=We||{},be.setScale();var Ce=Ie._fullLayout,Ue=be._id,Ye=Ue.charAt(0),xe=B.counterLetter(Ue),Ee=Ce._plots[be._mainSubplot];if(Ee){var Je=Ee[Ye+"axislayer"],it=be._mainLinePosition,ht=be._mainMirrorPosition,ct=be._vals=B.calcTicks(be),mt=[be.mirror,it,ht].join("_");for(Ge=0;Ge<ct.length;Ge++)ct[Ge].axInfo=mt;be._selections={},be._tickAngles&&(be._prevTickAngles=be._tickAngles),be._tickAngles={},be._depth=null;var bt={};if(be.visible){var Et,Mt,_t=B.makeTransTickFn(be),xt=B.makeTransTickLabelFn(be),At=be.ticks==="inside",It=be.ticks==="outside";if(be.tickson==="boundaries"){var Nt=function(Ir,kr){var rn,Qr=[],nn=function(Xr,Nr){var Br=Xr.xbnd[Nr];Br!==null&&Qr.push(e.extendFlat({},Xr,{x:Br}))};if(kr.length){for(rn=0;rn<kr.length;rn++)nn(kr[rn],0);nn(kr[rn-1],1)}return Qr}(0,ct);Mt=B.clipEnds(be,Nt),Et=At?Mt:Nt}else Mt=B.clipEnds(be,ct),Et=At&&be.ticklabelmode!=="period"?Mt:ct;var Ot=be._gridVals=Mt,Yt=function(Ir,kr){var rn,Qr,nn=[],Xr=kr.length&&kr[kr.length-1].x<kr[0].x,Nr=function(on,cn){var un=on.xbnd[cn];un!==null&&nn.push(e.extendFlat({},on,{x:un}))};if(Ir.showdividers&&kr.length){for(rn=0;rn<kr.length;rn++){var Br=kr[rn];Br.text2!==Qr&&Nr(Br,Xr?1:0),Qr=Br.text2}Nr(kr[rn-1],Xr?0:1)}return nn}(be,ct);if(!Ce._hasOnlyLargeSploms){var Pt=be._subplotsWith,Ne={};for(Ge=0;Ge<Pt.length;Ge++){st=Pt[Ge];var ut=(ot=Ce._plots[st])[xe+"axis"],wt=ut._mainAxis._id;if(!Ne[wt]){Ne[wt]=1;var Bt=Ye==="x"?"M0,"+ut._offset+"v"+ut._length:"M"+ut._offset+",0h"+ut._length;B.drawGrid(Ie,be,{vals:Ot,counterAxis:ut,layer:ot.gridlayer.select("."+Ue),path:Bt,transFn:_t}),B.drawZeroLine(Ie,be,{counterAxis:ut,layer:ot.zerolinelayer,path:Bt,transFn:_t})}}}var Jt=B.getTickSigns(be),er=[];if(be.ticks){var or,zt,Qt,cr=B.makeTickPath(be,it,Jt[2]);if(be._anchorAxis&&be.mirror&&be.mirror!==!0?(or=B.makeTickPath(be,ht,Jt[3]),zt=cr+or):(or="",zt=cr),be.showdividers&&It&&be.tickson==="boundaries"){var Dt={};for(Ge=0;Ge<Yt.length;Ge++)Dt[Yt[Ge].x]=1;Qt=function(Ir){return Dt[Ir.x]?or:zt}}else Qt=zt;B.drawTicks(Ie,be,{vals:Et,layer:Je,path:Qt,transFn:_t}),be.mirror==="allticks"&&(er=Object.keys(be._linepositions||{}))}for(Ge=0;Ge<er.length;Ge++){st=er[Ge],ot=Ce._plots[st];var Ut=be._linepositions[st]||[],ur=B.makeTickPath(be,Ut[0],Jt[0])+B.makeTickPath(be,Ut[1],Jt[1]);B.drawTicks(Ie,be,{vals:Et,layer:ot[Ye+"axislayer"],path:ur,transFn:_t})}var Sr=[];if(Sr.push(function(){return B.drawLabels(Ie,be,{vals:ct,layer:Je,transFn:xt,labelFns:B.makeLabelFns(be,it)})}),be.type==="multicategory"){var Lr={x:2,y:10}[Ye];Sr.push(function(){var Ir={x:"height",y:"width"}[Ye],kr=Kr()[Ir]+Lr+(be._tickAngles[Ue+"tick"]?be.tickfont.size*J:0);return B.drawLabels(Ie,be,{vals:_e(be,ct),layer:Je,cls:Ue+"tick2",repositionOnUpdate:!0,secondary:!0,transFn:_t,labelFns:B.makeLabelFns(be,it+kr*Jt[4])})}),Sr.push(function(){return be._depth=Jt[4]*(Kr("tick2")[be.side]-it),function(Ir,kr,rn){var Qr=kr._id+"divider",nn=rn.vals,Xr=rn.layer.selectAll("path."+Qr).data(nn,Fe);Xr.exit().remove(),Xr.enter().insert("path",":first-child").classed(Qr,1).classed("crisp",1).call(u.stroke,kr.dividercolor).style("stroke-width",s.crispRound(Ir,kr.dividerwidth,1)+"px"),Xr.attr("transform",rn.transFn).attr("d",rn.path)}(Ie,be,{vals:Yt,layer:Je,path:B.makeTickPath(be,it,Jt[4],be._depth),transFn:_t})})}else be.title.hasOwnProperty("standoff")&&Sr.push(function(){be._depth=Jt[4]*(Kr()[be.side]-it)});var Hr=l.getComponentMethod("rangeslider","isVisible")(be);return Sr.push(function(){var Ir,kr,rn,Qr,nn=be.side.charAt(0),Xr=D[be.side].charAt(0),Nr=B.getPxPosition(Ie,be),Br=It?be.ticklen:0;if((be.automargin||Hr)&&(be.type==="multicategory"?Ir=Kr("tick2"):(Ir=Kr(),Ye==="x"&&nn==="b"&&(be._depth=Math.max(Ir.width>0?Ir.bottom-Nr:0,Br)))),be.automargin){kr={x:0,y:0,r:0,l:0,t:0,b:0};var on=[0,1];if(Ye==="x"){if(nn==="b"?kr[nn]=be._depth:(kr[nn]=be._depth=Math.max(Ir.width>0?Nr-Ir.top:0,Br),on.reverse()),Ir.width>0){var cn=Ir.right-(be._offset+be._length);cn>0&&(kr.xr=1,kr.r=cn);var un=be._offset-Ir.left;un>0&&(kr.xl=0,kr.l=un)}}else if(nn==="l"?kr[nn]=be._depth=Math.max(Ir.height>0?Nr-Ir.left:0,Br):(kr[nn]=be._depth=Math.max(Ir.height>0?Ir.right-Nr:0,Br),on.reverse()),Ir.height>0){var Zr=Ir.bottom-(be._offset+be._length);Zr>0&&(kr.yb=0,kr.b=Zr);var yn=be._offset-Ir.top;yn>0&&(kr.yt=1,kr.t=yn)}kr[xe]=be.anchor==="free"?be.position:be._anchorAxis.domain[on[0]],be.title.text!==Ce._dfltTitle[Ye]&&(kr[nn]+=ze(be)+(be.title.standoff||0)),be.mirror&&be.anchor!=="free"&&((rn={x:0,y:0,r:0,l:0,t:0,b:0})[Xr]=be.linewidth,be.mirror&&be.mirror!==!0&&(rn[Xr]+=Br),be.mirror===!0||be.mirror==="ticks"?rn[xe]=be._anchorAxis.domain[on[1]]:be.mirror!=="all"&&be.mirror!=="allticks"||(rn[xe]=[be._counterDomainMin,be._counterDomainMax][on[1]]))}Hr&&(Qr=l.getComponentMethod("rangeslider","autoMarginOpts")(Ie,be)),p.autoMargin(Ie,Re(be),kr),p.autoMargin(Ie,Ze(be),rn),p.autoMargin(Ie,Ke(be),Qr)}),We.skipTitle||Hr&&be.side==="bottom"||Sr.push(function(){return function(Ir,kr){var rn,Qr=Ir._fullLayout,nn=kr._id,Xr=nn.charAt(0),Nr=kr.title.font.size;if(kr.title.hasOwnProperty("standoff"))rn=kr._depth+kr.title.standoff+ze(kr);else{var Br=(kr.ticklabelposition||"").indexOf("inside")!==-1;if(kr.type==="multicategory")rn=kr._depth;else{var on=1.5*Nr;Br&&(on=.5*Nr,kr.ticks==="outside"&&(on+=kr.ticklen)),rn=10+on+(kr.linewidth?kr.linewidth-1:0)}Br||(rn+=Xr==="x"?kr.side==="top"?Nr*(kr.showticklabels?1:0):Nr*(kr.showticklabels?1.5:.5):kr.side==="right"?Nr*(kr.showticklabels?1:.5):Nr*(kr.showticklabels?.5:0))}var cn,un,Zr,yn,In=B.getPxPosition(Ir,kr);if(Xr==="x"?(un=kr._offset+kr._length/2,Zr=kr.side==="top"?In-rn:In+rn):(Zr=kr._offset+kr._length/2,un=kr.side==="right"?In+rn:In-rn,cn={rotate:"-90",offset:0}),kr.type!=="multicategory"){var Un=kr._selections[kr._id+"tick"];if(yn={selection:Un,side:kr.side},Un&&Un.node()&&Un.node().parentNode){var Kn=s.getTranslate(Un.node().parentNode);yn.offsetLeft=Kn.x,yn.offsetTop=Kn.y}kr.title.hasOwnProperty("standoff")&&(yn.pad=0)}return i.draw(Ir,nn+"title",{propContainer:kr,propName:kr._name+".title.text",placeholder:Qr._dfltTitle[Xr],avoid:yn,transform:cn,attributes:{x:un,y:Zr,"text-anchor":"middle"}})}(Ie,be)}),e.syncOrAsync(Sr)}}function Kr(Ir){var kr=Ue+(Ir||"tick");return bt[kr]||(bt[kr]=function(rn,Qr){var nn,Xr,Nr,Br;return rn._selections[Qr].size()?(nn=1/0,Xr=-1/0,Nr=1/0,Br=-1/0,rn._selections[Qr].each(function(){var on=et(this),cn=s.bBox(on.node().parentNode);nn=Math.min(nn,cn.top),Xr=Math.max(Xr,cn.bottom),Nr=Math.min(Nr,cn.left),Br=Math.max(Br,cn.right)})):(nn=0,Xr=0,Nr=0,Br=0),{top:nn,bottom:Xr,left:Nr,right:Br,height:Xr-nn,width:Br-Nr}}(be,kr)),bt[kr]}},B.getTickSigns=function(Ie){var be=Ie._id.charAt(0),We={x:"top",y:"right"}[be],Ge=Ie.side===We?1:-1,st=[-1,1,Ge,-Ge];return Ie.ticks!=="inside"==(be==="x")&&(st=st.map(function(ot){return-ot})),Ie.side&&st.push({l:-1,t:-1,r:1,b:1}[Ie.side.charAt(0)]),st},B.makeTransTickFn=function(Ie){return Ie._id.charAt(0)==="x"?function(be){return o(Ie._offset+Ie.l2p(be.x),0)}:function(be){return o(0,Ie._offset+Ie.l2p(be.x))}},B.makeTransTickLabelFn=function(Ie){var be=function(st){var ot=st.ticklabelposition||"",Ce=function(Et){return ot.indexOf(Et)!==-1},Ue=Ce("top"),Ye=Ce("left"),xe=Ce("right"),Ee=Ce("bottom"),Je=Ce("inside"),it=Ee||Ye||Ue||xe;if(!it&&!Je)return[0,0];var ht=st.side,ct=it?(st.tickwidth||0)/2:0,mt=3,bt=st.tickfont?st.tickfont.size:12;return(Ee||Ue)&&(ct+=bt*O,mt+=(st.linewidth||0)/2),(Ye||xe)&&(ct+=(st.linewidth||0)/2,mt+=3),Je&&ht==="top"&&(mt-=bt*(1-O)),(Ye||Ue)&&(ct=-ct),ht!=="bottom"&&ht!=="right"||(mt=-mt),[it?ct:0,Je?mt:0]}(Ie),We=be[0],Ge=be[1];return Ie._id.charAt(0)==="x"?function(st){return o(We+Ie._offset+Ie.l2p(Pe(st)),Ge)}:function(st){return o(Ge,We+Ie._offset+Ie.l2p(Pe(st)))}},B.makeTickPath=function(Ie,be,We,Ge){Ge=Ge!==void 0?Ge:Ie.ticklen;var st=Ie._id.charAt(0),ot=(Ie.linewidth||1)/2;return st==="x"?"M0,"+(be+ot*We)+"v"+Ge*We:"M"+(be+ot*We)+",0h"+Ge*We},B.makeLabelFns=function(Ie,be,We){var Ge=Ie.ticklabelposition||"",st=function(Ne){return Ge.indexOf(Ne)!==-1},ot=st("top"),Ce=st("left"),Ue=st("right"),Ye=st("bottom")||Ce||ot||Ue,xe=st("inside"),Ee=Ge==="inside"&&Ie.ticks==="inside"||!xe&&Ie.ticks==="outside"&&Ie.tickson!=="boundaries",Je=0,it=0,ht=Ee?Ie.ticklen:0;if(xe?ht*=-1:Ye&&(ht=0),Ee&&(Je+=ht,We)){var ct=e.deg2rad(We);Je=ht*Math.cos(ct)+1,it=ht*Math.sin(ct)}Ie.showticklabels&&(Ee||Ie.showline)&&(Je+=.2*Ie.tickfont.size);var mt,bt,Et,Mt,_t,xt={labelStandoff:Je+=(Ie.linewidth||1)/2*(xe?-1:1),labelShift:it},At=0,It=Ie.side,Nt=Ie._id.charAt(0),Ot=Ie.tickangle;if(Nt==="x")Mt=(_t=!xe&&It==="bottom"||xe&&It==="top")?1:-1,xe&&(Mt*=-1),mt=it*Mt,bt=be+Je*Mt,Et=_t?1:-.2,Math.abs(Ot)===90&&(xe?Et+=V:Et=Ot===-90&&It==="bottom"?O:Ot===90&&It==="top"?V:.5,At=V/2*(Ot/90)),xt.xFn=function(Ne){return Ne.dx+mt+At*Ne.fontSize},xt.yFn=function(Ne){return Ne.dy+bt+Ne.fontSize*Et},xt.anchorFn=function(Ne,ut){if(Ye){if(Ce)return"end";if(Ue)return"start"}return h(ut)&&ut!==0&&ut!==180?ut*Mt<0!==xe?"end":"start":"middle"},xt.heightFn=function(Ne,ut,wt){return ut<-60||ut>60?-.5*wt:Ie.side==="top"!==xe?-wt:0};else if(Nt==="y"){if(Mt=(_t=!xe&&It==="left"||xe&&It==="right")?1:-1,xe&&(Mt*=-1),mt=Je,bt=it*Mt,Et=0,xe||Math.abs(Ot)!==90||(Et=Ot===-90&&It==="left"||Ot===90&&It==="right"?O:.5),xe){var Yt=h(Ot)?+Ot:0;if(Yt!==0){var Pt=e.deg2rad(Yt);At=Math.abs(Math.sin(Pt))*O*Mt,Et=0}}xt.xFn=function(Ne){return Ne.dx+be-(mt+Ne.fontSize*Et)*Mt+At*Ne.fontSize},xt.yFn=function(Ne){return Ne.dy+bt+Ne.fontSize*V},xt.anchorFn=function(Ne,ut){return h(ut)&&Math.abs(ut)===90?"middle":_t?"end":"start"},xt.heightFn=function(Ne,ut,wt){return Ie.side==="right"&&(ut*=-1),ut<-30?-wt:ut<30?-.5*wt:0}}return xt},B.drawTicks=function(Ie,be,We){We=We||{};var Ge=be._id+"tick",st=We.vals;be.ticklabelmode==="period"&&(st=st.slice()).shift();var ot=We.layer.selectAll("path."+Ge).data(be.ticks?st:[],Fe);ot.exit().remove(),ot.enter().append("path").classed(Ge,1).classed("ticks",1).classed("crisp",We.crisp!==!1).call(u.stroke,be.tickcolor).style("stroke-width",s.crispRound(Ie,be.tickwidth,1)+"px").attr("d",We.path),ot.attr("transform",We.transFn)},B.drawGrid=function(Ie,be,We){We=We||{};var Ge=be._id+"grid",st=We.vals,ot=We.counterAxis;if(be.showgrid===!1)st=[];else if(ot&&B.shouldShowZeroLine(Ie,be,ot))for(var Ce=be.tickmode==="array",Ue=0;Ue<st.length;Ue++){var Ye=st[Ue].x;if(Ce?!Ye:Math.abs(Ye)<be.dtick/100){if(st=st.slice(0,Ue).concat(st.slice(Ue+1)),!Ce)break;Ue--}}var xe=We.layer.selectAll("path."+Ge).data(st,Fe);xe.exit().remove(),xe.enter().append("path").classed(Ge,1).classed("crisp",We.crisp!==!1),be._gw=s.crispRound(Ie,be.gridwidth,1),xe.attr("transform",We.transFn).attr("d",We.path).call(u.stroke,be.gridcolor||"#ddd").style("stroke-width",be._gw+"px"),typeof We.path=="function"&&xe.attr("d",We.path)},B.drawZeroLine=function(Ie,be,We){We=We||We;var Ge=be._id+"zl",st=B.shouldShowZeroLine(Ie,be,We.counterAxis),ot=We.layer.selectAll("path."+Ge).data(st?[{x:0,id:be._id}]:[]);ot.exit().remove(),ot.enter().append("path").classed(Ge,1).classed("zl",1).classed("crisp",We.crisp!==!1).each(function(){We.layer.selectAll("path").sort(function(Ce,Ue){return H(Ce.id,Ue.id)})}),ot.attr("transform",We.transFn).attr("d",We.path).call(u.stroke,be.zerolinecolor||u.defaultLine).style("stroke-width",s.crispRound(Ie,be.zerolinewidth,be._gw||1)+"px")},B.drawLabels=function(Ie,be,We){We=We||{};var Ge=Ie._fullLayout,st=be._id,ot=st.charAt(0),Ce=We.cls||st+"tick",Ue=We.vals,Ye=We.labelFns,xe=We.secondary?0:be.tickangle,Ee=(be._prevTickAngles||{})[Ce],Je=We.layer.selectAll("g."+Ce).data(be.showticklabels?Ue:[],Fe),it=[];function ht(Mt,_t){var xt=(be.ticklabelposition||"").indexOf("inside")!==-1;Mt.each(function(At){var It=t.select(this),Nt=It.select(".text-math-group"),Ot=Ye.anchorFn(At,_t),Yt=We.transFn.call(It.node(),At)+(h(_t)&&+_t!=0?" rotate("+_t+","+Ye.xFn(At)+","+(Ye.yFn(At)-At.fontSize/2)+")":""),Pt=r.lineCount(It),Ne=J*At.fontSize,ut=Ye.heightFn(At,h(_t)?+_t:0,(Pt-1)*Ne);if(ut&&(Yt+=o(0,ut)),Nt.empty()){var wt=It.select("text");wt.attr({transform:Yt,"text-anchor":Ot}),xt&&(wt.style({opacity:100}),be._hideOutOfRangeInsideTickLabels&&be._hideOutOfRangeInsideTickLabels())}else{var Bt=s.bBox(Nt.node()).width*{end:-.5,start:.5}[Ot];Nt.attr("transform",Yt+o(Bt,0))}})}Je.enter().append("g").classed(Ce,1).append("text").attr("text-anchor","middle").each(function(Mt){var _t=t.select(this),xt=Ie._promises.length;_t.call(r.positionText,Ye.xFn(Mt),Ye.yFn(Mt)).call(s.font,Mt.font,Mt.fontSize,Mt.fontColor).text(Mt.text).call(r.convertToTspans,Ie),Ie._promises[xt]?it.push(Ie._promises.pop().then(function(){ht(_t,xe)})):ht(_t,xe)}),Je.exit().remove(),We.repositionOnUpdate&&Je.each(function(Mt){t.select(this).select("text").call(r.positionText,Ye.xFn(Mt),Ye.yFn(Mt))}),be._hideOutOfRangeInsideTickLabels=void 0,(be.ticklabelposition||"").indexOf("inside")!==-1&&(be._hideOutOfRangeInsideTickLabels=function(){var Mt=e.simpleMap(be.range,be.r2l),_t=be.l2p(Mt[0]),xt=be.l2p(Mt[1]),At=Math.min(_t,xt)+be._offset,It=Math.max(_t,xt)+be._offset,Nt=be._id.charAt(0)==="x";Je.each(function(Ot){var Yt=t.select(this);if(Yt.select(".text-math-group").empty()){var Pt=s.bBox(Yt.node()),Ne=!1;Nt?(Pt.right>It||Pt.left<At)&&(Ne=!0):(Pt.bottom>It||Pt.top+(be.tickangle?0:Ot.fontSize/4)<At)&&(Ne=!0),Ne&&Yt.select("text").style({opacity:0})}})}),ht(Je,Ee+1?Ee:xe);var ct=null;be._selections&&(be._selections[Ce]=Je);var mt=[function(){return it.length&&Promise.all(it)}];be.automargin&&Ge._redrawFromAutoMarginCount&&Ee===90?(ct=90,mt.push(function(){ht(Je,Ee)})):mt.push(function(){if(ht(Je,xe),Ue.length&&ot==="x"&&!h(xe)&&(be.type!=="log"||String(be.dtick).charAt(0)!=="D")){ct=0;var Mt,_t=0,xt=[];if(Je.each(function(or){_t=Math.max(_t,or.fontSize);var zt=be.l2p(or.x),Qt=et(this),cr=s.bBox(Qt.node());xt.push({top:0,bottom:10,height:10,left:zt-cr.width/2,right:zt+cr.width/2+2,width:cr.width+2})}),be.tickson!=="boundaries"&&!be.showdividers||We.secondary){var At=Ue.length,It=Math.abs((Ue[At-1].x-Ue[0].x)*be._m)/(At-1),Nt=be.ticklabelposition||"",Ot=function(or){return Nt.indexOf(or)!==-1},Yt=Ot("top"),Pt=Ot("left"),Ne=Ot("right"),ut=Ot("bottom")||Pt||Yt||Ne?(be.tickwidth||0)+6:0,wt=It<2.5*_t||be.type==="multicategory";for(Mt=0;Mt<xt.length-1;Mt++)if(e.bBoxIntersect(xt[Mt],xt[Mt+1],ut)){ct=wt?90:30;break}}else{var Bt=2;for(be.ticks&&(Bt+=be.tickwidth/2),Mt=0;Mt<xt.length;Mt++){var Jt=Ue[Mt].xbnd,er=xt[Mt];if(Jt[0]!==null&&er.left-be.l2p(Jt[0])<Bt||Jt[1]!==null&&be.l2p(Jt[1])-er.right<Bt){ct=90;break}}}ct&&ht(Je,ct)}}),be._tickAngles&&mt.push(function(){be._tickAngles[Ce]=ct===null?h(xe)?xe:0:ct});var bt=be._anchorAxis;bt&&bt.autorange&&(be.ticklabelposition||"").indexOf("inside")!==-1&&!j(Ge,be._id)&&(Ge._insideTickLabelsAutorange||(Ge._insideTickLabelsAutorange={}),Ge._insideTickLabelsAutorange[bt._name+".autorange"]=bt.autorange,mt.push(function(){Je.each(function(Mt,_t){var xt=et(this);be._vals[_t].bb=s.bBox(xt.node())})}));var Et=e.syncOrAsync(mt);return Et&&Et.then&&Ie._promises.push(Et),Et},B.getPxPosition=function(Ie,be){var We,Ge=Ie._fullLayout._size,st=be._id.charAt(0),ot=be.side;return be.anchor!=="free"?We=be._anchorAxis:st==="x"?We={_offset:Ge.t+(1-(be.position||0))*Ge.h,_length:0}:st==="y"&&(We={_offset:Ge.l+(be.position||0)*Ge.w,_length:0}),ot==="top"||ot==="left"?We._offset:ot==="bottom"||ot==="right"?We._offset+We._length:void 0},B.shouldShowZeroLine=function(Ie,be,We){var Ge=e.simpleMap(be.range,be.r2l);return Ge[0]*Ge[1]<=0&&be.zeroline&&(be.type==="linear"||be.type==="-")&&!(be.rangebreaks&&be.maskBreaks(0)===I)&&(He(be,0)||!function(st,ot,Ce,Ue){var Ye=Ce._mainAxis;if(!Ye)return;var xe=st._fullLayout,Ee=ot._id.charAt(0),Je=B.counterLetter(ot._id),it=ot._offset+(Math.abs(Ue[0])<Math.abs(Ue[1])==(Ee==="x")?0:ot._length);function ht(Mt){if(!Mt.showline||!Mt.linewidth)return!1;var _t=Math.max((Mt.linewidth+ot.zerolinewidth)/2,1);function xt(Nt){return typeof Nt=="number"&&Math.abs(Nt-it)<_t}if(xt(Mt._mainLinePosition)||xt(Mt._mainMirrorPosition))return!0;var At=Mt._linepositions||{};for(var It in At)if(xt(At[It][0])||xt(At[It][1]))return!0}var ct=xe._plots[Ce._mainSubplot];if(!(ct.mainplotinfo||ct).overlays.length)return ht(Ce);for(var mt=B.list(st,Je),bt=0;bt<mt.length;bt++){var Et=mt[bt];if(Et._mainAxis===Ye&&ht(Et))return!0}}(Ie,be,We,Ge)||function(st,ot){for(var Ce=st._fullData,Ue=ot._mainSubplot,Ye=ot._id.charAt(0),xe=0;xe<Ce.length;xe++){var Ee=Ce[xe];if(Ee.visible===!0&&Ee.xaxis+Ee.yaxis===Ue&&(l.traceIs(Ee,"bar-like")&&Ee.orientation==={x:"h",y:"v"}[Ye]||Ee.fill&&Ee.fill.charAt(Ee.fill.length-1)===Ye))return!0}return!1}(Ie,be))},B.clipEnds=function(Ie,be){return be.filter(function(We){return He(Ie,We.x)})},B.allowAutoMargin=function(Ie){for(var be=B.list(Ie,"",!0),We=0;We<be.length;We++){var Ge=be[We];Ge.automargin&&(p.allowAutoMargin(Ie,Re(Ge)),Ge.mirror&&p.allowAutoMargin(Ie,Ze(Ge))),l.getComponentMethod("rangeslider","isVisible")(Ge)&&p.allowAutoMargin(Ie,Ke(Ge))}},B.swap=function(Ie,be){for(var We=function(st,ot){var Ce,Ue,Ye=[];for(Ce=0;Ce<ot.length;Ce++){var xe=[],Ee=st._fullData[ot[Ce]].xaxis,Je=st._fullData[ot[Ce]].yaxis;if(Ee&&Je){for(Ue=0;Ue<Ye.length;Ue++)Ye[Ue].x.indexOf(Ee)===-1&&Ye[Ue].y.indexOf(Je)===-1||xe.push(Ue);if(xe.length){var it,ht=Ye[xe[0]];if(xe.length>1)for(Ue=1;Ue<xe.length;Ue++)it=Ye[xe[Ue]],$e(ht.x,it.x),$e(ht.y,it.y);$e(ht.x,[Ee]),$e(ht.y,[Je])}else Ye.push({x:[Ee],y:[Je]})}}return Ye}(Ie,be),Ge=0;Ge<We.length;Ge++)rt(Ie,We[Ge].x,We[Ge].y)}},{"../../components/color":643,"../../components/drawing":665,"../../components/titles":738,"../../constants/alignment":745,"../../constants/numerical":753,"../../lib":778,"../../lib/svg_text_utils":803,"../../plots/plots":891,"../../registry":911,"./autorange":827,"./axis_autotype":829,"./axis_ids":831,"./clean_ticks":833,"./layout_attributes":842,"./set_convert":848,d3:169,"fast-isnumeric":241}],829:[function(n,z,q){"use strict";var t=n("fast-isnumeric"),h=n("../../lib"),p=n("../../constants/numerical").BADNUM,l=h.isArrayOrTypedArray,e=h.isDateTime,o=h.cleanNumber,r=Math.round;function i(s,a){return a?t(s):typeof s=="number"}function u(s){return Math.max(1,(s-1)/1e3)}z.exports=function(s,a,c){var f=s,g=c.noMultiCategory;if(l(f)&&!f.length)return"-";if(!g&&function(T){return l(T[0])&&l(T[1])}(f))return"multicategory";if(g&&Array.isArray(f[0])){for(var d=[],m=0;m<f.length;m++)if(l(f[m]))for(var y=0;y<f[m].length;y++)d.push(f[m][y]);f=d}if(function(T,w){for(var A=T.length,E=u(A),M=0,b=0,_={},S=0;S<A;S+=E){var C=r(S),k=T[C],L=String(k);_[L]||(_[L]=1,e(k,w)&&M++,t(k)&&b++)}return M>2*b}(f,a))return"date";var v=c.autotypenumbers!=="strict";return function(T,w){for(var A=T.length,E=u(A),M=0,b=0,_={},S=0;S<A;S+=E){var C=r(S),k=T[C],L=String(k);if(!_[L]){_[L]=1;var I=typeof k;I==="boolean"?b++:(w?o(k)!==p:I==="number")?M++:I==="string"&&b++}}return b>2*M}(f,v)?"category":function(T,w){for(var A=T.length,E=0;E<A;E++)if(i(T[E],w))return!0;return!1}(f,v)?"linear":"-"}},{"../../constants/numerical":753,"../../lib":778,"fast-isnumeric":241}],830:[function(n,z,q){"use strict";var t=n("fast-isnumeric"),h=n("../../registry"),p=n("../../lib"),l=n("../array_container_defaults"),e=n("./layout_attributes"),o=n("./tick_value_defaults"),r=n("./tick_mark_defaults"),i=n("./tick_label_defaults"),u=n("./category_order_defaults"),s=n("./line_grid_defaults"),a=n("./set_convert"),c=n("./constants").WEEKDAY_PATTERN,f=n("./constants").HOUR_PATTERN;function g(y,v,T){function w(k,L){return p.coerce(y,v,e.rangebreaks,k,L)}if(w("enabled")){var A=w("bounds");if(A&&A.length>=2){var E,M,b="";if(A.length===2){for(E=0;E<2;E++)if(M=m(A[E])){b=c;break}}var _=w("pattern",b);if(_===c)for(E=0;E<2;E++)(M=m(A[E]))&&(v.bounds[E]=A[E]=M-1);if(_)for(E=0;E<2;E++)switch(M=A[E],_){case c:if(!t(M)||(M=+M)!==Math.floor(M)||M<0||M>=7)return void(v.enabled=!1);v.bounds[E]=A[E]=M;break;case f:if(!t(M)||(M=+M)<0||M>24)return void(v.enabled=!1);v.bounds[E]=A[E]=M}if(T.autorange===!1){var S=T.range;if(S[0]<S[1]){if(A[0]<S[0]&&A[1]>S[1])return void(v.enabled=!1)}else if(A[0]>S[0]&&A[1]<S[1])return void(v.enabled=!1)}}else{var C=w("values");if(!C||!C.length)return void(v.enabled=!1);w("dvalue")}}}z.exports=function(y,v,T,w,A){var E,M=w.letter,b=w.font||{},_=w.splomStash||{},S=T("visible",!w.visibleDflt),C=v._template||{},k=v.type||C.type||"-";k==="date"&&(h.getComponentMethod("calendars","handleDefaults")(y,v,"calendar",w.calendar),w.noTicklabelmode||(E=T("ticklabelmode"))),w.noTicklabelposition&&k!=="multicategory"||p.coerce(y,v,{ticklabelposition:{valType:"enumerated",dflt:"outside",values:E==="period"?["outside","inside"]:M==="x"?["outside","inside","outside left","inside left","outside right","inside right"]:["outside","inside","outside top","inside top","outside bottom","inside bottom"]}},"ticklabelposition"),a(v,A);var L=!v.isValidRange(y.range);L&&w.reverseDflt&&(L="reversed"),!T("autorange",L)||k!=="linear"&&k!=="-"||T("rangemode"),T("range"),v.cleanRange(),u(y,v,T,w),k==="category"||w.noHover||T("hoverformat");var I=T("color"),R=I!==e.color.dflt?I:b.color,V=_.label||A._dfltTitle[M];if(i(y,v,T,k,w,{pass:1}),!S)return v;T("title.text",V),p.coerceFont(T,"title.font",{family:b.family,size:Math.round(1.2*b.size),color:R}),o(y,v,T,k),i(y,v,T,k,w,{pass:2}),r(y,v,T,w),s(y,v,T,{dfltColor:I,bgColor:w.bgColor,showGrid:w.showGrid,attributes:e}),(v.showline||v.ticks)&&T("mirror"),w.automargin&&T("automargin");var O,J=k==="multicategory";if(w.noTickson||k!=="category"&&!J||!v.ticks&&!v.showgrid||(J&&(O="boundaries"),T("tickson",O)==="boundaries"&&delete v.ticklabelposition),J&&T("showdividers")&&(T("dividercolor"),T("dividerwidth")),k==="date")if(l(y,v,{name:"rangebreaks",inclusionAttr:"enabled",handleItemDefaults:g}),v.rangebreaks.length){for(var D=0;D<v.rangebreaks.length;D++)if(v.rangebreaks[D].pattern===c){v._hasDayOfWeekBreaks=!0;break}if(a(v,A),A._has("scattergl")||A._has("splom"))for(var B=0;B<w.data.length;B++){var N=w.data[B];N.type!=="scattergl"&&N.type!=="splom"||(N.visible=!1,p.warn(N.type+" traces do not work on axes with rangebreaks. Setting trace "+N.index+" to `visible: false`."))}}else delete v.rangebreaks;return v};var d={sun:1,mon:2,tue:3,wed:4,thu:5,fri:6,sat:7};function m(y){if(typeof y=="string")return d[y.substr(0,3).toLowerCase()]}},{"../../lib":778,"../../registry":911,"../array_container_defaults":823,"./category_order_defaults":832,"./constants":834,"./layout_attributes":842,"./line_grid_defaults":844,"./set_convert":848,"./tick_label_defaults":849,"./tick_mark_defaults":850,"./tick_value_defaults":851,"fast-isnumeric":241}],831:[function(n,z,q){"use strict";var t=n("../../registry"),h=n("./constants");function p(l,e){if(e&&e.length){for(var o=0;o<e.length;o++)if(e[o][l])return!0}return!1}q.id2name=function(l){if(typeof l=="string"&&l.match(h.AX_ID_PATTERN)){var e=l.split(" ")[0].substr(1);return e==="1"&&(e=""),l.charAt(0)+"axis"+e}},q.name2id=function(l){if(l.match(h.AX_NAME_PATTERN)){var e=l.substr(5);return e==="1"&&(e=""),l.charAt(0)+e}},q.cleanId=function(l,e,o){var r=/( domain)$/.test(l);if(typeof l=="string"&&l.match(h.AX_ID_PATTERN)&&(!e||l.charAt(0)===e)&&(!r||o)){var i=l.split(" ")[0].substr(1).replace(/^0+/,"");return i==="1"&&(i=""),l.charAt(0)+i+(r&&o?" domain":"")}},q.list=function(l,e,o){var r=l._fullLayout;if(!r)return[];var i,u=q.listIds(l,e),s=new Array(u.length);for(i=0;i<u.length;i++){var a=u[i];s[i]=r[a.charAt(0)+"axis"+a.substr(1)]}if(!o){var c=r._subplots.gl3d||[];for(i=0;i<c.length;i++){var f=r[c[i]];e?s.push(f[e+"axis"]):s.push(f.xaxis,f.yaxis,f.zaxis)}}return s},q.listIds=function(l,e){var o=l._fullLayout;if(!o)return[];var r=o._subplots;return e?r[e+"axis"]:r.xaxis.concat(r.yaxis)},q.getFromId=function(l,e,o){var r=l._fullLayout;return e=e===void 0||typeof e!="string"?e:e.replace(" domain",""),o==="x"?e=e.replace(/y[0-9]*/,""):o==="y"&&(e=e.replace(/x[0-9]*/,"")),r[q.id2name(e)]},q.getFromTrace=function(l,e,o){var r=l._fullLayout,i=null;if(t.traceIs(e,"gl3d")){var u=e.scene;u.substr(0,5)==="scene"&&(i=r[u][o+"axis"])}else i=q.getFromId(l,e[o+"axis"]||o);return i},q.idSort=function(l,e){var o=l.charAt(0),r=e.charAt(0);return o!==r?o>r?1:-1:+(l.substr(1)||1)-+(e.substr(1)||1)},q.ref2id=function(l){return!!/^[xyz]/.test(l)&&l.split(" ")[0]},q.isLinked=function(l,e){return p(e,l._axisMatchGroups)||p(e,l._axisConstraintGroups)}},{"../../registry":911,"./constants":834}],832:[function(n,z,q){"use strict";z.exports=function(t,h,p,l){if(h.type==="category"){var e,o=t.categoryarray,r=Array.isArray(o)&&o.length>0;r&&(e="array");var i,u=p("categoryorder",e);u==="array"&&(i=p("categoryarray")),r||u!=="array"||(u=h.categoryorder="trace"),u==="trace"?h._initialCategories=[]:u==="array"?h._initialCategories=i.slice():(i=function(s,a){var c,f,g,d=a.dataAttr||s._id.charAt(0),m={};if(a.axData)c=a.axData;else for(c=[],f=0;f<a.data.length;f++){var y=a.data[f];y[d+"axis"]===s._id&&c.push(y)}for(f=0;f<c.length;f++){var v=c[f][d];for(g=0;g<v.length;g++){var T=v[g];T!=null&&(m[T]=1)}}return Object.keys(m)}(h,l).sort(),u==="category ascending"?h._initialCategories=i:u==="category descending"&&(h._initialCategories=i.reverse()))}}},{}],833:[function(n,z,q){"use strict";var t=n("fast-isnumeric"),h=n("../../lib"),p=n("../../constants/numerical"),l=p.ONEDAY,e=p.ONEWEEK;q.dtick=function(o,r){var i=r==="log",u=r==="date",s=r==="category",a=u?l:1;if(!o)return a;if(t(o))return(o=Number(o))<=0?a:s?Math.max(1,Math.round(o)):u?Math.max(.1,o):o;if(typeof o!="string"||!u&&!i)return a;var c=o.charAt(0),f=o.substr(1);return(f=t(f)?Number(f):0)<=0||!(u&&c==="M"&&f===Math.round(f)||i&&c==="L"||i&&c==="D"&&(f===1||f===2))?a:o},q.tick0=function(o,r,i,u){return r==="date"?h.cleanDate(o,h.dateTick0(i,u%e==0?1:0)):u!=="D1"&&u!=="D2"?t(o)?Number(o):0:void 0}},{"../../constants/numerical":753,"../../lib":778,"fast-isnumeric":241}],834:[function(n,z,q){"use strict";var t=n("../../lib/regex").counter;z.exports={idRegex:{x:t("x","( domain)?"),y:t("y","( domain)?")},attrRegex:t("[xy]axis"),xAxisMatch:t("xaxis"),yAxisMatch:t("yaxis"),AX_ID_PATTERN:/^[xyz][0-9]*( domain)?$/,AX_NAME_PATTERN:/^[xyz]axis[0-9]*$/,SUBPLOT_PATTERN:/^x([0-9]*)y([0-9]*)$/,HOUR_PATTERN:"hour",WEEKDAY_PATTERN:"day of week",MINDRAG:8,MINSELECT:12,MINZOOM:20,DRAGGERSIZE:20,BENDPX:1.5,REDRAWDELAY:50,SELECTDELAY:100,SELECTID:"-select",DFLTRANGEX:[-1,6],DFLTRANGEY:[-1,4],traceLayerClasses:["imagelayer","heatmaplayer","contourcarpetlayer","contourlayer","funnellayer","waterfalllayer","barlayer","carpetlayer","violinlayer","boxlayer","ohlclayer","scattercarpetlayer","scatterlayer"],clipOnAxisFalseQuery:[".scatterlayer",".barlayer",".funnellayer",".waterfalllayer"],layerValue2layerClass:{"above traces":"above","below traces":"below"}}},{"../../lib/regex":795}],835:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("./autorange"),p=n("./axis_ids").id2name,l=n("./layout_attributes"),e=n("./scale_zoom"),o=n("./set_convert"),r=n("../../constants/numerical").ALMOST_EQUAL,i=n("../../constants/alignment").FROM_BL;function u(m,y,v){var T=v.axIds,w=v.layoutOut,A=v.hasImage,E=w._axisConstraintGroups,M=w._axisMatchGroups,b=y._id,_=b.charAt(0),S=((w._splomAxes||{})[_]||{})[b]||{},C=y._id,k=C.charAt(0)==="x";function L(Q,$){return t.coerce(m,y,l,Q,$)}y._matchGroup=null,y._constraintGroup=null,L("constrain",A?"domain":"range"),t.coerce(m,y,{constraintoward:{valType:"enumerated",values:k?["left","center","right"]:["bottom","middle","top"],dflt:k?"center":"middle"}},"constraintoward");var I,R,V=y.type,O=[];for(I=0;I<T.length;I++)(R=T[I])!==C&&w[p(R)].type===V&&O.push(R);var J=a(E,C);if(J){var D=[];for(I=0;I<O.length;I++)J[R=O[I]]||D.push(R);O=D}var B,N,F=O.length;F&&(m.matches||S.matches)&&(B=t.coerce(m,y,{matches:{valType:"enumerated",values:O,dflt:O.indexOf(S.matches)!==-1?S.matches:void 0}},"matches"));var H=A&&!k?y.anchor:void 0;if(F&&!B&&(m.scaleanchor||H)&&(N=t.coerce(m,y,{scaleanchor:{valType:"enumerated",values:O}},"scaleanchor",H)),B){y._matchGroup=c(M,C,B,1);var j=w[p(B)],G=s(w,y)/s(w,j);k!==(B.charAt(0)==="x")&&(G=(k?"x":"y")+G),c(E,C,B,G)}else m.matches&&T.indexOf(m.matches)!==-1&&t.warn("ignored "+y._name+'.matches: "'+m.matches+'" to avoid an infinite loop');if(N){var W=L("scaleratio");W||(W=y.scaleratio=1),c(E,C,N,W)}else m.scaleanchor&&T.indexOf(m.scaleanchor)!==-1&&t.warn("ignored "+y._name+'.scaleanchor: "'+m.scaleanchor+'" to avoid either an infinite loop and possibly inconsistent scaleratios, or because this axis declares a *matches* constraint.')}function s(m,y){var v=y.domain;return v||(v=m[p(y.overlaying)].domain),v[1]-v[0]}function a(m,y){for(var v=0;v<m.length;v++)if(m[v][y])return m[v];return null}function c(m,y,v,T){var w,A,E,M,b,_=a(m,y);_===null?((_={})[y]=1,b=m.length,m.push(_)):b=m.indexOf(_);var S=Object.keys(_);for(w=0;w<m.length;w++)if(E=m[w],w!==b&&E[v]){var C=E[v];for(A=0;A<S.length;A++)E[M=S[A]]=f(C,f(T,_[M]));return void m.splice(b,1)}if(T!==1)for(A=0;A<S.length;A++){var k=S[A];_[k]=f(T,_[k])}_[v]=1}function f(m,y){var v,T,w="",A="";typeof m=="string"&&(v=(w=m.match(/^[xy]*/)[0]).length,m=+m.substr(v)),typeof y=="string"&&(T=(A=y.match(/^[xy]*/)[0]).length,y=+y.substr(T));var E=m*y;return v||T?v&&T&&w.charAt(0)!==A.charAt(0)?v===T?E:(v>T?w.substr(T):A.substr(v))+E:w+A+m*y:E}function g(m,y){for(var v=y._size,T=v.h/v.w,w={},A=Object.keys(m),E=0;E<A.length;E++){var M=A[E],b=m[M];if(typeof b=="string"){var _=b.match(/^[xy]*/)[0],S=_.length;b=+b.substr(S);for(var C=_.charAt(0)==="y"?T:1/T,k=0;k<S;k++)b*=C}w[M]=b}return w}function d(m,y){var v=m._inputDomain,T=i[m.constraintoward],w=v[0]+(v[1]-v[0])*T;m.domain=m._input.domain=[w+(v[0]-w)/y,w+(v[1]-w)/y],m.setScale()}q.handleDefaults=function(m,y,v){var T,w,A,E,M,b,_,S,C=v.axIds,k=v.axHasImage,L=y._axisConstraintGroups=[],I=y._axisMatchGroups=[];for(T=0;T<C.length;T++)u(M=m[E=p(C[T])],b=y[E],{axIds:C,layoutOut:y,hasImage:k[E]});function R(j,G){for(T=0;T<j.length;T++)for(A in w=j[T])y[p(A)][G]=w}for(R(I,"_matchGroup"),T=0;T<L.length;T++)for(A in w=L[T])if((b=y[p(A)]).fixedrange){for(var V in w){var O=p(V);(m[O]||{}).fixedrange===!1&&t.warn("fixedrange was specified as false for axis "+O+" but was overridden because another axis in its constraint group has fixedrange true"),y[O].fixedrange=!0}break}for(T=0;T<L.length;){for(A in w=L[T]){(b=y[p(A)])._matchGroup&&Object.keys(b._matchGroup).length===Object.keys(w).length&&(L.splice(T,1),T--);break}T++}R(L,"_constraintGroup");var J=["constrain","range","autorange","rangemode","rangebreaks","categoryorder","categoryarray"],D=!1,B=!1;function N(){S=b[_],_==="rangebreaks"&&(B=b._hasDayOfWeekBreaks)}for(T=0;T<I.length;T++){w=I[T];for(var F=0;F<J.length;F++){var H;for(A in _=J[F],S=null,w)if(M=m[E=p(A)],b=y[E],_ in b){if(!b.matches&&(H=b,_ in M)){N();break}S===null&&_ in M&&N()}if(_==="range"&&S&&(D=!0),_==="autorange"&&S===null&&D&&(S=!1),S===null&&_ in H&&(S=H[_]),S!==null)for(A in w)(b=y[p(A)])[_]=_==="range"?S.slice():S,_==="rangebreaks"&&(b._hasDayOfWeekBreaks=B,o(b,y))}}},q.enforce=function(m){var y,v,T,w,A,E,M,b,_=m._fullLayout,S=_._axisConstraintGroups||[];for(y=0;y<S.length;y++){T=g(S[y],_);var C=Object.keys(T),k=1/0,L=0,I=1/0,R={},V={},O=!1;for(v=0;v<C.length;v++)V[w=C[v]]=A=_[p(w)],A._inputDomain?A.domain=A._inputDomain.slice():A._inputDomain=A.domain.slice(),A._inputRange||(A._inputRange=A.range.slice()),A.setScale(),R[w]=E=Math.abs(A._m)/T[w],k=Math.min(k,E),A.constrain!=="domain"&&A._constraintShrinkable||(I=Math.min(I,E)),delete A._constraintShrinkable,L=Math.max(L,E),A.constrain==="domain"&&(O=!0);if(!(k>r*L)||O){for(v=0;v<C.length;v++)if(E=R[w=C[v]],M=(A=V[w]).constrain,E!==I||M==="domain")if(b=E/I,M==="range")e(A,b);else{var J=A._inputDomain,D=(A.domain[1]-A.domain[0])/(J[1]-J[0]),B=(A.r2l(A.range[1])-A.r2l(A.range[0]))/(A.r2l(A._inputRange[1])-A.r2l(A._inputRange[0]));if((b/=D)*B<1){A.domain=A._input.domain=J.slice(),e(A,b);continue}if(B<1&&(A.range=A._input.range=A._inputRange.slice(),b*=B),A.autorange){var N=A.r2l(A.range[0]),F=A.r2l(A.range[1]),H=(N+F)/2,j=H,G=H,W=Math.abs(F-H),Q=H-W*b*1.0001,$=H+W*b*1.0001,ee=h.makePadFn(_,A,0),ie=h.makePadFn(_,A,1);d(A,b);var ae,oe,de=Math.abs(A._m),le=h.concatExtremes(m,A),fe=le.min,ue=le.max;for(oe=0;oe<fe.length;oe++)(ae=fe[oe].val-ee(fe[oe])/de)>Q&&ae<j&&(j=ae);for(oe=0;oe<ue.length;oe++)(ae=ue[oe].val+ie(ue[oe])/de)<$&&ae>G&&(G=ae);b/=(G-j)/(2*W),j=A.l2r(j),G=A.l2r(G),A.range=A._input.range=N<F?[j,G]:[G,j]}d(A,b)}}}},q.getAxisGroup=function(m,y){for(var v=m._axisMatchGroups,T=0;T<v.length;T++)if(v[T][y])return"g"+T;return y},q.clean=function(m,y){if(y._inputDomain){for(var v=!1,T=y._id,w=m._fullLayout._axisConstraintGroups,A=0;A<w.length;A++)if(w[A][T]){v=!0;break}v&&y.constrain==="domain"||(y._input.domain=y.domain=y._inputDomain,delete y._inputDomain)}}},{"../../constants/alignment":745,"../../constants/numerical":753,"../../lib":778,"./autorange":827,"./axis_ids":831,"./layout_attributes":842,"./scale_zoom":846,"./set_convert":848}],836:[function(n,z,q){"use strict";var t=n("d3"),h=n("tinycolor2"),p=n("has-passive-events"),l=n("../../registry"),e=n("../../lib"),o=e.strTranslate,r=n("../../lib/svg_text_utils"),i=n("../../components/color"),u=n("../../components/drawing"),s=n("../../components/fx"),a=n("./axes"),c=n("../../lib/setcursor"),f=n("../../components/dragelement"),g=n("../../components/dragelement/helpers"),d=g.selectingOrDrawing,m=g.freeMode,y=n("../../constants/alignment").FROM_TL,v=n("../../lib/clear_gl_canvases"),T=n("../../plot_api/subroutines").redrawReglTraces,w=n("../plots"),A=n("./axis_ids").getFromId,E=n("./select").prepSelect,M=n("./select").clearSelect,b=n("./select").selectOnClick,_=n("./scale_zoom"),S=n("./constants"),C=S.MINDRAG,k=S.MINZOOM,L=!0;function I(ie,ae,oe,de){var le=e.ensureSingle(ie.draglayer,ae,oe,function(fe){fe.classed("drag",!0).style({fill:"transparent","stroke-width":0}).attr("data-subplot",ie.id)});return le.call(c,de),le.node()}function R(ie,ae,oe,de,le,fe,ue){var we=I(ie,"rect",ae,oe);return t.select(we).call(u.setRect,de,le,fe,ue),we}function V(ie,ae){for(var oe=0;oe<ie.length;oe++)if(!ie[oe].fixedrange)return ae;return""}function O(ie,ae,oe,de,le){for(var fe=0;fe<ie.length;fe++){var ue=ie[fe];if(!ue.fixedrange)if(ue.rangebreaks){var we=ue._id.charAt(0)==="y",Ae=we?1-ae:ae,Se=we?1-oe:oe;de[ue._name+".range[0]"]=ue.l2r(ue.p2l(Ae*ue._length)),de[ue._name+".range[1]"]=ue.l2r(ue.p2l(Se*ue._length))}else{var ke=ue._rl[0],Me=ue._rl[1]-ke;de[ue._name+".range[0]"]=ue.l2r(ke+Me*ae),de[ue._name+".range[1]"]=ue.l2r(ke+Me*oe)}}if(le&&le.length){var ve=(ae+(1-oe))/2;O(le,ve,1-ve,de,[])}}function J(ie,ae){for(var oe=0;oe<ie.length;oe++){var de=ie[oe];if(!de.fixedrange)if(de.rangebreaks){var le=de._length,fe=(de.p2l(0+ae)-de.p2l(0)+(de.p2l(le+ae)-de.p2l(le)))/2;de.range=[de.l2r(de._rl[0]-fe),de.l2r(de._rl[1]-fe)]}else de.range=[de.l2r(de._rl[0]-ae/de._m),de.l2r(de._rl[1]-ae/de._m)]}}function D(ie){return 1-(ie>=0?Math.min(ie,.9):1/(1/Math.max(ie,-.3)+3.222))}function B(ie,ae,oe,de,le){return ie.append("path").attr("class","zoombox").style({fill:ae>.2?"rgba(0,0,0,0)":"rgba(255,255,255,0)","stroke-width":0}).attr("transform",o(oe,de)).attr("d",le+"Z")}function N(ie,ae,oe){return ie.append("path").attr("class","zoombox-corners").style({fill:i.background,stroke:i.defaultLine,"stroke-width":1,opacity:0}).attr("transform",o(ae,oe)).attr("d","M0,0Z")}function F(ie,ae,oe,de,le,fe){ie.attr("d",de+"M"+oe.l+","+oe.t+"v"+oe.h+"h"+oe.w+"v-"+oe.h+"h-"+oe.w+"Z"),H(ie,ae,le,fe)}function H(ie,ae,oe,de){oe||(ie.transition().style("fill",de>.2?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.3)").duration(200),ae.transition().style("opacity",1).duration(200))}function j(ie){t.select(ie).selectAll(".zoombox,.js-zoombox-backdrop,.js-zoombox-menu,.zoombox-corners").remove()}function G(ie){L&&ie.data&&ie._context.showTips&&(e.notifier(e._(ie,"Double-click to zoom back out"),"long"),L=!1)}function W(ie){var ae=Math.floor(Math.min(ie.b-ie.t,ie.r-ie.l,k)/2);return"M"+(ie.l-3.5)+","+(ie.t-.5+ae)+"h3v"+-ae+"h"+ae+"v-3h-"+(ae+3)+"ZM"+(ie.r+3.5)+","+(ie.t-.5+ae)+"h-3v"+-ae+"h"+-ae+"v-3h"+(ae+3)+"ZM"+(ie.r+3.5)+","+(ie.b+.5-ae)+"h-3v"+ae+"h"+-ae+"v3h"+(ae+3)+"ZM"+(ie.l-3.5)+","+(ie.b+.5-ae)+"h3v"+ae+"h"+ae+"v3h-"+(ae+3)+"Z"}function Q(ie,ae,oe,de,le){for(var fe,ue,we,Ae,Se=!1,ke={},Me={},ve=(le||{}).xaHash,ge=(le||{}).yaHash,De=0;De<ae.length;De++){var _e=ae[De];for(fe in oe)if(_e[fe]){for(we in _e)le&&(ve[we]||ge[we])||(we.charAt(0)==="x"?oe:de)[we]||(ke[we]=fe);for(ue in de)le&&(ve[ue]||ge[ue])||!_e[ue]||(Se=!0)}for(ue in de)if(_e[ue])for(Ae in _e)le&&(ve[Ae]||ge[Ae])||(Ae.charAt(0)==="x"?oe:de)[Ae]||(Me[Ae]=ue)}Se&&(e.extendFlat(ke,Me),Me={});var Pe={},Fe=[];for(we in ke){var ze=A(ie,we);Fe.push(ze),Pe[ze._id]=ze}var He={},et=[];for(Ae in Me){var Re=A(ie,Ae);et.push(Re),He[Re._id]=Re}return{xaHash:Pe,yaHash:He,xaxes:Fe,yaxes:et,xLinks:ke,yLinks:Me,isSubplotConstrained:Se}}function $(ie,ae){if(p){var oe=ie.onwheel!==void 0?"wheel":"mousewheel";ie._onwheel&&ie.removeEventListener(oe,ie._onwheel),ie._onwheel=ae,ie.addEventListener(oe,ae,{passive:!1})}else ie.onwheel!==void 0?ie.onwheel=ae:ie.onmousewheel!==void 0?ie.onmousewheel=ae:ie.isAddedWheelEvent||(ie.isAddedWheelEvent=!0,ie.addEventListener("wheel",ae,{passive:!1}))}function ee(ie){var ae=[];for(var oe in ie)ae.push(ie[oe]);return ae}z.exports={makeDragBox:function(ie,ae,oe,de,le,fe,ue,we){var Ae,Se,ke,Me,ve,ge,De,_e,Pe,Fe,ze,He,et,Re,Ze,Ke,$e,rt,at,lt,gt,Ie,be,We=ie._fullLayout._zoomlayer,Ge=ue+we==="nsew",st=(ue+we).length===1;function ot(){if(Ae=ae.xaxis,Se=ae.yaxis,Pe=Ae._length,Fe=Se._length,De=Ae._offset,_e=Se._offset,(ke={})[Ae._id]=Ae,(Me={})[Se._id]=Se,ue&&we)for(var Dt=ae.overlays,Ut=0;Ut<Dt.length;Ut++){var ur=Dt[Ut].xaxis;ke[ur._id]=ur;var Sr=Dt[Ut].yaxis;Me[Sr._id]=Sr}ve=ee(ke),ge=ee(Me),et=V(ve,we),Re=V(ge,ue),Ze=!Re&&!et,He=Q(ie,ie._fullLayout._axisMatchGroups,ke,Me);var Lr=(ze=Q(ie,ie._fullLayout._axisConstraintGroups,ke,Me,He)).isSubplotConstrained||He.isSubplotConstrained;Ke=we||Lr,$e=ue||Lr;var Hr=ie._fullLayout;rt=Hr._has("scattergl"),at=Hr._has("splom"),lt=Hr._has("svg")}ot();var Ce=function(Dt,Ut,ur){return Dt?Dt==="nsew"?ur?"":Ut==="pan"?"move":"crosshair":Dt.toLowerCase()+"-resize":"pointer"}(Re+et,ie._fullLayout.dragmode,Ge),Ue=R(ae,ue+we+"drag",Ce,oe,de,le,fe);if(Ze&&!Ge)return Ue.onmousedown=null,Ue.style.pointerEvents="none",Ue;var Ye,xe,Ee,Je,it,ht,ct,mt,bt,Et,Mt={element:Ue,gd:ie,plotinfo:ae};function _t(){Mt.plotinfo.selection=!1,M(ie)}function xt(Dt,Ut){var ur=Mt.gd;if(ur._fullLayout._activeShapeIndex>=0)ur._fullLayout._deactivateShape(ur);else{var Sr=ur._fullLayout.clickmode;if(j(ur),Dt!==2||st||Jt(),Ge)Sr.indexOf("select")>-1&&b(Ut,ur,ve,ge,ae.id,Mt),Sr.indexOf("event")>-1&&s.click(ur,Ut,ae.id);else if(Dt===1&&st){var Lr=ue?Se:Ae,Hr=ue==="s"||we==="w"?0:1,Kr=Lr._name+".range["+Hr+"]",Ir=function(Qr,nn){var Xr,Nr=Qr.range[nn],Br=Math.abs(Nr-Qr.range[1-nn]);return Qr.type==="date"?Nr:Qr.type==="log"?(Xr=Math.ceil(Math.max(0,-Math.log(Br)/Math.LN10))+3,t.format("."+Xr+"g")(Math.pow(10,Nr))):(Xr=Math.floor(Math.log(Math.abs(Nr))/Math.LN10)-Math.floor(Math.log(Br)/Math.LN10)+4,t.format("."+String(Xr)+"g")(Nr))}(Lr,Hr),kr="left",rn="middle";if(Lr.fixedrange)return;ue?(rn=ue==="n"?"top":"bottom",Lr.side==="right"&&(kr="right")):we==="e"&&(kr="right"),ur._context.showAxisRangeEntryBoxes&&t.select(Ue).call(r.makeEditable,{gd:ur,immediate:!0,background:ur._fullLayout.paper_bgcolor,text:String(Ir),fill:Lr.tickfont?Lr.tickfont.color:"#444",horizontalAlign:kr,verticalAlign:rn}).on("edit",function(Qr){var nn=Lr.d2r(Qr);nn!==void 0&&l.call("_guiRelayout",ur,Kr,nn)})}}}function At(Dt,Ut){if(ie._transitioningWithDuration)return!1;var ur=Math.max(0,Math.min(Pe,Ie*Dt+Ye)),Sr=Math.max(0,Math.min(Fe,be*Ut+xe)),Lr=Math.abs(ur-Ye),Hr=Math.abs(Sr-xe);function Kr(){ct="",Ee.r=Ee.l,Ee.t=Ee.b,bt.attr("d","M0,0Z")}if(Ee.l=Math.min(Ye,ur),Ee.r=Math.max(Ye,ur),Ee.t=Math.min(xe,Sr),Ee.b=Math.max(xe,Sr),ze.isSubplotConstrained)Lr>k||Hr>k?(ct="xy",Lr/Pe>Hr/Fe?(Hr=Lr*Fe/Pe,xe>Sr?Ee.t=xe-Hr:Ee.b=xe+Hr):(Lr=Hr*Pe/Fe,Ye>ur?Ee.l=Ye-Lr:Ee.r=Ye+Lr),bt.attr("d",W(Ee))):Kr();else if(He.isSubplotConstrained)if(Lr>k||Hr>k){ct="xy";var Ir=Math.min(Ee.l/Pe,(Fe-Ee.b)/Fe),kr=Math.max(Ee.r/Pe,(Fe-Ee.t)/Fe);Ee.l=Ir*Pe,Ee.r=kr*Pe,Ee.b=(1-Ir)*Fe,Ee.t=(1-kr)*Fe,bt.attr("d",W(Ee))}else Kr();else!Re||Hr<Math.min(Math.max(.6*Lr,C),k)?Lr<C||!et?Kr():(Ee.t=0,Ee.b=Fe,ct="x",bt.attr("d",function(rn,Qr){return"M"+(rn.l-.5)+","+(Qr-k-.5)+"h-3v"+(2*k+1)+"h3ZM"+(rn.r+.5)+","+(Qr-k-.5)+"h3v"+(2*k+1)+"h-3Z"}(Ee,xe))):!et||Lr<Math.min(.6*Hr,k)?(Ee.l=0,Ee.r=Pe,ct="y",bt.attr("d",function(rn,Qr){return"M"+(Qr-k-.5)+","+(rn.t-.5)+"v-3h"+(2*k+1)+"v3ZM"+(Qr-k-.5)+","+(rn.b+.5)+"v3h"+(2*k+1)+"v-3Z"}(Ee,Ye))):(ct="xy",bt.attr("d",W(Ee)));Ee.w=Ee.r-Ee.l,Ee.h=Ee.b-Ee.t,ct&&(Et=!0),ie._dragged=Et,F(mt,bt,Ee,it,ht,Je),It(),ie.emit("plotly_relayouting",gt),ht=!0}function It(){gt={},ct!=="xy"&&ct!=="x"||(O(ve,Ee.l/Pe,Ee.r/Pe,gt,ze.xaxes),wt("x",gt)),ct!=="xy"&&ct!=="y"||(O(ge,(Fe-Ee.b)/Fe,(Fe-Ee.t)/Fe,gt,ze.yaxes),wt("y",gt))}function Nt(){It(),j(ie),er(),G(ie)}Mt.prepFn=function(Dt,Ut,ur){var Sr=Mt.dragmode,Lr=ie._fullLayout.dragmode;Lr!==Sr&&(Mt.dragmode=Lr),ot(),Ie=ie._fullLayout._invScaleX,be=ie._fullLayout._invScaleY,Ze||(Ge?Dt.shiftKey?Lr==="pan"?Lr="zoom":d(Lr)||(Lr="pan"):Dt.ctrlKey&&(Lr="pan"):Lr="pan"),m(Lr)?Mt.minDrag=1:Mt.minDrag=void 0,d(Lr)?(Mt.xaxes=ve,Mt.yaxes=ge,E(Dt,Ut,ur,Mt,Lr)):(Mt.clickFn=xt,d(Sr)&&_t(),Ze||(Lr==="zoom"?(Mt.moveFn=At,Mt.doneFn=Nt,Mt.minDrag=1,function(Hr,Kr,Ir){var kr=Ue.getBoundingClientRect();Ye=Kr-kr.left,xe=Ir-kr.top,ie._fullLayout._calcInverseTransform(ie);var rn=e.apply3DTransform(ie._fullLayout._invTransform)(Ye,xe);Ye=rn[0],xe=rn[1],Ee={l:Ye,r:Ye,w:0,t:xe,b:xe,h:0},Je=ie._hmpixcount?ie._hmlumcount/ie._hmpixcount:h(ie._fullLayout.plot_bgcolor).getLuminance(),ht=!1,ct="xy",Et=!1,mt=B(We,Je,De,_e,it="M0,0H"+Pe+"V"+Fe+"H0V0"),bt=N(We,De,_e)}(0,Ut,ur)):Lr==="pan"&&(Mt.moveFn=ut,Mt.doneFn=er))),ie._fullLayout._redrag=function(){var Hr=ie._dragdata;if(Hr&&Hr.element===Ue){var Kr=ie._fullLayout.dragmode;d(Kr)||(ot(),or([0,0,Pe,Fe]),Mt.moveFn(Hr.dx,Hr.dy))}}},f.init(Mt);var Ot=[0,0,Pe,Fe],Yt=null,Pt=S.REDRAWDELAY,Ne=ae.mainplot?ie._fullLayout._plots[ae.mainplot]:ae;function ut(Dt,Ut){if(Dt*=Ie,Ut*=be,!ie._transitioningWithDuration){if(ie._fullLayout._replotting=!0,et==="ew"||Re==="ns"){var ur=et?-Dt:0,Sr=Re?-Ut:0;if(He.isSubplotConstrained){if(et&&Re){var Lr=(Dt/Pe-Ut/Fe)/2;ur=-(Dt=Lr*Pe),Sr=-(Ut=-Lr*Fe)}Re?ur=-Sr*Pe/Fe:Sr=-ur*Fe/Pe}return et&&(J(ve,Dt),wt("x")),Re&&(J(ge,Ut),wt("y")),or([ur,Sr,Pe,Fe]),Bt(),void ie.emit("plotly_relayouting",gt)}var Hr,Kr,Ir=et==="w"==(Re==="n")?1:-1;if(et&&Re&&(ze.isSubplotConstrained||He.isSubplotConstrained)){var kr=(Dt/Pe+Ir*Ut/Fe)/2;Dt=kr*Pe,Ut=Ir*kr*Fe}if(et==="w"?Dt=Xr(ve,0,Dt):et==="e"?Dt=Xr(ve,1,-Dt):et||(Dt=0),Re==="n"?Ut=Xr(ge,1,Ut):Re==="s"?Ut=Xr(ge,0,-Ut):Re||(Ut=0),Hr=et==="w"?Dt:0,Kr=Re==="n"?Ut:0,ze.isSubplotConstrained&&!He.isSubplotConstrained||He.isSubplotConstrained&&et&&Re&&Ir>0){var rn;if(He.isSubplotConstrained||!et&&Re.length===1){for(rn=0;rn<ve.length;rn++)ve[rn].range=ve[rn]._r.slice(),_(ve[rn],1-Ut/Fe);Hr=(Dt=Ut*Pe/Fe)/2}if(He.isSubplotConstrained||!Re&&et.length===1){for(rn=0;rn<ge.length;rn++)ge[rn].range=ge[rn]._r.slice(),_(ge[rn],1-Dt/Pe);Kr=(Ut=Dt*Fe/Pe)/2}}He.isSubplotConstrained&&Re||wt("x"),He.isSubplotConstrained&&et||wt("y");var Qr=Pe-Dt,nn=Fe-Ut;!He.isSubplotConstrained||et&&Re||(et?(Kr=Hr?0:Dt*Fe/Pe,nn=Qr*Fe/Pe):(Hr=Kr?0:Ut*Pe/Fe,Qr=nn*Pe/Fe)),or([Hr,Kr,Qr,nn]),Bt(),ie.emit("plotly_relayouting",gt)}function Xr(Nr,Br,on){for(var cn,un,Zr=1-Br,yn=0;yn<Nr.length;yn++){var In=Nr[yn];if(!In.fixedrange){cn=In,un=In._rl[Zr]+(In._rl[Br]-In._rl[Zr])/D(on/In._length);var Un=In.l2r(un);Un!==!1&&Un!==void 0&&(In.range[Br]=Un)}}return cn._length*(cn._rl[Br]-un)/(cn._rl[Br]-cn._rl[Zr])}}function wt(Dt,Ut){for(var ur=He.isSubplotConstrained?{x:ge,y:ve}[Dt]:He[Dt+"axes"],Sr=He.isSubplotConstrained?{x:ve,y:ge}[Dt]:[],Lr=0;Lr<ur.length;Lr++){var Hr=ur[Lr],Kr=Hr._id,Ir=He.xLinks[Kr]||He.yLinks[Kr],kr=Sr[0]||ke[Ir]||Me[Ir];kr&&(Ut?(Ut[Hr._name+".range[0]"]=Ut[kr._name+".range[0]"],Ut[Hr._name+".range[1]"]=Ut[kr._name+".range[1]"]):Hr.range=kr.range.slice())}}function Bt(){var Dt,Ut=[];function ur(Hr){for(Dt=0;Dt<Hr.length;Dt++)Hr[Dt].fixedrange||Ut.push(Hr[Dt]._id)}for(Ke&&(ur(ve),ur(ze.xaxes),ur(He.xaxes)),$e&&(ur(ge),ur(ze.yaxes),ur(He.yaxes)),gt={},Dt=0;Dt<Ut.length;Dt++){var Sr=Ut[Dt],Lr=A(ie,Sr);a.drawOne(ie,Lr,{skipTitle:!0}),gt[Lr._name+".range[0]"]=Lr.range[0],gt[Lr._name+".range[1]"]=Lr.range[1]}a.redrawComponents(ie,Ut)}function Jt(){if(!ie._transitioningWithDuration){var Dt=ie._context.doubleClick,Ut=[];et&&(Ut=Ut.concat(ve)),Re&&(Ut=Ut.concat(ge)),He.xaxes&&(Ut=Ut.concat(He.xaxes)),He.yaxes&&(Ut=Ut.concat(He.yaxes));var ur,Sr,Lr,Hr={};if(Dt==="reset+autosize"){for(Dt="autosize",Sr=0;Sr<Ut.length;Sr++)if((ur=Ut[Sr])._rangeInitial&&(ur.range[0]!==ur._rangeInitial[0]||ur.range[1]!==ur._rangeInitial[1])||!ur._rangeInitial&&!ur.autorange){Dt="reset";break}}if(Dt==="autosize")for(Sr=0;Sr<Ut.length;Sr++)(ur=Ut[Sr]).fixedrange||(Hr[ur._name+".autorange"]=!0);else if(Dt==="reset")for((et||ze.isSubplotConstrained)&&(Ut=Ut.concat(ze.xaxes)),Re&&!ze.isSubplotConstrained&&(Ut=Ut.concat(ze.yaxes)),ze.isSubplotConstrained&&(et?Re||(Ut=Ut.concat(ge)):Ut=Ut.concat(ve)),Sr=0;Sr<Ut.length;Sr++)(ur=Ut[Sr]).fixedrange||(ur._rangeInitial?(Lr=ur._rangeInitial,Hr[ur._name+".range[0]"]=Lr[0],Hr[ur._name+".range[1]"]=Lr[1]):Hr[ur._name+".autorange"]=!0);ie.emit("plotly_doubleclick",null),l.call("_guiRelayout",ie,Hr)}}function er(){or([0,0,Pe,Fe]),e.syncOrAsync([w.previousPromises,function(){ie._fullLayout._replotting=!1,l.call("_guiRelayout",ie,gt)}],ie)}function or(Dt){var Ut,ur,Sr,Lr,Hr=ie._fullLayout,Kr=Hr._plots,Ir=Hr._subplots.cartesian;if(at&&l.subplotsRegistry.splom.drag(ie),rt){for(Ut=0;Ut<Ir.length;Ut++)if(Sr=(ur=Kr[Ir[Ut]]).xaxis,Lr=ur.yaxis,ur._scene){var kr=e.simpleMap(Sr.range,Sr.r2l),rn=e.simpleMap(Lr.range,Lr.r2l);ur._scene.update({range:[kr[0],rn[0],kr[1],rn[1]]})}}if((at||rt)&&(v(ie),T(ie)),lt){var Qr=Dt[2]/Ae._length,nn=Dt[3]/Se._length;for(Ut=0;Ut<Ir.length;Ut++){Sr=(ur=Kr[Ir[Ut]]).xaxis,Lr=ur.yaxis;var Xr,Nr,Br,on,cn=(Ke||He.isSubplotConstrained)&&!Sr.fixedrange&&ke[Sr._id],un=($e||He.isSubplotConstrained)&&!Lr.fixedrange&&Me[Lr._id];if(cn?(Xr=Qr,Br=we||He.isSubplotConstrained?Dt[0]:cr(Sr,Xr)):He.xaHash[Sr._id]?(Xr=Qr,Br=Dt[0]*Sr._length/Ae._length):He.yaHash[Sr._id]?(Xr=nn,Br=Re==="ns"?-Dt[1]*Sr._length/Se._length:cr(Sr,Xr,{n:"top",s:"bottom"}[Re])):Br=Qt(Sr,Xr=zt(Sr,Qr,nn)),un?(Nr=nn,on=ue||He.isSubplotConstrained?Dt[1]:cr(Lr,Nr)):He.yaHash[Lr._id]?(Nr=nn,on=Dt[1]*Lr._length/Se._length):He.xaHash[Lr._id]?(Nr=Qr,on=et==="ew"?-Dt[0]*Lr._length/Ae._length:cr(Lr,Nr,{e:"right",w:"left"}[et])):on=Qt(Lr,Nr=zt(Lr,Qr,nn)),Xr||Nr){Xr||(Xr=1),Nr||(Nr=1);var Zr=Sr._offset-Br/Xr,yn=Lr._offset-on/Nr;ur.clipRect.call(u.setTranslate,Br,on).call(u.setScale,Xr,Nr),ur.plot.call(u.setTranslate,Zr,yn).call(u.setScale,1/Xr,1/Nr),Xr===ur.xScaleFactor&&Nr===ur.yScaleFactor||(u.setPointGroupScale(ur.zoomScalePts,Xr,Nr),u.setTextPointsScale(ur.zoomScaleTxt,Xr,Nr)),u.hideOutsideRangePoints(ur.clipOnAxisFalseTraces,ur),ur.xScaleFactor=Xr,ur.yScaleFactor=Nr}}}}function zt(Dt,Ut,ur){return Dt.fixedrange?0:Ke&&ze.xaHash[Dt._id]?Ut:$e&&(ze.isSubplotConstrained?ze.xaHash:ze.yaHash)[Dt._id]?ur:0}function Qt(Dt,Ut){return Ut?(Dt.range=Dt._r.slice(),_(Dt,Ut),cr(Dt,Ut)):0}function cr(Dt,Ut,ur){return Dt._length*(1-Ut)*y[ur||Dt.constraintoward||"middle"]}return ue.length*we.length!=1&&$(Ue,function(Dt){if(ie._context._scrollZoom.cartesian||ie._fullLayout._enablescrollzoom){if(_t(),ie._transitioningWithDuration)return Dt.preventDefault(),void Dt.stopPropagation();ot(),clearTimeout(Yt);var Ut=-Dt.deltaY;if(isFinite(Ut)||(Ut=Dt.wheelDelta/10),isFinite(Ut)){var ur,Sr=Math.exp(-Math.min(Math.max(Ut,-20),20)/200),Lr=Ne.draglayer.select(".nsewdrag").node().getBoundingClientRect(),Hr=(Dt.clientX-Lr.left)/Lr.width,Kr=(Lr.bottom-Dt.clientY)/Lr.height;if(Ke){for(we||(Hr=.5),ur=0;ur<ve.length;ur++)Ir(ve[ur],Hr,Sr);wt("x"),Ot[2]*=Sr,Ot[0]+=Ot[2]*Hr*(1/Sr-1)}if($e){for(ue||(Kr=.5),ur=0;ur<ge.length;ur++)Ir(ge[ur],Kr,Sr);wt("y"),Ot[3]*=Sr,Ot[1]+=Ot[3]*(1-Kr)*(1/Sr-1)}or(Ot),Bt(),ie.emit("plotly_relayouting",gt),Yt=setTimeout(function(){Ot=[0,0,Pe,Fe],er()},Pt),Dt.preventDefault()}else e.log("Did not find wheel motion attributes: ",Dt)}function Ir(kr,rn,Qr){if(!kr.fixedrange){var nn=e.simpleMap(kr.range,kr.r2l),Xr=nn[0]+(nn[1]-nn[0])*rn;kr.range=nn.map(function(Nr){return kr.l2r(Xr+(Nr-Xr)*Qr)})}}}),Ue},makeDragger:I,makeRectDragger:R,makeZoombox:B,makeCorners:N,updateZoombox:F,xyCorners:W,transitionZoombox:H,removeZoombox:j,showDoubleClickNotifier:G,attachWheelEventHandler:$}},{"../../components/color":643,"../../components/dragelement":662,"../../components/dragelement/helpers":661,"../../components/drawing":665,"../../components/fx":683,"../../constants/alignment":745,"../../lib":778,"../../lib/clear_gl_canvases":762,"../../lib/setcursor":799,"../../lib/svg_text_utils":803,"../../plot_api/subroutines":818,"../../registry":911,"../plots":891,"./axes":828,"./axis_ids":831,"./constants":834,"./scale_zoom":846,"./select":847,d3:169,"has-passive-events":441,tinycolor2:576}],837:[function(n,z,q){"use strict";var t=n("d3"),h=n("../../components/fx"),p=n("../../components/dragelement"),l=n("../../lib/setcursor"),e=n("./dragbox").makeDragBox,o=n("./constants").DRAGGERSIZE;q.initInteractions=function(r){var i=r._fullLayout;if(r._context.staticPlot)t.select(r).selectAll(".drag").remove();else if(i._has("cartesian")||i._has("splom")){Object.keys(i._plots||{}).sort(function(s,a){if((i._plots[s].mainplot&&!0)===(i._plots[a].mainplot&&!0)){var c=s.split("y"),f=a.split("y");return c[0]===f[0]?Number(c[1]||1)-Number(f[1]||1):Number(c[0]||1)-Number(f[0]||1)}return i._plots[s].mainplot?1:-1}).forEach(function(s){var a=i._plots[s],c=a.xaxis,f=a.yaxis;if(!a.mainplot){var g=e(r,a,c._offset,f._offset,c._length,f._length,"ns","ew");g.onmousemove=function(y){r._fullLayout._rehover=function(){r._fullLayout._hoversubplot===s&&r._fullLayout._plots[s]&&h.hover(r,y,s)},h.hover(r,y,s),r._fullLayout._lasthover=g,r._fullLayout._hoversubplot=s},g.onmouseout=function(y){r._dragging||(r._fullLayout._hoversubplot=null,p.unhover(r,y))},r._context.showAxisDragHandles&&(e(r,a,c._offset-o,f._offset-o,o,o,"n","w"),e(r,a,c._offset+c._length,f._offset-o,o,o,"n","e"),e(r,a,c._offset-o,f._offset+f._length,o,o,"s","w"),e(r,a,c._offset+c._length,f._offset+f._length,o,o,"s","e"))}if(r._context.showAxisDragHandles){if(s===c._mainSubplot){var d=c._mainLinePosition;c.side==="top"&&(d-=o),e(r,a,c._offset+.1*c._length,d,.8*c._length,o,"","ew"),e(r,a,c._offset,d,.1*c._length,o,"","w"),e(r,a,c._offset+.9*c._length,d,.1*c._length,o,"","e")}if(s===f._mainSubplot){var m=f._mainLinePosition;f.side!=="right"&&(m-=o),e(r,a,m,f._offset+.1*f._length,o,.8*f._length,"ns",""),e(r,a,m,f._offset+.9*f._length,o,.1*f._length,"s",""),e(r,a,m,f._offset,o,.1*f._length,"n","")}}});var u=i._hoverlayer.node();u.onmousemove=function(s){s.target=r._fullLayout._lasthover,h.hover(r,s,i._hoversubplot)},u.onclick=function(s){s.target=r._fullLayout._lasthover,h.click(r,s)},u.onmousedown=function(s){r._fullLayout._lasthover.onmousedown(s)},q.updateFx(r)}},q.updateFx=function(r){var i=r._fullLayout,u=i.dragmode==="pan"?"move":"crosshair";l(i._draggers,u)}},{"../../components/dragelement":662,"../../components/fx":683,"../../lib/setcursor":799,"./constants":834,"./dragbox":836,d3:169}],838:[function(n,z,q){"use strict";z.exports={clearOutlineControllers:function(t){var h=t._fullLayout._zoomlayer;h&&h.selectAll(".outline-controllers").remove()},clearSelect:function(t){var h=t._fullLayout._zoomlayer;h&&h.selectAll(".select-outline").remove(),t._fullLayout._drawing=!1}}},{}],839:[function(n,z,q){"use strict";var t=n("../../lib").strTranslate;function h(p,l){switch(p.type){case"log":return p.p2d(l);case"date":return p.p2r(l,0,p.calendar);default:return p.p2r(l)}}z.exports={p2r:h,r2p:function(p,l){switch(p.type){case"log":return p.d2p(l);case"date":return p.r2p(l,0,p.calendar);default:return p.r2p(l)}},axValue:function(p){var l=p._id.charAt(0)==="y"?1:0;return function(e){return h(p,e[l])}},getTransform:function(p){return t(p.xaxis._offset,p.yaxis._offset)}}},{"../../lib":778}],840:[function(n,z,q){"use strict";var t=n("../../registry"),h=n("../../lib"),p=n("./axis_ids");z.exports=function(l){return function(e,o){var r=e[l];if(Array.isArray(r))for(var i=t.subplotsRegistry.cartesian,u=i.idRegex,s=o._subplots,a=s.xaxis,c=s.yaxis,f=s.cartesian,g=o._has("cartesian")||o._has("gl2d"),d=0;d<r.length;d++){var m=r[d];if(h.isPlainObject(m)){var y=p.cleanId(m.xref,"x",!1),v=p.cleanId(m.yref,"y",!1),T=u.x.test(y),w=u.y.test(v);if(T||w){g||h.pushUnique(o._basePlotModules,i);var A=!1;T&&a.indexOf(y)===-1&&(a.push(y),A=!0),w&&c.indexOf(v)===-1&&(c.push(v),A=!0),A&&T&&w&&f.push(y+v)}}}}}},{"../../lib":778,"../../registry":911,"./axis_ids":831}],841:[function(n,z,q){"use strict";var t=n("d3"),h=n("../../registry"),p=n("../../lib"),l=n("../plots"),e=n("../../components/drawing"),o=n("../get_data").getModuleCalcData,r=n("./axis_ids"),i=n("./constants"),u=n("../../constants/xmlns_namespaces"),s=p.ensureSingle;function a(m,y,v){return p.ensureSingle(m,y,v,function(T){T.datum(v)})}function c(m,y,v,T,w){for(var A,E,M,b=i.traceLayerClasses,_=m._fullLayout,S=_._modules,C=[],k=[],L=0;L<S.length;L++){var I=(A=S[L]).name,R=h.modules[I].categories;if(R.svg){var V=A.layerName||I+"layer",O=A.plot;M=(E=o(v,O))[0],v=E[1],M.length&&C.push({i:b.indexOf(V),className:V,plotMethod:O,cdModule:M}),R.zoomScale&&k.push("."+V)}}C.sort(function(B,N){return B.i-N.i});var J=y.plot.selectAll("g.mlayer").data(C,function(B){return B.className});if(J.enter().append("g").attr("class",function(B){return B.className}).classed("mlayer",!0).classed("rangeplot",y.isRangePlot),J.exit().remove(),J.order(),J.each(function(B){var N=t.select(this),F=B.className;B.plotMethod(m,y,B.cdModule,N,T,w),i.clipOnAxisFalseQuery.indexOf("."+F)===-1&&e.setClipUrl(N,y.layerClipId,m)}),_._has("scattergl")&&(A=h.getModule("scattergl"),M=o(v,A)[0],A.plot(m,y,M)),!m._context.staticPlot&&(y._hasClipOnAxisFalse&&(y.clipOnAxisFalseTraces=y.plot.selectAll(i.clipOnAxisFalseQuery.join(",")).selectAll(".trace")),k.length)){var D=y.plot.selectAll(k.join(",")).selectAll(".trace");y.zoomScalePts=D.selectAll("path.point"),y.zoomScaleTxt=D.selectAll(".textpoint")}}function f(m,y){var v=y.plotgroup,T=y.id,w=i.layerValue2layerClass[y.xaxis.layer],A=i.layerValue2layerClass[y.yaxis.layer],E=m._fullLayout._hasOnlyLargeSploms;if(y.mainplot){var M=y.mainplotinfo,b=M.plotgroup,_=T+"-x",S=T+"-y";y.gridlayer=M.gridlayer,y.zerolinelayer=M.zerolinelayer,s(M.overlinesBelow,"path",_),s(M.overlinesBelow,"path",S),s(M.overaxesBelow,"g",_),s(M.overaxesBelow,"g",S),y.plot=s(M.overplot,"g",T),s(M.overlinesAbove,"path",_),s(M.overlinesAbove,"path",S),s(M.overaxesAbove,"g",_),s(M.overaxesAbove,"g",S),y.xlines=b.select(".overlines-"+w).select("."+_),y.ylines=b.select(".overlines-"+A).select("."+S),y.xaxislayer=b.select(".overaxes-"+w).select("."+_),y.yaxislayer=b.select(".overaxes-"+A).select("."+S)}else if(E)y.xlines=s(v,"path","xlines-above"),y.ylines=s(v,"path","ylines-above"),y.xaxislayer=s(v,"g","xaxislayer-above"),y.yaxislayer=s(v,"g","yaxislayer-above");else{var C=s(v,"g","layer-subplot");y.shapelayer=s(C,"g","shapelayer"),y.imagelayer=s(C,"g","imagelayer"),y.gridlayer=s(v,"g","gridlayer"),y.zerolinelayer=s(v,"g","zerolinelayer"),s(v,"path","xlines-below"),s(v,"path","ylines-below"),y.overlinesBelow=s(v,"g","overlines-below"),s(v,"g","xaxislayer-below"),s(v,"g","yaxislayer-below"),y.overaxesBelow=s(v,"g","overaxes-below"),y.plot=s(v,"g","plot"),y.overplot=s(v,"g","overplot"),y.xlines=s(v,"path","xlines-above"),y.ylines=s(v,"path","ylines-above"),y.overlinesAbove=s(v,"g","overlines-above"),s(v,"g","xaxislayer-above"),s(v,"g","yaxislayer-above"),y.overaxesAbove=s(v,"g","overaxes-above"),y.xlines=v.select(".xlines-"+w),y.ylines=v.select(".ylines-"+A),y.xaxislayer=v.select(".xaxislayer-"+w),y.yaxislayer=v.select(".yaxislayer-"+A)}E||(a(y.gridlayer,"g",y.xaxis._id),a(y.gridlayer,"g",y.yaxis._id),y.gridlayer.selectAll("g").map(function(k){return k[0]}).sort(r.idSort)),y.xlines.style("fill","none").classed("crisp",!0),y.ylines.style("fill","none").classed("crisp",!0)}function g(m,y){if(m){var v={};for(var T in m.each(function(M){var b=M[0];t.select(this).remove(),d(b,y),v[b]=!0}),y._plots)for(var w=y._plots[T].overlays||[],A=0;A<w.length;A++){var E=w[A];v[E.id]&&E.plot.selectAll(".trace").remove()}}}function d(m,y){y._draggers.selectAll("g."+m).remove(),y._defs.select("#clip"+y._uid+m+"plot").remove()}q.name="cartesian",q.attr=["xaxis","yaxis"],q.idRoot=["x","y"],q.idRegex=i.idRegex,q.attrRegex=i.attrRegex,q.attributes=n("./attributes"),q.layoutAttributes=n("./layout_attributes"),q.supplyLayoutDefaults=n("./layout_defaults"),q.transitionAxes=n("./transition_axes"),q.finalizeSubplots=function(m,y){var v,T,w,A=y._subplots,E=A.xaxis,M=A.yaxis,b=A.cartesian,_=b.concat(A.gl2d||[]),S={},C={};for(v=0;v<_.length;v++){var k=_[v].split("y");S[k[0]]=1,C["y"+k[1]]=1}for(v=0;v<E.length;v++)S[T=E[v]]||(w=(m[r.id2name(T)]||{}).anchor,i.idRegex.y.test(w)||(w="y"),b.push(T+w),_.push(T+w),C[w]||(C[w]=1,p.pushUnique(M,w)));for(v=0;v<M.length;v++)C[w=M[v]]||(T=(m[r.id2name(w)]||{}).anchor,i.idRegex.x.test(T)||(T="x"),b.push(T+w),_.push(T+w),S[T]||(S[T]=1,p.pushUnique(E,T)));if(!_.length){for(var L in T="",w="",m)i.attrRegex.test(L)&&(L.charAt(0)==="x"?(!T||+L.substr(5)<+T.substr(5))&&(T=L):(!w||+L.substr(5)<+w.substr(5))&&(w=L));T=T?r.name2id(T):"x",w=w?r.name2id(w):"y",E.push(T),M.push(w),b.push(T+w)}},q.plot=function(m,y,v,T){var w,A=m._fullLayout,E=A._subplots.cartesian,M=m.calcdata;if(!Array.isArray(y))for(y=[],w=0;w<M.length;w++)y.push(w);for(w=0;w<E.length;w++){for(var b,_=E[w],S=A._plots[_],C=[],k=0;k<M.length;k++){var L=M[k],I=L[0].trace;I.xaxis+I.yaxis===_&&((y.indexOf(I.index)!==-1||I.carpet)&&(b&&b[0].trace.xaxis+b[0].trace.yaxis===_&&["tonextx","tonexty","tonext"].indexOf(I.fill)!==-1&&C.indexOf(b)===-1&&C.push(b),C.push(L)),b=L)}c(m,S,C,v,T)}},q.clean=function(m,y,v,T){var w,A,E,M=T._plots||{},b=y._plots||{},_=T._subplots||{};if(T._hasOnlyLargeSploms&&!y._hasOnlyLargeSploms)for(E in M)(w=M[E]).plotgroup&&w.plotgroup.remove();var S=T._has&&T._has("gl"),C=y._has&&y._has("gl");if(S&&!C)for(E in M)(w=M[E])._scene&&w._scene.destroy();if(_.xaxis&&_.yaxis){var k=r.listIds({_fullLayout:T});for(A=0;A<k.length;A++){var L=k[A];y[r.id2name(L)]||T._infolayer.selectAll(".g-"+L+"title").remove()}}var I=T._has&&T._has("cartesian"),R=y._has&&y._has("cartesian");if(I&&!R)g(T._cartesianlayer.selectAll(".subplot"),T),T._defs.selectAll(".axesclip").remove(),delete T._axisConstraintGroups,delete T._axisMatchGroups;else if(_.cartesian)for(A=0;A<_.cartesian.length;A++){var V=_.cartesian[A];if(!b[V]){var O="."+V+",."+V+"-x,."+V+"-y";T._cartesianlayer.selectAll(O).remove(),d(V,T)}}},q.drawFramework=function(m){var y=m._fullLayout,v=function(w){var A,E,M,b,_,S,C=w._fullLayout,k=C._subplots.cartesian,L=k.length,I=[],R=[];for(A=0;A<L;A++){M=k[A],b=C._plots[M],_=b.xaxis,S=b.yaxis;var V=_._mainAxis,O=S._mainAxis,J=V._id+O._id,D=C._plots[J];b.overlays=[],J!==M&&D?(b.mainplot=J,b.mainplotinfo=D,R.push(M)):(b.mainplot=void 0,b.mainplotinfo=void 0,I.push(M))}for(A=0;A<R.length;A++)M=R[A],(b=C._plots[M]).mainplotinfo.overlays.push(b);var B=I.concat(R),N=new Array(L);for(A=0;A<L;A++){M=B[A],b=C._plots[M],_=b.xaxis,S=b.yaxis;var F=[M,_.layer,S.layer,_.overlaying||"",S.overlaying||""];for(E=0;E<b.overlays.length;E++)F.push(b.overlays[E].id);N[A]=F}return N}(m),T=y._cartesianlayer.selectAll(".subplot").data(v,String);T.enter().append("g").attr("class",function(w){return"subplot "+w[0]}),T.order(),T.exit().call(g,y),T.each(function(w){var A=w[0],E=y._plots[A];E.plotgroup=t.select(this),f(m,E),E.draglayer=s(y._draggers,"g",A)})},q.rangePlot=function(m,y,v){f(m,y),c(m,y,v),l.style(m)},q.toSVG=function(m){var y=m._fullLayout._glimages,v=t.select(m).selectAll(".svg-container");v.filter(function(T,w){return w===v.size()-1}).selectAll(".gl-canvas-context, .gl-canvas-focus").each(function(){var T=this.toDataURL("image/png");y.append("svg:image").attr({xmlns:u.svg,"xlink:href":T,preserveAspectRatio:"none",x:0,y:0,width:this.width,height:this.height})})},q.updateFx=n("./graph_interact").updateFx},{"../../components/drawing":665,"../../constants/xmlns_namespaces":754,"../../lib":778,"../../registry":911,"../get_data":865,"../plots":891,"./attributes":826,"./axis_ids":831,"./constants":834,"./graph_interact":837,"./layout_attributes":842,"./layout_defaults":843,"./transition_axes":852,d3:169}],842:[function(n,z,q){"use strict";var t=n("../font_attributes"),h=n("../../components/color/attributes"),p=n("../../components/drawing/attributes").dash,l=n("../../lib/extend").extendFlat,e=n("../../plot_api/plot_template").templatedArray,o=(n("../../constants/docs").FORMAT_LINK,n("../../constants/docs").DATE_FORMAT_LINK,n("../../constants/numerical").ONEDAY),r=n("./constants"),i=r.HOUR_PATTERN,u=r.WEEKDAY_PATTERN;z.exports={visible:{valType:"boolean",editType:"plot"},color:{valType:"color",dflt:h.defaultLine,editType:"ticks"},title:{text:{valType:"string",editType:"ticks"},font:t({editType:"ticks"}),standoff:{valType:"number",min:0,editType:"ticks"},editType:"ticks"},type:{valType:"enumerated",values:["-","linear","log","date","category","multicategory"],dflt:"-",editType:"calc",_noTemplating:!0},autotypenumbers:{valType:"enumerated",values:["convert types","strict"],dflt:"convert types",editType:"calc"},autorange:{valType:"enumerated",values:[!0,!1,"reversed"],dflt:!0,editType:"axrange",impliedEdits:{"range[0]":void 0,"range[1]":void 0}},rangemode:{valType:"enumerated",values:["normal","tozero","nonnegative"],dflt:"normal",editType:"plot"},range:{valType:"info_array",items:[{valType:"any",editType:"axrange",impliedEdits:{"^autorange":!1},anim:!0},{valType:"any",editType:"axrange",impliedEdits:{"^autorange":!1},anim:!0}],editType:"axrange",impliedEdits:{autorange:!1},anim:!0},fixedrange:{valType:"boolean",dflt:!1,editType:"calc"},scaleanchor:{valType:"enumerated",values:[r.idRegex.x.toString(),r.idRegex.y.toString()],editType:"plot"},scaleratio:{valType:"number",min:0,dflt:1,editType:"plot"},constrain:{valType:"enumerated",values:["range","domain"],editType:"plot"},constraintoward:{valType:"enumerated",values:["left","center","right","top","middle","bottom"],editType:"plot"},matches:{valType:"enumerated",values:[r.idRegex.x.toString(),r.idRegex.y.toString()],editType:"calc"},rangebreaks:e("rangebreak",{enabled:{valType:"boolean",dflt:!0,editType:"calc"},bounds:{valType:"info_array",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}],editType:"calc"},pattern:{valType:"enumerated",values:[u,i,""],editType:"calc"},values:{valType:"info_array",freeLength:!0,editType:"calc",items:{valType:"any",editType:"calc"}},dvalue:{valType:"number",editType:"calc",min:0,dflt:o},editType:"calc"}),tickmode:{valType:"enumerated",values:["auto","linear","array"],editType:"ticks",impliedEdits:{tick0:void 0,dtick:void 0}},nticks:{valType:"integer",min:0,dflt:0,editType:"ticks"},tick0:{valType:"any",editType:"ticks",impliedEdits:{tickmode:"linear"}},dtick:{valType:"any",editType:"ticks",impliedEdits:{tickmode:"linear"}},tickvals:{valType:"data_array",editType:"ticks"},ticktext:{valType:"data_array",editType:"ticks"},ticks:{valType:"enumerated",values:["outside","inside",""],editType:"ticks"},tickson:{valType:"enumerated",values:["labels","boundaries"],dflt:"labels",editType:"ticks"},ticklabelmode:{valType:"enumerated",values:["instant","period"],dflt:"instant",editType:"ticks"},ticklabelposition:{valType:"enumerated",values:["outside","inside","outside top","inside top","outside left","inside left","outside right","inside right","outside bottom","inside bottom"],dflt:"outside",editType:"calc"},mirror:{valType:"enumerated",values:[!0,"ticks",!1,"all","allticks"],dflt:!1,editType:"ticks+layoutstyle"},ticklen:{valType:"number",min:0,dflt:5,editType:"ticks"},tickwidth:{valType:"number",min:0,dflt:1,editType:"ticks"},tickcolor:{valType:"color",dflt:h.defaultLine,editType:"ticks"},showticklabels:{valType:"boolean",dflt:!0,editType:"ticks"},automargin:{valType:"boolean",dflt:!1,editType:"ticks"},showspikes:{valType:"boolean",dflt:!1,editType:"modebar"},spikecolor:{valType:"color",dflt:null,editType:"none"},spikethickness:{valType:"number",dflt:3,editType:"none"},spikedash:l({},p,{dflt:"dash",editType:"none"}),spikemode:{valType:"flaglist",flags:["toaxis","across","marker"],dflt:"toaxis",editType:"none"},spikesnap:{valType:"enumerated",values:["data","cursor","hovered data"],dflt:"data",editType:"none"},tickfont:t({editType:"ticks"}),tickangle:{valType:"angle",dflt:"auto",editType:"ticks"},tickprefix:{valType:"string",dflt:"",editType:"ticks"},showtickprefix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},ticksuffix:{valType:"string",dflt:"",editType:"ticks"},showticksuffix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},showexponent:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},exponentformat:{valType:"enumerated",values:["none","e","E","power","SI","B"],dflt:"B",editType:"ticks"},minexponent:{valType:"number",dflt:3,min:0,editType:"ticks"},separatethousands:{valType:"boolean",dflt:!1,editType:"ticks"},tickformat:{valType:"string",dflt:"",editType:"ticks"},tickformatstops:e("tickformatstop",{enabled:{valType:"boolean",dflt:!0,editType:"ticks"},dtickrange:{valType:"info_array",items:[{valType:"any",editType:"ticks"},{valType:"any",editType:"ticks"}],editType:"ticks"},value:{valType:"string",dflt:"",editType:"ticks"},editType:"ticks"}),hoverformat:{valType:"string",dflt:"",editType:"none"},showline:{valType:"boolean",dflt:!1,editType:"ticks+layoutstyle"},linecolor:{valType:"color",dflt:h.defaultLine,editType:"layoutstyle"},linewidth:{valType:"number",min:0,dflt:1,editType:"ticks+layoutstyle"},showgrid:{valType:"boolean",editType:"ticks"},gridcolor:{valType:"color",dflt:h.lightLine,editType:"ticks"},gridwidth:{valType:"number",min:0,dflt:1,editType:"ticks"},zeroline:{valType:"boolean",editType:"ticks"},zerolinecolor:{valType:"color",dflt:h.defaultLine,editType:"ticks"},zerolinewidth:{valType:"number",dflt:1,editType:"ticks"},showdividers:{valType:"boolean",dflt:!0,editType:"ticks"},dividercolor:{valType:"color",dflt:h.defaultLine,editType:"ticks"},dividerwidth:{valType:"number",dflt:1,editType:"ticks"},anchor:{valType:"enumerated",values:["free",r.idRegex.x.toString(),r.idRegex.y.toString()],editType:"plot"},side:{valType:"enumerated",values:["top","bottom","left","right"],editType:"plot"},overlaying:{valType:"enumerated",values:["free",r.idRegex.x.toString(),r.idRegex.y.toString()],editType:"plot"},layer:{valType:"enumerated",values:["above traces","below traces"],dflt:"above traces",editType:"plot"},domain:{valType:"info_array",items:[{valType:"number",min:0,max:1,editType:"plot"},{valType:"number",min:0,max:1,editType:"plot"}],dflt:[0,1],editType:"plot"},position:{valType:"number",min:0,max:1,dflt:0,editType:"plot"},categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array","total ascending","total descending","min ascending","min descending","max ascending","max descending","sum ascending","sum descending","mean ascending","mean descending","median ascending","median descending"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},uirevision:{valType:"any",editType:"none"},editType:"calc",_deprecated:{autotick:{valType:"boolean",editType:"ticks"},title:{valType:"string",editType:"ticks"},titlefont:t({editType:"ticks"})}}},{"../../components/color/attributes":642,"../../components/drawing/attributes":664,"../../constants/docs":748,"../../constants/numerical":753,"../../lib/extend":768,"../../plot_api/plot_template":817,"../font_attributes":856,"./constants":834}],843:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../../components/color"),p=n("../../components/fx/helpers").isUnifiedHover,l=n("../../components/fx/hovermode_defaults"),e=n("../../plot_api/plot_template"),o=n("../layout_attributes"),r=n("./layout_attributes"),i=n("./type_defaults"),u=n("./axis_defaults"),s=n("./constraints"),a=n("./position_defaults"),c=n("./axis_ids"),f=c.id2name,g=c.name2id,d=n("./constants").AX_ID_PATTERN,m=n("../../registry"),y=m.traceIs,v=m.getComponentMethod;function T(w,A,E){Array.isArray(w[A])?w[A].push(E):w[A]=[E]}z.exports=function(w,A,E){var M,b,_=A.autotypenumbers,S={},C={},k={},L={},I={},R={},V={},O={},J={},D={};for(M=0;M<E.length;M++){var B=E[M];if(y(B,"cartesian")||y(B,"gl2d")){var N,F;if(B.xaxis)N=f(B.xaxis),T(S,N,B);else if(B.xaxes)for(b=0;b<B.xaxes.length;b++)T(S,f(B.xaxes[b]),B);if(B.yaxis)F=f(B.yaxis),T(S,F,B);else if(B.yaxes)for(b=0;b<B.yaxes.length;b++)T(S,f(B.yaxes[b]),B);B.type==="funnel"?B.orientation==="h"?(N&&(C[N]=!0),F&&(V[F]=!0)):F&&(k[F]=!0):B.type==="image"?(F&&(O[F]=!0),N&&(O[N]=!0)):(F&&(I[F]=!0,R[F]=!0),y(B,"carpet")&&(B.type!=="carpet"||B._cheater)||N&&(L[N]=!0)),B.type==="carpet"&&B._cheater&&N&&(C[N]=!0),y(B,"2dMap")&&(J[N]=!0,J[F]=!0),y(B,"oriented")&&(D[B.orientation==="h"?F:N]=!0)}}var H=A._subplots,j=H.xaxis,G=H.yaxis,W=t.simpleMap(j,f),Q=t.simpleMap(G,f),$=W.concat(Q),ee=h.background;j.length&&G.length&&(ee=t.coerce(w,A,o,"plot_bgcolor"));var ie,ae,oe,de,le,fe=h.combine(ee,A.paper_bgcolor);function ue(){var We=S[ie]||[];le._traceIndices=We.map(function(Ge){return Ge._expandedIndex}),le._annIndices=[],le._shapeIndices=[],le._imgIndices=[],le._subplotsWith=[],le._counterAxes=[],le._name=le._attr=ie,le._id=ae}function we(We,Ge){return t.coerce(de,le,r,We,Ge)}function Ae(We,Ge){return t.coerce2(de,le,r,We,Ge)}function Se(We){return We==="x"?G:j}function ke(We,Ge){for(var st=We==="x"?W:Q,ot=[],Ce=0;Ce<st.length;Ce++){var Ue=st[Ce];Ue===Ge||(w[Ue]||{}).overlaying||ot.push(g(Ue))}return ot}var Me={x:Se("x"),y:Se("y")},ve=Me.x.concat(Me.y),ge={},De=[];function _e(){var We=de.matches;d.test(We)&&ve.indexOf(We)===-1&&(ge[We]=de.type,De=Object.keys(ge))}var Pe=l(w,A,E),Fe=p(Pe);for(M=0;M<$.length;M++){ie=$[M],ae=g(ie),oe=ie.charAt(0),t.isPlainObject(w[ie])||(w[ie]={}),de=w[ie],le=e.newContainer(A,ie,oe+"axis"),ue();var ze=oe==="x"&&!L[ie]&&C[ie]||oe==="y"&&!I[ie]&&k[ie],He=oe==="y"&&(!R[ie]&&V[ie]||O[ie]),et={letter:oe,font:A.font,outerTicks:J[ie],showGrid:!D[ie],data:S[ie]||[],bgColor:fe,calendar:A.calendar,automargin:!0,visibleDflt:ze,reverseDflt:He,autotypenumbersDflt:_,splomStash:((A._splomAxes||{})[oe]||{})[ae]};we("uirevision",A.uirevision),i(de,le,we,et),u(de,le,we,et,A);var Re=Fe&&oe===Pe.charAt(0),Ze=Ae("spikecolor",Fe?le.color:void 0),Ke=Ae("spikethickness",Fe?1.5:void 0),$e=Ae("spikedash",Fe?"dot":void 0),rt=Ae("spikemode",Fe?"across":void 0),at=Ae("spikesnap",Fe?"hovered data":void 0);we("showspikes",!!(Re||Ze||Ke||$e||rt||at))||(delete le.spikecolor,delete le.spikethickness,delete le.spikedash,delete le.spikemode,delete le.spikesnap),a(de,le,we,{letter:oe,counterAxes:Me[oe],overlayableAxes:ke(oe,ie),grid:A.grid}),we("title.standoff"),_e(),le._input=de}for(M=0;M<De.length;){ae=De[M++],oe=(ie=f(ae)).charAt(0),t.isPlainObject(w[ie])||(w[ie]={}),de=w[ie],le=e.newContainer(A,ie,oe+"axis"),ue();var lt={letter:oe,font:A.font,outerTicks:J[ie],showGrid:!D[ie],data:[],bgColor:fe,calendar:A.calendar,automargin:!0,visibleDflt:!1,reverseDflt:!1,autotypenumbersDflt:_,splomStash:((A._splomAxes||{})[oe]||{})[ae]};we("uirevision",A.uirevision),le.type=ge[ae]||"linear",u(de,le,we,lt,A),a(de,le,we,{letter:oe,counterAxes:Me[oe],overlayableAxes:ke(oe,ie),grid:A.grid}),we("fixedrange"),_e(),le._input=de}var gt=v("rangeslider","handleDefaults"),Ie=v("rangeselector","handleDefaults");for(M=0;M<W.length;M++)ie=W[M],de=w[ie],le=A[ie],gt(w,A,ie),le.type==="date"&&Ie(de,le,A,Q,le.calendar),we("fixedrange");for(M=0;M<Q.length;M++){ie=Q[M],de=w[ie],le=A[ie];var be=A[f(le.anchor)];we("fixedrange",v("rangeslider","isVisible")(be))}s.handleDefaults(w,A,{axIds:ve.concat(De).sort(c.idSort),axHasImage:O})}},{"../../components/color":643,"../../components/fx/helpers":679,"../../components/fx/hovermode_defaults":682,"../../lib":778,"../../plot_api/plot_template":817,"../../registry":911,"../layout_attributes":882,"./axis_defaults":830,"./axis_ids":831,"./constants":834,"./constraints":835,"./layout_attributes":842,"./position_defaults":845,"./type_defaults":853}],844:[function(n,z,q){"use strict";var t=n("tinycolor2").mix,h=n("../../components/color/attributes").lightFraction,p=n("../../lib");z.exports=function(l,e,o,r){var i=(r=r||{}).dfltColor;function u(m,y){return p.coerce2(l,e,r.attributes,m,y)}var s=u("linecolor",i),a=u("linewidth");o("showline",r.showLine||!!s||!!a)||(delete e.linecolor,delete e.linewidth);var c=u("gridcolor",t(i,r.bgColor,r.blend||h).toRgbString()),f=u("gridwidth");if(o("showgrid",r.showGrid||!!c||!!f)||(delete e.gridcolor,delete e.gridwidth),!r.noZeroLine){var g=u("zerolinecolor",i),d=u("zerolinewidth");o("zeroline",r.showGrid||!!g||!!d)||(delete e.zerolinecolor,delete e.zerolinewidth)}}},{"../../components/color/attributes":642,"../../lib":778,tinycolor2:576}],845:[function(n,z,q){"use strict";var t=n("fast-isnumeric"),h=n("../../lib");z.exports=function(p,l,e,o){var r,i,u,s,a=o.counterAxes||[],c=o.overlayableAxes||[],f=o.letter,g=o.grid;g&&(i=g._domains[f][g._axisMap[l._id]],r=g._anchors[l._id],i&&(u=g[f+"side"].split(" ")[0],s=g.domain[f][u==="right"||u==="top"?1:0])),i=i||[0,1],r=r||(t(p.position)?"free":a[0]||"free"),u=u||(f==="x"?"bottom":"left"),s=s||0,h.coerce(p,l,{anchor:{valType:"enumerated",values:["free"].concat(a),dflt:r}},"anchor")==="free"&&e("position",s),h.coerce(p,l,{side:{valType:"enumerated",values:f==="x"?["bottom","top"]:["left","right"],dflt:u}},"side");var d=!1;if(c.length&&(d=h.coerce(p,l,{overlaying:{valType:"enumerated",values:[!1].concat(c),dflt:!1}},"overlaying")),!d){var m=e("domain",i);m[0]>m[1]-1/4096&&(l.domain=i),h.noneOrAll(p.domain,l.domain,i)}return e("layer"),l}},{"../../lib":778,"fast-isnumeric":241}],846:[function(n,z,q){"use strict";var t=n("../../constants/alignment").FROM_BL;z.exports=function(h,p,l){l===void 0&&(l=t[h.constraintoward||"center"]);var e=[h.r2l(h.range[0]),h.r2l(h.range[1])],o=e[0]+(e[1]-e[0])*l;h.range=h._input.range=[h.l2r(o+(e[0]-o)*p),h.l2r(o+(e[1]-o)*p)],h.setScale()}},{"../../constants/alignment":745}],847:[function(n,z,q){"use strict";var t=n("polybooljs"),h=n("../../registry"),p=n("../../components/drawing").dashStyle,l=n("../../components/color"),e=n("../../components/fx"),o=n("../../components/fx/helpers").makeEventData,r=n("../../components/dragelement/helpers"),i=r.freeMode,u=r.rectMode,s=r.drawMode,a=r.openMode,c=r.selectMode,f=n("../../components/shapes/draw_newshape/display_outlines"),g=n("../../components/shapes/draw_newshape/helpers").handleEllipse,d=n("../../components/shapes/draw_newshape/newshapes"),m=n("../../lib"),y=n("../../lib/polygon"),v=n("../../lib/throttle"),T=n("./axis_ids").getFromId,w=n("../../lib/clear_gl_canvases"),A=n("../../plot_api/subroutines").redrawReglTraces,E=n("./constants"),M=E.MINSELECT,b=y.filter,_=y.tester,S=n("./handle_outline").clearSelect,C=n("./helpers"),k=C.p2r,L=C.axValue,I=C.getTransform;function R(W,Q,$,ee,ie,ae,oe){var de,le,fe,ue,we,Ae,Se,ke,Me,ve=Q._hoverdata,ge=Q._fullLayout.clickmode.indexOf("event")>-1,De=[];if(function(He){return He&&Array.isArray(He)&&He[0].hoverOnBox!==!0}(ve)){D(W,Q,ae);var _e=function(He,et){var Re,Ze,Ke=He[0],$e=-1,rt=[];for(Ze=0;Ze<et.length;Ze++)if(Re=et[Ze],Ke.fullData._expandedIndex===Re.cd[0].trace._expandedIndex){if(Ke.hoverOnBox===!0)break;Ke.pointNumber!==void 0?$e=Ke.pointNumber:Ke.binNumber!==void 0&&($e=Ke.binNumber,rt=Ke.pointNumbers);break}return{pointNumber:$e,pointNumbers:rt,searchInfo:Re}}(ve,de=N(Q,$,ee,ie));if(_e.pointNumbers.length>0?function(He,et){var Re,Ze,Ke,$e=[];for(Ke=0;Ke<He.length;Ke++)(Re=He[Ke]).cd[0].trace.selectedpoints&&Re.cd[0].trace.selectedpoints.length>0&&$e.push(Re);if($e.length===1&&$e[0]===et.searchInfo&&(Ze=et.searchInfo.cd[0].trace).selectedpoints.length===et.pointNumbers.length){for(Ke=0;Ke<et.pointNumbers.length;Ke++)if(Ze.selectedpoints.indexOf(et.pointNumbers[Ke])<0)return!1;return!0}return!1}(de,_e):function(He){var et,Re,Ze,Ke=0;for(Ze=0;Ze<He.length;Ze++)if(et=He[Ze],(Re=et.cd[0].trace).selectedpoints&&(Re.selectedpoints.length>1||(Ke+=Re.selectedpoints.length)>1))return!1;return Ke===1}(de)&&(Ae=F(_e))){for(oe&&oe.remove(),Me=0;Me<de.length;Me++)(le=de[Me])._module.selectPoints(le,!1);H(Q,de),B(ae),ge&&Q.emit("plotly_deselect",null)}else{for(Se=W.shiftKey&&(Ae!==void 0?Ae:F(_e)),fe=function(He,et,Re){return{pointNumber:He,searchInfo:et,subtract:Re}}(_e.pointNumber,_e.searchInfo,Se),ue=J(ae.selectionDefs.concat([fe])),Me=0;Me<de.length;Me++)if(we=j(de[Me]._module.selectPoints(de[Me],ue),de[Me]),De.length)for(var Pe=0;Pe<we.length;Pe++)De.push(we[Pe]);else De=we;if(H(Q,de,ke={points:De}),fe&&ae&&ae.selectionDefs.push(fe),oe){var Fe=ae.mergedPolygons,ze=a(ae.dragmode);f(G(Fe,ze),oe,ae)}ge&&Q.emit("plotly_selected",ke)}}}function V(W){return"pointNumber"in W&&"searchInfo"in W}function O(W){return{xmin:0,xmax:0,ymin:0,ymax:0,pts:[],contains:function(Q,$,ee,ie){var ae=W.searchInfo.cd[0].trace._expandedIndex;return ie.cd[0].trace._expandedIndex===ae&&ee===W.pointNumber},isRect:!1,degenerate:!1,subtract:W.subtract}}function J(W){for(var Q=[],$=V(W[0])?0:W[0][0][0],ee=$,ie=V(W[0])?0:W[0][0][1],ae=ie,oe=0;oe<W.length;oe++)if(V(W[oe]))Q.push(O(W[oe]));else{var de=y.tester(W[oe]);de.subtract=W[oe].subtract,Q.push(de),$=Math.min($,de.xmin),ee=Math.max(ee,de.xmax),ie=Math.min(ie,de.ymin),ae=Math.max(ae,de.ymax)}return{xmin:$,xmax:ee,ymin:ie,ymax:ae,pts:[],contains:function(le,fe,ue,we){for(var Ae=!1,Se=0;Se<Q.length;Se++)Q[Se].contains(le,fe,ue,we)&&(Ae=Q[Se].subtract===!1);return Ae},isRect:!1,degenerate:!1}}function D(W,Q,$){Q._fullLayout._drawing=!1;var ee=Q._fullLayout,ie=$.plotinfo,ae=$.dragmode,oe=ee._lastSelectedSubplot&&ee._lastSelectedSubplot===ie.id,de=(W.shiftKey||W.altKey)&&!(s(ae)&&a(ae));oe&&de&&ie.selection&&ie.selection.selectionDefs&&!$.selectionDefs?($.selectionDefs=ie.selection.selectionDefs,$.mergedPolygons=ie.selection.mergedPolygons):de&&ie.selection||B($),oe||(S(Q),ee._lastSelectedSubplot=ie.id)}function B(W){var Q=W.dragmode,$=W.plotinfo,ee=W.gd;if(ee._fullLayout._activeShapeIndex>=0&&ee._fullLayout._deactivateShape(ee),s(Q)){var ie=ee._fullLayout._zoomlayer.selectAll(".select-outline-"+$.id);if(ie&&ee._fullLayout._drawing){var ae=d(ie,W);ae&&h.call("_guiRelayout",ee,{shapes:ae}),ee._fullLayout._drawing=!1}}$.selection={},$.selection.selectionDefs=W.selectionDefs=[],$.selection.mergedPolygons=W.mergedPolygons=[]}function N(W,Q,$,ee){var ie,ae,oe,de=[],le=Q.map(function(Se){return Se._id}),fe=$.map(function(Se){return Se._id});for(oe=0;oe<W.calcdata.length;oe++)if((ae=(ie=W.calcdata[oe])[0].trace).visible===!0&&ae._module&&ae._module.selectPoints)if(!ee||ae.subplot!==ee&&ae.geo!==ee)if(ae.type==="splom"&&ae._xaxes[le[0]]&&ae._yaxes[fe[0]]){var ue=Ae(ae._module,ie,Q[0],$[0]);ue.scene=W._fullLayout._splomScenes[ae.uid],de.push(ue)}else if(ae.type==="sankey"){var we=Ae(ae._module,ie,Q[0],$[0]);de.push(we)}else{if(le.indexOf(ae.xaxis)===-1||fe.indexOf(ae.yaxis)===-1)continue;de.push(Ae(ae._module,ie,T(W,ae.xaxis),T(W,ae.yaxis)))}else de.push(Ae(ae._module,ie,Q[0],$[0]));return de;function Ae(Se,ke,Me,ve){return{_module:Se,cd:ke,xaxis:Me,yaxis:ve}}}function F(W){var Q=W.searchInfo.cd[0].trace,$=W.pointNumber,ee=W.pointNumbers,ie=ee.length>0?ee[0]:$;return!!Q.selectedpoints&&Q.selectedpoints.indexOf(ie)>-1}function H(W,Q,$){var ee,ie,ae,oe;for(ee=0;ee<Q.length;ee++){var de=Q[ee].cd[0].trace._fullInput,le=W._fullLayout._tracePreGUI[de.uid]||{};le.selectedpoints===void 0&&(le.selectedpoints=de._input.selectedpoints||null)}if($){var fe=$.points||[];for(ee=0;ee<Q.length;ee++)(oe=Q[ee].cd[0].trace)._input.selectedpoints=oe._fullInput.selectedpoints=[],oe._fullInput!==oe&&(oe.selectedpoints=[]);for(ee=0;ee<fe.length;ee++){var ue=fe[ee],we=ue.data,Ae=ue.fullData;ue.pointIndices?([].push.apply(we.selectedpoints,ue.pointIndices),oe._fullInput!==oe&&[].push.apply(Ae.selectedpoints,ue.pointIndices)):(we.selectedpoints.push(ue.pointIndex),oe._fullInput!==oe&&Ae.selectedpoints.push(ue.pointIndex))}}else for(ee=0;ee<Q.length;ee++)delete(oe=Q[ee].cd[0].trace).selectedpoints,delete oe._input.selectedpoints,oe._fullInput!==oe&&delete oe._fullInput.selectedpoints;var Se=!1;for(ee=0;ee<Q.length;ee++){oe=(ae=(ie=Q[ee]).cd)[0].trace,h.traceIs(oe,"regl")&&(Se=!0);var ke=ie._module,Me=ke.styleOnSelect||ke.style;Me&&(Me(W,ae,ae[0].node3),ae[0].nodeRangePlot3&&Me(W,ae,ae[0].nodeRangePlot3))}Se&&(w(W),A(W))}function j(W,Q){if(Array.isArray(W))for(var $=Q.cd,ee=Q.cd[0].trace,ie=0;ie<W.length;ie++)W[ie]=o(W[ie],ee,$);return W}function G(W,Q){for(var $=[],ee=0;ee<W.length;ee++){$[ee]=[];for(var ie=0;ie<W[ee].length;ie++){$[ee][ie]=[],$[ee][ie][0]=ie?"L":"M";for(var ae=0;ae<W[ee][ie].length;ae++)$[ee][ie].push(W[ee][ie][ae])}Q||$[ee].push(["Z",$[ee][0][1],$[ee][0][2]])}return $}z.exports={prepSelect:function(W,Q,$,ee,ie){var ae=i(ie),oe=u(ie),de=a(ie),le=s(ie),fe=c(ie),ue=ie==="drawcircle",we=ie==="drawline"||ue,Ae=ee.gd,Se=Ae._fullLayout,ke=Se._zoomlayer,Me=ee.element.getBoundingClientRect(),ve=ee.plotinfo,ge=I(ve),De=Q-Me.left,_e=$-Me.top;Se._calcInverseTransform(Ae);var Pe=m.apply3DTransform(Se._invTransform)(De,_e);De=Pe[0],_e=Pe[1];var Fe,ze,He,et,Re,Ze,Ke,$e=Se._invScaleX,rt=Se._invScaleY,at=De,lt=_e,gt="M"+De+","+_e,Ie=ee.xaxes[0]._length,be=ee.yaxes[0]._length,We=ee.xaxes.concat(ee.yaxes),Ge=W.altKey&&!(s(ie)&&de);D(W,Ae,ee),ae&&(Fe=b([[De,_e]],E.BENDPX));var st=ke.selectAll("path.select-outline-"+ve.id).data(le?[0]:[1,2]),ot=Se.newshape;st.enter().append("path").attr("class",function(it){return"select-outline select-outline-"+it+" select-outline-"+ve.id}).style(le?{opacity:ot.opacity/2,fill:de?void 0:ot.fillcolor,stroke:ot.line.color,"stroke-dasharray":p(ot.line.dash,ot.line.width),"stroke-width":ot.line.width+"px"}:{}).attr("fill-rule",ot.fillrule).classed("cursor-move",!!le).attr("transform",ge).attr("d",gt+"Z");var Ce,Ue=ke.append("path").attr("class","zoombox-corners").style({fill:l.background,stroke:l.defaultLine,"stroke-width":1}).attr("transform",ge).attr("d","M0,0Z"),Ye=Se._uid+E.SELECTID,xe=[],Ee=N(Ae,ee.xaxes,ee.yaxes,ee.subplot);function Je(it,ht){return it-ht}Ce=ve.fillRangeItems?ve.fillRangeItems:oe?function(it,ht){var ct=it.range={};for(Re=0;Re<We.length;Re++){var mt=We[Re],bt=mt._id.charAt(0);ct[mt._id]=[k(mt,ht[bt+"min"]),k(mt,ht[bt+"max"])].sort(Je)}}:function(it,ht,ct){var mt=it.lassoPoints={};for(Re=0;Re<We.length;Re++){var bt=We[Re];mt[bt._id]=ct.filtered.map(L(bt))}},ee.moveFn=function(it,ht){at=Math.max(0,Math.min(Ie,$e*it+De)),lt=Math.max(0,Math.min(be,rt*ht+_e));var ct=Math.abs(at-De),mt=Math.abs(lt-_e);if(oe){var bt,Et,Mt;if(fe){var _t=Se.selectdirection;switch(bt=_t==="any"?mt<Math.min(.6*ct,M)?"h":ct<Math.min(.6*mt,M)?"v":"d":_t){case"h":Et=ue?be/2:0,Mt=be;break;case"v":Et=ue?Ie/2:0,Mt=Ie}}if(le)switch(Se.newshape.drawdirection){case"vertical":bt="h",Et=ue?be/2:0,Mt=be;break;case"horizontal":bt="v",Et=ue?Ie/2:0,Mt=Ie;break;case"ortho":ct<mt?(bt="h",Et=_e,Mt=lt):(bt="v",Et=De,Mt=at);break;default:bt="d"}bt==="h"?((et=we?g(ue,[at,Et],[at,Mt]):[[De,Et],[De,Mt],[at,Mt],[at,Et]]).xmin=we?at:Math.min(De,at),et.xmax=we?at:Math.max(De,at),et.ymin=Math.min(Et,Mt),et.ymax=Math.max(Et,Mt),Ue.attr("d","M"+et.xmin+","+(_e-M)+"h-4v"+2*M+"h4ZM"+(et.xmax-1)+","+(_e-M)+"h4v"+2*M+"h-4Z")):bt==="v"?((et=we?g(ue,[Et,lt],[Mt,lt]):[[Et,_e],[Et,lt],[Mt,lt],[Mt,_e]]).xmin=Math.min(Et,Mt),et.xmax=Math.max(Et,Mt),et.ymin=we?lt:Math.min(_e,lt),et.ymax=we?lt:Math.max(_e,lt),Ue.attr("d","M"+(De-M)+","+et.ymin+"v-4h"+2*M+"v4ZM"+(De-M)+","+(et.ymax-1)+"v4h"+2*M+"v-4Z")):bt==="d"&&((et=we?g(ue,[De,_e],[at,lt]):[[De,_e],[De,lt],[at,lt],[at,_e]]).xmin=Math.min(De,at),et.xmax=Math.max(De,at),et.ymin=Math.min(_e,lt),et.ymax=Math.max(_e,lt),Ue.attr("d","M0,0Z"))}else ae&&(Fe.addPt([at,lt]),et=Fe.filtered);ee.selectionDefs&&ee.selectionDefs.length?(He=function(xt,At,It){return It?t.difference({regions:xt,inverted:!1},{regions:[At],inverted:!1}).regions:t.union({regions:xt,inverted:!1},{regions:[At],inverted:!1}).regions}(ee.mergedPolygons,et,Ge),et.subtract=Ge,ze=J(ee.selectionDefs.concat([et]))):(He=[et],ze=_(et)),f(G(He,de),st,ee),fe&&v.throttle(Ye,E.SELECTDELAY,function(){var xt;xe=[];var At,It=[];for(Re=0;Re<Ee.length;Re++)if(At=(Ze=Ee[Re])._module.selectPoints(Ze,ze),It.push(At),xt=j(At,Ze),xe.length)for(var Nt=0;Nt<xt.length;Nt++)xe.push(xt[Nt]);else xe=xt;H(Ae,Ee,Ke={points:xe}),Ce(Ke,et,Fe),ee.gd.emit("plotly_selecting",Ke)})},ee.clickFn=function(it,ht){if(Ue.remove(),Ae._fullLayout._activeShapeIndex>=0)Ae._fullLayout._deactivateShape(Ae);else if(!le){var ct=Se.clickmode;v.done(Ye).then(function(){if(v.clear(Ye),it===2){for(st.remove(),Re=0;Re<Ee.length;Re++)(Ze=Ee[Re])._module.selectPoints(Ze,!1);H(Ae,Ee),B(ee),Ae.emit("plotly_deselect",null)}else ct.indexOf("select")>-1&&R(ht,Ae,ee.xaxes,ee.yaxes,ee.subplot,ee,st),ct==="event"&&Ae.emit("plotly_selected",void 0);e.click(Ae,ht)}).catch(m.error)}},ee.doneFn=function(){Ue.remove(),v.done(Ye).then(function(){v.clear(Ye),ee.gd.emit("plotly_selected",Ke),et&&ee.selectionDefs&&(et.subtract=Ge,ee.selectionDefs.push(et),ee.mergedPolygons.length=0,[].push.apply(ee.mergedPolygons,He)),ee.doneFnCompleted&&ee.doneFnCompleted(xe)}).catch(m.error),le&&B(ee)}},clearSelect:S,clearSelectionsCache:B,selectOnClick:R}},{"../../components/color":643,"../../components/dragelement/helpers":661,"../../components/drawing":665,"../../components/fx":683,"../../components/fx/helpers":679,"../../components/shapes/draw_newshape/display_outlines":728,"../../components/shapes/draw_newshape/helpers":729,"../../components/shapes/draw_newshape/newshapes":730,"../../lib":778,"../../lib/clear_gl_canvases":762,"../../lib/polygon":790,"../../lib/throttle":804,"../../plot_api/subroutines":818,"../../registry":911,"./axis_ids":831,"./constants":834,"./handle_outline":838,"./helpers":839,polybooljs:517}],848:[function(n,z,q){"use strict";var t=n("d3"),h=n("d3-time-format").utcFormat,p=n("fast-isnumeric"),l=n("../../lib"),e=l.cleanNumber,o=l.ms2DateTime,r=l.dateTime2ms,i=l.ensureNumber,u=l.isArrayOrTypedArray,s=n("../../constants/numerical"),a=s.FP_SAFE,c=s.BADNUM,f=s.LOG_CLIP,g=s.ONEWEEK,d=s.ONEDAY,m=s.ONEHOUR,y=s.ONEMIN,v=s.ONESEC,T=n("./axis_ids"),w=n("./constants"),A=w.HOUR_PATTERN,E=w.WEEKDAY_PATTERN;function M(_){return Math.pow(10,_)}function b(_){return _!=null}z.exports=function(_,S){S=S||{};var C=_._id||"x",k=C.charAt(0);function L(Q,$){if(Q>0)return Math.log(Q)/Math.LN10;if(Q<=0&&$&&_.range&&_.range.length===2){var ee=_.range[0],ie=_.range[1];return .5*(ee+ie-2*f*Math.abs(ee-ie))}return c}function I(Q,$,ee,ie){if((ie||{}).msUTC&&p(Q))return+Q;var ae=r(Q,ee||_.calendar);if(ae===c){if(!p(Q))return c;Q=+Q;var oe=Math.floor(10*l.mod(Q+.05,1)),de=Math.round(Q-oe/10);ae=r(new Date(de))+oe/10}return ae}function R(Q,$,ee){return o(Q,$,ee||_.calendar)}function V(Q){return _._categories[Math.round(Q)]}function O(Q){if(b(Q)){if(_._categoriesMap===void 0&&(_._categoriesMap={}),_._categoriesMap[Q]!==void 0)return _._categoriesMap[Q];_._categories.push(typeof Q=="number"?String(Q):Q);var $=_._categories.length-1;return _._categoriesMap[Q]=$,$}return c}function J(Q){if(_._categoriesMap)return _._categoriesMap[Q]}function D(Q){var $=J(Q);return $!==void 0?$:p(Q)?+Q:void 0}function B(Q){return p(Q)?+Q:J(Q)}function N(Q,$,ee){return t.round(ee+$*Q,2)}function F(Q,$,ee){return(Q-ee)/$}var H=function(Q){return p(Q)?N(Q,_._m,_._b):c},j=function(Q){return F(Q,_._m,_._b)};if(_.rangebreaks){var G=k==="y";H=function(Q){if(!p(Q))return c;var $=_._rangebreaks.length;if(!$)return N(Q,_._m,_._b);var ee=G;_.range[0]>_.range[1]&&(ee=!ee);for(var ie=ee?-1:1,ae=ie*Q,oe=0,de=0;de<$;de++){var le=ie*_._rangebreaks[de].min,fe=ie*_._rangebreaks[de].max;if(ae<le)break;if(!(ae>fe)){oe=ae<(le+fe)/2?de:de+1;break}oe=de+1}var ue=_._B[oe]||0;return isFinite(ue)?N(Q,_._m2,ue):0},j=function(Q){var $=_._rangebreaks.length;if(!$)return F(Q,_._m,_._b);for(var ee=0,ie=0;ie<$&&!(Q<_._rangebreaks[ie].pmin);ie++)Q>_._rangebreaks[ie].pmax&&(ee=ie+1);return F(Q,_._m2,_._B[ee])}}_.c2l=_.type==="log"?L:i,_.l2c=_.type==="log"?M:i,_.l2p=H,_.p2l=j,_.c2p=_.type==="log"?function(Q,$){return H(L(Q,$))}:H,_.p2c=_.type==="log"?function(Q){return M(j(Q))}:j,["linear","-"].indexOf(_.type)!==-1?(_.d2r=_.r2d=_.d2c=_.r2c=_.d2l=_.r2l=e,_.c2d=_.c2r=_.l2d=_.l2r=i,_.d2p=_.r2p=function(Q){return _.l2p(e(Q))},_.p2d=_.p2r=j,_.cleanPos=i):_.type==="log"?(_.d2r=_.d2l=function(Q,$){return L(e(Q),$)},_.r2d=_.r2c=function(Q){return M(e(Q))},_.d2c=_.r2l=e,_.c2d=_.l2r=i,_.c2r=L,_.l2d=M,_.d2p=function(Q,$){return _.l2p(_.d2r(Q,$))},_.p2d=function(Q){return M(j(Q))},_.r2p=function(Q){return _.l2p(e(Q))},_.p2r=j,_.cleanPos=i):_.type==="date"?(_.d2r=_.r2d=l.identity,_.d2c=_.r2c=_.d2l=_.r2l=I,_.c2d=_.c2r=_.l2d=_.l2r=R,_.d2p=_.r2p=function(Q,$,ee){return _.l2p(I(Q,0,ee))},_.p2d=_.p2r=function(Q,$,ee){return R(j(Q),$,ee)},_.cleanPos=function(Q){return l.cleanDate(Q,c,_.calendar)}):_.type==="category"?(_.d2c=_.d2l=O,_.r2d=_.c2d=_.l2d=V,_.d2r=_.d2l_noadd=D,_.r2c=function(Q){var $=B(Q);return $!==void 0?$:_.fraction2r(.5)},_.l2r=_.c2r=i,_.r2l=B,_.d2p=function(Q){return _.l2p(_.r2c(Q))},_.p2d=function(Q){return V(j(Q))},_.r2p=_.d2p,_.p2r=j,_.cleanPos=function(Q){return typeof Q=="string"&&Q!==""?Q:i(Q)}):_.type==="multicategory"&&(_.r2d=_.c2d=_.l2d=V,_.d2r=_.d2l_noadd=D,_.r2c=function(Q){var $=D(Q);return $!==void 0?$:_.fraction2r(.5)},_.r2c_just_indices=J,_.l2r=_.c2r=i,_.r2l=D,_.d2p=function(Q){return _.l2p(_.r2c(Q))},_.p2d=function(Q){return V(j(Q))},_.r2p=_.d2p,_.p2r=j,_.cleanPos=function(Q){return Array.isArray(Q)||typeof Q=="string"&&Q!==""?Q:i(Q)},_.setupMultiCategory=function(Q){var $,ee,ie=_._traceIndices,ae=_._matchGroup;if(ae&&_._categories.length===0){for(var oe in ae)if(oe!==C){var de=S[T.id2name(oe)];ie=ie.concat(de._traceIndices)}}var le=[[0,{}],[0,{}]],fe=[];for($=0;$<ie.length;$++){var ue=Q[ie[$]];if(k in ue){var we=ue[k],Ae=ue._length||l.minRowLength(we);if(u(we[0])&&u(we[1]))for(ee=0;ee<Ae;ee++){var Se=we[0][ee],ke=we[1][ee];b(Se)&&b(ke)&&(fe.push([Se,ke]),Se in le[0][1]||(le[0][1][Se]=le[0][0]++),ke in le[1][1]||(le[1][1][ke]=le[1][0]++))}}}for(fe.sort(function(Me,ve){var ge=le[0][1],De=ge[Me[0]]-ge[ve[0]];if(De)return De;var _e=le[1][1];return _e[Me[1]]-_e[ve[1]]}),$=0;$<fe.length;$++)O(fe[$])}),_.fraction2r=function(Q){var $=_.r2l(_.range[0]),ee=_.r2l(_.range[1]);return _.l2r($+Q*(ee-$))},_.r2fraction=function(Q){var $=_.r2l(_.range[0]),ee=_.r2l(_.range[1]);return(_.r2l(Q)-$)/(ee-$)},_.cleanRange=function(Q,$){$||($={}),Q||(Q="range");var ee,ie,ae=l.nestedProperty(_,Q).get();if(ie=(ie=_.type==="date"?l.dfltRange(_.calendar):k==="y"?w.DFLTRANGEY:$.dfltRange||w.DFLTRANGEX).slice(),_.rangemode!=="tozero"&&_.rangemode!=="nonnegative"||(ie[0]=0),ae&&ae.length===2)for(_.type!=="date"||_.autorange||(ae[0]=l.cleanDate(ae[0],c,_.calendar),ae[1]=l.cleanDate(ae[1],c,_.calendar)),ee=0;ee<2;ee++)if(_.type==="date"){if(!l.isDateTime(ae[ee],_.calendar)){_[Q]=ie;break}if(_.r2l(ae[0])===_.r2l(ae[1])){var oe=l.constrain(_.r2l(ae[0]),l.MIN_MS+1e3,l.MAX_MS-1e3);ae[0]=_.l2r(oe-1e3),ae[1]=_.l2r(oe+1e3);break}}else{if(!p(ae[ee])){if(!p(ae[1-ee])){_[Q]=ie;break}ae[ee]=ae[1-ee]*(ee?10:.1)}if(ae[ee]<-a?ae[ee]=-a:ae[ee]>a&&(ae[ee]=a),ae[0]===ae[1]){var de=Math.max(1,Math.abs(1e-6*ae[0]));ae[0]-=de,ae[1]+=de}}else l.nestedProperty(_,Q).set(ie)},_.setScale=function(Q){var $=S._size;if(_.overlaying){var ee=T.getFromId({_fullLayout:S},_.overlaying);_.domain=ee.domain}var ie=Q&&_._r?"_r":"range",ae=_.calendar;_.cleanRange(ie);var oe,de,le=_.r2l(_[ie][0],ae),fe=_.r2l(_[ie][1],ae),ue=k==="y";if(ue?(_._offset=$.t+(1-_.domain[1])*$.h,_._length=$.h*(_.domain[1]-_.domain[0]),_._m=_._length/(le-fe),_._b=-_._m*fe):(_._offset=$.l+_.domain[0]*$.w,_._length=$.w*(_.domain[1]-_.domain[0]),_._m=_._length/(fe-le),_._b=-_._m*le),_._rangebreaks=[],_._lBreaks=0,_._m2=0,_._B=[],_.rangebreaks&&(_._rangebreaks=_.locateBreaks(Math.min(le,fe),Math.max(le,fe)),_._rangebreaks.length)){for(oe=0;oe<_._rangebreaks.length;oe++)de=_._rangebreaks[oe],_._lBreaks+=Math.abs(de.max-de.min);var we=ue;le>fe&&(we=!we),we&&_._rangebreaks.reverse();var Ae=we?-1:1;for(_._m2=Ae*_._length/(Math.abs(fe-le)-_._lBreaks),_._B.push(-_._m2*(ue?fe:le)),oe=0;oe<_._rangebreaks.length;oe++)de=_._rangebreaks[oe],_._B.push(_._B[_._B.length-1]-Ae*_._m2*(de.max-de.min));for(oe=0;oe<_._rangebreaks.length;oe++)(de=_._rangebreaks[oe]).pmin=H(de.min),de.pmax=H(de.max)}if(!isFinite(_._m)||!isFinite(_._b)||_._length<0)throw S._replotting=!1,new Error("Something went wrong with axis scaling")},_.maskBreaks=function(Q){for(var $,ee,ie,ae,oe,de=_.rangebreaks||[],le=0;le<de.length;le++){var fe=de[le];if(fe.enabled){if(fe.bounds){var ue=fe.pattern;switch(ee=($=l.simpleMap(fe.bounds,ue?e:_.d2c))[0],ie=$[1],ue){case E:ae=(oe=new Date(Q)).getUTCDay(),ee>ie&&(ie+=7,ae<ee&&(ae+=7));break;case A:ae=(oe=new Date(Q)).getUTCHours()+(oe.getUTCMinutes()/60+oe.getUTCSeconds()/3600+oe.getUTCMilliseconds()/36e5),ee>ie&&(ie+=24,ae<ee&&(ae+=24));break;case"":ae=Q}if(ae>=ee&&ae<ie)return c}else for(var we=l.simpleMap(fe.values,_.d2c).sort(l.sorterAsc),Ae=0;Ae<we.length;Ae++)if(ie=(ee=we[Ae])+fe.dvalue,Q>=ee&&Q<ie)return c}}return Q},_.locateBreaks=function(Q,$){var ee,ie,ae,oe,de=[];if(!_.rangebreaks)return de;var le=_.rangebreaks.slice().sort(function(_e,Pe){return _e.pattern===E&&Pe.pattern===A?-1:Pe.pattern===E&&_e.pattern===A?1:0}),fe=function(_e,Pe){if((_e=l.constrain(_e,Q,$))!==(Pe=l.constrain(Pe,Q,$))){for(var Fe=!0,ze=0;ze<de.length;ze++){var He=de[ze];_e<He.max&&Pe>=He.min&&(_e<He.min&&(He.min=_e),Pe>He.max&&(He.max=Pe),Fe=!1)}Fe&&de.push({min:_e,max:Pe})}};for(ee=0;ee<le.length;ee++){var ue=le[ee];if(ue.enabled)if(ue.bounds){var we=Q,Ae=$;ue.pattern&&(we=Math.floor(we)),ae=(ie=l.simpleMap(ue.bounds,ue.pattern?e:_.r2l))[0],oe=ie[1];var Se,ke,Me=new Date(we);switch(ue.pattern){case E:ke=g,Se=(oe-ae+(oe<ae?7:0))*d,we+=ae*d-(Me.getUTCDay()*d+Me.getUTCHours()*m+Me.getUTCMinutes()*y+Me.getUTCSeconds()*v+Me.getUTCMilliseconds());break;case A:ke=d,Se=(oe-ae+(oe<ae?24:0))*m,we+=ae*m-(Me.getUTCHours()*m+Me.getUTCMinutes()*y+Me.getUTCSeconds()*v+Me.getUTCMilliseconds());break;default:we=Math.min(ie[0],ie[1]),Se=ke=(Ae=Math.max(ie[0],ie[1]))-we}for(var ve=we;ve<Ae;ve+=ke)fe(ve,ve+Se)}else for(var ge=l.simpleMap(ue.values,_.d2c),De=0;De<ge.length;De++)fe(ae=ge[De],oe=ae+ue.dvalue)}return de.sort(function(_e,Pe){return _e.min-Pe.min}),de},_.makeCalcdata=function(Q,$,ee){var ie,ae,oe,de,le=_.type,fe=le==="date"&&Q[$+"calendar"];if($ in Q){if(ie=Q[$],de=Q._length||l.minRowLength(ie),l.isTypedArray(ie)&&(le==="linear"||le==="log")){if(de===ie.length)return ie;if(ie.subarray)return ie.subarray(0,de)}if(le==="multicategory")return function(Ae,Se){for(var ke=new Array(Se),Me=0;Me<Se;Me++){var ve=(Ae[0]||[])[Me],ge=(Ae[1]||[])[Me];ke[Me]=J([ve,ge])}return ke}(ie,de);for(ae=new Array(de),oe=0;oe<de;oe++)ae[oe]=_.d2c(ie[oe],0,fe,ee)}else{var ue=$+"0"in Q?_.d2c(Q[$+"0"],0,fe):0,we=Q["d"+$]?Number(Q["d"+$]):1;for(ie=Q[{x:"y",y:"x"}[$]],de=Q._length||ie.length,ae=new Array(de),oe=0;oe<de;oe++)ae[oe]=ue+oe*we}if(_.rangebreaks)for(oe=0;oe<de;oe++)ae[oe]=_.maskBreaks(ae[oe]);return ae},_.isValidRange=function(Q){return Array.isArray(Q)&&Q.length===2&&p(_.r2l(Q[0]))&&p(_.r2l(Q[1]))},_.isPtWithinRange=function(Q,$){var ee=_.c2l(Q[k],null,$),ie=_.r2l(_.range[0]),ae=_.r2l(_.range[1]);return ie<ae?ie<=ee&&ee<=ae:ae<=ee&&ee<=ie},_._emptyCategories=function(){_._categories=[],_._categoriesMap={}},_.clearCalc=function(){var Q=_._matchGroup;if(Q){var $=null,ee=null;for(var ie in Q){var ae=S[T.id2name(ie)];if(ae._categories){$=ae._categories,ee=ae._categoriesMap;break}}$&&ee?(_._categories=$,_._categoriesMap=ee):_._emptyCategories()}else _._emptyCategories();if(_._initialCategories)for(var oe=0;oe<_._initialCategories.length;oe++)O(_._initialCategories[oe])},_.sortByInitialCategories=function(){var Q=[];if(_._emptyCategories(),_._initialCategories)for(var $=0;$<_._initialCategories.length;$++)O(_._initialCategories[$]);Q=Q.concat(_._traceIndices);var ee=_._matchGroup;for(var ie in ee)if(C!==ie){var ae=S[T.id2name(ie)];ae._categories=_._categories,ae._categoriesMap=_._categoriesMap,Q=Q.concat(ae._traceIndices)}return Q};var W=S._d3locale;_.type==="date"&&(_._dateFormat=W?W.timeFormat:h,_._extraFormat=S._extraFormat),_._separators=S.separators,_._numFormat=W?W.numberFormat:t.format,delete _._minDtick,delete _._forceTick0}},{"../../constants/numerical":753,"../../lib":778,"./axis_ids":831,"./constants":834,d3:169,"d3-time-format":166,"fast-isnumeric":241}],849:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../../components/color").contrast,p=n("./layout_attributes"),l=n("../array_container_defaults");function e(r){var i=["showexponent","showtickprefix","showticksuffix"].filter(function(u){return r[u]!==void 0});if(i.every(function(u){return r[u]===r[i[0]]})||i.length===1)return r[i[0]]}function o(r,i){function u(s,a){return t.coerce(r,i,p.tickformatstops,s,a)}u("enabled")&&(u("dtickrange"),u("value"))}z.exports=function(r,i,u,s,a,c){c&&c.pass!==1||function(f,g,d,m,y){var v=e(f);d("tickprefix")&&d("showtickprefix",v),d("ticksuffix",y.tickSuffixDflt)&&d("showticksuffix",v)}(r,0,u,0,a),c&&c.pass!==2||function(f,g,d,m,y){var v=e(f);if(d("tickprefix")&&d("showtickprefix",v),d("ticksuffix",y.tickSuffixDflt)&&d("showticksuffix",v),d("showticklabels")){var T=y.font||{},w=g.color,A=(g.ticklabelposition||"").indexOf("inside")!==-1?h(y.bgColor):w&&w!==p.color.dflt?w:T.color;if(t.coerceFont(d,"tickfont",{family:T.family,size:T.size,color:A}),d("tickangle"),m!=="category"){var E=d("tickformat");l(f,g,{name:"tickformatstops",inclusionAttr:"enabled",handleItemDefaults:o}),g.tickformatstops.length||delete g.tickformatstops,E||m==="date"||(d("showexponent",v),d("exponentformat"),d("minexponent"),d("separatethousands"))}}}(r,i,u,s,a)}},{"../../components/color":643,"../../lib":778,"../array_container_defaults":823,"./layout_attributes":842}],850:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("./layout_attributes");z.exports=function(p,l,e,o){var r=t.coerce2(p,l,h,"ticklen"),i=t.coerce2(p,l,h,"tickwidth"),u=t.coerce2(p,l,h,"tickcolor",l.color);e("ticks",o.outerTicks||r||i||u?"outside":"")||(delete l.ticklen,delete l.tickwidth,delete l.tickcolor)}},{"../../lib":778,"./layout_attributes":842}],851:[function(n,z,q){"use strict";var t=n("./clean_ticks"),h=n("../../lib").isArrayOrTypedArray;z.exports=function(p,l,e,o){function r(f){var g=p[f];return g!==void 0?g:(l._template||{})[f]}var i=r("tick0"),u=r("dtick"),s=r("tickvals"),a=e("tickmode",h(s)?"array":u?"linear":"auto");if(a==="auto")e("nticks");else if(a==="linear"){var c=l.dtick=t.dtick(u,o);l.tick0=t.tick0(i,o,l.calendar,c)}else o!=="multicategory"&&(e("tickvals")===void 0?l.tickmode="auto":e("ticktext"))}},{"../../lib":778,"./clean_ticks":833}],852:[function(n,z,q){"use strict";var t=n("d3"),h=n("../../registry"),p=n("../../lib"),l=n("../../components/drawing"),e=n("./axes");z.exports=function(o,r,i,u){var s=o._fullLayout;if(r.length!==0){var a,c,f,g;u&&(a=u());var d=t.ease(i.easing);return o._transitionData._interruptCallbacks.push(function(){return window.cancelAnimationFrame(g),g=null,function(){for(var v={},T=0;T<r.length;T++){var w=r[T],A=w.plotinfo.xaxis,E=w.plotinfo.yaxis;w.xr0&&(v[A._name+".range"]=w.xr0.slice()),w.yr0&&(v[E._name+".range"]=w.yr0.slice())}return h.call("relayout",o,v).then(function(){for(var M=0;M<r.length;M++)m(r[M].plotinfo)})}()}),c=Date.now(),g=window.requestAnimationFrame(function v(){f=Date.now();for(var T=Math.min(1,(f-c)/i.duration),w=d(T),A=0;A<r.length;A++)y(r[A],w);f-c>i.duration?(function(){for(var E={},M=0;M<r.length;M++){var b=r[M],_=b.plotinfo.xaxis,S=b.plotinfo.yaxis;b.xr1&&(E[_._name+".range"]=b.xr1.slice()),b.yr1&&(E[S._name+".range"]=b.yr1.slice())}a&&a(),h.call("relayout",o,E).then(function(){for(var C=0;C<r.length;C++)m(r[C].plotinfo)})}(),g=window.cancelAnimationFrame(v)):g=window.requestAnimationFrame(v)}),Promise.resolve()}function m(v){var T=v.xaxis,w=v.yaxis;s._defs.select("#"+v.clipId+"> rect").call(l.setTranslate,0,0).call(l.setScale,1,1),v.plot.call(l.setTranslate,T._offset,w._offset).call(l.setScale,1,1);var A=v.plot.selectAll(".scatterlayer .trace");A.selectAll(".point").call(l.setPointGroupScale,1,1),A.selectAll(".textpoint").call(l.setTextPointsScale,1,1),A.call(l.hideOutsideRangePoints,v)}function y(v,T){var w=v.plotinfo,A=w.xaxis,E=w.yaxis,M=A._length,b=E._length,_=!!v.xr1,S=!!v.yr1,C=[];if(_){var k=p.simpleMap(v.xr0,A.r2l),L=p.simpleMap(v.xr1,A.r2l),I=k[1]-k[0],R=L[1]-L[0];C[0]=(k[0]*(1-T)+T*L[0]-k[0])/(k[1]-k[0])*M,C[2]=M*(1-T+T*R/I),A.range[0]=A.l2r(k[0]*(1-T)+T*L[0]),A.range[1]=A.l2r(k[1]*(1-T)+T*L[1])}else C[0]=0,C[2]=M;if(S){var V=p.simpleMap(v.yr0,E.r2l),O=p.simpleMap(v.yr1,E.r2l),J=V[1]-V[0],D=O[1]-O[0];C[1]=(V[1]*(1-T)+T*O[1]-V[1])/(V[0]-V[1])*b,C[3]=b*(1-T+T*D/J),E.range[0]=A.l2r(V[0]*(1-T)+T*O[0]),E.range[1]=E.l2r(V[1]*(1-T)+T*O[1])}else C[1]=0,C[3]=b;e.drawOne(o,A,{skipTitle:!0}),e.drawOne(o,E,{skipTitle:!0}),e.redrawComponents(o,[A._id,E._id]);var B=_?M/C[2]:1,N=S?b/C[3]:1,F=_?C[0]:0,H=S?C[1]:0,j=_?C[0]/C[2]*M:0,G=S?C[1]/C[3]*b:0,W=A._offset-j,Q=E._offset-G;w.clipRect.call(l.setTranslate,F,H).call(l.setScale,1/B,1/N),w.plot.call(l.setTranslate,W,Q).call(l.setScale,B,N),l.setPointGroupScale(w.zoomScalePts,1/B,1/N),l.setTextPointsScale(w.zoomScaleTxt,1/B,1/N)}e.redrawComponents(o)}},{"../../components/drawing":665,"../../lib":778,"../../registry":911,"./axes":828,d3:169}],853:[function(n,z,q){"use strict";var t=n("../../registry").traceIs,h=n("./axis_autotype");function p(e){return{v:"x",h:"y"}[e.orientation||"v"]}function l(e,o){var r=p(e),i=t(e,"box-violin"),u=t(e._fullInput||{},"candlestick");return i&&!u&&o===r&&e[r]===void 0&&e[r+"0"]===void 0}z.exports=function(e,o,r,i){r("autotypenumbers",i.autotypenumbersDflt),r("type",(i.splomStash||{}).type)==="-"&&(function(u,s){if(u.type==="-"){var a,c=u._id,f=c.charAt(0);c.indexOf("scene")!==-1&&(c=f);var g=function(E,M,b){for(var _=0;_<E.length;_++){var S=E[_];if(S.type==="splom"&&S._length>0&&(S["_"+b+"axes"]||{})[M]||(S[b+"axis"]||b)===M&&(l(S,b)||(S[b]||[]).length||S[b+"0"]))return S}}(s,c,f);if(g){if(g.type==="histogram"&&f==={v:"y",h:"x"}[g.orientation||"v"])return void(u.type="linear");var d=f+"calendar",m=g[d],y={noMultiCategory:!t(g,"cartesian")||t(g,"noMultiCategory")};if(g.type==="box"&&g._hasPreCompStats&&f==={h:"x",v:"y"}[g.orientation||"v"]&&(y.noMultiCategory=!0),y.autotypenumbers=u.autotypenumbers,l(g,f)){var v=p(g),T=[];for(a=0;a<s.length;a++){var w=s[a];t(w,"box-violin")&&(w[f+"axis"]||f)===c&&(w[v]!==void 0?T.push(w[v][0]):w.name!==void 0?T.push(w.name):T.push("text"),w[d]!==m&&(m=void 0))}u.type=h(T,m,y)}else if(g.type==="splom"){var A=g.dimensions[g._axesDim[c]];A.visible&&(u.type=h(A.values,m,y))}else u.type=h(g[f]||[g[f+"0"]],m,y)}}}(o,i.data),o.type==="-"?o.type="linear":e.type=o.type)}},{"../../registry":911,"./axis_autotype":829}],854:[function(n,z,q){"use strict";var t=n("../registry"),h=n("../lib");function p(r,i,u){var s,a,c,f=!1;if(i.type==="data")s=r._fullData[i.traces!==null?i.traces[0]:0];else{if(i.type!=="layout")return!1;s=r._fullLayout}return a=h.nestedProperty(s,i.prop).get(),(c=u[i.type]=u[i.type]||{}).hasOwnProperty(i.prop)&&c[i.prop]!==a&&(f=!0),c[i.prop]=a,{changed:f,value:a}}function l(r,i){var u=[],s=i[0],a={};if(typeof s=="string")a[s]=i[1];else{if(!h.isPlainObject(s))return u;a=s}return o(a,function(c,f,g){u.push({type:"layout",prop:c,value:g})},"",0),u}function e(r,i){var u,s,a,c,f=[];if(s=i[0],a=i[1],u=i[2],c={},typeof s=="string")c[s]=a;else{if(!h.isPlainObject(s))return f;c=s,u===void 0&&(u=a)}return u===void 0&&(u=null),o(c,function(g,d,m){var y,v;if(Array.isArray(m)){v=m.slice();var T=Math.min(v.length,r.data.length);u&&(T=Math.min(T,u.length)),y=[];for(var w=0;w<T;w++)y[w]=u?u[w]:w}else v=m,y=u?u.slice():null;if(y===null)Array.isArray(v)&&(v=v[0]);else if(Array.isArray(y)){if(!Array.isArray(v)){var A=v;v=[];for(var E=0;E<y.length;E++)v[E]=A}v.length=Math.min(y.length,v.length)}f.push({type:"data",prop:g,traces:y,value:v})},"",0),f}function o(r,i,u,s){Object.keys(r).forEach(function(a){var c=r[a];if(a[0]!=="_"){var f=u+(s>0?".":"")+a;h.isPlainObject(c)?o(c,i,f,s+1):i(f,a,c)}})}q.manageCommandObserver=function(r,i,u,s){var a={},c=!0;i&&i._commandObserver&&(a=i._commandObserver),a.cache||(a.cache={}),a.lookupTable={};var f=q.hasSimpleAPICommandBindings(r,u,a.lookupTable);if(i&&i._commandObserver){if(f)return a;if(i._commandObserver.remove)return i._commandObserver.remove(),i._commandObserver=null,a}if(f){p(r,f,a.cache),a.check=function(){if(c){var m=p(r,f,a.cache);return m.changed&&s&&a.lookupTable[m.value]!==void 0&&(a.disable(),Promise.resolve(s({value:m.value,type:f.type,prop:f.prop,traces:f.traces,index:a.lookupTable[m.value]})).then(a.enable,a.enable)),m.changed}};for(var g=["plotly_relayout","plotly_redraw","plotly_restyle","plotly_update","plotly_animatingframe","plotly_afterplot"],d=0;d<g.length;d++)r._internalOn(g[d],a.check);a.remove=function(){for(var m=0;m<g.length;m++)r._removeInternalListener(g[m],a.check)}}else h.log("Unable to automatically bind plot updates to API command"),a.lookupTable={},a.remove=function(){};return a.disable=function(){c=!1},a.enable=function(){c=!0},i&&(i._commandObserver=a),a},q.hasSimpleAPICommandBindings=function(r,i,u){var s,a,c=i.length;for(s=0;s<c;s++){var f,g=i[s],d=g.method,m=g.args;if(Array.isArray(m)||(m=[]),!d)return!1;var y=q.computeAPICommandBindings(r,d,m);if(y.length!==1)return!1;if(a){if((f=y[0]).type!==a.type||f.prop!==a.prop)return!1;if(Array.isArray(a.traces)){if(!Array.isArray(f.traces))return!1;f.traces.sort();for(var v=0;v<a.traces.length;v++)if(a.traces[v]!==f.traces[v])return!1}else if(f.prop!==a.prop)return!1}else a=y[0],Array.isArray(a.traces)&&a.traces.sort();var T=(f=y[0]).value;if(Array.isArray(T)){if(T.length!==1)return!1;T=T[0]}u&&(u[T]=s)}return a},q.executeAPICommand=function(r,i,u){if(i==="skip")return Promise.resolve();var s=t.apiMethodRegistry[i],a=[r];Array.isArray(u)||(u=[]);for(var c=0;c<u.length;c++)a.push(u[c]);return s.apply(null,a).catch(function(f){return h.warn("API call to Plotly."+i+" rejected.",f),Promise.reject(f)})},q.computeAPICommandBindings=function(r,i,u){var s;switch(Array.isArray(u)||(u=[]),i){case"restyle":s=e(r,u);break;case"relayout":s=l(r,u);break;case"update":s=e(r,[u[0],u[2]]).concat(l(r,[u[1]]));break;case"animate":s=function(a,c){return Array.isArray(c[0])&&c[0].length===1&&["string","number"].indexOf(typeof c[0][0])!==-1?[{type:"layout",prop:"_currentFrame",value:c[0][0].toString()}]:[]}(0,u);break;default:s=[]}return s}},{"../lib":778,"../registry":911}],855:[function(n,z,q){"use strict";var t=n("../lib/extend").extendFlat;q.attributes=function(h,p){p=p||{};var l={valType:"info_array",editType:(h=h||{}).editType,items:[{valType:"number",min:0,max:1,editType:h.editType},{valType:"number",min:0,max:1,editType:h.editType}],dflt:[0,1]},e=(h.name&&h.name,h.trace,p.description&&p.description,{x:t({},l,{}),y:t({},l,{}),editType:h.editType});return h.noGridCell||(e.row={valType:"integer",min:0,dflt:0,editType:h.editType},e.column={valType:"integer",min:0,dflt:0,editType:h.editType}),e},q.defaults=function(h,p,l,e){var o=e&&e.x||[0,1],r=e&&e.y||[0,1],i=p.grid;if(i){var u=l("domain.column");u!==void 0&&(u<i.columns?o=i._domains.x[u]:delete h.domain.column);var s=l("domain.row");s!==void 0&&(s<i.rows?r=i._domains.y[s]:delete h.domain.row)}var a=l("domain.x",o),c=l("domain.y",r);a[0]<a[1]||(h.domain.x=o.slice()),c[0]<c[1]||(h.domain.y=r.slice())}},{"../lib/extend":768}],856:[function(n,z,q){"use strict";z.exports=function(t){var h=t.editType,p=t.colorEditType;p===void 0&&(p=h);var l={family:{valType:"string",noBlank:!0,strict:!0,editType:h},size:{valType:"number",min:1,editType:h},color:{valType:"color",editType:p},editType:h};return t.arrayOk&&(l.family.arrayOk=!0,l.size.arrayOk=!0,l.color.arrayOk=!0),l}},{}],857:[function(n,z,q){"use strict";z.exports={_isLinkedToArray:"frames_entry",group:{valType:"string"},name:{valType:"string"},traces:{valType:"any"},baseframe:{valType:"string"},data:{valType:"any"},layout:{valType:"any"}}},{}],858:[function(n,z,q){"use strict";q.projNames={equirectangular:"equirectangular",mercator:"mercator",orthographic:"orthographic","natural earth":"naturalEarth",kavrayskiy7:"kavrayskiy7",miller:"miller",robinson:"robinson",eckert4:"eckert4","azimuthal equal area":"azimuthalEqualArea","azimuthal equidistant":"azimuthalEquidistant","conic equal area":"conicEqualArea","conic conformal":"conicConformal","conic equidistant":"conicEquidistant",gnomonic:"gnomonic",stereographic:"stereographic",mollweide:"mollweide",hammer:"hammer","transverse mercator":"transverseMercator","albers usa":"albersUsa","winkel tripel":"winkel3",aitoff:"aitoff",sinusoidal:"sinusoidal"},q.axesNames=["lonaxis","lataxis"],q.lonaxisSpan={orthographic:180,"azimuthal equal area":360,"azimuthal equidistant":360,"conic conformal":180,gnomonic:160,stereographic:180,"transverse mercator":180,"*":360},q.lataxisSpan={"conic conformal":150,stereographic:179.5,"*":180},q.scopeDefaults={world:{lonaxisRange:[-180,180],lataxisRange:[-90,90],projType:"equirectangular",projRotate:[0,0,0]},usa:{lonaxisRange:[-180,-50],lataxisRange:[15,80],projType:"albers usa"},europe:{lonaxisRange:[-30,60],lataxisRange:[30,85],projType:"conic conformal",projRotate:[15,0,0],projParallels:[0,60]},asia:{lonaxisRange:[22,160],lataxisRange:[-15,55],projType:"mercator",projRotate:[0,0,0]},africa:{lonaxisRange:[-30,60],lataxisRange:[-40,40],projType:"mercator",projRotate:[0,0,0]},"north america":{lonaxisRange:[-180,-45],lataxisRange:[5,85],projType:"conic conformal",projRotate:[-100,0,0],projParallels:[29.5,45.5]},"south america":{lonaxisRange:[-100,-30],lataxisRange:[-60,15],projType:"mercator",projRotate:[0,0,0]}},q.clipPad=.001,q.precision=.1,q.landColor="#F0DC82",q.waterColor="#3399FF",q.locationmodeToLayer={"ISO-3":"countries","USA-states":"subunits","country names":"countries"},q.sphereSVG={type:"Sphere"},q.fillLayers={ocean:1,land:1,lakes:1},q.lineLayers={subunits:1,countries:1,coastlines:1,rivers:1,frame:1},q.layers=["bg","ocean","land","lakes","subunits","countries","coastlines","rivers","lataxis","lonaxis","frame","backplot","frontplot"],q.layersForChoropleth=["bg","ocean","land","subunits","countries","coastlines","lataxis","lonaxis","frame","backplot","rivers","lakes","frontplot"],q.layerNameToAdjective={ocean:"ocean",land:"land",lakes:"lake",subunits:"subunit",countries:"country",coastlines:"coastline",rivers:"river",frame:"frame"}},{}],859:[function(n,z,q){"use strict";var t=n("d3"),h=n("../../registry"),p=n("../../lib"),l=p.strTranslate,e=n("../../components/color"),o=n("../../components/drawing"),r=n("../../components/fx"),i=n("../plots"),u=n("../cartesian/axes"),s=n("../cartesian/autorange").getAutoRange,a=n("../../components/dragelement"),c=n("../cartesian/select").prepSelect,f=n("../cartesian/select").clearSelect,g=n("../cartesian/select").selectOnClick,d=n("./zoom"),m=n("./constants"),y=n("../../lib/geo_location_utils"),v=n("../../lib/topojson_utils"),T=n("topojson-client").feature;function w(M){this.id=M.id,this.graphDiv=M.graphDiv,this.container=M.container,this.topojsonURL=M.topojsonURL,this.isStatic=M.staticPlot,this.topojsonName=null,this.topojson=null,this.projection=null,this.scope=null,this.viewInitial=null,this.fitScale=null,this.bounds=null,this.midPt=null,this.hasChoropleth=!1,this.traceHash={},this.layers={},this.basePaths={},this.dataPaths={},this.dataPoints={},this.clipDef=null,this.clipRect=null,this.bgRect=null,this.makeFramework()}n("./projections")(t);var A=w.prototype;function E(M,b){var _=m.clipPad,S=M[0]+_,C=M[1]-_,k=b[0]+_,L=b[1]-_;S>0&&C<0&&(C+=360);var I=(C-S)/4;return{type:"Polygon",coordinates:[[[S,k],[S,L],[S+I,L],[S+2*I,L],[S+3*I,L],[C,L],[C,k],[C-I,k],[C-2*I,k],[C-3*I,k],[S,k]]]}}z.exports=function(M){return new w(M)},A.plot=function(M,b,_){var S=this,C=b[this.id],k=[],L=!1;for(var I in m.layerNameToAdjective)if(I!=="frame"&&C["show"+I]){L=!0;break}for(var R=0;R<M.length;R++)if(M[0][0].trace.locationmode){L=!0;break}if(L){var V=v.getTopojsonName(C);S.topojson!==null&&V===S.topojsonName||(S.topojsonName=V,PlotlyGeoAssets.topojson[S.topojsonName]===void 0&&k.push(S.fetchTopojson()))}k=k.concat(y.fetchTraceGeoData(M)),_.push(new Promise(function(O,J){Promise.all(k).then(function(){S.topojson=PlotlyGeoAssets.topojson[S.topojsonName],S.update(M,b),O()}).catch(J)}))},A.fetchTopojson=function(){var M=this,b=v.getTopojsonPath(M.topojsonURL,M.topojsonName);return new Promise(function(_,S){t.json(b,function(C,k){if(C)return C.status===404?S(new Error(["plotly.js could not find topojson file at",b,".","Make sure the *topojsonURL* plot config option","is set properly."].join(" "))):S(new Error(["unexpected error while fetching topojson file at",b].join(" ")));PlotlyGeoAssets.topojson[M.topojsonName]=k,_()})})},A.update=function(M,b){var _=b[this.id];this.hasChoropleth=!1;for(var S=0;S<M.length;S++){var C=M[S],k=C[0].trace;k.type==="choropleth"&&(this.hasChoropleth=!0),k.visible===!0&&k._length>0&&k._module.calcGeoJSON(C,b)}if(!this.updateProjection(M,b)){this.viewInitial&&this.scope===_.scope||this.saveViewInitial(_),this.scope=_.scope,this.updateBaseLayers(b,_),this.updateDims(b,_),this.updateFx(b,_),i.generalUpdatePerTraceModule(this.graphDiv,this,M,_);var L=this.layers.frontplot.select(".scatterlayer");this.dataPoints.point=L.selectAll(".point"),this.dataPoints.text=L.selectAll("text"),this.dataPaths.line=L.selectAll(".js-line");var I=this.layers.backplot.select(".choroplethlayer");this.dataPaths.choropleth=I.selectAll("path"),this.render()}},A.updateProjection=function(M,b){var _=this.graphDiv,S=b[this.id],C=b._size,k=S.domain,L=S.projection,I=S.lonaxis,R=S.lataxis,V=I._ax,O=R._ax,J=this.projection=function(ve){for(var ge=ve.projection.type,De=t.geo[m.projNames[ge]](),_e=ve._isClipped?m.lonaxisSpan[ge]/2:null,Pe=["center","rotate","parallels","clipExtent"],Fe=function(et){return et?De:[]},ze=0;ze<Pe.length;ze++){var He=Pe[ze];typeof De[He]!="function"&&(De[He]=Fe)}return De.isLonLatOverEdges=function(et){if(De(et)===null)return!0;if(_e){var Re=De.rotate();return t.geo.distance(et,[-Re[0],-Re[1]])>_e*Math.PI/180}return!1},De.getPath=function(){return t.geo.path().projection(De)},De.getBounds=function(et){return De.getPath().bounds(et)},De.fitExtent=function(et,Re){var Ze=et[1][0]-et[0][0],Ke=et[1][1]-et[0][1],$e=De.clipExtent&&De.clipExtent();De.scale(150).translate([0,0]),$e&&De.clipExtent(null);var rt=De.getBounds(Re),at=Math.min(Ze/(rt[1][0]-rt[0][0]),Ke/(rt[1][1]-rt[0][1])),lt=+et[0][0]+(Ze-at*(rt[1][0]+rt[0][0]))/2,gt=+et[0][1]+(Ke-at*(rt[1][1]+rt[0][1]))/2;return $e&&De.clipExtent($e),De.scale(150*at).translate([lt,gt])},De.precision(m.precision),_e&&De.clipAngle(_e-m.clipPad),De}(S),D=[[C.l+C.w*k.x[0],C.t+C.h*(1-k.y[1])],[C.l+C.w*k.x[1],C.t+C.h*(1-k.y[0])]],B=S.center||{},N=L.rotation||{},F=I.range||[],H=R.range||[];if(S.fitbounds){V._length=D[1][0]-D[0][0],O._length=D[1][1]-D[0][1],V.range=s(_,V),O.range=s(_,O);var j=(V.range[0]+V.range[1])/2,G=(O.range[0]+O.range[1])/2;if(S._isScoped)B={lon:j,lat:G};else if(S._isClipped){B={lon:j,lat:G},N={lon:j,lat:G,roll:N.roll};var W=L.type,Q=m.lonaxisSpan[W]/2||180,$=m.lataxisSpan[W]/2||90;F=[j-Q,j+Q],H=[G-$,G+$]}else B={lon:j,lat:G},N={lon:j,lat:N.lat,roll:N.roll}}J.center([B.lon-N.lon,B.lat-N.lat]).rotate([-N.lon,-N.lat,N.roll]).parallels(L.parallels);var ee=E(F,H);J.fitExtent(D,ee);var ie=this.bounds=J.getBounds(ee),ae=this.fitScale=J.scale(),oe=J.translate();if(!isFinite(ie[0][0])||!isFinite(ie[0][1])||!isFinite(ie[1][0])||!isFinite(ie[1][1])||isNaN(oe[0])||isNaN(oe[0])){for(var de=["fitbounds","projection.rotation","center","lonaxis.range","lataxis.range"],le="Invalid geo settings, relayout'ing to default view.",fe={},ue=0;ue<de.length;ue++)fe[this.id+"."+de[ue]]=null;return this.viewInitial=null,p.warn(le),_._promises.push(h.call("relayout",_,fe)),le}if(S.fitbounds){var we=J.getBounds(E(V.range,O.range)),Ae=Math.min((ie[1][0]-ie[0][0])/(we[1][0]-we[0][0]),(ie[1][1]-ie[0][1])/(we[1][1]-we[0][1]));isFinite(Ae)?J.scale(Ae*ae):p.warn("Something went wrong during"+this.id+"fitbounds computations.")}else J.scale(L.scale*ae);var Se=this.midPt=[(ie[0][0]+ie[1][0])/2,(ie[0][1]+ie[1][1])/2];if(J.translate([oe[0]+(Se[0]-oe[0]),oe[1]+(Se[1]-oe[1])]).clipExtent(ie),S._isAlbersUsa){var ke=J([B.lon,B.lat]),Me=J.translate();J.translate([Me[0]-(ke[0]-Me[0]),Me[1]-(ke[1]-Me[1])])}},A.updateBaseLayers=function(M,b){var _=this,S=_.topojson,C=_.layers,k=_.basePaths;function L(J){return J==="lonaxis"||J==="lataxis"}function I(J){return!!m.lineLayers[J]}function R(J){return!!m.fillLayers[J]}var V=(this.hasChoropleth?m.layersForChoropleth:m.layers).filter(function(J){return I(J)||R(J)?b["show"+J]:!L(J)||b[J].showgrid}),O=_.framework.selectAll(".layer").data(V,String);O.exit().each(function(J){delete C[J],delete k[J],t.select(this).remove()}),O.enter().append("g").attr("class",function(J){return"layer "+J}).each(function(J){var D=C[J]=t.select(this);J==="bg"?_.bgRect=D.append("rect").style("pointer-events","all"):L(J)?k[J]=D.append("path").style("fill","none"):J==="backplot"?D.append("g").classed("choroplethlayer",!0):J==="frontplot"?D.append("g").classed("scatterlayer",!0):I(J)?k[J]=D.append("path").style("fill","none").style("stroke-miterlimit",2):R(J)&&(k[J]=D.append("path").style("stroke","none"))}),O.order(),O.each(function(J){var D=k[J],B=m.layerNameToAdjective[J];J==="frame"?D.datum(m.sphereSVG):I(J)||R(J)?D.datum(T(S,S.objects[J])):L(J)&&D.datum(function(N,F,H){var j,G,W,Q=F[N],$=m.scopeDefaults[F.scope];N==="lonaxis"?(j=$.lonaxisRange,G=$.lataxisRange,W=function(we,Ae){return[we,Ae]}):N==="lataxis"&&(j=$.lataxisRange,G=$.lonaxisRange,W=function(we,Ae){return[Ae,we]});var ee={type:"linear",range:[j[0],j[1]-1e-6],tick0:Q.tick0,dtick:Q.dtick};u.setConvert(ee,H);var ie=u.calcTicks(ee);F.isScoped||N!=="lonaxis"||ie.pop();for(var ae=ie.length,oe=new Array(ae),de=0;de<ae;de++)for(var le=ie[de].x,fe=oe[de]=[],ue=G[0];ue<G[1]+2.5;ue+=2.5)fe.push(W(le,ue));return{type:"MultiLineString",coordinates:oe}}(J,b,M)).call(e.stroke,b[J].gridcolor).call(o.dashLine,"",b[J].gridwidth),I(J)?D.call(e.stroke,b[B+"color"]).call(o.dashLine,"",b[B+"width"]):R(J)&&D.call(e.fill,b[B+"color"])})},A.updateDims=function(M,b){var _=this.bounds,S=(b.framewidth||0)/2,C=_[0][0]-S,k=_[0][1]-S,L=_[1][0]-C+S,I=_[1][1]-k+S;o.setRect(this.clipRect,C,k,L,I),this.bgRect.call(o.setRect,C,k,L,I).call(e.fill,b.bgcolor),this.xaxis._offset=C,this.xaxis._length=L,this.yaxis._offset=k,this.yaxis._length=I},A.updateFx=function(M,b){var _=this,S=_.graphDiv,C=_.bgRect,k=M.dragmode,L=M.clickmode;if(!_.isStatic){var I;k==="select"?I=function(O,J){(O.range={})[_.id]=[V([J.xmin,J.ymin]),V([J.xmax,J.ymax])]}:k==="lasso"&&(I=function(O,J,D){(O.lassoPoints={})[_.id]=D.filtered.map(V)});var R={element:_.bgRect.node(),gd:S,plotinfo:{id:_.id,xaxis:_.xaxis,yaxis:_.yaxis,fillRangeItems:I},xaxes:[_.xaxis],yaxes:[_.yaxis],subplot:_.id,clickFn:function(O){O===2&&f(S)}};k==="pan"?(C.node().onmousedown=null,C.call(d(_,b)),C.on("dblclick.zoom",function(){var O=_.viewInitial,J={};for(var D in O)J[_.id+"."+D]=O[D];h.call("_guiRelayout",S,J),S.emit("plotly_doubleclick",null)}),S._context._scrollZoom.geo||C.on("wheel.zoom",null)):k!=="select"&&k!=="lasso"||(C.on(".zoom",null),R.prepFn=function(O,J,D){c(O,J,D,R,k)},a.init(R)),C.on("mousemove",function(){var O=_.projection.invert(t.mouse(this));if(!O||isNaN(O[0])||isNaN(O[1]))return a.unhover(S,t.event);_.xaxis.p2c=function(){return O[0]},_.yaxis.p2c=function(){return O[1]},r.hover(S,t.event,_.id)}),C.on("mouseout",function(){S._dragging||a.unhover(S,t.event)}),C.on("click",function(){k!=="select"&&k!=="lasso"&&(L.indexOf("select")>-1&&g(t.event,S,[_.xaxis],[_.yaxis],_.id,R),L.indexOf("event")>-1&&r.click(S,t.event))})}function V(O){return _.projection.invert([O[0]+_.xaxis._offset,O[1]+_.yaxis._offset])}},A.makeFramework=function(){var M=this,b=M.graphDiv,_=b._fullLayout,S="clip"+_._uid+M.id;M.clipDef=_._clips.append("clipPath").attr("id",S),M.clipRect=M.clipDef.append("rect"),M.framework=t.select(M.container).append("g").attr("class","geo "+M.id).call(o.setClipUrl,S,b),M.project=function(C){var k=M.projection(C);return k?[k[0]-M.xaxis._offset,k[1]-M.yaxis._offset]:[null,null]},M.xaxis={_id:"x",c2p:function(C){return M.project(C)[0]}},M.yaxis={_id:"y",c2p:function(C){return M.project(C)[1]}},M.mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},u.setConvert(M.mockAxis,_)},A.saveViewInitial=function(M){var b,_=M.center||{},S=M.projection,C=S.rotation||{};this.viewInitial={fitbounds:M.fitbounds,"projection.scale":S.scale},b=M._isScoped?{"center.lon":_.lon,"center.lat":_.lat}:M._isClipped?{"projection.rotation.lon":C.lon,"projection.rotation.lat":C.lat}:{"center.lon":_.lon,"center.lat":_.lat,"projection.rotation.lon":C.lon},p.extendFlat(this.viewInitial,b)},A.render=function(){var M,b=this.projection,_=b.getPath();function S(k){var L=b(k.lonlat);return L?l(L[0],L[1]):null}function C(k){return b.isLonLatOverEdges(k.lonlat)?"none":null}for(M in this.basePaths)this.basePaths[M].attr("d",_);for(M in this.dataPaths)this.dataPaths[M].attr("d",function(k){return _(k.geojson)});for(M in this.dataPoints)this.dataPoints[M].attr("display",C).attr("transform",S)}},{"../../components/color":643,"../../components/dragelement":662,"../../components/drawing":665,"../../components/fx":683,"../../lib":778,"../../lib/geo_location_utils":771,"../../lib/topojson_utils":806,"../../registry":911,"../cartesian/autorange":827,"../cartesian/axes":828,"../cartesian/select":847,"../plots":891,"./constants":858,"./projections":863,"./zoom":864,d3:169,"topojson-client":579}],860:[function(n,z,q){"use strict";var t=n("../../plots/get_data").getSubplotCalcData,h=n("../../lib").counterRegex,p=n("./geo"),l="geo",e=h(l),o={};o.geo={valType:"subplotid",dflt:l,editType:"calc"},z.exports={attr:l,name:l,idRoot:l,idRegex:e,attrRegex:e,attributes:o,layoutAttributes:n("./layout_attributes"),supplyLayoutDefaults:n("./layout_defaults"),plot:function(r){for(var i=r._fullLayout,u=r.calcdata,s=i._subplots.geo,a=0;a<s.length;a++){var c=s[a],f=t(u,l,c),g=i[c]._subplot;g||(g=p({id:c,graphDiv:r,container:i._geolayer.node(),topojsonURL:r._context.topojsonURL,staticPlot:r._context.staticPlot}),i[c]._subplot=g),g.plot(f,i,r._promises)}},updateFx:function(r){for(var i=r._fullLayout,u=i._subplots.geo,s=0;s<u.length;s++){var a=i[u[s]];a._subplot.updateFx(i,a)}},clean:function(r,i,u,s){for(var a=s._subplots.geo||[],c=0;c<a.length;c++){var f=a[c],g=s[f]._subplot;!i[f]&&g&&(g.framework.remove(),g.clipDef.remove())}}}},{"../../lib":778,"../../plots/get_data":865,"./geo":859,"./layout_attributes":861,"./layout_defaults":862}],861:[function(n,z,q){"use strict";var t=n("../../components/color/attributes"),h=n("../domain").attributes,p=n("./constants"),l=n("../../plot_api/edit_types").overrideAll,e={range:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},showgrid:{valType:"boolean",dflt:!1},tick0:{valType:"number",dflt:0},dtick:{valType:"number"},gridcolor:{valType:"color",dflt:t.lightLine},gridwidth:{valType:"number",min:0,dflt:1}};(z.exports=l({domain:h({name:"geo"},{}),fitbounds:{valType:"enumerated",values:[!1,"locations","geojson"],dflt:!1,editType:"plot"},resolution:{valType:"enumerated",values:[110,50],dflt:110,coerceNumber:!0},scope:{valType:"enumerated",values:Object.keys(p.scopeDefaults),dflt:"world"},projection:{type:{valType:"enumerated",values:Object.keys(p.projNames)},rotation:{lon:{valType:"number"},lat:{valType:"number"},roll:{valType:"number"}},parallels:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},scale:{valType:"number",min:0,dflt:1}},center:{lon:{valType:"number"},lat:{valType:"number"}},visible:{valType:"boolean",dflt:!0},showcoastlines:{valType:"boolean"},coastlinecolor:{valType:"color",dflt:t.defaultLine},coastlinewidth:{valType:"number",min:0,dflt:1},showland:{valType:"boolean",dflt:!1},landcolor:{valType:"color",dflt:p.landColor},showocean:{valType:"boolean",dflt:!1},oceancolor:{valType:"color",dflt:p.waterColor},showlakes:{valType:"boolean",dflt:!1},lakecolor:{valType:"color",dflt:p.waterColor},showrivers:{valType:"boolean",dflt:!1},rivercolor:{valType:"color",dflt:p.waterColor},riverwidth:{valType:"number",min:0,dflt:1},showcountries:{valType:"boolean"},countrycolor:{valType:"color",dflt:t.defaultLine},countrywidth:{valType:"number",min:0,dflt:1},showsubunits:{valType:"boolean"},subunitcolor:{valType:"color",dflt:t.defaultLine},subunitwidth:{valType:"number",min:0,dflt:1},showframe:{valType:"boolean"},framecolor:{valType:"color",dflt:t.defaultLine},framewidth:{valType:"number",min:0,dflt:1},bgcolor:{valType:"color",dflt:t.background},lonaxis:e,lataxis:e},"plot","from-root")).uirevision={valType:"any",editType:"none"}},{"../../components/color/attributes":642,"../../plot_api/edit_types":810,"../domain":855,"./constants":858}],862:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../subplot_defaults"),p=n("../get_data").getSubplotData,l=n("./constants"),e=n("./layout_attributes"),o=l.axesNames;function r(i,u,s,a){var c=p(a.fullData,"geo",a.id).map(function(j){return j._expandedIndex}),f=s("resolution"),g=s("scope"),d=l.scopeDefaults[g],m=s("projection.type",d.projType),y=u._isAlbersUsa=m==="albers usa";y&&(g=u.scope="usa");var v=u._isScoped=g!=="world",T=u._isConic=m.indexOf("conic")!==-1,w=u._isClipped=!!l.lonaxisSpan[m];if(i.visible===!1){var A=t.extendDeep({},u._template);A.showcoastlines=!1,A.showcountries=!1,A.showframe=!1,A.showlakes=!1,A.showland=!1,A.showocean=!1,A.showrivers=!1,A.showsubunits=!1,A.lonaxis&&(A.lonaxis.showgrid=!1),A.lataxis&&(A.lataxis.showgrid=!1),u._template=A}for(var E=s("visible"),M=0;M<o.length;M++){var b,_=o[M],S=[30,10][M];if(v)b=d[_+"Range"];else{var C=l[_+"Span"],k=(C[m]||C["*"])/2,L=s("projection.rotation."+_.substr(0,3),d.projRotate[M]);b=[L-k,L+k]}var I=s(_+".range",b);s(_+".tick0"),s(_+".dtick",S),s(_+".showgrid",!!E&&void 0)&&(s(_+".gridcolor"),s(_+".gridwidth")),u[_]._ax={type:"linear",_id:_.slice(0,3),_traceIndices:c,setScale:t.identity,c2l:t.identity,r2l:t.identity,autorange:!0,range:I.slice(),_m:1,_input:{}}}var R=u.lonaxis.range,V=u.lataxis.range,O=R[0],J=R[1];O>0&&J<0&&(J+=360);var D,B,N,F=(O+J)/2;if(!y){var H=v?d.projRotate:[F,0,0];D=s("projection.rotation.lon",H[0]),s("projection.rotation.lat",H[1]),s("projection.rotation.roll",H[2]),s("showcoastlines",!v&&E)&&(s("coastlinecolor"),s("coastlinewidth")),s("showocean",!!E&&void 0)&&s("oceancolor")}y?(B=-96.6,N=38.7):(B=v?F:D,N=(V[0]+V[1])/2),s("center.lon",B),s("center.lat",N),T&&s("projection.parallels",d.projParallels||[0,60]),s("projection.scale"),s("showland",!!E&&void 0)&&s("landcolor"),s("showlakes",!!E&&void 0)&&s("lakecolor"),s("showrivers",!!E&&void 0)&&(s("rivercolor"),s("riverwidth")),s("showcountries",v&&g!=="usa"&&E)&&(s("countrycolor"),s("countrywidth")),(g==="usa"||g==="north america"&&f===50)&&(s("showsubunits",E),s("subunitcolor"),s("subunitwidth")),v||s("showframe",E)&&(s("framecolor"),s("framewidth")),s("bgcolor"),s("fitbounds")&&(delete u.projection.scale,v?(delete u.center.lon,delete u.center.lat):w?(delete u.center.lon,delete u.center.lat,delete u.projection.rotation.lon,delete u.projection.rotation.lat,delete u.lonaxis.range,delete u.lataxis.range):(delete u.center.lon,delete u.center.lat,delete u.projection.rotation.lon))}z.exports=function(i,u,s){h(i,u,s,{type:"geo",attributes:e,handleDefaults:r,fullData:s,partition:"y"})}},{"../../lib":778,"../get_data":865,"../subplot_defaults":905,"./constants":858,"./layout_attributes":861}],863:[function(n,z,q){"use strict";z.exports=function(t){function h(D,B){return{type:"Feature",id:D.id,properties:D.properties,geometry:p(D.geometry,B)}}function p(D,B){if(!D)return null;if(D.type==="GeometryCollection")return{type:"GeometryCollection",geometries:object.geometries.map(function(F){return p(F,B)})};if(!s.hasOwnProperty(D.type))return null;var N=s[D.type];return t.geo.stream(D,B(N)),N.result()}t.geo.project=function(D,B){var N=B.stream;if(!N)throw new Error("not yet supported");return(D&&l.hasOwnProperty(D.type)?l[D.type]:p)(D,N)};var l={Feature:h,FeatureCollection:function(D,B){return{type:"FeatureCollection",features:D.features.map(function(N){return h(N,B)})}}},e=[],o=[],r={point:function(D,B){e.push([D,B])},result:function(){var D=e.length?e.length<2?{type:"Point",coordinates:e[0]}:{type:"MultiPoint",coordinates:e}:null;return e=[],D}},i={lineStart:a,point:function(D,B){e.push([D,B])},lineEnd:function(){e.length&&(o.push(e),e=[])},result:function(){var D=o.length?o.length<2?{type:"LineString",coordinates:o[0]}:{type:"MultiLineString",coordinates:o}:null;return o=[],D}},u={polygonStart:a,lineStart:a,point:function(D,B){e.push([D,B])},lineEnd:function(){var D=e.length;if(D){do e.push(e[0].slice());while(++D<4);o.push(e),e=[]}},polygonEnd:a,result:function(){if(!o.length)return null;var D=[],B=[];return o.forEach(function(N){(function(F){if((H=F.length)<4)return!1;for(var H,j=0,G=F[H-1][1]*F[0][0]-F[H-1][0]*F[0][1];++j<H;)G+=F[j-1][1]*F[j][0]-F[j-1][0]*F[j][1];return G<=0})(N)?D.push([N]):B.push(N)}),B.forEach(function(N){var F=N[0];D.some(function(H){if(function(j,G){for(var W=G[0],Q=G[1],$=!1,ee=0,ie=j.length,ae=ie-1;ee<ie;ae=ee++){var oe=j[ee],de=oe[0],le=oe[1],fe=j[ae],ue=fe[0],we=fe[1];le>Q^we>Q&&W<(ue-de)*(Q-le)/(we-le)+de&&($=!$)}return $}(H[0],F))return H.push(N),!0})||D.push([N])}),o=[],D.length?D.length>1?{type:"MultiPolygon",coordinates:D}:{type:"Polygon",coordinates:D[0]}:null}},s={Point:r,MultiPoint:r,LineString:i,MultiLineString:i,Polygon:u,MultiPolygon:u,Sphere:u};function a(){}var c=1e-6,f=Math.PI,g=f/2,d=(Math.sqrt(f),f/180),m=180/f;function y(D){return D>1?g:D<-1?-g:Math.asin(D)}function v(D){return D>1?0:D<-1?f:Math.acos(D)}var T=t.geo.projection,w=t.geo.projectionMutator;function A(D,B){var N=(2+g)*Math.sin(B);B/=2;for(var F=0,H=1/0;F<10&&Math.abs(H)>c;F++){var j=Math.cos(B);B-=H=(B+Math.sin(B)*(j+2)-N)/(2*j*(1+j))}return[2/Math.sqrt(f*(4+f))*D*(1+Math.cos(B)),2*Math.sqrt(f/(4+f))*Math.sin(B)]}t.geo.interrupt=function(D){var B,N=[[[[-f,0],[0,g],[f,0]]],[[[-f,0],[0,-g],[f,0]]]];function F($,ee){for(var ie=ee<0?-1:1,ae=N[+(ee<0)],oe=0,de=ae.length-1;oe<de&&$>ae[oe][2][0];++oe);var le=D($-ae[oe][1][0],ee);return le[0]+=D(ae[oe][1][0],ie*ee>ie*ae[oe][0][1]?ae[oe][0][1]:ee)[0],le}function H(){B=N.map(function($){return $.map(function(ee){var ie,ae=D(ee[0][0],ee[0][1])[0],oe=D(ee[2][0],ee[2][1])[0],de=D(ee[1][0],ee[0][1])[1],le=D(ee[1][0],ee[1][1])[1];return de>le&&(ie=de,de=le,le=ie),[[ae,de],[oe,le]]})})}D.invert&&(F.invert=function($,ee){for(var ie=B[+(ee<0)],ae=N[+(ee<0)],oe=0,de=ie.length;oe<de;++oe){var le=ie[oe];if(le[0][0]<=$&&$<le[1][0]&&le[0][1]<=ee&&ee<le[1][1]){var fe=D.invert($-D(ae[oe][1][0],0)[0],ee);return fe[0]+=ae[oe][1][0],Q(F(fe[0],fe[1]),[$,ee])?fe:null}}});var j=t.geo.projection(F),G=j.stream;function W($,ee){for(var ie,ae,oe,de=-1,le=$.length,fe=$[0],ue=[];++de<le;){ae=((ie=$[de])[0]-fe[0])/ee,oe=(ie[1]-fe[1])/ee;for(var we=0;we<ee;++we)ue.push([fe[0]+we*ae,fe[1]+we*oe]);fe=ie}return ue.push(ie),ue}function Q($,ee){return Math.abs($[0]-ee[0])<c&&Math.abs($[1]-ee[1])<c}return j.stream=function($){var ee=j.rotate(),ie=G($),ae=(j.rotate([0,0]),G($));return j.rotate(ee),ie.sphere=function(){t.geo.stream(function(){for(var oe=1e-6,de=[],le=0,fe=N[0].length;le<fe;++le){var ue=180*(Me=N[0][le])[0][0]/f,we=180*Me[0][1]/f,Ae=180*Me[1][1]/f,Se=180*Me[2][0]/f,ke=180*Me[2][1]/f;de.push(W([[ue+oe,we+oe],[ue+oe,Ae-oe],[Se-oe,Ae-oe],[Se-oe,ke+oe]],30))}for(le=N[1].length-1;le>=0;--le){var Me;ue=180*(Me=N[1][le])[0][0]/f,we=180*Me[0][1]/f,Ae=180*Me[1][1]/f,Se=180*Me[2][0]/f,ke=180*Me[2][1]/f,de.push(W([[Se-oe,ke-oe],[Se-oe,Ae+oe],[ue+oe,Ae+oe],[ue+oe,we-oe]],30))}return{type:"Polygon",coordinates:[t.merge(de)]}}(),ae)},ie},j.lobes=function($){return arguments.length?(N=$.map(function(ee){return ee.map(function(ie){return[[ie[0][0]*f/180,ie[0][1]*f/180],[ie[1][0]*f/180,ie[1][1]*f/180],[ie[2][0]*f/180,ie[2][1]*f/180]]})}),H(),j):N.map(function(ee){return ee.map(function(ie){return[[180*ie[0][0]/f,180*ie[0][1]/f],[180*ie[1][0]/f,180*ie[1][1]/f],[180*ie[2][0]/f,180*ie[2][1]/f]]})})},j},A.invert=function(D,B){var N=.5*B*Math.sqrt((4+f)/f),F=y(N),H=Math.cos(F);return[D/(2/Math.sqrt(f*(4+f))*(1+H)),y((F+N*(H+2))/(2+g))]},(t.geo.eckert4=function(){return T(A)}).raw=A;var E=t.geo.azimuthalEqualArea.raw;function M(D,B){if(arguments.length<2&&(B=D),B===1)return E;if(B===1/0)return b;function N(F,H){var j=E(F/B,H);return j[0]*=D,j}return N.invert=function(F,H){var j=E.invert(F/D,H);return j[0]*=B,j},N}function b(D,B){return[D*Math.cos(B)/Math.cos(B/=2),2*Math.sin(B)]}function _(D,B){return[3*D/(2*f)*Math.sqrt(f*f/3-B*B),B]}function S(D,B){return[D,1.25*Math.log(Math.tan(f/4+.4*B))]}function C(D){return function(B){var N,F=D*Math.sin(B),H=30;do B-=N=(B+Math.sin(B)-F)/(1+Math.cos(B));while(Math.abs(N)>c&&--H>0);return B/2}}b.invert=function(D,B){var N=2*y(B/2);return[D*Math.cos(N/2)/Math.cos(N),N]},(t.geo.hammer=function(){var D=2,B=w(M),N=B(D);return N.coefficient=function(F){return arguments.length?B(D=+F):D},N}).raw=M,_.invert=function(D,B){return[2/3*f*D/Math.sqrt(f*f/3-B*B),B]},(t.geo.kavrayskiy7=function(){return T(_)}).raw=_,S.invert=function(D,B){return[D,2.5*Math.atan(Math.exp(.8*B))-.625*f]},(t.geo.miller=function(){return T(S)}).raw=S,C(f);var k=function(D,B,N){var F=C(N);function H(j,G){return[D*j*Math.cos(G=F(G)),B*Math.sin(G)]}return H.invert=function(j,G){var W=y(G/B);return[j/(D*Math.cos(W)),y((2*W+Math.sin(2*W))/N)]},H}(Math.SQRT2/g,Math.SQRT2,f);function L(D,B){var N=B*B,F=N*N;return[D*(.8707-.131979*N+F*(F*(.003971*N-.001529*F)-.013791)),B*(1.007226+N*(.015085+F*(.028874*N-.044475-.005916*F)))]}(t.geo.mollweide=function(){return T(k)}).raw=k,L.invert=function(D,B){var N,F=B,H=25;do{var j=F*F,G=j*j;F-=N=(F*(1.007226+j*(.015085+G*(.028874*j-.044475-.005916*G)))-B)/(1.007226+j*(.045255+G*(.259866*j-.311325-.005916*11*G)))}while(Math.abs(N)>c&&--H>0);return[D/(.8707+(j=F*F)*(j*(j*j*j*(.003971-.001529*j)-.013791)-.131979)),F]},(t.geo.naturalEarth=function(){return T(L)}).raw=L;var I=[[.9986,-.062],[1,0],[.9986,.062],[.9954,.124],[.99,.186],[.9822,.248],[.973,.31],[.96,.372],[.9427,.434],[.9216,.4958],[.8962,.5571],[.8679,.6176],[.835,.6769],[.7986,.7346],[.7597,.7903],[.7186,.8435],[.6732,.8936],[.6213,.9394],[.5722,.9761],[.5322,1]];function R(D,B){var N,F=Math.min(18,36*Math.abs(B)/f),H=Math.floor(F),j=F-H,G=(N=I[H])[0],W=N[1],Q=(N=I[++H])[0],$=N[1],ee=(N=I[Math.min(19,++H)])[0],ie=N[1];return[D*(Q+j*(ee-G)/2+j*j*(ee-2*Q+G)/2),(B>0?g:-g)*($+j*(ie-W)/2+j*j*(ie-2*$+W)/2)]}function V(D,B){return[D*Math.cos(B),B]}function O(D,B){var N,F=Math.cos(B),H=(N=v(F*Math.cos(D/=2)))?N/Math.sin(N):1;return[2*F*Math.sin(D)*H,Math.sin(B)*H]}function J(D,B){var N=O(D,B);return[(N[0]+D/g)/2,(N[1]+B)/2]}I.forEach(function(D){D[1]*=1.0144}),R.invert=function(D,B){var N=B/g,F=90*N,H=Math.min(18,Math.abs(F/5)),j=Math.max(0,Math.floor(H));do{var G=I[j][1],W=I[j+1][1],Q=I[Math.min(19,j+2)][1],$=Q-G,ee=Q-2*W+G,ie=2*(Math.abs(N)-W)/$,ae=ee/$,oe=ie*(1-ae*ie*(1-2*ae*ie));if(oe>=0||j===1){F=(B>=0?5:-5)*(oe+H);var de,le=50;do oe=(H=Math.min(18,Math.abs(F)/5))-(j=Math.floor(H)),G=I[j][1],W=I[j+1][1],Q=I[Math.min(19,j+2)][1],F-=(de=(B>=0?g:-g)*(W+oe*(Q-G)/2+oe*oe*(Q-2*W+G)/2)-B)*m;while(Math.abs(de)>1e-12&&--le>0);break}}while(--j>=0);var fe=I[j][0],ue=I[j+1][0],we=I[Math.min(19,j+2)][0];return[D/(ue+oe*(we-fe)/2+oe*oe*(we-2*ue+fe)/2),F*d]},(t.geo.robinson=function(){return T(R)}).raw=R,V.invert=function(D,B){return[D/Math.cos(B),B]},(t.geo.sinusoidal=function(){return T(V)}).raw=V,O.invert=function(D,B){if(!(D*D+4*B*B>f*f+c)){var N=D,F=B,H=25;do{var j,G=Math.sin(N),W=Math.sin(N/2),Q=Math.cos(N/2),$=Math.sin(F),ee=Math.cos(F),ie=Math.sin(2*F),ae=$*$,oe=ee*ee,de=W*W,le=1-oe*Q*Q,fe=le?v(ee*Q)*Math.sqrt(j=1/le):j=0,ue=2*fe*ee*W-D,we=fe*$-B,Ae=j*(oe*de+fe*ee*Q*ae),Se=j*(.5*G*ie-2*fe*$*W),ke=.25*j*(ie*W-fe*$*oe*G),Me=j*(ae*Q+fe*de*ee),ve=Se*ke-Me*Ae;if(!ve)break;var ge=(we*Se-ue*Me)/ve,De=(ue*ke-we*Ae)/ve;N-=ge,F-=De}while((Math.abs(ge)>c||Math.abs(De)>c)&&--H>0);return[N,F]}},(t.geo.aitoff=function(){return T(O)}).raw=O,J.invert=function(D,B){var N=D,F=B,H=25;do{var j,G=Math.cos(F),W=Math.sin(F),Q=Math.sin(2*F),$=W*W,ee=G*G,ie=Math.sin(N),ae=Math.cos(N/2),oe=Math.sin(N/2),de=oe*oe,le=1-ee*ae*ae,fe=le?v(G*ae)*Math.sqrt(j=1/le):j=0,ue=.5*(2*fe*G*oe+N/g)-D,we=.5*(fe*W+F)-B,Ae=.5*j*(ee*de+fe*G*ae*$)+.5/g,Se=j*(ie*Q/4-fe*W*oe),ke=.125*j*(Q*oe-fe*W*ee*ie),Me=.5*j*($*ae+fe*de*G)+.5,ve=Se*ke-Me*Ae,ge=(we*Se-ue*Me)/ve,De=(ue*ke-we*Ae)/ve;N-=ge,F-=De}while((Math.abs(ge)>c||Math.abs(De)>c)&&--H>0);return[N,F]},(t.geo.winkel3=function(){return T(J)}).raw=J}},{}],864:[function(n,z,q){"use strict";var t=n("d3"),h=n("../../lib"),p=n("../../registry"),l=Math.PI/180,e=180/Math.PI,o={cursor:"pointer"},r={cursor:"auto"};function i(M,b){return t.behavior.zoom().translate(b.translate()).scale(b.scale())}function u(M,b,_){var S=M.id,C=M.graphDiv,k=C.layout,L=k[S],I=C._fullLayout,R=I[S],V={},O={};function J(D,B){V[S+"."+D]=h.nestedProperty(L,D).get(),p.call("_storeDirectGUIEdit",k,I._preGUI,V);var N=h.nestedProperty(R,D);N.get()!==B&&(N.set(B),h.nestedProperty(L,D).set(B),O[S+"."+D]=B)}_(J),J("projection.scale",b.scale()/M.fitScale),J("fitbounds",!1),C.emit("plotly_relayout",O)}function s(M,b){var _=i(0,b);function S(C){var k=b.invert(M.midPt);C("center.lon",k[0]),C("center.lat",k[1])}return _.on("zoomstart",function(){t.select(this).style(o)}).on("zoom",function(){b.scale(t.event.scale).translate(t.event.translate),M.render();var C=b.invert(M.midPt);M.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":b.scale()/M.fitScale,"geo.center.lon":C[0],"geo.center.lat":C[1]})}).on("zoomend",function(){t.select(this).style(r),u(M,b,S)}),_}function a(M,b){var _,S,C,k,L,I,R,V,O,J=i(0,b);function D(N){return b.invert(N)}function B(N){var F=b.rotate(),H=b.invert(M.midPt);N("projection.rotation.lon",-F[0]),N("center.lon",H[0]),N("center.lat",H[1])}return J.on("zoomstart",function(){t.select(this).style(o),_=t.mouse(this),S=b.rotate(),C=b.translate(),k=S,L=D(_)}).on("zoom",function(){if(I=t.mouse(this),function(H){var j=D(H);if(!j)return!0;var G=b(j);return Math.abs(G[0]-H[0])>2||Math.abs(G[1]-H[1])>2}(_))return J.scale(b.scale()),void J.translate(b.translate());b.scale(t.event.scale),b.translate([C[0],t.event.translate[1]]),L?D(I)&&(V=D(I),R=[k[0]+(V[0]-L[0]),S[1],S[2]],b.rotate(R),k=R):L=D(_=I),O=!0,M.render();var N=b.rotate(),F=b.invert(M.midPt);M.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":b.scale()/M.fitScale,"geo.center.lon":F[0],"geo.center.lat":F[1],"geo.projection.rotation.lon":-N[0]})}).on("zoomend",function(){t.select(this).style(r),O&&u(M,b,B)}),J}function c(M,b){var _,S={r:b.rotate(),k:b.scale()},C=i(0,b),k=function(D){for(var B=0,N=arguments.length,F=[];++B<N;)F.push(arguments[B]);var H=t.dispatch.apply(null,F);return H.of=function(j,G){return function(W){var Q;try{Q=W.sourceEvent=t.event,W.target=D,t.event=W,H[W.type].apply(j,G)}finally{t.event=Q}}},H}(C,"zoomstart","zoom","zoomend"),L=0,I=C.on;function R(D){L++||D({type:"zoomstart"})}function V(D){D({type:"zoom"})}function O(D){--L||D({type:"zoomend"})}function J(D){var B=b.rotate();D("projection.rotation.lon",-B[0]),D("projection.rotation.lat",-B[1])}return C.on("zoomstart",function(){t.select(this).style(o);var D=t.mouse(this),B=b.rotate(),N=B,F=b.translate(),H=g(B);_=f(b,D),I.call(C,"zoom",function(){var j=t.mouse(this);if(b.scale(S.k=t.event.scale),_){if(f(b,j)){b.rotate(B).translate(F);var G=f(b,j),W=m(_,G),Q=A(d(H,W)),$=S.r=y(Q,_,N);isFinite($[0])&&isFinite($[1])&&isFinite($[2])||($=N),b.rotate($),N=$}}else _=f(b,D=j);V(k.of(this,arguments))}),R(k.of(this,arguments))}).on("zoomend",function(){t.select(this).style(r),I.call(C,"zoom",null),O(k.of(this,arguments)),u(M,b,J)}).on("zoom.redraw",function(){M.render();var D=b.rotate();M.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":b.scale()/M.fitScale,"geo.projection.rotation.lon":-D[0],"geo.projection.rotation.lat":-D[1]})}),t.rebind(C,k,"on")}function f(M,b){var _=M.invert(b);return _&&isFinite(_[0])&&isFinite(_[1])&&function(S){var C=S[0]*l,k=S[1]*l,L=Math.cos(k);return[L*Math.cos(C),L*Math.sin(C),Math.sin(k)]}(_)}function g(M){var b=.5*M[0]*l,_=.5*M[1]*l,S=.5*M[2]*l,C=Math.sin(b),k=Math.cos(b),L=Math.sin(_),I=Math.cos(_),R=Math.sin(S),V=Math.cos(S);return[k*I*V+C*L*R,C*I*V-k*L*R,k*L*V+C*I*R,k*I*R-C*L*V]}function d(M,b){var _=M[0],S=M[1],C=M[2],k=M[3],L=b[0],I=b[1],R=b[2],V=b[3];return[_*L-S*I-C*R-k*V,_*I+S*L+C*V-k*R,_*R-S*V+C*L+k*I,_*V+S*R-C*I+k*L]}function m(M,b){if(M&&b){var _=function(L,I){return[L[1]*I[2]-L[2]*I[1],L[2]*I[0]-L[0]*I[2],L[0]*I[1]-L[1]*I[0]]}(M,b),S=Math.sqrt(E(_,_)),C=.5*Math.acos(Math.max(-1,Math.min(1,E(M,b)))),k=Math.sin(C)/S;return S&&[Math.cos(C),_[2]*k,-_[1]*k,_[0]*k]}}function y(M,b,_){var S=w(b,2,M[0]);S=w(S,1,M[1]),S=w(S,0,M[2]-_[2]);var C,k,L=b[0],I=b[1],R=b[2],V=S[0],O=S[1],J=S[2],D=Math.atan2(I,L)*e,B=Math.sqrt(L*L+I*I);Math.abs(O)>B?(k=(O>0?90:-90)-D,C=0):(k=Math.asin(O/B)*e-D,C=Math.sqrt(B*B-O*O));var N=180-k-2*D,F=(Math.atan2(J,V)-Math.atan2(R,C))*e,H=(Math.atan2(J,V)-Math.atan2(R,-C))*e;return v(_[0],_[1],k,F)<=v(_[0],_[1],N,H)?[k,F,_[2]]:[N,H,_[2]]}function v(M,b,_,S){var C=T(_-M),k=T(S-b);return Math.sqrt(C*C+k*k)}function T(M){return(M%360+540)%360-180}function w(M,b,_){var S=_*l,C=M.slice(),k=b===0?1:0,L=b===2?1:2,I=Math.cos(S),R=Math.sin(S);return C[k]=M[k]*I-M[L]*R,C[L]=M[L]*I+M[k]*R,C}function A(M){return[Math.atan2(2*(M[0]*M[1]+M[2]*M[3]),1-2*(M[1]*M[1]+M[2]*M[2]))*e,Math.asin(Math.max(-1,Math.min(1,2*(M[0]*M[2]-M[3]*M[1]))))*e,Math.atan2(2*(M[0]*M[3]+M[1]*M[2]),1-2*(M[2]*M[2]+M[3]*M[3]))*e]}function E(M,b){for(var _=0,S=0,C=M.length;S<C;++S)_+=M[S]*b[S];return _}z.exports=function(M,b){var _=M.projection;return(b._isScoped?s:b._isClipped?c:a)(M,_)}},{"../../lib":778,"../../registry":911,d3:169}],865:[function(n,z,q){"use strict";var t=n("../registry"),h=n("./cartesian/constants").SUBPLOT_PATTERN;q.getSubplotCalcData=function(p,l,e){var o=t.subplotsRegistry[l];if(!o)return[];for(var r=o.attr,i=[],u=0;u<p.length;u++){var s=p[u];s[0].trace[r]===e&&i.push(s)}return i},q.getModuleCalcData=function(p,l){var e,o=[],r=[];if(!(e=typeof l=="string"?t.getModule(l).plot:typeof l=="function"?l:l.plot))return[o,p];for(var i=0;i<p.length;i++){var u=p[i],s=u[0].trace;s.visible===!0&&s._length!==0&&(s._module.plot===e?o.push(u):r.push(u))}return[o,r]},q.getSubplotData=function(p,l,e){if(!t.subplotsRegistry[l])return[];var o,r,i,u=t.subplotsRegistry[l].attr,s=[];if(l==="gl2d"){var a=e.match(h);r="x"+a[1],i="y"+a[2]}for(var c=0;c<p.length;c++)o=p[c],l==="gl2d"&&t.traceIs(o,"gl2d")?o[u[0]]===r&&o[u[1]]===i&&s.push(o):o[u]===e&&s.push(o);return s}},{"../registry":911,"./cartesian/constants":834}],866:[function(n,z,q){"use strict";var t=n("mouse-change"),h=n("mouse-wheel"),p=n("mouse-event-offset"),l=n("../cartesian/constants"),e=n("has-passive-events");function o(r,i){this.element=r,this.plot=i,this.mouseListener=null,this.wheelListener=null,this.lastInputTime=Date.now(),this.lastPos=[0,0],this.boxEnabled=!1,this.boxInited=!1,this.boxStart=[0,0],this.boxEnd=[0,0],this.dragStart=[0,0]}z.exports=function(r){var i=r.mouseContainer,u=r.glplot,s=new o(i,u);function a(){r.xaxis.autorange=!1,r.yaxis.autorange=!1}function c(f,g,d){var m,y,v=r.calcDataBox(),T=u.viewBox,w=s.lastPos[0],A=s.lastPos[1],E=l.MINDRAG*u.pixelRatio,M=l.MINZOOM*u.pixelRatio;function b(I,R,V){var O=Math.min(R,V),J=Math.max(R,V);O!==J?(v[I]=O,v[I+2]=J,s.dataBox=v,r.setRanges(v)):(r.selectBox.selectBox=[0,0,1,1],r.glplot.setDirty())}switch(g*=u.pixelRatio,d*=u.pixelRatio,d=T[3]-T[1]-d,r.fullLayout.dragmode){case"zoom":if(f){var _=g/(T[2]-T[0])*(v[2]-v[0])+v[0],S=d/(T[3]-T[1])*(v[3]-v[1])+v[1];s.boxInited||(s.boxStart[0]=_,s.boxStart[1]=S,s.dragStart[0]=g,s.dragStart[1]=d),s.boxEnd[0]=_,s.boxEnd[1]=S,s.boxInited=!0,s.boxEnabled||s.boxStart[0]===s.boxEnd[0]&&s.boxStart[1]===s.boxEnd[1]||(s.boxEnabled=!0);var C=Math.abs(s.dragStart[0]-g)<M,k=Math.abs(s.dragStart[1]-d)<M;if(!function(){for(var I=r.graphDiv._fullLayout._axisConstraintGroups,R=r.xaxis._id,V=r.yaxis._id,O=0;O<I.length;O++)if(I[O][R]!==-1){if(I[O][V]!==-1)return!0;break}return!1}()||C&&k)C&&(s.boxEnd[0]=s.boxStart[0]),k&&(s.boxEnd[1]=s.boxStart[1]);else{m=s.boxEnd[0]-s.boxStart[0],y=s.boxEnd[1]-s.boxStart[1];var L=(v[3]-v[1])/(v[2]-v[0]);Math.abs(m*L)>Math.abs(y)?(s.boxEnd[1]=s.boxStart[1]+Math.abs(m)*L*(y>=0?1:-1),s.boxEnd[1]<v[1]?(s.boxEnd[1]=v[1],s.boxEnd[0]=s.boxStart[0]+(v[1]-s.boxStart[1])/Math.abs(L)):s.boxEnd[1]>v[3]&&(s.boxEnd[1]=v[3],s.boxEnd[0]=s.boxStart[0]+(v[3]-s.boxStart[1])/Math.abs(L))):(s.boxEnd[0]=s.boxStart[0]+Math.abs(y)/L*(m>=0?1:-1),s.boxEnd[0]<v[0]?(s.boxEnd[0]=v[0],s.boxEnd[1]=s.boxStart[1]+(v[0]-s.boxStart[0])*Math.abs(L)):s.boxEnd[0]>v[2]&&(s.boxEnd[0]=v[2],s.boxEnd[1]=s.boxStart[1]+(v[2]-s.boxStart[0])*Math.abs(L)))}}else s.boxEnabled?(m=s.boxStart[0]!==s.boxEnd[0],y=s.boxStart[1]!==s.boxEnd[1],m||y?(m&&(b(0,s.boxStart[0],s.boxEnd[0]),r.xaxis.autorange=!1),y&&(b(1,s.boxStart[1],s.boxEnd[1]),r.yaxis.autorange=!1),r.relayoutCallback()):r.glplot.setDirty(),s.boxEnabled=!1,s.boxInited=!1):s.boxInited&&(s.boxInited=!1);break;case"pan":s.boxEnabled=!1,s.boxInited=!1,f?(s.panning||(s.dragStart[0]=g,s.dragStart[1]=d),Math.abs(s.dragStart[0]-g)<E&&(g=s.dragStart[0]),Math.abs(s.dragStart[1]-d)<E&&(d=s.dragStart[1]),m=(w-g)*(v[2]-v[0])/(u.viewBox[2]-u.viewBox[0]),y=(A-d)*(v[3]-v[1])/(u.viewBox[3]-u.viewBox[1]),v[0]+=m,v[2]+=m,v[1]+=y,v[3]+=y,r.setRanges(v),s.panning=!0,s.lastInputTime=Date.now(),a(),r.cameraChanged(),r.handleAnnotations()):s.panning&&(s.panning=!1,r.relayoutCallback())}s.lastPos[0]=g,s.lastPos[1]=d}return s.mouseListener=t(i,c),i.addEventListener("touchstart",function(f){var g=p(f.changedTouches[0],i);c(0,g[0],g[1]),c(1,g[0],g[1]),f.preventDefault()},!!e&&{passive:!1}),i.addEventListener("touchmove",function(f){f.preventDefault();var g=p(f.changedTouches[0],i);c(1,g[0],g[1]),f.preventDefault()},!!e&&{passive:!1}),i.addEventListener("touchend",function(f){c(0,s.lastPos[0],s.lastPos[1]),f.preventDefault()},!!e&&{passive:!1}),s.wheelListener=h(i,function(f,g){if(!r.scrollZoom)return!1;var d=r.calcDataBox(),m=u.viewBox,y=s.lastPos[0],v=s.lastPos[1],T=Math.exp(5*g/(m[3]-m[1])),w=y/(m[2]-m[0])*(d[2]-d[0])+d[0],A=v/(m[3]-m[1])*(d[3]-d[1])+d[1];return d[0]=(d[0]-w)*T+w,d[2]=(d[2]-w)*T+w,d[1]=(d[1]-A)*T+A,d[3]=(d[3]-A)*T+A,r.setRanges(d),s.lastInputTime=Date.now(),a(),r.cameraChanged(),r.handleAnnotations(),r.relayoutCallback(),!0},!0),s}},{"../cartesian/constants":834,"has-passive-events":441,"mouse-change":483,"mouse-event-offset":484,"mouse-wheel":486}],867:[function(n,z,q){"use strict";var t=n("../cartesian/axes"),h=n("../../lib/str2rgbarray");function p(o){this.scene=o,this.gl=o.gl,this.pixelRatio=o.pixelRatio,this.screenBox=[0,0,1,1],this.viewBox=[0,0,1,1],this.dataBox=[-1,-1,1,1],this.borderLineEnable=[!1,!1,!1,!1],this.borderLineWidth=[1,1,1,1],this.borderLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.ticks=[[],[]],this.tickEnable=[!0,!0,!1,!1],this.tickPad=[15,15,15,15],this.tickAngle=[0,0,0,0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickMarkLength=[0,0,0,0],this.tickMarkWidth=[0,0,0,0],this.tickMarkColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labels=["x","y"],this.labelEnable=[!0,!0,!1,!1],this.labelAngle=[0,Math.PI/2,0,3*Math.PI/2],this.labelPad=[15,15,15,15],this.labelSize=[12,12],this.labelFont=["sans-serif","sans-serif"],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.title="",this.titleEnable=!0,this.titleCenter=[0,0,0,0],this.titleAngle=0,this.titleColor=[0,0,0,1],this.titleFont="sans-serif",this.titleSize=18,this.gridLineEnable=[!0,!0],this.gridLineColor=[[0,0,0,.5],[0,0,0,.5]],this.gridLineWidth=[1,1],this.zeroLineEnable=[!0,!0],this.zeroLineWidth=[1,1],this.zeroLineColor=[[0,0,0,1],[0,0,0,1]],this.borderColor=[0,0,0,0],this.backgroundColor=[0,0,0,0],this.static=this.scene.staticPlot}var l=p.prototype,e=["xaxis","yaxis"];l.merge=function(o){var r,i,u,s,a,c,f,g,d,m,y;for(this.titleEnable=!1,this.backgroundColor=h(o.plot_bgcolor),m=0;m<2;++m){var v=(r=e[m]).charAt(0);for(u=(i=o[this.scene[r]._name]).title.text===this.scene.fullLayout._dfltTitle[v]?"":i.title.text,y=0;y<=2;y+=2)this.labelEnable[m+y]=!1,this.labels[m+y]=u,this.labelColor[m+y]=h(i.title.font.color),this.labelFont[m+y]=i.title.font.family,this.labelSize[m+y]=i.title.font.size,this.labelPad[m+y]=this.getLabelPad(r,i),this.tickEnable[m+y]=!1,this.tickColor[m+y]=h((i.tickfont||{}).color),this.tickAngle[m+y]=i.tickangle==="auto"?0:Math.PI*-i.tickangle/180,this.tickPad[m+y]=this.getTickPad(i),this.tickMarkLength[m+y]=0,this.tickMarkWidth[m+y]=i.tickwidth||0,this.tickMarkColor[m+y]=h(i.tickcolor),this.borderLineEnable[m+y]=!1,this.borderLineColor[m+y]=h(i.linecolor),this.borderLineWidth[m+y]=i.linewidth||0;f=this.hasSharedAxis(i),a=this.hasAxisInDfltPos(r,i)&&!f,c=this.hasAxisInAltrPos(r,i)&&!f,s=i.mirror||!1,g=f?String(s).indexOf("all")!==-1:!!s,d=f?s==="allticks":String(s).indexOf("ticks")!==-1,a?this.labelEnable[m]=!0:c&&(this.labelEnable[m+2]=!0),a?this.tickEnable[m]=i.showticklabels:c&&(this.tickEnable[m+2]=i.showticklabels),(a||g)&&(this.borderLineEnable[m]=i.showline),(c||g)&&(this.borderLineEnable[m+2]=i.showline),(a||d)&&(this.tickMarkLength[m]=this.getTickMarkLength(i)),(c||d)&&(this.tickMarkLength[m+2]=this.getTickMarkLength(i)),this.gridLineEnable[m]=i.showgrid,this.gridLineColor[m]=h(i.gridcolor),this.gridLineWidth[m]=i.gridwidth,this.zeroLineEnable[m]=i.zeroline,this.zeroLineColor[m]=h(i.zerolinecolor),this.zeroLineWidth[m]=i.zerolinewidth}},l.hasSharedAxis=function(o){var r=this.scene,i=r.fullLayout._subplots.gl2d;return t.findSubplotsWithAxis(i,o).indexOf(r.id)!==0},l.hasAxisInDfltPos=function(o,r){var i=r.side;return o==="xaxis"?i==="bottom":o==="yaxis"?i==="left":void 0},l.hasAxisInAltrPos=function(o,r){var i=r.side;return o==="xaxis"?i==="top":o==="yaxis"?i==="right":void 0},l.getLabelPad=function(o,r){var i=r.title.font.size,u=r.showticklabels;return o==="xaxis"?r.side==="top"?i*(1.5+(u?1:0))-10:i*(1.5+(u?.5:0))-10:o==="yaxis"?r.side==="right"?10+i*(1.5+(u?1:.5)):10+i*(1.5+(u?.5:0)):void 0},l.getTickPad=function(o){return o.ticks==="outside"?10+o.ticklen:15},l.getTickMarkLength=function(o){if(!o.ticks)return 0;var r=o.ticklen;return o.ticks==="inside"?-r:r},z.exports=function(o){return new p(o)}},{"../../lib/str2rgbarray":802,"../cartesian/axes":828}],868:[function(n,z,q){"use strict";var t=n("../../plot_api/edit_types").overrideAll,h=n("./scene2d"),p=n("../layout_attributes"),l=n("../../constants/xmlns_namespaces"),e=n("../cartesian/constants"),o=n("../cartesian"),r=n("../../components/fx/layout_attributes"),i=n("../get_data").getSubplotData;q.name="gl2d",q.attr=["xaxis","yaxis"],q.idRoot=["x","y"],q.idRegex=e.idRegex,q.attrRegex=e.attrRegex,q.attributes=n("../cartesian/attributes"),q.supplyLayoutDefaults=function(u,s,a){s._has("cartesian")||o.supplyLayoutDefaults(u,s,a)},q.layoutAttrOverrides=t(o.layoutAttributes,"plot","from-root"),q.baseLayoutAttrOverrides=t({plot_bgcolor:p.plot_bgcolor,hoverlabel:r.hoverlabel},"plot","nested"),q.plot=function(u){for(var s=u._fullLayout,a=u._fullData,c=s._subplots.gl2d,f=0;f<c.length;f++){var g=c[f],d=s._plots[g],m=i(a,"gl2d",g),y=d._scene2d;y===void 0&&(y=new h({id:g,graphDiv:u,container:u.querySelector(".gl-container"),staticPlot:u._context.staticPlot,plotGlPixelRatio:u._context.plotGlPixelRatio},s),d._scene2d=y),y.plot(m,u.calcdata,s,u.layout)}},q.clean=function(u,s,a,c){for(var f=c._subplots.gl2d||[],g=0;g<f.length;g++){var d=f[g],m=c._plots[d];if(m._scene2d){var y=i(u,"gl2d",d);y.length===0&&(m._scene2d.destroy(),delete c._plots[d])}}o.clean.apply(this,arguments)},q.drawFramework=function(u){u._context.staticPlot||o.drawFramework(u)},q.toSVG=function(u){for(var s=u._fullLayout,a=s._subplots.gl2d,c=0;c<a.length;c++){var f=s._plots[a[c]]._scene2d,g=f.toImage("png");s._glimages.append("svg:image").attr({xmlns:l.svg,"xlink:href":g,x:0,y:0,width:"100%",height:"100%",preserveAspectRatio:"none"}),f.destroy()}},q.updateFx=function(u){for(var s=u._fullLayout,a=s._subplots.gl2d,c=0;c<a.length;c++)s._plots[a[c]]._scene2d.updateFx(s.dragmode)}},{"../../components/fx/layout_attributes":684,"../../constants/xmlns_namespaces":754,"../../plot_api/edit_types":810,"../cartesian":841,"../cartesian/attributes":826,"../cartesian/constants":834,"../get_data":865,"../layout_attributes":882,"./scene2d":869}],869:[function(n,z,q){"use strict";var t,h,p=n("../../registry"),l=n("../../plots/cartesian/axes"),e=n("../../components/fx"),o=n("gl-plot2d"),r=n("gl-spikes2d"),i=n("gl-select-box"),u=n("webgl-context"),s=n("./convert"),a=n("./camera"),c=n("../../lib/show_no_webgl_msg"),f=n("../cartesian/constraints"),g=f.enforce,d=f.clean,m=n("../cartesian/autorange").doAutoRange,y=n("../../components/dragelement/helpers"),v=y.drawMode,T=y.selectMode,w=["xaxis","yaxis"],A=n("../cartesian/constants").SUBPLOT_PATTERN;function E(b,_){this.container=b.container,this.graphDiv=b.graphDiv,this.pixelRatio=b.plotGlPixelRatio||window.devicePixelRatio,this.id=b.id,this.staticPlot=!!b.staticPlot,this.scrollZoom=this.graphDiv._context._scrollZoom.cartesian,this.fullData=null,this.updateRefs(_),this.makeFramework(),this.stopped||(this.glplotOptions=s(this),this.glplotOptions.merge(_),this.glplot=o(this.glplotOptions),this.camera=a(this),this.traces={},this.spikes=r(this.glplot),this.selectBox=i(this.glplot,{innerFill:!1,outerFill:!0}),this.lastButtonState=0,this.pickResult=null,this.isMouseOver=!0,this.stopped=!1,this.redraw=this.draw.bind(this),this.redraw())}z.exports=E;var M=E.prototype;M.makeFramework=function(){if(this.staticPlot){if(!(h||(t=document.createElement("canvas"),h=u({canvas:t,preserveDrawingBuffer:!1,premultipliedAlpha:!0,antialias:!0}))))throw new Error("Error creating static canvas/context for image server");this.canvas=t,this.gl=h}else{var b=this.container.querySelector(".gl-canvas-focus"),_=u({canvas:b,preserveDrawingBuffer:!0,premultipliedAlpha:!0});if(!_)return c(this),void(this.stopped=!0);this.canvas=b,this.gl=_}var S=this.canvas;S.style.width="100%",S.style.height="100%",S.style.position="absolute",S.style.top="0px",S.style.left="0px",S.style["pointer-events"]="none",this.updateSize(S);var C=this.svgContainer=document.createElementNS("http://www.w3.org/2000/svg","svg");C.style.position="absolute",C.style.top=C.style.left="0px",C.style.width=C.style.height="100%",C.style["z-index"]=20,C.style["pointer-events"]="none";var k=this.mouseContainer=document.createElement("div");k.style.position="absolute",k.style["pointer-events"]="auto",this.pickCanvas=this.container.querySelector(".gl-canvas-pick");var L=this.container;L.appendChild(C),L.appendChild(k);var I=this;k.addEventListener("mouseout",function(){I.isMouseOver=!1,I.unhover()}),k.addEventListener("mouseover",function(){I.isMouseOver=!0})},M.toImage=function(b){b||(b="png"),this.stopped=!0,this.staticPlot&&this.container.appendChild(t),this.updateSize(this.canvas);var _=this.glplot.gl,S=_.drawingBufferWidth,C=_.drawingBufferHeight;_.clearColor(1,1,1,0),_.clear(_.COLOR_BUFFER_BIT|_.DEPTH_BUFFER_BIT),this.glplot.setDirty(),this.glplot.draw(),_.bindFramebuffer(_.FRAMEBUFFER,null);var k=new Uint8Array(S*C*4);_.readPixels(0,0,S,C,_.RGBA,_.UNSIGNED_BYTE,k);for(var L=0,I=C-1;L<I;++L,--I)for(var R=0;R<S;++R)for(var V=0;V<4;++V){var O=k[4*(S*L+R)+V];k[4*(S*L+R)+V]=k[4*(S*I+R)+V],k[4*(S*I+R)+V]=O}var J=document.createElement("canvas");J.width=S,J.height=C;var D,B=J.getContext("2d"),N=B.createImageData(S,C);switch(N.data.set(k),B.putImageData(N,0,0),b){case"jpeg":D=J.toDataURL("image/jpeg");break;case"webp":D=J.toDataURL("image/webp");break;default:D=J.toDataURL("image/png")}return this.staticPlot&&this.container.removeChild(t),D},M.updateSize=function(b){b||(b=this.canvas);var _=this.pixelRatio,S=this.fullLayout,C=S.width,k=S.height,L=0|Math.ceil(_*C),I=0|Math.ceil(_*k);return b.width===L&&b.height===I||(b.width=L,b.height=I),b},M.computeTickMarks=function(){this.xaxis.setScale(),this.yaxis.setScale();for(var b=[l.calcTicks(this.xaxis),l.calcTicks(this.yaxis)],_=0;_<2;++_)for(var S=0;S<b[_].length;++S)b[_][S].text=b[_][S].text+"";return b},M.updateRefs=function(b){this.fullLayout=b;var _=this.id.match(A),S="xaxis"+_[1],C="yaxis"+_[2];this.xaxis=this.fullLayout[S],this.yaxis=this.fullLayout[C]},M.relayoutCallback=function(){var b=this.graphDiv,_=this.xaxis,S=this.yaxis,C=b.layout,k={},L=k[_._name+".range"]=_.range.slice(),I=k[S._name+".range"]=S.range.slice();k[_._name+".autorange"]=_.autorange,k[S._name+".autorange"]=S.autorange,p.call("_storeDirectGUIEdit",b.layout,b._fullLayout._preGUI,k);var R=C[_._name];R.range=L,R.autorange=_.autorange;var V=C[S._name];V.range=I,V.autorange=S.autorange,k.lastInputTime=this.camera.lastInputTime,b.emit("plotly_relayout",k)},M.cameraChanged=function(){var b=this.camera;this.glplot.setDataBox(this.calcDataBox());var _=this.computeTickMarks();(function(S,C){for(var k=0;k<2;++k){var L=S[k],I=C[k];if(L.length!==I.length)return!0;for(var R=0;R<L.length;++R)if(L[R].x!==I[R].x)return!0}return!1})(_,this.glplotOptions.ticks)&&(this.glplotOptions.ticks=_,this.glplotOptions.dataBox=b.dataBox,this.glplot.update(this.glplotOptions),this.handleAnnotations())},M.handleAnnotations=function(){for(var b=this.graphDiv,_=this.fullLayout.annotations,S=0;S<_.length;S++){var C=_[S];C.xref===this.xaxis._id&&C.yref===this.yaxis._id&&p.getComponentMethod("annotations","drawOne")(b,S)}},M.destroy=function(){if(this.glplot){var b=this.traces;b&&Object.keys(b).map(function(_){b[_].dispose(),delete b[_]}),this.glplot.dispose(),this.container.removeChild(this.svgContainer),this.container.removeChild(this.mouseContainer),this.fullData=null,this.glplot=null,this.stopped=!0,this.camera.mouseListener.enabled=!1,this.mouseContainer.removeEventListener("wheel",this.camera.wheelListener),this.camera=null}},M.plot=function(b,_,S){var C=this.glplot;this.updateRefs(S),this.xaxis.clearCalc(),this.yaxis.clearCalc(),this.updateTraces(b,_),this.updateFx(S.dragmode);var k=S.width,L=S.height;this.updateSize(this.canvas);var I=this.glplotOptions;I.merge(S),I.screenBox=[0,0,k,L];var R={_fullLayout:{_axisConstraintGroups:this.graphDiv._fullLayout._axisConstraintGroups,xaxis:this.xaxis,yaxis:this.yaxis}};d(R,this.xaxis),d(R,this.yaxis);var V,O,J=S._size,D=this.xaxis.domain,B=this.yaxis.domain;for(I.viewBox=[J.l+D[0]*J.w,J.b+B[0]*J.h,k-J.r-(1-D[1])*J.w,L-J.t-(1-B[1])*J.h],this.mouseContainer.style.width=J.w*(D[1]-D[0])+"px",this.mouseContainer.style.height=J.h*(B[1]-B[0])+"px",this.mouseContainer.height=J.h*(B[1]-B[0]),this.mouseContainer.style.left=J.l+D[0]*J.w+"px",this.mouseContainer.style.top=J.t+(1-B[1])*J.h+"px",O=0;O<2;++O)(V=this[w[O]])._length=I.viewBox[O+2]-I.viewBox[O],m(this.graphDiv,V),V.setScale();g(R),I.ticks=this.computeTickMarks(),I.dataBox=this.calcDataBox(),I.merge(S),C.update(I),this.glplot.draw()},M.calcDataBox=function(){var b=this.xaxis,_=this.yaxis,S=b.range,C=_.range,k=b.r2l,L=_.r2l;return[k(S[0]),L(C[0]),k(S[1]),L(C[1])]},M.setRanges=function(b){var _=this.xaxis,S=this.yaxis,C=_.l2r,k=S.l2r;_.range=[C(b[0]),C(b[2])],S.range=[k(b[1]),k(b[3])]},M.updateTraces=function(b,_){var S,C,k,L=Object.keys(this.traces);this.fullData=b;e:for(S=0;S<L.length;S++){var I=L[S],R=this.traces[I];for(C=0;C<b.length;C++)if((k=b[C]).uid===I&&k.type===R.type)continue e;R.dispose(),delete this.traces[I]}for(S=0;S<b.length;S++){k=b[S];var V=_[S],O=this.traces[k.uid];O?O.update(k,V):(O=k._module.plot(this,k,V),this.traces[k.uid]=O)}this.glplot.objects.sort(function(J,D){return J._trace.index-D._trace.index})},M.updateFx=function(b){T(b)||v(b)?(this.pickCanvas.style["pointer-events"]="none",this.mouseContainer.style["pointer-events"]="none"):(this.pickCanvas.style["pointer-events"]="auto",this.mouseContainer.style["pointer-events"]="auto"),this.mouseContainer.style.cursor=b==="pan"?"move":b==="zoom"?"crosshair":null},M.emitPointAction=function(b,_){for(var S,C=b.trace.uid,k=b.pointIndex,L=0;L<this.fullData.length;L++)this.fullData[L].uid===C&&(S=this.fullData[L]);var I={x:b.traceCoord[0],y:b.traceCoord[1],curveNumber:S.index,pointNumber:k,data:S._input,fullData:this.fullData,xaxis:this.xaxis,yaxis:this.yaxis};e.appendArrayPointValue(I,S,k),this.graphDiv.emit(_,{points:[I]})},M.draw=function(){if(!this.stopped){requestAnimationFrame(this.redraw);var b=this.glplot,_=this.camera,S=_.mouseListener,C=this.lastButtonState===1&&S.buttons===0,k=this.fullLayout;this.lastButtonState=S.buttons,this.cameraChanged();var L,I=S.x*b.pixelRatio,R=this.canvas.height-b.pixelRatio*S.y;if(_.boxEnabled&&k.dragmode==="zoom"){this.selectBox.enabled=!0;for(var V=this.selectBox.selectBox=[Math.min(_.boxStart[0],_.boxEnd[0]),Math.min(_.boxStart[1],_.boxEnd[1]),Math.max(_.boxStart[0],_.boxEnd[0]),Math.max(_.boxStart[1],_.boxEnd[1])],O=0;O<2;O++)_.boxStart[O]===_.boxEnd[O]&&(V[O]=b.dataBox[O],V[O+2]=b.dataBox[O+2]);b.setDirty()}else if(!_.panning&&this.isMouseOver){this.selectBox.enabled=!1;var J=k._size,D=this.xaxis.domain,B=this.yaxis.domain,N=(L=b.pick(I/b.pixelRatio+J.l+D[0]*J.w,R/b.pixelRatio-(J.t+(1-B[1])*J.h)))&&L.object._trace.handlePick(L);if(N&&C&&this.emitPointAction(N,"plotly_click"),L&&L.object._trace.hoverinfo!=="skip"&&k.hovermode&&N&&(!this.lastPickResult||this.lastPickResult.traceUid!==N.trace.uid||this.lastPickResult.dataCoord[0]!==N.dataCoord[0]||this.lastPickResult.dataCoord[1]!==N.dataCoord[1])){var F=N;this.lastPickResult={traceUid:N.trace?N.trace.uid:null,dataCoord:N.dataCoord.slice()},this.spikes.update({center:L.dataCoord}),F.screenCoord=[((b.viewBox[2]-b.viewBox[0])*(L.dataCoord[0]-b.dataBox[0])/(b.dataBox[2]-b.dataBox[0])+b.viewBox[0])/b.pixelRatio,(this.canvas.height-(b.viewBox[3]-b.viewBox[1])*(L.dataCoord[1]-b.dataBox[1])/(b.dataBox[3]-b.dataBox[1])-b.viewBox[1])/b.pixelRatio],this.emitPointAction(N,"plotly_hover");var H=this.fullData[F.trace.index]||{},j=F.pointIndex,G=e.castHoverinfo(H,k,j);if(G&&G!=="all"){var W=G.split("+");W.indexOf("x")===-1&&(F.traceCoord[0]=void 0),W.indexOf("y")===-1&&(F.traceCoord[1]=void 0),W.indexOf("z")===-1&&(F.traceCoord[2]=void 0),W.indexOf("text")===-1&&(F.textLabel=void 0),W.indexOf("name")===-1&&(F.name=void 0)}e.loneHover({x:F.screenCoord[0],y:F.screenCoord[1],xLabel:this.hoverFormatter("xaxis",F.traceCoord[0]),yLabel:this.hoverFormatter("yaxis",F.traceCoord[1]),zLabel:F.traceCoord[2],text:F.textLabel,name:F.name,color:e.castHoverOption(H,j,"bgcolor")||F.color,borderColor:e.castHoverOption(H,j,"bordercolor"),fontFamily:e.castHoverOption(H,j,"font.family"),fontSize:e.castHoverOption(H,j,"font.size"),fontColor:e.castHoverOption(H,j,"font.color"),nameLength:e.castHoverOption(H,j,"namelength"),textAlign:e.castHoverOption(H,j,"align")},{container:this.svgContainer,gd:this.graphDiv})}}L||this.unhover(),b.draw()}},M.unhover=function(){this.lastPickResult&&(this.spikes.update({}),this.lastPickResult=null,this.graphDiv.emit("plotly_unhover"),e.loneUnhover(this.svgContainer))},M.hoverFormatter=function(b,_){if(_!==void 0){var S=this[b];return l.tickText(S,S.c2l(_),"hover").text}}},{"../../components/dragelement/helpers":661,"../../components/fx":683,"../../lib/show_no_webgl_msg":800,"../../plots/cartesian/axes":828,"../../registry":911,"../cartesian/autorange":827,"../cartesian/constants":834,"../cartesian/constraints":835,"./camera":866,"./convert":867,"gl-plot2d":317,"gl-select-box":333,"gl-spikes2d":342,"webgl-context":606}],870:[function(n,z,q){"use strict";var t=n("../../plot_api/edit_types").overrideAll,h=n("../../components/fx/layout_attributes"),p=n("./scene"),l=n("../get_data").getSubplotData,e=n("../../lib"),o=n("../../constants/xmlns_namespaces");q.name="gl3d",q.attr="scene",q.idRoot="scene",q.idRegex=q.attrRegex=e.counterRegex("scene"),q.attributes=n("./layout/attributes"),q.layoutAttributes=n("./layout/layout_attributes"),q.baseLayoutAttrOverrides=t({hoverlabel:h.hoverlabel},"plot","nested"),q.supplyLayoutDefaults=n("./layout/defaults"),q.plot=function(r){for(var i=r._fullLayout,u=r._fullData,s=i._subplots.gl3d,a=0;a<s.length;a++){var c=s[a],f=l(u,"gl3d",c),g=i[c],d=g.camera,m=g._scene;m||(m=new p({id:c,graphDiv:r,container:r.querySelector(".gl-container"),staticPlot:r._context.staticPlot,plotGlPixelRatio:r._context.plotGlPixelRatio,camera:d},i),g._scene=m),m.viewInitial||(m.viewInitial={up:{x:d.up.x,y:d.up.y,z:d.up.z},eye:{x:d.eye.x,y:d.eye.y,z:d.eye.z},center:{x:d.center.x,y:d.center.y,z:d.center.z}}),m.plot(f,i,r.layout)}},q.clean=function(r,i,u,s){for(var a=s._subplots.gl3d||[],c=0;c<a.length;c++){var f=a[c];!i[f]&&s[f]._scene&&(s[f]._scene.destroy(),s._infolayer&&s._infolayer.selectAll(".annotation-"+f).remove())}},q.toSVG=function(r){for(var i=r._fullLayout,u=i._subplots.gl3d,s=i._size,a=0;a<u.length;a++){var c=i[u[a]],f=c.domain,g=c._scene,d=g.toImage("png");i._glimages.append("svg:image").attr({xmlns:o.svg,"xlink:href":d,x:s.l+s.w*f.x[0],y:s.t+s.h*(1-f.y[1]),width:s.w*(f.x[1]-f.x[0]),height:s.h*(f.y[1]-f.y[0]),preserveAspectRatio:"none"}),g.destroy()}},q.cleanId=function(r){if(r.match(/^scene[0-9]*$/)){var i=r.substr(5);return i==="1"&&(i=""),"scene"+i}},q.updateFx=function(r){for(var i=r._fullLayout,u=i._subplots.gl3d,s=0;s<u.length;s++)i[u[s]]._scene.updateFx(i.dragmode,i.hovermode)}},{"../../components/fx/layout_attributes":684,"../../constants/xmlns_namespaces":754,"../../lib":778,"../../plot_api/edit_types":810,"../get_data":865,"./layout/attributes":871,"./layout/defaults":875,"./layout/layout_attributes":876,"./scene":880}],871:[function(n,z,q){"use strict";z.exports={scene:{valType:"subplotid",dflt:"scene",editType:"calc+clearAxisTypes"}}},{}],872:[function(n,z,q){"use strict";var t=n("../../../components/color"),h=n("../../cartesian/layout_attributes"),p=n("../../../lib/extend").extendFlat,l=n("../../../plot_api/edit_types").overrideAll;z.exports=l({visible:h.visible,showspikes:{valType:"boolean",dflt:!0},spikesides:{valType:"boolean",dflt:!0},spikethickness:{valType:"number",min:0,dflt:2},spikecolor:{valType:"color",dflt:t.defaultLine},showbackground:{valType:"boolean",dflt:!1},backgroundcolor:{valType:"color",dflt:"rgba(204, 204, 204, 0.5)"},showaxeslabels:{valType:"boolean",dflt:!0},color:h.color,categoryorder:h.categoryorder,categoryarray:h.categoryarray,title:{text:h.title.text,font:h.title.font},type:p({},h.type,{values:["-","linear","log","date","category"]}),autotypenumbers:h.autotypenumbers,autorange:h.autorange,rangemode:h.rangemode,range:p({},h.range,{items:[{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}}],anim:!1}),tickmode:h.tickmode,nticks:h.nticks,tick0:h.tick0,dtick:h.dtick,tickvals:h.tickvals,ticktext:h.ticktext,ticks:h.ticks,mirror:h.mirror,ticklen:h.ticklen,tickwidth:h.tickwidth,tickcolor:h.tickcolor,showticklabels:h.showticklabels,tickfont:h.tickfont,tickangle:h.tickangle,tickprefix:h.tickprefix,showtickprefix:h.showtickprefix,ticksuffix:h.ticksuffix,showticksuffix:h.showticksuffix,showexponent:h.showexponent,exponentformat:h.exponentformat,minexponent:h.minexponent,separatethousands:h.separatethousands,tickformat:h.tickformat,tickformatstops:h.tickformatstops,hoverformat:h.hoverformat,showline:h.showline,linecolor:h.linecolor,linewidth:h.linewidth,showgrid:h.showgrid,gridcolor:p({},h.gridcolor,{dflt:"rgb(204, 204, 204)"}),gridwidth:h.gridwidth,zeroline:h.zeroline,zerolinecolor:h.zerolinecolor,zerolinewidth:h.zerolinewidth,_deprecated:{title:h._deprecated.title,titlefont:h._deprecated.titlefont}},"plot","from-root")},{"../../../components/color":643,"../../../lib/extend":768,"../../../plot_api/edit_types":810,"../../cartesian/layout_attributes":842}],873:[function(n,z,q){"use strict";var t=n("tinycolor2").mix,h=n("../../../lib"),p=n("../../../plot_api/plot_template"),l=n("./axis_attributes"),e=n("../../cartesian/type_defaults"),o=n("../../cartesian/axis_defaults"),r=["xaxis","yaxis","zaxis"];z.exports=function(i,u,s){var a,c;function f(m,y){return h.coerce(a,c,l,m,y)}for(var g=0;g<r.length;g++){var d=r[g];a=i[d]||{},(c=p.newContainer(u,d))._id=d[0]+s.scene,c._name=d,e(a,c,f,s),o(a,c,f,{font:s.font,letter:d[0],data:s.data,showGrid:!0,noTickson:!0,noTicklabelmode:!0,noTicklabelposition:!0,bgColor:s.bgColor,calendar:s.calendar},s.fullLayout),f("gridcolor",t(c.color,s.bgColor,13600/187).toRgbString()),f("title.text",d[0]),c.setScale=h.noop,f("showspikes")&&(f("spikesides"),f("spikethickness"),f("spikecolor",c.color)),f("showaxeslabels"),f("showbackground")&&f("backgroundcolor")}}},{"../../../lib":778,"../../../plot_api/plot_template":817,"../../cartesian/axis_defaults":830,"../../cartesian/type_defaults":853,"./axis_attributes":872,tinycolor2:576}],874:[function(n,z,q){"use strict";var t=n("../../../lib/str2rgbarray"),h=n("../../../lib"),p=["xaxis","yaxis","zaxis"];function l(){this.bounds=[[-10,-10,-10],[10,10,10]],this.ticks=[[],[],[]],this.tickEnable=[!0,!0,!0],this.tickFont=["sans-serif","sans-serif","sans-serif"],this.tickSize=[12,12,12],this.tickAngle=[0,0,0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[18,18,18],this.labels=["x","y","z"],this.labelEnable=[!0,!0,!0],this.labelFont=["Open Sans","Open Sans","Open Sans"],this.labelSize=[20,20,20],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[30,30,30],this.lineEnable=[!0,!0,!0],this.lineMirror=[!1,!1,!1],this.lineWidth=[1,1,1],this.lineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.lineTickEnable=[!0,!0,!0],this.lineTickMirror=[!1,!1,!1],this.lineTickLength=[10,10,10],this.lineTickWidth=[1,1,1],this.lineTickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.gridEnable=[!0,!0,!0],this.gridWidth=[1,1,1],this.gridColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroEnable=[!0,!0,!0],this.zeroLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroLineWidth=[2,2,2],this.backgroundEnable=[!0,!0,!0],this.backgroundColor=[[.8,.8,.8,.5],[.8,.8,.8,.5],[.8,.8,.8,.5]],this._defaultTickPad=this.tickPad.slice(),this._defaultLabelPad=this.labelPad.slice(),this._defaultLineTickLength=this.lineTickLength.slice()}l.prototype.merge=function(e,o){for(var r=0;r<3;++r){var i=o[p[r]];i.visible?(this.labels[r]=e._meta?h.templateString(i.title.text,e._meta):i.title.text,"font"in i.title&&(i.title.font.color&&(this.labelColor[r]=t(i.title.font.color)),i.title.font.family&&(this.labelFont[r]=i.title.font.family),i.title.font.size&&(this.labelSize[r]=i.title.font.size)),"showline"in i&&(this.lineEnable[r]=i.showline),"linecolor"in i&&(this.lineColor[r]=t(i.linecolor)),"linewidth"in i&&(this.lineWidth[r]=i.linewidth),"showgrid"in i&&(this.gridEnable[r]=i.showgrid),"gridcolor"in i&&(this.gridColor[r]=t(i.gridcolor)),"gridwidth"in i&&(this.gridWidth[r]=i.gridwidth),i.type==="log"?this.zeroEnable[r]=!1:"zeroline"in i&&(this.zeroEnable[r]=i.zeroline),"zerolinecolor"in i&&(this.zeroLineColor[r]=t(i.zerolinecolor)),"zerolinewidth"in i&&(this.zeroLineWidth[r]=i.zerolinewidth),"ticks"in i&&i.ticks?this.lineTickEnable[r]=!0:this.lineTickEnable[r]=!1,"ticklen"in i&&(this.lineTickLength[r]=this._defaultLineTickLength[r]=i.ticklen),"tickcolor"in i&&(this.lineTickColor[r]=t(i.tickcolor)),"tickwidth"in i&&(this.lineTickWidth[r]=i.tickwidth),"tickangle"in i&&(this.tickAngle[r]=i.tickangle==="auto"?-3600:Math.PI*-i.tickangle/180),"showticklabels"in i&&(this.tickEnable[r]=i.showticklabels),"tickfont"in i&&(i.tickfont.color&&(this.tickColor[r]=t(i.tickfont.color)),i.tickfont.family&&(this.tickFont[r]=i.tickfont.family),i.tickfont.size&&(this.tickSize[r]=i.tickfont.size)),"mirror"in i?["ticks","all","allticks"].indexOf(i.mirror)!==-1?(this.lineTickMirror[r]=!0,this.lineMirror[r]=!0):i.mirror===!0?(this.lineTickMirror[r]=!1,this.lineMirror[r]=!0):(this.lineTickMirror[r]=!1,this.lineMirror[r]=!1):this.lineMirror[r]=!1,"showbackground"in i&&i.showbackground!==!1?(this.backgroundEnable[r]=!0,this.backgroundColor[r]=t(i.backgroundcolor)):this.backgroundEnable[r]=!1):(this.tickEnable[r]=!1,this.labelEnable[r]=!1,this.lineEnable[r]=!1,this.lineTickEnable[r]=!1,this.gridEnable[r]=!1,this.zeroEnable[r]=!1,this.backgroundEnable[r]=!1)}},z.exports=function(e,o){var r=new l;return r.merge(e,o),r}},{"../../../lib":778,"../../../lib/str2rgbarray":802}],875:[function(n,z,q){"use strict";var t=n("../../../lib"),h=n("../../../components/color"),p=n("../../../registry"),l=n("../../subplot_defaults"),e=n("./axis_defaults"),o=n("./layout_attributes"),r=n("../../get_data").getSubplotData;function i(u,s,a,c){for(var f=a("bgcolor"),g=h.combine(f,c.paper_bgcolor),d=["up","center","eye"],m=0;m<d.length;m++)a("camera."+d[m]+".x"),a("camera."+d[m]+".y"),a("camera."+d[m]+".z");a("camera.projection.type");var y=!!a("aspectratio.x")&&!!a("aspectratio.y")&&!!a("aspectratio.z"),v=a("aspectmode",y?"manual":"auto");y||(u.aspectratio=s.aspectratio={x:1,y:1,z:1},v==="manual"&&(s.aspectmode="auto"),u.aspectmode=s.aspectmode);var T=r(c.fullData,"gl3d",c.id);e(u,s,{font:c.font,scene:c.id,data:T,bgColor:g,calendar:c.calendar,autotypenumbersDflt:c.autotypenumbersDflt,fullLayout:c.fullLayout}),p.getComponentMethod("annotations3d","handleDefaults")(u,s,c);var w=c.getDfltFromLayout("dragmode");if(w!==!1&&!w)if(w="orbit",u.camera&&u.camera.up){var A=u.camera.up.x,E=u.camera.up.y,M=u.camera.up.z;M!==0&&(A&&E&&M?M/Math.sqrt(A*A+E*E+M*M)>.999&&(w="turntable"):w="turntable")}else w="turntable";a("dragmode",w),a("hovermode",c.getDfltFromLayout("hovermode"))}z.exports=function(u,s,a){var c=s._basePlotModules.length>1;l(u,s,a,{type:"gl3d",attributes:o,handleDefaults:i,fullLayout:s,font:s.font,fullData:a,getDfltFromLayout:function(f){if(!c)return t.validate(u[f],o[f])?u[f]:void 0},autotypenumbersDflt:s.autotypenumbers,paper_bgcolor:s.paper_bgcolor,calendar:s.calendar})}},{"../../../components/color":643,"../../../lib":778,"../../../registry":911,"../../get_data":865,"../../subplot_defaults":905,"./axis_defaults":873,"./layout_attributes":876}],876:[function(n,z,q){"use strict";var t=n("./axis_attributes"),h=n("../../domain").attributes,p=n("../../../lib/extend").extendFlat,l=n("../../../lib").counterRegex;function e(o,r,i){return{x:{valType:"number",dflt:o,editType:"camera"},y:{valType:"number",dflt:r,editType:"camera"},z:{valType:"number",dflt:i,editType:"camera"},editType:"camera"}}z.exports={_arrayAttrRegexps:[l("scene",".annotations",!0)],bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"plot"},camera:{up:p(e(0,0,1),{}),center:p(e(0,0,0),{}),eye:p(e(1.25,1.25,1.25),{}),projection:{type:{valType:"enumerated",values:["perspective","orthographic"],dflt:"perspective",editType:"calc"},editType:"calc"},editType:"camera"},domain:h({name:"scene",editType:"plot"}),aspectmode:{valType:"enumerated",values:["auto","cube","data","manual"],dflt:"auto",editType:"plot",impliedEdits:{"aspectratio.x":void 0,"aspectratio.y":void 0,"aspectratio.z":void 0}},aspectratio:{x:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},y:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},z:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},editType:"plot",impliedEdits:{aspectmode:"manual"}},xaxis:t,yaxis:t,zaxis:t,dragmode:{valType:"enumerated",values:["orbit","turntable","zoom","pan",!1],editType:"plot"},hovermode:{valType:"enumerated",values:["closest",!1],dflt:"closest",editType:"modebar"},uirevision:{valType:"any",editType:"none"},editType:"plot",_deprecated:{cameraposition:{valType:"info_array",editType:"camera"}}}},{"../../../lib":778,"../../../lib/extend":768,"../../domain":855,"./axis_attributes":872}],877:[function(n,z,q){"use strict";var t=n("../../../lib/str2rgbarray"),h=["xaxis","yaxis","zaxis"];function p(){this.enabled=[!0,!0,!0],this.colors=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.drawSides=[!0,!0,!0],this.lineWidth=[1,1,1]}p.prototype.merge=function(l){for(var e=0;e<3;++e){var o=l[h[e]];o.visible?(this.enabled[e]=o.showspikes,this.colors[e]=t(o.spikecolor),this.drawSides[e]=o.spikesides,this.lineWidth[e]=o.spikethickness):(this.enabled[e]=!1,this.drawSides[e]=!1)}},z.exports=function(l){var e=new p;return e.merge(l),e}},{"../../../lib/str2rgbarray":802}],878:[function(n,z,q){"use strict";z.exports=function(e){for(var o=e.axesOptions,r=e.glplot.axesPixels,i=e.fullSceneLayout,u=[[],[],[]],s=0;s<3;++s){var a=i[p[s]];if(a._length=(r[s].hi-r[s].lo)*r[s].pixelsPerDataUnit/e.dataScale[s],Math.abs(a._length)===1/0||isNaN(a._length))u[s]=[];else{a._input_range=a.range.slice(),a.range[0]=r[s].lo/e.dataScale[s],a.range[1]=r[s].hi/e.dataScale[s],a._m=1/(e.dataScale[s]*r[s].pixelsPerDataUnit),a.range[0]===a.range[1]&&(a.range[0]-=1,a.range[1]+=1);var c=a.tickmode;if(a.tickmode==="auto"){a.tickmode="linear";var f=a.nticks||h.constrain(a._length/40,4,9);t.autoTicks(a,Math.abs(a.range[1]-a.range[0])/f)}for(var g=t.calcTicks(a,{msUTC:!0}),d=0;d<g.length;++d)g[d].x=g[d].x*e.dataScale[s],a.type==="date"&&(g[d].text=g[d].text.replace(/\<br\>/g," "));u[s]=g,a.tickmode=c}}for(o.ticks=u,s=0;s<3;++s)for(l[s]=.5*(e.glplot.bounds[0][s]+e.glplot.bounds[1][s]),d=0;d<2;++d)o.bounds[d][s]=e.glplot.bounds[d][s];e.contourLevels=function(m){for(var y=new Array(3),v=0;v<3;++v){for(var T=m[v],w=new Array(T.length),A=0;A<T.length;++A)w[A]=T[A].x;y[v]=w}return y}(u)};var t=n("../../cartesian/axes"),h=n("../../../lib"),p=["xaxis","yaxis","zaxis"],l=[0,0,0]},{"../../../lib":778,"../../cartesian/axes":828}],879:[function(n,z,q){"use strict";function t(h,p){var l,e,o=[0,0,0,0];for(l=0;l<4;++l)for(e=0;e<4;++e)o[e]+=h[4*l+e]*p[l];return o}z.exports=function(h,p){return t(h.projection,t(h.view,t(h.model,[p[0],p[1],p[2],1])))}},{}],880:[function(n,z,q){"use strict";var t,h,p=n("gl-plot3d"),l=p.createCamera,e=p.createScene,o=n("webgl-context"),r=n("has-passive-events"),i=n("../../registry"),u=n("../../lib"),s=u.preserveDrawingBuffer(),a=n("../../plots/cartesian/axes"),c=n("../../components/fx"),f=n("../../lib/str2rgbarray"),g=n("../../lib/show_no_webgl_msg"),d=n("./project"),m=n("./layout/convert"),y=n("./layout/spikes"),v=n("./layout/tick_marks");function T(b,_){var S=document.createElement("div"),C=b.container;this.graphDiv=b.graphDiv;var k=document.createElementNS("http://www.w3.org/2000/svg","svg");k.style.position="absolute",k.style.top=k.style.left="0px",k.style.width=k.style.height="100%",k.style["z-index"]=20,k.style["pointer-events"]="none",S.appendChild(k),this.svgContainer=k,S.id=b.id,S.style.position="absolute",S.style.top=S.style.left="0px",S.style.width=S.style.height="100%",C.appendChild(S),this.fullLayout=_,this.id=b.id||"scene",this.fullSceneLayout=_[this.id],this.plotArgs=[[],{},{}],this.axesOptions=m(_,_[this.id]),this.spikeOptions=y(_[this.id]),this.container=S,this.staticMode=!!b.staticPlot,this.pixelRatio=this.pixelRatio||b.plotGlPixelRatio||2,this.dataScale=[1,1,1],this.contourLevels=[[],[],[]],this.convertAnnotations=i.getComponentMethod("annotations3d","convert"),this.drawAnnotations=i.getComponentMethod("annotations3d","draw"),this.initializeGLPlot()}var w=T.prototype;w.prepareOptions=function(){var b={canvas:this.canvas,gl:this.gl,glOptions:{preserveDrawingBuffer:s,premultipliedAlpha:!0,antialias:!0},container:this.container,axes:this.axesOptions,spikes:this.spikeOptions,pickRadius:10,snapToData:!0,autoScale:!0,autoBounds:!1,cameraObject:this.camera,pixelRatio:this.pixelRatio};if(this.staticMode){if(!(h||(t=document.createElement("canvas"),h=o({canvas:t,preserveDrawingBuffer:!0,premultipliedAlpha:!0,antialias:!0}))))throw new Error("error creating static canvas/context for image server");b.gl=h,b.canvas=t}return b};var A=!0;w.tryCreatePlot=function(){var b=this.prepareOptions(),_=!0;try{this.glplot=e(b)}catch{if(this.staticMode||!A||s)_=!1;else{u.warn(["webgl setup failed possibly due to","false preserveDrawingBuffer config.","The mobile/tablet device may not be detected by is-mobile module.","Enabling preserveDrawingBuffer in second attempt to create webgl scene..."].join(" "));try{s=b.glOptions.preserveDrawingBuffer=!0,this.glplot=e(b)}catch{s=b.glOptions.preserveDrawingBuffer=!1,_=!1}}}return A=!1,_},w.initializeGLCamera=function(){var b=this.fullSceneLayout.camera,_=b.projection.type==="orthographic";this.camera=l(this.container,{center:[b.center.x,b.center.y,b.center.z],eye:[b.eye.x,b.eye.y,b.eye.z],up:[b.up.x,b.up.y,b.up.z],_ortho:_,zoomMin:.01,zoomMax:100,mode:"orbit"})},w.initializeGLPlot=function(){var b=this;if(b.initializeGLCamera(),!b.tryCreatePlot())return g(b);b.traces={},b.make4thDimension();var _=b.graphDiv,S=_.layout,C=function(){var L={};return b.isCameraChanged(S)&&(L[b.id+".camera"]=b.getCamera()),b.isAspectChanged(S)&&(L[b.id+".aspectratio"]=b.glplot.getAspectratio(),S[b.id].aspectmode!=="manual"&&(b.fullSceneLayout.aspectmode=S[b.id].aspectmode=L[b.id+".aspectmode"]="manual")),L},k=function(L){if(L.fullSceneLayout.dragmode!==!1){var I=C();L.saveLayout(S),L.graphDiv.emit("plotly_relayout",I)}};return b.glplot.canvas&&(b.glplot.canvas.addEventListener("mouseup",function(){k(b)}),b.glplot.canvas.addEventListener("wheel",function(L){if(_._context._scrollZoom.gl3d){if(b.camera._ortho){var I=L.deltaX>L.deltaY?1.1:.9090909090909091,R=b.glplot.getAspectratio();b.glplot.setAspectratio({x:I*R.x,y:I*R.y,z:I*R.z})}k(b)}},!!r&&{passive:!1}),b.glplot.canvas.addEventListener("mousemove",function(){if(b.fullSceneLayout.dragmode!==!1&&b.camera.mouseListener.buttons!==0){var L=C();b.graphDiv.emit("plotly_relayouting",L)}}),b.staticMode||b.glplot.canvas.addEventListener("webglcontextlost",function(L){_&&_.emit&&_.emit("plotly_webglcontextlost",{event:L,layer:b.id})},!1)),b.glplot.oncontextloss=function(){b.recoverContext()},b.glplot.onrender=function(){b.render()},!0},w.render=function(){var b,_=this,S=_.graphDiv,C=_.svgContainer,k=_.container.getBoundingClientRect();S._fullLayout._calcInverseTransform(S);var L=S._fullLayout._invScaleX,I=S._fullLayout._invScaleY,R=k.width*L,V=k.height*I;C.setAttributeNS(null,"viewBox","0 0 "+R+" "+V),C.setAttributeNS(null,"width",R),C.setAttributeNS(null,"height",V),v(_),_.glplot.axes.update(_.axesOptions);for(var O,J=Object.keys(_.traces),D=null,B=_.glplot.selection,N=0;N<J.length;++N)(b=_.traces[J[N]]).data.hoverinfo!=="skip"&&b.handlePick(B)&&(D=b),b.setContourLevels&&b.setContourLevels();function F(le,fe){var ue=_.fullSceneLayout[le];return a.tickText(ue,ue.d2l(fe),"hover").text}if(D!==null){var H=d(_.glplot.cameraParams,B.dataCoordinate);b=D.data;var j,G=S._fullData[b.index],W=B.index,Q={xLabel:F("xaxis",B.traceCoordinate[0]),yLabel:F("yaxis",B.traceCoordinate[1]),zLabel:F("zaxis",B.traceCoordinate[2])},$=c.castHoverinfo(G,_.fullLayout,W),ee=($||"").split("+"),ie=$&&$==="all";G.hovertemplate||ie||(ee.indexOf("x")===-1&&(Q.xLabel=void 0),ee.indexOf("y")===-1&&(Q.yLabel=void 0),ee.indexOf("z")===-1&&(Q.zLabel=void 0),ee.indexOf("text")===-1&&(B.textLabel=void 0),ee.indexOf("name")===-1&&(D.name=void 0));var ae=[];b.type==="cone"||b.type==="streamtube"?(Q.uLabel=F("xaxis",B.traceCoordinate[3]),(ie||ee.indexOf("u")!==-1)&&ae.push("u: "+Q.uLabel),Q.vLabel=F("yaxis",B.traceCoordinate[4]),(ie||ee.indexOf("v")!==-1)&&ae.push("v: "+Q.vLabel),Q.wLabel=F("zaxis",B.traceCoordinate[5]),(ie||ee.indexOf("w")!==-1)&&ae.push("w: "+Q.wLabel),Q.normLabel=B.traceCoordinate[6].toPrecision(3),(ie||ee.indexOf("norm")!==-1)&&ae.push("norm: "+Q.normLabel),b.type==="streamtube"&&(Q.divergenceLabel=B.traceCoordinate[7].toPrecision(3),(ie||ee.indexOf("divergence")!==-1)&&ae.push("divergence: "+Q.divergenceLabel)),B.textLabel&&ae.push(B.textLabel),j=ae.join("<br>")):b.type==="isosurface"||b.type==="volume"?(Q.valueLabel=a.tickText(_._mockAxis,_._mockAxis.d2l(B.traceCoordinate[3]),"hover").text,ae.push("value: "+Q.valueLabel),B.textLabel&&ae.push(B.textLabel),j=ae.join("<br>")):j=B.textLabel;var oe={x:B.traceCoordinate[0],y:B.traceCoordinate[1],z:B.traceCoordinate[2],data:G._input,fullData:G,curveNumber:G.index,pointNumber:W};c.appendArrayPointValue(oe,G,W),b._module.eventData&&(oe=G._module.eventData(oe,B,G,{},W));var de={points:[oe]};_.fullSceneLayout.hovermode&&c.loneHover({trace:G,x:(.5+.5*H[0]/H[3])*R,y:(.5-.5*H[1]/H[3])*V,xLabel:Q.xLabel,yLabel:Q.yLabel,zLabel:Q.zLabel,text:j,name:D.name,color:c.castHoverOption(G,W,"bgcolor")||D.color,borderColor:c.castHoverOption(G,W,"bordercolor"),fontFamily:c.castHoverOption(G,W,"font.family"),fontSize:c.castHoverOption(G,W,"font.size"),fontColor:c.castHoverOption(G,W,"font.color"),nameLength:c.castHoverOption(G,W,"namelength"),textAlign:c.castHoverOption(G,W,"align"),hovertemplate:u.castOption(G,W,"hovertemplate"),hovertemplateLabels:u.extendFlat({},oe,Q),eventData:[oe]},{container:C,gd:S}),B.buttons&&B.distance<5?S.emit("plotly_click",de):S.emit("plotly_hover",de),O=de}else c.loneUnhover(C),S.emit("plotly_unhover",O);_.drawAnnotations(_)},w.recoverContext=function(){var b=this;b.glplot.dispose();var _=function(){b.glplot.gl.isContextLost()?requestAnimationFrame(_):b.initializeGLPlot()?b.plot.apply(b,b.plotArgs):u.error("Catastrophic and unrecoverable WebGL error. Context lost.")};requestAnimationFrame(_)};var E=["xaxis","yaxis","zaxis"];function M(b,_,S){for(var C=b.fullSceneLayout,k=0;k<3;k++){var L=E[k],I=L.charAt(0),R=C[L],V=_[I],O=_[I+"calendar"],J=_["_"+I+"length"];if(u.isArrayOrTypedArray(V))for(var D,B=0;B<(J||V.length);B++)if(u.isArrayOrTypedArray(V[B]))for(var N=0;N<V[B].length;++N)D=R.d2l(V[B][N],0,O),!isNaN(D)&&isFinite(D)&&(S[0][k]=Math.min(S[0][k],D),S[1][k]=Math.max(S[1][k],D));else D=R.d2l(V[B],0,O),!isNaN(D)&&isFinite(D)&&(S[0][k]=Math.min(S[0][k],D),S[1][k]=Math.max(S[1][k],D));else S[0][k]=Math.min(S[0][k],0),S[1][k]=Math.max(S[1][k],J-1)}}w.plot=function(b,_,S){if(this.plotArgs=[b,_,S],!this.glplot.contextLost){var C,k,L,I,R,V,O=_[this.id],J=S[this.id];this.fullLayout=_,this.fullSceneLayout=O,this.axesOptions.merge(_,O),this.spikeOptions.merge(O),this.setViewport(O),this.updateFx(O.dragmode,O.hovermode),this.camera.enableWheel=this.graphDiv._context._scrollZoom.gl3d,this.glplot.setClearColor(f(O.bgcolor)),this.setConvert(R),b?Array.isArray(b)||(b=[b]):b=[];var D=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]];for(L=0;L<b.length;++L)(C=b[L]).visible===!0&&C._length!==0&&M(this,C,D);(function(De,_e){for(var Pe=De.fullSceneLayout,Fe=Pe.annotations||[],ze=0;ze<3;ze++)for(var He=E[ze],et=He.charAt(0),Re=Pe[He],Ze=0;Ze<Fe.length;Ze++){var Ke=Fe[Ze];if(Ke.visible){var $e=Re.r2l(Ke[et]);!isNaN($e)&&isFinite($e)&&(_e[0][ze]=Math.min(_e[0][ze],$e),_e[1][ze]=Math.max(_e[1][ze],$e))}}})(this,D);var B=[1,1,1];for(I=0;I<3;++I)D[1][I]===D[0][I]?B[I]=1:B[I]=1/(D[1][I]-D[0][I]);for(this.dataScale=B,this.convertAnnotations(this),L=0;L<b.length;++L)(C=b[L]).visible===!0&&C._length!==0&&((k=this.traces[C.uid])?k.data.type===C.type?k.update(C):(k.dispose(),k=C._module.plot(this,C),this.traces[C.uid]=k):(k=C._module.plot(this,C),this.traces[C.uid]=k),k.name=C.name);var N=Object.keys(this.traces);e:for(L=0;L<N.length;++L){for(I=0;I<b.length;++I)if(b[I].uid===N[L]&&b[I].visible===!0&&b[I]._length!==0)continue e;(k=this.traces[N[L]]).dispose(),delete this.traces[N[L]]}this.glplot.objects.sort(function(De,_e){return De._trace.data.index-_e._trace.data.index});var F,H=[[0,0,0],[0,0,0]],j=[],G={};for(L=0;L<3;++L){if((V=(R=O[E[L]]).type)in G?(G[V].acc*=B[L],G[V].count+=1):G[V]={acc:B[L],count:1},R.autorange){H[0][L]=1/0,H[1][L]=-1/0;var W=this.glplot.objects,Q=this.fullSceneLayout.annotations||[],$=R._name.charAt(0);for(I=0;I<W.length;I++){var ee=W[I],ie=ee.bounds,ae=ee._trace.data._pad||0;ee.constructor.name==="ErrorBars"&&R._lowerLogErrorBound?H[0][L]=Math.min(H[0][L],R._lowerLogErrorBound):H[0][L]=Math.min(H[0][L],ie[0][L]/B[L]-ae),H[1][L]=Math.max(H[1][L],ie[1][L]/B[L]+ae)}for(I=0;I<Q.length;I++){var oe=Q[I];if(oe.visible){var de=R.r2l(oe[$]);H[0][L]=Math.min(H[0][L],de),H[1][L]=Math.max(H[1][L],de)}}if("rangemode"in R&&R.rangemode==="tozero"&&(H[0][L]=Math.min(H[0][L],0),H[1][L]=Math.max(H[1][L],0)),H[0][L]>H[1][L])H[0][L]=-1,H[1][L]=1;else{var le=H[1][L]-H[0][L];H[0][L]-=le/32,H[1][L]+=le/32}if(R.autorange==="reversed"){var fe=H[0][L];H[0][L]=H[1][L],H[1][L]=fe}}else{var ue=R.range;H[0][L]=R.r2l(ue[0]),H[1][L]=R.r2l(ue[1])}H[0][L]===H[1][L]&&(H[0][L]-=1,H[1][L]+=1),j[L]=H[1][L]-H[0][L],this.glplot.setBounds(L,{min:H[0][L]*B[L],max:H[1][L]*B[L]})}var we=O.aspectmode;if(we==="cube")F=[1,1,1];else if(we==="manual"){var Ae=O.aspectratio;F=[Ae.x,Ae.y,Ae.z]}else{if(we!=="auto"&&we!=="data")throw new Error("scene.js aspectRatio was not one of the enumerated types");var Se=[1,1,1];for(L=0;L<3;++L){var ke=G[V=(R=O[E[L]]).type];Se[L]=Math.pow(ke.acc,1/ke.count)/B[L]}F=we==="data"||Math.max.apply(null,Se)/Math.min.apply(null,Se)<=4?Se:[1,1,1]}O.aspectratio.x=J.aspectratio.x=F[0],O.aspectratio.y=J.aspectratio.y=F[1],O.aspectratio.z=J.aspectratio.z=F[2],this.glplot.setAspectratio(O.aspectratio),this.viewInitial.aspectratio||(this.viewInitial.aspectratio={x:O.aspectratio.x,y:O.aspectratio.y,z:O.aspectratio.z}),this.viewInitial.aspectmode||(this.viewInitial.aspectmode=O.aspectmode);var Me=O.domain||null,ve=_._size||null;if(Me&&ve){var ge=this.container.style;ge.position="absolute",ge.left=ve.l+Me.x[0]*ve.w+"px",ge.top=ve.t+(1-Me.y[1])*ve.h+"px",ge.width=ve.w*(Me.x[1]-Me.x[0])+"px",ge.height=ve.h*(Me.y[1]-Me.y[0])+"px"}this.glplot.redraw()}},w.destroy=function(){this.glplot&&(this.camera.mouseListener.enabled=!1,this.container.removeEventListener("wheel",this.camera.wheelListener),this.camera=null,this.glplot.dispose(),this.container.parentNode.removeChild(this.container),this.glplot=null)},w.getCamera=function(){var b;return this.camera.view.recalcMatrix(this.camera.view.lastT()),{up:{x:(b=this.camera).up[0],y:b.up[1],z:b.up[2]},center:{x:b.center[0],y:b.center[1],z:b.center[2]},eye:{x:b.eye[0],y:b.eye[1],z:b.eye[2]},projection:{type:b._ortho===!0?"orthographic":"perspective"}}},w.setViewport=function(b){var _,S=b.camera;this.camera.lookAt.apply(this,[[(_=S).eye.x,_.eye.y,_.eye.z],[_.center.x,_.center.y,_.center.z],[_.up.x,_.up.y,_.up.z]]),this.glplot.setAspectratio(b.aspectratio),S.projection.type==="orthographic"!==this.camera._ortho&&(this.glplot.redraw(),this.glplot.clearRGBA(),this.glplot.dispose(),this.initializeGLPlot())},w.isCameraChanged=function(b){var _=this.getCamera(),S=u.nestedProperty(b,this.id+".camera").get();function C(R,V,O,J){var D=["up","center","eye"],B=["x","y","z"];return V[D[O]]&&R[D[O]][B[J]]===V[D[O]][B[J]]}var k=!1;if(S===void 0)k=!0;else{for(var L=0;L<3;L++)for(var I=0;I<3;I++)if(!C(_,S,L,I)){k=!0;break}(!S.projection||_.projection&&_.projection.type!==S.projection.type)&&(k=!0)}return k},w.isAspectChanged=function(b){var _=this.glplot.getAspectratio(),S=u.nestedProperty(b,this.id+".aspectratio").get();return S===void 0||S.x!==_.x||S.y!==_.y||S.z!==_.z},w.saveLayout=function(b){var _,S,C,k,L,I,R=this.fullLayout,V=this.isCameraChanged(b),O=this.isAspectChanged(b),J=V||O;if(J){var D={};V&&(_=this.getCamera(),C=(S=u.nestedProperty(b,this.id+".camera")).get(),D[this.id+".camera"]=C),O&&(k=this.glplot.getAspectratio(),I=(L=u.nestedProperty(b,this.id+".aspectratio")).get(),D[this.id+".aspectratio"]=I),i.call("_storeDirectGUIEdit",b,R._preGUI,D),V&&(S.set(_),u.nestedProperty(R,this.id+".camera").set(_)),O&&(L.set(k),u.nestedProperty(R,this.id+".aspectratio").set(k),this.glplot.redraw())}return J},w.updateFx=function(b,_){var S=this.camera;if(S)if(b==="orbit")S.mode="orbit",S.keyBindingMode="rotate";else if(b==="turntable"){S.up=[0,0,1],S.mode="turntable",S.keyBindingMode="rotate";var C=this.graphDiv,k=C._fullLayout,L=this.fullSceneLayout.camera,I=L.up.x,R=L.up.y,V=L.up.z;if(V/Math.sqrt(I*I+R*R+V*V)<.999){var O=this.id+".camera.up",J={x:0,y:0,z:1},D={};D[O]=J;var B=C.layout;i.call("_storeDirectGUIEdit",B,k._preGUI,D),L.up=J,u.nestedProperty(B,O).set(J)}}else S.keyBindingMode=b;this.fullSceneLayout.hovermode=_},w.toImage=function(b){b||(b="png"),this.staticMode&&this.container.appendChild(t),this.glplot.redraw();var _=this.glplot.gl,S=_.drawingBufferWidth,C=_.drawingBufferHeight;_.bindFramebuffer(_.FRAMEBUFFER,null);var k=new Uint8Array(S*C*4);_.readPixels(0,0,S,C,_.RGBA,_.UNSIGNED_BYTE,k),function(O,J,D){for(var B=0,N=D-1;B<N;++B,--N)for(var F=0;F<J;++F)for(var H=0;H<4;++H){var j=4*(J*B+F)+H,G=4*(J*N+F)+H,W=O[j];O[j]=O[G],O[G]=W}}(k,S,C),function(O,J,D){for(var B=0;B<D;++B)for(var N=0;N<J;++N){var F=4*(J*B+N),H=O[F+3];if(H>0)for(var j=255/H,G=0;G<3;++G)O[F+G]=Math.min(j*O[F+G],255)}}(k,S,C);var L=document.createElement("canvas");L.width=S,L.height=C;var I,R=L.getContext("2d"),V=R.createImageData(S,C);switch(V.data.set(k),R.putImageData(V,0,0),b){case"jpeg":I=L.toDataURL("image/jpeg");break;case"webp":I=L.toDataURL("image/webp");break;default:I=L.toDataURL("image/png")}return this.staticMode&&this.container.removeChild(t),I},w.setConvert=function(){for(var b=0;b<3;b++){var _=this.fullSceneLayout[E[b]];a.setConvert(_,this.fullLayout),_.setScale=u.noop}},w.make4thDimension=function(){var b=this.graphDiv._fullLayout;this._mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},a.setConvert(this._mockAxis,b)},z.exports=T},{"../../components/fx":683,"../../lib":778,"../../lib/show_no_webgl_msg":800,"../../lib/str2rgbarray":802,"../../plots/cartesian/axes":828,"../../registry":911,"./layout/convert":874,"./layout/spikes":877,"./layout/tick_marks":878,"./project":879,"gl-plot3d":321,"has-passive-events":441,"webgl-context":606}],881:[function(n,z,q){"use strict";z.exports=function(t,h,p,l){l=l||t.length;for(var e=new Array(l),o=0;o<l;o++)e[o]=[t[o],h[o],p[o]];return e}},{}],882:[function(n,z,q){"use strict";var t=n("./font_attributes"),h=n("./animation_attributes"),p=n("../components/color/attributes"),l=n("../components/shapes/draw_newshape/attributes"),e=n("./pad_attributes"),o=n("../lib/extend").extendFlat,r=t({editType:"calc"});r.family.dflt='"Open Sans", verdana, arial, sans-serif',r.size.dflt=12,r.color.dflt=p.defaultLine,z.exports={font:r,title:{text:{valType:"string",editType:"layoutstyle"},font:t({editType:"layoutstyle"}),xref:{valType:"enumerated",dflt:"container",values:["container","paper"],editType:"layoutstyle"},yref:{valType:"enumerated",dflt:"container",values:["container","paper"],editType:"layoutstyle"},x:{valType:"number",min:0,max:1,dflt:.5,editType:"layoutstyle"},y:{valType:"number",min:0,max:1,dflt:"auto",editType:"layoutstyle"},xanchor:{valType:"enumerated",dflt:"auto",values:["auto","left","center","right"],editType:"layoutstyle"},yanchor:{valType:"enumerated",dflt:"auto",values:["auto","top","middle","bottom"],editType:"layoutstyle"},pad:o(e({editType:"layoutstyle"}),{}),editType:"layoutstyle"},uniformtext:{mode:{valType:"enumerated",values:[!1,"hide","show"],dflt:!1,editType:"plot"},minsize:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"plot"},autosize:{valType:"boolean",dflt:!1,editType:"none"},width:{valType:"number",min:10,dflt:700,editType:"plot"},height:{valType:"number",min:10,dflt:450,editType:"plot"},margin:{l:{valType:"number",min:0,dflt:80,editType:"plot"},r:{valType:"number",min:0,dflt:80,editType:"plot"},t:{valType:"number",min:0,dflt:100,editType:"plot"},b:{valType:"number",min:0,dflt:80,editType:"plot"},pad:{valType:"number",min:0,dflt:0,editType:"plot"},autoexpand:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},computed:{valType:"any",editType:"none"},paper_bgcolor:{valType:"color",dflt:p.background,editType:"plot"},plot_bgcolor:{valType:"color",dflt:p.background,editType:"layoutstyle"},autotypenumbers:{valType:"enumerated",values:["convert types","strict"],dflt:"convert types",editType:"calc"},separators:{valType:"string",editType:"plot"},hidesources:{valType:"boolean",dflt:!1,editType:"plot"},showlegend:{valType:"boolean",editType:"legend"},colorway:{valType:"colorlist",dflt:p.defaults,editType:"calc"},datarevision:{valType:"any",editType:"calc"},uirevision:{valType:"any",editType:"none"},editrevision:{valType:"any",editType:"none"},selectionrevision:{valType:"any",editType:"none"},template:{valType:"any",editType:"calc"},modebar:{orientation:{valType:"enumerated",values:["v","h"],dflt:"h",editType:"modebar"},bgcolor:{valType:"color",editType:"modebar"},color:{valType:"color",editType:"modebar"},activecolor:{valType:"color",editType:"modebar"},uirevision:{valType:"any",editType:"none"},editType:"modebar"},newshape:l.newshape,activeshape:l.activeshape,meta:{valType:"any",arrayOk:!0,editType:"plot"},transition:o({},h.transition,{editType:"none"}),_deprecated:{title:{valType:"string",editType:"layoutstyle"},titlefont:t({editType:"layoutstyle"})}}},{"../components/color/attributes":642,"../components/shapes/draw_newshape/attributes":725,"../lib/extend":768,"./animation_attributes":822,"./font_attributes":856,"./pad_attributes":890}],883:[function(n,z,q){"use strict";var t={"open-street-map":{id:"osm",version:8,sources:{"plotly-osm-tiles":{type:"raster",attribution:'<a href="http://www.openstreetmap.org/about/" target="_blank">\xA9 OpenStreetMap</a>',tiles:["https://a.tile.openstreetmap.org/{z}/{x}/{y}.png","https://b.tile.openstreetmap.org/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-osm-tiles",type:"raster",source:"plotly-osm-tiles",minzoom:0,maxzoom:22}]},"white-bg":{id:"white-bg",version:8,sources:{},layers:[{id:"white-bg",type:"background",paint:{"background-color":"#FFFFFF"},minzoom:0,maxzoom:22}]},"carto-positron":{id:"carto-positron",version:8,sources:{"plotly-carto-positron":{type:"raster",attribution:'<a href="https://carto.com/" target="_blank">\xA9 CARTO</a>',tiles:["https://cartodb-basemaps-c.global.ssl.fastly.net/light_all/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-carto-positron",type:"raster",source:"plotly-carto-positron",minzoom:0,maxzoom:22}]},"carto-darkmatter":{id:"carto-darkmatter",version:8,sources:{"plotly-carto-darkmatter":{type:"raster",attribution:'<a href="https://carto.com/" target="_blank">\xA9 CARTO</a>',tiles:["https://cartodb-basemaps-c.global.ssl.fastly.net/dark_all/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-carto-darkmatter",type:"raster",source:"plotly-carto-darkmatter",minzoom:0,maxzoom:22}]},"stamen-terrain":{id:"stamen-terrain",version:8,sources:{"plotly-stamen-terrain":{type:"raster",attribution:'Map tiles by <a href="http://stamen.com">Stamen Design</a>, under <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> | Data by <a href="http://openstreetmap.org">OpenStreetMap</a>, under <a href="http://www.openstreetmap.org/copyright">ODbL</a>.',tiles:["https://stamen-tiles.a.ssl.fastly.net/terrain/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-terrain",type:"raster",source:"plotly-stamen-terrain",minzoom:0,maxzoom:22}]},"stamen-toner":{id:"stamen-toner",version:8,sources:{"plotly-stamen-toner":{type:"raster",attribution:'Map tiles by <a href="http://stamen.com">Stamen Design</a>, under <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> | Data by <a href="http://openstreetmap.org">OpenStreetMap</a>, under <a href="http://www.openstreetmap.org/copyright">ODbL</a>.',tiles:["https://stamen-tiles.a.ssl.fastly.net/toner/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-toner",type:"raster",source:"plotly-stamen-toner",minzoom:0,maxzoom:22}]},"stamen-watercolor":{id:"stamen-watercolor",version:8,sources:{"plotly-stamen-watercolor":{type:"raster",attribution:'Map tiles by <a href="http://stamen.com">Stamen Design</a>, under <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> | Data by <a href="http://openstreetmap.org">OpenStreetMap</a>, under <a href="http://creativecommons.org/licenses/by-sa/3.0">CC BY SA</a>.',tiles:["https://stamen-tiles.a.ssl.fastly.net/watercolor/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-watercolor",type:"raster",source:"plotly-stamen-watercolor",minzoom:0,maxzoom:22}]}},h=Object.keys(t);z.exports={requiredVersion:"1.10.1",styleUrlPrefix:"mapbox://styles/mapbox/",styleUrlSuffix:"v9",styleValuesMapbox:["basic","streets","outdoors","light","dark","satellite","satellite-streets"],styleValueDflt:"basic",stylesNonMapbox:t,styleValuesNonMapbox:h,traceLayerPrefix:"plotly-trace-layer-",layoutLayerPrefix:"plotly-layout-layer-",wrongVersionErrorMsg:["Your custom plotly.js bundle is not using the correct mapbox-gl version","Please install mapbox-gl@1.10.1."].join(`
`),noAccessTokenErrorMsg:["Missing Mapbox access token.","Mapbox trace type require a Mapbox access token to be registered.","For example:","  Plotly.plot(gd, data, layout, { mapboxAccessToken: 'my-access-token' });","More info here: https://www.mapbox.com/help/define-access-token/"].join(`
`),missingStyleErrorMsg:["No valid mapbox style found, please set `mapbox.style` to one of:",h.join(", "),"or register a Mapbox access token to use a Mapbox-served style."].join(`
`),multipleTokensErrorMsg:["Set multiple mapbox access token across different mapbox subplot,","using first token found as mapbox-gl does not allow multipleaccess tokens on the same page."].join(`
`),mapOnErrorMsg:"Mapbox error.",mapboxLogo:{path0:"m 10.5,1.24 c -5.11,0 -9.25,4.15 -9.25,9.25 0,5.1 4.15,9.25 9.25,9.25 5.1,0 9.25,-4.15 9.25,-9.25 0,-5.11 -4.14,-9.25 -9.25,-9.25 z m 4.39,11.53 c -1.93,1.93 -4.78,2.31 -6.7,2.31 -0.7,0 -1.41,-0.05 -2.1,-0.16 0,0 -1.02,-5.64 2.14,-8.81 0.83,-0.83 1.95,-1.28 3.13,-1.28 1.27,0 2.49,0.51 3.39,1.42 1.84,1.84 1.89,4.75 0.14,6.52 z",path1:"M 10.5,-0.01 C 4.7,-0.01 0,4.7 0,10.49 c 0,5.79 4.7,10.5 10.5,10.5 5.8,0 10.5,-4.7 10.5,-10.5 C 20.99,4.7 16.3,-0.01 10.5,-0.01 Z m 0,19.75 c -5.11,0 -9.25,-4.15 -9.25,-9.25 0,-5.1 4.14,-9.26 9.25,-9.26 5.11,0 9.25,4.15 9.25,9.25 0,5.13 -4.14,9.26 -9.25,9.26 z",path2:"M 14.74,6.25 C 12.9,4.41 9.98,4.35 8.23,6.1 5.07,9.27 6.09,14.91 6.09,14.91 c 0,0 5.64,1.02 8.81,-2.14 C 16.64,11 16.59,8.09 14.74,6.25 Z m -2.27,4.09 -0.91,1.87 -0.9,-1.87 -1.86,-0.91 1.86,-0.9 0.9,-1.87 0.91,1.87 1.86,0.9 z",polygon:"11.56,12.21 10.66,10.34 8.8,9.43 10.66,8.53 11.56,6.66 12.47,8.53 14.33,9.43 12.47,10.34"},styleRules:{map:"overflow:hidden;position:relative;","missing-css":"display:none;",canary:"background-color:salmon;","ctrl-bottom-left":"position: absolute; pointer-events: none; z-index: 2; bottom: 0; left: 0;","ctrl-bottom-right":"position: absolute; pointer-events: none; z-index: 2; right: 0; bottom: 0;",ctrl:"clear: both; pointer-events: auto; transform: translate(0, 0);","ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-inner":"display: none;","ctrl-attrib.mapboxgl-compact:hover .mapboxgl-ctrl-attrib-inner":"display: block; margin-top:2px","ctrl-attrib.mapboxgl-compact:hover":"padding: 2px 24px 2px 4px; visibility: visible; margin-top: 6px;","ctrl-attrib.mapboxgl-compact::after":`content: ""; cursor: pointer; position: absolute; background-image: url('data:image/svg+xml;charset=utf-8,%3Csvg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"%3E %3Cpath fill="%23333333" fill-rule="evenodd" d="M4,10a6,6 0 1,0 12,0a6,6 0 1,0 -12,0 M9,7a1,1 0 1,0 2,0a1,1 0 1,0 -2,0 M9,10a1,1 0 1,1 2,0l0,3a1,1 0 1,1 -2,0"/%3E %3C/svg%3E'); background-color: rgba(255, 255, 255, 0.5); width: 24px; height: 24px; box-sizing: border-box; border-radius: 12px;`,"ctrl-attrib.mapboxgl-compact":"min-height: 20px; padding: 0; margin: 10px; position: relative; background-color: #fff; border-radius: 3px 12px 12px 3px;","ctrl-bottom-right > .mapboxgl-ctrl-attrib.mapboxgl-compact::after":"bottom: 0; right: 0","ctrl-bottom-left > .mapboxgl-ctrl-attrib.mapboxgl-compact::after":"bottom: 0; left: 0","ctrl-bottom-left .mapboxgl-ctrl":"margin: 0 0 10px 10px; float: left;","ctrl-bottom-right .mapboxgl-ctrl":"margin: 0 10px 10px 0; float: right;","ctrl-attrib":"color: rgba(0, 0, 0, 0.75); text-decoration: none; font-size: 12px","ctrl-attrib a":"color: rgba(0, 0, 0, 0.75); text-decoration: none; font-size: 12px","ctrl-attrib a:hover":"color: inherit; text-decoration: underline;","ctrl-attrib .mapbox-improve-map":"font-weight: bold; margin-left: 2px;","attrib-empty":"display: none;","ctrl-logo":`display:block; width: 21px; height: 21px; background-image: url('data:image/svg+xml;charset=utf-8,%3C?xml version="1.0" encoding="utf-8"?%3E %3Csvg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 21 21" style="enable-background:new 0 0 21 21;" xml:space="preserve"%3E%3Cg transform="translate(0,0.01)"%3E%3Cpath d="m 10.5,1.24 c -5.11,0 -9.25,4.15 -9.25,9.25 0,5.1 4.15,9.25 9.25,9.25 5.1,0 9.25,-4.15 9.25,-9.25 0,-5.11 -4.14,-9.25 -9.25,-9.25 z m 4.39,11.53 c -1.93,1.93 -4.78,2.31 -6.7,2.31 -0.7,0 -1.41,-0.05 -2.1,-0.16 0,0 -1.02,-5.64 2.14,-8.81 0.83,-0.83 1.95,-1.28 3.13,-1.28 1.27,0 2.49,0.51 3.39,1.42 1.84,1.84 1.89,4.75 0.14,6.52 z" style="opacity:0.9;fill:%23ffffff;enable-background:new" class="st0"/%3E%3Cpath d="M 10.5,-0.01 C 4.7,-0.01 0,4.7 0,10.49 c 0,5.79 4.7,10.5 10.5,10.5 5.8,0 10.5,-4.7 10.5,-10.5 C 20.99,4.7 16.3,-0.01 10.5,-0.01 Z m 0,19.75 c -5.11,0 -9.25,-4.15 -9.25,-9.25 0,-5.1 4.14,-9.26 9.25,-9.26 5.11,0 9.25,4.15 9.25,9.25 0,5.13 -4.14,9.26 -9.25,9.26 z" style="opacity:0.35;enable-background:new" class="st1"/%3E%3Cpath d="M 14.74,6.25 C 12.9,4.41 9.98,4.35 8.23,6.1 5.07,9.27 6.09,14.91 6.09,14.91 c 0,0 5.64,1.02 8.81,-2.14 C 16.64,11 16.59,8.09 14.74,6.25 Z m -2.27,4.09 -0.91,1.87 -0.9,-1.87 -1.86,-0.91 1.86,-0.9 0.9,-1.87 0.91,1.87 1.86,0.9 z" style="opacity:0.35;enable-background:new" class="st1"/%3E%3Cpolygon points="11.56,12.21 10.66,10.34 8.8,9.43 10.66,8.53 11.56,6.66 12.47,8.53 14.33,9.43 12.47,10.34 " style="opacity:0.9;fill:%23ffffff;enable-background:new" class="st0"/%3E%3C/g%3E%3C/svg%3E')`}}},{}],884:[function(n,z,q){"use strict";var t=n("../../lib");z.exports=function(h,p){var l=h.split(" "),e=l[0],o=l[1],r=t.isArrayOrTypedArray(p)?t.mean(p):p,i=.5+r/100,u=1.5+r/100,s=["",""],a=[0,0];switch(e){case"top":s[0]="top",a[1]=-u;break;case"bottom":s[0]="bottom",a[1]=u}switch(o){case"left":s[1]="right",a[0]=-i;break;case"right":s[1]="left",a[0]=i}return{anchor:s[0]&&s[1]?s.join("-"):s[0]?s[0]:s[1]?s[1]:"center",offset:a}}},{"../../lib":778}],885:[function(n,z,q){"use strict";var t=n("mapbox-gl"),h=n("../../lib"),p=h.strTranslate,l=h.strScale,e=n("../../plots/get_data").getSubplotCalcData,o=n("../../constants/xmlns_namespaces"),r=n("d3"),i=n("../../components/drawing"),u=n("../../lib/svg_text_utils"),s=n("./mapbox"),a=q.constants=n("./constants");function c(f){return typeof f=="string"&&(a.styleValuesMapbox.indexOf(f)!==-1||f.indexOf("mapbox://")===0)}q.name="mapbox",q.attr="subplot",q.idRoot="mapbox",q.idRegex=q.attrRegex=h.counterRegex("mapbox"),q.attributes={subplot:{valType:"subplotid",dflt:"mapbox",editType:"calc"}},q.layoutAttributes=n("./layout_attributes"),q.supplyLayoutDefaults=n("./layout_defaults"),q.plot=function(f){var g=f._fullLayout,d=f.calcdata,m=g._subplots.mapbox;if(t.version!==a.requiredVersion)throw new Error(a.wrongVersionErrorMsg);var y=function(M,b){var _=M._fullLayout;if(M._context.mapboxAccessToken==="")return"";for(var S=[],C=[],k=!1,L=!1,I=0;I<b.length;I++){var R=_[b[I]],V=R.accesstoken;c(R.style)&&(V?h.pushUnique(S,V):(c(R._input.style)&&(h.error("Uses Mapbox map style, but did not set an access token."),k=!0),L=!0)),V&&h.pushUnique(C,V)}if(L){var O=k?a.noAccessTokenErrorMsg:a.missingStyleErrorMsg;throw h.error(O),new Error(O)}return S.length?(S.length>1&&h.warn(a.multipleTokensErrorMsg),S[0]):(C.length&&h.log(["Listed mapbox access token(s)",C.join(","),"but did not use a Mapbox map style, ignoring token(s)."].join(" ")),"")}(f,m);t.accessToken=y;for(var v=0;v<m.length;v++){var T=m[v],w=e(d,"mapbox",T),A=g[T],E=A._subplot;E||(E=new s(f,T),g[T]._subplot=E),E.viewInitial||(E.viewInitial={center:h.extendFlat({},A.center),zoom:A.zoom,bearing:A.bearing,pitch:A.pitch}),E.plot(w,g,f._promises)}},q.clean=function(f,g,d,m){for(var y=m._subplots.mapbox||[],v=0;v<y.length;v++){var T=y[v];!g[T]&&m[T]._subplot&&m[T]._subplot.destroy()}},q.toSVG=function(f){for(var g=f._fullLayout,d=g._subplots.mapbox,m=g._size,y=0;y<d.length;y++){var v=g[d[y]],T=v.domain,w=v._subplot.toImage("png");g._glimages.append("svg:image").attr({xmlns:o.svg,"xlink:href":w,x:m.l+m.w*T.x[0],y:m.t+m.h*(1-T.y[1]),width:m.w*(T.x[1]-T.x[0]),height:m.h*(T.y[1]-T.y[0]),preserveAspectRatio:"none"});var A=r.select(v._subplot.div);if(A.select(".mapboxgl-ctrl-logo").node().offsetParent!==null){var E=g._glimages.append("g");E.attr("transform",p(m.l+m.w*T.x[0]+10,m.t+m.h*(1-T.y[0])-31)),E.append("path").attr("d",a.mapboxLogo.path0).style({opacity:.9,fill:"#ffffff","enable-background":"new"}),E.append("path").attr("d",a.mapboxLogo.path1).style("opacity",.35).style("enable-background","new"),E.append("path").attr("d",a.mapboxLogo.path2).style("opacity",.35).style("enable-background","new"),E.append("polygon").attr("points",a.mapboxLogo.polygon).style({opacity:.9,fill:"#ffffff","enable-background":"new"})}var M=A.select(".mapboxgl-ctrl-attrib").text().replace("Improve this map",""),b=g._glimages.append("g"),_=b.append("text");_.text(M).classed("static-attribution",!0).attr({"font-size":12,"font-family":"Arial",color:"rgba(0, 0, 0, 0.75)","text-anchor":"end","data-unformatted":M});var S=i.bBox(_.node()),C=m.w*(T.x[1]-T.x[0]);if(S.width>C/2){var k=M.split("|").join("<br>");_.text(k).attr("data-unformatted",k).call(u.convertToTspans,f),S=i.bBox(_.node())}_.attr("transform",p(-3,8-S.height)),b.insert("rect",".static-attribution").attr({x:-S.width-6,y:-S.height-3,width:S.width+6,height:S.height+3,fill:"rgba(255, 255, 255, 0.75)"});var L=1;S.width+6>C&&(L=C/(S.width+6));var I=[m.l+m.w*T.x[1],m.t+m.h*(1-T.y[0])];b.attr("transform",p(I[0],I[1])+l(L))}},q.updateFx=function(f){for(var g=f._fullLayout,d=g._subplots.mapbox,m=0;m<d.length;m++)g[d[m]]._subplot.updateFx(g)}},{"../../components/drawing":665,"../../constants/xmlns_namespaces":754,"../../lib":778,"../../lib/svg_text_utils":803,"../../plots/get_data":865,"./constants":883,"./layout_attributes":887,"./layout_defaults":888,"./mapbox":889,d3:169,"mapbox-gl":473}],886:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../../lib/svg_text_utils").sanitizeHTML,p=n("./convert_text_opts"),l=n("./constants");function e(u,s){this.subplot=u,this.uid=u.uid+"-"+s,this.index=s,this.idSource="source-"+this.uid,this.idLayer=l.layoutLayerPrefix+this.uid,this.sourceType=null,this.source=null,this.layerType=null,this.below=null,this.visible=!1}var o=e.prototype;function r(u){if(!u.visible)return!1;var s=u.source;if(Array.isArray(s)&&s.length>0){for(var a=0;a<s.length;a++)if(typeof s[a]!="string"||s[a].length===0)return!1;return!0}return t.isPlainObject(s)||typeof s=="string"&&s.length>0}function i(u){var s={},a={};switch(u.type){case"circle":t.extendFlat(a,{"circle-radius":u.circle.radius,"circle-color":u.color,"circle-opacity":u.opacity});break;case"line":t.extendFlat(a,{"line-width":u.line.width,"line-color":u.color,"line-opacity":u.opacity,"line-dasharray":u.line.dash});break;case"fill":t.extendFlat(a,{"fill-color":u.color,"fill-outline-color":u.fill.outlinecolor,"fill-opacity":u.opacity});break;case"symbol":var c=u.symbol,f=p(c.textposition,c.iconsize);t.extendFlat(s,{"icon-image":c.icon+"-15","icon-size":c.iconsize/10,"text-field":c.text,"text-size":c.textfont.size,"text-anchor":f.anchor,"text-offset":f.offset,"symbol-placement":c.placement}),t.extendFlat(a,{"icon-color":u.color,"text-color":c.textfont.color,"text-opacity":u.opacity});break;case"raster":t.extendFlat(a,{"raster-fade-duration":0,"raster-opacity":u.opacity})}return{layout:s,paint:a}}o.update=function(u){this.visible?this.needsNewImage(u)?this.updateImage(u):this.needsNewSource(u)?(this.removeLayer(),this.updateSource(u),this.updateLayer(u)):this.needsNewLayer(u)?this.updateLayer(u):this.updateStyle(u):(this.updateSource(u),this.updateLayer(u)),this.visible=r(u)},o.needsNewImage=function(u){return this.subplot.map.getSource(this.idSource)&&this.sourceType==="image"&&u.sourcetype==="image"&&(this.source!==u.source||JSON.stringify(this.coordinates)!==JSON.stringify(u.coordinates))},o.needsNewSource=function(u){return this.sourceType!==u.sourcetype||JSON.stringify(this.source)!==JSON.stringify(u.source)||this.layerType!==u.type},o.needsNewLayer=function(u){return this.layerType!==u.type||this.below!==this.subplot.belowLookup["layout-"+this.index]},o.lookupBelow=function(){return this.subplot.belowLookup["layout-"+this.index]},o.updateImage=function(u){this.subplot.map.getSource(this.idSource).updateImage({url:u.source,coordinates:u.coordinates});var s=this.findFollowingMapboxLayerId(this.lookupBelow());s!==null&&this.subplot.map.moveLayer(this.idLayer,s)},o.updateSource=function(u){var s=this.subplot.map;if(s.getSource(this.idSource)&&s.removeSource(this.idSource),this.sourceType=u.sourcetype,this.source=u.source,r(u)){var a=function(c){var f,g=c.sourcetype,d=c.source,m={type:g};return g==="geojson"?f="data":g==="vector"?f=typeof d=="string"?"url":"tiles":g==="raster"?(f="tiles",m.tileSize=256):g==="image"&&(f="url",m.coordinates=c.coordinates),m[f]=d,c.sourceattribution&&(m.attribution=h(c.sourceattribution)),m}(u);s.addSource(this.idSource,a)}},o.findFollowingMapboxLayerId=function(u){if(u==="traces")for(var s=this.subplot.getMapLayers(),a=0;a<s.length;a++){var c=s[a].id;if(typeof c=="string"&&c.indexOf(l.traceLayerPrefix)===0){u=c;break}}return u},o.updateLayer=function(u){var s=this.subplot,a=i(u),c=this.lookupBelow(),f=this.findFollowingMapboxLayerId(c);this.removeLayer(),r(u)&&s.addLayer({id:this.idLayer,source:this.idSource,"source-layer":u.sourcelayer||"",type:u.type,minzoom:u.minzoom,maxzoom:u.maxzoom,layout:a.layout,paint:a.paint},f),this.layerType=u.type,this.below=c},o.updateStyle=function(u){if(r(u)){var s=i(u);this.subplot.setOptions(this.idLayer,"setLayoutProperty",s.layout),this.subplot.setOptions(this.idLayer,"setPaintProperty",s.paint)}},o.removeLayer=function(){var u=this.subplot.map;u.getLayer(this.idLayer)&&u.removeLayer(this.idLayer)},o.dispose=function(){var u=this.subplot.map;u.getLayer(this.idLayer)&&u.removeLayer(this.idLayer),u.getSource(this.idSource)&&u.removeSource(this.idSource)},z.exports=function(u,s,a){var c=new e(u,s);return c.update(a),c}},{"../../lib":778,"../../lib/svg_text_utils":803,"./constants":883,"./convert_text_opts":884}],887:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../../components/color").defaultLine,p=n("../domain").attributes,l=n("../font_attributes"),e=n("../../traces/scatter/attributes").textposition,o=n("../../plot_api/edit_types").overrideAll,r=n("../../plot_api/plot_template").templatedArray,i=n("./constants"),u=l({});u.family.dflt="Open Sans Regular, Arial Unicode MS Regular",(z.exports=o({_arrayAttrRegexps:[t.counterRegex("mapbox",".layers",!0)],domain:p({name:"mapbox"}),accesstoken:{valType:"string",noBlank:!0,strict:!0},style:{valType:"any",values:i.styleValuesMapbox.concat(i.styleValuesNonMapbox),dflt:i.styleValueDflt},center:{lon:{valType:"number",dflt:0},lat:{valType:"number",dflt:0}},zoom:{valType:"number",dflt:1},bearing:{valType:"number",dflt:0},pitch:{valType:"number",dflt:0},layers:r("layer",{visible:{valType:"boolean",dflt:!0},sourcetype:{valType:"enumerated",values:["geojson","vector","raster","image"],dflt:"geojson"},source:{valType:"any"},sourcelayer:{valType:"string",dflt:""},sourceattribution:{valType:"string"},type:{valType:"enumerated",values:["circle","line","fill","symbol","raster"],dflt:"circle"},coordinates:{valType:"any"},below:{valType:"string"},color:{valType:"color",dflt:h},opacity:{valType:"number",min:0,max:1,dflt:1},minzoom:{valType:"number",min:0,max:24,dflt:0},maxzoom:{valType:"number",min:0,max:24,dflt:24},circle:{radius:{valType:"number",dflt:15}},line:{width:{valType:"number",dflt:2},dash:{valType:"data_array"}},fill:{outlinecolor:{valType:"color",dflt:h}},symbol:{icon:{valType:"string",dflt:"marker"},iconsize:{valType:"number",dflt:10},text:{valType:"string",dflt:""},placement:{valType:"enumerated",values:["point","line","line-center"],dflt:"point"},textfont:u,textposition:t.extendFlat({},e,{arrayOk:!1})}})},"plot","from-root")).uirevision={valType:"any",editType:"none"}},{"../../components/color":643,"../../lib":778,"../../plot_api/edit_types":810,"../../plot_api/plot_template":817,"../../traces/scatter/attributes":1187,"../domain":855,"../font_attributes":856,"./constants":883}],888:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../subplot_defaults"),p=n("../array_container_defaults"),l=n("./layout_attributes");function e(r,i,u,s){u("accesstoken",s.accessToken),u("style"),u("center.lon"),u("center.lat"),u("zoom"),u("bearing"),u("pitch"),p(r,i,{name:"layers",handleItemDefaults:o}),i._input=r}function o(r,i){function u(g,d){return t.coerce(r,i,l.layers,g,d)}if(u("visible")){var s,a=u("sourcetype"),c=a==="raster"||a==="image";u("source"),u("sourceattribution"),a==="vector"&&u("sourcelayer"),a==="image"&&u("coordinates"),c&&(s="raster");var f=u("type",s);c&&f!=="raster"&&(f=i.type="raster",t.log("Source types *raster* and *image* must drawn *raster* layer type.")),u("below"),u("color"),u("opacity"),u("minzoom"),u("maxzoom"),f==="circle"&&u("circle.radius"),f==="line"&&(u("line.width"),u("line.dash")),f==="fill"&&u("fill.outlinecolor"),f==="symbol"&&(u("symbol.icon"),u("symbol.iconsize"),u("symbol.text"),t.coerceFont(u,"symbol.textfont"),u("symbol.textposition"),u("symbol.placement"))}}z.exports=function(r,i,u){h(r,i,u,{type:"mapbox",attributes:l,handleDefaults:e,partition:"y",accessToken:i._mapboxAccessToken})}},{"../../lib":778,"../array_container_defaults":823,"../subplot_defaults":905,"./layout_attributes":887}],889:[function(n,z,q){"use strict";var t=n("mapbox-gl"),h=n("../../lib"),p=n("../../lib/geo_location_utils"),l=n("../../registry"),e=n("../cartesian/axes"),o=n("../../components/dragelement"),r=n("../../components/fx"),i=n("../../components/dragelement/helpers"),u=i.rectMode,s=i.drawMode,a=i.selectMode,c=n("../cartesian/select").prepSelect,f=n("../cartesian/select").clearSelect,g=n("../cartesian/select").clearSelectionsCache,d=n("../cartesian/select").selectOnClick,m=n("./constants"),y=n("./layers");function v(b,_){this.id=_,this.gd=b;var S=b._fullLayout,C=b._context;this.container=S._glcontainer.node(),this.isStatic=C.staticPlot,this.uid=S._uid+"-"+this.id,this.div=null,this.xaxis=null,this.yaxis=null,this.createFramework(S),this.map=null,this.accessToken=null,this.styleObj=null,this.traceHash={},this.layerList=[],this.belowLookup={},this.dragging=!1,this.wheeling=!1}var T=v.prototype;T.plot=function(b,_,S){var C,k=this,L=_[k.id];k.map&&L.accesstoken!==k.accessToken&&(k.map.remove(),k.map=null,k.styleObj=null,k.traceHash={},k.layerList=[]),C=k.map?new Promise(function(I,R){k.updateMap(b,_,I,R)}):new Promise(function(I,R){k.createMap(b,_,I,R)}),S.push(C)},T.createMap=function(b,_,S,C){var k=this,L=_[k.id],I=k.styleObj=A(L.style);k.accessToken=L.accesstoken;var R=k.map=new t.Map({container:k.div,style:I.style,center:M(L.center),zoom:L.zoom,bearing:L.bearing,pitch:L.pitch,interactive:!k.isStatic,preserveDrawingBuffer:k.isStatic,doubleClickZoom:!1,boxZoom:!1,attributionControl:!1}).addControl(new t.AttributionControl({compact:!0}));R._canvas.style.left="0px",R._canvas.style.top="0px",k.rejectOnError(C),k.isStatic||k.initFx(b,_);var V=[];V.push(new Promise(function(O){R.once("load",O)})),V=V.concat(p.fetchTraceGeoData(b)),Promise.all(V).then(function(){k.fillBelowLookup(b,_),k.updateData(b),k.updateLayout(_),k.resolveOnRender(S)}).catch(C)},T.updateMap=function(b,_,S,C){var k=this,L=k.map,I=_[this.id];k.rejectOnError(C);var R=[],V=A(I.style);JSON.stringify(k.styleObj)!==JSON.stringify(V)&&(k.styleObj=V,L.setStyle(V.style),k.traceHash={},R.push(new Promise(function(O){L.once("styledata",O)}))),R=R.concat(p.fetchTraceGeoData(b)),Promise.all(R).then(function(){k.fillBelowLookup(b,_),k.updateData(b),k.updateLayout(_),k.resolveOnRender(S)}).catch(C)},T.fillBelowLookup=function(b,_){var S,C,k=_[this.id].layers,L=this.belowLookup={},I=!1;for(S=0;S<b.length;S++){var R=b[S][0].trace,V=R._module;typeof R.below=="string"?C=R.below:V.getBelow&&(C=V.getBelow(R,this)),C===""&&(I=!0),L["trace-"+R.uid]=C||""}for(S=0;S<k.length;S++){var O=k[S];C=typeof O.below=="string"?O.below:I?"traces":"",L["layout-"+S]=C}var J,D,B={};for(J in L)B[C=L[J]]?B[C].push(J):B[C]=[J];for(C in B){var N=B[C];if(N.length>1)for(S=0;S<N.length;S++)(J=N[S]).indexOf("trace-")===0?(D=J.split("trace-")[1],this.traceHash[D]&&(this.traceHash[D].below=null)):J.indexOf("layout-")===0&&(D=J.split("layout-")[1],this.layerList[D]&&(this.layerList[D].below=null))}};var w={choroplethmapbox:0,densitymapbox:1,scattermapbox:2};function A(b){var _={};return h.isPlainObject(b)?(_.id=b.id,_.style=b):typeof b=="string"?(_.id=b,m.styleValuesMapbox.indexOf(b)!==-1?_.style=E(b):m.stylesNonMapbox[b]?_.style=m.stylesNonMapbox[b]:_.style=b):(_.id=m.styleValueDflt,_.style=E(m.styleValueDflt)),_.transition={duration:0,delay:0},_}function E(b){return m.styleUrlPrefix+b+"-"+m.styleUrlSuffix}function M(b){return[b.lon,b.lat]}T.updateData=function(b){var _,S,C,k,L=this.traceHash,I=b.slice().sort(function(D,B){return w[D[0].trace.type]-w[B[0].trace.type]});for(C=0;C<I.length;C++){var R=I[C],V=!1;(_=L[(S=R[0].trace).uid])&&(_.type===S.type?(_.update(R),V=!0):_.dispose()),!V&&S._module&&(L[S.uid]=S._module.plot(this,R))}var O=Object.keys(L);e:for(C=0;C<O.length;C++){var J=O[C];for(k=0;k<b.length;k++)if(J===(S=b[k][0].trace).uid)continue e;(_=L[J]).dispose(),delete L[J]}},T.updateLayout=function(b){var _=this.map,S=b[this.id];this.dragging||this.wheeling||(_.setCenter(M(S.center)),_.setZoom(S.zoom),_.setBearing(S.bearing),_.setPitch(S.pitch)),this.updateLayers(b),this.updateFramework(b),this.updateFx(b),this.map.resize(),this.gd._context._scrollZoom.mapbox?_.scrollZoom.enable():_.scrollZoom.disable()},T.resolveOnRender=function(b){var _=this.map;_.on("render",function S(){_.loaded()&&(_.off("render",S),setTimeout(b,10))})},T.rejectOnError=function(b){var _=this.map;function S(){b(new Error(m.mapOnErrorMsg))}_.once("error",S),_.once("style.error",S),_.once("source.error",S),_.once("tile.error",S),_.once("layer.error",S)},T.createFramework=function(b){var _=this,S=_.div=document.createElement("div");S.id=_.uid,S.style.position="absolute",_.container.appendChild(S),_.xaxis={_id:"x",c2p:function(C){return _.project(C).x}},_.yaxis={_id:"y",c2p:function(C){return _.project(C).y}},_.updateFramework(b),_.mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},e.setConvert(_.mockAxis,b)},T.initFx=function(b,_){var S=this,C=S.gd,k=S.map;function L(){r.loneUnhover(_._hoverlayer)}function I(){var R=S.getView();C.emit("plotly_relayouting",S.getViewEditsWithDerived(R))}k.on("moveend",function(R){if(S.map){var V=C._fullLayout;if(R.originalEvent||S.wheeling){var O=V[S.id];l.call("_storeDirectGUIEdit",C.layout,V._preGUI,S.getViewEdits(O));var J=S.getView();O._input.center=O.center=J.center,O._input.zoom=O.zoom=J.zoom,O._input.bearing=O.bearing=J.bearing,O._input.pitch=O.pitch=J.pitch,C.emit("plotly_relayout",S.getViewEditsWithDerived(J))}R.originalEvent&&R.originalEvent.type==="mouseup"?S.dragging=!1:S.wheeling&&(S.wheeling=!1),V._rehover&&V._rehover()}}),k.on("wheel",function(){S.wheeling=!0}),k.on("mousemove",function(R){var V=S.div.getBoundingClientRect(),O=[R.originalEvent.offsetX,R.originalEvent.offsetY];R.target.getBoundingClientRect=function(){return V},S.xaxis.p2c=function(){return k.unproject(O).lng},S.yaxis.p2c=function(){return k.unproject(O).lat},C._fullLayout._rehover=function(){C._fullLayout._hoversubplot===S.id&&C._fullLayout[S.id]&&r.hover(C,R,S.id)},r.hover(C,R,S.id),C._fullLayout._hoversubplot=S.id}),k.on("dragstart",function(){S.dragging=!0,L()}),k.on("zoomstart",L),k.on("mouseout",function(){C._fullLayout._hoversubplot=null}),k.on("drag",I),k.on("zoom",I),k.on("dblclick",function(){var R=C._fullLayout[S.id];l.call("_storeDirectGUIEdit",C.layout,C._fullLayout._preGUI,S.getViewEdits(R));var V=S.viewInitial;k.setCenter(M(V.center)),k.setZoom(V.zoom),k.setBearing(V.bearing),k.setPitch(V.pitch);var O=S.getView();R._input.center=R.center=O.center,R._input.zoom=R.zoom=O.zoom,R._input.bearing=R.bearing=O.bearing,R._input.pitch=R.pitch=O.pitch,C.emit("plotly_doubleclick",null),C.emit("plotly_relayout",S.getViewEditsWithDerived(O))}),S.clearSelect=function(){g(S.dragOptions),f(S.dragOptions.gd)},S.onClickInPanFn=function(R){return function(V){var O=C._fullLayout.clickmode;O.indexOf("select")>-1&&d(V.originalEvent,C,[S.xaxis],[S.yaxis],S.id,R),O.indexOf("event")>-1&&r.click(C,V.originalEvent)}}},T.updateFx=function(b){var _=this,S=_.map,C=_.gd;if(!_.isStatic){var k,L=b.dragmode;k=u(L)?function(V,O){(V.range={})[_.id]=[R([O.xmin,O.ymin]),R([O.xmax,O.ymax])]}:function(V,O,J){(V.lassoPoints={})[_.id]=J.filtered.map(R)};var I=_.dragOptions;_.dragOptions=h.extendDeep(I||{},{dragmode:b.dragmode,element:_.div,gd:C,plotinfo:{id:_.id,domain:b[_.id].domain,xaxis:_.xaxis,yaxis:_.yaxis,fillRangeItems:k},xaxes:[_.xaxis],yaxes:[_.yaxis],subplot:_.id}),S.off("click",_.onClickInPanHandler),a(L)||s(L)?(S.dragPan.disable(),S.on("zoomstart",_.clearSelect),_.dragOptions.prepFn=function(V,O,J){c(V,O,J,_.dragOptions,L)},o.init(_.dragOptions)):(S.dragPan.enable(),S.off("zoomstart",_.clearSelect),_.div.onmousedown=null,_.onClickInPanHandler=_.onClickInPanFn(_.dragOptions),S.on("click",_.onClickInPanHandler))}function R(V){var O=_.map.unproject(V);return[O.lng,O.lat]}},T.updateFramework=function(b){var _=b[this.id].domain,S=b._size,C=this.div.style;C.width=S.w*(_.x[1]-_.x[0])+"px",C.height=S.h*(_.y[1]-_.y[0])+"px",C.left=S.l+_.x[0]*S.w+"px",C.top=S.t+(1-_.y[1])*S.h+"px",this.xaxis._offset=S.l+_.x[0]*S.w,this.xaxis._length=S.w*(_.x[1]-_.x[0]),this.yaxis._offset=S.t+(1-_.y[1])*S.h,this.yaxis._length=S.h*(_.y[1]-_.y[0])},T.updateLayers=function(b){var _,S=b[this.id].layers,C=this.layerList;if(S.length!==C.length){for(_=0;_<C.length;_++)C[_].dispose();for(C=this.layerList=[],_=0;_<S.length;_++)C.push(y(this,_,S[_]))}else for(_=0;_<S.length;_++)C[_].update(S[_])},T.destroy=function(){this.map&&(this.map.remove(),this.map=null,this.container.removeChild(this.div))},T.toImage=function(){return this.map.stop(),this.map.getCanvas().toDataURL()},T.setOptions=function(b,_,S){for(var C in S)this.map[_](b,C,S[C])},T.getMapLayers=function(){return this.map.getStyle().layers},T.addLayer=function(b,_){var S=this.map;if(typeof _=="string"){if(_==="")return void S.addLayer(b,_);for(var C=this.getMapLayers(),k=0;k<C.length;k++)if(_===C[k].id)return void S.addLayer(b,_);h.warn(["Trying to add layer with *below* value",_,"referencing a layer that does not exist","or that does not yet exist."].join(" "))}S.addLayer(b)},T.project=function(b){return this.map.project(new t.LngLat(b[0],b[1]))},T.getView=function(){var b=this.map,_=b.getCenter(),S={lon:_.lng,lat:_.lat},C=b.getCanvas(),k=C.width,L=C.height;return{center:S,zoom:b.getZoom(),bearing:b.getBearing(),pitch:b.getPitch(),_derived:{coordinates:[b.unproject([0,0]).toArray(),b.unproject([k,0]).toArray(),b.unproject([k,L]).toArray(),b.unproject([0,L]).toArray()]}}},T.getViewEdits=function(b){for(var _=this.id,S=["center","zoom","bearing","pitch"],C={},k=0;k<S.length;k++){var L=S[k];C[_+"."+L]=b[L]}return C},T.getViewEditsWithDerived=function(b){var _=this.id,S=this.getViewEdits(b);return S[_+"._derived"]=b._derived,S},z.exports=v},{"../../components/dragelement":662,"../../components/dragelement/helpers":661,"../../components/fx":683,"../../lib":778,"../../lib/geo_location_utils":771,"../../registry":911,"../cartesian/axes":828,"../cartesian/select":847,"./constants":883,"./layers":886,"mapbox-gl":473}],890:[function(n,z,q){"use strict";z.exports=function(t){var h=t.editType;return{t:{valType:"number",dflt:0,editType:h},r:{valType:"number",dflt:0,editType:h},b:{valType:"number",dflt:0,editType:h},l:{valType:"number",dflt:0,editType:h},editType:h}}},{}],891:[function(n,z,q){"use strict";var t=n("d3"),h=n("d3-time-format").timeFormatLocale,p=n("fast-isnumeric"),l=n("../registry"),e=n("../plot_api/plot_schema"),o=n("../plot_api/plot_template"),r=n("../lib"),i=n("../components/color"),u=n("../constants/numerical").BADNUM,s=n("./cartesian/axis_ids"),a=n("./cartesian/handle_outline").clearSelect,c=n("./animation_attributes"),f=n("./frame_attributes"),g=n("../plots/get_data").getModuleCalcData,d=r.relinkPrivateKeys,m=r._,y=z.exports={};r.extendFlat(y,l),y.attributes=n("./attributes"),y.attributes.type.values=y.allTypes,y.fontAttrs=n("./font_attributes"),y.layoutAttributes=n("./layout_attributes"),y.fontWeight="normal";var v=y.transformsRegistry,T=n("./command");y.executeAPICommand=T.executeAPICommand,y.computeAPICommandBindings=T.computeAPICommandBindings,y.manageCommandObserver=T.manageCommandObserver,y.hasSimpleAPICommandBindings=T.hasSimpleAPICommandBindings,y.redrawText=function(O){var J=(O=r.getGraphDiv(O))._fullLayout||{};if(!(!(J._has&&J._has("polar"))&&O.data&&O.data[0]&&O.data[0].r))return new Promise(function(D){setTimeout(function(){l.getComponentMethod("annotations","draw")(O),l.getComponentMethod("legend","draw")(O),l.getComponentMethod("colorbar","draw")(O),D(y.previousPromises(O))},300)})},y.resize=function(O){var J;O=r.getGraphDiv(O);var D=new Promise(function(B,N){O&&!r.isHidden(O)||N(new Error("Resize must be passed a displayed plot div element.")),O._redrawTimer&&clearTimeout(O._redrawTimer),O._resolveResize&&(J=O._resolveResize),O._resolveResize=B,O._redrawTimer=setTimeout(function(){if(!O.layout||O.layout.width&&O.layout.height||r.isHidden(O))B(O);else{delete O.layout.width,delete O.layout.height;var F=O.changed;O.autoplay=!0,l.call("relayout",O,{autosize:!0}).then(function(){O.changed=F,O._resolveResize===B&&(delete O._resolveResize,B(O))})}},100)});return J&&J(D),D},y.previousPromises=function(O){if((O._promises||[]).length)return Promise.all(O._promises).then(function(){O._promises=[]})},y.addLinks=function(O){if(O._context.showLink||O._context.showSources){var J=O._fullLayout,D=r.ensureSingle(J._paper,"text","js-plot-link-container",function(G){G.style({"font-family":'"Open Sans", Arial, sans-serif',"font-size":"12px",fill:i.defaultLine,"pointer-events":"all"}).each(function(){var W=t.select(this);W.append("tspan").classed("js-link-to-tool",!0),W.append("tspan").classed("js-link-spacer",!0),W.append("tspan").classed("js-sourcelinks",!0)})}),B=D.node(),N={y:J._paper.attr("height")-9};document.body.contains(B)&&B.getComputedTextLength()>=J.width-20?(N["text-anchor"]="start",N.x=5):(N["text-anchor"]="end",N.x=J._paper.attr("width")-7),D.attr(N);var F=D.select(".js-link-to-tool"),H=D.select(".js-link-spacer"),j=D.select(".js-sourcelinks");O._context.showSources&&O._context.showSources(O),O._context.showLink&&function(G,W){W.text("");var Q=W.append("a").attr({"xlink:xlink:href":"#",class:"link--impt link--embedview","font-weight":"bold"}).text(G._context.linkText+" "+String.fromCharCode(187));if(G._context.sendData)Q.on("click",function(){y.sendDataToCloud(G)});else{var $=window.location.pathname.split("/"),ee=window.location.search;Q.attr({"xlink:xlink:show":"new","xlink:xlink:href":"/"+$[2].split(".")[0]+"/"+$[1]+ee})}}(O,F),H.text(F.text()&&j.text()?" - ":"")}},y.sendDataToCloud=function(O){var J=(window.PLOTLYENV||{}).BASE_URL||O._context.plotlyServerURL;if(J){O.emit("plotly_beforeexport");var D=t.select(O).append("div").attr("id","hiddenform").style("display","none"),B=D.append("form").attr({action:J+"/external",method:"post",target:"_blank"});return B.append("input").attr({type:"text",name:"data"}).node().value=y.graphJson(O,!1,"keepdata"),B.node().submit(),D.remove(),O.emit("plotly_afterexport"),!1}};var w=["days","shortDays","months","shortMonths","periods","dateTime","date","time","decimal","thousands","grouping","currency"],A=["year","month","dayMonth","dayMonthYear"];function E(O,J){var D=O._context.locale;D||(D="en-US");var B=!1,N={};function F($){for(var ee=!0,ie=0;ie<J.length;ie++){var ae=J[ie];N[ae]||($[ae]?N[ae]=$[ae]:ee=!1)}ee&&(B=!0)}for(var H=0;H<2;H++){for(var j=O._context.locales,G=0;G<2;G++){var W=(j[D]||{}).format;if(W&&(F(W),B))break;j=l.localeRegistry}var Q=D.split("-")[0];if(B||Q===D)break;D=Q}return B||F(l.localeRegistry.en.format),N}function M(O,J){var D={_fullLayout:J},B=O._id.charAt(0)==="x",N=O._mainAxis._anchorAxis,F="",H="",j="";if(N&&(j=N._mainAxis._id,F=B?O._id+j:j+O._id),!F||!J._plots[F]){F="";for(var G=O._counterAxes,W=0;W<G.length;W++){var Q=G[W],$=B?O._id+Q:Q+O._id;H||(H=$);var ee=s.getFromId(D,Q);if(j&&ee.overlaying===j){F=$;break}}}return F||H}function b(O){var J=O.transforms;if(Array.isArray(J)&&J.length)for(var D=0;D<J.length;D++){var B=J[D],N=B._module||v[B.type];if(N&&N.makesData)return!0}return!1}function _(O,J,D,B){for(var N=O.transforms,F=[O],H=0;H<N.length;H++){var j=N[H],G=v[j.type];G&&G.transform&&(F=G.transform(F,{transform:j,fullTrace:O,fullData:J,layout:D,fullLayout:B,transformIndex:H}))}return F}function S(O){return typeof O=="string"&&O.substr(O.length-2)==="px"&&parseFloat(O)}function C(O){var J=O.margin;if(!O._size){var D=O._size={l:Math.round(J.l),r:Math.round(J.r),t:Math.round(J.t),b:Math.round(J.b),p:Math.round(J.pad)};D.w=Math.round(O.width)-D.l-D.r,D.h=Math.round(O.height)-D.t-D.b}O._pushmargin||(O._pushmargin={}),O._pushmarginIds||(O._pushmarginIds={})}y.supplyDefaults=function(O,J){var D=J&&J.skipUpdateCalc,B=O._fullLayout||{};if(B._skipDefaults)delete B._skipDefaults;else{var N,F=O._fullLayout={},H=O.layout||{},j=O._fullData||[],G=O._fullData=[],W=O.data||[],Q=O.calcdata||[],$=O._context||{};O._transitionData||y.createTransitionData(O),F._dfltTitle={plot:m(O,"Click to enter Plot title"),x:m(O,"Click to enter X axis title"),y:m(O,"Click to enter Y axis title"),colorbar:m(O,"Click to enter Colorscale title"),annotation:m(O,"new text")},F._traceWord=m(O,"trace");var ee=E(O,w);if(F._mapboxAccessToken=$.mapboxAccessToken,B._initialAutoSizeIsDone){var ie=B.width,ae=B.height;y.supplyLayoutGlobalDefaults(H,F,ee),H.width||(F.width=ie),H.height||(F.height=ae),y.sanitizeMargins(F)}else{y.supplyLayoutGlobalDefaults(H,F,ee);var oe=!H.width||!H.height,de=F.autosize,le=$.autosizable;oe&&(de||le)?y.plotAutoSize(O,H,F):oe&&y.sanitizeMargins(F),!de&&oe&&(H.width=F.width,H.height=F.height)}F._d3locale=function(Re,Ze){return Re.decimal=Ze.charAt(0),Re.thousands=Ze.charAt(1),{numberFormat:t.locale(Re).numberFormat,timeFormat:h(Re).utcFormat}}(ee,F.separators),F._extraFormat=E(O,A),F._initialAutoSizeIsDone=!0,F._dataLength=W.length,F._modules=[],F._visibleModules=[],F._basePlotModules=[];var fe=F._subplots=function(){var Re,Ze,Ke=l.collectableSubplotTypes,$e={};if(!Ke){Ke=[];var rt=l.subplotsRegistry;for(var at in rt){var lt=rt[at].attr;if(lt&&(Ke.push(at),Array.isArray(lt)))for(Ze=0;Ze<lt.length;Ze++)r.pushUnique(Ke,lt[Ze])}}for(Re=0;Re<Ke.length;Re++)$e[Ke[Re]]=[];return $e}(),ue=F._splomAxes={x:{},y:{}},we=F._splomSubplots={};F._splomGridDflt={},F._scatterStackOpts={},F._firstScatter={},F._alignmentOpts={},F._colorAxes={},F._requestRangeslider={},F._traceUids=function(Re,Ze){var Ke,$e,rt=Ze.length,at=[];for(Ke=0;Ke<Re.length;Ke++){var lt=Re[Ke]._fullInput;lt!==$e&&at.push(lt),$e=lt}var gt=at.length,Ie=new Array(rt),be={};function We(ot,Ce){Ie[Ce]=ot,be[ot]=1}function Ge(ot,Ce){if(ot&&typeof ot=="string"&&!be[ot])return We(ot,Ce),!0}for(Ke=0;Ke<rt;Ke++){var st=Ze[Ke].uid;typeof st=="number"&&(st=String(st)),Ge(st,Ke)||Ke<gt&&Ge(at[Ke].uid,Ke)||We(r.randstr(be),Ke)}return Ie}(j,W),F._globalTransforms=(O._context||{}).globalTransforms,y.supplyDataDefaults(W,G,H,F);var Ae=Object.keys(ue.x),Se=Object.keys(ue.y);if(Ae.length>1&&Se.length>1){for(l.getComponentMethod("grid","sizeDefaults")(H,F),N=0;N<Ae.length;N++)r.pushUnique(fe.xaxis,Ae[N]);for(N=0;N<Se.length;N++)r.pushUnique(fe.yaxis,Se[N]);for(var ke in we)r.pushUnique(fe.cartesian,ke)}if(F._has=y._hasPlotType.bind(F),j.length===G.length)for(N=0;N<G.length;N++)d(G[N],j[N]);y.supplyLayoutModuleDefaults(H,F,G,O._transitionData);var Me=F._visibleModules,ve=[];for(N=0;N<Me.length;N++){var ge=Me[N].crossTraceDefaults;ge&&r.pushUnique(ve,ge)}for(N=0;N<ve.length;N++)ve[N](G,F);F._hasOnlyLargeSploms=F._basePlotModules.length===1&&F._basePlotModules[0].name==="splom"&&Ae.length>15&&Se.length>15&&F.shapes.length===0&&F.images.length===0,F._hasCartesian=F._has("cartesian"),F._hasGeo=F._has("geo"),F._hasGL3D=F._has("gl3d"),F._hasGL2D=F._has("gl2d"),F._hasTernary=F._has("ternary"),F._hasPie=F._has("pie"),y.linkSubplots(G,F,j,B),y.cleanPlot(G,F,j,B);var De=!(!B._has||!B._has("gl2d")),_e=!(!F._has||!F._has("gl2d")),Pe=!(!B._has||!B._has("cartesian"))||De,Fe=!(!F._has||!F._has("cartesian"))||_e;Pe&&!Fe?B._bgLayer.remove():Fe&&!Pe&&(F._shouldCreateBgLayer=!0),B._zoomlayer&&!O._dragging&&a({_fullLayout:B}),function(Re,Ze){var Ke,$e=[];Ze.meta&&(Ke=Ze._meta={meta:Ze.meta,layout:{meta:Ze.meta}});for(var rt=0;rt<Re.length;rt++){var at=Re[rt];at.meta?$e[at.index]=at._meta={meta:at.meta}:Ze.meta&&(at._meta={meta:Ze.meta}),Ze.meta&&(at._meta.layout={meta:Ze.meta})}$e.length&&(Ke||(Ke=Ze._meta={}),Ke.data=$e)}(G,F),d(F,B),l.getComponentMethod("colorscale","crossTraceDefaults")(G,F),F._preGUI||(F._preGUI={}),F._tracePreGUI||(F._tracePreGUI={});var ze,He=F._tracePreGUI,et={};for(ze in He)et[ze]="old";for(N=0;N<G.length;N++)et[ze=G[N]._fullInput.uid]||(He[ze]={}),et[ze]="new";for(ze in et)et[ze]==="old"&&delete He[ze];C(F),l.getComponentMethod("rangeslider","makeData")(F),D||Q.length!==G.length||y.supplyDefaultsUpdateCalc(Q,G)}},y.supplyDefaultsUpdateCalc=function(O,J){for(var D=0;D<J.length;D++){var B=J[D],N=(O[D]||[])[0];if(N&&N.trace){var F=N.trace;if(F._hasCalcTransform){var H,j,G,W=F._arrayAttrs;for(H=0;H<W.length;H++)j=W[H],G=r.nestedProperty(F,j).get().slice(),r.nestedProperty(B,j).set(G)}N.trace=B}}},y.createTransitionData=function(O){O._transitionData||(O._transitionData={}),O._transitionData._frames||(O._transitionData._frames=[]),O._transitionData._frameHash||(O._transitionData._frameHash={}),O._transitionData._counter||(O._transitionData._counter=0),O._transitionData._interruptCallbacks||(O._transitionData._interruptCallbacks=[])},y._hasPlotType=function(O){var J,D=this._basePlotModules||[];for(J=0;J<D.length;J++)if(D[J].name===O)return!0;var B=this._modules||[];for(J=0;J<B.length;J++){var N=B[J].name;if(N===O)return!0;var F=l.modules[N];if(F&&F.categories[O])return!0}return!1},y.cleanPlot=function(O,J,D,B){var N,F,H=B._basePlotModules||[];for(N=0;N<H.length;N++){var j=H[N];j.clean&&j.clean(O,J,D,B)}var G=B._has&&B._has("gl"),W=J._has&&J._has("gl");G&&!W&&B._glcontainer!==void 0&&(B._glcontainer.selectAll(".gl-canvas").remove(),B._glcontainer.selectAll(".no-webgl").remove(),B._glcanvas=null);var Q=!!B._infolayer;e:for(N=0;N<D.length;N++){var $=D[N].uid;for(F=0;F<O.length;F++)if($===O[F].uid)continue e;Q&&B._infolayer.select(".cb"+$).remove()}},y.linkSubplots=function(O,J,D,B){var N,F,H=B._plots||{},j=J._plots={},G=J._subplots,W={_fullData:O,_fullLayout:J},Q=G.cartesian.concat(G.gl2d||[]);for(N=0;N<Q.length;N++){var $,ee=Q[N],ie=H[ee],ae=s.getFromId(W,ee,"x"),oe=s.getFromId(W,ee,"y");for(ie?$=j[ee]=ie:($=j[ee]={}).id=ee,ae._counterAxes.push(oe._id),oe._counterAxes.push(ae._id),ae._subplotsWith.push(ee),oe._subplotsWith.push(ee),$.xaxis=ae,$.yaxis=oe,$._hasClipOnAxisFalse=!1,F=0;F<O.length;F++){var de=O[F];if(de.xaxis===$.xaxis._id&&de.yaxis===$.yaxis._id&&de.cliponaxis===!1){$._hasClipOnAxisFalse=!0;break}}}var le,fe=s.list(W,null,!0);for(N=0;N<fe.length;N++){var ue=null;(le=fe[N]).overlaying&&(ue=s.getFromId(W,le.overlaying))&&ue.overlaying&&(le.overlaying=!1,ue=null),le._mainAxis=ue||le,ue&&(le.domain=ue.domain.slice()),le._anchorAxis=le.anchor==="free"?null:s.getFromId(W,le.anchor)}for(N=0;N<fe.length;N++)if((le=fe[N])._counterAxes.sort(s.idSort),le._subplotsWith.sort(r.subplotSort),le._mainSubplot=M(le,J),le._counterAxes.length&&(le.spikemode&&le.spikemode.indexOf("across")!==-1||le.automargin&&le.mirror&&le.anchor!=="free"||l.getComponentMethod("rangeslider","isVisible")(le))){var we=1,Ae=0;for(F=0;F<le._counterAxes.length;F++){var Se=s.getFromId(W,le._counterAxes[F]);we=Math.min(we,Se.domain[0]),Ae=Math.max(Ae,Se.domain[1])}we<Ae&&(le._counterDomainMin=we,le._counterDomainMax=Ae)}},y.clearExpandedTraceDefaultColors=function(O){var J,D,B;for(D=[],(J=O._module._colorAttrs)||(O._module._colorAttrs=J=[],e.crawl(O._module.attributes,function(N,F,H,j){D[j]=F,D.length=j+1,N.valType==="color"&&N.dflt===void 0&&J.push(D.join("."))})),B=0;B<J.length;B++)r.nestedProperty(O,"_input."+J[B]).get()||r.nestedProperty(O,J[B]).set(null)},y.supplyDataDefaults=function(O,J,D,B){var N,F,H,j=B._modules,G=B._visibleModules,W=B._basePlotModules,Q=0,$=0;function ee(ke){J.push(ke);var Me=ke._module;Me&&(r.pushUnique(j,Me),ke.visible===!0&&r.pushUnique(G,Me),r.pushUnique(W,ke._module.basePlotModule),Q++,ke._input.visible!==!1&&$++)}B._transformModules=[];var ie={},ae=[],oe=(D.template||{}).data||{},de=o.traceTemplater(oe);for(N=0;N<O.length;N++){if(H=O[N],(F=de.newTrace(H)).uid=B._traceUids[N],y.supplyTraceDefaults(H,F,$,B,N),F.index=N,F._input=H,F._expandedIndex=Q,F.transforms&&F.transforms.length)for(var le=H.visible!==!1&&F.visible===!1,fe=_(F,J,D,B),ue=0;ue<fe.length;ue++){var we=fe[ue],Ae={_template:F._template,type:F.type,uid:F.uid+ue};le&&we.visible===!1&&delete we.visible,y.supplyTraceDefaults(we,Ae,Q,B,N),d(Ae,we),Ae.index=N,Ae._input=H,Ae._fullInput=F,Ae._expandedIndex=Q,Ae._expandedInput=we,ee(Ae)}else F._fullInput=F,F._expandedInput=F,ee(F);l.traceIs(F,"carpetAxis")&&(ie[F.carpet]=F),l.traceIs(F,"carpetDependent")&&ae.push(N)}for(N=0;N<ae.length;N++)if((F=J[ae[N]]).visible){var Se=ie[F.carpet];F._carpet=Se,Se&&Se.visible?(F.xaxis=Se.xaxis,F.yaxis=Se.yaxis):F.visible=!1}},y.supplyAnimationDefaults=function(O){var J;O=O||{};var D={};function B(N,F){return r.coerce(O||{},D,c,N,F)}if(B("mode"),B("direction"),B("fromcurrent"),Array.isArray(O.frame))for(D.frame=[],J=0;J<O.frame.length;J++)D.frame[J]=y.supplyAnimationFrameDefaults(O.frame[J]||{});else D.frame=y.supplyAnimationFrameDefaults(O.frame||{});if(Array.isArray(O.transition))for(D.transition=[],J=0;J<O.transition.length;J++)D.transition[J]=y.supplyAnimationTransitionDefaults(O.transition[J]||{});else D.transition=y.supplyAnimationTransitionDefaults(O.transition||{});return D},y.supplyAnimationFrameDefaults=function(O){var J={};function D(B,N){return r.coerce(O||{},J,c.frame,B,N)}return D("duration"),D("redraw"),J},y.supplyAnimationTransitionDefaults=function(O){var J={};function D(B,N){return r.coerce(O||{},J,c.transition,B,N)}return D("duration"),D("easing"),J},y.supplyFrameDefaults=function(O){var J={};function D(B,N){return r.coerce(O,J,f,B,N)}return D("group"),D("name"),D("traces"),D("baseframe"),D("data"),D("layout"),J},y.supplyTraceDefaults=function(O,J,D,B,N){var F,H=B.colorway||i.defaults,j=H[D%H.length];function G(fe,ue){return r.coerce(O,J,y.attributes,fe,ue)}var W=G("visible");G("type"),G("name",B._traceWord+" "+N),G("uirevision",B.uirevision);var Q=y.getModule(J);if(J._module=Q,Q){var $=Q.basePlotModule,ee=$.attr,ie=$.attributes;if(ee&&ie){var ae=B._subplots,oe="";if(W||$.name!=="gl2d"){if(Array.isArray(ee))for(F=0;F<ee.length;F++){var de=ee[F],le=r.coerce(O,J,ie,de);ae[de]&&r.pushUnique(ae[de],le),oe+=le}else oe=r.coerce(O,J,ie,ee);ae[$.name]&&r.pushUnique(ae[$.name],oe)}}}return W&&(G("customdata"),G("ids"),G("meta"),l.traceIs(J,"showLegend")?(r.coerce(O,J,Q.attributes.showlegend?Q.attributes:y.attributes,"showlegend"),G("legendgroup"),J._dfltShowLegend=!0):J._dfltShowLegend=!1,Q&&Q.supplyDefaults(O,J,j,B),l.traceIs(J,"noOpacity")||G("opacity"),l.traceIs(J,"notLegendIsolatable")&&(J.visible=!!J.visible),l.traceIs(J,"noHover")||(J.hovertemplate||r.coerceHoverinfo(O,J,B),J.type!=="parcats"&&l.getComponentMethod("fx","supplyDefaults")(O,J,j,B)),Q&&Q.selectPoints&&G("selectedpoints"),y.supplyTransformDefaults(O,J,B)),J},y.hasMakesDataTransform=b,y.supplyTransformDefaults=function(O,J,D){if(J._length||b(O)){var B=D._globalTransforms||[],N=D._transformModules||[];if(Array.isArray(O.transforms)||B.length!==0)for(var F=O.transforms||[],H=B.concat(F),j=J.transforms=[],G=0;G<H.length;G++){var W,Q=H[G],$=Q.type,ee=v[$],ie=!(Q._module&&Q._module===ee),ae=ee&&typeof ee.transform=="function";ee||r.warn("Unrecognized transform type "+$+"."),ee&&ee.supplyDefaults&&(ie||ae)?((W=ee.supplyDefaults(Q,J,D,O)).type=$,W._module=ee,r.pushUnique(N,ee)):W=r.extendFlat({},Q),j.push(W)}}},y.supplyLayoutGlobalDefaults=function(O,J,D){function B(G,W){return r.coerce(O,J,y.layoutAttributes,G,W)}var N=O.template;r.isPlainObject(N)&&(J.template=N,J._template=N.layout,J._dataTemplate=N.data),B("autotypenumbers");var F=r.coerceFont(B,"font");B("title.text",J._dfltTitle.plot),r.coerceFont(B,"title.font",{family:F.family,size:Math.round(1.4*F.size),color:F.color}),B("title.xref"),B("title.yref"),B("title.x"),B("title.y"),B("title.xanchor"),B("title.yanchor"),B("title.pad.t"),B("title.pad.r"),B("title.pad.b"),B("title.pad.l"),B("uniformtext.mode")&&B("uniformtext.minsize"),B("autosize",!(O.width&&O.height)),B("width"),B("height"),B("margin.l"),B("margin.r"),B("margin.t"),B("margin.b"),B("margin.pad"),B("margin.autoexpand"),O.width&&O.height&&y.sanitizeMargins(J),l.getComponentMethod("grid","sizeDefaults")(O,J),B("paper_bgcolor"),B("separators",D.decimal+D.thousands),B("hidesources"),B("colorway"),B("datarevision");var H=B("uirevision");B("editrevision",H),B("selectionrevision",H),B("modebar.orientation"),B("modebar.bgcolor",i.addOpacity(J.paper_bgcolor,.5));var j=i.contrast(i.rgb(J.modebar.bgcolor));B("modebar.color",i.addOpacity(j,.3)),B("modebar.activecolor",i.addOpacity(j,.7)),B("modebar.uirevision",H),l.getComponentMethod("shapes","supplyDrawNewShapeDefaults")(O,J,B),B("meta"),r.isPlainObject(O.transition)&&(B("transition.duration"),B("transition.easing"),B("transition.ordering")),l.getComponentMethod("calendars","handleDefaults")(O,J,"calendar"),l.getComponentMethod("fx","supplyLayoutGlobalDefaults")(O,J,B)},y.plotAutoSize=function(O,J,D){var B,N,F=O._context||{},H=F.frameMargins,j=r.isPlotDiv(O);if(j&&O.emit("plotly_autosize"),F.fillFrame)B=window.innerWidth,N=window.innerHeight,document.body.style.overflow="hidden";else{var G=j?window.getComputedStyle(O):{};if(B=S(G.width)||S(G.maxWidth)||D.width,N=S(G.height)||S(G.maxHeight)||D.height,p(H)&&H>0){var W=1-2*H;B=Math.round(W*B),N=Math.round(W*N)}}var Q=y.layoutAttributes.width.min,$=y.layoutAttributes.height.min;B<Q&&(B=Q),N<$&&(N=$);var ee=!J.width&&Math.abs(D.width-B)>1,ie=!J.height&&Math.abs(D.height-N)>1;(ie||ee)&&(ee&&(D.width=B),ie&&(D.height=N)),O._initialAutoSize||(O._initialAutoSize={width:B,height:N}),y.sanitizeMargins(D)},y.supplyLayoutModuleDefaults=function(O,J,D,B){var N,F,H,j=l.componentsRegistry,G=J._basePlotModules,W=l.subplotsRegistry.cartesian;for(N in j)(H=j[N]).includeBasePlot&&H.includeBasePlot(O,J);for(var Q in G.length||G.push(W),J._has("cartesian")&&(l.getComponentMethod("grid","contentDefaults")(O,J),W.finalizeSubplots(O,J)),J._subplots)J._subplots[Q].sort(r.subplotSort);for(F=0;F<G.length;F++)(H=G[F]).supplyLayoutDefaults&&H.supplyLayoutDefaults(O,J,D);var $=J._modules;for(F=0;F<$.length;F++)(H=$[F]).supplyLayoutDefaults&&H.supplyLayoutDefaults(O,J,D);var ee=J._transformModules;for(F=0;F<ee.length;F++)(H=ee[F]).supplyLayoutDefaults&&H.supplyLayoutDefaults(O,J,D,B);for(N in j)(H=j[N]).supplyLayoutDefaults&&H.supplyLayoutDefaults(O,J,D)},y.purge=function(O){var J=O._fullLayout||{};J._glcontainer!==void 0&&(J._glcontainer.selectAll(".gl-canvas").remove(),J._glcontainer.remove(),J._glcanvas=null),J._modeBar&&J._modeBar.destroy(),O._transitionData&&(O._transitionData._interruptCallbacks&&(O._transitionData._interruptCallbacks.length=0),O._transitionData._animationRaf&&window.cancelAnimationFrame(O._transitionData._animationRaf)),r.clearThrottle(),r.clearResponsive(O),delete O.data,delete O.layout,delete O._fullData,delete O._fullLayout,delete O.calcdata,delete O.framework,delete O.empty,delete O.fid,delete O.undoqueue,delete O.undonum,delete O.autoplay,delete O.changed,delete O._promises,delete O._redrawTimer,delete O._hmlumcount,delete O._hmpixcount,delete O._transitionData,delete O._transitioning,delete O._initialAutoSize,delete O._transitioningWithDuration,delete O._dragging,delete O._dragged,delete O._dragdata,delete O._hoverdata,delete O._snapshotInProgress,delete O._editing,delete O._mouseDownTime,delete O._legendMouseDownTime,O.removeAllListeners&&O.removeAllListeners()},y.style=function(O){var J,D=O._fullLayout._visibleModules,B=[];for(J=0;J<D.length;J++){var N=D[J];N.style&&r.pushUnique(B,N.style)}for(J=0;J<B.length;J++)B[J](O)},y.sanitizeMargins=function(O){if(O&&O.margin){var J,D=O.width,B=O.height,N=O.margin,F=D-(N.l+N.r),H=B-(N.t+N.b);F<0&&(J=(D-1)/(N.l+N.r),N.l=Math.floor(J*N.l),N.r=Math.floor(J*N.r)),H<0&&(J=(B-1)/(N.t+N.b),N.t=Math.floor(J*N.t),N.b=Math.floor(J*N.b))}},y.clearAutoMarginIds=function(O){O._fullLayout._pushmarginIds={}},y.allowAutoMargin=function(O,J){O._fullLayout._pushmarginIds[J]=1},y.autoMargin=function(O,J,D){var B=O._fullLayout,N=B.width,F=B.height,H=B.margin,j=r.constrain(N-H.l-H.r,2,64),G=r.constrain(F-H.t-H.b,2,64),W=Math.max(0,N-j),Q=Math.max(0,F-G),$=B._pushmargin,ee=B._pushmarginIds;if(H.autoexpand!==!1){if(D){var ie=D.pad;if(ie===void 0&&(ie=Math.min(12,H.l,H.r,H.t,H.b)),W){var ae=(D.l+D.r)/W;ae>1&&(D.l/=ae,D.r/=ae)}if(Q){var oe=(D.t+D.b)/Q;oe>1&&(D.t/=oe,D.b/=oe)}var de=D.xl!==void 0?D.xl:D.x,le=D.xr!==void 0?D.xr:D.x,fe=D.yt!==void 0?D.yt:D.y,ue=D.yb!==void 0?D.yb:D.y;$[J]={l:{val:de,size:D.l+ie},r:{val:le,size:D.r+ie},b:{val:ue,size:D.b+ie},t:{val:fe,size:D.t+ie}},ee[J]=1}else delete $[J],delete ee[J];if(!B._replotting)return y.doAutoMargin(O)}},y.doAutoMargin=function(O){var J=O._fullLayout,D=J.width,B=J.height;J._size||(J._size={}),C(J);var N=J._size,F=J.margin,H=r.extendFlat({},N),j=F.l,G=F.r,W=F.t,Q=F.b,$=J._pushmargin,ee=J._pushmarginIds;if(J.margin.autoexpand!==!1){for(var ie in $)ee[ie]||delete $[ie];for(var ae in $.base={l:{val:0,size:j},r:{val:1,size:G},t:{val:1,size:W},b:{val:0,size:Q}},$){var oe=$[ae].l||{},de=$[ae].b||{},le=oe.val,fe=oe.size,ue=de.val,we=de.size;for(var Ae in $){if(p(fe)&&$[Ae].r){var Se=$[Ae].r.val,ke=$[Ae].r.size;if(Se>le){var Me=(fe*Se+(ke-D)*le)/(Se-le),ve=(ke*(1-le)+(fe-D)*(1-Se))/(Se-le);Me+ve>j+G&&(j=Me,G=ve)}}if(p(we)&&$[Ae].t){var ge=$[Ae].t.val,De=$[Ae].t.size;if(ge>ue){var _e=(we*ge+(De-B)*ue)/(ge-ue),Pe=(De*(1-ue)+(we-B)*(1-ge))/(ge-ue);_e+Pe>Q+W&&(Q=_e,W=Pe)}}}}}var Fe=r.constrain(D-F.l-F.r,2,64),ze=r.constrain(B-F.t-F.b,2,64),He=Math.max(0,D-Fe),et=Math.max(0,B-ze);if(He){var Re=(j+G)/He;Re>1&&(j/=Re,G/=Re)}if(et){var Ze=(Q+W)/et;Ze>1&&(Q/=Ze,W/=Ze)}if(N.l=Math.round(j),N.r=Math.round(G),N.t=Math.round(W),N.b=Math.round(Q),N.p=Math.round(F.pad),N.w=Math.round(D)-N.l-N.r,N.h=Math.round(B)-N.t-N.b,!J._replotting&&y.didMarginChange(H,N)){"_redrawFromAutoMarginCount"in J?J._redrawFromAutoMarginCount++:J._redrawFromAutoMarginCount=1;var Ke=3*(1+Object.keys(ee).length);if(J._redrawFromAutoMarginCount<Ke)return l.call("plot",O);J._size=H,r.warn("Too many auto-margin redraws.")}(function($e){for(var rt=s.list($e,"",!0),at=0;at<rt.length;at++){var lt=rt[at]._hideOutOfRangeInsideTickLabels;lt&&lt()}})(O)};var k=["l","r","t","b","p","w","h"];function L(O,J,D){var B=!1,N=[y.previousPromises,function(){if(O._transitionData)return O._transitioning=!1,function(H){var j=Promise.resolve();if(!H)return j;for(;H.length;)j=j.then(H.shift());return j}(O._transitionData._interruptCallbacks)},D.prepareFn,y.rehover,function(){return O.emit("plotly_transitioning",[]),new Promise(function(H){O._transitioning=!0,J.duration>0&&(O._transitioningWithDuration=!0),O._transitionData._interruptCallbacks.push(function(){B=!0}),D.redraw&&O._transitionData._interruptCallbacks.push(function(){return l.call("redraw",O)}),O._transitionData._interruptCallbacks.push(function(){O.emit("plotly_transitioninterrupted",[])});var j=0,G=0;function W(){return j++,function(){G++,B||G!==j||function(Q){O._transitionData&&(function($){if($)for(;$.length;)$.shift()}(O._transitionData._interruptCallbacks),Promise.resolve().then(function(){if(D.redraw)return l.call("redraw",O)}).then(function(){O._transitioning=!1,O._transitioningWithDuration=!1,O.emit("plotly_transitioned",[])}).then(Q))}(H)}}D.runFn(W),setTimeout(W())})}],F=r.syncOrAsync(N,O);return F&&F.then||(F=Promise.resolve()),F.then(function(){return O})}y.didMarginChange=function(O,J){for(var D=0;D<k.length;D++){var B=k[D],N=O[B],F=J[B];if(!p(N)||Math.abs(F-N)>1)return!0}return!1},y.graphJson=function(O,J,D,B,N,F){(N&&J&&!O._fullData||N&&!J&&!O._fullLayout)&&y.supplyDefaults(O);var H=N?O._fullData:O.data,j=N?O._fullLayout:O.layout,G=(O._transitionData||{})._frames;function W(ee,ie){if(typeof ee=="function")return ie?"_function_":null;if(r.isPlainObject(ee)){var ae,oe={};return Object.keys(ee).sort().forEach(function(de){if(["_","["].indexOf(de.charAt(0))===-1)if(typeof ee[de]!="function"){if(D==="keepdata"){if(de.substr(de.length-3)==="src")return}else if(D==="keepstream"){if(typeof(ae=ee[de+"src"])=="string"&&ae.indexOf(":")>0&&!r.isPlainObject(ee.stream))return}else if(D!=="keepall"&&typeof(ae=ee[de+"src"])=="string"&&ae.indexOf(":")>0)return;oe[de]=W(ee[de],ie)}else ie&&(oe[de]="_function")}),oe}return Array.isArray(ee)?ee.map(function(de){return W(de,ie)}):r.isTypedArray(ee)?r.simpleMap(ee,r.identity):r.isJSDate(ee)?r.ms2DateTimeLocal(+ee):ee}var Q={data:(H||[]).map(function(ee){var ie=W(ee);return J&&delete ie.fit,ie})};if(!J&&(Q.layout=W(j),N)){var $=j._size;Q.layout.computed={margin:{b:$.b,l:$.l,r:$.r,t:$.t}}}return O.framework&&O.framework.isPolar&&(Q=O.framework.getConfig()),G&&(Q.frames=W(G)),F&&(Q.config=W(O._context,!0)),B==="object"?Q:JSON.stringify(Q)},y.modifyFrames=function(O,J){var D,B,N,F=O._transitionData._frames,H=O._transitionData._frameHash;for(D=0;D<J.length;D++)switch((B=J[D]).type){case"replace":N=B.value;var j=(F[B.index]||{}).name,G=N.name;F[B.index]=H[G]=N,G!==j&&(delete H[j],H[G]=N);break;case"insert":H[(N=B.value).name]=N,F.splice(B.index,0,N);break;case"delete":delete H[(N=F[B.index]).name],F.splice(B.index,1)}return Promise.resolve()},y.computeFrame=function(O,J){var D,B,N,F,H=O._transitionData._frameHash;if(!J)throw new Error("computeFrame must be given a string frame name");var j=H[J.toString()];if(!j)return!1;for(var G=[j],W=[j.name];j.baseframe&&(j=H[j.baseframe.toString()])&&W.indexOf(j.name)===-1;)G.push(j),W.push(j.name);for(var Q={};j=G.pop();)if(j.layout&&(Q.layout=y.extendLayout(Q.layout,j.layout)),j.data){if(Q.data||(Q.data=[]),!(B=j.traces))for(B=[],D=0;D<j.data.length;D++)B[D]=D;for(Q.traces||(Q.traces=[]),D=0;D<j.data.length;D++)(N=B[D])!=null&&((F=Q.traces.indexOf(N))===-1&&(F=Q.data.length,Q.traces[F]=N),Q.data[F]=y.extendTrace(Q.data[F],j.data[D]))}return Q},y.recomputeFrameHash=function(O){for(var J=O._transitionData._frameHash={},D=O._transitionData._frames,B=0;B<D.length;B++){var N=D[B];N&&N.name&&(J[N.name]=N)}},y.extendObjectWithContainers=function(O,J,D){var B,N,F,H,j,G,W,Q=r.extendDeepNoArrays({},J||{}),$=r.expandObjectPaths(Q),ee={};if(D&&D.length)for(F=0;F<D.length;F++)(N=(B=r.nestedProperty($,D[F])).get())===void 0?r.nestedProperty(ee,D[F]).set(null):(B.set(null),r.nestedProperty(ee,D[F]).set(N));if(O=r.extendDeepNoArrays(O||{},$),D&&D.length){for(F=0;F<D.length;F++)if(G=r.nestedProperty(ee,D[F]).get()){for(W=(j=r.nestedProperty(O,D[F])).get(),Array.isArray(W)||(W=[],j.set(W)),H=0;H<G.length;H++){var ie=G[H];W[H]=ie===null?null:y.extendObjectWithContainers(W[H],ie)}j.set(W)}}return O},y.dataArrayContainers=["transforms","dimensions"],y.layoutArrayContainers=l.layoutArrayContainers,y.extendTrace=function(O,J){return y.extendObjectWithContainers(O,J,y.dataArrayContainers)},y.extendLayout=function(O,J){return y.extendObjectWithContainers(O,J,y.layoutArrayContainers)},y.transition=function(O,J,D,B,N,F){var H={redraw:N.redraw},j={},G=[];return H.prepareFn=function(){for(var W=Array.isArray(J)?J.length:0,Q=B.slice(0,W),$=0;$<Q.length;$++){var ee=Q[$],ie=O._fullData[ee]._module;if(ie){if(ie.animatable){var ae=ie.basePlotModule.name;j[ae]||(j[ae]=[]),j[ae].push(ee)}O.data[Q[$]]=y.extendTrace(O.data[Q[$]],J[$])}}var oe=r.expandObjectPaths(r.extendDeepNoArrays({},D)),de=/^[xy]axis[0-9]*$/;for(var le in oe)de.test(le)&&delete oe[le].range;y.extendLayout(O.layout,oe),delete O.calcdata,y.supplyDefaults(O),y.doCalcdata(O);var fe=r.expandObjectPaths(D);if(fe){var ue=O._fullLayout._plots;for(var we in ue){var Ae=ue[we],Se=Ae.xaxis,ke=Ae.yaxis,Me=Se.range.slice(),ve=ke.range.slice(),ge=null,De=null,_e=null,Pe=null;Array.isArray(fe[Se._name+".range"])?ge=fe[Se._name+".range"].slice():Array.isArray((fe[Se._name]||{}).range)&&(ge=fe[Se._name].range.slice()),Array.isArray(fe[ke._name+".range"])?De=fe[ke._name+".range"].slice():Array.isArray((fe[ke._name]||{}).range)&&(De=fe[ke._name].range.slice()),Me&&ge&&(Se.r2l(Me[0])!==Se.r2l(ge[0])||Se.r2l(Me[1])!==Se.r2l(ge[1]))&&(_e={xr0:Me,xr1:ge}),ve&&De&&(ke.r2l(ve[0])!==ke.r2l(De[0])||ke.r2l(ve[1])!==ke.r2l(De[1]))&&(Pe={yr0:ve,yr1:De}),(_e||Pe)&&G.push(r.extendFlat({plotinfo:Ae},_e,Pe))}}return Promise.resolve()},H.runFn=function(W){var Q,$,ee=O._fullLayout._basePlotModules,ie=G.length;if(D)for($=0;$<ee.length;$++)ee[$].transitionAxes&&ee[$].transitionAxes(O,G,F,W);for(var ae in ie?((Q=r.extendFlat({},F)).duration=0,delete j.cartesian):Q=F,j){var oe=j[ae];O._fullData[oe[0]]._module.basePlotModule.plot(O,oe,Q,W)}},L(O,F,H)},y.transitionFromReact=function(O,J,D,B){var N=O._fullLayout,F=N.transition,H={},j=[];return H.prepareFn=function(){var G=N._plots;for(var W in H.redraw=!1,J.anim==="some"&&(H.redraw=!0),D.anim==="some"&&(H.redraw=!0),G){var Q=G[W],$=Q.xaxis,ee=Q.yaxis,ie=B[$._name].range.slice(),ae=B[ee._name].range.slice(),oe=$.range.slice(),de=ee.range.slice();$.setScale(),ee.setScale();var le=null,fe=null;$.r2l(ie[0])===$.r2l(oe[0])&&$.r2l(ie[1])===$.r2l(oe[1])||(le={xr0:ie,xr1:oe}),ee.r2l(ae[0])===ee.r2l(de[0])&&ee.r2l(ae[1])===ee.r2l(de[1])||(fe={yr0:ae,yr1:de}),(le||fe)&&j.push(r.extendFlat({plotinfo:Q},le,fe))}return Promise.resolve()},H.runFn=function(G){for(var W,Q,$,ee=O._fullData,ie=O._fullLayout._basePlotModules,ae=[],oe=0;oe<ee.length;oe++)ae.push(oe);function de(){for(var fe=0;fe<ie.length;fe++)ie[fe].transitionAxes&&ie[fe].transitionAxes(O,j,W,G)}function le(){for(var fe=0;fe<ie.length;fe++)ie[fe].plot(O,$,Q,G)}j.length&&J.anim?F.ordering==="traces first"?(W=r.extendFlat({},F,{duration:0}),$=ae,Q=F,setTimeout(de,F.duration),le()):(W=F,$=null,Q=r.extendFlat({},F,{duration:0}),setTimeout(le,W.duration),de()):j.length?(W=F,de()):J.anim&&($=ae,Q=F,le())},L(O,F,H)},y.doCalcdata=function(O,J){var D,B,N,F,H=s.list(O),j=O._fullData,G=O._fullLayout,W=new Array(j.length),Q=(O.calcdata||[]).slice();for(O.calcdata=W,G._numBoxes=0,G._numViolins=0,G._violinScaleGroupStats={},O._hmpixcount=0,O._hmlumcount=0,G._piecolormap={},G._sunburstcolormap={},G._treemapcolormap={},G._funnelareacolormap={},N=0;N<j.length;N++)Array.isArray(J)&&J.indexOf(N)===-1&&(W[N]=Q[N]);for(N=0;N<j.length;N++)(D=j[N])._arrayAttrs=e.findArrayAttributes(D),D._extremes={};var $=G._subplots.polar||[];for(N=0;N<$.length;N++)H.push(G[$[N]].radialaxis,G[$[N]].angularaxis);for(var ee in G._colorAxes){var ie=G[ee];ie.cauto!==!1&&(delete ie.cmin,delete ie.cmax)}var ae=!1;function oe(fe){if(D=j[fe],B=D._module,D.visible===!0&&D.transforms){if(B&&B.calc){var ue=B.calc(O,D);ue[0]&&ue[0].t&&ue[0].t._scene&&delete ue[0].t._scene.dirty}for(F=0;F<D.transforms.length;F++){var we=D.transforms[F];(B=v[we.type])&&B.calcTransform&&(D._hasCalcTransform=!0,ae=!0,B.calcTransform(O,D,we))}}}function de(fe,ue){if(D=j[fe],!!(B=D._module).isContainer===ue){var we=[];if(D.visible===!0&&D._length!==0){delete D._indexToPoints;var Ae=D.transforms||[];for(F=Ae.length-1;F>=0;F--)if(Ae[F].enabled){D._indexToPoints=Ae[F]._indexToPoints;break}B&&B.calc&&(we=B.calc(O,D))}Array.isArray(we)&&we[0]||(we=[{x:u,y:u}]),we[0].t||(we[0].t={}),we[0].trace=D,W[fe]=we}}for(R(H,j,G),N=0;N<j.length;N++)de(N,!0);for(N=0;N<j.length;N++)oe(N);for(ae&&R(H,j,G),N=0;N<j.length;N++)de(N,!0);for(N=0;N<j.length;N++)de(N,!1);V(O);var le=function(fe,ue){var we,Ae,Se,ke,Me,ve=[];function ge(Ye,xe,Ee){var Je=xe._id.charAt(0);if(Ye==="histogram2dcontour"){var it=xe._counterAxes[0],ht=s.getFromId(ue,it),ct=Je==="x"||it==="x"&&ht.type==="category",mt=Je==="y"||it==="y"&&ht.type==="category";return function(bt,Et){return bt===0||Et===0||ct&&bt===Ee[Et].length-1||mt&&Et===Ee.length-1?-1:(Je==="y"?Et:bt)-1}}return function(bt,Et){return Je==="y"?Et:bt}}var De={min:function(Ye){return r.aggNums(Math.min,null,Ye)},max:function(Ye){return r.aggNums(Math.max,null,Ye)},sum:function(Ye){return r.aggNums(function(xe,Ee){return xe+Ee},null,Ye)},total:function(Ye){return r.aggNums(function(xe,Ee){return xe+Ee},null,Ye)},mean:function(Ye){return r.mean(Ye)},median:function(Ye){return r.median(Ye)}};for(we=0;we<fe.length;we++){var _e=fe[we];if(_e.type==="category"){var Pe=_e.categoryorder.match(I);if(Pe){var Fe=Pe[1],ze=Pe[2],He=_e._id.charAt(0),et=He==="x",Re=[];for(Ae=0;Ae<_e._categories.length;Ae++)Re.push([_e._categories[Ae],[]]);for(Ae=0;Ae<_e._traceIndices.length;Ae++){var Ze=_e._traceIndices[Ae],Ke=ue._fullData[Ze];if(Ke.visible===!0){var $e=Ke.type;l.traceIs(Ke,"histogram")&&(delete Ke._xautoBinFinished,delete Ke._yautoBinFinished);var rt=$e==="splom",at=$e==="scattergl",lt=ue.calcdata[Ze];for(Se=0;Se<lt.length;Se++){var gt,Ie,be=lt[Se];if(rt){var We=Ke._axesDim[_e._id];if(!et){var Ge=Ke._diag[We][0];Ge&&(_e=ue._fullLayout[s.id2name(Ge)])}var st=be.trace.dimensions[We].values;for(ke=0;ke<st.length;ke++)for(gt=_e._categoriesMap[st[ke]],Me=0;Me<be.trace.dimensions.length;Me++)if(Me!==We){var ot=be.trace.dimensions[Me];Re[gt][1].push(ot.values[ke])}}else if(at){for(ke=0;ke<be.t.x.length;ke++)et?(gt=be.t.x[ke],Ie=be.t.y[ke]):(gt=be.t.y[ke],Ie=be.t.x[ke]),Re[gt][1].push(Ie);be.t&&be.t._scene&&delete be.t._scene.dirty}else if(be.hasOwnProperty("z")){Ie=be.z;var Ce=ge(Ke.type,_e,Ie);for(ke=0;ke<Ie.length;ke++)for(Me=0;Me<Ie[ke].length;Me++)(gt=Ce(Me,ke))+1&&Re[gt][1].push(Ie[ke][Me])}else for((gt=be.p)===void 0&&(gt=be[He]),(Ie=be.s)===void 0&&(Ie=be.v),Ie===void 0&&(Ie=et?be.y:be.x),Array.isArray(Ie)||(Ie=Ie===void 0?[]:[Ie]),ke=0;ke<Ie.length;ke++)Re[gt][1].push(Ie[ke])}}}_e._categoriesValue=Re;var Ue=[];for(Ae=0;Ae<Re.length;Ae++)Ue.push([Re[Ae][0],De[Fe](Re[Ae][1])]);Ue.sort(function(Ye,xe){return Ye[1]-xe[1]}),_e._categoriesAggregatedValue=Ue,_e._initialCategories=Ue.map(function(Ye){return Ye[0]}),ze==="descending"&&_e._initialCategories.reverse(),ve=ve.concat(_e.sortByInitialCategories())}}}return ve}(H,O);if(le.length){for(G._numBoxes=0,G._numViolins=0,N=0;N<le.length;N++)de(le[N],!0);for(N=0;N<le.length;N++)de(le[N],!1);V(O)}l.getComponentMethod("fx","calc")(O),l.getComponentMethod("errorbars","calc")(O)};var I=/(total|sum|min|max|mean|median) (ascending|descending)/;function R(O,J,D){var B={};function N(G){G.clearCalc(),G.type==="multicategory"&&G.setupMultiCategory(J),B[G._id]=1}r.simpleMap(O,N);for(var F=D._axisMatchGroups||[],H=0;H<F.length;H++)for(var j in F[H])B[j]||N(D[s.id2name(j)])}function V(O){var J,D,B,N=O._fullLayout,F=N._visibleModules,H={};for(D=0;D<F.length;D++){var j=F[D],G=j.crossTraceCalc;if(G){var W=j.basePlotModule.name;H[W]?r.pushUnique(H[W],G):H[W]=[G]}}for(B in H){var Q=H[B],$=N._subplots[B];if(Array.isArray($))for(J=0;J<$.length;J++){var ee=$[J],ie=B==="cartesian"?N._plots[ee]:N[ee];for(D=0;D<Q.length;D++)Q[D](O,ie,ee)}else for(D=0;D<Q.length;D++)Q[D](O)}}y.rehover=function(O){O._fullLayout._rehover&&O._fullLayout._rehover()},y.redrag=function(O){O._fullLayout._redrag&&O._fullLayout._redrag()},y.generalUpdatePerTraceModule=function(O,J,D,B){var N,F=J.traceHash,H={};for(N=0;N<D.length;N++){var j=D[N],G=j[0].trace;G.visible&&(H[G.type]=H[G.type]||[],H[G.type].push(j))}for(var W in F)if(!H[W]){var Q=F[W][0];Q[0].trace.visible=!1,H[W]=[Q]}for(var $ in H){var ee=H[$];ee[0][0].trace._module.plot(O,J,r.filterVisible(ee),B)}J.traceHash=H},y.plotBasePlot=function(O,J,D,B,N){var F=l.getModule(O),H=g(J.calcdata,F)[0];F.plot(J,H,B,N)},y.cleanBasePlot=function(O,J,D,B,N){var F=N._has&&N._has(O),H=D._has&&D._has(O);F&&!H&&N["_"+O+"layer"].selectAll("g.trace").remove()}},{"../components/color":643,"../constants/numerical":753,"../lib":778,"../plot_api/plot_schema":816,"../plot_api/plot_template":817,"../plots/get_data":865,"../registry":911,"./animation_attributes":822,"./attributes":824,"./cartesian/axis_ids":831,"./cartesian/handle_outline":838,"./command":854,"./font_attributes":856,"./frame_attributes":857,"./layout_attributes":882,d3:169,"d3-time-format":166,"fast-isnumeric":241}],892:[function(n,z,q){"use strict";z.exports={attr:"subplot",name:"polar",axisNames:["angularaxis","radialaxis"],axisName2dataArray:{angularaxis:"theta",radialaxis:"r"},layerNames:["draglayer","plotbg","backplot","angular-grid","radial-grid","frontplot","angular-line","radial-line","angular-axis","radial-axis"],radialDragBoxSize:50,angularDragBoxSize:30,cornerLen:25,cornerHalfWidth:2,MINDRAG:8,MINZOOM:20,OFFEDGE:20}},{}],893:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../../lib/polygon").tester,p=t.findIndexOfMin,l=t.isAngleInsideSector,e=t.angleDelta,o=t.angleDist;function r(a,c,f,g){var d,m,y=g[0],v=g[1],T=u(Math.sin(c)-Math.sin(a)),w=u(Math.cos(c)-Math.cos(a)),A=Math.tan(f),E=u(1/A),M=T/w,b=v-M*y;return E?T&&w?m=A*(d=b/(A-M)):w?(d=v*E,m=v):(d=y,m=y*A):T&&w?(d=0,m=b):w?(d=0,m=v):d=m=NaN,[d,m]}function i(a,c,f,g){return t.isFullCircle([c,f])?function(d,m){var y,v=m.length,T=new Array(v+1);for(y=0;y<v;y++){var w=m[y];T[y]=[d*Math.cos(w),d*Math.sin(w)]}return T[y]=T[0].slice(),T}(a,g):function(d,m,y,v){var T,w,A=v.length,E=[];function M(V){return[d*Math.cos(V),d*Math.sin(V)]}function b(V,O,J){return r(V,O,J,M(V))}function _(V){return t.mod(V,A)}function S(V){return l(V,[m,y])}var C=p(v,function(V){return S(V)?o(V,m):1/0}),k=b(v[C],v[_(C-1)],m);for(E.push(k),T=C,w=0;w<A;T++,w++){var L=v[_(T)];if(!S(L))break;E.push(M(L))}var I=p(v,function(V){return S(V)?o(V,y):1/0}),R=b(v[I],v[_(I+1)],y);return E.push(R),E.push([0,0]),E.push(E[0].slice()),E}(a,c,f,g)}function u(a){return Math.abs(a)>1e-10?a:0}function s(a,c,f){c=c||0,f=f||0;for(var g=a.length,d=new Array(g),m=0;m<g;m++){var y=a[m];d[m]=[c+y[0],f-y[1]]}return d}z.exports={isPtInsidePolygon:function(a,c,f,g,d){if(!l(c,g))return!1;var m,y;f[0]<f[1]?(m=f[0],y=f[1]):(m=f[1],y=f[0]);var v=h(i(m,g[0],g[1],d)),T=h(i(y,g[0],g[1],d)),w=[a*Math.cos(c),a*Math.sin(c)];return T.contains(w)&&!v.contains(w)},findPolygonOffset:function(a,c,f,g){for(var d=1/0,m=1/0,y=i(a,c,f,g),v=0;v<y.length;v++){var T=y[v];d=Math.min(d,T[0]),m=Math.min(m,-T[1])}return[d,m]},findEnclosingVertexAngles:function(a,c){var f=p(c,function(d){var m=e(d,a);return m>0?m:1/0}),g=t.mod(f+1,c.length);return[c[f],c[g]]},findIntersectionXY:r,findXYatLength:function(a,c,f,g){var d=-c*f,m=c*c+1,y=2*(c*d-f),v=d*d+f*f-a*a,T=Math.sqrt(y*y-4*m*v),w=(-y+T)/(2*m),A=(-y-T)/(2*m);return[[w,c*w+d+g],[A,c*A+d+g]]},clampTiny:u,pathPolygon:function(a,c,f,g,d,m){return"M"+s(i(a,c,f,g),d,m).join("L")},pathPolygonAnnulus:function(a,c,f,g,d,m,y){var v,T;a<c?(v=a,T=c):(v=c,T=a);var w=s(i(v,f,g,d),m,y);return"M"+s(i(T,f,g,d),m,y).reverse().join("L")+"M"+w.join("L")}}},{"../../lib":778,"../../lib/polygon":790}],894:[function(n,z,q){"use strict";var t=n("../get_data").getSubplotCalcData,h=n("../../lib").counterRegex,p=n("./polar"),l=n("./constants"),e=l.attr,o=l.name,r=h(o),i={};i[e]={valType:"subplotid",dflt:o,editType:"calc"},z.exports={attr:e,name:o,idRoot:o,idRegex:r,attrRegex:r,attributes:i,layoutAttributes:n("./layout_attributes"),supplyLayoutDefaults:n("./layout_defaults"),plot:function(u){for(var s=u._fullLayout,a=u.calcdata,c=s._subplots[o],f=0;f<c.length;f++){var g=c[f],d=t(a,o,g),m=s[g]._subplot;m||(m=p(u,g),s[g]._subplot=m),m.plot(d,s,u._promises)}},clean:function(u,s,a,c){for(var f=c._subplots[o]||[],g=c._has&&c._has("gl"),d=s._has&&s._has("gl"),m=g&&!d,y=0;y<f.length;y++){var v=f[y],T=c[v]._subplot;if(!s[v]&&T)for(var w in T.framework.remove(),T.layers["radial-axis-title"].remove(),T.clipPaths)T.clipPaths[w].remove();m&&T._scene&&(T._scene.destroy(),T._scene=null)}},toSVG:n("../cartesian").toSVG}},{"../../lib":778,"../cartesian":841,"../get_data":865,"./constants":892,"./layout_attributes":895,"./layout_defaults":896,"./polar":903}],895:[function(n,z,q){"use strict";var t=n("../../components/color/attributes"),h=n("../cartesian/layout_attributes"),p=n("../domain").attributes,l=n("../../lib").extendFlat,e=n("../../plot_api/edit_types").overrideAll,o=e({color:h.color,showline:l({},h.showline,{dflt:!0}),linecolor:h.linecolor,linewidth:h.linewidth,showgrid:l({},h.showgrid,{dflt:!0}),gridcolor:h.gridcolor,gridwidth:h.gridwidth},"plot","from-root"),r=e({tickmode:h.tickmode,nticks:h.nticks,tick0:h.tick0,dtick:h.dtick,tickvals:h.tickvals,ticktext:h.ticktext,ticks:h.ticks,ticklen:h.ticklen,tickwidth:h.tickwidth,tickcolor:h.tickcolor,showticklabels:h.showticklabels,showtickprefix:h.showtickprefix,tickprefix:h.tickprefix,showticksuffix:h.showticksuffix,ticksuffix:h.ticksuffix,showexponent:h.showexponent,exponentformat:h.exponentformat,minexponent:h.minexponent,separatethousands:h.separatethousands,tickfont:h.tickfont,tickangle:h.tickangle,tickformat:h.tickformat,tickformatstops:h.tickformatstops,layer:h.layer},"plot","from-root"),i={visible:l({},h.visible,{dflt:!0}),type:l({},h.type,{values:["-","linear","log","date","category"]}),autotypenumbers:h.autotypenumbers,autorange:l({},h.autorange,{editType:"plot"}),rangemode:{valType:"enumerated",values:["tozero","nonnegative","normal"],dflt:"tozero",editType:"calc"},range:l({},h.range,{items:[{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}}],editType:"plot"}),categoryorder:h.categoryorder,categoryarray:h.categoryarray,angle:{valType:"angle",editType:"plot"},side:{valType:"enumerated",values:["clockwise","counterclockwise"],dflt:"clockwise",editType:"plot"},title:{text:l({},h.title.text,{editType:"plot",dflt:""}),font:l({},h.title.font,{editType:"plot"}),editType:"plot"},hoverformat:h.hoverformat,uirevision:{valType:"any",editType:"none"},editType:"calc",_deprecated:{title:h._deprecated.title,titlefont:h._deprecated.titlefont}};l(i,o,r);var u={visible:l({},h.visible,{dflt:!0}),type:{valType:"enumerated",values:["-","linear","category"],dflt:"-",editType:"calc",_noTemplating:!0},autotypenumbers:h.autotypenumbers,categoryorder:h.categoryorder,categoryarray:h.categoryarray,thetaunit:{valType:"enumerated",values:["radians","degrees"],dflt:"degrees",editType:"calc"},period:{valType:"number",editType:"calc",min:0},direction:{valType:"enumerated",values:["counterclockwise","clockwise"],dflt:"counterclockwise",editType:"calc"},rotation:{valType:"angle",editType:"calc"},hoverformat:h.hoverformat,uirevision:{valType:"any",editType:"none"},editType:"calc"};l(u,o,r),z.exports={domain:p({name:"polar",editType:"plot"}),sector:{valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],dflt:[0,360],editType:"plot"},hole:{valType:"number",min:0,max:1,dflt:0,editType:"plot"},bgcolor:{valType:"color",editType:"plot",dflt:t.background},radialaxis:i,angularaxis:u,gridshape:{valType:"enumerated",values:["circular","linear"],dflt:"circular",editType:"plot"},uirevision:{valType:"any",editType:"none"},editType:"calc"}},{"../../components/color/attributes":642,"../../lib":778,"../../plot_api/edit_types":810,"../cartesian/layout_attributes":842,"../domain":855}],896:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../../components/color"),p=n("../../plot_api/plot_template"),l=n("../subplot_defaults"),e=n("../get_data").getSubplotData,o=n("../cartesian/tick_value_defaults"),r=n("../cartesian/tick_mark_defaults"),i=n("../cartesian/tick_label_defaults"),u=n("../cartesian/category_order_defaults"),s=n("../cartesian/line_grid_defaults"),a=n("../cartesian/axis_autotype"),c=n("./layout_attributes"),f=n("./set_convert"),g=n("./constants"),d=g.axisNames;function m(v,T,w,A){var E=w("bgcolor");A.bgColor=h.combine(E,A.paper_bgcolor);var M=w("sector");w("hole");var b,_=e(A.fullData,g.name,A.id),S=A.layoutOut;function C(H,j){return w(b+"."+H,j)}for(var k=0;k<d.length;k++){b=d[k],t.isPlainObject(v[b])||(v[b]={});var L=v[b],I=p.newContainer(T,b);I._id=I._name=b,I._attr=A.id+"."+b,I._traceIndices=_.map(function(H){return H._expandedIndex});var R=g.axisName2dataArray[b],V=y(L,I,C,_,R,A);u(L,I,C,{axData:_,dataAttr:R});var O,J,D=C("visible");switch(f(I,T,S),C("uirevision",T.uirevision),D&&(J=(O=C("color"))===L.color?O:A.font.color),I._m=1,b){case"radialaxis":var B=C("autorange",!I.isValidRange(L.range));L.autorange=B,!B||V!=="linear"&&V!=="-"||C("rangemode"),B==="reversed"&&(I._m=-1),C("range"),I.cleanRange("range",{dfltRange:[0,1]}),D&&(C("side"),C("angle",M[0]),C("title.text"),t.coerceFont(C,"title.font",{family:A.font.family,size:Math.round(1.2*A.font.size),color:J}));break;case"angularaxis":if(V==="date"){t.log("Polar plots do not support date angular axes yet.");for(var N=0;N<_.length;N++)_[N].visible=!1;V=L.type=I.type="linear"}C(V==="linear"?"thetaunit":"period");var F=C("direction");C("rotation",{counterclockwise:0,clockwise:90}[F])}D&&(o(L,I,C,I.type),i(L,I,C,I.type,{tickSuffixDflt:I.thetaunit==="degrees"?"\xB0":void 0}),r(L,I,C,{outerTicks:!0}),C("showticklabels")&&(t.coerceFont(C,"tickfont",{family:A.font.family,size:A.font.size,color:J}),C("tickangle"),C("tickformat")),s(L,I,C,{dfltColor:O,bgColor:A.bgColor,blend:60,showLine:!0,showGrid:!0,noZeroLine:!0,attributes:c[b]}),C("layer")),V!=="category"&&C("hoverformat"),I._input=L}T.angularaxis.type==="category"&&w("gridshape")}function y(v,T,w,A,E,M){var b=w("autotypenumbers",M.autotypenumbersDflt);if(w("type")==="-"){for(var _,S=0;S<A.length;S++)if(A[S].visible){_=A[S];break}_&&_[E]&&(T.type=a(_[E],"gregorian",{noMultiCategory:!0,autotypenumbers:b})),T.type==="-"?T.type="linear":v.type=T.type}return T.type}z.exports=function(v,T,w){l(v,T,w,{type:g.name,attributes:c,handleDefaults:m,font:T.font,autotypenumbersDflt:T.autotypenumbers,paper_bgcolor:T.paper_bgcolor,fullData:w,layoutOut:T})}},{"../../components/color":643,"../../lib":778,"../../plot_api/plot_template":817,"../cartesian/axis_autotype":829,"../cartesian/category_order_defaults":832,"../cartesian/line_grid_defaults":844,"../cartesian/tick_label_defaults":849,"../cartesian/tick_mark_defaults":850,"../cartesian/tick_value_defaults":851,"../get_data":865,"../subplot_defaults":905,"./constants":892,"./layout_attributes":895,"./set_convert":904}],897:[function(n,z,q){"use strict";var t=n("../../../traces/scatter/attributes"),h=t.marker,p=n("../../../lib/extend").extendFlat;["Area traces are deprecated!","Please switch to the *barpolar* trace type."].join(" "),z.exports={r:p({},t.r,{}),t:p({},t.t,{}),marker:{color:p({},h.color,{}),size:p({},h.size,{}),symbol:p({},h.symbol,{}),opacity:p({},h.opacity,{}),editType:"calc"}}},{"../../../lib/extend":768,"../../../traces/scatter/attributes":1187}],898:[function(n,z,q){"use strict";var t=n("../../cartesian/layout_attributes"),h=n("../../../lib/extend").extendFlat,p=n("../../../plot_api/edit_types").overrideAll,l=["Legacy polar charts are deprecated!","Please switch to *polar* subplots."].join(" "),e=h({},t.domain,{});function o(r,i){return h({},i,{showline:{valType:"boolean"},showticklabels:{valType:"boolean"},tickorientation:{valType:"enumerated",values:["horizontal","vertical"]},ticklen:{valType:"number",min:0},tickcolor:{valType:"color"},ticksuffix:{valType:"string"},endpadding:{valType:"number",description:l},visible:{valType:"boolean"}})}z.exports=p({radialaxis:o(0,{range:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},domain:e,orientation:{valType:"number"}}),angularaxis:o(0,{range:{valType:"info_array",items:[{valType:"number",dflt:0},{valType:"number",dflt:360}]},domain:e}),layout:{direction:{valType:"enumerated",values:["clockwise","counterclockwise"]},orientation:{valType:"angle"}}},"plot","nested")},{"../../../lib/extend":768,"../../../plot_api/edit_types":810,"../../cartesian/layout_attributes":842}],899:[function(n,z,q){"use strict";(z.exports=n("./micropolar")).manager=n("./micropolar_manager")},{"./micropolar":900,"./micropolar_manager":901}],900:[function(n,z,q){var t=n("d3"),h=n("../../../lib").extendDeepAll,p=n("../../../constants/alignment").MID_SHIFT,l=z.exports={version:"0.2.2"};l.Axis=function(){var e,o,r,i,u={data:[],layout:{}},s={},a={},c=t.dispatch("hover"),f={};return f.render=function(g){return function(d){o=d||o;var m=u.data,y=u.layout;(typeof o=="string"||o.nodeName)&&(o=t.select(o)),o.datum(m).each(function(v,T){var w=v.slice();a={data:l.util.cloneJson(w),layout:l.util.cloneJson(y)};var A=0;w.forEach(function(be,We){be.color||(be.color=y.defaultColorRange[A],A=(A+1)%y.defaultColorRange.length),be.strokeColor||(be.strokeColor=be.geometry==="LinePlot"?be.color:t.rgb(be.color).darker().toString()),a.data[We].color=be.color,a.data[We].strokeColor=be.strokeColor,a.data[We].strokeDash=be.strokeDash,a.data[We].strokeSize=be.strokeSize});var E=w.filter(function(be,We){var Ge=be.visible;return typeof Ge>"u"||Ge===!0}),M=!1,b=E.map(function(be,We){return M=M||typeof be.groupId<"u",be});if(M){var _=t.nest().key(function(be,We){return typeof be.groupId<"u"?be.groupId:"unstacked"}).entries(b),S=[],C=_.map(function(be,We){if(be.key==="unstacked")return be.values;var Ge=be.values[0].r.map(function(st,ot){return 0});return be.values.forEach(function(st,ot,Ce){st.yStack=[Ge],S.push(Ge),Ge=l.util.sumArrays(st.r,Ge)}),be.values});E=t.merge(C)}E.forEach(function(be,We){be.t=Array.isArray(be.t[0])?be.t:[be.t],be.r=Array.isArray(be.r[0])?be.r:[be.r]});var k=Math.min(y.width-y.margin.left-y.margin.right,y.height-y.margin.top-y.margin.bottom)/2;k=Math.max(10,k);var L,I=[y.margin.left+k,y.margin.top+k];M?L=[0,t.max(l.util.sumArrays(l.util.arrayLast(E).r[0],l.util.arrayLast(S)))]:L=t.extent(l.util.flattenArray(E.map(function(be,We){return be.r}))),y.radialAxis.domain!=l.DATAEXTENT&&(L[0]=0),r=t.scale.linear().domain(y.radialAxis.domain!=l.DATAEXTENT&&y.radialAxis.domain?y.radialAxis.domain:L).range([0,k]),a.layout.radialAxis.domain=r.domain();var R,V=l.util.flattenArray(E.map(function(be,We){return be.t})),O=typeof V[0]=="string";O&&(V=l.util.deduplicate(V),R=V.slice(),V=t.range(V.length),E=E.map(function(be,We){var Ge=be;return be.t=[V],M&&(Ge.yStack=be.yStack),Ge}));var J=E.filter(function(be,We){return be.geometry==="LinePlot"||be.geometry==="DotPlot"}).length===E.length,D=y.needsEndSpacing===null?O||!J:y.needsEndSpacing,B=y.angularAxis.domain&&y.angularAxis.domain!=l.DATAEXTENT&&!O&&y.angularAxis.domain[0]>=0?y.angularAxis.domain:t.extent(V),N=Math.abs(V[1]-V[0]);J&&!O&&(N=0);var F=B.slice();D&&O&&(F[1]+=N);var H=y.angularAxis.ticksCount||4;H>8&&(H=H/(H/8)+H%8),y.angularAxis.ticksStep&&(H=(F[1]-F[0])/H);var j=y.angularAxis.ticksStep||(F[1]-F[0])/(H*(y.minorTicks+1));R&&(j=Math.max(Math.round(j),1)),F[2]||(F[2]=j);var G=t.range.apply(this,F);if(G=G.map(function(be,We){return parseFloat(be.toPrecision(12))}),i=t.scale.linear().domain(F.slice(0,2)).range(y.direction==="clockwise"?[0,360]:[360,0]),a.layout.angularAxis.domain=i.domain(),a.layout.angularAxis.endPadding=D?N:0,typeof(e=t.select(this).select("svg.chart-root"))>"u"||e.empty()){var W=new DOMParser().parseFromString("<svg xmlns='http://www.w3.org/2000/svg' class='chart-root'>' + '<g class='outer-group'>' + '<g class='chart-group'>' + '<circle class='background-circle'></circle>' + '<g class='geometry-group'></g>' + '<g class='radial axis-group'>' + '<circle class='outside-circle'></circle>' + '</g>' + '<g class='angular axis-group'></g>' + '<g class='guides-group'><line></line><circle r='0'></circle></g>' + '</g>' + '<g class='legend-group'></g>' + '<g class='tooltips-group'></g>' + '<g class='title-group'><text></text></g>' + '</g>' + '</svg>","application/xml"),Q=this.appendChild(this.ownerDocument.importNode(W.documentElement,!0));e=t.select(Q)}e.select(".guides-group").style({"pointer-events":"none"}),e.select(".angular.axis-group").style({"pointer-events":"none"}),e.select(".radial.axis-group").style({"pointer-events":"none"});var $,ee=e.select(".chart-group"),ie={fill:"none",stroke:y.tickColor},ae={"font-size":y.font.size,"font-family":y.font.family,fill:y.font.color,"text-shadow":["-1px 0px","1px -1px","-1px 1px","1px 1px"].map(function(be,We){return" "+be+" 0 "+y.font.outlineColor}).join(",")};if(y.showLegend){$=e.select(".legend-group").attr({transform:"translate("+[k,y.margin.top]+")"}).style({display:"block"});var oe=E.map(function(be,We){var Ge=l.util.cloneJson(be);return Ge.symbol=be.geometry==="DotPlot"?be.dotType||"circle":be.geometry!="LinePlot"?"square":"line",Ge.visibleInLegend=typeof be.visibleInLegend>"u"||be.visibleInLegend,Ge.color=be.geometry==="LinePlot"?be.strokeColor:be.color,Ge});l.Legend().config({data:E.map(function(be,We){return be.name||"Element"+We}),legendConfig:h({},l.Legend.defaultConfig().legendConfig,{container:$,elements:oe,reverseOrder:y.legend.reverseOrder})})();var de=$.node().getBBox();k=Math.min(y.width-de.width-y.margin.left-y.margin.right,y.height-y.margin.top-y.margin.bottom)/2,k=Math.max(10,k),I=[y.margin.left+k,y.margin.top+k],r.range([0,k]),a.layout.radialAxis.domain=r.domain(),$.attr("transform","translate("+[I[0]+k,I[1]-k]+")")}else $=e.select(".legend-group").style({display:"none"});e.attr({width:y.width,height:y.height}).style({opacity:y.opacity}),ee.attr("transform","translate("+I+")").style({cursor:"crosshair"});var le=[(y.width-(y.margin.left+y.margin.right+2*k+(de?de.width:0)))/2,(y.height-(y.margin.top+y.margin.bottom+2*k))/2];if(le[0]=Math.max(0,le[0]),le[1]=Math.max(0,le[1]),e.select(".outer-group").attr("transform","translate("+le+")"),y.title&&y.title.text){var fe=e.select("g.title-group text").style(ae).text(y.title.text),ue=fe.node().getBBox();fe.attr({x:I[0]-ue.width/2,y:I[1]-k-20})}var we=e.select(".radial.axis-group");if(y.radialAxis.gridLinesVisible){var Ae=we.selectAll("circle.grid-circle").data(r.ticks(5));Ae.enter().append("circle").attr({class:"grid-circle"}).style(ie),Ae.attr("r",r),Ae.exit().remove()}we.select("circle.outside-circle").attr({r:k}).style(ie);var Se=e.select("circle.background-circle").attr({r:k}).style({fill:y.backgroundColor,stroke:y.stroke});function ke(be,We){return i(be)%360+y.orientation}if(y.radialAxis.visible){var Me=t.svg.axis().scale(r).ticks(5).tickSize(5);we.call(Me).attr({transform:"rotate("+y.radialAxis.orientation+")"}),we.selectAll(".domain").style(ie),we.selectAll("g>text").text(function(be,We){return this.textContent+y.radialAxis.ticksSuffix}).style(ae).style({"text-anchor":"start"}).attr({x:0,y:0,dx:0,dy:0,transform:function(be,We){return y.radialAxis.tickOrientation==="horizontal"?"rotate("+-y.radialAxis.orientation+") translate("+[0,ae["font-size"]]+")":"translate("+[0,ae["font-size"]]+")"}}),we.selectAll("g>line").style({stroke:"black"})}var ve=e.select(".angular.axis-group").selectAll("g.angular-tick").data(G),ge=ve.enter().append("g").classed("angular-tick",!0);ve.attr({transform:function(be,We){return"rotate("+ke(be)+")"}}).style({display:y.angularAxis.visible?"block":"none"}),ve.exit().remove(),ge.append("line").classed("grid-line",!0).classed("major",function(be,We){return We%(y.minorTicks+1)==0}).classed("minor",function(be,We){return We%(y.minorTicks+1)!=0}).style(ie),ge.selectAll(".minor").style({stroke:y.minorTickColor}),ve.select("line.grid-line").attr({x1:y.tickLength?k-y.tickLength:0,x2:k}).style({display:y.angularAxis.gridLinesVisible?"block":"none"}),ge.append("text").classed("axis-text",!0).style(ae);var De=ve.select("text.axis-text").attr({x:k+y.labelOffset,dy:p+"em",transform:function(be,We){var Ge=ke(be),st=k+y.labelOffset,ot=y.angularAxis.tickOrientation;return ot=="horizontal"?"rotate("+-Ge+" "+st+" 0)":ot=="radial"?Ge<270&&Ge>90?"rotate(180 "+st+" 0)":null:"rotate("+(Ge<=180&&Ge>0?-90:90)+" "+st+" 0)"}}).style({"text-anchor":"middle",display:y.angularAxis.labelsVisible?"block":"none"}).text(function(be,We){return We%(y.minorTicks+1)!=0?"":R?R[be]+y.angularAxis.ticksSuffix:be+y.angularAxis.ticksSuffix}).style(ae);y.angularAxis.rewriteTicks&&De.text(function(be,We){return We%(y.minorTicks+1)!=0?"":y.angularAxis.rewriteTicks(this.textContent,We)});var _e=t.max(ee.selectAll(".angular-tick text")[0].map(function(be,We){return be.getCTM().e+be.getBBox().width}));$.attr({transform:"translate("+[k+_e,y.margin.top]+")"});var Pe=e.select("g.geometry-group").selectAll("g").size()>0,Fe=e.select("g.geometry-group").selectAll("g.geometry").data(E);if(Fe.enter().append("g").attr({class:function(be,We){return"geometry geometry"+We}}),Fe.exit().remove(),E[0]||Pe){var ze=[];E.forEach(function(be,We){var Ge={};Ge.radialScale=r,Ge.angularScale=i,Ge.container=Fe.filter(function(st,ot){return ot==We}),Ge.geometry=be.geometry,Ge.orientation=y.orientation,Ge.direction=y.direction,Ge.index=We,ze.push({data:be,geometryConfig:Ge})});var He=t.nest().key(function(be,We){return typeof be.data.groupId<"u"||"unstacked"}).entries(ze),et=[];He.forEach(function(be,We){be.key==="unstacked"?et=et.concat(be.values.map(function(Ge,st){return[Ge]})):et.push(be.values)}),et.forEach(function(be,We){var Ge;Ge=Array.isArray(be)?be[0].geometryConfig.geometry:be.geometryConfig.geometry;var st=be.map(function(ot,Ce){return h(l[Ge].defaultConfig(),ot)});l[Ge]().config(st)()})}var Re,Ze,Ke=e.select(".guides-group"),$e=e.select(".tooltips-group"),rt=l.tooltipPanel().config({container:$e,fontSize:8})(),at=l.tooltipPanel().config({container:$e,fontSize:8})(),lt=l.tooltipPanel().config({container:$e,hasTick:!0})();if(!O){var gt=Ke.select("line").attr({x1:0,y1:0,y2:0}).style({stroke:"grey","pointer-events":"none"});ee.on("mousemove.angular-guide",function(be,We){var Ge=l.util.getMousePos(Se).angle;gt.attr({x2:-k,transform:"rotate("+Ge+")"}).style({opacity:.5});var st=(Ge+180+360-y.orientation)%360;Re=i.invert(st);var ot=l.util.convertToCartesian(k+12,Ge+180);rt.text(l.util.round(Re)).move([ot[0]+I[0],ot[1]+I[1]])}).on("mouseout.angular-guide",function(be,We){Ke.select("line").style({opacity:0})})}var Ie=Ke.select("circle").style({stroke:"grey",fill:"none"});ee.on("mousemove.radial-guide",function(be,We){var Ge=l.util.getMousePos(Se).radius;Ie.attr({r:Ge}).style({opacity:.5}),Ze=r.invert(l.util.getMousePos(Se).radius);var st=l.util.convertToCartesian(Ge,y.radialAxis.orientation);at.text(l.util.round(Ze)).move([st[0]+I[0],st[1]+I[1]])}).on("mouseout.radial-guide",function(be,We){Ie.style({opacity:0}),lt.hide(),rt.hide(),at.hide()}),e.selectAll(".geometry-group .mark").on("mouseover.tooltip",function(be,We){var Ge=t.select(this),st=this.style.fill,ot="black",Ce=this.style.opacity||1;if(Ge.attr({"data-opacity":Ce}),st&&st!=="none"){Ge.attr({"data-fill":st}),ot=t.hsl(st).darker().toString(),Ge.style({fill:ot,opacity:1});var Ue={t:l.util.round(be[0]),r:l.util.round(be[1])};O&&(Ue.t=R[be[0]]);var Ye="t: "+Ue.t+", r: "+Ue.r,xe=this.getBoundingClientRect(),Ee=e.node().getBoundingClientRect(),Je=[xe.left+xe.width/2-le[0]-Ee.left,xe.top+xe.height/2-le[1]-Ee.top];lt.config({color:ot}).text(Ye),lt.move(Je)}else st=this.style.stroke||"black",Ge.attr({"data-stroke":st}),ot=t.hsl(st).darker().toString(),Ge.style({stroke:ot,opacity:1})}).on("mousemove.tooltip",function(be,We){if(t.event.which!=0)return!1;t.select(this).attr("data-fill")&&lt.show()}).on("mouseout.tooltip",function(be,We){lt.hide();var Ge=t.select(this),st=Ge.attr("data-fill");st?Ge.style({fill:st,opacity:Ge.attr("data-opacity")}):Ge.style({stroke:Ge.attr("data-stroke"),opacity:Ge.attr("data-opacity")})})})}(g),this},f.config=function(g){if(!arguments.length)return u;var d=l.util.cloneJson(g);return d.data.forEach(function(m,y){u.data[y]||(u.data[y]={}),h(u.data[y],l.Axis.defaultConfig().data[0]),h(u.data[y],m)}),h(u.layout,l.Axis.defaultConfig().layout),h(u.layout,d.layout),this},f.getLiveConfig=function(){return a},f.getinputConfig=function(){return s},f.radialScale=function(g){return r},f.angularScale=function(g){return i},f.svg=function(){return e},t.rebind(f,c,"on"),f},l.Axis.defaultConfig=function(e,o){return{data:[{t:[1,2,3,4],r:[10,11,12,13],name:"Line1",geometry:"LinePlot",color:null,strokeDash:"solid",strokeColor:null,strokeSize:"1",visibleInLegend:!0,opacity:1}],layout:{defaultColorRange:t.scale.category10().range(),title:null,height:450,width:500,margin:{top:40,right:40,bottom:40,left:40},font:{size:12,color:"gray",outlineColor:"white",family:"Tahoma, sans-serif"},direction:"clockwise",orientation:0,labelOffset:10,radialAxis:{domain:null,orientation:-45,ticksSuffix:"",visible:!0,gridLinesVisible:!0,tickOrientation:"horizontal",rewriteTicks:null},angularAxis:{domain:[0,360],ticksSuffix:"",visible:!0,gridLinesVisible:!0,labelsVisible:!0,tickOrientation:"horizontal",rewriteTicks:null,ticksCount:null,ticksStep:null},minorTicks:0,tickLength:null,tickColor:"silver",minorTickColor:"#eee",backgroundColor:"none",needsEndSpacing:null,showLegend:!0,legend:{reverseOrder:!1},opacity:1}}},l.util={},l.DATAEXTENT="dataExtent",l.AREA="AreaChart",l.LINE="LinePlot",l.DOT="DotPlot",l.BAR="BarChart",l.util._override=function(e,o){for(var r in e)r in o&&(o[r]=e[r])},l.util._extend=function(e,o){for(var r in e)o[r]=e[r]},l.util._rndSnd=function(){return 2*Math.random()-1+(2*Math.random()-1)+(2*Math.random()-1)},l.util.dataFromEquation2=function(e,o){var r=o||6;return t.range(0,360+r,r).map(function(i,u){var s=i*Math.PI/180;return[i,e(s)]})},l.util.dataFromEquation=function(e,o,r){var i=o||6,u=[],s=[];t.range(0,360+i,i).forEach(function(c,f){var g=c*Math.PI/180,d=e(g);u.push(c),s.push(d)});var a={t:u,r:s};return r&&(a.name=r),a},l.util.ensureArray=function(e,o){if(typeof e>"u")return null;var r=[].concat(e);return t.range(o).map(function(i,u){return r[u]||r[0]})},l.util.fillArrays=function(e,o,r){return o.forEach(function(i,u){e[i]=l.util.ensureArray(e[i],r)}),e},l.util.cloneJson=function(e){return JSON.parse(JSON.stringify(e))},l.util.validateKeys=function(e,o){typeof o=="string"&&(o=o.split("."));var r=o.shift();return e[r]&&(!o.length||objHasKeys(e[r],o))},l.util.sumArrays=function(e,o){return t.zip(e,o).map(function(r,i){return t.sum(r)})},l.util.arrayLast=function(e){return e[e.length-1]},l.util.arrayEqual=function(e,o){for(var r=Math.max(e.length,o.length,1);r-->=0&&e[r]===o[r];);return r===-2},l.util.flattenArray=function(e){for(var o=[];!l.util.arrayEqual(o,e);)o=e,e=[].concat.apply([],e);return e},l.util.deduplicate=function(e){return e.filter(function(o,r,i){return i.indexOf(o)==r})},l.util.convertToCartesian=function(e,o){var r=o*Math.PI/180;return[e*Math.cos(r),e*Math.sin(r)]},l.util.round=function(e,o){var r=o||2,i=Math.pow(10,r);return Math.round(e*i)/i},l.util.getMousePos=function(e){var o=t.mouse(e.node()),r=o[0],i=o[1],u={};return u.x=r,u.y=i,u.pos=o,u.angle=180*(Math.atan2(i,r)+Math.PI)/Math.PI,u.radius=Math.sqrt(r*r+i*i),u},l.util.duplicatesCount=function(e){for(var o,r={},i={},u=0,s=e.length;u<s;u++)(o=e[u])in r?(r[o]++,i[o]=r[o]):r[o]=1;return i},l.util.duplicates=function(e){return Object.keys(l.util.duplicatesCount(e))},l.util.translator=function(e,o,r,i){if(i){var u=r.slice();r=o,o=u}var s=o.reduce(function(a,c){if(typeof a<"u")return a[c]},e);typeof s<"u"&&(o.reduce(function(a,c,f){if(typeof a<"u")return f===o.length-1&&delete a[c],a[c]},e),r.reduce(function(a,c,f){return typeof a[c]>"u"&&(a[c]={}),f===r.length-1&&(a[c]=s),a[c]},e))},l.PolyChart=function(){var e=[l.PolyChart.defaultConfig()],o=t.dispatch("hover"),r={solid:"none",dash:[5,2],dot:[2,5]};function i(){var u=e[0].geometryConfig,s=u.container;typeof s=="string"&&(s=t.select(s)),s.datum(e).each(function(a,c){var f=!!a[0].data.yStack,g=a.map(function(_,S){return f?t.zip(_.data.t[0],_.data.r[0],_.data.yStack[0]):t.zip(_.data.t[0],_.data.r[0])}),d=u.angularScale,m=u.radialScale.domain()[0],y={bar:function(_,S,C){var k=a[C].data,L=u.radialScale(_[1])-u.radialScale(0),I=u.radialScale(_[2]||0),R=k.barWidth;t.select(this).attr({class:"mark bar",d:"M"+[[L+I,-R/2],[L+I,R/2],[I,R/2],[I,-R/2]].join("L")+"Z",transform:function(V,O){return"rotate("+(u.orientation+d(V[0]))+")"}})}};y.dot=function(_,S,C){var k=_[2]?[_[0],_[1]+_[2]]:_,L=t.svg.symbol().size(a[C].data.dotSize).type(a[C].data.dotType)(_,S);t.select(this).attr({class:"mark dot",d:L,transform:function(I,R){var V,O,J,D=(V=function(B,N){var F=u.radialScale(B[1]),H=(u.angularScale(B[0])+u.orientation)*Math.PI/180;return{r:F,t:H}}(k),O=V.r*Math.cos(V.t),J=V.r*Math.sin(V.t),{x:O,y:J});return"translate("+[D.x,D.y]+")"}})};var v=t.svg.line.radial().interpolate(a[0].data.lineInterpolation).radius(function(_){return u.radialScale(_[1])}).angle(function(_){return u.angularScale(_[0])*Math.PI/180});y.line=function(_,S,C){var k=_[2]?g[C].map(function(I,R){return[I[0],I[1]+I[2]]}):g[C];if(t.select(this).each(y.dot).style({opacity:function(I,R){return+a[C].data.dotVisible},fill:E.stroke(_,S,C)}).attr({class:"mark dot"}),!(S>0)){var L=t.select(this.parentNode).selectAll("path.line").data([0]);L.enter().insert("path"),L.attr({class:"line",d:v(k),transform:function(I,R){return"rotate("+(u.orientation+90)+")"},"pointer-events":"none"}).style({fill:function(I,R){return E.fill(_,S,C)},"fill-opacity":0,stroke:function(I,R){return E.stroke(_,S,C)},"stroke-width":function(I,R){return E["stroke-width"](_,S,C)},"stroke-dasharray":function(I,R){return E["stroke-dasharray"](_,S,C)},opacity:function(I,R){return E.opacity(_,S,C)},display:function(I,R){return E.display(_,S,C)}})}};var T=u.angularScale.range(),w=Math.abs(T[1]-T[0])/g[0].length*Math.PI/180,A=t.svg.arc().startAngle(function(_){return-w/2}).endAngle(function(_){return w/2}).innerRadius(function(_){return u.radialScale(m+(_[2]||0))}).outerRadius(function(_){return u.radialScale(m+(_[2]||0))+u.radialScale(_[1])});y.arc=function(_,S,C){t.select(this).attr({class:"mark arc",d:A,transform:function(k,L){return"rotate("+(u.orientation+d(k[0])+90)+")"}})};var E={fill:function(_,S,C){return a[C].data.color},stroke:function(_,S,C){return a[C].data.strokeColor},"stroke-width":function(_,S,C){return a[C].data.strokeSize+"px"},"stroke-dasharray":function(_,S,C){return r[a[C].data.strokeDash]},opacity:function(_,S,C){return a[C].data.opacity},display:function(_,S,C){return typeof a[C].data.visible>"u"||a[C].data.visible?"block":"none"}},M=t.select(this).selectAll("g.layer").data(g);M.enter().append("g").attr({class:"layer"});var b=M.selectAll("path.mark").data(function(_,S){return _});b.enter().append("path").attr({class:"mark"}),b.style(E).each(y[u.geometryType]),b.exit().remove(),M.exit().remove()})}return i.config=function(u){return arguments.length?(u.forEach(function(s,a){e[a]||(e[a]={}),h(e[a],l.PolyChart.defaultConfig()),h(e[a],s)}),this):e},i.getColorScale=function(){},t.rebind(i,o,"on"),i},l.PolyChart.defaultConfig=function(){return{data:{name:"geom1",t:[[1,2,3,4]],r:[[1,2,3,4]],dotType:"circle",dotSize:64,dotVisible:!1,barWidth:20,color:"#ffa500",strokeSize:1,strokeColor:"silver",strokeDash:"solid",opacity:1,index:0,visible:!0,visibleInLegend:!0},geometryConfig:{geometry:"LinePlot",geometryType:"arc",direction:"clockwise",orientation:0,container:"body",radialScale:null,angularScale:null,colorScale:t.scale.category20()}}},l.BarChart=function(){return l.PolyChart()},l.BarChart.defaultConfig=function(){return{geometryConfig:{geometryType:"bar"}}},l.AreaChart=function(){return l.PolyChart()},l.AreaChart.defaultConfig=function(){return{geometryConfig:{geometryType:"arc"}}},l.DotPlot=function(){return l.PolyChart()},l.DotPlot.defaultConfig=function(){return{geometryConfig:{geometryType:"dot",dotType:"circle"}}},l.LinePlot=function(){return l.PolyChart()},l.LinePlot.defaultConfig=function(){return{geometryConfig:{geometryType:"line"}}},l.Legend=function(){var e=l.Legend.defaultConfig(),o=t.dispatch("hover");function r(){var i=e.legendConfig,u=e.data.map(function(_,S){return[].concat(_).map(function(C,k){var L=h({},i.elements[S]);return L.name=C,L.color=[].concat(i.elements[S].color)[k],L})}),s=t.merge(u);s=s.filter(function(_,S){return i.elements[S]&&(i.elements[S].visibleInLegend||typeof i.elements[S].visibleInLegend>"u")}),i.reverseOrder&&(s=s.reverse());var a=i.container;(typeof a=="string"||a.nodeName)&&(a=t.select(a));var c=s.map(function(_,S){return _.color}),f=i.fontSize,g=i.isContinuous==null?typeof s[0]=="number":i.isContinuous,d=g?i.height:f*s.length,m=a.classed("legend-group",!0).selectAll("svg").data([0]),y=m.enter().append("svg").attr({width:300,height:d+f,xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"});y.append("g").classed("legend-axis",!0),y.append("g").classed("legend-marks",!0);var v=t.range(s.length),T=t.scale[g?"linear":"ordinal"]().domain(v).range(c),w=t.scale[g?"linear":"ordinal"]().domain(v)[g?"range":"rangePoints"]([0,d]);if(g){var A=m.select(".legend-marks").append("defs").append("linearGradient").attr({id:"grad1",x1:"0%",y1:"0%",x2:"0%",y2:"100%"}).selectAll("stop").data(c);A.enter().append("stop"),A.attr({offset:function(_,S){return S/(c.length-1)*100+"%"}}).style({"stop-color":function(_,S){return _}}),m.append("rect").classed("legend-mark",!0).attr({height:i.height,width:i.colorBandWidth,fill:"url(#grad1)"})}else{var E=m.select(".legend-marks").selectAll("path.legend-mark").data(s);E.enter().append("path").classed("legend-mark",!0),E.attr({transform:function(_,S){return"translate("+[f/2,w(S)+f/2]+")"},d:function(_,S){var C,k,L,I=_.symbol;return L=3*(k=f),(C=I)==="line"?"M"+[[-k/2,-k/12],[k/2,-k/12],[k/2,k/12],[-k/2,k/12]]+"Z":t.svg.symbolTypes.indexOf(C)!=-1?t.svg.symbol().type(C).size(L)():t.svg.symbol().type("square").size(L)()},fill:function(_,S){return T(S)}}),E.exit().remove()}var M=t.svg.axis().scale(w).orient("right"),b=m.select("g.legend-axis").attr({transform:"translate("+[g?i.colorBandWidth:f,f/2]+")"}).call(M);return b.selectAll(".domain").style({fill:"none",stroke:"none"}),b.selectAll("line").style({fill:"none",stroke:g?i.textColor:"none"}),b.selectAll("text").style({fill:i.textColor,"font-size":i.fontSize}).text(function(_,S){return s[S].name}),r}return r.config=function(i){return arguments.length?(h(e,i),this):e},t.rebind(r,o,"on"),r},l.Legend.defaultConfig=function(e,o){return{data:["a","b","c"],legendConfig:{elements:[{symbol:"line",color:"red"},{symbol:"square",color:"yellow"},{symbol:"diamond",color:"limegreen"}],height:150,colorBandWidth:30,fontSize:12,container:"body",isContinuous:null,textColor:"grey",reverseOrder:!1}}},l.tooltipPanel=function(){var e,o,r,i={container:null,hasTick:!1,fontSize:12,color:"white",padding:5},u="tooltip-"+l.tooltipPanel.uid++,s=10,a=function(){var c=(e=i.container.selectAll("g."+u).data([0])).enter().append("g").classed(u,!0).style({"pointer-events":"none",display:"none"});return r=c.append("path").style({fill:"white","fill-opacity":.9}).attr({d:"M0 0"}),o=c.append("text").attr({dx:i.padding+s,dy:.3*+i.fontSize}),a};return a.text=function(c){var f=t.hsl(i.color).l,g=f>=.5?"#aaa":"white",d=f>=.5?"black":"white",m=c||"";o.style({fill:d,"font-size":i.fontSize+"px"}).text(m);var y=i.padding,v=o.node().getBBox(),T={fill:i.color,stroke:g,"stroke-width":"2px"},w=v.width+2*y+s,A=v.height+2*y;return r.attr({d:"M"+[[s,-A/2],[s,-A/4],[i.hasTick?0:s,0],[s,A/4],[s,A/2],[w,A/2],[w,-A/2]].join("L")+"Z"}).style(T),e.attr({transform:"translate("+[s,-A/2+2*y]+")"}),e.style({display:"block"}),a},a.move=function(c){if(e)return e.attr({transform:"translate("+[c[0],c[1]]+")"}).style({display:"block"}),a},a.hide=function(){if(e)return e.style({display:"none"}),a},a.show=function(){if(e)return e.style({display:"block"}),a},a.config=function(c){return h(i,c),a},a},l.tooltipPanel.uid=1,l.adapter={},l.adapter.plotly=function(){var e={convert:function(o,r){var i={};if(o.data&&(i.data=o.data.map(function(g,d){var m=h({},g);return[[m,["marker","color"],["color"]],[m,["marker","opacity"],["opacity"]],[m,["marker","line","color"],["strokeColor"]],[m,["marker","line","dash"],["strokeDash"]],[m,["marker","line","width"],["strokeSize"]],[m,["marker","symbol"],["dotType"]],[m,["marker","size"],["dotSize"]],[m,["marker","barWidth"],["barWidth"]],[m,["line","interpolation"],["lineInterpolation"]],[m,["showlegend"],["visibleInLegend"]]].forEach(function(y,v){l.util.translator.apply(null,y.concat(r))}),r||delete m.marker,r&&delete m.groupId,r?(m.geometry==="LinePlot"?(m.type="scatter",m.dotVisible===!0?(delete m.dotVisible,m.mode="lines+markers"):m.mode="lines"):m.geometry==="DotPlot"?(m.type="scatter",m.mode="markers"):m.geometry==="AreaChart"?m.type="area":m.geometry==="BarChart"&&(m.type="bar"),delete m.geometry):(m.type==="scatter"?m.mode==="lines"?m.geometry="LinePlot":m.mode==="markers"?m.geometry="DotPlot":m.mode==="lines+markers"&&(m.geometry="LinePlot",m.dotVisible=!0):m.type==="area"?m.geometry="AreaChart":m.type==="bar"&&(m.geometry="BarChart"),delete m.mode,delete m.type),m}),!r&&o.layout&&o.layout.barmode==="stack")){var u=l.util.duplicates(i.data.map(function(g,d){return g.geometry}));i.data.forEach(function(g,d){var m=u.indexOf(g.geometry);m!=-1&&(i.data[d].groupId=m)})}if(o.layout){var s=h({},o.layout);if([[s,["plot_bgcolor"],["backgroundColor"]],[s,["showlegend"],["showLegend"]],[s,["radialaxis"],["radialAxis"]],[s,["angularaxis"],["angularAxis"]],[s.angularaxis,["showline"],["gridLinesVisible"]],[s.angularaxis,["showticklabels"],["labelsVisible"]],[s.angularaxis,["nticks"],["ticksCount"]],[s.angularaxis,["tickorientation"],["tickOrientation"]],[s.angularaxis,["ticksuffix"],["ticksSuffix"]],[s.angularaxis,["range"],["domain"]],[s.angularaxis,["endpadding"],["endPadding"]],[s.radialaxis,["showline"],["gridLinesVisible"]],[s.radialaxis,["tickorientation"],["tickOrientation"]],[s.radialaxis,["ticksuffix"],["ticksSuffix"]],[s.radialaxis,["range"],["domain"]],[s.angularAxis,["showline"],["gridLinesVisible"]],[s.angularAxis,["showticklabels"],["labelsVisible"]],[s.angularAxis,["nticks"],["ticksCount"]],[s.angularAxis,["tickorientation"],["tickOrientation"]],[s.angularAxis,["ticksuffix"],["ticksSuffix"]],[s.angularAxis,["range"],["domain"]],[s.angularAxis,["endpadding"],["endPadding"]],[s.radialAxis,["showline"],["gridLinesVisible"]],[s.radialAxis,["tickorientation"],["tickOrientation"]],[s.radialAxis,["ticksuffix"],["ticksSuffix"]],[s.radialAxis,["range"],["domain"]],[s.font,["outlinecolor"],["outlineColor"]],[s.legend,["traceorder"],["reverseOrder"]],[s,["labeloffset"],["labelOffset"]],[s,["defaultcolorrange"],["defaultColorRange"]]].forEach(function(g,d){l.util.translator.apply(null,g.concat(r))}),r?(typeof s.tickLength<"u"&&(s.angularaxis.ticklen=s.tickLength,delete s.tickLength),s.tickColor&&(s.angularaxis.tickcolor=s.tickColor,delete s.tickColor)):(s.angularAxis&&typeof s.angularAxis.ticklen<"u"&&(s.tickLength=s.angularAxis.ticklen),s.angularAxis&&typeof s.angularAxis.tickcolor<"u"&&(s.tickColor=s.angularAxis.tickcolor)),s.legend&&typeof s.legend.reverseOrder!="boolean"&&(s.legend.reverseOrder=s.legend.reverseOrder!="normal"),s.legend&&typeof s.legend.traceorder=="boolean"&&(s.legend.traceorder=s.legend.traceorder?"reversed":"normal",delete s.legend.reverseOrder),s.margin&&typeof s.margin.t<"u"){var a=["t","r","b","l","pad"],c=["top","right","bottom","left","pad"],f={};t.entries(s.margin).forEach(function(g,d){f[c[a.indexOf(g.key)]]=g.value}),s.margin=f}r&&(delete s.needsEndSpacing,delete s.minorTickColor,delete s.minorTicks,delete s.angularaxis.ticksCount,delete s.angularaxis.ticksCount,delete s.angularaxis.ticksStep,delete s.angularaxis.rewriteTicks,delete s.angularaxis.nticks,delete s.radialaxis.ticksCount,delete s.radialaxis.ticksCount,delete s.radialaxis.ticksStep,delete s.radialaxis.rewriteTicks,delete s.radialaxis.nticks),i.layout=s}return i}};return e}},{"../../../constants/alignment":745,"../../../lib":778,d3:169}],901:[function(n,z,q){"use strict";var t=n("d3"),h=n("../../../lib"),p=n("../../../components/color"),l=n("./micropolar"),e=n("./undo_manager"),o=h.extendDeepAll,r=z.exports={};r.framework=function(i){var u,s,a,c,f,g=new e;function d(m,y){return y&&(f=y),t.select(t.select(f).node().parentNode).selectAll(".svg-container>*:not(.chart-root)").remove(),u=u?o(u,m):m,a||(a=l.Axis()),c=l.adapter.plotly().convert(u),a.config(c).render(f),i.data=u.data,i.layout=u.layout,r.fillLayout(i),u}return d.isPolar=!0,d.svg=function(){return a.svg()},d.getConfig=function(){return u},d.getLiveConfig=function(){return l.adapter.plotly().convert(a.getLiveConfig(),!0)},d.getLiveScales=function(){return{t:a.angularScale(),r:a.radialScale()}},d.setUndoPoint=function(){var m,y,v=this,T=l.util.cloneJson(u);m=T,y=s,g.add({undo:function(){y&&v(y)},redo:function(){v(m)}}),s=l.util.cloneJson(T)},d.undo=function(){g.undo()},d.redo=function(){g.redo()},d},r.fillLayout=function(i){var u=t.select(i).selectAll(".plot-container"),s=u.selectAll(".svg-container"),a=i.framework&&i.framework.svg&&i.framework.svg(),c={width:800,height:600,paper_bgcolor:p.background,_container:u,_paperdiv:s,_paper:a};i._fullLayout=o(c,i.layout)}},{"../../../components/color":643,"../../../lib":778,"./micropolar":900,"./undo_manager":902,d3:169}],902:[function(n,z,q){"use strict";z.exports=function(){var t,h=[],p=-1,l=!1;function e(o,r){return o?(l=!0,o[r](),l=!1,this):this}return{add:function(o){return l||(h.splice(p+1,h.length-p),h.push(o),p=h.length-1),this},setCallback:function(o){t=o},undo:function(){var o=h[p];return o?(e(o,"undo"),p-=1,t&&t(o.undo),this):this},redo:function(){var o=h[p+1];return o?(e(o,"redo"),p+=1,t&&t(o.redo),this):this},clear:function(){h=[],p=-1},hasUndo:function(){return p!==-1},hasRedo:function(){return p<h.length-1},getCommands:function(){return h},getPreviousCommand:function(){return h[p-1]},getIndex:function(){return p}}}},{}],903:[function(n,z,q){"use strict";var t=n("d3"),h=n("tinycolor2"),p=n("../../registry"),l=n("../../lib"),e=l.strRotate,o=l.strTranslate,r=n("../../components/color"),i=n("../../components/drawing"),u=n("../plots"),s=n("../../plots/cartesian/axes"),a=n("../cartesian/set_convert"),c=n("./set_convert"),f=n("../cartesian/autorange").doAutoRange,g=n("../cartesian/dragbox"),d=n("../../components/dragelement"),m=n("../../components/fx"),y=n("../../components/titles"),v=n("../cartesian/select").prepSelect,T=n("../cartesian/select").selectOnClick,w=n("../cartesian/select").clearSelect,A=n("../../lib/setcursor"),E=n("../../lib/clear_gl_canvases"),M=n("../../plot_api/subroutines").redrawReglTraces,b=n("../../constants/alignment").MID_SHIFT,_=n("./constants"),S=n("./helpers"),C=l._,k=l.mod,L=l.deg2rad,I=l.rad2deg;function R(B,N){this.id=N,this.gd=B,this._hasClipOnAxisFalse=null,this.vangles=null,this.radialAxisAngle=null,this.traceHash={},this.layers={},this.clipPaths={},this.clipIds={},this.viewInitial={};var F=B._fullLayout,H="clip"+F._uid+N;this.clipIds.forTraces=H+"-for-traces",this.clipPaths.forTraces=F._clips.append("clipPath").attr("id",this.clipIds.forTraces),this.clipPaths.forTraces.append("path"),this.framework=F._polarlayer.append("g").attr("class",N),this.radialTickLayout=null,this.angularTickLayout=null}var V=R.prototype;function O(B){var N=B.ticks+String(B.ticklen)+String(B.showticklabels);return"side"in B&&(N+=B.side),N}function J(B,N){return N[l.findIndexOfMin(N,function(F){return l.angleDist(B,F)})]}function D(B,N,F){return N?(B.attr("display",null),B.attr(F)):B&&B.attr("display","none"),B}z.exports=function(B,N){return new R(B,N)},V.plot=function(B,N){var F=N[this.id];this._hasClipOnAxisFalse=!1;for(var H=0;H<B.length;H++)if(B[H][0].trace.cliponaxis===!1){this._hasClipOnAxisFalse=!0;break}this.updateLayers(N,F),this.updateLayout(N,F),u.generalUpdatePerTraceModule(this.gd,this,B,F),this.updateFx(N,F)},V.updateLayers=function(B,N){var F=this.layers,H=N.radialaxis,j=N.angularaxis,G=_.layerNames,W=G.indexOf("frontplot"),Q=G.slice(0,W),$=j.layer==="below traces",ee=H.layer==="below traces";$&&Q.push("angular-line"),ee&&Q.push("radial-line"),$&&Q.push("angular-axis"),ee&&Q.push("radial-axis"),Q.push("frontplot"),$||Q.push("angular-line"),ee||Q.push("radial-line"),$||Q.push("angular-axis"),ee||Q.push("radial-axis");var ie=this.framework.selectAll(".polarsublayer").data(Q,String);ie.enter().append("g").attr("class",function(ae){return"polarsublayer "+ae}).each(function(ae){var oe=F[ae]=t.select(this);switch(ae){case"frontplot":oe.append("g").classed("barlayer",!0),oe.append("g").classed("scatterlayer",!0);break;case"backplot":oe.append("g").classed("maplayer",!0);break;case"plotbg":F.bg=oe.append("path");break;case"radial-grid":case"angular-grid":oe.style("fill","none");break;case"radial-line":oe.append("line").style("fill","none");break;case"angular-line":oe.append("path").style("fill","none")}}),ie.order()},V.updateLayout=function(B,N){var F=this.layers,H=B._size,j=N.radialaxis,G=N.angularaxis,W=N.domain.x,Q=N.domain.y;this.xOffset=H.l+H.w*W[0],this.yOffset=H.t+H.h*(1-Q[1]);var $=this.xLength=H.w*(W[1]-W[0]),ee=this.yLength=H.h*(Q[1]-Q[0]),ie=N.sector;this.sectorInRad=ie.map(L);var ae,oe,de,le,fe,ue=this.sectorBBox=function(et){var Re,Ze,Ke,$e,rt=et[0],at=et[1]-rt,lt=k(rt,360),gt=lt+at,Ie=Math.cos(L(lt)),be=Math.sin(L(lt)),We=Math.cos(L(gt)),Ge=Math.sin(L(gt));return $e=lt<=90&&gt>=90||lt>90&&gt>=450?1:be<=0&&Ge<=0?0:Math.max(be,Ge),Re=lt<=180&&gt>=180||lt>180&&gt>=540?-1:Ie>=0&&We>=0?0:Math.min(Ie,We),Ze=lt<=270&&gt>=270||lt>270&&gt>=630?-1:be>=0&&Ge>=0?0:Math.min(be,Ge),Ke=gt>=360?1:Ie<=0&&We<=0?0:Math.max(Ie,We),[Re,Ze,Ke,$e]}(ie),we=ue[2]-ue[0],Ae=ue[3]-ue[1],Se=ee/$,ke=Math.abs(Ae/we);Se>ke?(ae=$,fe=(ee-(oe=$*ke))/H.h/2,de=[W[0],W[1]],le=[Q[0]+fe,Q[1]-fe]):(oe=ee,fe=($-(ae=ee/ke))/H.w/2,de=[W[0]+fe,W[1]-fe],le=[Q[0],Q[1]]),this.xLength2=ae,this.yLength2=oe,this.xDomain2=de,this.yDomain2=le;var Me=this.xOffset2=H.l+H.w*de[0],ve=this.yOffset2=H.t+H.h*(1-le[1]),ge=this.radius=ae/we,De=this.innerRadius=N.hole*ge,_e=this.cx=Me-ge*ue[0],Pe=this.cy=ve+ge*ue[3],Fe=this.cxx=_e-Me,ze=this.cyy=Pe-ve;this.radialAxis=this.mockAxis(B,N,j,{_id:"x",side:{counterclockwise:"top",clockwise:"bottom"}[j.side],_realSide:j.side,domain:[De/H.w,ge/H.w]}),this.angularAxis=this.mockAxis(B,N,G,{side:"right",domain:[0,Math.PI],autorange:!1}),this.doAutoRange(B,N),this.updateAngularAxis(B,N),this.updateRadialAxis(B,N),this.updateRadialAxisTitle(B,N),this.xaxis=this.mockCartesianAxis(B,N,{_id:"x",domain:de}),this.yaxis=this.mockCartesianAxis(B,N,{_id:"y",domain:le});var He=this.pathSubplot();this.clipPaths.forTraces.select("path").attr("d",He).attr("transform",o(Fe,ze)),F.frontplot.attr("transform",o(Me,ve)).call(i.setClipUrl,this._hasClipOnAxisFalse?null:this.clipIds.forTraces,this.gd),F.bg.attr("d",He).attr("transform",o(_e,Pe)).call(r.fill,N.bgcolor)},V.mockAxis=function(B,N,F,H){var j=l.extendFlat({},F,H);return c(j,N,B),j},V.mockCartesianAxis=function(B,N,F){var H=this,j=F._id,G=l.extendFlat({type:"linear"},F);a(G,B);var W={x:[0,2],y:[1,3]};return G.setRange=function(){var Q=H.sectorBBox,$=W[j],ee=H.radialAxis._rl,ie=(ee[1]-ee[0])/(1-N.hole);G.range=[Q[$[0]]*ie,Q[$[1]]*ie]},G.isPtWithinRange=j==="x"?function(Q){return H.isPtInside(Q)}:function(){return!0},G.setRange(),G.setScale(),G},V.doAutoRange=function(B,N){var F=this.gd,H=this.radialAxis,j=N.radialaxis;H.setScale(),f(F,H);var G=H.range;j.range=G.slice(),j._input.range=G.slice(),H._rl=[H.r2l(G[0],null,"gregorian"),H.r2l(G[1],null,"gregorian")]},V.updateRadialAxis=function(B,N){var F=this,H=F.gd,j=F.layers,G=F.radius,W=F.innerRadius,Q=F.cx,$=F.cy,ee=N.radialaxis,ie=k(N.sector[0],360),ae=F.radialAxis,oe=W<G;F.fillViewInitialKey("radialaxis.angle",ee.angle),F.fillViewInitialKey("radialaxis.range",ae.range.slice()),ae.setGeometry(),ae.tickangle==="auto"&&ie>90&&ie<=270&&(ae.tickangle=180);var de=function(Me){return o(ae.l2p(Me.x)+W,0)},le=O(ee);if(F.radialTickLayout!==le&&(j["radial-axis"].selectAll(".xtick").remove(),F.radialTickLayout=le),oe){ae.setScale();var fe=s.calcTicks(ae),ue=s.clipEnds(ae,fe),we=s.getTickSigns(ae)[2];s.drawTicks(H,ae,{vals:fe,layer:j["radial-axis"],path:s.makeTickPath(ae,0,we),transFn:de,crisp:!1}),s.drawGrid(H,ae,{vals:ue,layer:j["radial-grid"],path:function(Me){return F.pathArc(ae.r2p(Me.x)+W)},transFn:l.noop,crisp:!1}),s.drawLabels(H,ae,{vals:fe,layer:j["radial-axis"],transFn:de,labelFns:s.makeLabelFns(ae,0)})}var Ae=F.radialAxisAngle=F.vangles?I(J(L(ee.angle),F.vangles)):ee.angle,Se=o(Q,$),ke=Se+e(-Ae);D(j["radial-axis"],oe&&(ee.showticklabels||ee.ticks),{transform:ke}),D(j["radial-grid"],oe&&ee.showgrid,{transform:Se}),D(j["radial-line"].select("line"),oe&&ee.showline,{x1:W,y1:0,x2:G,y2:0,transform:ke}).attr("stroke-width",ee.linewidth).call(r.stroke,ee.linecolor)},V.updateRadialAxisTitle=function(B,N,F){var H=this.gd,j=this.radius,G=this.cx,W=this.cy,Q=N.radialaxis,$=this.id+"title",ee=F!==void 0?F:this.radialAxisAngle,ie=L(ee),ae=Math.cos(ie),oe=Math.sin(ie),de=0;if(Q.title){var le=i.bBox(this.layers["radial-axis"].node()).height,fe=Q.title.font.size;de=Q.side==="counterclockwise"?-le-.4*fe:le+.8*fe}this.layers["radial-axis-title"]=y.draw(H,$,{propContainer:Q,propName:this.id+".radialaxis.title",placeholder:C(H,"Click to enter radial axis title"),attributes:{x:G+j/2*ae+de*oe,y:W-j/2*oe+de*ae,"text-anchor":"middle"},transform:{rotate:-ee}})},V.updateAngularAxis=function(B,N){var F=this,H=F.gd,j=F.layers,G=F.radius,W=F.innerRadius,Q=F.cx,$=F.cy,ee=N.angularaxis,ie=F.angularAxis;F.fillViewInitialKey("angularaxis.rotation",ee.rotation),ie.setGeometry(),ie.setScale();var ae=function(ke){return ie.t2g(ke.x)};ie.type==="linear"&&ie.thetaunit==="radians"&&(ie.tick0=I(ie.tick0),ie.dtick=I(ie.dtick));var oe=function(ke){return o(Q+G*Math.cos(ke),$-G*Math.sin(ke))},de=s.makeLabelFns(ie,0).labelStandoff,le={xFn:function(ke){var Me=ae(ke);return Math.cos(Me)*de},yFn:function(ke){var Me=ae(ke),ve=Math.sin(Me)>0?.2:1;return-Math.sin(Me)*(de+ke.fontSize*ve)+Math.abs(Math.cos(Me))*(ke.fontSize*b)},anchorFn:function(ke){var Me=ae(ke),ve=Math.cos(Me);return Math.abs(ve)<.1?"middle":ve>0?"start":"end"},heightFn:function(ke,Me,ve){var ge=ae(ke);return-.5*(1+Math.sin(ge))*ve}},fe=O(ee);F.angularTickLayout!==fe&&(j["angular-axis"].selectAll("."+ie._id+"tick").remove(),F.angularTickLayout=fe);var ue,we=s.calcTicks(ie);if(N.gridshape==="linear"?(ue=we.map(ae),l.angleDelta(ue[0],ue[1])<0&&(ue=ue.slice().reverse())):ue=null,F.vangles=ue,ie.type==="category"&&(we=we.filter(function(ke){return l.isAngleInsideSector(ae(ke),F.sectorInRad)})),ie.visible){var Ae=ie.ticks==="inside"?-1:1,Se=(ie.linewidth||1)/2;s.drawTicks(H,ie,{vals:we,layer:j["angular-axis"],path:"M"+Ae*Se+",0h"+Ae*ie.ticklen,transFn:function(ke){var Me=ae(ke);return oe(Me)+e(-I(Me))},crisp:!1}),s.drawGrid(H,ie,{vals:we,layer:j["angular-grid"],path:function(ke){var Me=ae(ke),ve=Math.cos(Me),ge=Math.sin(Me);return"M"+[Q+W*ve,$-W*ge]+"L"+[Q+G*ve,$-G*ge]},transFn:l.noop,crisp:!1}),s.drawLabels(H,ie,{vals:we,layer:j["angular-axis"],repositionOnUpdate:!0,transFn:function(ke){return oe(ae(ke))},labelFns:le})}D(j["angular-line"].select("path"),ee.showline,{d:F.pathSubplot(),transform:o(Q,$)}).attr("stroke-width",ee.linewidth).call(r.stroke,ee.linecolor)},V.updateFx=function(B,N){this.gd._context.staticPlot||(this.updateAngularDrag(B),this.updateRadialDrag(B,N,0),this.updateRadialDrag(B,N,1),this.updateMainDrag(B))},V.updateMainDrag=function(B){var N,F,H=this,j=H.gd,G=H.layers,W=B._zoomlayer,Q=_.MINZOOM,$=_.OFFEDGE,ee=H.radius,ie=H.innerRadius,ae=H.cx,oe=H.cy,de=H.cxx,le=H.cyy,fe=H.sectorInRad,ue=H.vangles,we=H.radialAxis,Ae=S.clampTiny,Se=S.findXYatLength,ke=S.findEnclosingVertexAngles,Me=_.cornerHalfWidth,ve=_.cornerLen/2,ge=g.makeDragger(G,"path","maindrag","crosshair");t.select(ge).attr("d",H.pathSubplot()).attr("transform",o(ae,oe));var De,_e,Pe,Fe,ze,He,et,Re,Ze,Ke={element:ge,gd:j,subplot:H.id,plotinfo:{id:H.id,xaxis:H.xaxis,yaxis:H.yaxis},xaxes:[H.xaxis],yaxes:[H.yaxis]};function $e(xe,Ee){return Math.sqrt(xe*xe+Ee*Ee)}function rt(xe,Ee){return $e(xe-de,Ee-le)}function at(xe,Ee){return Math.atan2(le-Ee,xe-de)}function lt(xe,Ee){return[xe*Math.cos(Ee),xe*Math.sin(-Ee)]}function gt(xe,Ee){if(xe===0)return H.pathSector(2*Me);var Je=ve/xe,it=Ee-Je,ht=Ee+Je,ct=Math.max(0,Math.min(xe,ee)),mt=ct-Me,bt=ct+Me;return"M"+lt(mt,it)+"A"+[mt,mt]+" 0,0,0 "+lt(mt,ht)+"L"+lt(bt,ht)+"A"+[bt,bt]+" 0,0,1 "+lt(bt,it)+"Z"}function Ie(xe,Ee,Je){if(xe===0)return H.pathSector(2*Me);var it,ht,ct=lt(xe,Ee),mt=lt(xe,Je),bt=Ae((ct[0]+mt[0])/2),Et=Ae((ct[1]+mt[1])/2);if(bt&&Et){var Mt=Et/bt,_t=-1/Mt,xt=Se(Me,Mt,bt,Et);it=Se(ve,_t,xt[0][0],xt[0][1]),ht=Se(ve,_t,xt[1][0],xt[1][1])}else{var At,It;Et?(At=ve,It=Me):(At=Me,It=ve),it=[[bt-At,Et-It],[bt+At,Et-It]],ht=[[bt-At,Et+It],[bt+At,Et+It]]}return"M"+it.join("L")+"L"+ht.reverse().join("L")+"Z"}function be(xe,Ee){return Ee=Math.max(Math.min(Ee,ee),ie),xe<$?xe=0:ee-xe<$?xe=ee:Ee<$?Ee=0:ee-Ee<$&&(Ee=ee),Math.abs(Ee-xe)>Q?(xe<Ee?(Pe=xe,Fe=Ee):(Pe=Ee,Fe=xe),!0):(Pe=null,Fe=null,!1)}function We(xe,Ee){xe=xe||ze,Ee=Ee||"M0,0Z",Re.attr("d",xe),Ze.attr("d",Ee),g.transitionZoombox(Re,Ze,He,et),He=!0;var Je={};Ue(Je),j.emit("plotly_relayouting",Je)}function Ge(xe,Ee){var Je,it,ht=De+(xe*=N),ct=_e+(Ee*=F),mt=rt(De,_e),bt=Math.min(rt(ht,ct),ee),Et=at(De,_e);be(mt,bt)&&(Je=ze+H.pathSector(Fe),Pe&&(Je+=H.pathSector(Pe)),it=gt(Pe,Et)+gt(Fe,Et)),We(Je,it)}function st(xe,Ee,Je,it){var ht=S.findIntersectionXY(Je,it,Je,[xe-de,le-Ee]);return $e(ht[0],ht[1])}function ot(xe,Ee){var Je,it,ht=De+xe,ct=_e+Ee,mt=at(De,_e),bt=at(ht,ct),Et=ke(mt,ue),Mt=ke(bt,ue);be(st(De,_e,Et[0],Et[1]),Math.min(st(ht,ct,Mt[0],Mt[1]),ee))&&(Je=ze+H.pathSector(Fe),Pe&&(Je+=H.pathSector(Pe)),it=[Ie(Pe,Et[0],Et[1]),Ie(Fe,Et[0],Et[1])].join(" ")),We(Je,it)}function Ce(){if(g.removeZoombox(j),Pe!==null&&Fe!==null){var xe={};Ue(xe),g.showDoubleClickNotifier(j),p.call("_guiRelayout",j,xe)}}function Ue(xe){var Ee=we._rl,Je=(Ee[1]-Ee[0])/(1-ie/ee)/ee,it=[Ee[0]+(Pe-ie)*Je,Ee[0]+(Fe-ie)*Je];xe[H.id+".radialaxis.range"]=it}function Ye(xe,Ee){var Je=j._fullLayout.clickmode;if(g.removeZoombox(j),xe===2){var it={};for(var ht in H.viewInitial)it[H.id+"."+ht]=H.viewInitial[ht];j.emit("plotly_doubleclick",null),p.call("_guiRelayout",j,it)}Je.indexOf("select")>-1&&xe===1&&T(Ee,j,[H.xaxis],[H.yaxis],H.id,Ke),Je.indexOf("event")>-1&&m.click(j,Ee,H.id)}Ke.prepFn=function(xe,Ee,Je){var it=j._fullLayout.dragmode,ht=ge.getBoundingClientRect();j._fullLayout._calcInverseTransform(j);var ct=j._fullLayout._invTransform;N=j._fullLayout._invScaleX,F=j._fullLayout._invScaleY;var mt=l.apply3DTransform(ct)(Ee-ht.left,Je-ht.top);if(De=mt[0],_e=mt[1],ue){var bt=S.findPolygonOffset(ee,fe[0],fe[1],ue);De+=de+bt[0],_e+=le+bt[1]}switch(it){case"zoom":Ke.moveFn=ue?ot:Ge,Ke.clickFn=Ye,Ke.doneFn=Ce,function(){Pe=null,Fe=null,ze=H.pathSubplot(),He=!1;var Et=j._fullLayout[H.id];et=h(Et.bgcolor).getLuminance(),(Re=g.makeZoombox(W,et,ae,oe,ze)).attr("fill-rule","evenodd"),Ze=g.makeCorners(W,ae,oe),w(j)}();break;case"select":case"lasso":v(xe,Ee,Je,Ke,it)}},ge.onmousemove=function(xe){m.hover(j,xe,H.id),j._fullLayout._lasthover=ge,j._fullLayout._hoversubplot=H.id},ge.onmouseout=function(xe){j._dragging||d.unhover(j,xe)},d.init(Ke)},V.updateRadialDrag=function(B,N,F){var H=this,j=H.gd,G=H.layers,W=H.radius,Q=H.innerRadius,$=H.cx,ee=H.cy,ie=H.radialAxis,ae=_.radialDragBoxSize,oe=ae/2;if(ie.visible){var de,le,fe,ue=L(H.radialAxisAngle),we=ie._rl,Ae=we[0],Se=we[1],ke=we[F],Me=.75*(we[1]-we[0])/(1-N.hole)/W;F?(de=$+(W+oe)*Math.cos(ue),le=ee-(W+oe)*Math.sin(ue),fe="radialdrag"):(de=$+(Q-oe)*Math.cos(ue),le=ee-(Q-oe)*Math.sin(ue),fe="radialdrag-inner");var ve,ge,De,_e=g.makeRectDragger(G,fe,"crosshair",-oe,-oe,ae,ae),Pe={element:_e,gd:j};D(t.select(_e),ie.visible&&Q<W,{transform:o(de,le)}),Pe.prepFn=function(){ve=null,ge=null,De=null,Pe.moveFn=Fe,Pe.doneFn=ze,w(j)},Pe.clampFn=function(Re,Ze){return Math.sqrt(Re*Re+Ze*Ze)<_.MINDRAG&&(Re=0,Ze=0),[Re,Ze]},d.init(Pe)}function Fe(Re,Ze){if(ve)ve(Re,Ze);else{var Ke=[Re,-Ze],$e=[Math.cos(ue),Math.sin(ue)],rt=Math.abs(l.dot(Ke,$e)/Math.sqrt(l.dot(Ke,Ke)));isNaN(rt)||(ve=rt<.5?He:et)}var at={};(function(lt){ge!==null?lt[H.id+".radialaxis.angle"]=ge:De!==null&&(lt[H.id+".radialaxis.range["+F+"]"]=De)})(at),j.emit("plotly_relayouting",at)}function ze(){ge!==null?p.call("_guiRelayout",j,H.id+".radialaxis.angle",ge):De!==null&&p.call("_guiRelayout",j,H.id+".radialaxis.range["+F+"]",De)}function He(Re,Ze){if(F!==0){var Ke=de+Re,$e=le+Ze;ge=Math.atan2(ee-$e,Ke-$),H.vangles&&(ge=J(ge,H.vangles)),ge=I(ge);var rt=o($,ee)+e(-ge);G["radial-axis"].attr("transform",rt),G["radial-line"].select("line").attr("transform",rt);var at=H.gd._fullLayout,lt=at[H.id];H.updateRadialAxisTitle(at,lt,ge)}}function et(Re,Ze){var Ke=l.dot([Re,-Ze],[Math.cos(ue),Math.sin(ue)]);if(De=ke-Me*Ke,Me>0==(F?De>Ae:De<Se)){var $e=j._fullLayout,rt=$e[H.id];ie.range[F]=De,ie._rl[F]=De,H.updateRadialAxis($e,rt),H.xaxis.setRange(),H.xaxis.setScale(),H.yaxis.setRange(),H.yaxis.setScale();var at=!1;for(var lt in H.traceHash){var gt=H.traceHash[lt],Ie=l.filterVisible(gt);gt[0][0].trace._module.plot(j,H,Ie,rt),p.traceIs(lt,"gl")&&Ie.length&&(at=!0)}at&&(E(j),M(j))}else De=null}},V.updateAngularDrag=function(B){var N=this,F=N.gd,H=N.layers,j=N.radius,G=N.angularAxis,W=N.cx,Q=N.cy,$=N.cxx,ee=N.cyy,ie=_.angularDragBoxSize,ae=g.makeDragger(H,"path","angulardrag","move"),oe={element:ae,gd:F};function de(Pe,Fe){return Math.atan2(ee+ie-Fe,Pe-$-ie)}t.select(ae).attr("d",N.pathAnnulus(j,j+ie)).attr("transform",o(W,Q)).call(A,"move");var le,fe,ue,we,Ae,Se,ke=H.frontplot.select(".scatterlayer").selectAll(".trace"),Me=ke.selectAll(".point"),ve=ke.selectAll(".textpoint");function ge(Pe,Fe){var ze=N.gd._fullLayout,He=ze[N.id],et=de(le+Pe*B._invScaleX,fe+Fe*B._invScaleY),Re=I(et-Se);if(we=ue+Re,H.frontplot.attr("transform",o(N.xOffset2,N.yOffset2)+e([-Re,$,ee])),N.vangles){Ae=N.radialAxisAngle+Re;var Ze=o(W,Q)+e(-Re),Ke=o(W,Q)+e(-Ae);H.bg.attr("transform",Ze),H["radial-grid"].attr("transform",Ze),H["radial-axis"].attr("transform",Ke),H["radial-line"].select("line").attr("transform",Ke),N.updateRadialAxisTitle(ze,He,Ae)}else N.clipPaths.forTraces.select("path").attr("transform",o($,ee)+e(Re));Me.each(function(){var Ie=t.select(this),be=i.getTranslate(Ie);Ie.attr("transform",o(be.x,be.y)+e([Re]))}),ve.each(function(){var Ie=t.select(this),be=Ie.select("text"),We=i.getTranslate(Ie);Ie.attr("transform",e([Re,be.attr("x"),be.attr("y")])+o(We.x,We.y))}),G.rotation=l.modHalf(we,360),N.updateAngularAxis(ze,He),N._hasClipOnAxisFalse&&!l.isFullCircle(N.sectorInRad)&&ke.call(i.hideOutsideRangePoints,N);var $e=!1;for(var rt in N.traceHash)if(p.traceIs(rt,"gl")){var at=N.traceHash[rt],lt=l.filterVisible(at);at[0][0].trace._module.plot(F,N,lt,He),lt.length&&($e=!0)}$e&&(E(F),M(F));var gt={};De(gt),F.emit("plotly_relayouting",gt)}function De(Pe){Pe[N.id+".angularaxis.rotation"]=we,N.vangles&&(Pe[N.id+".radialaxis.angle"]=Ae)}function _e(){ve.select("text").attr("transform",null);var Pe={};De(Pe),p.call("_guiRelayout",F,Pe)}oe.prepFn=function(Pe,Fe,ze){var He=B[N.id];ue=He.angularaxis.rotation;var et=ae.getBoundingClientRect();le=Fe-et.left,fe=ze-et.top,F._fullLayout._calcInverseTransform(F);var Re=l.apply3DTransform(B._invTransform)(le,fe);le=Re[0],fe=Re[1],Se=de(le,fe),oe.moveFn=ge,oe.doneFn=_e,w(F)},N.vangles&&!l.isFullCircle(N.sectorInRad)&&(oe.prepFn=l.noop,A(t.select(ae),null)),d.init(oe)},V.isPtInside=function(B){var N=this.sectorInRad,F=this.vangles,H=this.angularAxis.c2g(B.theta),j=this.radialAxis,G=j.c2l(B.r),W=j._rl;return(F?S.isPtInsidePolygon:l.isPtInsideSector)(G,H,W,N,F)},V.pathArc=function(B){var N=this.sectorInRad,F=this.vangles;return(F?S.pathPolygon:l.pathArc)(B,N[0],N[1],F)},V.pathSector=function(B){var N=this.sectorInRad,F=this.vangles;return(F?S.pathPolygon:l.pathSector)(B,N[0],N[1],F)},V.pathAnnulus=function(B,N){var F=this.sectorInRad,H=this.vangles;return(H?S.pathPolygonAnnulus:l.pathAnnulus)(B,N,F[0],F[1],H)},V.pathSubplot=function(){var B=this.innerRadius,N=this.radius;return B?this.pathAnnulus(B,N):this.pathSector(N)},V.fillViewInitialKey=function(B,N){B in this.viewInitial||(this.viewInitial[B]=N)}},{"../../components/color":643,"../../components/dragelement":662,"../../components/drawing":665,"../../components/fx":683,"../../components/titles":738,"../../constants/alignment":745,"../../lib":778,"../../lib/clear_gl_canvases":762,"../../lib/setcursor":799,"../../plot_api/subroutines":818,"../../plots/cartesian/axes":828,"../../registry":911,"../cartesian/autorange":827,"../cartesian/dragbox":836,"../cartesian/select":847,"../cartesian/set_convert":848,"../plots":891,"./constants":892,"./helpers":893,"./set_convert":904,d3:169,tinycolor2:576}],904:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../cartesian/set_convert"),p=t.deg2rad,l=t.rad2deg;z.exports=function(e,o,r){switch(h(e,r),e._id){case"x":case"radialaxis":(function(i,u){var s=u._subplot;i.setGeometry=function(){var a=i._rl[0],c=i._rl[1],f=s.innerRadius,g=(s.radius-f)/(c-a),d=f/g,m=a>c?function(y){return y<=0}:function(y){return y>=0};i.c2g=function(y){var v=i.c2l(y)-a;return(m(v)?v:0)+d},i.g2c=function(y){return i.l2c(y+a-d)},i.g2p=function(y){return y*g},i.c2p=function(y){return i.g2p(i.c2g(y))}}})(e,o);break;case"angularaxis":(function(i,u){var s=i.type;if(s==="linear"){var a=i.d2c,c=i.c2d;i.d2c=function(f,g){return function(d,m){return m==="degrees"?p(d):d}(a(f),g)},i.c2d=function(f,g){return c(function(d,m){return m==="degrees"?l(d):d}(f,g))}}i.makeCalcdata=function(f,g){var d,m,y=f[g],v=f._length,T=function(b){return i.d2c(b,f.thetaunit)};if(y){if(t.isTypedArray(y)&&s==="linear"){if(v===y.length)return y;if(y.subarray)return y.subarray(0,v)}for(d=new Array(v),m=0;m<v;m++)d[m]=T(y[m])}else{var w=g+"0",A="d"+g,E=w in f?T(f[w]):0,M=f[A]?T(f[A]):(i.period||2*Math.PI)/v;for(d=new Array(v),m=0;m<v;m++)d[m]=E+m*M}return d},i.setGeometry=function(){var f,g,d,m,y=u.sector,v=y.map(p),T={clockwise:-1,counterclockwise:1}[i.direction],w=p(i.rotation),A=function(_){return T*_+w},E=function(_){return(_-w)/T};switch(s){case"linear":g=f=t.identity,m=p,d=l,i.range=t.isFullCircle(v)?[y[0],y[0]+360]:v.map(E).map(l);break;case"category":var M=i._categories.length,b=i.period?Math.max(i.period,M):M;b===0&&(b=1),g=m=function(_){return 2*_*Math.PI/b},f=d=function(_){return _*b/Math.PI/2},i.range=[0,b]}i.c2g=function(_){return A(g(_))},i.g2c=function(_){return f(E(_))},i.t2g=function(_){return A(m(_))},i.g2t=function(_){return d(E(_))}}})(e,o)}}},{"../../lib":778,"../cartesian/set_convert":848}],905:[function(n,z,q){"use strict";var t=n("../lib"),h=n("../plot_api/plot_template"),p=n("./domain").defaults;z.exports=function(l,e,o,r){var i,u,s=r.type,a=r.attributes,c=r.handleDefaults,f=r.partition||"x",g=e._subplots[s],d=g.length,m=d&&g[0].replace(/\d+$/,"");function y(A,E){return t.coerce(i,u,a,A,E)}for(var v=0;v<d;v++){var T=g[v];i=l[T]?l[T]:l[T]={},u=h.newContainer(e,T,m),y("uirevision",e.uirevision);var w={};w[f]=[v/d,(v+1)/d],p(u,e,y,w),r.id=T,c(i,u,y,r)}}},{"../lib":778,"../plot_api/plot_template":817,"./domain":855}],906:[function(n,z,q){"use strict";['Variables are inserted using %{variable}, for example "y: %{y}".',`Numbers are formatted using d3-format's syntax %{variable:d3-format}, for example "Price: %{y:$.2f}".`,n("../constants/docs").FORMAT_LINK,"for details on the formatting syntax.",`Dates are formatted using d3-time-format's syntax %{variable|d3-time-format}, for example "Day: %{2019-01-01|%A}".`,n("../constants/docs").DATE_FORMAT_LINK,"for details on the date formatting syntax."].join(" ");function t(h){var p=h.description?" "+h.description:"",l=h.keys||[];if(l.length>0){for(var e=[],o=0;o<l.length;o++)e[o]="`"+l[o]+"`";p+="Finally, the template string has access to ",p=l.length===1?"variable "+e[0]:"variables "+e.slice(0,-1).join(", ")+" and "+e.slice(-1)+"."}return p}q.hovertemplateAttrs=function(h,p){h=h||{},t(p=p||{});var l={valType:"string",dflt:"",editType:h.editType||"none"};return h.arrayOk!==!1&&(l.arrayOk=!0),l},q.texttemplateAttrs=function(h,p){h=h||{},t(p=p||{});var l={valType:"string",dflt:"",editType:h.editType||"calc"};return h.arrayOk!==!1&&(l.arrayOk=!0),l}},{"../constants/docs":748}],907:[function(n,z,q){"use strict";var t=n("./ternary"),h=n("../../plots/get_data").getSubplotCalcData,p=n("../../lib").counterRegex;q.name="ternary";var l=q.attr="subplot";q.idRoot="ternary",q.idRegex=q.attrRegex=p("ternary"),(q.attributes={})[l]={valType:"subplotid",dflt:"ternary",editType:"calc"},q.layoutAttributes=n("./layout_attributes"),q.supplyLayoutDefaults=n("./layout_defaults"),q.plot=function(e){for(var o=e._fullLayout,r=e.calcdata,i=o._subplots.ternary,u=0;u<i.length;u++){var s=i[u],a=h(r,"ternary",s),c=o[s]._subplot;c||(c=new t({id:s,graphDiv:e,container:o._ternarylayer.node()},o),o[s]._subplot=c),c.plot(a,o,e._promises)}},q.clean=function(e,o,r,i){for(var u=i._subplots.ternary||[],s=0;s<u.length;s++){var a=u[s],c=i[a]._subplot;!o[a]&&c&&(c.plotContainer.remove(),c.clipDef.remove(),c.clipDefRelative.remove(),c.layers["a-title"].remove(),c.layers["b-title"].remove(),c.layers["c-title"].remove())}}},{"../../lib":778,"../../plots/get_data":865,"./layout_attributes":908,"./layout_defaults":909,"./ternary":910}],908:[function(n,z,q){"use strict";var t=n("../../components/color/attributes"),h=n("../domain").attributes,p=n("../cartesian/layout_attributes"),l=n("../../plot_api/edit_types").overrideAll,e=n("../../lib/extend").extendFlat,o={title:{text:p.title.text,font:p.title.font},color:p.color,tickmode:p.tickmode,nticks:e({},p.nticks,{dflt:6,min:1}),tick0:p.tick0,dtick:p.dtick,tickvals:p.tickvals,ticktext:p.ticktext,ticks:p.ticks,ticklen:p.ticklen,tickwidth:p.tickwidth,tickcolor:p.tickcolor,showticklabels:p.showticklabels,showtickprefix:p.showtickprefix,tickprefix:p.tickprefix,showticksuffix:p.showticksuffix,ticksuffix:p.ticksuffix,showexponent:p.showexponent,exponentformat:p.exponentformat,minexponent:p.minexponent,separatethousands:p.separatethousands,tickfont:p.tickfont,tickangle:p.tickangle,tickformat:p.tickformat,tickformatstops:p.tickformatstops,hoverformat:p.hoverformat,showline:e({},p.showline,{dflt:!0}),linecolor:p.linecolor,linewidth:p.linewidth,showgrid:e({},p.showgrid,{dflt:!0}),gridcolor:p.gridcolor,gridwidth:p.gridwidth,layer:p.layer,min:{valType:"number",dflt:0,min:0},_deprecated:{title:p._deprecated.title,titlefont:p._deprecated.titlefont}},r=z.exports=l({domain:h({name:"ternary"}),bgcolor:{valType:"color",dflt:t.background},sum:{valType:"number",dflt:1,min:0},aaxis:o,baxis:o,caxis:o},"plot","from-root");r.uirevision={valType:"any",editType:"none"},r.aaxis.uirevision=r.baxis.uirevision=r.caxis.uirevision={valType:"any",editType:"none"}},{"../../components/color/attributes":642,"../../lib/extend":768,"../../plot_api/edit_types":810,"../cartesian/layout_attributes":842,"../domain":855}],909:[function(n,z,q){"use strict";var t=n("../../components/color"),h=n("../../plot_api/plot_template"),p=n("../../lib"),l=n("../subplot_defaults"),e=n("../cartesian/tick_label_defaults"),o=n("../cartesian/tick_mark_defaults"),r=n("../cartesian/tick_value_defaults"),i=n("../cartesian/line_grid_defaults"),u=n("./layout_attributes"),s=["aaxis","baxis","caxis"];function a(f,g,d,m){var y,v,T,w=d("bgcolor"),A=d("sum");m.bgColor=t.combine(w,m.paper_bgcolor);for(var E=0;E<s.length;E++)v=f[y=s[E]]||{},(T=h.newContainer(g,y))._name=y,c(v,T,m,g);var M=g.aaxis,b=g.baxis,_=g.caxis;M.min+b.min+_.min>=A&&(M.min=0,b.min=0,_.min=0,f.aaxis&&delete f.aaxis.min,f.baxis&&delete f.baxis.min,f.caxis&&delete f.caxis.min)}function c(f,g,d,m){var y=u[g._name];function v(b,_){return p.coerce(f,g,y,b,_)}v("uirevision",m.uirevision),g.type="linear";var T=v("color"),w=T!==y.color.dflt?T:d.font.color,A=g._name.charAt(0).toUpperCase(),E="Component "+A,M=v("title.text",E);g._hovertitle=M===E?M:A,p.coerceFont(v,"title.font",{family:d.font.family,size:Math.round(1.2*d.font.size),color:w}),v("min"),r(f,g,v,"linear"),e(f,g,v,"linear",{}),o(f,g,v,{outerTicks:!0}),v("showticklabels")&&(p.coerceFont(v,"tickfont",{family:d.font.family,size:d.font.size,color:w}),v("tickangle"),v("tickformat")),i(f,g,v,{dfltColor:T,bgColor:d.bgColor,blend:60,showLine:!0,showGrid:!0,noZeroLine:!0,attributes:y}),v("hoverformat"),v("layer")}z.exports=function(f,g,d){l(f,g,d,{type:"ternary",attributes:u,handleDefaults:a,font:g.font,paper_bgcolor:g.paper_bgcolor})}},{"../../components/color":643,"../../lib":778,"../../plot_api/plot_template":817,"../cartesian/line_grid_defaults":844,"../cartesian/tick_label_defaults":849,"../cartesian/tick_mark_defaults":850,"../cartesian/tick_value_defaults":851,"../subplot_defaults":905,"./layout_attributes":908}],910:[function(n,z,q){"use strict";var t=n("d3"),h=n("tinycolor2"),p=n("../../registry"),l=n("../../lib"),e=l.strTranslate,o=l._,r=n("../../components/color"),i=n("../../components/drawing"),u=n("../cartesian/set_convert"),s=n("../../lib/extend").extendFlat,a=n("../plots"),c=n("../cartesian/axes"),f=n("../../components/dragelement"),g=n("../../components/fx"),d=n("../../components/dragelement/helpers"),m=d.freeMode,y=d.rectMode,v=n("../../components/titles"),T=n("../cartesian/select").prepSelect,w=n("../cartesian/select").selectOnClick,A=n("../cartesian/select").clearSelect,E=n("../cartesian/select").clearSelectionsCache,M=n("../cartesian/constants");function b(O,J){this.id=O.id,this.graphDiv=O.graphDiv,this.init(J),this.makeFramework(J),this.aTickLayout=null,this.bTickLayout=null,this.cTickLayout=null}z.exports=b;var _=b.prototype;_.init=function(O){this.container=O._ternarylayer,this.defs=O._defs,this.layoutId=O._uid,this.traceHash={},this.layers={}},_.plot=function(O,J){var D=J[this.id],B=J._size;this._hasClipOnAxisFalse=!1;for(var N=0;N<O.length;N++)if(O[N][0].trace.cliponaxis===!1){this._hasClipOnAxisFalse=!0;break}this.updateLayers(D),this.adjustLayout(D,B),a.generalUpdatePerTraceModule(this.graphDiv,this,O,D),this.layers.plotbg.select("path").call(r.fill,D.bgcolor)},_.makeFramework=function(O){var J=this.graphDiv,D=O[this.id],B=this.clipId="clip"+this.layoutId+this.id,N=this.clipIdRelative="clip-relative"+this.layoutId+this.id;this.clipDef=l.ensureSingleById(O._clips,"clipPath",B,function(F){F.append("path").attr("d","M0,0Z")}),this.clipDefRelative=l.ensureSingleById(O._clips,"clipPath",N,function(F){F.append("path").attr("d","M0,0Z")}),this.plotContainer=l.ensureSingle(this.container,"g",this.id),this.updateLayers(D),i.setClipUrl(this.layers.backplot,B,J),i.setClipUrl(this.layers.grids,B,J)},_.updateLayers=function(O){var J=this.layers,D=["draglayer","plotbg","backplot","grids"];O.aaxis.layer==="below traces"&&D.push("aaxis","aline"),O.baxis.layer==="below traces"&&D.push("baxis","bline"),O.caxis.layer==="below traces"&&D.push("caxis","cline"),D.push("frontplot"),O.aaxis.layer==="above traces"&&D.push("aaxis","aline"),O.baxis.layer==="above traces"&&D.push("baxis","bline"),O.caxis.layer==="above traces"&&D.push("caxis","cline");var B=this.plotContainer.selectAll("g.toplevel").data(D,String),N=["agrid","bgrid","cgrid"];B.enter().append("g").attr("class",function(F){return"toplevel "+F}).each(function(F){var H=t.select(this);J[F]=H,F==="frontplot"?H.append("g").classed("scatterlayer",!0):F==="backplot"?H.append("g").classed("maplayer",!0):F==="plotbg"?H.append("path").attr("d","M0,0Z"):F==="aline"||F==="bline"||F==="cline"?H.append("path"):F==="grids"&&N.forEach(function(j){J[j]=H.append("g").classed("grid "+j,!0)})}),B.order()};var S=Math.sqrt(4/3);_.adjustLayout=function(O,J){var D,B,N,F,H,j,G=this,W=O.domain,Q=(W.x[0]+W.x[1])/2,$=(W.y[0]+W.y[1])/2,ee=W.x[1]-W.x[0],ie=W.y[1]-W.y[0],ae=ee*J.w,oe=ie*J.h,de=O.sum,le=O.aaxis.min,fe=O.baxis.min,ue=O.caxis.min;ae>S*oe?N=(F=oe)*S:F=(N=ae)/S,H=ee*N/ae,j=ie*F/oe,D=J.l+J.w*Q-N/2,B=J.t+J.h*(1-$)-F/2,G.x0=D,G.y0=B,G.w=N,G.h=F,G.sum=de,G.xaxis={type:"linear",range:[le+2*ue-de,de-le-2*fe],domain:[Q-H/2,Q+H/2],_id:"x"},u(G.xaxis,G.graphDiv._fullLayout),G.xaxis.setScale(),G.xaxis.isPtWithinRange=function(Fe){return Fe.a>=G.aaxis.range[0]&&Fe.a<=G.aaxis.range[1]&&Fe.b>=G.baxis.range[1]&&Fe.b<=G.baxis.range[0]&&Fe.c>=G.caxis.range[1]&&Fe.c<=G.caxis.range[0]},G.yaxis={type:"linear",range:[le,de-fe-ue],domain:[$-j/2,$+j/2],_id:"y"},u(G.yaxis,G.graphDiv._fullLayout),G.yaxis.setScale(),G.yaxis.isPtWithinRange=function(){return!0};var we=G.yaxis.domain[0],Ae=G.aaxis=s({},O.aaxis,{range:[le,de-fe-ue],side:"left",tickangle:(+O.aaxis.tickangle||0)-30,domain:[we,we+j*S],anchor:"free",position:0,_id:"y",_length:N});u(Ae,G.graphDiv._fullLayout),Ae.setScale();var Se=G.baxis=s({},O.baxis,{range:[de-le-ue,fe],side:"bottom",domain:G.xaxis.domain,anchor:"free",position:0,_id:"x",_length:N});u(Se,G.graphDiv._fullLayout),Se.setScale();var ke=G.caxis=s({},O.caxis,{range:[de-le-fe,ue],side:"right",tickangle:(+O.caxis.tickangle||0)+30,domain:[we,we+j*S],anchor:"free",position:0,_id:"y",_length:N});u(ke,G.graphDiv._fullLayout),ke.setScale();var Me="M"+D+","+(B+F)+"h"+N+"l-"+N/2+",-"+F+"Z";G.clipDef.select("path").attr("d",Me),G.layers.plotbg.select("path").attr("d",Me);var ve="M0,"+F+"h"+N+"l-"+N/2+",-"+F+"Z";G.clipDefRelative.select("path").attr("d",ve);var ge=e(D,B);G.plotContainer.selectAll(".scatterlayer,.maplayer").attr("transform",ge),G.clipDefRelative.select("path").attr("transform",null);var De=e(D-Se._offset,B+F);G.layers.baxis.attr("transform",De),G.layers.bgrid.attr("transform",De);var _e=e(D+N/2,B)+"rotate(30)"+e(0,-Ae._offset);G.layers.aaxis.attr("transform",_e),G.layers.agrid.attr("transform",_e);var Pe=e(D+N/2,B)+"rotate(-30)"+e(0,-ke._offset);G.layers.caxis.attr("transform",Pe),G.layers.cgrid.attr("transform",Pe),G.drawAxes(!0),G.layers.aline.select("path").attr("d",Ae.showline?"M"+D+","+(B+F)+"l"+N/2+",-"+F:"M0,0").call(r.stroke,Ae.linecolor||"#000").style("stroke-width",(Ae.linewidth||0)+"px"),G.layers.bline.select("path").attr("d",Se.showline?"M"+D+","+(B+F)+"h"+N:"M0,0").call(r.stroke,Se.linecolor||"#000").style("stroke-width",(Se.linewidth||0)+"px"),G.layers.cline.select("path").attr("d",ke.showline?"M"+(D+N/2)+","+B+"l"+N/2+","+F:"M0,0").call(r.stroke,ke.linecolor||"#000").style("stroke-width",(ke.linewidth||0)+"px"),G.graphDiv._context.staticPlot||G.initInteractions(),i.setClipUrl(G.layers.frontplot,G._hasClipOnAxisFalse?null:G.clipId,G.graphDiv)},_.drawAxes=function(O){var J=this.graphDiv,D=this.id.substr(7)+"title",B=this.layers,N=this.aaxis,F=this.baxis,H=this.caxis;if(this.drawAx(N),this.drawAx(F),this.drawAx(H),O){var j=Math.max(N.showticklabels?N.tickfont.size/2:0,(H.showticklabels?.75*H.tickfont.size:0)+(H.ticks==="outside"?.87*H.ticklen:0)),G=(F.showticklabels?F.tickfont.size:0)+(F.ticks==="outside"?F.ticklen:0)+3;B["a-title"]=v.draw(J,"a"+D,{propContainer:N,propName:this.id+".aaxis.title",placeholder:o(J,"Click to enter Component A title"),attributes:{x:this.x0+this.w/2,y:this.y0-N.title.font.size/3-j,"text-anchor":"middle"}}),B["b-title"]=v.draw(J,"b"+D,{propContainer:F,propName:this.id+".baxis.title",placeholder:o(J,"Click to enter Component B title"),attributes:{x:this.x0-G,y:this.y0+this.h+.83*F.title.font.size+G,"text-anchor":"middle"}}),B["c-title"]=v.draw(J,"c"+D,{propContainer:H,propName:this.id+".caxis.title",placeholder:o(J,"Click to enter Component C title"),attributes:{x:this.x0+this.w+G,y:this.y0+this.h+.83*H.title.font.size+G,"text-anchor":"middle"}})}},_.drawAx=function(O){var J,D=this.graphDiv,B=O._name,N=B.charAt(0),F=O._id,H=this.layers[B],j=N+"tickLayout",G=(J=O).ticks+String(J.ticklen)+String(J.showticklabels);this[j]!==G&&(H.selectAll("."+F+"tick").remove(),this[j]=G),O.setScale();var W=c.calcTicks(O),Q=c.clipEnds(O,W),$=c.makeTransTickFn(O),ee=c.getTickSigns(O)[2],ie=l.deg2rad(30),ae=ee*(O.linewidth||1)/2,oe=ee*O.ticklen,de=this.w,le=this.h,fe=N==="b"?"M0,"+ae+"l"+Math.sin(ie)*oe+","+Math.cos(ie)*oe:"M"+ae+",0l"+Math.cos(ie)*oe+","+-Math.sin(ie)*oe,ue={a:"M0,0l"+le+",-"+de/2,b:"M0,0l-"+de/2+",-"+le,c:"M0,0l-"+le+","+de/2}[N];c.drawTicks(D,O,{vals:O.ticks==="inside"?Q:W,layer:H,path:fe,transFn:$,crisp:!1}),c.drawGrid(D,O,{vals:Q,layer:this.layers[N+"grid"],path:ue,transFn:$,crisp:!1}),c.drawLabels(D,O,{vals:W,layer:H,transFn:$,labelFns:c.makeLabelFns(O,0,30)})};var C=M.MINZOOM/2+.87,k="m-0.87,.5h"+C+"v3h-"+(C+5.2)+"l"+(C/2+2.6)+",-"+(.87*C+4.5)+"l2.6,1.5l-"+C/2+","+.87*C+"Z",L="m0.87,.5h-"+C+"v3h"+(C+5.2)+"l-"+(C/2+2.6)+",-"+(.87*C+4.5)+"l-2.6,1.5l"+C/2+","+.87*C+"Z",I="m0,1l"+C/2+","+.87*C+"l2.6,-1.5l-"+(C/2+2.6)+",-"+(.87*C+4.5)+"l-"+(C/2+2.6)+","+(.87*C+4.5)+"l2.6,1.5l"+C/2+",-"+.87*C+"Z",R=!0;function V(O){t.select(O).selectAll(".zoombox,.js-zoombox-backdrop,.js-zoombox-menu,.zoombox-corners").remove()}_.clearSelect=function(){E(this.dragOptions),A(this.dragOptions.gd)},_.initInteractions=function(){var O,J,D,B,N,F,H,j,G,W,Q,$,ee=this,ie=ee.layers.plotbg.select("path").node(),ae=ee.graphDiv,oe=ae._fullLayout._zoomlayer;function de(ve){var ge={};return ge[ee.id+".aaxis.min"]=ve.a,ge[ee.id+".baxis.min"]=ve.b,ge[ee.id+".caxis.min"]=ve.c,ge}function le(ve,ge){var De=ae._fullLayout.clickmode;V(ae),ve===2&&(ae.emit("plotly_doubleclick",null),p.call("_guiRelayout",ae,de({a:0,b:0,c:0}))),De.indexOf("select")>-1&&ve===1&&w(ge,ae,[ee.xaxis],[ee.yaxis],ee.id,ee.dragOptions),De.indexOf("event")>-1&&g.click(ae,ge,ee.id)}function fe(ve,ge){return 1-ge/ee.h}function ue(ve,ge){return 1-(ve+(ee.h-ge)/Math.sqrt(3))/ee.w}function we(ve,ge){return(ve-(ee.h-ge)/Math.sqrt(3))/ee.w}function Ae(ve,ge){var De=D+ve*O,_e=B+ge*J,Pe=Math.max(0,Math.min(1,fe(0,B),fe(0,_e))),Fe=Math.max(0,Math.min(1,ue(D,B),ue(De,_e))),ze=Math.max(0,Math.min(1,we(D,B),we(De,_e))),He=(Pe/2+ze)*ee.w,et=(1-Pe/2-Fe)*ee.w,Re=(He+et)/2,Ze=et-He,Ke=(1-Pe)*ee.h,$e=Ke-Ze/S;Ze<M.MINZOOM?(H=N,Q.attr("d",G),$.attr("d","M0,0Z")):(H={a:N.a+Pe*F,b:N.b+Fe*F,c:N.c+ze*F},Q.attr("d",G+"M"+He+","+Ke+"H"+et+"L"+Re+","+$e+"L"+He+","+Ke+"Z"),$.attr("d","M"+D+","+B+"m0.5,0.5h5v-2h-5v-5h-2v5h-5v2h5v5h2ZM"+He+","+Ke+k+"M"+et+","+Ke+L+"M"+Re+","+$e+I)),W||(Q.transition().style("fill",j>.2?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.3)").duration(200),$.transition().style("opacity",1).duration(200),W=!0),ae.emit("plotly_relayouting",de(H))}function Se(){V(ae),H!==N&&(p.call("_guiRelayout",ae,de(H)),R&&ae.data&&ae._context.showTips&&(l.notifier(o(ae,"Double-click to zoom back out"),"long"),R=!1))}function ke(ve,ge){var De=ve/ee.xaxis._m,_e=ge/ee.yaxis._m,Pe=[(H={a:N.a-_e,b:N.b+(De+_e)/2,c:N.c-(De-_e)/2}).a,H.b,H.c].sort(l.sorterAsc),Fe=Pe.indexOf(H.a),ze=Pe.indexOf(H.b),He=Pe.indexOf(H.c);Pe[0]<0&&(Pe[1]+Pe[0]/2<0?(Pe[2]+=Pe[0]+Pe[1],Pe[0]=Pe[1]=0):(Pe[2]+=Pe[0]/2,Pe[1]+=Pe[0]/2,Pe[0]=0),H={a:Pe[Fe],b:Pe[ze],c:Pe[He]},ge=(N.a-H.a)*ee.yaxis._m,ve=(N.c-H.c-N.b+H.b)*ee.xaxis._m);var et=e(ee.x0+ve,ee.y0+ge);ee.plotContainer.selectAll(".scatterlayer,.maplayer").attr("transform",et);var Re=e(-ve,-ge);ee.clipDefRelative.select("path").attr("transform",Re),ee.aaxis.range=[H.a,ee.sum-H.b-H.c],ee.baxis.range=[ee.sum-H.a-H.c,H.b],ee.caxis.range=[ee.sum-H.a-H.b,H.c],ee.drawAxes(!1),ee._hasClipOnAxisFalse&&ee.plotContainer.select(".scatterlayer").selectAll(".trace").call(i.hideOutsideRangePoints,ee),ae.emit("plotly_relayouting",de(H))}function Me(){p.call("_guiRelayout",ae,de(H))}this.dragOptions={element:ie,gd:ae,plotinfo:{id:ee.id,domain:ae._fullLayout[ee.id].domain,xaxis:ee.xaxis,yaxis:ee.yaxis},subplot:ee.id,prepFn:function(ve,ge,De){ee.dragOptions.xaxes=[ee.xaxis],ee.dragOptions.yaxes=[ee.yaxis],O=ae._fullLayout._invScaleX,J=ae._fullLayout._invScaleY;var _e=ee.dragOptions.dragmode=ae._fullLayout.dragmode;m(_e)?ee.dragOptions.minDrag=1:ee.dragOptions.minDrag=void 0,_e==="zoom"?(ee.dragOptions.moveFn=Ae,ee.dragOptions.clickFn=le,ee.dragOptions.doneFn=Se,function(Pe,Fe,ze){var He=ie.getBoundingClientRect();D=Fe-He.left,B=ze-He.top,ae._fullLayout._calcInverseTransform(ae);var et=ae._fullLayout._invTransform,Re=l.apply3DTransform(et)(D,B);D=Re[0],B=Re[1],N={a:ee.aaxis.range[0],b:ee.baxis.range[1],c:ee.caxis.range[1]},H=N,F=ee.aaxis.range[1]-N.a,j=h(ee.graphDiv._fullLayout[ee.id].bgcolor).getLuminance(),G="M0,"+ee.h+"L"+ee.w/2+", 0L"+ee.w+","+ee.h+"Z",W=!1,Q=oe.append("path").attr("class","zoombox").attr("transform",e(ee.x0,ee.y0)).style({fill:j>.2?"rgba(0,0,0,0)":"rgba(255,255,255,0)","stroke-width":0}).attr("d",G),$=oe.append("path").attr("class","zoombox-corners").attr("transform",e(ee.x0,ee.y0)).style({fill:r.background,stroke:r.defaultLine,"stroke-width":1,opacity:0}).attr("d","M0,0Z"),ee.clearSelect(ae)}(0,ge,De)):_e==="pan"?(ee.dragOptions.moveFn=ke,ee.dragOptions.clickFn=le,ee.dragOptions.doneFn=Me,N={a:ee.aaxis.range[0],b:ee.baxis.range[1],c:ee.caxis.range[1]},H=N,ee.clearSelect(ae)):(y(_e)||m(_e))&&T(ve,ge,De,ee.dragOptions,_e)}},ie.onmousemove=function(ve){g.hover(ae,ve,ee.id),ae._fullLayout._lasthover=ie,ae._fullLayout._hoversubplot=ee.id},ie.onmouseout=function(ve){ae._dragging||f.unhover(ae,ve)},f.init(this.dragOptions)}},{"../../components/color":643,"../../components/dragelement":662,"../../components/dragelement/helpers":661,"../../components/drawing":665,"../../components/fx":683,"../../components/titles":738,"../../lib":778,"../../lib/extend":768,"../../registry":911,"../cartesian/axes":828,"../cartesian/constants":834,"../cartesian/select":847,"../cartesian/set_convert":848,"../plots":891,d3:169,tinycolor2:576}],911:[function(n,z,q){"use strict";var t=n("./lib/loggers"),h=n("./lib/noop"),p=n("./lib/push_unique"),l=n("./lib/is_plain_object"),e=n("./lib/dom").addStyleRule,o=n("./lib/extend"),r=n("./plots/attributes"),i=n("./plots/layout_attributes"),u=o.extendFlat,s=o.extendDeepAll;function a(w){var A=w.name,E=w.categories,M=w.meta;if(q.modules[A])t.log("Type "+A+" already registered");else{q.subplotsRegistry[w.basePlotModule.name]||function(R){var V=R.name;if(q.subplotsRegistry[V])return void t.log("Plot type "+V+" already registered.");for(var O in d(R),q.subplotsRegistry[V]=R,q.componentsRegistry)v(O,R.name)}(w.basePlotModule);for(var b={},_=0;_<E.length;_++)b[E[_]]=!0,q.allCategories[E[_]]=!0;for(var S in q.modules[A]={_module:w,categories:b},M&&Object.keys(M).length&&(q.modules[A].meta=M),q.allTypes.push(A),q.componentsRegistry)m(S,A);w.layoutAttributes&&u(q.traceLayoutAttributes,w.layoutAttributes);var C=w.basePlotModule,k=C.name;if(k==="mapbox"){var L=C.constants.styleRules;for(var I in L)e(".js-plotly-plot .plotly .mapboxgl-"+I,L[I])}k!=="geo"&&k!=="mapbox"||typeof window===void 0||window.PlotlyGeoAssets!==void 0||(window.PlotlyGeoAssets={topojson:{}})}}function c(w){if(typeof w.name!="string")throw new Error("Component module *name* must be a string.");var A=w.name;for(var E in q.componentsRegistry[A]=w,w.layoutAttributes&&(w.layoutAttributes._isLinkedToArray&&p(q.layoutArrayContainers,A),d(w)),q.modules)m(A,E);for(var M in q.subplotsRegistry)v(A,M);for(var b in q.transformsRegistry)y(A,b);w.schema&&w.schema.layout&&s(i,w.schema.layout)}function f(w){if(typeof w.name!="string")throw new Error("Transform module *name* must be a string.");var A="Transform module "+w.name,E=typeof w.transform=="function",M=typeof w.calcTransform=="function";if(!E&&!M)throw new Error(A+" is missing a *transform* or *calcTransform* method.");for(var b in E&&M&&t.log([A+" has both a *transform* and *calcTransform* methods.","Please note that all *transform* methods are executed","before all *calcTransform* methods."].join(" ")),l(w.attributes)||t.log(A+" registered without an *attributes* object."),typeof w.supplyDefaults!="function"&&t.log(A+" registered without a *supplyDefaults* method."),q.transformsRegistry[w.name]=w,q.componentsRegistry)y(b,w.name)}function g(w){var A=w.name,E=A.split("-")[0],M=w.dictionary,b=w.format,_=M&&Object.keys(M).length,S=b&&Object.keys(b).length,C=q.localeRegistry,k=C[A];if(k||(C[A]=k={}),E!==A){var L=C[E];L||(C[E]=L={}),_&&L.dictionary===k.dictionary&&(L.dictionary=M),S&&L.format===k.format&&(L.format=b)}_&&(k.dictionary=M),S&&(k.format=b)}function d(w){if(w.layoutAttributes){var A=w.layoutAttributes._arrayAttrRegexps;if(A)for(var E=0;E<A.length;E++)p(q.layoutArrayRegexes,A[E])}}function m(w,A){var E=q.componentsRegistry[w].schema;if(E&&E.traces){var M=E.traces[A];M&&s(q.modules[A]._module.attributes,M)}}function y(w,A){var E=q.componentsRegistry[w].schema;if(E&&E.transforms){var M=E.transforms[A];M&&s(q.transformsRegistry[A].attributes,M)}}function v(w,A){var E=q.componentsRegistry[w].schema;if(E&&E.subplots){var M=q.subplotsRegistry[A],b=M.layoutAttributes,_=M.attr==="subplot"?M.name:M.attr;Array.isArray(_)&&(_=_[0]);var S=E.subplots[_];b&&S&&s(b,S)}}function T(w){return typeof w=="object"&&(w=w.type),w}q.modules={},q.allCategories={},q.allTypes=[],q.subplotsRegistry={},q.transformsRegistry={},q.componentsRegistry={},q.layoutArrayContainers=[],q.layoutArrayRegexes=[],q.traceLayoutAttributes={},q.localeRegistry={},q.apiMethodRegistry={},q.collectableSubplotTypes=null,q.register=function(w){if(q.collectableSubplotTypes=null,!w)throw new Error("No argument passed to Plotly.register.");w&&!Array.isArray(w)&&(w=[w]);for(var A=0;A<w.length;A++){var E=w[A];if(!E)throw new Error("Invalid module was attempted to be registered!");switch(E.moduleType){case"trace":a(E);break;case"transform":f(E);break;case"component":c(E);break;case"locale":g(E);break;case"apiMethod":var M=E.name;q.apiMethodRegistry[M]=E.fn;break;default:throw new Error("Invalid module was attempted to be registered!")}}},q.getModule=function(w){var A=q.modules[T(w)];return!!A&&A._module},q.traceIs=function(w,A){if((w=T(w))==="various")return!1;var E=q.modules[w];return E||(w&&w!=="area"&&t.log("Unrecognized trace type "+w+"."),E=q.modules[r.type.dflt]),!!E.categories[A]},q.getTransformIndices=function(w,A){for(var E=[],M=w.transforms||[],b=0;b<M.length;b++)M[b].type===A&&E.push(b);return E},q.hasTransform=function(w,A){for(var E=w.transforms||[],M=0;M<E.length;M++)if(E[M].type===A)return!0;return!1},q.getComponentMethod=function(w,A){var E=q.componentsRegistry[w];return E&&E[A]||h},q.call=function(){var w=arguments[0],A=[].slice.call(arguments,1);return q.apiMethodRegistry[w].apply(null,A)}},{"./lib/dom":766,"./lib/extend":768,"./lib/is_plain_object":779,"./lib/loggers":782,"./lib/noop":787,"./lib/push_unique":793,"./plots/attributes":824,"./plots/layout_attributes":882}],912:[function(n,z,q){"use strict";var t=n("../registry"),h=n("../lib"),p=h.extendFlat,l=h.extendDeep;function e(o){var r;switch(o){case"themes__thumb":r={autosize:!0,width:150,height:150,title:{text:""},showlegend:!1,margin:{l:5,r:5,t:5,b:5,pad:0},annotations:[]};break;case"thumbnail":r={title:{text:""},hidesources:!0,showlegend:!1,borderwidth:0,bordercolor:"",margin:{l:1,r:1,t:1,b:1,pad:0},annotations:[]};break;default:r={}}return r}z.exports=function(o,r){var i;o.framework&&o.framework.isPolar&&(o=o.framework.getConfig());var u,s=o.data,a=o.layout,c=l([],s),f=l({},a,e(r.tileClass)),g=o._context||{};if(r.width&&(f.width=r.width),r.height&&(f.height=r.height),r.tileClass==="thumbnail"||r.tileClass==="themes__thumb"){f.annotations=[];var d=Object.keys(f);for(i=0;i<d.length;i++)u=d[i],["xaxis","yaxis","zaxis"].indexOf(u.slice(0,5))>-1&&(f[d[i]].title={text:""});for(i=0;i<c.length;i++){var m=c[i];m.showscale=!1,m.marker&&(m.marker.showscale=!1),t.traceIs(m,"pie-like")&&(m.textposition="none")}}if(Array.isArray(r.annotations))for(i=0;i<r.annotations.length;i++)f.annotations.push(r.annotations[i]);var y=Object.keys(f).filter(function(E){return E.match(/^scene\d*$/)});if(y.length){var v={};for(r.tileClass==="thumbnail"&&(v={title:{text:""},showaxeslabels:!1,showticklabels:!1,linetickenable:!1}),i=0;i<y.length;i++){var T=f[y[i]];T.xaxis||(T.xaxis={}),T.yaxis||(T.yaxis={}),T.zaxis||(T.zaxis={}),p(T.xaxis,v),p(T.yaxis,v),p(T.zaxis,v),T._scene=null}}var w=document.createElement("div");r.tileClass&&(w.className=r.tileClass);var A={gd:w,td:w,layout:f,data:c,config:{staticPlot:r.staticPlot===void 0||r.staticPlot,plotGlPixelRatio:r.plotGlPixelRatio===void 0?2:r.plotGlPixelRatio,displaylogo:r.displaylogo||!1,showLink:r.showLink||!1,showTips:r.showTips||!1,mapboxAccessToken:g.mapboxAccessToken}};return r.setBackground!=="transparent"&&(A.config.setBackground=r.setBackground||"opaque"),A.gd.defaultLayout=e(r.tileClass),A}},{"../lib":778,"../registry":911}],913:[function(n,z,q){"use strict";var t=n("../lib"),h=n("../plot_api/to_image"),p=n("./filesaver"),l=n("./helpers");z.exports=function(e,o){var r;return t.isPlainObject(e)||(r=t.getGraphDiv(e)),(o=o||{}).format=o.format||"png",o.width=o.width||null,o.height=o.height||null,o.imageDataOnly=!0,new Promise(function(i,u){r&&r._snapshotInProgress&&u(new Error("Snapshotting already in progress.")),t.isIE()&&o.format!=="svg"&&u(new Error(l.MSG_IE_BAD_FORMAT)),r&&(r._snapshotInProgress=!0);var s=h(e,o),a=o.filename||e.fn||"newplot";a+="."+o.format.replace("-","."),s.then(function(c){return r&&(r._snapshotInProgress=!1),p(c,a,o.format)}).then(function(c){i(c)}).catch(function(c){r&&(r._snapshotInProgress=!1),u(c)})})}},{"../lib":778,"../plot_api/to_image":820,"./filesaver":914,"./helpers":915}],914:[function(n,z,q){"use strict";var t=n("../lib"),h=n("./helpers");z.exports=function(p,l,e){var o=document.createElement("a"),r="download"in o;return new Promise(function(i,u){var s,a;if(t.isIE9orBelow()&&u(new Error("IE < 10 unsupported")),t.isSafari()){var c=e==="svg"?",":";base64,";return h.octetStream(c+encodeURIComponent(p)),i(l)}return t.isIE()?(s=h.createBlob(p,"svg"),window.navigator.msSaveBlob(s,l),s=null,i(l)):r?(s=h.createBlob(p,e),a=h.createObjectURL(s),o.href=a,o.download=l,document.body.appendChild(o),o.click(),document.body.removeChild(o),h.revokeObjectURL(a),s=null,i(l)):void u(new Error("download error"))})}},{"../lib":778,"./helpers":915}],915:[function(n,z,q){"use strict";var t=n("../registry");q.getDelay=function(p){return p._has&&(p._has("gl3d")||p._has("gl2d")||p._has("mapbox"))?500:0},q.getRedrawFunc=function(p){return function(){var l=p._fullLayout||{};!(l._has&&l._has("polar"))&&p.data&&p.data[0]&&p.data[0].r||t.getComponentMethod("colorbar","draw")(p)}},q.encodeSVG=function(p){return"data:image/svg+xml,"+encodeURIComponent(p)},q.encodeJSON=function(p){return"data:application/json,"+encodeURIComponent(p)};var h=window.URL||window.webkitURL;q.createObjectURL=function(p){return h.createObjectURL(p)},q.revokeObjectURL=function(p){return h.revokeObjectURL(p)},q.createBlob=function(p,l){if(l==="svg")return new window.Blob([p],{type:"image/svg+xml;charset=utf-8"});if(l==="full-json")return new window.Blob([p],{type:"application/json;charset=utf-8"});var e=function(o){for(var r=o.length,i=new ArrayBuffer(r),u=new Uint8Array(i),s=0;s<r;s++)u[s]=o.charCodeAt(s);return i}(window.atob(p));return new window.Blob([e],{type:"image/"+l})},q.octetStream=function(p){document.location.href="data:application/octet-stream"+p},q.IMAGE_URL_PREFIX=/^data:image\/\w+;base64,/,q.MSG_IE_BAD_FORMAT="Sorry IE does not support downloading from canvas. Try {format:'svg'} instead."},{"../registry":911}],916:[function(n,z,q){"use strict";var t=n("./helpers"),h={getDelay:t.getDelay,getRedrawFunc:t.getRedrawFunc,clone:n("./cloneplot"),toSVG:n("./tosvg"),svgToImg:n("./svgtoimg"),toImage:n("./toimage"),downloadImage:n("./download")};z.exports=h},{"./cloneplot":912,"./download":913,"./helpers":915,"./svgtoimg":917,"./toimage":918,"./tosvg":919}],917:[function(n,z,q){"use strict";var t=n("../lib"),h=n("events").EventEmitter,p=n("./helpers");z.exports=function(l){var e=l.emitter||new h,o=new Promise(function(r,i){var u=window.Image,s=l.svg,a=l.format||"png";if(t.isIE()&&a!=="svg"){var c=new Error(p.MSG_IE_BAD_FORMAT);return i(c),l.promise?o:e.emit("error",c)}var f,g,d=l.canvas,m=l.scale||1,y=l.width||300,v=l.height||150,T=m*y,w=m*v,A=d.getContext("2d"),E=new u;a==="svg"||t.isIE9orBelow()||t.isSafari()?g=p.encodeSVG(s):(f=p.createBlob(s,"svg"),g=p.createObjectURL(f)),d.width=T,d.height=w,E.onload=function(){var M;switch(f=null,p.revokeObjectURL(g),a!=="svg"&&A.drawImage(E,0,0,T,w),a){case"jpeg":M=d.toDataURL("image/jpeg");break;case"png":M=d.toDataURL("image/png");break;case"webp":M=d.toDataURL("image/webp");break;case"svg":M=g;break;default:var b="Image format is not jpeg, png, svg or webp.";if(i(new Error(b)),!l.promise)return e.emit("error",b)}r(M),l.promise||e.emit("success",M)},E.onerror=function(M){if(f=null,p.revokeObjectURL(g),i(M),!l.promise)return e.emit("error",M)},E.src=g});return l.promise?o:e}},{"../lib":778,"./helpers":915,events:110}],918:[function(n,z,q){"use strict";var t=n("events").EventEmitter,h=n("../registry"),p=n("../lib"),l=n("./helpers"),e=n("./cloneplot"),o=n("./tosvg"),r=n("./svgtoimg");z.exports=function(i,u){var s=new t,a=e(i,{format:"png"}),c=a.gd;c.style.position="absolute",c.style.left="-5000px",document.body.appendChild(c);var f=l.getRedrawFunc(c);return h.call("plot",c,a.data,a.layout,a.config).then(f).then(function(){var g=l.getDelay(c._fullLayout);setTimeout(function(){var d=o(c),m=document.createElement("canvas");m.id=p.randstr(),(s=r({format:u.format,width:c._fullLayout.width,height:c._fullLayout.height,canvas:m,emitter:s,svg:d})).clean=function(){c&&document.body.removeChild(c)}},g)}).catch(function(g){s.emit("error",g)}),s}},{"../lib":778,"../registry":911,"./cloneplot":912,"./helpers":915,"./svgtoimg":917,"./tosvg":919,events:110}],919:[function(n,z,q){"use strict";var t=n("d3"),h=n("../lib"),p=n("../components/drawing"),l=n("../components/color"),e=n("../constants/xmlns_namespaces"),o=/"/g,r=new RegExp('("TOBESTRIPPED)|(TOBESTRIPPED")',"g");z.exports=function(i,u,s){var a,c=i._fullLayout,f=c._paper,g=c._toppaper,d=c.width,m=c.height;f.insert("rect",":first-child").call(p.setRect,0,0,d,m).call(l.fill,c.paper_bgcolor);var y=c._basePlotModules||[];for(a=0;a<y.length;a++){var v=y[a];v.toSVG&&v.toSVG(i)}if(g){var T=g.node().childNodes,w=Array.prototype.slice.call(T);for(a=0;a<w.length;a++){var A=w[a];A.childNodes.length&&f.node().appendChild(A)}}if(c._draggers&&c._draggers.remove(),f.node().style.background="",f.selectAll("text").attr({"data-unformatted":null,"data-math":null}).each(function(){var _=t.select(this);if(this.style.visibility!=="hidden"&&this.style.display!=="none"){_.style({visibility:null,display:null});var S=this.style.fontFamily;S&&S.indexOf('"')!==-1&&_.style("font-family",S.replace(o,"TOBESTRIPPED"))}else _.remove()}),c._gradientUrlQueryParts){var E=[];for(var M in c._gradientUrlQueryParts)E.push(M);E.length&&f.selectAll(E.join(",")).each(function(){var _=t.select(this),S=this.style.fill;S&&S.indexOf("url(")!==-1&&_.style("fill",S.replace(o,"TOBESTRIPPED"));var C=this.style.stroke;C&&C.indexOf("url(")!==-1&&_.style("stroke",C.replace(o,"TOBESTRIPPED"))})}u!=="pdf"&&u!=="eps"||f.selectAll("#MathJax_SVG_glyphs path").attr("stroke-width",0),f.node().setAttributeNS(e.xmlns,"xmlns",e.svg),f.node().setAttributeNS(e.xmlns,"xmlns:xlink",e.xlink),u==="svg"&&s&&(f.attr("width",s*d),f.attr("height",s*m),f.attr("viewBox","0 0 "+d+" "+m));var b=new window.XMLSerializer().serializeToString(f.node());return b=function(_){var S=t.select("body").append("div").style({display:"none"}).html(""),C=_.replace(/(&[^;]*;)/gi,function(k){return k==="&lt;"?"&#60;":k==="&rt;"?"&#62;":k.indexOf("<")!==-1||k.indexOf(">")!==-1?"":S.html(k).text()});return S.remove(),C}(b),b=(b=b.replace(/&(?!\w+;|\#[0-9]+;| \#x[0-9A-F]+;)/g,"&amp;")).replace(r,"'"),h.isIE()&&(b=(b=(b=b.replace(/"/gi,"'")).replace(/(\('#)([^']*)('\))/gi,'("#$2")')).replace(/(\\')/gi,'"')),b}},{"../components/color":643,"../components/drawing":665,"../constants/xmlns_namespaces":754,"../lib":778,d3:169}],920:[function(n,z,q){"use strict";var t=n("../../lib");z.exports=function(h,p){for(var l=0;l<h.length;l++)h[l].i=l;t.mergeArray(p.text,h,"tx"),t.mergeArray(p.hovertext,h,"htx");var e=p.marker;if(e){t.mergeArray(e.opacity,h,"mo",!0),t.mergeArray(e.color,h,"mc");var o=e.line;o&&(t.mergeArray(o.color,h,"mlc"),t.mergeArrayCastPositive(o.width,h,"mlw"))}}},{"../../lib":778}],921:[function(n,z,q){"use strict";var t=n("../scatter/attributes"),h=n("../../plots/template_attributes").hovertemplateAttrs,p=n("../../plots/template_attributes").texttemplateAttrs,l=n("../../components/colorscale/attributes"),e=n("../../plots/font_attributes"),o=n("./constants"),r=n("../../lib/extend").extendFlat,i=e({editType:"calc",arrayOk:!0,colorEditType:"style"}),u=r({},t.marker.line.width,{dflt:0}),s=r({width:u,editType:"calc"},l("marker.line")),a=r({line:s,editType:"calc"},l("marker"),{opacity:{valType:"number",arrayOk:!0,dflt:1,min:0,max:1,editType:"style"}});z.exports={x:t.x,x0:t.x0,dx:t.dx,y:t.y,y0:t.y0,dy:t.dy,xperiod:t.xperiod,yperiod:t.yperiod,xperiod0:t.xperiod0,yperiod0:t.yperiod0,xperiodalignment:t.xperiodalignment,yperiodalignment:t.yperiodalignment,text:t.text,texttemplate:p({editType:"plot"},{keys:o.eventDataKeys}),hovertext:t.hovertext,hovertemplate:h({},{keys:o.eventDataKeys}),textposition:{valType:"enumerated",values:["inside","outside","auto","none"],dflt:"none",arrayOk:!0,editType:"calc"},insidetextanchor:{valType:"enumerated",values:["end","middle","start"],dflt:"end",editType:"plot"},textangle:{valType:"angle",dflt:"auto",editType:"plot"},textfont:r({},i,{}),insidetextfont:r({},i,{}),outsidetextfont:r({},i,{}),constraintext:{valType:"enumerated",values:["inside","outside","both","none"],dflt:"both",editType:"calc"},cliponaxis:r({},t.cliponaxis,{}),orientation:{valType:"enumerated",values:["v","h"],editType:"calc+clearAxisTypes"},base:{valType:"any",dflt:null,arrayOk:!0,editType:"calc"},offset:{valType:"number",dflt:null,arrayOk:!0,editType:"calc"},width:{valType:"number",dflt:null,min:0,arrayOk:!0,editType:"calc"},marker:a,offsetgroup:{valType:"string",dflt:"",editType:"calc"},alignmentgroup:{valType:"string",dflt:"",editType:"calc"},selected:{marker:{opacity:t.selected.marker.opacity,color:t.selected.marker.color,editType:"style"},textfont:t.selected.textfont,editType:"style"},unselected:{marker:{opacity:t.unselected.marker.opacity,color:t.unselected.marker.color,editType:"style"},textfont:t.unselected.textfont,editType:"style"},r:t.r,t:t.t,_deprecated:{bardir:{valType:"enumerated",editType:"calc",values:["v","h"]}}}},{"../../components/colorscale/attributes":650,"../../lib/extend":768,"../../plots/font_attributes":856,"../../plots/template_attributes":906,"../scatter/attributes":1187,"./constants":923}],922:[function(n,z,q){"use strict";var t=n("../../plots/cartesian/axes"),h=n("../../plots/cartesian/align_period"),p=n("../../components/colorscale/helpers").hasColorscale,l=n("../../components/colorscale/calc"),e=n("./arrays_to_calcdata"),o=n("../scatter/calc_selection");z.exports=function(r,i){var u,s,a,c,f=t.getFromId(r,i.xaxis||"x"),g=t.getFromId(r,i.yaxis||"y"),d={msUTC:!(!i.base&&i.base!==0)};i.orientation==="h"?(u=f.makeCalcdata(i,"x",d),a=g.makeCalcdata(i,"y"),s=h(i,g,"y",a),c=!!i.yperiodalignment):(u=g.makeCalcdata(i,"y",d),a=f.makeCalcdata(i,"x"),s=h(i,f,"x",a),c=!!i.xperiodalignment);for(var m=Math.min(s.length,u.length),y=new Array(m),v=0;v<m;v++)y[v]={p:s[v],s:u[v]},c&&(y[v].orig_p=a[v]),i.ids&&(y[v].id=String(i.ids[v]));return p(i,"marker")&&l(r,i,{vals:i.marker.color,containerStr:"marker",cLetter:"c"}),p(i,"marker.line")&&l(r,i,{vals:i.marker.line.color,containerStr:"marker.line",cLetter:"c"}),e(y,i),o(y,i),y}},{"../../components/colorscale/calc":651,"../../components/colorscale/helpers":654,"../../plots/cartesian/align_period":825,"../../plots/cartesian/axes":828,"../scatter/calc_selection":1189,"./arrays_to_calcdata":920}],923:[function(n,z,q){"use strict";z.exports={TEXTPAD:3,eventDataKeys:["value","label"]}},{}],924:[function(n,z,q){"use strict";var t=n("fast-isnumeric"),h=n("../../lib").isArrayOrTypedArray,p=n("../../constants/numerical").BADNUM,l=n("../../registry"),e=n("../../plots/cartesian/axes"),o=n("../../plots/cartesian/constraints").getAxisGroup,r=n("./sieve.js");function i(v,T,w,A,E){if(A.length){var M,b,_,S;switch(function(C,k){var L,I;for(L=0;L<k.length;L++){var R,V=k[L],O=V[0].trace,J=O.type==="funnel"?O._base:O.base,D=O.orientation==="h"?O.xcalendar:O.ycalendar,B=C.type==="category"||C.type==="multicategory"?function(){return null}:C.d2c;if(h(J)){for(I=0;I<Math.min(J.length,V.length);I++)R=B(J[I],0,D),t(R)?(V[I].b=+R,V[I].hasB=1):V[I].b=0;for(;I<V.length;I++)V[I].b=0}else{R=B(J,0,D);var N=t(R);for(R=N?R:0,I=0;I<V.length;I++)V[I].b=R,N&&(V[I].hasB=1)}}}(w,A),E.mode){case"overlay":u(T,w,A,E);break;case"group":for(M=[],b=[],_=0;_<A.length;_++)(S=A[_])[0].trace.offset===void 0?b.push(S):M.push(S);b.length&&function(C,k,L,I,R){var V=new r(I,{sepNegVal:!1,overlapNoMerge:!R.norm});(function(O,J,D,B){for(var N=O._fullLayout,F=D.positions,H=D.distinctPositions,j=D.minDiff,G=D.traces,W=G.length,Q=F.length!==H.length,$=j*(1-B.gap),ee=o(N,J._id)+G[0][0].trace.orientation,ie=N._alignmentOpts[ee]||{},ae=0;ae<W;ae++){var oe,de,le=G[ae],fe=le[0].trace,ue=ie[fe.alignmentgroup]||{},we=Object.keys(ue.offsetGroups||{}).length,Ae=(oe=we?$/we:Q?$/W:$)*(1-(B.groupgap||0));de=we?((2*fe._offsetIndex+1-we)*oe-Ae)/2:Q?((2*ae+1-W)*oe-Ae)/2:-Ae/2;var Se=le[0].t;Se.barwidth=Ae,Se.poffset=de,Se.bargroupwidth=$,Se.bardelta=j}D.binWidth=G[0][0].t.barwidth/100,a(D),c(J,D),f(J,D,Q)})(C,k,V,R),function(O){for(var J=O.traces,D=0;D<J.length;D++){var B=J[D];if(B[0].trace.base===void 0)for(var N=new r([B],{sepNegVal:!0,overlapNoMerge:!0}),F=0;F<B.length;F++){var H=B[F];if(H.p!==p){var j=N.put(H.p,H.b+H.s);j&&(H.b=j)}}}}(V),R.norm?(d(V),m(L,V,R)):g(L,V)}(v,T,w,b,E),M.length&&u(T,w,M,E);break;case"stack":case"relative":for(M=[],b=[],_=0;_<A.length;_++)(S=A[_])[0].trace.base===void 0?b.push(S):M.push(S);b.length&&function(C,k,L,I,R){var V=new r(I,{sepNegVal:R.mode==="relative",overlapNoMerge:!(R.norm||R.mode==="stack"||R.mode==="relative")});s(k,V,R),function(N,F,H){var j,G,W,Q,$,ee,ie=y(N),ae=F.traces;for(Q=0;Q<ae.length;Q++)if(j=ae[Q],(G=j[0].trace).type==="funnel")for($=0;$<j.length;$++)(ee=j[$]).s!==p&&F.put(ee.p,-.5*ee.s);for(Q=0;Q<ae.length;Q++){j=ae[Q],G=j[0].trace,W=G.type==="funnel";var oe=[];for($=0;$<j.length;$++)if((ee=j[$]).s!==p){var de;de=W?ee.s:ee.s+ee.b;var le=F.put(ee.p,de),fe=le+de;ee.b=le,ee[ie]=fe,H.norm||(oe.push(fe),ee.hasB&&oe.push(le))}H.norm||(G._extremes[N._id]=e.findExtremes(N,oe,{tozero:!0,padded:!0}))}}(L,V,R);for(var O=0;O<I.length;O++)for(var J=I[O],D=0;D<J.length;D++){var B=J[D];B.s!==p&&B.b+B.s===V.get(B.p,B.s)&&(B._outmost=!0)}R.norm&&m(L,V,R)}(0,T,w,b,E),M.length&&u(T,w,M,E)}(function(C,k){var L,I,R,V=y(k),O={},J=1/0,D=-1/0;for(L=0;L<C.length;L++)for(R=C[L],I=0;I<R.length;I++){var B=R[I].p;t(B)&&(J=Math.min(J,B),D=Math.max(D,B))}var N=1e4/(D-J),F=O.round=function(ee){return String(Math.round(N*(ee-J)))};for(L=0;L<C.length;L++){(R=C[L])[0].t.extents=O;var H=R[0].t.poffset,j=Array.isArray(H);for(I=0;I<R.length;I++){var G=R[I],W=G[V]-G.w/2;if(t(W)){var Q=G[V]+G.w/2,$=F(G.p);O[$]?O[$]=[Math.min(W,O[$][0]),Math.max(Q,O[$][1])]:O[$]=[W,Q]}G.p0=G.p+(j?H[I]:H),G.p1=G.p0+G.w,G.s0=G.b,G.s1=G.s0+G.s}}})(A,T)}}function u(v,T,w,A){for(var E=0;E<w.length;E++){var M=w[E],b=new r([M],{unitMinDiff:A.xCat||A.yCat,sepNegVal:!1,overlapNoMerge:!A.norm});s(v,b,A),A.norm?(d(b),m(T,b,A)):g(T,b)}}function s(v,T,w){for(var A=T.minDiff,E=T.traces,M=A*(1-w.gap),b=M*(1-(w.groupgap||0)),_=-b/2,S=0;S<E.length;S++){var C=E[S][0].t;C.barwidth=b,C.poffset=_,C.bargroupwidth=M,C.bardelta=A}T.binWidth=E[0][0].t.barwidth/100,a(T),c(v,T),f(v,T)}function a(v){var T,w,A=v.traces;for(T=0;T<A.length;T++){var E,M=A[T],b=M[0],_=b.trace,S=b.t,C=_._offset||_.offset,k=S.poffset;if(h(C)){for(E=Array.prototype.slice.call(C,0,M.length),w=0;w<E.length;w++)t(E[w])||(E[w]=k);for(w=E.length;w<M.length;w++)E.push(k);S.poffset=E}else C!==void 0&&(S.poffset=C);var L=_._width||_.width,I=S.barwidth;if(h(L)){var R=Array.prototype.slice.call(L,0,M.length);for(w=0;w<R.length;w++)t(R[w])||(R[w]=I);for(w=R.length;w<M.length;w++)R.push(I);if(S.barwidth=R,C===void 0){for(E=[],w=0;w<M.length;w++)E.push(k+(I-R[w])/2);S.poffset=E}}else L!==void 0&&(S.barwidth=L,C===void 0&&(S.poffset=k+(I-L)/2))}}function c(v,T){for(var w=T.traces,A=y(v),E=0;E<w.length;E++)for(var M=w[E],b=M[0].t,_=b.poffset,S=Array.isArray(_),C=b.barwidth,k=Array.isArray(C),L=0;L<M.length;L++){var I=M[L],R=I.w=k?C[L]:C;I[A]=I.p+(S?_[L]:_)+R/2}}function f(v,T,w){var A=T.traces,E=T.minDiff/2;e.minDtick(v,T.minDiff,T.distinctPositions[0],w);for(var M=0;M<A.length;M++){var b,_,S,C,k=A[M],L=k[0],I=L.trace,R=[];for(C=0;C<k.length;C++)_=(b=k[C]).p-E,S=b.p+E,R.push(_,S);if(I.width||I.offset){var V=L.t,O=V.poffset,J=V.barwidth,D=Array.isArray(O),B=Array.isArray(J);for(C=0;C<k.length;C++){b=k[C];var N=D?O[C]:O,F=B?J[C]:J;S=(_=b.p+N)+F,R.push(_,S)}}I._extremes[v._id]=e.findExtremes(v,R,{padded:!1})}}function g(v,T){for(var w=T.traces,A=y(v),E=0;E<w.length;E++){for(var M=w[E],b=M[0].trace,_=[],S=!1,C=0;C<M.length;C++){var k=M[C],L=k.b,I=L+k.s;k[A]=I,_.push(I),k.hasB&&_.push(L),k.hasB&&k.b||(S=!0)}b._extremes[v._id]=e.findExtremes(v,_,{tozero:S,padded:!0})}}function d(v){for(var T=v.traces,w=0;w<T.length;w++)for(var A=T[w],E=0;E<A.length;E++){var M=A[E];M.s!==p&&v.put(M.p,M.b+M.s)}}function m(v,T,w){var A=T.traces,E=y(v),M=w.norm==="fraction"?1:100,b=M/1e9,_=v.l2c(v.c2l(0)),S=w.mode==="stack"?M:_;function C(H){return t(v.c2l(H))&&(H<_-b||H>S+b||!t(_))}for(var k=0;k<A.length;k++){for(var L=A[k],I=L[0].trace,R=[],V=!1,O=!1,J=0;J<L.length;J++){var D=L[J];if(D.s!==p){var B=Math.abs(M/T.get(D.p,D.s));D.b*=B,D.s*=B;var N=D.b,F=N+D.s;D[E]=F,R.push(F),O=O||C(F),D.hasB&&(R.push(N),O=O||C(N)),D.hasB&&D.b||(V=!0)}}I._extremes[v._id]=e.findExtremes(v,R,{tozero:V,padded:O})}}function y(v){return v._id.charAt(0)}z.exports={crossTraceCalc:function(v,T){for(var w=T.xaxis,A=T.yaxis,E=v._fullLayout,M=v._fullData,b=v.calcdata,_=[],S=[],C=0;C<M.length;C++){var k=M[C];if(k.visible===!0&&l.traceIs(k,"bar")&&k.xaxis===w._id&&k.yaxis===A._id&&(k.orientation==="h"?_.push(b[C]):S.push(b[C]),k._computePh))for(var L=v.calcdata[C],I=0;I<L.length;I++)typeof L[I].ph0=="function"&&(L[I].ph0=L[I].ph0()),typeof L[I].ph1=="function"&&(L[I].ph1=L[I].ph1())}var R={xCat:w.type==="category"||w.type==="multicategory",yCat:A.type==="category"||A.type==="multicategory",mode:E.barmode,norm:E.barnorm,gap:E.bargap,groupgap:E.bargroupgap};i(v,w,A,S,R),i(v,A,w,_,R)},setGroupPositions:i}},{"../../constants/numerical":753,"../../lib":778,"../../plots/cartesian/axes":828,"../../plots/cartesian/constraints":835,"../../registry":911,"./sieve.js":934,"fast-isnumeric":241}],925:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../../components/color"),p=n("../../registry"),l=n("../scatter/xy_defaults"),e=n("../scatter/period_defaults"),o=n("./style_defaults"),r=n("../../plots/cartesian/constraints").getAxisGroup,i=n("./attributes"),u=t.coerceFont;function s(c,f,g,d){var m=f.orientation,y=f[{v:"x",h:"y"}[m]+"axis"],v=r(g,y)+m,T=g._alignmentOpts||{},w=d("alignmentgroup"),A=T[v];A||(A=T[v]={});var E=A[w];E?E.traces.push(f):E=A[w]={traces:[f],alignmentIndex:Object.keys(A).length,offsetGroups:{}};var M=d("offsetgroup"),b=E.offsetGroups,_=b[M];M&&(_||(_=b[M]={offsetIndex:Object.keys(b).length}),f._offsetIndex=_.offsetIndex)}function a(c,f,g,d,m,y){var v=(y=y||{}).moduleHasSelected!==!1,T=y.moduleHasUnselected!==!1,w=y.moduleHasConstrain!==!1,A=y.moduleHasCliponaxis!==!1,E=y.moduleHasTextangle!==!1,M=y.moduleHasInsideanchor!==!1,b=!!y.hasPathbar,_=Array.isArray(m)||m==="auto",S=_||m==="inside",C=_||m==="outside";if(S||C){var k=u(d,"textfont",g.font),L=t.extendFlat({},k),I=!(c.textfont&&c.textfont.color);if(I&&delete L.color,u(d,"insidetextfont",L),b){var R=t.extendFlat({},k);I&&delete R.color,u(d,"pathbar.textfont",R)}C&&u(d,"outsidetextfont",k),v&&d("selected.textfont.color"),T&&d("unselected.textfont.color"),w&&d("constraintext"),A&&d("cliponaxis"),E&&d("textangle"),d("texttemplate")}S&&M&&d("insidetextanchor")}z.exports={supplyDefaults:function(c,f,g,d){function m(w,A){return t.coerce(c,f,i,w,A)}if(l(c,f,d,m)){e(c,f,d,m),m("orientation",f.x&&!f.y?"h":"v"),m("base"),m("offset"),m("width"),m("text"),m("hovertext"),m("hovertemplate");var y=m("textposition");a(c,f,d,m,y,{moduleHasSelected:!0,moduleHasUnselected:!0,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),o(c,f,m,g,d);var v=(f.marker.line||{}).color,T=p.getComponentMethod("errorbars","supplyDefaults");T(c,f,v||h.defaultLine,{axis:"y"}),T(c,f,v||h.defaultLine,{axis:"x",inherit:"y"}),t.coerceSelectionMarkerOpacity(f,m)}else f.visible=!1},crossTraceDefaults:function(c,f){var g;function d(y){return t.coerce(g._input,g,i,y)}if(f.barmode==="group")for(var m=0;m<c.length;m++)(g=c[m]).type==="bar"&&(g._input,s(0,g,f,d))},handleGroupingDefaults:s,handleText:a}},{"../../components/color":643,"../../lib":778,"../../plots/cartesian/constraints":835,"../../registry":911,"../scatter/period_defaults":1207,"../scatter/xy_defaults":1214,"./attributes":921,"./style_defaults":936}],926:[function(n,z,q){"use strict";z.exports=function(t,h,p){return t.x="xVal"in h?h.xVal:h.x,t.y="yVal"in h?h.yVal:h.y,h.xa&&(t.xaxis=h.xa),h.ya&&(t.yaxis=h.ya),p.orientation==="h"?(t.label=t.y,t.value=t.x):(t.label=t.x,t.value=t.y),t}},{}],927:[function(n,z,q){"use strict";var t=n("fast-isnumeric"),h=n("tinycolor2"),p=n("../../lib").isArrayOrTypedArray;q.coerceString=function(l,e,o){if(typeof e=="string"){if(e||!l.noBlank)return e}else if((typeof e=="number"||e===!0)&&!l.strict)return String(e);return o!==void 0?o:l.dflt},q.coerceNumber=function(l,e,o){if(t(e)){e=+e;var r=l.min,i=l.max;if(!(r!==void 0&&e<r||i!==void 0&&e>i))return e}return o!==void 0?o:l.dflt},q.coerceColor=function(l,e,o){return h(e).isValid()?e:o!==void 0?o:l.dflt},q.coerceEnumerated=function(l,e,o){return l.coerceNumber&&(e=+e),l.values.indexOf(e)!==-1?e:o!==void 0?o:l.dflt},q.getValue=function(l,e){var o;return Array.isArray(l)?e<l.length&&(o=l[e]):o=l,o},q.getLineWidth=function(l,e){return 0<e.mlw?e.mlw:p(l.marker.line.width)?0:l.marker.line.width}},{"../../lib":778,"fast-isnumeric":241,tinycolor2:576}],928:[function(n,z,q){"use strict";var t=n("../../components/fx"),h=n("../../registry"),p=n("../../components/color"),l=n("../../lib").fillText,e=n("./helpers").getLineWidth,o=n("../../plots/cartesian/axes").hoverLabelText,r=n("../../constants/numerical").BADNUM;function i(s,a,c,f){var g,d,m,y,v,T,w,A=s.cd,E=A[0].trace,M=A[0].t,b=f==="closest",_=E.type==="waterfall",S=s.maxHoverDistance;function C(G){return G[m]-G.w/2}function k(G){return G[m]+G.w/2}var L=b?C:function(G){return Math.min(C(G),G.p-M.bardelta/2)},I=b?k:function(G){return Math.max(k(G),G.p+M.bardelta/2)};function R(G,W){return t.inbox(G-g,W-g,S+Math.min(1,Math.abs(W-G)/w)-1)}function V(G){return R(L(G),I(G))}function O(G){var W=d,Q=G.b,$=G[y];if(_){var ee=Math.abs(G.rawS)||0;W>0?$+=ee:W<0&&($-=ee)}return t.inbox(Q-W,$-W,S+($-W)/($-Q)-1)}E.orientation==="h"?(g=c,d=a,m="y",y="x",v=O,T=V):(g=a,d=c,m="x",y="y",T=O,v=V);var J=s[m+"a"],D=s[y+"a"];w=Math.abs(J.r2c(J.range[1])-J.r2c(J.range[0]));var B=t.getDistanceFunction(f,v,T,function(G){return(v(G)+T(G))/2});if(t.getClosest(A,B,s),s.index!==!1&&A[s.index].p!==r){b||(L=function(G){return Math.min(C(G),G.p-M.bargroupwidth/2)},I=function(G){return Math.max(k(G),G.p+M.bargroupwidth/2)});var N=A[s.index],F=E.base?N.b+N.s:N.s;s[y+"0"]=s[y+"1"]=D.c2p(N[y],!0),s[y+"LabelVal"]=F;var H=M.extents[M.extents.round(N.p)];s[m+"0"]=J.c2p(b?L(N):H[0],!0),s[m+"1"]=J.c2p(b?I(N):H[1],!0);var j=N.orig_p!==void 0;return s[m+"LabelVal"]=j?N.orig_p:N.p,s.labelLabel=o(J,s[m+"LabelVal"]),s.valueLabel=o(D,s[y+"LabelVal"]),s.baseLabel=o(D,N.b),s.spikeDistance=(O(N)+function(G){return R(C(G),k(G))}(N))/2-S,s[m+"Spike"]=J.c2p(N.p,!0),l(N,E,s),s.hovertemplate=E.hovertemplate,s}}function u(s,a){var c=a.mcc||s.marker.color,f=a.mlcc||s.marker.line.color,g=e(s,a);return p.opacity(c)?c:p.opacity(f)&&g?f:void 0}z.exports={hoverPoints:function(s,a,c,f){var g=i(s,a,c,f);if(g){var d=g.cd,m=d[0].trace,y=d[g.index];return g.color=u(m,y),h.getComponentMethod("errorbars","hoverInfo")(y,m,g),[g]}},hoverOnBars:i,getTraceColor:u}},{"../../components/color":643,"../../components/fx":683,"../../constants/numerical":753,"../../lib":778,"../../plots/cartesian/axes":828,"../../registry":911,"./helpers":927}],929:[function(n,z,q){"use strict";z.exports={attributes:n("./attributes"),layoutAttributes:n("./layout_attributes"),supplyDefaults:n("./defaults").supplyDefaults,crossTraceDefaults:n("./defaults").crossTraceDefaults,supplyLayoutDefaults:n("./layout_defaults"),calc:n("./calc"),crossTraceCalc:n("./cross_trace_calc").crossTraceCalc,colorbar:n("../scatter/marker_colorbar"),arraysToCalcdata:n("./arrays_to_calcdata"),plot:n("./plot").plot,style:n("./style").style,styleOnSelect:n("./style").styleOnSelect,hoverPoints:n("./hover").hoverPoints,eventData:n("./event_data"),selectPoints:n("./select"),moduleType:"trace",name:"bar",basePlotModule:n("../../plots/cartesian"),categories:["bar-like","cartesian","svg","bar","oriented","errorBarsOK","showLegend","zoomScale"],animatable:!0,meta:{}}},{"../../plots/cartesian":841,"../scatter/marker_colorbar":1205,"./arrays_to_calcdata":920,"./attributes":921,"./calc":922,"./cross_trace_calc":924,"./defaults":925,"./event_data":926,"./hover":928,"./layout_attributes":930,"./layout_defaults":931,"./plot":932,"./select":933,"./style":935}],930:[function(n,z,q){"use strict";z.exports={barmode:{valType:"enumerated",values:["stack","group","overlay","relative"],dflt:"group",editType:"calc"},barnorm:{valType:"enumerated",values:["","fraction","percent"],dflt:"",editType:"calc"},bargap:{valType:"number",min:0,max:1,editType:"calc"},bargroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],931:[function(n,z,q){"use strict";var t=n("../../registry"),h=n("../../plots/cartesian/axes"),p=n("../../lib"),l=n("./layout_attributes");z.exports=function(e,o,r){function i(y,v){return p.coerce(e,o,l,y,v)}for(var u=!1,s=!1,a=!1,c={},f=i("barmode"),g=0;g<r.length;g++){var d=r[g];if(t.traceIs(d,"bar")&&d.visible){if(u=!0,f==="group"){var m=d.xaxis+d.yaxis;c[m]&&(a=!0),c[m]=!0}d.visible&&d.type==="histogram"&&h.getFromId({_fullLayout:o},d[d.orientation==="v"?"xaxis":"yaxis"]).type!=="category"&&(s=!0)}}u?(f!=="overlay"&&i("barnorm"),i("bargap",s&&!a?0:.2),i("bargroupgap")):delete o.barmode}},{"../../lib":778,"../../plots/cartesian/axes":828,"../../registry":911,"./layout_attributes":930}],932:[function(n,z,q){"use strict";var t=n("d3"),h=n("fast-isnumeric"),p=n("../../lib"),l=n("../../lib/svg_text_utils"),e=n("../../components/color"),o=n("../../components/drawing"),r=n("../../registry"),i=n("../../plots/cartesian/axes").tickText,u=n("./uniform_text"),s=u.recordMinTextSize,a=u.clearMinTextSize,c=n("./style"),f=n("./helpers"),g=n("./constants"),d=n("./attributes"),m=d.text,y=d.textposition,v=n("../../components/fx/helpers").appendArrayPointValue,T=g.TEXTPAD;function w(k){return k.id}function A(k){if(k.ids)return w}function E(k,L){return k<L?1:-1}function M(k,L,I,R){var V;return!L.uniformtext.mode&&b(I)?(R&&(V=R()),k.transition().duration(I.duration).ease(I.easing).each("end",function(){V&&V()}).each("interrupt",function(){V&&V()})):k}function b(k){return k&&k.duration>0}function _(k){return k==="auto"?0:k}function S(k,L){var I=Math.PI/180*L,R=Math.abs(Math.sin(I)),V=Math.abs(Math.cos(I));return{x:k.width*V+k.height*R,y:k.width*R+k.height*V}}function C(k,L,I,R,V,O){var J=!!O.isHorizontal,D=!!O.constrained,B=O.angle||0,N=O.anchor||"end",F=N==="end",H=N==="start",j=((O.leftToRight||0)+1)/2,G=1-j,W=V.width,Q=V.height,$=Math.abs(L-k),ee=Math.abs(R-I),ie=$>2*T&&ee>2*T?T:0;$-=2*ie,ee-=2*ie;var ae=_(B);B!=="auto"||W<=$&&Q<=ee||!(W>$||Q>ee)||(W>ee||Q>$)&&W<Q==$<ee||(ae+=90);var oe=S(V,ae),de=1;D&&(de=Math.min(1,$/oe.x,ee/oe.y));var le=V.left*G+V.right*j,fe=(V.top+V.bottom)/2,ue=(k+T)*G+(L-T)*j,we=(I+R)/2,Ae=0,Se=0;if(H||F){var ke=(J?oe.x:oe.y)/2,Me=J?E(k,L):E(I,R);J?H?(ue=k+Me*ie,Ae=-Me*ke):(ue=L-Me*ie,Ae=Me*ke):H?(we=I+Me*ie,Se=-Me*ke):(we=R-Me*ie,Se=Me*ke)}return{textX:le,textY:fe,targetX:ue,targetY:we,anchorX:Ae,anchorY:Se,scale:de,rotate:ae}}z.exports={plot:function(k,L,I,R,V,O){var J=L.xaxis,D=L.yaxis,B=k._fullLayout;V||(V={mode:B.barmode,norm:B.barmode,gap:B.bargap,groupgap:B.bargroupgap},a("bar",B));var N=p.makeTraceGroups(R,I,"trace bars").each(function(F){var H=t.select(this),j=F[0].trace,G=j.type==="waterfall",W=j.type==="funnel",Q=j.type==="bar"||W,$=0;G&&j.connector.visible&&j.connector.mode==="between"&&($=j.connector.line.width/2);var ee=j.orientation==="h",ie=b(V),ae=p.ensureSingle(H,"g","points"),oe=A(j),de=ae.selectAll("g.point").data(p.identity,oe);de.enter().append("g").classed("point",!0),de.exit().remove(),de.each(function(fe,ue){var we,Ae,Se=t.select(this),ke=function(Re,Ze,Ke,$e){var rt=[],at=[],lt=$e?Ze:Ke,gt=$e?Ke:Ze;return rt[0]=lt.c2p(Re.s0,!0),at[0]=gt.c2p(Re.p0,!0),rt[1]=lt.c2p(Re.s1,!0),at[1]=gt.c2p(Re.p1,!0),$e?[rt,at]:[at,rt]}(fe,J,D,ee),Me=ke[0][0],ve=ke[0][1],ge=ke[1][0],De=ke[1][1],_e=(ee?ve-Me:De-ge)==0;if(_e&&Q&&f.getLineWidth(j,fe)&&(_e=!1),_e||(_e=!(h(Me)&&h(ve)&&h(ge)&&h(De))),fe.isBlank=_e,_e&&(ee?ve=Me:De=ge),$&&!_e&&(ee?(Me-=E(Me,ve)*$,ve+=E(Me,ve)*$):(ge-=E(ge,De)*$,De+=E(ge,De)*$)),j.type==="waterfall"){if(!_e){var Pe=j[fe.dir].marker;we=Pe.line.width,Ae=Pe.color}}else we=f.getLineWidth(j,fe),Ae=fe.mc||j.marker.color;function Fe(Re){var Ze=t.round(we/2%1,2);return V.gap===0&&V.groupgap===0?t.round(Math.round(Re)-Ze,2):Re}if(!k._context.staticPlot){var ze=e.opacity(Ae)<1||we>.01?Fe:function(Re,Ze,Ke){return Ke&&Re===Ze?Re:Math.abs(Re-Ze)>=2?Fe(Re):Re>Ze?Math.ceil(Re):Math.floor(Re)};Me=ze(Me,ve,ee),ve=ze(ve,Me,ee),ge=ze(ge,De,!ee),De=ze(De,ge,!ee)}var He=M(p.ensureSingle(Se,"path"),B,V,O);if(He.style("vector-effect","non-scaling-stroke").attr("d",isNaN((ve-Me)*(De-ge))||_e&&k._context.staticPlot?"M0,0Z":"M"+Me+","+ge+"V"+De+"H"+ve+"V"+ge+"Z").call(o.setClipUrl,L.layerClipId,k),!B.uniformtext.mode&&ie){var et=o.makePointStyleFns(j);o.singlePointStyle(fe,He,j,et,k)}(function(Re,Ze,Ke,$e,rt,at,lt,gt,Ie,be,We){var Ge,st=Ze.xaxis,ot=Ze.yaxis,Ce=Re._fullLayout;function Ue(or,zt,Qt){return p.ensureSingle(or,"text").text(zt).attr({class:"bartext bartext-"+Ge,"text-anchor":"middle","data-notex":1}).call(o.font,Qt).call(l.convertToTspans,Re)}var Ye=$e[0].trace,xe=Ye.orientation==="h",Ee=function(or,zt,Qt,cr,Dt){var Ut,ur=zt[0].trace;return Ut=ur.texttemplate?function(Sr,Lr,Hr,Kr,Ir){var kr=Lr[0].trace,rn=p.castOption(kr,Hr,"texttemplate");if(!rn)return"";var Qr,nn,Xr,Nr,Br=kr.type==="waterfall",on=kr.type==="funnel";kr.orientation==="h"?(Qr="y",nn=Ir,Xr="x",Nr=Kr):(Qr="x",nn=Kr,Xr="y",Nr=Ir);function cn(vt){return i(Nr,+vt,!0).text}var un=Lr[Hr],Zr={};Zr.label=un.p,Zr.labelLabel=Zr[Qr+"Label"]=(yn=un.p,i(nn,yn,!0).text);var yn,In=p.castOption(kr,un.i,"text");(In===0||In)&&(Zr.text=In),Zr.value=un.s,Zr.valueLabel=Zr[Xr+"Label"]=cn(un.s);var Un={};v(Un,kr,un.i),Br&&(Zr.delta=+un.rawS||un.s,Zr.deltaLabel=cn(Zr.delta),Zr.final=un.v,Zr.finalLabel=cn(Zr.final),Zr.initial=Zr.final-Zr.delta,Zr.initialLabel=cn(Zr.initial)),on&&(Zr.value=un.s,Zr.valueLabel=cn(Zr.value),Zr.percentInitial=un.begR,Zr.percentInitialLabel=p.formatPercent(un.begR),Zr.percentPrevious=un.difR,Zr.percentPreviousLabel=p.formatPercent(un.difR),Zr.percentTotal=un.sumR,Zr.percenTotalLabel=p.formatPercent(un.sumR));var Kn=p.castOption(kr,un.i,"customdata");return Kn&&(Zr.customdata=Kn),p.texttemplateString(rn,Zr,Sr._d3locale,Un,Zr,kr._meta||{})}(or,zt,Qt,cr,Dt):ur.textinfo?function(Sr,Lr,Hr,Kr){var Ir=Sr[0].trace,kr=Ir.orientation==="h",rn=Ir.type==="waterfall",Qr=Ir.type==="funnel";function nn(Zt){return i(kr?Hr:Kr,+Zt,!0).text}var Xr,Nr=Ir.textinfo,Br=Sr[Lr],on=Nr.split("+"),cn=[],un=function(Zt){return on.indexOf(Zt)!==-1};un("label")&&cn.push((Zr=Sr[Lr].p,i(kr?Kr:Hr,Zr,!0).text));var Zr;if(un("text")&&((Xr=p.castOption(Ir,Br.i,"text"))===0||Xr)&&cn.push(Xr),rn){var yn=+Br.rawS||Br.s,In=Br.v,Un=In-yn;un("initial")&&cn.push(nn(Un)),un("delta")&&cn.push(nn(yn)),un("final")&&cn.push(nn(In))}if(Qr){un("value")&&cn.push(nn(Br.s));var Kn=0;un("percent initial")&&Kn++,un("percent previous")&&Kn++,un("percent total")&&Kn++;var vt=Kn>1;un("percent initial")&&(Xr=p.formatPercent(Br.begR),vt&&(Xr+=" of initial"),cn.push(Xr)),un("percent previous")&&(Xr=p.formatPercent(Br.difR),vt&&(Xr+=" of previous"),cn.push(Xr)),un("percent total")&&(Xr=p.formatPercent(Br.sumR),vt&&(Xr+=" of total"),cn.push(Xr))}return cn.join("<br>")}(zt,Qt,cr,Dt):f.getValue(ur.text,Qt),f.coerceString(m,Ut)}(Ce,$e,rt,st,ot);Ge=function(or,zt){var Qt=f.getValue(or.textposition,zt);return f.coerceEnumerated(y,Qt)}(Ye,rt);var Je=be.mode==="stack"||be.mode==="relative",it=$e[rt],ht=!Je||it._outmost;if(!Ee||Ge==="none"||(it.isBlank||at===lt||gt===Ie)&&(Ge==="auto"||Ge==="inside"))return void Ke.select("text").remove();var ct=Ce.font,mt=c.getBarColor($e[rt],Ye),bt=c.getInsideTextFont(Ye,rt,ct,mt),Et=c.getOutsideTextFont(Ye,rt,ct),Mt=Ke.datum();xe?st.type==="log"&&Mt.s0<=0&&(at=st.range[0]<st.range[1]?0:st._length):ot.type==="log"&&Mt.s0<=0&&(gt=ot.range[0]<ot.range[1]?ot._length:0);var _t,xt,At,It,Nt,Ot=Math.abs(lt-at)-2*T,Yt=Math.abs(Ie-gt)-2*T;if(Ge==="outside"&&(ht||it.hasB||(Ge="inside")),Ge==="auto")if(ht){Ge="inside",Nt=p.ensureUniformFontSize(Re,bt),_t=Ue(Ke,Ee,Nt),xt=o.bBox(_t.node()),At=xt.width,It=xt.height;var Pt=At<=Ot&&It<=Yt,Ne=At<=Yt&&It<=Ot,ut=xe?Ot>=At*(Yt/It):Yt>=It*(Ot/At);At>0&&It>0&&(Pt||Ne||ut)?Ge="inside":(Ge="outside",_t.remove(),_t=null)}else Ge="inside";if(!_t){Nt=p.ensureUniformFontSize(Re,Ge==="outside"?Et:bt);var wt=(_t=Ue(Ke,Ee,Nt)).attr("transform");if(_t.attr("transform",""),xt=o.bBox(_t.node()),At=xt.width,It=xt.height,_t.attr("transform",wt),At<=0||It<=0)return void _t.remove()}var Bt,Jt,er=Ye.textangle;Ge==="outside"?(Jt=Ye.constraintext==="both"||Ye.constraintext==="outside",Bt=function(or,zt,Qt,cr,Dt,Ut){var ur,Sr=!!Ut.isHorizontal,Lr=!!Ut.constrained,Hr=Ut.angle||0,Kr=Dt.width,Ir=Dt.height,kr=Math.abs(zt-or),rn=Math.abs(cr-Qt);ur=Sr?rn>2*T?T:0:kr>2*T?T:0;var Qr=1;Lr&&(Qr=Sr?Math.min(1,rn/Ir):Math.min(1,kr/Kr));var nn=_(Hr),Xr=S(Dt,nn),Nr=(Sr?Xr.x:Xr.y)/2,Br=(Dt.left+Dt.right)/2,on=(Dt.top+Dt.bottom)/2,cn=(or+zt)/2,un=(Qt+cr)/2,Zr=0,yn=0,In=Sr?E(zt,or):E(Qt,cr);return Sr?(cn=zt-In*ur,Zr=In*Nr):(un=cr+In*ur,yn=-In*Nr),{textX:Br,textY:on,targetX:cn,targetY:un,anchorX:Zr,anchorY:yn,scale:Qr,rotate:nn}}(at,lt,gt,Ie,xt,{isHorizontal:xe,constrained:Jt,angle:er})):(Jt=Ye.constraintext==="both"||Ye.constraintext==="inside",Bt=C(at,lt,gt,Ie,xt,{isHorizontal:xe,constrained:Jt,angle:er,anchor:Ye.insidetextanchor})),Bt.fontSize=Nt.size,s(Ye.type,Bt,Ce),it.transform=Bt,M(_t,Ce,be,We).attr("transform",p.getTextTransform(Bt))})(k,L,Se,F,ue,Me,ve,ge,De,V,O),L.layerClipId&&o.hideOutsideRangePoint(fe,Se.select("text"),J,D,j.xcalendar,j.ycalendar)});var le=j.cliponaxis===!1;o.setClipUrl(H,le?null:L.layerClipId,k)});r.getComponentMethod("errorbars","plot")(k,N,L,V)},toMoveInsideBar:C}},{"../../components/color":643,"../../components/drawing":665,"../../components/fx/helpers":679,"../../lib":778,"../../lib/svg_text_utils":803,"../../plots/cartesian/axes":828,"../../registry":911,"./attributes":921,"./constants":923,"./helpers":927,"./style":935,"./uniform_text":937,d3:169,"fast-isnumeric":241}],933:[function(n,z,q){"use strict";function t(h,p,l,e,o){var r=p.c2p(e?h.s0:h.p0,!0),i=p.c2p(e?h.s1:h.p1,!0),u=l.c2p(e?h.p0:h.s0,!0),s=l.c2p(e?h.p1:h.s1,!0);return o?[(r+i)/2,(u+s)/2]:e?[i,(u+s)/2]:[(r+i)/2,s]}z.exports=function(h,p){var l,e=h.cd,o=h.xaxis,r=h.yaxis,i=e[0].trace,u=i.type==="funnel",s=i.orientation==="h",a=[];if(p===!1)for(l=0;l<e.length;l++)e[l].selected=0;else for(l=0;l<e.length;l++){var c=e[l],f="ct"in c?c.ct:t(c,o,r,s,u);p.contains(f,!1,l,h)?(a.push({pointNumber:l,x:o.c2d(c.x),y:r.c2d(c.y)}),c.selected=1):c.selected=0}return a}},{}],934:[function(n,z,q){"use strict";z.exports=p;var t=n("../../lib").distinctVals,h=n("../../constants/numerical").BADNUM;function p(l,e){this.traces=l,this.sepNegVal=e.sepNegVal,this.overlapNoMerge=e.overlapNoMerge;for(var o=1/0,r=[],i=0;i<l.length;i++){for(var u=l[i],s=0;s<u.length;s++){var a=u[s];a.p!==h&&r.push(a.p)}u[0]&&u[0].width1&&(o=Math.min(u[0].width1,o))}this.positions=r;var c=t(r,{unitMinDiff:e.unitMinDiff});this.distinctPositions=c.vals,c.vals.length===1&&o!==1/0?this.minDiff=o:this.minDiff=Math.min(c.minDiff,o),this.binWidth=this.minDiff,this.bins={}}p.prototype.put=function(l,e){var o=this.getLabel(l,e),r=this.bins[o]||0;return this.bins[o]=r+e,r},p.prototype.get=function(l,e){var o=this.getLabel(l,e);return this.bins[o]||0},p.prototype.getLabel=function(l,e){return(e<0&&this.sepNegVal?"v":"^")+(this.overlapNoMerge?l:Math.round(l/this.binWidth))}},{"../../constants/numerical":753,"../../lib":778}],935:[function(n,z,q){"use strict";var t=n("d3"),h=n("../../components/color"),p=n("../../components/drawing"),l=n("../../lib"),e=n("../../registry"),o=n("./uniform_text").resizeText,r=n("./attributes"),i=r.textfont,u=r.insidetextfont,s=r.outsidetextfont,a=n("./helpers");function c(w,A,E){p.pointStyle(w.selectAll("path"),A,E),f(w,A,E)}function f(w,A,E){w.selectAll("text").each(function(M){var b=t.select(this),_=l.ensureUniformFontSize(E,g(b,M,A,E));p.font(b,_)})}function g(w,A,E,M){var b=M._fullLayout.font,_=E.textfont;if(w.classed("bartext-inside")){var S=T(A,E);_=m(E,A.i,b,S)}else w.classed("bartext-outside")&&(_=y(E,A.i,b));return _}function d(w,A,E){return v(i,w.textfont,A,E)}function m(w,A,E,M){var b=d(w,A,E);return(w._input.textfont===void 0||w._input.textfont.color===void 0||Array.isArray(w.textfont.color)&&w.textfont.color[A]===void 0)&&(b={color:h.contrast(M),family:b.family,size:b.size}),v(u,w.insidetextfont,A,b)}function y(w,A,E){var M=d(w,A,E);return v(s,w.outsidetextfont,A,M)}function v(w,A,E,M){A=A||{};var b=a.getValue(A.family,E),_=a.getValue(A.size,E),S=a.getValue(A.color,E);return{family:a.coerceString(w.family,b,M.family),size:a.coerceNumber(w.size,_,M.size),color:a.coerceColor(w.color,S,M.color)}}function T(w,A){return A.type==="waterfall"?A[w.dir].marker.color:w.mc||A.marker.color}z.exports={style:function(w){var A=t.select(w).selectAll("g.barlayer").selectAll("g.trace");o(w,A,"bar");var E=A.size(),M=w._fullLayout;A.style("opacity",function(b){return b[0].trace.opacity}).each(function(b){(M.barmode==="stack"&&E>1||M.bargap===0&&M.bargroupgap===0&&!b[0].trace.marker.line.width)&&t.select(this).attr("shape-rendering","crispEdges")}),A.selectAll("g.points").each(function(b){c(t.select(this),b[0].trace,w)}),e.getComponentMethod("errorbars","style")(A)},styleTextPoints:f,styleOnSelect:function(w,A,E){var M=A[0].trace;M.selectedpoints?function(b,_,S){p.selectedPointStyle(b.selectAll("path"),_),function(C,k,L){C.each(function(I){var R,V=t.select(this);if(I.selected){R=l.ensureUniformFontSize(L,g(V,I,k,L));var O=k.selected.textfont&&k.selected.textfont.color;O&&(R.color=O),p.font(V,R)}else p.selectedTextStyle(V,k)})}(b.selectAll("text"),_,S)}(E,M,w):(c(E,M,w),e.getComponentMethod("errorbars","style")(E))},getInsideTextFont:m,getOutsideTextFont:y,getBarColor:T,resizeText:o}},{"../../components/color":643,"../../components/drawing":665,"../../lib":778,"../../registry":911,"./attributes":921,"./helpers":927,"./uniform_text":937,d3:169}],936:[function(n,z,q){"use strict";var t=n("../../components/color"),h=n("../../components/colorscale/helpers").hasColorscale,p=n("../../components/colorscale/defaults");z.exports=function(l,e,o,r,i){o("marker.color",r),h(l,"marker")&&p(l,e,i,o,{prefix:"marker.",cLetter:"c"}),o("marker.line.color",t.defaultLine),h(l,"marker.line")&&p(l,e,i,o,{prefix:"marker.line.",cLetter:"c"}),o("marker.line.width"),o("marker.opacity"),o("selected.marker.color"),o("unselected.marker.color")}},{"../../components/color":643,"../../components/colorscale/defaults":653,"../../components/colorscale/helpers":654}],937:[function(n,z,q){"use strict";var t=n("d3"),h=n("../../lib");function p(l){return"_"+l+"Text_minsize"}z.exports={recordMinTextSize:function(l,e,o){if(o.uniformtext.mode){var r=p(l),i=o.uniformtext.minsize,u=e.scale*e.fontSize;e.hide=u<i,o[r]=o[r]||1/0,e.hide||(o[r]=Math.min(o[r],Math.max(u,i)))}},clearMinTextSize:function(l,e){e[p(l)]=void 0},resizeText:function(l,e,o){var r=l._fullLayout,i=r["_"+o+"Text_minsize"];if(i){var u,s=r.uniformtext.mode==="hide";switch(o){case"funnelarea":case"pie":case"sunburst":u="g.slice";break;case"treemap":u="g.slice, g.pathbar";break;default:u="g.points > g.point"}e.selectAll(u).each(function(a){var c=a.transform;c&&(c.scale=s&&c.hide?0:i/c.fontSize,t.select(this).select("text").attr("transform",h.getTextTransform(c)))})}}}},{"../../lib":778,d3:169}],938:[function(n,z,q){"use strict";var t=n("../../plots/template_attributes").hovertemplateAttrs,h=n("../../lib/extend").extendFlat,p=n("../scatterpolar/attributes"),l=n("../bar/attributes");z.exports={r:p.r,theta:p.theta,r0:p.r0,dr:p.dr,theta0:p.theta0,dtheta:p.dtheta,thetaunit:p.thetaunit,base:h({},l.base,{}),offset:h({},l.offset,{}),width:h({},l.width,{}),text:h({},l.text,{}),hovertext:h({},l.hovertext,{}),marker:l.marker,hoverinfo:p.hoverinfo,hovertemplate:t(),selected:l.selected,unselected:l.unselected}},{"../../lib/extend":768,"../../plots/template_attributes":906,"../bar/attributes":921,"../scatterpolar/attributes":1261}],939:[function(n,z,q){"use strict";var t=n("../../components/colorscale/helpers").hasColorscale,h=n("../../components/colorscale/calc"),p=n("../bar/arrays_to_calcdata"),l=n("../bar/cross_trace_calc").setGroupPositions,e=n("../scatter/calc_selection"),o=n("../../registry").traceIs,r=n("../../lib").extendFlat;z.exports={calc:function(i,u){for(var s=i._fullLayout,a=u.subplot,c=s[a].radialaxis,f=s[a].angularaxis,g=c.makeCalcdata(u,"r"),d=f.makeCalcdata(u,"theta"),m=u._length,y=new Array(m),v=g,T=d,w=0;w<m;w++)y[w]={p:T[w],s:v[w]};function A(E){var M=u[E];M!==void 0&&(u["_"+E]=Array.isArray(M)?f.makeCalcdata(u,E):f.d2c(M,u.thetaunit))}return f.type==="linear"&&(A("width"),A("offset")),t(u,"marker")&&h(i,u,{vals:u.marker.color,containerStr:"marker",cLetter:"c"}),t(u,"marker.line")&&h(i,u,{vals:u.marker.line.color,containerStr:"marker.line",cLetter:"c"}),p(y,u),e(y,u),y},crossTraceCalc:function(i,u,s){for(var a=i.calcdata,c=[],f=0;f<a.length;f++){var g=a[f],d=g[0].trace;d.visible===!0&&o(d,"bar")&&d.subplot===s&&c.push(g)}var m=r({},u.radialaxis,{_id:"x"}),y=u.angularaxis;l(i,y,m,c,{mode:u.barmode,norm:u.barnorm,gap:u.bargap,groupgap:u.bargroupgap})}}},{"../../components/colorscale/calc":651,"../../components/colorscale/helpers":654,"../../lib":778,"../../registry":911,"../bar/arrays_to_calcdata":920,"../bar/cross_trace_calc":924,"../scatter/calc_selection":1189}],940:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../scatterpolar/defaults").handleRThetaDefaults,p=n("../bar/style_defaults"),l=n("./attributes");z.exports=function(e,o,r,i){function u(s,a){return t.coerce(e,o,l,s,a)}h(e,o,i,u)?(u("thetaunit"),u("base"),u("offset"),u("width"),u("text"),u("hovertext"),u("hovertemplate"),p(e,o,u,r,i),t.coerceSelectionMarkerOpacity(o,u)):o.visible=!1}},{"../../lib":778,"../bar/style_defaults":936,"../scatterpolar/defaults":1263,"./attributes":938}],941:[function(n,z,q){"use strict";var t=n("../../components/fx"),h=n("../../lib"),p=n("../bar/hover").getTraceColor,l=h.fillText,e=n("../scatterpolar/hover").makeHoverPointText,o=n("../../plots/polar/helpers").isPtInsidePolygon;z.exports=function(r,i,u){var s=r.cd,a=s[0].trace,c=r.subplot,f=c.radialAxis,g=c.angularAxis,d=c.vangles,m=d?o:h.isPtInsideSector,y=r.maxHoverDistance,v=g._period||2*Math.PI,T=Math.abs(f.g2p(Math.sqrt(i*i+u*u))),w=Math.atan2(u,i);if(f.range[0]>f.range[1]&&(w+=Math.PI),t.getClosest(s,function(M){return m(T,w,[M.rp0,M.rp1],[M.thetag0,M.thetag1],d)?y+Math.min(1,Math.abs(M.thetag1-M.thetag0)/v)-1+(M.rp1-T)/(M.rp1-M.rp0)-1:1/0},r),r.index!==!1){var A=s[r.index];r.x0=r.x1=A.ct[0],r.y0=r.y1=A.ct[1];var E=h.extendFlat({},A,{r:A.s,theta:A.p});return l(A,a,r),e(E,a,c,r),r.hovertemplate=a.hovertemplate,r.color=p(a,A),r.xLabelVal=r.yLabelVal=void 0,A.s<0&&(r.idealAlign="left"),[r]}}},{"../../components/fx":683,"../../lib":778,"../../plots/polar/helpers":893,"../bar/hover":928,"../scatterpolar/hover":1265}],942:[function(n,z,q){"use strict";z.exports={moduleType:"trace",name:"barpolar",basePlotModule:n("../../plots/polar"),categories:["polar","bar","showLegend"],attributes:n("./attributes"),layoutAttributes:n("./layout_attributes"),supplyDefaults:n("./defaults"),supplyLayoutDefaults:n("./layout_defaults"),calc:n("./calc").calc,crossTraceCalc:n("./calc").crossTraceCalc,plot:n("./plot"),colorbar:n("../scatter/marker_colorbar"),formatLabels:n("../scatterpolar/format_labels"),style:n("../bar/style").style,styleOnSelect:n("../bar/style").styleOnSelect,hoverPoints:n("./hover"),selectPoints:n("../bar/select"),meta:{}}},{"../../plots/polar":894,"../bar/select":933,"../bar/style":935,"../scatter/marker_colorbar":1205,"../scatterpolar/format_labels":1264,"./attributes":938,"./calc":939,"./defaults":940,"./hover":941,"./layout_attributes":943,"./layout_defaults":944,"./plot":945}],943:[function(n,z,q){"use strict";z.exports={barmode:{valType:"enumerated",values:["stack","overlay"],dflt:"stack",editType:"calc"},bargap:{valType:"number",dflt:.1,min:0,max:1,editType:"calc"}}},{}],944:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("./layout_attributes");z.exports=function(p,l,e){var o,r={};function i(a,c){return t.coerce(p[o]||{},l[o],h,a,c)}for(var u=0;u<e.length;u++){var s=e[u];s.type==="barpolar"&&s.visible===!0&&(r[o=s.subplot]||(i("barmode"),i("bargap"),r[o]=1))}}},{"../../lib":778,"./layout_attributes":943}],945:[function(n,z,q){"use strict";var t=n("d3"),h=n("fast-isnumeric"),p=n("../../lib"),l=n("../../components/drawing"),e=n("../../plots/polar/helpers");z.exports=function(o,r,i){var u=r.xaxis,s=r.yaxis,a=r.radialAxis,c=r.angularAxis,f=function(d){var m=d.cxx,y=d.cyy;return d.vangles?function(v,T,w,A){var E,M;p.angleDelta(w,A)>0?(E=w,M=A):(E=A,M=w);var b=[e.findEnclosingVertexAngles(E,d.vangles)[0],(E+M)/2,e.findEnclosingVertexAngles(M,d.vangles)[1]];return e.pathPolygonAnnulus(v,T,E,M,b,m,y)}:function(v,T,w,A){return p.pathAnnulus(v,T,w,A,m,y)}}(r),g=r.layers.frontplot.select("g.barlayer");p.makeTraceGroups(g,i,"trace bars").each(function(){var d=t.select(this),m=p.ensureSingle(d,"g","points").selectAll("g.point").data(p.identity);m.enter().append("g").style("vector-effect","non-scaling-stroke").style("stroke-miterlimit",2).classed("point",!0),m.exit().remove(),m.each(function(y){var v,T=t.select(this),w=y.rp0=a.c2p(y.s0),A=y.rp1=a.c2p(y.s1),E=y.thetag0=c.c2g(y.p0),M=y.thetag1=c.c2g(y.p1);if(h(w)&&h(A)&&h(E)&&h(M)&&w!==A&&E!==M){var b=a.c2g(y.s1),_=(E+M)/2;y.ct=[u.c2p(b*Math.cos(_)),s.c2p(b*Math.sin(_))],v=f(w,A,E,M)}else v="M0,0Z";p.ensureSingle(T,"path").attr("d",v)}),l.setClipUrl(d,r._hasClipOnAxisFalse?r.clipIds.forTraces:null,o)})}},{"../../components/drawing":665,"../../lib":778,"../../plots/polar/helpers":893,d3:169,"fast-isnumeric":241}],946:[function(n,z,q){"use strict";var t=n("../scatter/attributes"),h=n("../bar/attributes"),p=n("../../components/color/attributes"),l=n("../../plots/template_attributes").hovertemplateAttrs,e=n("../../lib/extend").extendFlat,o=t.marker,r=o.line;z.exports={y:{valType:"data_array",editType:"calc+clearAxisTypes"},x:{valType:"data_array",editType:"calc+clearAxisTypes"},x0:{valType:"any",editType:"calc+clearAxisTypes"},y0:{valType:"any",editType:"calc+clearAxisTypes"},dx:{valType:"number",editType:"calc"},dy:{valType:"number",editType:"calc"},xperiod:t.xperiod,yperiod:t.yperiod,xperiod0:t.xperiod0,yperiod0:t.yperiod0,xperiodalignment:t.xperiodalignment,yperiodalignment:t.yperiodalignment,name:{valType:"string",editType:"calc+clearAxisTypes"},q1:{valType:"data_array",editType:"calc+clearAxisTypes"},median:{valType:"data_array",editType:"calc+clearAxisTypes"},q3:{valType:"data_array",editType:"calc+clearAxisTypes"},lowerfence:{valType:"data_array",editType:"calc"},upperfence:{valType:"data_array",editType:"calc"},notched:{valType:"boolean",editType:"calc"},notchwidth:{valType:"number",min:0,max:.5,dflt:.25,editType:"calc"},notchspan:{valType:"data_array",editType:"calc"},boxpoints:{valType:"enumerated",values:["all","outliers","suspectedoutliers",!1],editType:"calc"},jitter:{valType:"number",min:0,max:1,editType:"calc"},pointpos:{valType:"number",min:-2,max:2,editType:"calc"},boxmean:{valType:"enumerated",values:[!0,"sd",!1],editType:"calc"},mean:{valType:"data_array",editType:"calc"},sd:{valType:"data_array",editType:"calc"},orientation:{valType:"enumerated",values:["v","h"],editType:"calc+clearAxisTypes"},quartilemethod:{valType:"enumerated",values:["linear","exclusive","inclusive"],dflt:"linear",editType:"calc"},width:{valType:"number",min:0,dflt:0,editType:"calc"},marker:{outliercolor:{valType:"color",dflt:"rgba(0, 0, 0, 0)",editType:"style"},symbol:e({},o.symbol,{arrayOk:!1,editType:"plot"}),opacity:e({},o.opacity,{arrayOk:!1,dflt:1,editType:"style"}),size:e({},o.size,{arrayOk:!1,editType:"calc"}),color:e({},o.color,{arrayOk:!1,editType:"style"}),line:{color:e({},r.color,{arrayOk:!1,dflt:p.defaultLine,editType:"style"}),width:e({},r.width,{arrayOk:!1,dflt:0,editType:"style"}),outliercolor:{valType:"color",editType:"style"},outlierwidth:{valType:"number",min:0,dflt:1,editType:"style"},editType:"style"},editType:"plot"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,dflt:2,editType:"style"},editType:"plot"},fillcolor:t.fillcolor,whiskerwidth:{valType:"number",min:0,max:1,dflt:.5,editType:"calc"},offsetgroup:h.offsetgroup,alignmentgroup:h.alignmentgroup,selected:{marker:t.selected.marker,editType:"style"},unselected:{marker:t.unselected.marker,editType:"style"},text:e({},t.text,{}),hovertext:e({},t.hovertext,{}),hovertemplate:l({}),hoveron:{valType:"flaglist",flags:["boxes","points"],dflt:"boxes+points",editType:"style"}}},{"../../components/color/attributes":642,"../../lib/extend":768,"../../plots/template_attributes":906,"../bar/attributes":921,"../scatter/attributes":1187}],947:[function(n,z,q){"use strict";var t=n("fast-isnumeric"),h=n("../../plots/cartesian/axes"),p=n("../../plots/cartesian/align_period"),l=n("../../lib"),e=n("../../constants/numerical").BADNUM,o=l._;z.exports=function(m,y){var v,T,w,A,E,M,b,_=m._fullLayout,S=h.getFromId(m,y.xaxis||"x"),C=h.getFromId(m,y.yaxis||"y"),k=[],L=y.type==="violin"?"_numViolins":"_numBoxes";y.orientation==="h"?(w=S,A="x",E=C,M="y",b=!!y.yperiodalignment):(w=C,A="y",E=S,M="x",b=!!y.xperiodalignment);var I,R,V,O,J,D,B=function(Ke,$e,rt,at){var lt,gt=$e+"0"in Ke,Ie="d"+$e in Ke;if($e in Ke||gt&&Ie){var be=rt.makeCalcdata(Ke,$e);return[p(Ke,rt,$e,be),be]}lt=gt?Ke[$e+"0"]:"name"in Ke&&(rt.type==="category"||t(Ke.name)&&["linear","log"].indexOf(rt.type)!==-1||l.isDateTime(Ke.name)&&rt.type==="date")?Ke.name:at;for(var We=rt.type==="multicategory"?rt.r2c_just_indices(lt):rt.d2c(lt,0,Ke[$e+"calendar"]),Ge=Ke._length,st=new Array(Ge),ot=0;ot<Ge;ot++)st[ot]=We;return[st]}(y,M,E,_[L]),N=B[0],F=B[1],H=l.distinctVals(N),j=H.vals,G=H.minDiff/2,W=(y.boxpoints||y.points)==="all"?l.identity:function(Ke){return Ke.v<I.lf||Ke.v>I.uf};if(y._hasPreCompStats){var Q=y[A],$=function(Ke){return w.d2c((y[Ke]||[])[v])},ee=1/0,ie=-1/0;for(v=0;v<y._length;v++){var ae=N[v];if(t(ae)){if((I={}).pos=I[M]=ae,b&&F&&(I.orig_p=F[v]),I.q1=$("q1"),I.med=$("median"),I.q3=$("q3"),R=[],Q&&l.isArrayOrTypedArray(Q[v]))for(T=0;T<Q[v].length;T++)(D=w.d2c(Q[v][T]))!==e&&(i(J={v:D,i:[v,T]},y,[v,T]),R.push(J));if(I.pts=R.sort(u),O=(V=I[A]=R.map(s)).length,I.med!==e&&I.q1!==e&&I.q3!==e&&I.med>=I.q1&&I.q3>=I.med){var oe=$("lowerfence");I.lf=oe!==e&&oe<=I.q1?oe:a(I,V,O);var de=$("upperfence");I.uf=de!==e&&de>=I.q3?de:c(I,V,O);var le=$("mean");I.mean=le!==e?le:O?l.mean(V,O):(I.q1+I.q3)/2;var fe=$("sd");I.sd=le!==e&&fe>=0?fe:O?l.stdev(V,O,I.mean):I.q3-I.q1,I.lo=f(I),I.uo=g(I);var ue=$("notchspan");ue=ue!==e&&ue>0?ue:d(I,O),I.ln=I.med-ue,I.un=I.med+ue;var we=I.lf,Ae=I.uf;y.boxpoints&&V.length&&(we=Math.min(we,V[0]),Ae=Math.max(Ae,V[O-1])),y.notched&&(we=Math.min(we,I.ln),Ae=Math.max(Ae,I.un)),I.min=we,I.max=Ae}else{var Se;l.warn(["Invalid input - make sure that q1 <= median <= q3","q1 = "+I.q1,"median = "+I.med,"q3 = "+I.q3].join(`
`)),Se=I.med!==e?I.med:I.q1!==e?I.q3!==e?(I.q1+I.q3)/2:I.q1:I.q3!==e?I.q3:0,I.med=Se,I.q1=I.q3=Se,I.lf=I.uf=Se,I.mean=I.sd=Se,I.ln=I.un=Se,I.min=I.max=Se}ee=Math.min(ee,I.min),ie=Math.max(ie,I.max),I.pts2=R.filter(W),k.push(I)}}y._extremes[w._id]=h.findExtremes(w,[ee,ie],{padded:!0})}else{var ke=w.makeCalcdata(y,A),Me=function(Ke,$e){for(var rt=Ke.length,at=new Array(rt+1),lt=0;lt<rt;lt++)at[lt]=Ke[lt]-$e;return at[rt]=Ke[rt-1]+$e,at}(j,G),ve=j.length,ge=function(Ke){for(var $e=new Array(Ke),rt=0;rt<Ke;rt++)$e[rt]=[];return $e}(ve);for(v=0;v<y._length;v++)if(D=ke[v],t(D)){var De=l.findBin(N[v],Me);De>=0&&De<ve&&(i(J={v:D,i:v},y,v),ge[De].push(J))}var _e=1/0,Pe=-1/0,Fe=y.quartilemethod,ze=Fe==="exclusive",He=Fe==="inclusive";for(v=0;v<ve;v++)if(ge[v].length>0){var et,Re;(I={}).pos=I[M]=j[v],R=I.pts=ge[v].sort(u),O=(V=I[A]=R.map(s)).length,I.min=V[0],I.max=V[O-1],I.mean=l.mean(V,O),I.sd=l.stdev(V,O,I.mean),I.med=l.interp(V,.5),O%2&&(ze||He)?(ze?(et=V.slice(0,O/2),Re=V.slice(O/2+1)):He&&(et=V.slice(0,O/2+1),Re=V.slice(O/2)),I.q1=l.interp(et,.5),I.q3=l.interp(Re,.5)):(I.q1=l.interp(V,.25),I.q3=l.interp(V,.75)),I.lf=a(I,V,O),I.uf=c(I,V,O),I.lo=f(I),I.uo=g(I);var Ze=d(I,O);I.ln=I.med-Ze,I.un=I.med+Ze,_e=Math.min(_e,I.ln),Pe=Math.max(Pe,I.un),I.pts2=R.filter(W),k.push(I)}y._extremes[w._id]=h.findExtremes(w,y.notched?ke.concat([_e,Pe]):ke,{padded:!0})}return function(Ke,$e){if(l.isArrayOrTypedArray($e.selectedpoints))for(var rt=0;rt<Ke.length;rt++){for(var at=Ke[rt].pts||[],lt={},gt=0;gt<at.length;gt++)lt[at[gt].i]=gt;l.tagSelected(at,$e,lt)}}(k,y),k.length>0?(k[0].t={num:_[L],dPos:G,posLetter:M,valLetter:A,labels:{med:o(m,"median:"),min:o(m,"min:"),q1:o(m,"q1:"),q3:o(m,"q3:"),max:o(m,"max:"),mean:y.boxmean==="sd"?o(m,"mean \xB1 \u03C3:"):o(m,"mean:"),lf:o(m,"lower fence:"),uf:o(m,"upper fence:")}},_[L]++,k):[{t:{empty:!0}}]};var r={text:"tx",hovertext:"htx"};function i(m,y,v){for(var T in r)l.isArrayOrTypedArray(y[T])&&(Array.isArray(v)?l.isArrayOrTypedArray(y[T][v[0]])&&(m[r[T]]=y[T][v[0]][v[1]]):m[r[T]]=y[T][v])}function u(m,y){return m.v-y.v}function s(m){return m.v}function a(m,y,v){return v===0?m.q1:Math.min(m.q1,y[Math.min(l.findBin(2.5*m.q1-1.5*m.q3,y,!0)+1,v-1)])}function c(m,y,v){return v===0?m.q3:Math.max(m.q3,y[Math.max(l.findBin(2.5*m.q3-1.5*m.q1,y),0)])}function f(m){return 4*m.q1-3*m.q3}function g(m){return 4*m.q3-3*m.q1}function d(m,y){return y===0?0:1.57*(m.q3-m.q1)/Math.sqrt(y)}},{"../../constants/numerical":753,"../../lib":778,"../../plots/cartesian/align_period":825,"../../plots/cartesian/axes":828,"fast-isnumeric":241}],948:[function(n,z,q){"use strict";var t=n("../../plots/cartesian/axes"),h=n("../../lib"),p=n("../../plots/cartesian/constraints").getAxisGroup,l=["v","h"];function e(o,r,i,u){var s,a,c,f=r.calcdata,g=r._fullLayout,d=u._id,m=d.charAt(0),y=[],v=0;for(s=0;s<i.length;s++)for(c=f[i[s]],a=0;a<c.length;a++)y.push(u.c2l(c[a].pos,!0)),v+=(c[a].pts2||[]).length;if(y.length){var T=h.distinctVals(y,{unitMinDiff:u.type==="category"||u.type==="multicategory"}),w=T.minDiff/2;t.minDtick(u,T.minDiff,T.vals[0],!0);var A=g[o==="violin"?"_numViolins":"_numBoxes"],E=g[o+"mode"]==="group"&&A>1,M=1-g[o+"gap"],b=1-g[o+"groupgap"];for(s=0;s<i.length;s++){var _,S,C,k,L,I,R=(c=f[i[s]])[0].trace,V=c[0].t,O=R.width,J=R.side;if(O)_=S=k=O/2,C=0;else if(_=w,E){var D=p(g,u._id)+R.orientation,B=(g._alignmentOpts[D]||{})[R.alignmentgroup]||{},N=Object.keys(B.offsetGroups||{}).length,F=N||A;S=_*M*b/F,C=2*_*(((N?R._offsetIndex:V.num)+.5)/F-.5)*M,k=_*M/F}else S=_*M*b,C=0,k=_;V.dPos=_,V.bPos=C,V.bdPos=S,V.wHover=k;var H,j,G,W,Q,$,ee=C+S,ie=!!O;if(J==="positive"?(L=_*(O?1:.5),H=ee,I=H=C):J==="negative"?(L=H=C,I=_*(O?1:.5),j=ee):(L=I=_,H=j=ee),(R.boxpoints||R.points)&&v>0){var ae=R.pointpos,oe=R.jitter,de=R.marker.size/2,le=0;ae+oe>=0&&((le=ee*(ae+oe))>L?(ie=!0,Q=de,G=le):le>H&&(Q=de,G=L)),le<=L&&(G=L);var fe=0;ae-oe<=0&&((fe=-ee*(ae-oe))>I?(ie=!0,$=de,W=fe):fe>j&&($=de,W=I)),fe<=I&&(W=I)}else G=L,W=I;var ue=new Array(c.length);for(a=0;a<c.length;a++)ue[a]=c[a].pos;R._extremes[d]=t.findExtremes(u,ue,{padded:ie,vpadminus:W,vpadplus:G,vpadLinearized:!0,ppadminus:{x:$,y:Q}[m],ppadplus:{x:Q,y:$}[m]})}}}z.exports={crossTraceCalc:function(o,r){for(var i=o.calcdata,u=r.xaxis,s=r.yaxis,a=0;a<l.length;a++){for(var c=l[a],f=c==="h"?s:u,g=[],d=0;d<i.length;d++){var m=i[d],y=m[0].t,v=m[0].trace;v.visible!==!0||v.type!=="box"&&v.type!=="candlestick"||y.empty||(v.orientation||"v")!==c||v.xaxis!==u._id||v.yaxis!==s._id||g.push(d)}e("box",o,g,f)}},setPositionOffset:e}},{"../../lib":778,"../../plots/cartesian/axes":828,"../../plots/cartesian/constraints":835}],949:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../../registry"),p=n("../../components/color"),l=n("../scatter/period_defaults"),e=n("../bar/defaults").handleGroupingDefaults,o=n("../../plots/cartesian/axis_autotype"),r=n("./attributes");function i(s,a,c,f){function g(J){var D=0;return J&&J.length&&(D+=1,t.isArrayOrTypedArray(J[0])&&J[0].length&&(D+=1)),D}function d(J){return t.validate(s[J],r[J])}var m,y=c("y"),v=c("x");if(a.type==="box"){var T=c("q1"),w=c("median"),A=c("q3");a._hasPreCompStats=T&&T.length&&w&&w.length&&A&&A.length,m=Math.min(t.minRowLength(T),t.minRowLength(w),t.minRowLength(A))}var E,M,b=g(y),_=g(v),S=b&&t.minRowLength(y),C=_&&t.minRowLength(v),k=f.calendar,L={autotypenumbers:f.autotypenumbers};if(a._hasPreCompStats)switch(String(_)+String(b)){case"00":var I=d("x0")||d("dx");E=(d("y0")||d("dy"))&&!I?"h":"v",M=m;break;case"10":E="v",M=Math.min(m,C);break;case"20":E="h",M=Math.min(m,v.length);break;case"01":E="h",M=Math.min(m,S);break;case"02":E="v",M=Math.min(m,y.length);break;case"12":E="v",M=Math.min(m,C,y.length);break;case"21":E="h",M=Math.min(m,v.length,S);break;case"11":M=0;break;case"22":var R,V=!1;for(R=0;R<v.length;R++)if(o(v[R],k,L)==="category"){V=!0;break}if(V)E="v",M=Math.min(m,C,y.length);else{for(R=0;R<y.length;R++)if(o(y[R],k,L)==="category"){V=!0;break}V?(E="h",M=Math.min(m,v.length,S)):(E="v",M=Math.min(m,C,y.length))}}else b>0?(E="v",M=_>0?Math.min(C,S):Math.min(S)):_>0?(E="h",M=Math.min(C)):M=0;if(M){a._length=M;var O=c("orientation",E);a._hasPreCompStats?O==="v"&&_===0?(c("x0",0),c("dx",1)):O==="h"&&b===0&&(c("y0",0),c("dy",1)):O==="v"&&_===0?c("x0"):O==="h"&&b===0&&c("y0"),h.getComponentMethod("calendars","handleTraceDefaults")(s,a,["x","y"],f)}else a.visible=!1}function u(s,a,c,f){var g=f.prefix,d=t.coerce2(s,a,r,"marker.outliercolor"),m=c("marker.line.outliercolor"),y="outliers";a._hasPreCompStats?y="all":(d||m)&&(y="suspectedoutliers");var v=c(g+"points",y);v?(c("jitter",v==="all"?.3:0),c("pointpos",v==="all"?-1.5:0),c("marker.symbol"),c("marker.opacity"),c("marker.size"),c("marker.color",a.line.color),c("marker.line.color"),c("marker.line.width"),v==="suspectedoutliers"&&(c("marker.line.outliercolor",a.marker.color),c("marker.line.outlierwidth")),c("selected.marker.color"),c("unselected.marker.color"),c("selected.marker.size"),c("unselected.marker.size"),c("text"),c("hovertext")):delete a.marker;var T=c("hoveron");T!=="all"&&T.indexOf("points")===-1||c("hovertemplate"),t.coerceSelectionMarkerOpacity(a,c)}z.exports={supplyDefaults:function(s,a,c,f){function g(A,E){return t.coerce(s,a,r,A,E)}if(i(s,a,g,f),a.visible!==!1){l(s,a,f,g);var d=a._hasPreCompStats;d&&(g("lowerfence"),g("upperfence")),g("line.color",(s.marker||{}).color||c),g("line.width"),g("fillcolor",p.addOpacity(a.line.color,.5));var m=!1;if(d){var y=g("mean"),v=g("sd");y&&y.length&&(m=!0,v&&v.length&&(m="sd"))}g("boxmean",m),g("whiskerwidth"),g("width"),g("quartilemethod");var T=!1;if(d){var w=g("notchspan");w&&w.length&&(T=!0)}else t.validate(s.notchwidth,r.notchwidth)&&(T=!0);g("notched",T)&&g("notchwidth"),u(s,a,g,{prefix:"box"})}},crossTraceDefaults:function(s,a){var c,f;function g(y){return t.coerce(f._input,f,r,y)}for(var d=0;d<s.length;d++){var m=(f=s[d]).type;m!=="box"&&m!=="violin"||(c=f._input,a[m+"mode"]==="group"&&e(c,f,a,g))}},handleSampleDefaults:i,handlePointsDefaults:u}},{"../../components/color":643,"../../lib":778,"../../plots/cartesian/axis_autotype":829,"../../registry":911,"../bar/defaults":925,"../scatter/period_defaults":1207,"./attributes":946}],950:[function(n,z,q){"use strict";z.exports=function(t,h){return h.hoverOnBox&&(t.hoverOnBox=h.hoverOnBox),"xVal"in h&&(t.x=h.xVal),"yVal"in h&&(t.y=h.yVal),h.xa&&(t.xaxis=h.xa),h.ya&&(t.yaxis=h.ya),t}},{}],951:[function(n,z,q){"use strict";var t=n("../../plots/cartesian/axes"),h=n("../../lib"),p=n("../../components/fx"),l=n("../../components/color"),e=h.fillText;function o(i,u,s,a){var c,f,g,d,m,y,v,T,w,A,E,M,b,_,S=i.cd,C=i.xa,k=i.ya,L=S[0].trace,I=S[0].t,R=L.type==="violin",V=[],O=I.bdPos,J=I.wHover,D=function(le){return g.c2l(le.pos)+I.bPos-g.c2l(y)};R&&L.side!=="both"?(L.side==="positive"&&(w=function(le){var fe=D(le);return p.inbox(fe,fe+J,A)},M=O,b=0),L.side==="negative"&&(w=function(le){var fe=D(le);return p.inbox(fe-J,fe,A)},M=0,b=O)):(w=function(le){var fe=D(le);return p.inbox(fe-J,fe+J,A)},M=b=O),_=R?function(le){return p.inbox(le.span[0]-m,le.span[1]-m,A)}:function(le){return p.inbox(le.min-m,le.max-m,A)},L.orientation==="h"?(m=u,y=s,v=_,T=w,c="y",g=k,f="x",d=C):(m=s,y=u,v=w,T=_,c="x",g=C,f="y",d=k);var B=Math.min(1,O/Math.abs(g.r2c(g.range[1])-g.r2c(g.range[0])));function N(le){return(v(le)+T(le))/2}A=i.maxHoverDistance-B,E=i.maxSpikeDistance-B;var F=p.getDistanceFunction(a,v,T,N);if(p.getClosest(S,F,i),i.index===!1)return[];var H=S[i.index],j=L.line.color,G=(L.marker||{}).color;l.opacity(j)&&L.line.width?i.color=j:l.opacity(G)&&L.boxpoints?i.color=G:i.color=L.fillcolor,i[c+"0"]=g.c2p(H.pos+I.bPos-b,!0),i[c+"1"]=g.c2p(H.pos+I.bPos+M,!0),i[c+"LabelVal"]=H.orig_p!==void 0?H.orig_p:H.pos;var W=c+"Spike";i.spikeDistance=N(H)*E/A,i[W]=g.c2p(H.pos,!0);var Q={},$=["med","q1","q3","min","max"];(L.boxmean||(L.meanline||{}).visible)&&$.push("mean"),(L.boxpoints||L.points)&&$.push("lf","uf");for(var ee=0;ee<$.length;ee++){var ie=$[ee];if(ie in H&&!(H[ie]in Q)){Q[H[ie]]=!0;var ae=H[ie],oe=d.c2p(ae,!0),de=h.extendFlat({},i);de.attr=ie,de[f+"0"]=de[f+"1"]=oe,de[f+"LabelVal"]=ae,de[f+"Label"]=(I.labels?I.labels[ie]+" ":"")+t.hoverLabelText(d,ae),de.hoverOnBox=!0,ie==="mean"&&"sd"in H&&L.boxmean==="sd"&&(de[f+"err"]=H.sd),i.name="",i.spikeDistance=void 0,i[W]=void 0,de.hovertemplate=!1,V.push(de)}}return V}function r(i,u,s){for(var a,c,f,g=i.cd,d=i.xa,m=i.ya,y=g[0].trace,v=d.c2p(u),T=m.c2p(s),w=p.quadrature(function(R){var V=Math.max(3,R.mrc||0);return Math.max(Math.abs(d.c2p(R.x)-v)-V,1-3/V)},function(R){var V=Math.max(3,R.mrc||0);return Math.max(Math.abs(m.c2p(R.y)-T)-V,1-3/V)}),A=!1,E=0;E<g.length;E++){c=g[E];for(var M=0;M<(c.pts||[]).length;M++){var b=w(f=c.pts[M]);b<=i.distance&&(i.distance=b,A=[E,M])}}if(!A)return!1;f=(c=g[A[0]]).pts[A[1]];var _=d.c2p(f.x,!0),S=m.c2p(f.y,!0),C=f.mrc||1;a=h.extendFlat({},i,{index:f.i,color:(y.marker||{}).color,name:y.name,x0:_-C,x1:_+C,y0:S-C,y1:S+C,spikeDistance:i.distance,hovertemplate:y.hovertemplate});var k,L=c.orig_p,I=L!==void 0?L:c.pos;return y.orientation==="h"?(k=m,a.xLabelVal=f.x,a.yLabelVal=I):(k=d,a.xLabelVal=I,a.yLabelVal=f.y),a[k._id.charAt(0)+"Spike"]=k.c2p(c.pos,!0),e(f,y,a),a}z.exports={hoverPoints:function(i,u,s,a){var c,f=i.cd[0].trace.hoveron,g=[];return f.indexOf("boxes")!==-1&&(g=g.concat(o(i,u,s,a))),f.indexOf("points")!==-1&&(c=r(i,u,s)),a==="closest"?c?[c]:g:(c&&g.push(c),g)},hoverOnBoxes:o,hoverOnPoints:r}},{"../../components/color":643,"../../components/fx":683,"../../lib":778,"../../plots/cartesian/axes":828}],952:[function(n,z,q){"use strict";z.exports={attributes:n("./attributes"),layoutAttributes:n("./layout_attributes"),supplyDefaults:n("./defaults").supplyDefaults,crossTraceDefaults:n("./defaults").crossTraceDefaults,supplyLayoutDefaults:n("./layout_defaults").supplyLayoutDefaults,calc:n("./calc"),crossTraceCalc:n("./cross_trace_calc").crossTraceCalc,plot:n("./plot").plot,style:n("./style").style,styleOnSelect:n("./style").styleOnSelect,hoverPoints:n("./hover").hoverPoints,eventData:n("./event_data"),selectPoints:n("./select"),moduleType:"trace",name:"box",basePlotModule:n("../../plots/cartesian"),categories:["cartesian","svg","symbols","oriented","box-violin","showLegend","boxLayout","zoomScale"],meta:{}}},{"../../plots/cartesian":841,"./attributes":946,"./calc":947,"./cross_trace_calc":948,"./defaults":949,"./event_data":950,"./hover":951,"./layout_attributes":953,"./layout_defaults":954,"./plot":955,"./select":956,"./style":957}],953:[function(n,z,q){"use strict";z.exports={boxmode:{valType:"enumerated",values:["group","overlay"],dflt:"overlay",editType:"calc"},boxgap:{valType:"number",min:0,max:1,dflt:.3,editType:"calc"},boxgroupgap:{valType:"number",min:0,max:1,dflt:.3,editType:"calc"}}},{}],954:[function(n,z,q){"use strict";var t=n("../../registry"),h=n("../../lib"),p=n("./layout_attributes");function l(e,o,r,i,u){for(var s=u+"Layout",a=!1,c=0;c<r.length;c++){var f=r[c];if(t.traceIs(f,s)){a=!0;break}}a&&(i(u+"mode"),i(u+"gap"),i(u+"groupgap"))}z.exports={supplyLayoutDefaults:function(e,o,r){l(0,0,r,function(i,u){return h.coerce(e,o,p,i,u)},"box")},_supply:l}},{"../../lib":778,"../../registry":911,"./layout_attributes":953}],955:[function(n,z,q){"use strict";var t=n("d3"),h=n("../../lib"),p=n("../../components/drawing");function l(r,i,u,s){var a,c,f=u.orientation==="h",g=i.val,d=i.pos,m=!!d.rangebreaks,y=s.bPos,v=s.wdPos||0,T=s.bPosPxOffset||0,w=u.whiskerwidth||0,A=u.notched||!1,E=A?1-2*u.notchwidth:1;Array.isArray(s.bdPos)?(a=s.bdPos[0],c=s.bdPos[1]):(a=s.bdPos,c=s.bdPos);var M=r.selectAll("path.box").data(u.type!=="violin"||u.box.visible?h.identity:[]);M.enter().append("path").style("vector-effect","non-scaling-stroke").attr("class","box"),M.exit().remove(),M.each(function(b){if(b.empty)return"M0,0Z";var _=d.c2l(b.pos+y,!0),S=d.l2p(_-a)+T,C=d.l2p(_+c)+T,k=m?(S+C)/2:d.l2p(_)+T,L=u.whiskerwidth,I=m?S*L+(1-L)*k:d.l2p(_-v)+T,R=m?C*L+(1-L)*k:d.l2p(_+v)+T,V=d.l2p(_-a*E)+T,O=d.l2p(_+c*E)+T,J=g.c2p(b.q1,!0),D=g.c2p(b.q3,!0),B=h.constrain(g.c2p(b.med,!0),Math.min(J,D)+1,Math.max(J,D)-1),N=b.lf===void 0||u.boxpoints===!1,F=g.c2p(N?b.min:b.lf,!0),H=g.c2p(N?b.max:b.uf,!0),j=g.c2p(b.ln,!0),G=g.c2p(b.un,!0);f?t.select(this).attr("d","M"+B+","+V+"V"+O+"M"+J+","+S+"V"+C+(A?"H"+j+"L"+B+","+O+"L"+G+","+C:"")+"H"+D+"V"+S+(A?"H"+G+"L"+B+","+V+"L"+j+","+S:"")+"ZM"+J+","+k+"H"+F+"M"+D+","+k+"H"+H+(w===0?"":"M"+F+","+I+"V"+R+"M"+H+","+I+"V"+R)):t.select(this).attr("d","M"+V+","+B+"H"+O+"M"+S+","+J+"H"+C+(A?"V"+j+"L"+O+","+B+"L"+C+","+G:"")+"V"+D+"H"+S+(A?"V"+G+"L"+V+","+B+"L"+S+","+j:"")+"ZM"+k+","+J+"V"+F+"M"+k+","+D+"V"+H+(w===0?"":"M"+I+","+F+"H"+R+"M"+I+","+H+"H"+R))})}function e(r,i,u,s){var a=i.x,c=i.y,f=s.bdPos,g=s.bPos,d=u.boxpoints||u.points;h.seedPseudoRandom();var m=r.selectAll("g.points").data(d?function(v){return v.forEach(function(T){T.t=s,T.trace=u}),v}:[]);m.enter().append("g").attr("class","points"),m.exit().remove();var y=m.selectAll("path").data(function(v){var T,w,A=v.pts2,E=Math.max((v.max-v.min)/10,v.q3-v.q1),M=1e-9*E,b=.01*E,_=[],S=0;if(u.jitter){if(E===0)for(S=1,_=new Array(A.length),T=0;T<A.length;T++)_[T]=1;else for(T=0;T<A.length;T++){var C=Math.max(0,T-5),k=A[C].v,L=Math.min(A.length-1,T+5),I=A[L].v;d!=="all"&&(A[T].v<v.lf?I=Math.min(I,v.lf):k=Math.max(k,v.uf));var R=Math.sqrt(b*(L-C)/(I-k+M))||0;R=h.constrain(Math.abs(R),0,1),_.push(R),S=Math.max(R,S)}w=2*u.jitter/(S||1)}for(T=0;T<A.length;T++){var V=A[T],O=V.v,J=u.jitter?w*_[T]*(h.pseudoRandom()-.5):0,D=v.pos+g+f*(u.pointpos+J);u.orientation==="h"?(V.y=D,V.x=O):(V.x=D,V.y=O),d==="suspectedoutliers"&&O<v.uo&&O>v.lo&&(V.so=!0)}return A});y.enter().append("path").classed("point",!0),y.exit().remove(),y.call(p.translatePoints,a,c)}function o(r,i,u,s){var a,c,f=i.val,g=i.pos,d=!!g.rangebreaks,m=s.bPos,y=s.bPosPxOffset||0,v=u.boxmean||(u.meanline||{}).visible;Array.isArray(s.bdPos)?(a=s.bdPos[0],c=s.bdPos[1]):(a=s.bdPos,c=s.bdPos);var T=r.selectAll("path.mean").data(u.type==="box"&&u.boxmean||u.type==="violin"&&u.box.visible&&u.meanline.visible?h.identity:[]);T.enter().append("path").attr("class","mean").style({fill:"none","vector-effect":"non-scaling-stroke"}),T.exit().remove(),T.each(function(w){var A=g.c2l(w.pos+m,!0),E=g.l2p(A-a)+y,M=g.l2p(A+c)+y,b=d?(E+M)/2:g.l2p(A)+y,_=f.c2p(w.mean,!0),S=f.c2p(w.mean-w.sd,!0),C=f.c2p(w.mean+w.sd,!0);u.orientation==="h"?t.select(this).attr("d","M"+_+","+E+"V"+M+(v==="sd"?"m0,0L"+S+","+b+"L"+_+","+E+"L"+C+","+b+"Z":"")):t.select(this).attr("d","M"+E+","+_+"H"+M+(v==="sd"?"m0,0L"+b+","+S+"L"+E+","+_+"L"+b+","+C+"Z":""))})}z.exports={plot:function(r,i,u,s){var a=i.xaxis,c=i.yaxis;h.makeTraceGroups(s,u,"trace boxes").each(function(f){var g,d,m=t.select(this),y=f[0],v=y.t,T=y.trace;v.wdPos=v.bdPos*T.whiskerwidth,T.visible!==!0||v.empty?m.remove():(T.orientation==="h"?(g=c,d=a):(g=a,d=c),l(m,{pos:g,val:d},T,v),e(m,{x:a,y:c},T,v),o(m,{pos:g,val:d},T,v))})},plotBoxAndWhiskers:l,plotPoints:e,plotBoxMean:o}},{"../../components/drawing":665,"../../lib":778,d3:169}],956:[function(n,z,q){"use strict";z.exports=function(t,h){var p,l,e=t.cd,o=t.xaxis,r=t.yaxis,i=[];if(h===!1)for(p=0;p<e.length;p++)for(l=0;l<(e[p].pts||[]).length;l++)e[p].pts[l].selected=0;else for(p=0;p<e.length;p++)for(l=0;l<(e[p].pts||[]).length;l++){var u=e[p].pts[l],s=o.c2p(u.x),a=r.c2p(u.y);h.contains([s,a],null,u.i,t)?(i.push({pointNumber:u.i,x:o.c2d(u.x),y:r.c2d(u.y)}),u.selected=1):u.selected=0}return i}},{}],957:[function(n,z,q){"use strict";var t=n("d3"),h=n("../../components/color"),p=n("../../components/drawing");z.exports={style:function(l,e,o){var r=o||t.select(l).selectAll("g.trace.boxes");r.style("opacity",function(i){return i[0].trace.opacity}),r.each(function(i){var u=t.select(this),s=i[0].trace,a=s.line.width;function c(d,m,y,v){d.style("stroke-width",m+"px").call(h.stroke,y).call(h.fill,v)}var f=u.selectAll("path.box");if(s.type==="candlestick")f.each(function(d){if(!d.empty){var m=t.select(this),y=s[d.dir];c(m,y.line.width,y.line.color,y.fillcolor),m.style("opacity",s.selectedpoints&&!d.selected?.3:1)}});else{c(f,a,s.line.color,s.fillcolor),u.selectAll("path.mean").style({"stroke-width":a,"stroke-dasharray":2*a+"px,"+a+"px"}).call(h.stroke,s.line.color);var g=u.selectAll("path.point");p.pointStyle(g,s,l)}})},styleOnSelect:function(l,e,o){var r=e[0].trace,i=o.selectAll("path.point");r.selectedpoints?p.selectedPointStyle(i,r):p.pointStyle(i,r,l)}}},{"../../components/color":643,"../../components/drawing":665,d3:169}],958:[function(n,z,q){"use strict";var t=n("../../lib").extendFlat,h=n("../ohlc/attributes"),p=n("../box/attributes");function l(e){return{line:{color:t({},p.line.color,{dflt:e}),width:p.line.width,editType:"style"},fillcolor:p.fillcolor,editType:"style"}}z.exports={xperiod:h.xperiod,xperiod0:h.xperiod0,xperiodalignment:h.xperiodalignment,x:h.x,open:h.open,high:h.high,low:h.low,close:h.close,line:{width:t({},p.line.width,{}),editType:"style"},increasing:l(h.increasing.line.color.dflt),decreasing:l(h.decreasing.line.color.dflt),text:h.text,hovertext:h.hovertext,whiskerwidth:t({},p.whiskerwidth,{dflt:0}),hoverlabel:h.hoverlabel}},{"../../lib":778,"../box/attributes":946,"../ohlc/attributes":1133}],959:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../../plots/cartesian/axes"),p=n("../../plots/cartesian/align_period"),l=n("../ohlc/calc").calcCommon;function e(o,r,i,u){return{min:i,q1:Math.min(o,u),med:u,q3:Math.max(o,u),max:r}}z.exports=function(o,r){var i=o._fullLayout,u=h.getFromId(o,r.xaxis),s=h.getFromId(o,r.yaxis),a=u.makeCalcdata(r,"x"),c=p(r,u,"x",a),f=l(o,r,a,c,s,e);return f.length?(t.extendFlat(f[0].t,{num:i._numBoxes,dPos:t.distinctVals(c).minDiff/2,posLetter:"x",valLetter:"y"}),i._numBoxes++,f):[{t:{empty:!0}}]}},{"../../lib":778,"../../plots/cartesian/align_period":825,"../../plots/cartesian/axes":828,"../ohlc/calc":1134}],960:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../../components/color"),p=n("../ohlc/ohlc_defaults"),l=n("../scatter/period_defaults"),e=n("./attributes");function o(r,i,u,s){var a=u(s+".line.color");u(s+".line.width",i.line.width),u(s+".fillcolor",h.addOpacity(a,.5))}z.exports=function(r,i,u,s){function a(c,f){return t.coerce(r,i,e,c,f)}p(r,i,a,s)?(l(r,i,s,a,{x:!0}),a("line.width"),o(r,i,a,"increasing"),o(r,i,a,"decreasing"),a("text"),a("hovertext"),a("whiskerwidth"),s._requestRangeslider[i.xaxis]=!0):i.visible=!1}},{"../../components/color":643,"../../lib":778,"../ohlc/ohlc_defaults":1138,"../scatter/period_defaults":1207,"./attributes":958}],961:[function(n,z,q){"use strict";z.exports={moduleType:"trace",name:"candlestick",basePlotModule:n("../../plots/cartesian"),categories:["cartesian","svg","showLegend","candlestick","boxLayout"],meta:{},attributes:n("./attributes"),layoutAttributes:n("../box/layout_attributes"),supplyLayoutDefaults:n("../box/layout_defaults").supplyLayoutDefaults,crossTraceCalc:n("../box/cross_trace_calc").crossTraceCalc,supplyDefaults:n("./defaults"),calc:n("./calc"),plot:n("../box/plot").plot,layerName:"boxlayer",style:n("../box/style").style,hoverPoints:n("../ohlc/hover").hoverPoints,selectPoints:n("../ohlc/select")}},{"../../plots/cartesian":841,"../box/cross_trace_calc":948,"../box/layout_attributes":953,"../box/layout_defaults":954,"../box/plot":955,"../box/style":957,"../ohlc/hover":1136,"../ohlc/select":1140,"./attributes":958,"./calc":959,"./defaults":960}],962:[function(n,z,q){"use strict";var t=n("./axis_defaults"),h=n("../../plot_api/plot_template");z.exports=function(p,l,e,o,r){o("a")||(o("da"),o("a0")),o("b")||(o("db"),o("b0")),function(i,u,s,a){["aaxis","baxis"].forEach(function(c){var f=c.charAt(0),g=i[c]||{},d=h.newContainer(u,c),m={tickfont:"x",id:f+"axis",letter:f,font:u.font,name:c,data:i[f],calendar:u.calendar,dfltColor:a,bgColor:s.paper_bgcolor,autotypenumbersDflt:s.autotypenumbers,fullLayout:s};t(g,d,m),d._categories=d._categories||[],i[c]||g.type==="-"||(i[c]={type:g.type})})}(p,l,e,r)}},{"../../plot_api/plot_template":817,"./axis_defaults":967}],963:[function(n,z,q){"use strict";var t=n("../../lib").isArrayOrTypedArray;z.exports=function(h){return function p(l,e){if(!t(l)||e>=10)return null;for(var o=1/0,r=-1/0,i=l.length,u=0;u<i;u++){var s=l[u];if(t(s)){var a=p(s,e+1);a&&(o=Math.min(a[0],o),r=Math.max(a[1],r))}else o=Math.min(s,o),r=Math.max(s,r)}return[o,r]}(h,0)}},{"../../lib":778}],964:[function(n,z,q){"use strict";var t=n("../../plots/font_attributes"),h=n("./axis_attributes"),p=n("../../components/color/attributes"),l=t({editType:"calc"});l.family.dflt='"Open Sans", verdana, arial, sans-serif',l.size.dflt=12,l.color.dflt=p.defaultLine,z.exports={carpet:{valType:"string",editType:"calc"},x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},a:{valType:"data_array",editType:"calc"},a0:{valType:"number",dflt:0,editType:"calc"},da:{valType:"number",dflt:1,editType:"calc"},b:{valType:"data_array",editType:"calc"},b0:{valType:"number",dflt:0,editType:"calc"},db:{valType:"number",dflt:1,editType:"calc"},cheaterslope:{valType:"number",dflt:1,editType:"calc"},aaxis:h,baxis:h,font:l,color:{valType:"color",dflt:p.defaultLine,editType:"plot"},transforms:void 0}},{"../../components/color/attributes":642,"../../plots/font_attributes":856,"./axis_attributes":966}],965:[function(n,z,q){"use strict";var t=n("../../lib").isArrayOrTypedArray;z.exports=function(h,p,l,e){var o,r,i,u,s,a,c,f,g,d,m,y,v,T=t(l)?"a":"b",w=(T==="a"?h.aaxis:h.baxis).smoothing,A=T==="a"?h.a2i:h.b2j,E=T==="a"?l:e,M=T==="a"?e:l,b=T==="a"?p.a.length:p.b.length,_=T==="a"?p.b.length:p.a.length,S=Math.floor(T==="a"?h.b2j(M):h.a2i(M)),C=T==="a"?function(H){return h.evalxy([],H,S)}:function(H){return h.evalxy([],S,H)};w&&(i=Math.max(0,Math.min(_-2,S)),u=S-i,r=T==="a"?function(H,j){return h.dxydi([],H,i,j,u)}:function(H,j){return h.dxydj([],i,H,u,j)});var k=A(E[0]),L=A(E[1]),I=k<L?1:-1,R=1e-8*(L-k),V=I>0?Math.floor:Math.ceil,O=I>0?Math.ceil:Math.floor,J=I>0?Math.min:Math.max,D=I>0?Math.max:Math.min,B=V(k+R),N=O(L-R),F=[[c=C(k)]];for(o=B;o*I<N*I;o+=I)s=[],m=D(k,o),v=(y=J(L,o+I))-m,a=Math.max(0,Math.min(b-2,Math.floor(.5*(m+y)))),f=C(y),w&&(g=r(a,m-a),d=r(a,y-a),s.push([c[0]+g[0]/3*v,c[1]+g[1]/3*v]),s.push([f[0]-d[0]/3*v,f[1]-d[1]/3*v])),s.push(f),F.push(s),c=f;return F}},{"../../lib":778}],966:[function(n,z,q){"use strict";var t=n("../../plots/font_attributes"),h=n("../../components/color/attributes"),p=n("../../plots/cartesian/layout_attributes"),l=n("../../plot_api/edit_types").overrideAll;n("../../constants/docs").FORMAT_LINK,n("../../constants/docs").TIME_FORMAT_LINK,z.exports={color:{valType:"color",editType:"calc"},smoothing:{valType:"number",dflt:1,min:0,max:1.3,editType:"calc"},title:{text:{valType:"string",dflt:"",editType:"calc"},font:t({editType:"calc"}),offset:{valType:"number",dflt:10,editType:"calc"},editType:"calc"},type:{valType:"enumerated",values:["-","linear","date","category"],dflt:"-",editType:"calc"},autotypenumbers:p.autotypenumbers,autorange:{valType:"enumerated",values:[!0,!1,"reversed"],dflt:!0,editType:"calc"},rangemode:{valType:"enumerated",values:["normal","tozero","nonnegative"],dflt:"normal",editType:"calc"},range:{valType:"info_array",editType:"calc",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}]},fixedrange:{valType:"boolean",dflt:!1,editType:"calc"},cheatertype:{valType:"enumerated",values:["index","value"],dflt:"value",editType:"calc"},tickmode:{valType:"enumerated",values:["linear","array"],dflt:"array",editType:"calc"},nticks:{valType:"integer",min:0,dflt:0,editType:"calc"},tickvals:{valType:"data_array",editType:"calc"},ticktext:{valType:"data_array",editType:"calc"},showticklabels:{valType:"enumerated",values:["start","end","both","none"],dflt:"start",editType:"calc"},tickfont:t({editType:"calc"}),tickangle:{valType:"angle",dflt:"auto",editType:"calc"},tickprefix:{valType:"string",dflt:"",editType:"calc"},showtickprefix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},ticksuffix:{valType:"string",dflt:"",editType:"calc"},showticksuffix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},showexponent:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},exponentformat:{valType:"enumerated",values:["none","e","E","power","SI","B"],dflt:"B",editType:"calc"},minexponent:{valType:"number",dflt:3,min:0,editType:"calc"},separatethousands:{valType:"boolean",dflt:!1,editType:"calc"},tickformat:{valType:"string",dflt:"",editType:"calc"},tickformatstops:l(p.tickformatstops,"calc","from-root"),categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},labelpadding:{valType:"integer",dflt:10,editType:"calc"},labelprefix:{valType:"string",editType:"calc"},labelsuffix:{valType:"string",dflt:"",editType:"calc"},showline:{valType:"boolean",dflt:!1,editType:"calc"},linecolor:{valType:"color",dflt:h.defaultLine,editType:"calc"},linewidth:{valType:"number",min:0,dflt:1,editType:"calc"},gridcolor:{valType:"color",editType:"calc"},gridwidth:{valType:"number",min:0,dflt:1,editType:"calc"},showgrid:{valType:"boolean",dflt:!0,editType:"calc"},minorgridcount:{valType:"integer",min:0,dflt:0,editType:"calc"},minorgridwidth:{valType:"number",min:0,dflt:1,editType:"calc"},minorgridcolor:{valType:"color",dflt:h.lightLine,editType:"calc"},startline:{valType:"boolean",editType:"calc"},startlinecolor:{valType:"color",editType:"calc"},startlinewidth:{valType:"number",dflt:1,editType:"calc"},endline:{valType:"boolean",editType:"calc"},endlinewidth:{valType:"number",dflt:1,editType:"calc"},endlinecolor:{valType:"color",editType:"calc"},tick0:{valType:"number",min:0,dflt:0,editType:"calc"},dtick:{valType:"number",min:0,dflt:1,editType:"calc"},arraytick0:{valType:"integer",min:0,dflt:0,editType:"calc"},arraydtick:{valType:"integer",min:1,dflt:1,editType:"calc"},_deprecated:{title:{valType:"string",editType:"calc"},titlefont:t({editType:"calc"}),titleoffset:{valType:"number",dflt:10,editType:"calc"}},editType:"calc"}},{"../../components/color/attributes":642,"../../constants/docs":748,"../../plot_api/edit_types":810,"../../plots/cartesian/layout_attributes":842,"../../plots/font_attributes":856}],967:[function(n,z,q){"use strict";var t=n("./attributes"),h=n("../../components/color").addOpacity,p=n("../../registry"),l=n("../../lib"),e=n("../../plots/cartesian/tick_value_defaults"),o=n("../../plots/cartesian/tick_label_defaults"),r=n("../../plots/cartesian/category_order_defaults"),i=n("../../plots/cartesian/set_convert"),u=n("../../plots/cartesian/axis_autotype");z.exports=function(s,a,c){var f=c.letter,g=c.font||{},d=t[f+"axis"];function m(k,L){return l.coerce(s,a,d,k,L)}function y(k,L){return l.coerce2(s,a,d,k,L)}c.name&&(a._name=c.name,a._id=c.name),m("autotypenumbers",c.autotypenumbersDflt);var v=m("type");v==="-"&&(c.data&&function(k,L){if(k.type==="-"){var I=k._id.charAt(0),R=k[I+"calendar"];k.type=u(L,R,{autotypenumbers:k.autotypenumbers})}}(a,c.data),a.type==="-"?a.type="linear":v=s.type=a.type),m("smoothing"),m("cheatertype"),m("showticklabels"),m("labelprefix",f+" = "),m("labelsuffix"),m("showtickprefix"),m("showticksuffix"),m("separatethousands"),m("tickformat"),m("exponentformat"),m("minexponent"),m("showexponent"),m("categoryorder"),m("tickmode"),m("tickvals"),m("ticktext"),m("tick0"),m("dtick"),a.tickmode==="array"&&(m("arraytick0"),m("arraydtick")),m("labelpadding"),a._hovertitle=f,v==="date"&&p.getComponentMethod("calendars","handleDefaults")(s,a,"calendar",c.calendar),i(a,c.fullLayout),a.c2p=l.identity;var T=m("color",c.dfltColor),w=T===s.color?T:g.color;m("title.text")&&(l.coerceFont(m,"title.font",{family:g.family,size:Math.round(1.2*g.size),color:w}),m("title.offset")),m("tickangle"),m("autorange",!a.isValidRange(s.range))&&m("rangemode"),m("range"),a.cleanRange(),m("fixedrange"),e(s,a,m,v),o(s,a,m,v,c),r(s,a,m,{data:c.data,dataAttr:f});var A=y("gridcolor",h(T,.3)),E=y("gridwidth"),M=m("showgrid");M||(delete a.gridcolor,delete a.gridwidth);var b=y("startlinecolor",T),_=y("startlinewidth",E);m("startline",a.showgrid||!!b||!!_)||(delete a.startlinecolor,delete a.startlinewidth);var S=y("endlinecolor",T),C=y("endlinewidth",E);return m("endline",a.showgrid||!!S||!!C)||(delete a.endlinecolor,delete a.endlinewidth),M?(m("minorgridcount"),m("minorgridwidth",E),m("minorgridcolor",h(A,.06)),a.minorgridcount||(delete a.minorgridwidth,delete a.minorgridcolor)):(delete a.gridcolor,delete a.gridWidth),a.showticklabels==="none"&&(delete a.tickfont,delete a.tickangle,delete a.showexponent,delete a.exponentformat,delete a.minexponent,delete a.tickformat,delete a.showticksuffix,delete a.showtickprefix),a.showticksuffix||delete a.ticksuffix,a.showtickprefix||delete a.tickprefix,m("tickmode"),a}},{"../../components/color":643,"../../lib":778,"../../plots/cartesian/axis_autotype":829,"../../plots/cartesian/category_order_defaults":832,"../../plots/cartesian/set_convert":848,"../../plots/cartesian/tick_label_defaults":849,"../../plots/cartesian/tick_value_defaults":851,"../../registry":911,"./attributes":964}],968:[function(n,z,q){"use strict";var t=n("../../plots/cartesian/axes"),h=n("../../lib").isArray1D,p=n("./cheater_basis"),l=n("./array_minmax"),e=n("./calc_gridlines"),o=n("./calc_labels"),r=n("./calc_clippath"),i=n("../heatmap/clean_2d_array"),u=n("./smooth_fill_2d_array"),s=n("../heatmap/convert_column_xyz"),a=n("./set_convert");z.exports=function(c,f){var g=t.getFromId(c,f.xaxis),d=t.getFromId(c,f.yaxis),m=f.aaxis,y=f.baxis,v=f.x,T=f.y,w=[];v&&h(v)&&w.push("x"),T&&h(T)&&w.push("y"),w.length&&s(f,m,y,"a","b",w);var A=f._a=f._a||f.a,E=f._b=f._b||f.b;v=f._x||f.x,T=f._y||f.y;var M={};if(f._cheater){var b=m.cheatertype==="index"?A.length:A,_=y.cheatertype==="index"?E.length:E;v=p(b,_,f.cheaterslope)}f._x=v=i(v),f._y=T=i(T),u(v,A,E),u(T,A,E),a(f),f.setScale();var S=l(v),C=l(T),k=.5*(S[1]-S[0]),L=.5*(S[1]+S[0]),I=.5*(C[1]-C[0]),R=.5*(C[1]+C[0]);return S=[L-1.3*k,L+1.3*k],C=[R-1.3*I,R+1.3*I],f._extremes[g._id]=t.findExtremes(g,S,{padded:!0}),f._extremes[d._id]=t.findExtremes(d,C,{padded:!0}),e(f,"a","b"),e(f,"b","a"),o(f,m),o(f,y),M.clipsegments=r(f._xctrl,f._yctrl,m,y),M.x=v,M.y=T,M.a=A,M.b=E,[M]}},{"../../lib":778,"../../plots/cartesian/axes":828,"../heatmap/clean_2d_array":1067,"../heatmap/convert_column_xyz":1069,"./array_minmax":963,"./calc_clippath":969,"./calc_gridlines":970,"./calc_labels":971,"./cheater_basis":973,"./set_convert":986,"./smooth_fill_2d_array":987}],969:[function(n,z,q){"use strict";z.exports=function(t,h,p,l){var e,o,r,i=[],u=!!p.smoothing,s=!!l.smoothing,a=t[0].length-1,c=t.length-1;for(e=0,o=[],r=[];e<=a;e++)o[e]=t[0][e],r[e]=h[0][e];for(i.push({x:o,y:r,bicubic:u}),e=0,o=[],r=[];e<=c;e++)o[e]=t[e][a],r[e]=h[e][a];for(i.push({x:o,y:r,bicubic:s}),e=a,o=[],r=[];e>=0;e--)o[a-e]=t[c][e],r[a-e]=h[c][e];for(i.push({x:o,y:r,bicubic:u}),e=c,o=[],r=[];e>=0;e--)o[c-e]=t[e][0],r[c-e]=h[e][0];return i.push({x:o,y:r,bicubic:s}),i}},{}],970:[function(n,z,q){"use strict";var t=n("../../plots/cartesian/axes"),h=n("../../lib/extend").extendFlat;z.exports=function(p,l,e){var o,r,i,u,s,a,c,f,g,d,m,y,v,T,w=p["_"+l],A=p[l+"axis"],E=A._gridlines=[],M=A._minorgridlines=[],b=A._boundarylines=[],_=p["_"+e],S=p[e+"axis"];A.tickmode==="array"&&(A.tickvals=w.slice());var C=p._xctrl,k=p._yctrl,L=C[0].length,I=C.length,R=p._a.length,V=p._b.length;t.prepTicks(A),A.tickmode==="array"&&delete A.tickvals;var O=A.smoothing?3:1;function J(B){var N,F,H,j,G,W,Q,$,ee,ie,ae,oe,de=[],le=[],fe={};if(l==="b")for(F=p.b2j(B),H=Math.floor(Math.max(0,Math.min(V-2,F))),j=F-H,fe.length=V,fe.crossLength=R,fe.xy=function(ue){return p.evalxy([],ue,F)},fe.dxy=function(ue,we){return p.dxydi([],ue,H,we,j)},N=0;N<R;N++)W=Math.min(R-2,N),Q=N-W,$=p.evalxy([],N,F),S.smoothing&&N>0&&(ee=p.dxydi([],N-1,H,0,j),de.push(G[0]+ee[0]/3),le.push(G[1]+ee[1]/3),ie=p.dxydi([],N-1,H,1,j),de.push($[0]-ie[0]/3),le.push($[1]-ie[1]/3)),de.push($[0]),le.push($[1]),G=$;else for(N=p.a2i(B),W=Math.floor(Math.max(0,Math.min(R-2,N))),Q=N-W,fe.length=R,fe.crossLength=V,fe.xy=function(ue){return p.evalxy([],N,ue)},fe.dxy=function(ue,we){return p.dxydj([],W,ue,Q,we)},F=0;F<V;F++)H=Math.min(V-2,F),j=F-H,$=p.evalxy([],N,F),S.smoothing&&F>0&&(ae=p.dxydj([],W,F-1,Q,0),de.push(G[0]+ae[0]/3),le.push(G[1]+ae[1]/3),oe=p.dxydj([],W,F-1,Q,1),de.push($[0]-oe[0]/3),le.push($[1]-oe[1]/3)),de.push($[0]),le.push($[1]),G=$;return fe.axisLetter=l,fe.axis=A,fe.crossAxis=S,fe.value=B,fe.constvar=e,fe.index=f,fe.x=de,fe.y=le,fe.smoothing=S.smoothing,fe}function D(B){var N,F,H,j,G,W=[],Q=[],$={};if($.length=w.length,$.crossLength=_.length,l==="b")for(H=Math.max(0,Math.min(V-2,B)),G=Math.min(1,Math.max(0,B-H)),$.xy=function(ee){return p.evalxy([],ee,B)},$.dxy=function(ee,ie){return p.dxydi([],ee,H,ie,G)},N=0;N<L;N++)W[N]=C[B*O][N],Q[N]=k[B*O][N];else for(F=Math.max(0,Math.min(R-2,B)),j=Math.min(1,Math.max(0,B-F)),$.xy=function(ee){return p.evalxy([],B,ee)},$.dxy=function(ee,ie){return p.dxydj([],F,ee,j,ie)},N=0;N<I;N++)W[N]=C[N][B*O],Q[N]=k[N][B*O];return $.axisLetter=l,$.axis=A,$.crossAxis=S,$.value=w[B],$.constvar=e,$.index=B,$.x=W,$.y=Q,$.smoothing=S.smoothing,$}if(A.tickmode==="array"){for(u=5e-15,a=(s=[Math.floor((w.length-1-A.arraytick0)/A.arraydtick*(1+u)),Math.ceil(-A.arraytick0/A.arraydtick/(1+u))].sort(function(B,N){return B-N}))[0]-1,c=s[1]+1,f=a;f<c;f++)(r=A.arraytick0+A.arraydtick*f)<0||r>w.length-1||E.push(h(D(r),{color:A.gridcolor,width:A.gridwidth}));for(f=a;f<c;f++)if(i=A.arraytick0+A.arraydtick*f,m=Math.min(i+A.arraydtick,w.length-1),!(i<0||i>w.length-1||m<0||m>w.length-1))for(y=w[i],v=w[m],o=0;o<A.minorgridcount;o++)(T=m-i)<=0||(d=y+(v-y)*(o+1)/(A.minorgridcount+1)*(A.arraydtick/T))<w[0]||d>w[w.length-1]||M.push(h(J(d),{color:A.minorgridcolor,width:A.minorgridwidth}));A.startline&&b.push(h(D(0),{color:A.startlinecolor,width:A.startlinewidth})),A.endline&&b.push(h(D(w.length-1),{color:A.endlinecolor,width:A.endlinewidth}))}else{for(u=5e-15,a=(s=[Math.floor((w[w.length-1]-A.tick0)/A.dtick*(1+u)),Math.ceil((w[0]-A.tick0)/A.dtick/(1+u))].sort(function(B,N){return B-N}))[0],c=s[1],f=a;f<=c;f++)g=A.tick0+A.dtick*f,E.push(h(J(g),{color:A.gridcolor,width:A.gridwidth}));for(f=a-1;f<c+1;f++)for(g=A.tick0+A.dtick*f,o=0;o<A.minorgridcount;o++)(d=g+A.dtick*(o+1)/(A.minorgridcount+1))<w[0]||d>w[w.length-1]||M.push(h(J(d),{color:A.minorgridcolor,width:A.minorgridwidth}));A.startline&&b.push(h(J(w[0]),{color:A.startlinecolor,width:A.startlinewidth})),A.endline&&b.push(h(J(w[w.length-1]),{color:A.endlinecolor,width:A.endlinewidth}))}}},{"../../lib/extend":768,"../../plots/cartesian/axes":828}],971:[function(n,z,q){"use strict";var t=n("../../plots/cartesian/axes"),h=n("../../lib/extend").extendFlat;z.exports=function(p,l){var e,o,r,i=l._labels=[],u=l._gridlines;for(e=0;e<u.length;e++)r=u[e],["start","both"].indexOf(l.showticklabels)!==-1&&(o=t.tickText(l,r.value),h(o,{prefix:void 0,suffix:void 0,endAnchor:!0,xy:r.xy(0),dxy:r.dxy(0,0),axis:r.axis,length:r.crossAxis.length,font:r.axis.tickfont,isFirst:e===0,isLast:e===u.length-1}),i.push(o)),["end","both"].indexOf(l.showticklabels)!==-1&&(o=t.tickText(l,r.value),h(o,{endAnchor:!1,xy:r.xy(r.crossLength-1),dxy:r.dxy(r.crossLength-2,1),axis:r.axis,length:r.crossAxis.length,font:r.axis.tickfont,isFirst:e===0,isLast:e===u.length-1}),i.push(o))}},{"../../lib/extend":768,"../../plots/cartesian/axes":828}],972:[function(n,z,q){"use strict";z.exports=function(t,h,p,l){var e=t[0]-h[0],o=t[1]-h[1],r=p[0]-h[0],i=p[1]-h[1],u=Math.pow(e*e+o*o,.25),s=Math.pow(r*r+i*i,.25),a=(s*s*e-u*u*r)*l,c=(s*s*o-u*u*i)*l,f=s*(u+s)*3,g=u*(u+s)*3;return[[h[0]+(f&&a/f),h[1]+(f&&c/f)],[h[0]-(g&&a/g),h[1]-(g&&c/g)]]}},{}],973:[function(n,z,q){"use strict";var t=n("../../lib").isArrayOrTypedArray;z.exports=function(h,p,l){var e,o,r,i,u,s,a=[],c=t(h)?h.length:h,f=t(p)?p.length:p,g=t(h)?h:null,d=t(p)?p:null;g&&(r=(g.length-1)/(g[g.length-1]-g[0])/(c-1)),d&&(i=(d.length-1)/(d[d.length-1]-d[0])/(f-1));var m=1/0,y=-1/0;for(o=0;o<f;o++)for(a[o]=[],u=d?(d[o]-d[0])*i:o/(f-1),e=0;e<c;e++)s=(g?(g[e]-g[0])*r:e/(c-1))-u*l,m=Math.min(s,m),y=Math.max(s,y),a[o][e]=s;var v=1/(y-m),T=-m*v;for(o=0;o<f;o++)for(e=0;e<c;e++)a[o][e]=v*a[o][e]+T;return a}},{"../../lib":778}],974:[function(n,z,q){"use strict";var t=n("./catmull_rom"),h=n("../../lib").ensureArray;function p(l,e,o){var r=-.5*o[0]+1.5*e[0],i=-.5*o[1]+1.5*e[1];return[(2*r+l[0])/3,(2*i+l[1])/3]}z.exports=function(l,e,o,r,i,u){var s,a,c,f,g,d,m,y,v,T,w=o[0].length,A=o.length,E=i?3*w-2:w,M=u?3*A-2:A;for(l=h(l,M),e=h(e,M),c=0;c<M;c++)l[c]=h(l[c],E),e[c]=h(e[c],E);for(a=0,f=0;a<A;a++,f+=u?3:1)for(g=l[f],d=e[f],m=o[a],y=r[a],s=0,c=0;s<w;s++,c+=i?3:1)g[c]=m[s],d[c]=y[s];if(i)for(a=0,f=0;a<A;a++,f+=u?3:1){for(s=1,c=3;s<w-1;s++,c+=3)v=t([o[a][s-1],r[a][s-1]],[o[a][s],r[a][s]],[o[a][s+1],r[a][s+1]],i),l[f][c-1]=v[0][0],e[f][c-1]=v[0][1],l[f][c+1]=v[1][0],e[f][c+1]=v[1][1];T=p([l[f][0],e[f][0]],[l[f][2],e[f][2]],[l[f][3],e[f][3]]),l[f][1]=T[0],e[f][1]=T[1],T=p([l[f][E-1],e[f][E-1]],[l[f][E-3],e[f][E-3]],[l[f][E-4],e[f][E-4]]),l[f][E-2]=T[0],e[f][E-2]=T[1]}if(u)for(c=0;c<E;c++){for(f=3;f<M-3;f+=3)v=t([l[f-3][c],e[f-3][c]],[l[f][c],e[f][c]],[l[f+3][c],e[f+3][c]],u),l[f-1][c]=v[0][0],e[f-1][c]=v[0][1],l[f+1][c]=v[1][0],e[f+1][c]=v[1][1];T=p([l[0][c],e[0][c]],[l[2][c],e[2][c]],[l[3][c],e[3][c]]),l[1][c]=T[0],e[1][c]=T[1],T=p([l[M-1][c],e[M-1][c]],[l[M-3][c],e[M-3][c]],[l[M-4][c],e[M-4][c]]),l[M-2][c]=T[0],e[M-2][c]=T[1]}if(i&&u)for(f=1;f<M;f+=(f+1)%3==0?2:1){for(c=3;c<E-3;c+=3)v=t([l[f][c-3],e[f][c-3]],[l[f][c],e[f][c]],[l[f][c+3],e[f][c+3]],i),l[f][c-1]=.5*(l[f][c-1]+v[0][0]),e[f][c-1]=.5*(e[f][c-1]+v[0][1]),l[f][c+1]=.5*(l[f][c+1]+v[1][0]),e[f][c+1]=.5*(e[f][c+1]+v[1][1]);T=p([l[f][0],e[f][0]],[l[f][2],e[f][2]],[l[f][3],e[f][3]]),l[f][1]=.5*(l[f][1]+T[0]),e[f][1]=.5*(e[f][1]+T[1]),T=p([l[f][E-1],e[f][E-1]],[l[f][E-3],e[f][E-3]],[l[f][E-4],e[f][E-4]]),l[f][E-2]=.5*(l[f][E-2]+T[0]),e[f][E-2]=.5*(e[f][E-2]+T[1])}return[l,e]}},{"../../lib":778,"./catmull_rom":972}],975:[function(n,z,q){"use strict";z.exports={RELATIVE_CULL_TOLERANCE:1e-6}},{}],976:[function(n,z,q){"use strict";z.exports=function(t,h,p){return h&&p?function(l,e,o,r,i){var u,s,a,c,f,g;l||(l=[]),e*=3,o*=3;var d=r*r,m=1-r,y=m*m,v=m*r*2,T=-3*y,w=3*(y-v),A=3*(v-d),E=3*d,M=i*i,b=M*i,_=1-i,S=_*_,C=S*_;for(g=0;g<t.length;g++)u=T*(f=t[g])[o][e]+w*f[o][e+1]+A*f[o][e+2]+E*f[o][e+3],s=T*f[o+1][e]+w*f[o+1][e+1]+A*f[o+1][e+2]+E*f[o+1][e+3],a=T*f[o+2][e]+w*f[o+2][e+1]+A*f[o+2][e+2]+E*f[o+2][e+3],c=T*f[o+3][e]+w*f[o+3][e+1]+A*f[o+3][e+2]+E*f[o+3][e+3],l[g]=C*u+3*(S*i*s+_*M*a)+b*c;return l}:h?function(l,e,o,r,i){var u,s,a,c;l||(l=[]),e*=3;var f=r*r,g=1-r,d=g*g,m=g*r*2,y=-3*d,v=3*(d-m),T=3*(m-f),w=3*f,A=1-i;for(a=0;a<t.length;a++)u=y*(c=t[a])[o][e]+v*c[o][e+1]+T*c[o][e+2]+w*c[o][e+3],s=y*c[o+1][e]+v*c[o+1][e+1]+T*c[o+1][e+2]+w*c[o+1][e+3],l[a]=A*u+i*s;return l}:p?function(l,e,o,r,i){var u,s,a,c,f,g;l||(l=[]),o*=3;var d=i*i,m=d*i,y=1-i,v=y*y,T=v*y;for(f=0;f<t.length;f++)u=(g=t[f])[o][e+1]-g[o][e],s=g[o+1][e+1]-g[o+1][e],a=g[o+2][e+1]-g[o+2][e],c=g[o+3][e+1]-g[o+3][e],l[f]=T*u+3*(v*i*s+y*d*a)+m*c;return l}:function(l,e,o,r,i){var u,s,a,c;l||(l=[]);var f=1-i;for(a=0;a<t.length;a++)u=(c=t[a])[o][e+1]-c[o][e],s=c[o+1][e+1]-c[o+1][e],l[a]=f*u+i*s;return l}}},{}],977:[function(n,z,q){"use strict";z.exports=function(t,h,p){return h&&p?function(l,e,o,r,i){var u,s,a,c,f,g;l||(l=[]),e*=3,o*=3;var d=r*r,m=d*r,y=1-r,v=y*y,T=v*y,w=i*i,A=1-i,E=A*A,M=A*i*2,b=-3*E,_=3*(E-M),S=3*(M-w),C=3*w;for(g=0;g<t.length;g++)u=b*(f=t[g])[o][e]+_*f[o+1][e]+S*f[o+2][e]+C*f[o+3][e],s=b*f[o][e+1]+_*f[o+1][e+1]+S*f[o+2][e+1]+C*f[o+3][e+1],a=b*f[o][e+2]+_*f[o+1][e+2]+S*f[o+2][e+2]+C*f[o+3][e+2],c=b*f[o][e+3]+_*f[o+1][e+3]+S*f[o+2][e+3]+C*f[o+3][e+3],l[g]=T*u+3*(v*r*s+y*d*a)+m*c;return l}:h?function(l,e,o,r,i){var u,s,a,c,f,g;l||(l=[]),e*=3;var d=i*i,m=d*i,y=1-i,v=y*y,T=v*y;for(f=0;f<t.length;f++)u=(g=t[f])[o+1][e]-g[o][e],s=g[o+1][e+1]-g[o][e+1],a=g[o+1][e+2]-g[o][e+2],c=g[o+1][e+3]-g[o][e+3],l[f]=T*u+3*(v*i*s+y*d*a)+m*c;return l}:p?function(l,e,o,r,i){var u,s,a,c;l||(l=[]),o*=3;var f=1-r,g=i*i,d=1-i,m=d*d,y=d*i*2,v=-3*m,T=3*(m-y),w=3*(y-g),A=3*g;for(a=0;a<t.length;a++)u=v*(c=t[a])[o][e]+T*c[o+1][e]+w*c[o+2][e]+A*c[o+3][e],s=v*c[o][e+1]+T*c[o+1][e+1]+w*c[o+2][e+1]+A*c[o+3][e+1],l[a]=f*u+r*s;return l}:function(l,e,o,r,i){var u,s,a,c;l||(l=[]);var f=1-r;for(a=0;a<t.length;a++)u=(c=t[a])[o+1][e]-c[o][e],s=c[o+1][e+1]-c[o][e+1],l[a]=f*u+r*s;return l}}},{}],978:[function(n,z,q){"use strict";z.exports=function(t,h,p,l,e){var o=h-2,r=p-2;return l&&e?function(i,u,s){var a,c,f,g,d,m;i||(i=[]);var y=Math.max(0,Math.min(Math.floor(u),o)),v=Math.max(0,Math.min(Math.floor(s),r)),T=Math.max(0,Math.min(1,u-y)),w=Math.max(0,Math.min(1,s-v));y*=3,v*=3;var A=T*T,E=A*T,M=1-T,b=M*M,_=b*M,S=w*w,C=S*w,k=1-w,L=k*k,I=L*k;for(m=0;m<t.length;m++)a=_*(d=t[m])[v][y]+3*(b*T*d[v][y+1]+M*A*d[v][y+2])+E*d[v][y+3],c=_*d[v+1][y]+3*(b*T*d[v+1][y+1]+M*A*d[v+1][y+2])+E*d[v+1][y+3],f=_*d[v+2][y]+3*(b*T*d[v+2][y+1]+M*A*d[v+2][y+2])+E*d[v+2][y+3],g=_*d[v+3][y]+3*(b*T*d[v+3][y+1]+M*A*d[v+3][y+2])+E*d[v+3][y+3],i[m]=I*a+3*(L*w*c+k*S*f)+C*g;return i}:l?function(i,u,s){i||(i=[]);var a,c,f,g,d,m,y=Math.max(0,Math.min(Math.floor(u),o)),v=Math.max(0,Math.min(Math.floor(s),r)),T=Math.max(0,Math.min(1,u-y)),w=Math.max(0,Math.min(1,s-v));y*=3;var A=T*T,E=A*T,M=1-T,b=M*M,_=b*M,S=1-w;for(d=0;d<t.length;d++)a=S*(m=t[d])[v][y]+w*m[v+1][y],c=S*m[v][y+1]+w*m[v+1][y+1],f=S*m[v][y+2]+w*m[v+1][y+1],g=S*m[v][y+3]+w*m[v+1][y+1],i[d]=_*a+3*(b*T*c+M*A*f)+E*g;return i}:e?function(i,u,s){i||(i=[]);var a,c,f,g,d,m,y=Math.max(0,Math.min(Math.floor(u),o)),v=Math.max(0,Math.min(Math.floor(s),r)),T=Math.max(0,Math.min(1,u-y)),w=Math.max(0,Math.min(1,s-v));v*=3;var A=w*w,E=A*w,M=1-w,b=M*M,_=b*M,S=1-T;for(d=0;d<t.length;d++)a=S*(m=t[d])[v][y]+T*m[v][y+1],c=S*m[v+1][y]+T*m[v+1][y+1],f=S*m[v+2][y]+T*m[v+2][y+1],g=S*m[v+3][y]+T*m[v+3][y+1],i[d]=_*a+3*(b*w*c+M*A*f)+E*g;return i}:function(i,u,s){i||(i=[]);var a,c,f,g,d=Math.max(0,Math.min(Math.floor(u),o)),m=Math.max(0,Math.min(Math.floor(s),r)),y=Math.max(0,Math.min(1,u-d)),v=Math.max(0,Math.min(1,s-m)),T=1-v,w=1-y;for(f=0;f<t.length;f++)a=w*(g=t[f])[m][d]+y*g[m][d+1],c=w*g[m+1][d]+y*g[m+1][d+1],i[f]=T*a+v*c;return i}}},{}],979:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("./xy_defaults"),p=n("./ab_defaults"),l=n("./attributes"),e=n("../../components/color/attributes");z.exports=function(o,r,i,u){function s(c,f){return t.coerce(o,r,l,c,f)}r._clipPathId="clip"+r.uid+"carpet";var a=s("color",e.defaultLine);t.coerceFont(s,"font"),s("carpet"),p(o,r,u,s,a),r.a&&r.b?(r.a.length<3&&(r.aaxis.smoothing=0),r.b.length<3&&(r.baxis.smoothing=0),h(o,r,s)||(r.visible=!1),r._cheater&&s("cheaterslope")):r.visible=!1}},{"../../components/color/attributes":642,"../../lib":778,"./ab_defaults":962,"./attributes":964,"./xy_defaults":988}],980:[function(n,z,q){"use strict";z.exports={attributes:n("./attributes"),supplyDefaults:n("./defaults"),plot:n("./plot"),calc:n("./calc"),animatable:!0,isContainer:!0,moduleType:"trace",name:"carpet",basePlotModule:n("../../plots/cartesian"),categories:["cartesian","svg","carpet","carpetAxis","notLegendIsolatable","noMultiCategory","noHover","noSortingByValue"],meta:{}}},{"../../plots/cartesian":841,"./attributes":964,"./calc":968,"./defaults":979,"./plot":985}],981:[function(n,z,q){"use strict";z.exports=function(t,h){for(var p,l=t._fullData.length,e=0;e<l;e++){var o=t._fullData[e];if(o.index!==h.index&&o.type==="carpet"&&(p||(p=o),o.carpet===h.carpet))return o}return p}},{}],982:[function(n,z,q){"use strict";z.exports=function(t,h,p){if(t.length===0)return"";var l,e=[],o=p?3:1;for(l=0;l<t.length;l+=o)e.push(t[l]+","+h[l]),p&&l<t.length-o&&(e.push("C"),e.push([t[l+1]+","+h[l+1],t[l+2]+","+h[l+2]+" "].join(" ")));return e.join(p?"":"L")}},{}],983:[function(n,z,q){"use strict";var t=n("../../lib").isArrayOrTypedArray;z.exports=function(h,p,l){var e;for(t(h)?h.length>p.length&&(h=h.slice(0,p.length)):h=[],e=0;e<p.length;e++)h[e]=l(p[e]);return h}},{"../../lib":778}],984:[function(n,z,q){"use strict";z.exports=function(t,h,p,l,e,o){var r=e[0]*t.dpdx(h),i=e[1]*t.dpdy(p),u=1,s=1;if(o){var a=Math.sqrt(e[0]*e[0]+e[1]*e[1]),c=Math.sqrt(o[0]*o[0]+o[1]*o[1]),f=(e[0]*o[0]+e[1]*o[1])/a/c;s=Math.max(0,f)}var g=180*Math.atan2(i,r)/Math.PI;return g<-90?(g+=180,u=-u):g>90&&(g-=180,u=-u),{angle:g,flip:u,p:t.c2p(l,h,p),offsetMultplier:s}}},{}],985:[function(n,z,q){"use strict";var t=n("d3"),h=n("../../components/drawing"),p=n("./map_1d_array"),l=n("./makepath"),e=n("./orient_text"),o=n("../../lib/svg_text_utils"),r=n("../../lib"),i=r.strRotate,u=r.strTranslate,s=n("../../constants/alignment");function a(m,y,v,T,w,A){var E="const-"+w+"-lines",M=v.selectAll("."+E).data(A);M.enter().append("path").classed(E,!0).style("vector-effect","non-scaling-stroke"),M.each(function(b){var _=b,S=_.x,C=_.y,k=p([],S,m.c2p),L=p([],C,y.c2p),I="M"+l(k,L,_.smoothing);t.select(this).attr("d",I).style("stroke-width",_.width).style("stroke",_.color).style("fill","none")}),M.exit().remove()}function c(m,y,v,T,w,A,E,M){var b=A.selectAll("text."+M).data(E);b.enter().append("text").classed(M,!0);var _=0,S={};return b.each(function(C,k){var L;if(C.axis.tickangle==="auto")L=e(T,y,v,C.xy,C.dxy);else{var I=(C.axis.tickangle+180)*Math.PI/180;L=e(T,y,v,C.xy,[Math.cos(I),Math.sin(I)])}k||(S={angle:L.angle,flip:L.flip});var R=(C.endAnchor?-1:1)*L.flip,V=t.select(this).attr({"text-anchor":R>0?"start":"end","data-notex":1}).call(h.font,C.font).text(C.text).call(o.convertToTspans,m),O=h.bBox(this);V.attr("transform",u(L.p[0],L.p[1])+i(L.angle)+u(C.axis.labelpadding*R,.3*O.height)),_=Math.max(_,O.width+C.axis.labelpadding)}),b.exit().remove(),S.maxExtent=_,S}z.exports=function(m,y,v,T){var w=y.xaxis,A=y.yaxis,E=m._fullLayout._clips;r.makeTraceGroups(T,v,"trace").each(function(M){var b=t.select(this),_=M[0],S=_.trace,C=S.aaxis,k=S.baxis,L=r.ensureSingle(b,"g","minorlayer"),I=r.ensureSingle(b,"g","majorlayer"),R=r.ensureSingle(b,"g","boundarylayer"),V=r.ensureSingle(b,"g","labellayer");b.style("opacity",S.opacity),a(w,A,I,C,"a",C._gridlines),a(w,A,I,k,"b",k._gridlines),a(w,A,L,C,"a",C._minorgridlines),a(w,A,L,k,"b",k._minorgridlines),a(w,A,R,C,"a-boundary",C._boundarylines),a(w,A,R,k,"b-boundary",k._boundarylines);var O=c(m,w,A,S,_,V,C._labels,"a-label"),J=c(m,w,A,S,_,V,k._labels,"b-label");(function(D,B,N,F,H,j,G,W){var Q,$,ee,ie,ae=r.aggNums(Math.min,null,N.a),oe=r.aggNums(Math.max,null,N.a),de=r.aggNums(Math.min,null,N.b),le=r.aggNums(Math.max,null,N.b);Q=.5*(ae+oe),$=de,ee=N.ab2xy(Q,$,!0),ie=N.dxyda_rough(Q,$),G.angle===void 0&&r.extendFlat(G,e(N,H,j,ee,N.dxydb_rough(Q,$))),d(D,B,N,F,ee,ie,N.aaxis,H,j,G,"a-title"),Q=ae,$=.5*(de+le),ee=N.ab2xy(Q,$,!0),ie=N.dxydb_rough(Q,$),W.angle===void 0&&r.extendFlat(W,e(N,H,j,ee,N.dxyda_rough(Q,$))),d(D,B,N,F,ee,ie,N.baxis,H,j,W,"b-title")})(m,V,S,_,w,A,O,J),function(D,B,N,F,H){var j,G,W,Q,$=N.select("#"+D._clipPathId);$.size()||($=N.append("clipPath").classed("carpetclip",!0));var ee=r.ensureSingle($,"path","carpetboundary"),ie=B.clipsegments,ae=[];for(Q=0;Q<ie.length;Q++)j=ie[Q],G=p([],j.x,F.c2p),W=p([],j.y,H.c2p),ae.push(l(G,W,j.bicubic));var oe="M"+ae.join("L")+"Z";$.attr("id",D._clipPathId),ee.attr("d",oe)}(S,_,E,w,A)})};var f=s.LINE_SPACING,g=(1-s.MID_SHIFT)/f+1;function d(m,y,v,T,w,A,E,M,b,_,S){var C=[];E.title.text&&C.push(E.title.text);var k=y.selectAll("text."+S).data(C),L=_.maxExtent;k.enter().append("text").classed(S,!0),k.each(function(){var I=e(v,M,b,w,A);["start","both"].indexOf(E.showticklabels)===-1&&(L=0);var R=E.title.font.size;L+=R+E.title.offset;var V=(_.angle+(_.flip<0?180:0)-I.angle+450)%360,O=V>90&&V<270,J=t.select(this);J.text(E.title.text).call(o.convertToTspans,m),O&&(L=(-o.lineCount(J)+g)*f*R-L),J.attr("transform",u(I.p[0],I.p[1])+i(I.angle)+u(0,L)).attr("text-anchor","middle").call(h.font,E.title.font)}),k.exit().remove()}},{"../../components/drawing":665,"../../constants/alignment":745,"../../lib":778,"../../lib/svg_text_utils":803,"./makepath":982,"./map_1d_array":983,"./orient_text":984,d3:169}],986:[function(n,z,q){"use strict";var t=n("./constants"),h=n("../../lib/search").findBin,p=n("./compute_control_points"),l=n("./create_spline_evaluator"),e=n("./create_i_derivative_evaluator"),o=n("./create_j_derivative_evaluator");z.exports=function(r){var i=r._a,u=r._b,s=i.length,a=u.length,c=r.aaxis,f=r.baxis,g=i[0],d=i[s-1],m=u[0],y=u[a-1],v=i[i.length-1]-i[0],T=u[u.length-1]-u[0],w=v*t.RELATIVE_CULL_TOLERANCE,A=T*t.RELATIVE_CULL_TOLERANCE;g-=w,d+=w,m-=A,y+=A,r.isVisible=function(E,M){return E>g&&E<d&&M>m&&M<y},r.isOccluded=function(E,M){return E<g||E>d||M<m||M>y},r.setScale=function(){var E=r._x,M=r._y,b=p(r._xctrl,r._yctrl,E,M,c.smoothing,f.smoothing);r._xctrl=b[0],r._yctrl=b[1],r.evalxy=l([r._xctrl,r._yctrl],s,a,c.smoothing,f.smoothing),r.dxydi=e([r._xctrl,r._yctrl],c.smoothing,f.smoothing),r.dxydj=o([r._xctrl,r._yctrl],c.smoothing,f.smoothing)},r.i2a=function(E){var M=Math.max(0,Math.floor(E[0]),s-2),b=E[0]-M;return(1-b)*i[M]+b*i[M+1]},r.j2b=function(E){var M=Math.max(0,Math.floor(E[1]),s-2),b=E[1]-M;return(1-b)*u[M]+b*u[M+1]},r.ij2ab=function(E){return[r.i2a(E[0]),r.j2b(E[1])]},r.a2i=function(E){var M=Math.max(0,Math.min(h(E,i),s-2)),b=i[M],_=i[M+1];return Math.max(0,Math.min(s-1,M+(E-b)/(_-b)))},r.b2j=function(E){var M=Math.max(0,Math.min(h(E,u),a-2)),b=u[M],_=u[M+1];return Math.max(0,Math.min(a-1,M+(E-b)/(_-b)))},r.ab2ij=function(E){return[r.a2i(E[0]),r.b2j(E[1])]},r.i2c=function(E,M){return r.evalxy([],E,M)},r.ab2xy=function(E,M,b){if(!b&&(E<i[0]||E>i[s-1]|M<u[0]||M>u[a-1]))return[!1,!1];var _=r.a2i(E),S=r.b2j(M),C=r.evalxy([],_,S);if(b){var k,L,I,R,V=0,O=0,J=[];E<i[0]?(k=0,L=0,V=(E-i[0])/(i[1]-i[0])):E>i[s-1]?(k=s-2,L=1,V=(E-i[s-1])/(i[s-1]-i[s-2])):L=_-(k=Math.max(0,Math.min(s-2,Math.floor(_)))),M<u[0]?(I=0,R=0,O=(M-u[0])/(u[1]-u[0])):M>u[a-1]?(I=a-2,R=1,O=(M-u[a-1])/(u[a-1]-u[a-2])):R=S-(I=Math.max(0,Math.min(a-2,Math.floor(S)))),V&&(r.dxydi(J,k,I,L,R),C[0]+=J[0]*V,C[1]+=J[1]*V),O&&(r.dxydj(J,k,I,L,R),C[0]+=J[0]*O,C[1]+=J[1]*O)}return C},r.c2p=function(E,M,b){return[M.c2p(E[0]),b.c2p(E[1])]},r.p2x=function(E,M,b){return[M.p2c(E[0]),b.p2c(E[1])]},r.dadi=function(E){var M=Math.max(0,Math.min(i.length-2,E));return i[M+1]-i[M]},r.dbdj=function(E){var M=Math.max(0,Math.min(u.length-2,E));return u[M+1]-u[M]},r.dxyda=function(E,M,b,_){var S=r.dxydi(null,E,M,b,_),C=r.dadi(E,b);return[S[0]/C,S[1]/C]},r.dxydb=function(E,M,b,_){var S=r.dxydj(null,E,M,b,_),C=r.dbdj(M,_);return[S[0]/C,S[1]/C]},r.dxyda_rough=function(E,M,b){var _=v*(b||.1),S=r.ab2xy(E+_,M,!0),C=r.ab2xy(E-_,M,!0);return[.5*(S[0]-C[0])/_,.5*(S[1]-C[1])/_]},r.dxydb_rough=function(E,M,b){var _=T*(b||.1),S=r.ab2xy(E,M+_,!0),C=r.ab2xy(E,M-_,!0);return[.5*(S[0]-C[0])/_,.5*(S[1]-C[1])/_]},r.dpdx=function(E){return E._m},r.dpdy=function(E){return E._m}}},{"../../lib/search":798,"./compute_control_points":974,"./constants":975,"./create_i_derivative_evaluator":976,"./create_j_derivative_evaluator":977,"./create_spline_evaluator":978}],987:[function(n,z,q){"use strict";var t=n("../../lib");z.exports=function(h,p,l){var e,o,r,i=[],u=[],s=h[0].length,a=h.length;function c(B,N){var F,H=0,j=0;return B>0&&(F=h[N][B-1])!==void 0&&(j++,H+=F),B<s-1&&(F=h[N][B+1])!==void 0&&(j++,H+=F),N>0&&(F=h[N-1][B])!==void 0&&(j++,H+=F),N<a-1&&(F=h[N+1][B])!==void 0&&(j++,H+=F),H/Math.max(1,j)}var f,g,d,m,y,v,T,w,A,E,M,b=0;for(e=0;e<s;e++)for(o=0;o<a;o++)h[o][e]===void 0&&(i.push(e),u.push(o),h[o][e]=c(e,o)),b=Math.max(b,Math.abs(h[o][e]));if(!i.length)return h;var _=0,S=0,C=i.length;do{for(_=0,r=0;r<C;r++){e=i[r],o=u[r];var k,L,I,R,V,O,J=0,D=0;e===0?(I=p[V=Math.min(s-1,2)],R=p[1],k=h[o][V],D+=(L=h[o][1])+(L-k)*(p[0]-R)/(R-I),J++):e===s-1&&(I=p[V=Math.max(0,s-3)],R=p[s-2],k=h[o][V],D+=(L=h[o][s-2])+(L-k)*(p[s-1]-R)/(R-I),J++),(e===0||e===s-1)&&o>0&&o<a-1&&(f=l[o+1]-l[o],D+=((g=l[o]-l[o-1])*h[o+1][e]+f*h[o-1][e])/(g+f),J++),o===0?(I=l[O=Math.min(a-1,2)],R=l[1],k=h[O][e],D+=(L=h[1][e])+(L-k)*(l[0]-R)/(R-I),J++):o===a-1&&(I=l[O=Math.max(0,a-3)],R=l[a-2],k=h[O][e],D+=(L=h[a-2][e])+(L-k)*(l[a-1]-R)/(R-I),J++),(o===0||o===a-1)&&e>0&&e<s-1&&(f=p[e+1]-p[e],D+=((g=p[e]-p[e-1])*h[o][e+1]+f*h[o][e-1])/(g+f),J++),J?D/=J:(d=p[e+1]-p[e],m=p[e]-p[e-1],w=(y=l[o+1]-l[o])*(v=l[o]-l[o-1])*(y+v),D=((T=d*m*(d+m))*(v*h[o+1][e]+y*h[o-1][e])+w*(m*h[o][e+1]+d*h[o][e-1]))/(w*(m+d)+T*(v+y))),_+=(E=(A=D-h[o][e])/b)*E,M=J?0:.85,h[o][e]+=A*(1+M)}_=Math.sqrt(_)}while(S++<100&&_>1e-5);return t.log("Smoother converged to",_,"after",S,"iterations"),h}},{"../../lib":778}],988:[function(n,z,q){"use strict";var t=n("../../lib").isArray1D;z.exports=function(h,p,l){var e=l("x"),o=e&&e.length,r=l("y"),i=r&&r.length;if(!o&&!i)return!1;if(p._cheater=!e,o&&!t(e)||i&&!t(r))p._length=null;else{var u=o?e.length:1/0;i&&(u=Math.min(u,r.length)),p.a&&p.a.length&&(u=Math.min(u,p.a.length)),p.b&&p.b.length&&(u=Math.min(u,p.b.length)),p._length=u}return!0}},{"../../lib":778}],989:[function(n,z,q){"use strict";var t=n("../../plots/template_attributes").hovertemplateAttrs,h=n("../scattergeo/attributes"),p=n("../../components/colorscale/attributes"),l=n("../../plots/attributes"),e=n("../../components/color/attributes").defaultLine,o=n("../../lib/extend").extendFlat,r=h.marker.line;z.exports=o({locations:{valType:"data_array",editType:"calc"},locationmode:h.locationmode,z:{valType:"data_array",editType:"calc"},geojson:o({},h.geojson,{}),featureidkey:h.featureidkey,text:o({},h.text,{}),hovertext:o({},h.hovertext,{}),marker:{line:{color:o({},r.color,{dflt:e}),width:o({},r.width,{dflt:1}),editType:"calc"},opacity:{valType:"number",arrayOk:!0,min:0,max:1,dflt:1,editType:"style"},editType:"calc"},selected:{marker:{opacity:h.selected.marker.opacity,editType:"plot"},editType:"plot"},unselected:{marker:{opacity:h.unselected.marker.opacity,editType:"plot"},editType:"plot"},hoverinfo:o({},l.hoverinfo,{editType:"calc",flags:["location","z","text","name"]}),hovertemplate:t(),showlegend:o({},l.showlegend,{dflt:!1})},p("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/color/attributes":642,"../../components/colorscale/attributes":650,"../../lib/extend":768,"../../plots/attributes":824,"../../plots/template_attributes":906,"../scattergeo/attributes":1229}],990:[function(n,z,q){"use strict";var t=n("fast-isnumeric"),h=n("../../constants/numerical").BADNUM,p=n("../../components/colorscale/calc"),l=n("../scatter/arrays_to_calcdata"),e=n("../scatter/calc_selection");function o(r){return r&&typeof r=="string"}z.exports=function(r,i){var u,s=i._length,a=new Array(s);u=i.geojson?function(m){return o(m)||t(m)}:o;for(var c=0;c<s;c++){var f=a[c]={},g=i.locations[c],d=i.z[c];u(g)&&t(d)?(f.loc=g,f.z=d):(f.loc=null,f.z=h),f.index=c}return l(a,i),p(r,i,{vals:i.z,containerStr:"",cLetter:"z"}),e(a,i),a}},{"../../components/colorscale/calc":651,"../../constants/numerical":753,"../scatter/arrays_to_calcdata":1186,"../scatter/calc_selection":1189,"fast-isnumeric":241}],991:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../../components/colorscale/defaults"),p=n("./attributes");z.exports=function(l,e,o,r){function i(f,g){return t.coerce(l,e,p,f,g)}var u=i("locations"),s=i("z");if(u&&u.length&&t.isArrayOrTypedArray(s)&&s.length){e._length=Math.min(u.length,s.length);var a,c=i("geojson");(typeof c=="string"&&c!==""||t.isPlainObject(c))&&(a="geojson-id"),i("locationmode",a)==="geojson-id"&&i("featureidkey"),i("text"),i("hovertext"),i("hovertemplate"),i("marker.line.width")&&i("marker.line.color"),i("marker.opacity"),h(l,e,r,i,{prefix:"",cLetter:"z"}),t.coerceSelectionMarkerOpacity(e,i)}else e.visible=!1}},{"../../components/colorscale/defaults":653,"../../lib":778,"./attributes":989}],992:[function(n,z,q){"use strict";z.exports=function(t,h,p,l,e){t.location=h.location,t.z=h.z;var o=l[e];return o.fIn&&o.fIn.properties&&(t.properties=o.fIn.properties),t.ct=o.ct,t}},{}],993:[function(n,z,q){"use strict";var t=n("../../plots/cartesian/axes"),h=n("./attributes"),p=n("../../lib").fillText;z.exports=function(l,e,o){var r,i,u,s,a=l.cd,c=a[0].trace,f=l.subplot,g=[e,o],d=[e+360,o];for(i=0;i<a.length;i++)if(s=!1,(r=a[i])._polygons){for(u=0;u<r._polygons.length;u++)r._polygons[u].contains(g)&&(s=!s),r._polygons[u].contains(d)&&(s=!s);if(s)break}if(s&&r)return l.x0=l.x1=l.xa.c2p(r.ct),l.y0=l.y1=l.ya.c2p(r.ct),l.index=r.index,l.location=r.loc,l.z=r.z,l.zLabel=t.tickText(f.mockAxis,f.mockAxis.c2l(r.z),"hover").text,l.hovertemplate=r.hovertemplate,function(m,y,v){if(!y.hovertemplate){var T=v.hi||y.hoverinfo,w=String(v.loc),A=T==="all"?h.hoverinfo.flags:T.split("+"),E=A.indexOf("name")!==-1,M=A.indexOf("location")!==-1,b=A.indexOf("z")!==-1,_=A.indexOf("text")!==-1,S=[];!E&&M?m.nameOverride=w:(E&&(m.nameOverride=y.name),M&&S.push(w)),b&&S.push(m.zLabel),_&&p(v,y,S),m.extraText=S.join("<br>")}}(l,c,r),[l]}},{"../../lib":778,"../../plots/cartesian/axes":828,"./attributes":989}],994:[function(n,z,q){"use strict";z.exports={attributes:n("./attributes"),supplyDefaults:n("./defaults"),colorbar:n("../heatmap/colorbar"),calc:n("./calc"),calcGeoJSON:n("./plot").calcGeoJSON,plot:n("./plot").plot,style:n("./style").style,styleOnSelect:n("./style").styleOnSelect,hoverPoints:n("./hover"),eventData:n("./event_data"),selectPoints:n("./select"),moduleType:"trace",name:"choropleth",basePlotModule:n("../../plots/geo"),categories:["geo","noOpacity","showLegend"],meta:{}}},{"../../plots/geo":860,"../heatmap/colorbar":1068,"./attributes":989,"./calc":990,"./defaults":991,"./event_data":992,"./hover":993,"./plot":995,"./select":996,"./style":997}],995:[function(n,z,q){"use strict";var t=n("d3"),h=n("../../lib"),p=n("../../lib/geo_location_utils"),l=n("../../lib/topojson_utils").getTopojsonFeatures,e=n("../../plots/cartesian/autorange").findExtremes,o=n("./style").style;z.exports={calcGeoJSON:function(r,i){for(var u=r[0].trace,s=i[u.geo],a=s._subplot,c=u.locationmode,f=u._length,g=c==="geojson-id"?p.extractTraceFeature(r):l(u,a.topojson),d=[],m=[],y=0;y<f;y++){var v=r[y],T=c==="geojson-id"?v.fOut:p.locationToFeature(c,v.loc,g);if(T){v.geojson=T,v.ct=T.properties.ct,v._polygons=p.feature2polygons(T);var w=p.computeBbox(T);d.push(w[0],w[2]),m.push(w[1],w[3])}else v.geojson=null}if(s.fitbounds==="geojson"&&c==="geojson-id"){var A=p.computeBbox(p.getTraceGeojson(u));d=[A[0],A[2]],m=[A[1],A[3]]}var E={padded:!0};u._extremes.lon=e(s.lonaxis._ax,d,E),u._extremes.lat=e(s.lataxis._ax,m,E)},plot:function(r,i,u){var s=i.layers.backplot.select(".choroplethlayer");h.makeTraceGroups(s,u,"trace choropleth").each(function(a){var c=t.select(this).selectAll("path.choroplethlocation").data(h.identity);c.enter().append("path").classed("choroplethlocation",!0),c.exit().remove(),o(r,a)})}}},{"../../lib":778,"../../lib/geo_location_utils":771,"../../lib/topojson_utils":806,"../../plots/cartesian/autorange":827,"./style":997,d3:169}],996:[function(n,z,q){"use strict";z.exports=function(t,h){var p,l,e,o,r,i=t.cd,u=t.xaxis,s=t.yaxis,a=[];if(h===!1)for(p=0;p<i.length;p++)i[p].selected=0;else for(p=0;p<i.length;p++)(e=(l=i[p]).ct)&&(o=u.c2p(e),r=s.c2p(e),h.contains([o,r],null,p,t)?(a.push({pointNumber:p,lon:e[0],lat:e[1]}),l.selected=1):l.selected=0);return a}},{}],997:[function(n,z,q){"use strict";var t=n("d3"),h=n("../../components/color"),p=n("../../components/drawing"),l=n("../../components/colorscale");function e(o,r){var i=r[0].trace,u=r[0].node3.selectAll(".choroplethlocation"),s=i.marker||{},a=s.line||{},c=l.makeColorScaleFuncFromTrace(i);u.each(function(f){t.select(this).attr("fill",c(f.z)).call(h.stroke,f.mlc||a.color).call(p.dashLine,"",f.mlw||a.width||0).style("opacity",s.opacity)}),p.selectedPointStyle(u,i,o)}z.exports={style:function(o,r){r&&e(o,r)},styleOnSelect:function(o,r){var i=r[0].node3,u=r[0].trace;u.selectedpoints?p.selectedPointStyle(i.selectAll(".choroplethlocation"),u,o):e(o,r)}}},{"../../components/color":643,"../../components/colorscale":655,"../../components/drawing":665,d3:169}],998:[function(n,z,q){"use strict";var t=n("../choropleth/attributes"),h=n("../../components/colorscale/attributes"),p=n("../../plots/template_attributes").hovertemplateAttrs,l=n("../../plots/attributes"),e=n("../../lib/extend").extendFlat;z.exports=e({locations:{valType:"data_array",editType:"calc"},z:{valType:"data_array",editType:"calc"},geojson:{valType:"any",editType:"calc"},featureidkey:e({},t.featureidkey,{}),below:{valType:"string",editType:"plot"},text:t.text,hovertext:t.hovertext,marker:{line:{color:e({},t.marker.line.color,{editType:"plot"}),width:e({},t.marker.line.width,{editType:"plot"}),editType:"calc"},opacity:e({},t.marker.opacity,{editType:"plot"}),editType:"calc"},selected:{marker:{opacity:e({},t.selected.marker.opacity,{editType:"plot"}),editType:"plot"},editType:"plot"},unselected:{marker:{opacity:e({},t.unselected.marker.opacity,{editType:"plot"}),editType:"plot"},editType:"plot"},hoverinfo:t.hoverinfo,hovertemplate:p({},{keys:["properties"]}),showlegend:e({},l.showlegend,{dflt:!1})},h("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":650,"../../lib/extend":768,"../../plots/attributes":824,"../../plots/template_attributes":906,"../choropleth/attributes":989}],999:[function(n,z,q){"use strict";var t=n("fast-isnumeric"),h=n("../../lib"),p=n("../../components/colorscale"),l=n("../../components/drawing"),e=n("../../lib/geojson_utils").makeBlank,o=n("../../lib/geo_location_utils");function r(i){var u,s=i[0].trace,a=s._opts;if(s.selectedpoints){for(var c=l.makeSelectedPointStyleFns(s),f=0;f<i.length;f++){var g=i[f];g.fOut&&(g.fOut.properties.mo2=c.selectedOpacityFn(g))}u={type:"identity",property:"mo2"}}else u=h.isArrayOrTypedArray(s.marker.opacity)?{type:"identity",property:"mo"}:s.marker.opacity;return h.extendFlat(a.fill.paint,{"fill-opacity":u}),h.extendFlat(a.line.paint,{"line-opacity":u}),a}z.exports={convert:function(i){var u=i[0].trace,s=u.visible===!0&&u._length!==0,a={layout:{visibility:"none"},paint:{}},c={layout:{visibility:"none"},paint:{}},f=u._opts={fill:a,line:c,geojson:e()};if(!s)return f;var g=o.extractTraceFeature(i);if(!g)return f;var d,m,y,v=p.makeColorScaleFuncFromTrace(u),T=u.marker,w=T.line||{};h.isArrayOrTypedArray(T.opacity)&&(d=function(S){var C=S.mo;return t(C)?+h.constrain(C,0,1):0}),h.isArrayOrTypedArray(w.color)&&(m=function(S){return S.mlc}),h.isArrayOrTypedArray(w.width)&&(y=function(S){return S.mlw});for(var A=0;A<i.length;A++){var E=i[A],M=E.fOut;if(M){var b=M.properties;b.fc=v(E.z),d&&(b.mo=d(E)),m&&(b.mlc=m(E)),y&&(b.mlw=y(E)),E.ct=b.ct,E._polygons=o.feature2polygons(M)}}var _=d?{type:"identity",property:"mo"}:T.opacity;return h.extendFlat(a.paint,{"fill-color":{type:"identity",property:"fc"},"fill-opacity":_}),h.extendFlat(c.paint,{"line-color":m?{type:"identity",property:"mlc"}:w.color,"line-width":y?{type:"identity",property:"mlw"}:w.width,"line-opacity":_}),a.layout.visibility="visible",c.layout.visibility="visible",f.geojson={type:"FeatureCollection",features:g},r(i),f},convertOnSelect:r}},{"../../components/colorscale":655,"../../components/drawing":665,"../../lib":778,"../../lib/geo_location_utils":771,"../../lib/geojson_utils":772,"fast-isnumeric":241}],1e3:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../../components/colorscale/defaults"),p=n("./attributes");z.exports=function(l,e,o,r){function i(c,f){return t.coerce(l,e,p,c,f)}var u=i("locations"),s=i("z"),a=i("geojson");t.isArrayOrTypedArray(u)&&u.length&&t.isArrayOrTypedArray(s)&&s.length&&(typeof a=="string"&&a!==""||t.isPlainObject(a))?(i("featureidkey"),e._length=Math.min(u.length,s.length),i("below"),i("text"),i("hovertext"),i("hovertemplate"),i("marker.line.width")&&i("marker.line.color"),i("marker.opacity"),h(l,e,r,i,{prefix:"",cLetter:"z"}),t.coerceSelectionMarkerOpacity(e,i)):e.visible=!1}},{"../../components/colorscale/defaults":653,"../../lib":778,"./attributes":998}],1001:[function(n,z,q){"use strict";z.exports={attributes:n("./attributes"),supplyDefaults:n("./defaults"),colorbar:n("../heatmap/colorbar"),calc:n("../choropleth/calc"),plot:n("./plot"),hoverPoints:n("../choropleth/hover"),eventData:n("../choropleth/event_data"),selectPoints:n("../choropleth/select"),styleOnSelect:function(t,h){h&&h[0].trace._glTrace.updateOnSelect(h)},getBelow:function(t,h){for(var p=h.getMapLayers(),l=p.length-2;l>=0;l--){var e=p[l].id;if(typeof e=="string"&&e.indexOf("water")===0){for(var o=l+1;o<p.length;o++)if(typeof(e=p[o].id)=="string"&&e.indexOf("plotly-")===-1)return e}}},moduleType:"trace",name:"choroplethmapbox",basePlotModule:n("../../plots/mapbox"),categories:["mapbox","gl","noOpacity","showLegend"],meta:{hr_name:"choropleth_mapbox"}}},{"../../plots/mapbox":885,"../choropleth/calc":990,"../choropleth/event_data":992,"../choropleth/hover":993,"../choropleth/select":996,"../heatmap/colorbar":1068,"./attributes":998,"./defaults":1e3,"./plot":1002}],1002:[function(n,z,q){"use strict";var t=n("./convert").convert,h=n("./convert").convertOnSelect,p=n("../../plots/mapbox/constants").traceLayerPrefix;function l(o,r){this.type="choroplethmapbox",this.subplot=o,this.uid=r,this.sourceId="source-"+r,this.layerList=[["fill",p+r+"-fill"],["line",p+r+"-line"]],this.below=null}var e=l.prototype;e.update=function(o){this._update(t(o))},e.updateOnSelect=function(o){this._update(h(o))},e._update=function(o){var r=this.subplot,i=this.layerList,u=r.belowLookup["trace-"+this.uid];r.map.getSource(this.sourceId).setData(o.geojson),u!==this.below&&(this._removeLayers(),this._addLayers(o,u),this.below=u);for(var s=0;s<i.length;s++){var a=i[s],c=a[0],f=a[1],g=o[c];r.setOptions(f,"setLayoutProperty",g.layout),g.layout.visibility==="visible"&&r.setOptions(f,"setPaintProperty",g.paint)}},e._addLayers=function(o,r){for(var i=this.subplot,u=this.layerList,s=this.sourceId,a=0;a<u.length;a++){var c=u[a],f=c[0],g=o[f];i.addLayer({type:f,id:c[1],source:s,layout:g.layout,paint:g.paint},r)}},e._removeLayers=function(){for(var o=this.subplot.map,r=this.layerList,i=r.length-1;i>=0;i--)o.removeLayer(r[i][1])},e.dispose=function(){var o=this.subplot.map;this._removeLayers(),o.removeSource(this.sourceId)},z.exports=function(o,r){var i=r[0].trace,u=new l(o,i.uid),s=u.sourceId,a=t(r),c=u.below=o.belowLookup["trace-"+i.uid];return o.map.addSource(s,{type:"geojson",data:a.geojson}),u._addLayers(a,c),r[0].trace._glTrace=u,u}},{"../../plots/mapbox/constants":883,"./convert":999}],1003:[function(n,z,q){"use strict";var t=n("../../components/colorscale/attributes"),h=n("../../plots/template_attributes").hovertemplateAttrs,p=n("../mesh3d/attributes"),l=n("../../plots/attributes"),e=n("../../lib/extend").extendFlat,o={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},u:{valType:"data_array",editType:"calc"},v:{valType:"data_array",editType:"calc"},w:{valType:"data_array",editType:"calc"},sizemode:{valType:"enumerated",values:["scaled","absolute"],editType:"calc",dflt:"scaled"},sizeref:{valType:"number",editType:"calc",min:0},anchor:{valType:"enumerated",editType:"calc",values:["tip","tail","cm","center"],dflt:"cm"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertemplate:h({editType:"calc"},{keys:["norm"]}),showlegend:e({},l.showlegend,{dflt:!1})};e(o,t("",{colorAttr:"u/v/w norm",showScaleDflt:!0,editTypeOverride:"calc"})),["opacity","lightposition","lighting"].forEach(function(r){o[r]=p[r]}),o.hoverinfo=e({},l.hoverinfo,{editType:"calc",flags:["x","y","z","u","v","w","norm","text","name"],dflt:"x+y+z+norm+text+name"}),o.transforms=void 0,z.exports=o},{"../../components/colorscale/attributes":650,"../../lib/extend":768,"../../plots/attributes":824,"../../plots/template_attributes":906,"../mesh3d/attributes":1128}],1004:[function(n,z,q){"use strict";var t=n("../../components/colorscale/calc");z.exports=function(h,p){for(var l=p.u,e=p.v,o=p.w,r=Math.min(p.x.length,p.y.length,p.z.length,l.length,e.length,o.length),i=-1/0,u=1/0,s=0;s<r;s++){var a=l[s],c=e[s],f=o[s],g=Math.sqrt(a*a+c*c+f*f);i=Math.max(i,g),u=Math.min(u,g)}p._len=r,p._normMax=i,t(h,p,{vals:[u,i],containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":651}],1005:[function(n,z,q){"use strict";var t=n("gl-cone3d"),h=n("gl-cone3d").createConeMesh,p=n("../../lib").simpleMap,l=n("../../lib/gl_format_color").parseColorScale,e=n("../../components/colorscale").extractOpts,o=n("../../plots/gl3d/zip3");function r(f,g){this.scene=f,this.uid=g,this.mesh=null,this.data=null}var i=r.prototype;i.handlePick=function(f){if(f.object===this.mesh){var g=f.index=f.data.index,d=this.data.x[g],m=this.data.y[g],y=this.data.z[g],v=this.data.u[g],T=this.data.v[g],w=this.data.w[g];f.traceCoordinate=[d,m,y,v,T,w,Math.sqrt(v*v+T*T+w*w)];var A=this.data.hovertext||this.data.text;return Array.isArray(A)&&A[g]!==void 0?f.textLabel=A[g]:A&&(f.textLabel=A),!0}};var u={xaxis:0,yaxis:1,zaxis:2},s={tip:1,tail:0,cm:.25,center:.5},a={tip:1,tail:1,cm:.75,center:.5};function c(f,g){var d=f.fullSceneLayout,m=f.dataScale,y={};function v(E,M){var b=d[M],_=m[u[M]];return p(E,function(S){return b.d2l(S)*_})}y.vectors=o(v(g.u,"xaxis"),v(g.v,"yaxis"),v(g.w,"zaxis"),g._len),y.positions=o(v(g.x,"xaxis"),v(g.y,"yaxis"),v(g.z,"zaxis"),g._len);var T=e(g);y.colormap=l(g),y.vertexIntensityBounds=[T.min/g._normMax,T.max/g._normMax],y.coneOffset=s[g.anchor],g.sizemode==="scaled"?y.coneSize=g.sizeref||.5:y.coneSize=g.sizeref&&g._normMax?g.sizeref/g._normMax:.5;var w=t(y),A=g.lightposition;return w.lightPosition=[A.x,A.y,A.z],w.ambient=g.lighting.ambient,w.diffuse=g.lighting.diffuse,w.specular=g.lighting.specular,w.roughness=g.lighting.roughness,w.fresnel=g.lighting.fresnel,w.opacity=g.opacity,g._pad=a[g.anchor]*w.vectorScale*w.coneScale*g._normMax,w}i.update=function(f){this.data=f;var g=c(this.scene,f);this.mesh.update(g)},i.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},z.exports=function(f,g){var d=f.glplot.gl,m=c(f,g),y=h(d,m),v=new r(f,g.uid);return v.mesh=y,v.data=g,y._trace=v,f.glplot.add(y),v}},{"../../components/colorscale":655,"../../lib":778,"../../lib/gl_format_color":774,"../../plots/gl3d/zip3":881,"gl-cone3d":260}],1006:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../../components/colorscale/defaults"),p=n("./attributes");z.exports=function(l,e,o,r){function i(d,m){return t.coerce(l,e,p,d,m)}var u=i("u"),s=i("v"),a=i("w"),c=i("x"),f=i("y"),g=i("z");u&&u.length&&s&&s.length&&a&&a.length&&c&&c.length&&f&&f.length&&g&&g.length?(i("sizeref"),i("sizemode"),i("anchor"),i("lighting.ambient"),i("lighting.diffuse"),i("lighting.specular"),i("lighting.roughness"),i("lighting.fresnel"),i("lightposition.x"),i("lightposition.y"),i("lightposition.z"),h(l,e,r,i,{prefix:"",cLetter:"c"}),i("text"),i("hovertext"),i("hovertemplate"),e._length=null):e.visible=!1}},{"../../components/colorscale/defaults":653,"../../lib":778,"./attributes":1003}],1007:[function(n,z,q){"use strict";z.exports={moduleType:"trace",name:"cone",basePlotModule:n("../../plots/gl3d"),categories:["gl3d","showLegend"],attributes:n("./attributes"),supplyDefaults:n("./defaults"),colorbar:{min:"cmin",max:"cmax"},calc:n("./calc"),plot:n("./convert"),eventData:function(t,h){return t.norm=h.traceCoordinate[6],t},meta:{}}},{"../../plots/gl3d":870,"./attributes":1003,"./calc":1004,"./convert":1005,"./defaults":1006}],1008:[function(n,z,q){"use strict";var t=n("../heatmap/attributes"),h=n("../scatter/attributes"),p=n("../../components/colorscale/attributes"),l=n("../../components/drawing/attributes").dash,e=n("../../plots/font_attributes"),o=n("../../lib/extend").extendFlat,r=n("../../constants/filter_ops"),i=r.COMPARISON_OPS2,u=r.INTERVAL_OPS,s=(n("../../constants/docs").FORMAT_LINK,h.line);z.exports=o({z:t.z,x:t.x,x0:t.x0,dx:t.dx,y:t.y,y0:t.y0,dy:t.dy,xperiod:t.xperiod,yperiod:t.yperiod,xperiod0:h.xperiod0,yperiod0:h.yperiod0,xperiodalignment:t.xperiodalignment,yperiodalignment:t.yperiodalignment,text:t.text,hovertext:t.hovertext,transpose:t.transpose,xtype:t.xtype,ytype:t.ytype,zhoverformat:t.zhoverformat,hovertemplate:t.hovertemplate,hoverongaps:t.hoverongaps,connectgaps:o({},t.connectgaps,{}),fillcolor:{valType:"color",editType:"calc"},autocontour:{valType:"boolean",dflt:!0,editType:"calc",impliedEdits:{"contours.start":void 0,"contours.end":void 0,"contours.size":void 0}},ncontours:{valType:"integer",dflt:15,min:1,editType:"calc"},contours:{type:{valType:"enumerated",values:["levels","constraint"],dflt:"levels",editType:"calc"},start:{valType:"number",dflt:null,editType:"plot",impliedEdits:{"^autocontour":!1}},end:{valType:"number",dflt:null,editType:"plot",impliedEdits:{"^autocontour":!1}},size:{valType:"number",dflt:null,min:0,editType:"plot",impliedEdits:{"^autocontour":!1}},coloring:{valType:"enumerated",values:["fill","heatmap","lines","none"],dflt:"fill",editType:"calc"},showlines:{valType:"boolean",dflt:!0,editType:"plot"},showlabels:{valType:"boolean",dflt:!1,editType:"plot"},labelfont:e({editType:"plot",colorEditType:"style"}),labelformat:{valType:"string",dflt:"",editType:"plot"},operation:{valType:"enumerated",values:[].concat(i).concat(u),dflt:"=",editType:"calc"},value:{valType:"any",dflt:0,editType:"calc"},editType:"calc",impliedEdits:{autocontour:!1}},line:{color:o({},s.color,{editType:"style+colorbars"}),width:{valType:"number",min:0,editType:"style+colorbars"},dash:l,smoothing:o({},s.smoothing,{}),editType:"plot"}},p("",{cLetter:"z",autoColorDflt:!1,editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":650,"../../components/drawing/attributes":664,"../../constants/docs":748,"../../constants/filter_ops":749,"../../lib/extend":768,"../../plots/font_attributes":856,"../heatmap/attributes":1065,"../scatter/attributes":1187}],1009:[function(n,z,q){"use strict";var t=n("../../components/colorscale"),h=n("../heatmap/calc"),p=n("./set_contours"),l=n("./end_plus");z.exports=function(e,o){var r=h(e,o),i=r[0].z;p(o,i);var u,s=o.contours,a=t.extractOpts(o);if(s.coloring==="heatmap"&&a.auto&&o.autocontour===!1){var c=s.start,f=l(s),g=s.size||1,d=Math.floor((f-c)/g)+1;isFinite(g)||(g=1,d=1);var m=c-g/2;u=[m,m+d*g]}else u=i;return t.calc(e,o,{vals:u,cLetter:"z"}),r}},{"../../components/colorscale":655,"../heatmap/calc":1066,"./end_plus":1019,"./set_contours":1027}],1010:[function(n,z,q){"use strict";z.exports=function(t,h){var p,l=t[0],e=l.z;switch(h.type){case"levels":var o=Math.min(e[0][0],e[0][1]);for(p=0;p<t.length;p++){var r=t[p];r.prefixBoundary=!r.edgepaths.length&&(o>r.level||r.starts.length&&o===r.level)}break;case"constraint":if(l.prefixBoundary=!1,l.edgepaths.length)return;var i=l.x.length,u=l.y.length,s=-1/0,a=1/0;for(p=0;p<u;p++)a=Math.min(a,e[p][0]),a=Math.min(a,e[p][i-1]),s=Math.max(s,e[p][0]),s=Math.max(s,e[p][i-1]);for(p=1;p<i-1;p++)a=Math.min(a,e[0][p]),a=Math.min(a,e[u-1][p]),s=Math.max(s,e[0][p]),s=Math.max(s,e[u-1][p]);var c,f,g=h.value;switch(h._operation){case">":g>s&&(l.prefixBoundary=!0);break;case"<":(g<a||l.starts.length&&g===a)&&(l.prefixBoundary=!0);break;case"[]":c=Math.min(g[0],g[1]),((f=Math.max(g[0],g[1]))<a||c>s||l.starts.length&&f===a)&&(l.prefixBoundary=!0);break;case"][":c=Math.min(g[0],g[1]),f=Math.max(g[0],g[1]),c<a&&f>s&&(l.prefixBoundary=!0)}}}},{}],1011:[function(n,z,q){"use strict";var t=n("../../components/colorscale"),h=n("./make_color_map"),p=n("./end_plus");z.exports={min:"zmin",max:"zmax",calc:function(l,e,o){var r=e.contours,i=e.line,u=r.size||1,s=r.coloring,a=h(e,{isColorbar:!0});if(s==="heatmap"){var c=t.extractOpts(e);o._fillgradient=c.reversescale?t.flipScale(c.colorscale):c.colorscale,o._zrange=[c.min,c.max]}else s==="fill"&&(o._fillcolor=a);o._line={color:s==="lines"?a:i.color,width:r.showlines!==!1?i.width:0,dash:i.dash},o._levels={start:r.start,end:p(r),size:u}}}},{"../../components/colorscale":655,"./end_plus":1019,"./make_color_map":1024}],1012:[function(n,z,q){"use strict";z.exports={BOTTOMSTART:[1,9,13,104,713],TOPSTART:[4,6,7,104,713],LEFTSTART:[8,12,14,208,1114],RIGHTSTART:[2,3,11,208,1114],NEWDELTA:[null,[-1,0],[0,-1],[-1,0],[1,0],null,[0,-1],[-1,0],[0,1],[0,1],null,[0,1],[1,0],[1,0],[0,-1]],CHOOSESADDLE:{104:[4,1],208:[2,8],713:[7,13],1114:[11,14]},SADDLEREMAINDER:{1:4,2:8,4:1,7:13,8:2,11:14,13:7,14:11},LABELDISTANCE:2,LABELINCREASE:10,LABELMIN:3,LABELMAX:10,LABELOPTIMIZER:{EDGECOST:1,ANGLECOST:1,NEIGHBORCOST:5,SAMELEVELFACTOR:10,SAMELEVELDISTANCE:5,MAXCOST:100,INITIALSEARCHPOINTS:10,ITERATIONS:5}}},{}],1013:[function(n,z,q){"use strict";var t=n("fast-isnumeric"),h=n("./label_defaults"),p=n("../../components/color"),l=p.addOpacity,e=p.opacity,o=n("../../constants/filter_ops"),r=o.CONSTRAINT_REDUCTION,i=o.COMPARISON_OPS2;z.exports=function(u,s,a,c,f,g){var d,m,y,v=s.contours,T=a("contours.operation");v._operation=r[T],function(w,A){var E;i.indexOf(A.operation)===-1?(w("contours.value",[0,1]),Array.isArray(A.value)?A.value.length>2?A.value=A.value.slice(2):A.length===0?A.value=[0,1]:A.length<2?(E=parseFloat(A.value[0]),A.value=[E,E+1]):A.value=[parseFloat(A.value[0]),parseFloat(A.value[1])]:t(A.value)&&(E=parseFloat(A.value),A.value=[E,E+1])):(w("contours.value",0),t(A.value)||(Array.isArray(A.value)?A.value=parseFloat(A.value[0]):A.value=0))}(a,v),T==="="?d=v.showlines=!0:(d=a("contours.showlines"),y=a("fillcolor",l((u.line||{}).color||f,.5))),d&&(m=a("line.color",y&&e(y)?l(s.fillcolor,1):f),a("line.width",2),a("line.dash")),a("line.smoothing"),h(a,c,m,g)}},{"../../components/color":643,"../../constants/filter_ops":749,"./label_defaults":1023,"fast-isnumeric":241}],1014:[function(n,z,q){"use strict";var t=n("../../constants/filter_ops"),h=n("fast-isnumeric");function p(o,r){var i,u=Array.isArray(r);function s(a){return h(a)?+a:null}return t.COMPARISON_OPS2.indexOf(o)!==-1?i=s(u?r[0]:r):t.INTERVAL_OPS.indexOf(o)!==-1?i=u?[s(r[0]),s(r[1])]:[s(r),s(r)]:t.SET_OPS.indexOf(o)!==-1&&(i=u?r.map(s):[s(r)]),i}function l(o){return function(r){r=p(o,r);var i=Math.min(r[0],r[1]),u=Math.max(r[0],r[1]);return{start:i,end:u,size:u-i}}}function e(o){return function(r){return{start:r=p(o,r),end:1/0,size:1/0}}}z.exports={"[]":l("[]"),"][":l("]["),">":e(">"),"<":e("<"),"=":e("=")}},{"../../constants/filter_ops":749,"fast-isnumeric":241}],1015:[function(n,z,q){"use strict";z.exports=function(t,h,p,l){var e=l("contours.start"),o=l("contours.end"),r=e===!1||o===!1,i=p("contours.size");!(r?h.autocontour=!0:p("autocontour",!1))&&i||p("ncontours")}},{}],1016:[function(n,z,q){"use strict";var t=n("../../lib");function h(p){return t.extendFlat({},p,{edgepaths:t.extendDeep([],p.edgepaths),paths:t.extendDeep([],p.paths),starts:t.extendDeep([],p.starts)})}z.exports=function(p,l){var e,o,r,i=function(a){return a.reverse()},u=function(a){return a};switch(l){case"=":case"<":return p;case">":for(p.length!==1&&t.warn("Contour data invalid for the specified inequality operation."),o=p[0],e=0;e<o.edgepaths.length;e++)o.edgepaths[e]=i(o.edgepaths[e]);for(e=0;e<o.paths.length;e++)o.paths[e]=i(o.paths[e]);for(e=0;e<o.starts.length;e++)o.starts[e]=i(o.starts[e]);return p;case"][":var s=i;i=u,u=s;case"[]":for(p.length!==2&&t.warn("Contour data invalid for the specified inequality range operation."),o=h(p[0]),r=h(p[1]),e=0;e<o.edgepaths.length;e++)o.edgepaths[e]=i(o.edgepaths[e]);for(e=0;e<o.paths.length;e++)o.paths[e]=i(o.paths[e]);for(e=0;e<o.starts.length;e++)o.starts[e]=i(o.starts[e]);for(;r.edgepaths.length;)o.edgepaths.push(u(r.edgepaths.shift()));for(;r.paths.length;)o.paths.push(u(r.paths.shift()));for(;r.starts.length;)o.starts.push(u(r.starts.shift()));return[o]}}},{"../../lib":778}],1017:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../heatmap/xyz_defaults"),p=n("../scatter/period_defaults"),l=n("./constraint_defaults"),e=n("./contours_defaults"),o=n("./style_defaults"),r=n("./attributes");z.exports=function(i,u,s,a){function c(g,d){return t.coerce(i,u,r,g,d)}if(h(i,u,c,a)){p(i,u,a,c),c("text"),c("hovertext"),c("hovertemplate"),c("hoverongaps");var f=c("contours.type")==="constraint";c("connectgaps",t.isArray1D(u.z)),f?l(i,u,c,a,s):(e(i,u,c,function(g){return t.coerce2(i,u,r,g)}),o(i,u,c,a))}else u.visible=!1}},{"../../lib":778,"../heatmap/xyz_defaults":1079,"../scatter/period_defaults":1207,"./attributes":1008,"./constraint_defaults":1013,"./contours_defaults":1015,"./style_defaults":1029}],1018:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("./constraint_mapping"),p=n("./end_plus");z.exports=function(l,e,o){for(var r=l.type==="constraint"?h[l._operation](l.value):l,i=r.size,u=[],s=p(r),a=o.trace._carpetTrace,c=a?{xaxis:a.aaxis,yaxis:a.baxis,x:o.a,y:o.b}:{xaxis:e.xaxis,yaxis:e.yaxis,x:o.x,y:o.y},f=r.start;f<s;f+=i)if(u.push(t.extendFlat({level:f,crossings:{},starts:[],edgepaths:[],paths:[],z:o.z,smoothing:o.trace.line.smoothing},c)),u.length>1e3){t.warn("Too many contours, clipping at 1000",l);break}return u}},{"../../lib":778,"./constraint_mapping":1014,"./end_plus":1019}],1019:[function(n,z,q){"use strict";z.exports=function(t){return t.end+t.size/1e6}},{}],1020:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("./constants");function p(o,r,i,u){return Math.abs(o[0]-r[0])<i&&Math.abs(o[1]-r[1])<u}function l(o,r,i,u,s){var a,c=r.join(","),f=o.crossings[c],g=function(ee,ie,ae){var oe=0,de=0;return ee>20&&ie?ee===208||ee===1114?oe=ae[0]===0?1:-1:de=ae[1]===0?1:-1:h.BOTTOMSTART.indexOf(ee)!==-1?de=1:h.LEFTSTART.indexOf(ee)!==-1?oe=1:h.TOPSTART.indexOf(ee)!==-1?de=-1:oe=-1,[oe,de]}(f,i,r),d=[e(o,r,[-g[0],-g[1]])],m=o.z.length,y=o.z[0].length,v=r.slice(),T=g.slice();for(a=0;a<1e4;a++){if(f>20?(f=h.CHOOSESADDLE[f][(g[0]||g[1])<0?0:1],o.crossings[c]=h.SADDLEREMAINDER[f]):delete o.crossings[c],!(g=h.NEWDELTA[f])){t.log("Found bad marching index:",f,r,o.level);break}d.push(e(o,r,g)),r[0]+=g[0],r[1]+=g[1],c=r.join(","),p(d[d.length-1],d[d.length-2],u,s)&&d.pop();var w=g[0]&&(r[0]<0||r[0]>y-2)||g[1]&&(r[1]<0||r[1]>m-2);if(r[0]===v[0]&&r[1]===v[1]&&g[0]===T[0]&&g[1]===T[1]||i&&w)break;f=o.crossings[c]}a===1e4&&t.log("Infinite loop in contour?");var A,E,M,b,_,S,C,k,L,I,R,V,O,J,D,B=p(d[0],d[d.length-1],u,s),N=0,F=.2*o.smoothing,H=[],j=0;for(a=1;a<d.length;a++)V=d[a],O=d[a-1],J=void 0,D=void 0,J=V[2]-O[2],D=V[3]-O[3],N+=C=Math.sqrt(J*J+D*D),H.push(C);var G=N/H.length*F;function W(ee){return d[ee%d.length]}for(a=d.length-2;a>=j;a--)if((A=H[a])<G){for(M=0,E=a-1;E>=j&&A+H[E]<G;E--)A+=H[E];if(B&&a===d.length-2)for(M=0;M<E&&A+H[M]<G;M++)A+=H[M];_=a-E+M+1,S=Math.floor((a+E+M+2)/2),b=B||a!==d.length-2?B||E!==-1?_%2?W(S):[(W(S)[0]+W(S+1)[0])/2,(W(S)[1]+W(S+1)[1])/2]:d[0]:d[d.length-1],d.splice(E+1,a-E+1,b),a=E+1,M&&(j=M),B&&(a===d.length-2?d[M]=d[d.length-1]:a===0&&(d[d.length-1]=d[0]))}for(d.splice(0,j),a=0;a<d.length;a++)d[a].length=2;if(!(d.length<2))if(B)d.pop(),o.paths.push(d);else{i||t.log("Unclosed interior contour?",o.level,v.join(","),d.join("L"));var Q=!1;for(k=0;k<o.edgepaths.length;k++)if(I=o.edgepaths[k],!Q&&p(I[0],d[d.length-1],u,s)){d.pop(),Q=!0;var $=!1;for(L=0;L<o.edgepaths.length;L++)if(p((R=o.edgepaths[L])[R.length-1],d[0],u,s)){$=!0,d.shift(),o.edgepaths.splice(k,1),L===k?o.paths.push(d.concat(R)):(L>k&&L--,o.edgepaths[L]=R.concat(d,I));break}$||(o.edgepaths[k]=d.concat(I))}for(k=0;k<o.edgepaths.length&&!Q;k++)p((I=o.edgepaths[k])[I.length-1],d[0],u,s)&&(d.shift(),o.edgepaths[k]=I.concat(d),Q=!0);Q||o.edgepaths.push(d)}}function e(o,r,i){var u=r[0]+Math.max(i[0],0),s=r[1]+Math.max(i[1],0),a=o.z[s][u],c=o.xaxis,f=o.yaxis;if(i[1]){var g=(o.level-a)/(o.z[s][u+1]-a);return[c.c2p((1-g)*o.x[u]+g*o.x[u+1],!0),f.c2p(o.y[s],!0),u+g,s]}var d=(o.level-a)/(o.z[s+1][u]-a);return[c.c2p(o.x[u],!0),f.c2p((1-d)*o.y[s]+d*o.y[s+1],!0),u,s+d]}z.exports=function(o,r,i){var u,s,a,c;for(r=r||.01,i=i||.01,s=0;s<o.length;s++){for(a=o[s],c=0;c<a.starts.length;c++)l(a,a.starts[c],"edge",r,i);for(u=0;Object.keys(a.crossings).length&&u<1e4;)u++,l(a,Object.keys(a.crossings)[0].split(",").map(Number),void 0,r,i);u===1e4&&t.log("Infinite loop in contour?")}}},{"../../lib":778,"./constants":1012}],1021:[function(n,z,q){"use strict";var t=n("../../components/color"),h=n("../heatmap/hover");z.exports=function(p,l,e,o,r){var i=h(p,l,e,o,r,!0);return i&&i.forEach(function(u){var s=u.trace;s.contours.type==="constraint"&&(s.fillcolor&&t.opacity(s.fillcolor)?u.color=t.addOpacity(s.fillcolor,1):s.contours.showlines&&t.opacity(s.line.color)&&(u.color=t.addOpacity(s.line.color,1)))}),i}},{"../../components/color":643,"../heatmap/hover":1072}],1022:[function(n,z,q){"use strict";z.exports={attributes:n("./attributes"),supplyDefaults:n("./defaults"),calc:n("./calc"),plot:n("./plot").plot,style:n("./style"),colorbar:n("./colorbar"),hoverPoints:n("./hover"),moduleType:"trace",name:"contour",basePlotModule:n("../../plots/cartesian"),categories:["cartesian","svg","2dMap","contour","showLegend"],meta:{}}},{"../../plots/cartesian":841,"./attributes":1008,"./calc":1009,"./colorbar":1011,"./defaults":1017,"./hover":1021,"./plot":1026,"./style":1028}],1023:[function(n,z,q){"use strict";var t=n("../../lib");z.exports=function(h,p,l,e){if(e||(e={}),h("contours.showlabels")){var o=p.font;t.coerceFont(h,"contours.labelfont",{family:o.family,size:o.size,color:l}),h("contours.labelformat")}e.hasHover!==!1&&h("zhoverformat")}},{"../../lib":778}],1024:[function(n,z,q){"use strict";var t=n("d3"),h=n("../../components/colorscale"),p=n("./end_plus");z.exports=function(l){var e=l.contours,o=e.start,r=p(e),i=e.size||1,u=Math.floor((r-o)/i)+1,s=e.coloring==="lines"?0:1,a=h.extractOpts(l);isFinite(i)||(i=1,u=1);var c,f,g=a.reversescale?h.flipScale(a.colorscale):a.colorscale,d=g.length,m=new Array(d),y=new Array(d);if(e.coloring==="heatmap"){var v=a.min,T=a.max;for(f=0;f<d;f++)c=g[f],m[f]=c[0]*(T-v)+v,y[f]=c[1];var w=t.extent([v,T,e.start,e.start+i*(u-1)]),A=w[v<T?0:1],E=w[v<T?1:0];A!==v&&(m.splice(0,0,A),y.splice(0,0,y[0])),E!==T&&(m.push(E),y.push(y[y.length-1]))}else for(f=0;f<d;f++)c=g[f],m[f]=(c[0]*(u+s-1)-s/2)*i+o,y[f]=c[1];return h.makeColorScaleFunc({domain:m,range:y},{noNumericCheck:!0})}},{"../../components/colorscale":655,"./end_plus":1019,d3:169}],1025:[function(n,z,q){"use strict";var t=n("./constants");function h(p,l){var e=(l[0][0]>p?0:1)+(l[0][1]>p?0:2)+(l[1][1]>p?0:4)+(l[1][0]>p?0:8);return e===5||e===10?p>(l[0][0]+l[0][1]+l[1][0]+l[1][1])/4?e===5?713:1114:e===5?104:208:e===15?0:e}z.exports=function(p){var l,e,o,r,i,u,s,a,c,f=p[0].z,g=f.length,d=f[0].length,m=g===2||d===2;for(e=0;e<g-1;e++)for(r=[],e===0&&(r=r.concat(t.BOTTOMSTART)),e===g-2&&(r=r.concat(t.TOPSTART)),l=0;l<d-1;l++)for(o=r.slice(),l===0&&(o=o.concat(t.LEFTSTART)),l===d-2&&(o=o.concat(t.RIGHTSTART)),i=l+","+e,u=[[f[e][l],f[e][l+1]],[f[e+1][l],f[e+1][l+1]]],c=0;c<p.length;c++)(s=h((a=p[c]).level,u))&&(a.crossings[i]=s,o.indexOf(s)!==-1&&(a.starts.push([l,e]),m&&o.indexOf(s,o.indexOf(s)+1)!==-1&&a.starts.push([l,e])))}},{"./constants":1012}],1026:[function(n,z,q){"use strict";var t=n("d3"),h=n("../../lib"),p=n("../../components/drawing"),l=n("../../components/colorscale"),e=n("../../lib/svg_text_utils"),o=n("../../plots/cartesian/axes"),r=n("../../plots/cartesian/set_convert"),i=n("../heatmap/plot"),u=n("./make_crossings"),s=n("./find_all_paths"),a=n("./empty_pathinfo"),c=n("./convert_to_constraints"),f=n("./close_boundaries"),g=n("./constants"),d=g.LABELOPTIMIZER;function m(T,w){var A,E,M,b,_,S,C,k="",L=0,I=T.edgepaths.map(function(B,N){return N}),R=!0;function V(B){return Math.abs(B[1]-w[2][1])<.01}function O(B){return Math.abs(B[0]-w[0][0])<.01}function J(B){return Math.abs(B[0]-w[2][0])<.01}for(;I.length;){for(S=p.smoothopen(T.edgepaths[L],T.smoothing),k+=R?S:S.replace(/^M/,"L"),I.splice(I.indexOf(L),1),A=T.edgepaths[L][T.edgepaths[L].length-1],b=-1,M=0;M<4;M++){if(!A){h.log("Missing end?",L,T);break}for(C=A,Math.abs(C[1]-w[0][1])<.01&&!J(A)?E=w[1]:O(A)?E=w[0]:V(A)?E=w[3]:J(A)&&(E=w[2]),_=0;_<T.edgepaths.length;_++){var D=T.edgepaths[_][0];Math.abs(A[0]-E[0])<.01?Math.abs(A[0]-D[0])<.01&&(D[1]-A[1])*(E[1]-D[1])>=0&&(E=D,b=_):Math.abs(A[1]-E[1])<.01?Math.abs(A[1]-D[1])<.01&&(D[0]-A[0])*(E[0]-D[0])>=0&&(E=D,b=_):h.log("endpt to newendpt is not vert. or horz.",A,E,D)}if(A=E,b>=0)break;k+="L"+E}if(b===T.edgepaths.length){h.log("unclosed perimeter path");break}L=b,(R=I.indexOf(L)===-1)&&(L=I[0],k+="Z")}for(L=0;L<T.paths.length;L++)k+=p.smoothclosed(T.paths[L],T.smoothing);return k}function y(T,w,A,E){var M=w.width/2,b=w.height/2,_=T.x,S=T.y,C=T.theta,k=Math.cos(C)*M,L=Math.sin(C)*M,I=(_>E.center?E.right-_:_-E.left)/(k+Math.abs(Math.sin(C)*b)),R=(S>E.middle?E.bottom-S:S-E.top)/(Math.abs(L)+Math.cos(C)*b);if(I<1||R<1)return 1/0;var V=d.EDGECOST*(1/(I-1)+1/(R-1));V+=d.ANGLECOST*C*C;for(var O=_-k,J=S-L,D=_+k,B=S+L,N=0;N<A.length;N++){var F=A[N],H=Math.cos(F.theta)*F.width/2,j=Math.sin(F.theta)*F.width/2,G=2*h.segmentDistance(O,J,D,B,F.x-H,F.y-j,F.x+H,F.y+j)/(w.height+F.height),W=F.level===w.level,Q=W?d.SAMELEVELDISTANCE:1;if(G<=Q)return 1/0;V+=d.NEIGHBORCOST*(W?d.SAMELEVELFACTOR:1)/(G-Q)}return V}function v(T){var w,A,E=T.trace._emptypoints,M=[],b=T.z.length,_=T.z[0].length,S=[];for(w=0;w<_;w++)S.push(1);for(w=0;w<b;w++)M.push(S.slice());for(w=0;w<E.length;w++)M[(A=E[w])[0]][A[1]]=0;return T.zmask=M,M}q.plot=function(T,w,A,E){var M=w.xaxis,b=w.yaxis;h.makeTraceGroups(E,A,"contour").each(function(_){var S=t.select(this),C=_[0],k=C.trace,L=C.x,I=C.y,R=k.contours,V=a(R,w,C),O=h.ensureSingle(S,"g","heatmapcoloring"),J=[];R.coloring==="heatmap"&&(J=[_]),i(T,w,J,O),u(V),s(V);var D=M.c2p(L[0],!0),B=M.c2p(L[L.length-1],!0),N=b.c2p(I[0],!0),F=b.c2p(I[I.length-1],!0),H=[[D,F],[B,F],[B,N],[D,N]],j=V;R.type==="constraint"&&(j=c(V,R._operation)),function(G,W,Q){var $=h.ensureSingle(G,"g","contourbg").selectAll("path").data(Q.coloring==="fill"?[0]:[]);$.enter().append("path"),$.exit().remove(),$.attr("d","M"+W.join("L")+"Z").style("stroke","none")}(S,H,R),function(G,W,Q,$){var ee=$.coloring==="fill"||$.type==="constraint"&&$._operation!=="=",ie="M"+Q.join("L")+"Z";ee&&f(W,$);var ae=h.ensureSingle(G,"g","contourfill").selectAll("path").data(ee?W:[]);ae.enter().append("path"),ae.exit().remove(),ae.each(function(oe){var de=(oe.prefixBoundary?ie:"")+m(oe,Q);de?t.select(this).attr("d",de).style("stroke","none"):t.select(this).remove()})}(S,j,H,R),function(G,W,Q,$,ee){var ie=h.ensureSingle(G,"g","contourlines"),ae=ee.showlines!==!1,oe=ee.showlabels,de=ae&&oe,le=q.createLines(ie,ae||oe,W),fe=q.createLineClip(ie,de,Q,$.trace.uid),ue=G.selectAll("g.contourlabels").data(oe?[0]:[]);if(ue.exit().remove(),ue.enter().append("g").classed("contourlabels",!0),oe){var we=[],Ae=[];h.clearLocationCache();var Se=q.labelFormatter(Q,$),ke=p.tester.append("text").attr("data-notex",1).call(p.font,ee.labelfont),Me=W[0].xaxis,ve=W[0].yaxis,ge=Me._length,De=ve._length,_e=Me.range,Pe=ve.range,Fe=h.aggNums(Math.min,null,$.x),ze=h.aggNums(Math.max,null,$.x),He=h.aggNums(Math.min,null,$.y),et=h.aggNums(Math.max,null,$.y),Re=Math.max(Me.c2p(Fe,!0),0),Ze=Math.min(Me.c2p(ze,!0),ge),Ke=Math.max(ve.c2p(et,!0),0),$e=Math.min(ve.c2p(He,!0),De),rt={};_e[0]<_e[1]?(rt.left=Re,rt.right=Ze):(rt.left=Ze,rt.right=Re),Pe[0]<Pe[1]?(rt.top=Ke,rt.bottom=$e):(rt.top=$e,rt.bottom=Ke),rt.middle=(rt.top+rt.bottom)/2,rt.center=(rt.left+rt.right)/2,we.push([[rt.left,rt.top],[rt.right,rt.top],[rt.right,rt.bottom],[rt.left,rt.bottom]]);var at=Math.sqrt(ge*ge+De*De),lt=g.LABELDISTANCE*at/Math.max(1,W.length/g.LABELINCREASE);le.each(function(gt){var Ie=q.calcTextOpts(gt.level,Se,ke,Q);t.select(this).selectAll("path").each(function(){var be=h.getVisibleSegment(this,rt,Ie.height/2);if(be&&!(be.len<(Ie.width+Ie.height)*g.LABELMIN))for(var We=Math.min(Math.ceil(be.len/lt),g.LABELMAX),Ge=0;Ge<We;Ge++){var st=q.findBestTextLocation(this,be,Ie,Ae,rt);if(!st)break;q.addLabelData(st,Ie,Ae,we)}})}),ke.remove(),q.drawLabels(ue,Ae,Q,fe,de?we:null)}oe&&!ae&&le.remove()}(S,V,T,C,R),function(G,W,Q,$,ee){var ie=$.trace,ae=Q._fullLayout._clips,oe="clip"+ie.uid,de=ae.selectAll("#"+oe).data(ie.connectgaps?[]:[0]);if(de.enter().append("clipPath").classed("contourclip",!0).attr("id",oe),de.exit().remove(),ie.connectgaps===!1){var le={level:.9,crossings:{},starts:[],edgepaths:[],paths:[],xaxis:W.xaxis,yaxis:W.yaxis,x:$.x,y:$.y,z:v($),smoothing:0};u([le]),s([le]),f([le],{type:"levels"}),h.ensureSingle(de,"path","").attr("d",(le.prefixBoundary?"M"+ee.join("L")+"Z":"")+m(le,ee))}else oe=null;p.setClipUrl(G,oe,Q)}(S,w,T,C,H)})},q.createLines=function(T,w,A){var E=A[0].smoothing,M=T.selectAll("g.contourlevel").data(w?A:[]);if(M.exit().remove(),M.enter().append("g").classed("contourlevel",!0),w){var b=M.selectAll("path.openline").data(function(S){return S.pedgepaths||S.edgepaths});b.exit().remove(),b.enter().append("path").classed("openline",!0),b.attr("d",function(S){return p.smoothopen(S,E)}).style("stroke-miterlimit",1).style("vector-effect","non-scaling-stroke");var _=M.selectAll("path.closedline").data(function(S){return S.ppaths||S.paths});_.exit().remove(),_.enter().append("path").classed("closedline",!0),_.attr("d",function(S){return p.smoothclosed(S,E)}).style("stroke-miterlimit",1).style("vector-effect","non-scaling-stroke")}return M},q.createLineClip=function(T,w,A,E){var M=w?"clipline"+E:null,b=A._fullLayout._clips.selectAll("#"+M).data(w?[0]:[]);return b.exit().remove(),b.enter().append("clipPath").classed("contourlineclip",!0).attr("id",M),p.setClipUrl(T,M,A),b},q.labelFormatter=function(T,w){var A=T._fullLayout,E=w.trace,M=E.contours,b={type:"linear",_id:"ycontour",showexponent:"all",exponentformat:"B"};if(M.labelformat)b.tickformat=M.labelformat,r(b,A);else{var _=l.extractOpts(E);if(_&&_.colorbar&&_.colorbar._axis)b=_.colorbar._axis;else{if(M.type==="constraint"){var S=M.value;Array.isArray(S)?b.range=[S[0],S[S.length-1]]:b.range=[S,S]}else b.range=[M.start,M.end],b.nticks=(M.end-M.start)/M.size;b.range[0]===b.range[1]&&(b.range[1]+=b.range[0]||1),b.nticks||(b.nticks=1e3),r(b,A),o.prepTicks(b),b._tmin=null,b._tmax=null}}return function(C){return o.tickText(b,C).text}},q.calcTextOpts=function(T,w,A,E){var M=w(T);A.text(M).call(e.convertToTspans,E);var b=A.node(),_=p.bBox(b,!0);return{text:M,width:_.width,height:_.height,fontSize:+b.style["font-size"].replace("px",""),level:T,dy:(_.top+_.bottom)/2}},q.findBestTextLocation=function(T,w,A,E,M){var b,_,S,C,k,L=A.width;w.isClosed?(_=w.len/d.INITIALSEARCHPOINTS,b=w.min+_/2,S=w.max):(_=(w.len-L)/(d.INITIALSEARCHPOINTS+1),b=w.min+_+L/2,S=w.max-(_+L)/2);for(var I=1/0,R=0;R<d.ITERATIONS;R++){for(var V=b;V<S;V+=_){var O=h.getTextLocation(T,w.total,V,L),J=y(O,A,E,M);J<I&&(I=J,k=O,C=V)}if(I>2*d.MAXCOST)break;R&&(_/=2),S=(b=C-_/2)+1.5*_}if(I<=d.MAXCOST)return k},q.addLabelData=function(T,w,A,E){var M=w.fontSize,b=w.width+M/3,_=Math.max(0,w.height-M/3),S=T.x,C=T.y,k=T.theta,L=Math.sin(k),I=Math.cos(k),R=function(O,J){return[S+O*I-J*L,C+O*L+J*I]},V=[R(-b/2,-_/2),R(-b/2,_/2),R(b/2,_/2),R(b/2,-_/2)];A.push({text:w.text,x:S,y:C,dy:w.dy,theta:k,level:w.level,width:b,height:_}),E.push(V)},q.drawLabels=function(T,w,A,E,M){var b=T.selectAll("text").data(w,function(C){return C.text+","+C.x+","+C.y+","+C.theta});if(b.exit().remove(),b.enter().append("text").attr({"data-notex":1,"text-anchor":"middle"}).each(function(C){var k=C.x+Math.sin(C.theta)*C.dy,L=C.y-Math.cos(C.theta)*C.dy;t.select(this).text(C.text).attr({x:k,y:L,transform:"rotate("+180*C.theta/Math.PI+" "+k+" "+L+")"}).call(e.convertToTspans,A)}),M){for(var _="",S=0;S<M.length;S++)_+="M"+M[S].join("L")+"Z";h.ensureSingle(E,"path","").attr("d",_)}}},{"../../components/colorscale":655,"../../components/drawing":665,"../../lib":778,"../../lib/svg_text_utils":803,"../../plots/cartesian/axes":828,"../../plots/cartesian/set_convert":848,"../heatmap/plot":1076,"./close_boundaries":1010,"./constants":1012,"./convert_to_constraints":1016,"./empty_pathinfo":1018,"./find_all_paths":1020,"./make_crossings":1025,d3:169}],1027:[function(n,z,q){"use strict";var t=n("../../plots/cartesian/axes"),h=n("../../lib");function p(l,e,o){var r={type:"linear",range:[l,e]};return t.autoTicks(r,(e-l)/(o||15)),r}z.exports=function(l,e){var o=l.contours;if(l.autocontour){var r=l.zmin,i=l.zmax;(l.zauto||r===void 0)&&(r=h.aggNums(Math.min,null,e)),(l.zauto||i===void 0)&&(i=h.aggNums(Math.max,null,e));var u=p(r,i,l.ncontours);o.size=u.dtick,o.start=t.tickFirst(u),u.range.reverse(),o.end=t.tickFirst(u),o.start===r&&(o.start+=o.size),o.end===i&&(o.end-=o.size),o.start>o.end&&(o.start=o.end=(o.start+o.end)/2),l._input.contours||(l._input.contours={}),h.extendFlat(l._input.contours,{start:o.start,end:o.end,size:o.size}),l._input.autocontour=!0}else if(o.type!=="constraint"){var s,a=o.start,c=o.end,f=l._input.contours;a>c&&(o.start=f.start=c,c=o.end=f.end=a,a=o.start),!(o.size>0)&&(s=a===c?1:p(a,c,l.ncontours).dtick,f.size=o.size=s)}}},{"../../lib":778,"../../plots/cartesian/axes":828}],1028:[function(n,z,q){"use strict";var t=n("d3"),h=n("../../components/drawing"),p=n("../heatmap/style"),l=n("./make_color_map");z.exports=function(e){var o=t.select(e).selectAll("g.contour");o.style("opacity",function(r){return r[0].trace.opacity}),o.each(function(r){var i=t.select(this),u=r[0].trace,s=u.contours,a=u.line,c=s.size||1,f=s.start,g=s.type==="constraint",d=!g&&s.coloring==="lines",m=!g&&s.coloring==="fill",y=d||m?l(u):null;i.selectAll("g.contourlevel").each(function(w){t.select(this).selectAll("path").call(h.lineGroupStyle,a.width,d?y(w.level):a.color,a.dash)});var v=s.labelfont;if(i.selectAll("g.contourlabels text").each(function(w){h.font(t.select(this),{family:v.family,size:v.size,color:v.color||(d?y(w.level):a.color)})}),g)i.selectAll("g.contourfill path").style("fill",u.fillcolor);else if(m){var T;i.selectAll("g.contourfill path").style("fill",function(w){return T===void 0&&(T=w.level),y(w.level+.5*c)}),T===void 0&&(T=f),i.selectAll("g.contourbg path").style("fill",y(T-.5*c))}}),p(e)}},{"../../components/drawing":665,"../heatmap/style":1077,"./make_color_map":1024,d3:169}],1029:[function(n,z,q){"use strict";var t=n("../../components/colorscale/defaults"),h=n("./label_defaults");z.exports=function(p,l,e,o,r){var i,u=e("contours.coloring"),s="";u==="fill"&&(i=e("contours.showlines")),i!==!1&&(u!=="lines"&&(s=e("line.color","#000")),e("line.width",.5),e("line.dash")),u!=="none"&&(p.showlegend!==!0&&(l.showlegend=!1),l._dfltShowLegend=!1,t(p,l,o,e,{prefix:"",cLetter:"z"})),e("line.smoothing"),h(e,o,s,r)}},{"../../components/colorscale/defaults":653,"./label_defaults":1023}],1030:[function(n,z,q){"use strict";var t=n("../heatmap/attributes"),h=n("../contour/attributes"),p=n("../../components/colorscale/attributes"),l=n("../../lib/extend").extendFlat,e=h.contours;z.exports=l({carpet:{valType:"string",editType:"calc"},z:t.z,a:t.x,a0:t.x0,da:t.dx,b:t.y,b0:t.y0,db:t.dy,text:t.text,hovertext:t.hovertext,transpose:t.transpose,atype:t.xtype,btype:t.ytype,fillcolor:h.fillcolor,autocontour:h.autocontour,ncontours:h.ncontours,contours:{type:e.type,start:e.start,end:e.end,size:e.size,coloring:{valType:"enumerated",values:["fill","lines","none"],dflt:"fill",editType:"calc"},showlines:e.showlines,showlabels:e.showlabels,labelfont:e.labelfont,labelformat:e.labelformat,operation:e.operation,value:e.value,editType:"calc",impliedEdits:{autocontour:!1}},line:{color:h.line.color,width:h.line.width,dash:h.line.dash,smoothing:h.line.smoothing,editType:"plot"},transforms:void 0},p("",{cLetter:"z",autoColorDflt:!1}))},{"../../components/colorscale/attributes":650,"../../lib/extend":768,"../contour/attributes":1008,"../heatmap/attributes":1065}],1031:[function(n,z,q){"use strict";var t=n("../../components/colorscale/calc"),h=n("../../lib"),p=n("../heatmap/convert_column_xyz"),l=n("../heatmap/clean_2d_array"),e=n("../heatmap/interp2d"),o=n("../heatmap/find_empties"),r=n("../heatmap/make_bound_array"),i=n("./defaults"),u=n("../carpet/lookup_carpetid"),s=n("../contour/set_contours");z.exports=function(a,c){var f=c._carpetTrace=u(a,c);if(f&&f.visible&&f.visible!=="legendonly"){if(!c.a||!c.b){var g=a.data[f.index],d=a.data[c.index];d.a||(d.a=g.a),d.b||(d.b=g.b),i(d,c,c._defaultColor,a._fullLayout)}var m=function(y,v){var T,w,A,E,M,b,_,S=v._carpetTrace,C=S.aaxis,k=S.baxis;C._minDtick=0,k._minDtick=0,h.isArray1D(v.z)&&p(v,C,k,"a","b",["z"]),T=v._a=v._a||v.a,E=v._b=v._b||v.b,T=T?C.makeCalcdata(v,"_a"):[],E=E?k.makeCalcdata(v,"_b"):[],w=v.a0||0,A=v.da||1,M=v.b0||0,b=v.db||1,_=v._z=l(v._z||v.z,v.transpose),v._emptypoints=o(_),e(_,v._emptypoints);var L=h.maxRowLength(_),I=v.xtype==="scaled"?"":T,R=r(v,I,w,A,L,C),V=v.ytype==="scaled"?"":E,O=r(v,V,M,b,_.length,k),J={a:R,b:O,z:_};return v.contours.type==="levels"&&v.contours.coloring!=="none"&&t(y,v,{vals:_,containerStr:"",cLetter:"z"}),[J]}(a,c);return s(c,c._z),m}}},{"../../components/colorscale/calc":651,"../../lib":778,"../carpet/lookup_carpetid":981,"../contour/set_contours":1027,"../heatmap/clean_2d_array":1067,"../heatmap/convert_column_xyz":1069,"../heatmap/find_empties":1071,"../heatmap/interp2d":1074,"../heatmap/make_bound_array":1075,"./defaults":1032}],1032:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../heatmap/xyz_defaults"),p=n("./attributes"),l=n("../contour/constraint_defaults"),e=n("../contour/contours_defaults"),o=n("../contour/style_defaults");z.exports=function(r,i,u,s){function a(c,f){return t.coerce(r,i,p,c,f)}if(a("carpet"),r.a&&r.b){if(!h(r,i,a,s,"a","b"))return void(i.visible=!1);a("text"),a("contours.type")==="constraint"?l(r,i,a,s,u,{hasHover:!1}):(e(r,i,a,function(c){return t.coerce2(r,i,p,c)}),o(r,i,a,s,{hasHover:!1}))}else i._defaultColor=u,i._length=null}},{"../../lib":778,"../contour/constraint_defaults":1013,"../contour/contours_defaults":1015,"../contour/style_defaults":1029,"../heatmap/xyz_defaults":1079,"./attributes":1030}],1033:[function(n,z,q){"use strict";z.exports={attributes:n("./attributes"),supplyDefaults:n("./defaults"),colorbar:n("../contour/colorbar"),calc:n("./calc"),plot:n("./plot"),style:n("../contour/style"),moduleType:"trace",name:"contourcarpet",basePlotModule:n("../../plots/cartesian"),categories:["cartesian","svg","carpet","contour","symbols","showLegend","hasLines","carpetDependent","noHover","noSortingByValue"],meta:{}}},{"../../plots/cartesian":841,"../contour/colorbar":1011,"../contour/style":1028,"./attributes":1030,"./calc":1031,"./defaults":1032,"./plot":1034}],1034:[function(n,z,q){"use strict";var t=n("d3"),h=n("../carpet/map_1d_array"),p=n("../carpet/makepath"),l=n("../../components/drawing"),e=n("../../lib"),o=n("../contour/make_crossings"),r=n("../contour/find_all_paths"),i=n("../contour/plot"),u=n("../contour/constants"),s=n("../contour/convert_to_constraints"),a=n("../contour/empty_pathinfo"),c=n("../contour/close_boundaries"),f=n("../carpet/lookup_carpetid"),g=n("../carpet/axis_aligned_line");function d(v,T,w){var A=v.getPointAtLength(T),E=v.getPointAtLength(w),M=E.x-A.x,b=E.y-A.y,_=Math.sqrt(M*M+b*b);return[M/_,b/_]}function m(v){var T=Math.sqrt(v[0]*v[0]+v[1]*v[1]);return[v[0]/T,v[1]/T]}function y(v,T){var w=Math.abs(v[0]*T[0]+v[1]*T[1]);return Math.sqrt(1-w*w)/w}z.exports=function(v,T,w,A){var E=T.xaxis,M=T.yaxis;e.makeTraceGroups(A,w,"contour").each(function(b){var _=t.select(this),S=b[0],C=S.trace,k=C._carpetTrace=f(v,C),L=v.calcdata[k.index][0];if(k.visible&&k.visible!=="legendonly"){var I=S.a,R=S.b,V=C.contours,O=a(V,T,S),J=V.type==="constraint",D=V._operation,B=J?D==="="?"lines":"fill":V.coloring,N=[[I[0],R[R.length-1]],[I[I.length-1],R[R.length-1]],[I[I.length-1],R[0]],[I[0],R[0]]];o(O);var F=1e-8*(I[I.length-1]-I[0]),H=1e-8*(R[R.length-1]-R[0]);r(O,F,H);var j,G,W,Q,$=O;V.type==="constraint"&&($=s(O,D)),function(oe,de){var le,fe,ue,we,Ae,Se,ke,Me,ve;for(le=0;le<oe.length;le++){for(we=oe[le],Ae=we.pedgepaths=[],Se=we.ppaths=[],fe=0;fe<we.edgepaths.length;fe++){for(ve=we.edgepaths[fe],ke=[],ue=0;ue<ve.length;ue++)ke[ue]=de(ve[ue]);Ae.push(ke)}for(fe=0;fe<we.paths.length;fe++){for(ve=we.paths[fe],Me=[],ue=0;ue<ve.length;ue++)Me[ue]=de(ve[ue]);Se.push(Me)}}}(O,ae);var ee=[];for(Q=L.clipsegments.length-1;Q>=0;Q--)j=L.clipsegments[Q],G=h([],j.x,E.c2p),W=h([],j.y,M.c2p),G.reverse(),W.reverse(),ee.push(p(G,W,j.bicubic));var ie="M"+ee.join("L")+"Z";(function(oe,de,le,fe,ue,we){var Ae,Se,ke,Me,ve=e.ensureSingle(oe,"g","contourbg").selectAll("path").data(we!=="fill"||ue?[]:[0]);ve.enter().append("path"),ve.exit().remove();var ge=[];for(Me=0;Me<de.length;Me++)Ae=de[Me],Se=h([],Ae.x,le.c2p),ke=h([],Ae.y,fe.c2p),ge.push(p(Se,ke,Ae.bicubic));ve.attr("d","M"+ge.join("L")+"Z").style("stroke","none")})(_,L.clipsegments,E,M,J,B),function(oe,de,le,fe,ue,we,Ae,Se,ke,Me,ve){var ge=Me==="fill";ge&&c(ue,oe.contours);var De=e.ensureSingle(de,"g","contourfill").selectAll("path").data(ge?ue:[]);De.enter().append("path"),De.exit().remove(),De.each(function(_e){var Pe=(_e.prefixBoundary?ve:"")+function(Fe,ze,He,et,Re,Ze,Ke,$e){var rt,at,lt,gt,Ie,be,We,Ge="",st=ze.edgepaths.map(function(mt,bt){return bt}),ot=!0,Ce=1e-4*Math.abs(He[0][0]-He[2][0]),Ue=1e-4*Math.abs(He[0][1]-He[2][1]);function Ye(mt){return Math.abs(mt[1]-He[0][1])<Ue}function xe(mt){return Math.abs(mt[1]-He[2][1])<Ue}function Ee(mt){return Math.abs(mt[0]-He[0][0])<Ce}function Je(mt){return Math.abs(mt[0]-He[2][0])<Ce}function it(mt,bt){var Et,Mt,_t,xt,At="";for(Ye(mt)&&!Je(mt)||xe(mt)&&!Ee(mt)?(xt=Re.aaxis,_t=g(Re,Ze,[mt[0],bt[0]],.5*(mt[1]+bt[1]))):(xt=Re.baxis,_t=g(Re,Ze,.5*(mt[0]+bt[0]),[mt[1],bt[1]])),Et=1;Et<_t.length;Et++)for(At+=xt.smoothing?"C":"L",Mt=0;Mt<_t[Et].length;Mt++){var It=_t[Et][Mt];At+=[Ke.c2p(It[0]),$e.c2p(It[1])]+" "}return At}for(rt=0,at=null;st.length;){var ht=ze.edgepaths[rt][0];for(at&&(Ge+=it(at,ht)),We=l.smoothopen(ze.edgepaths[rt].map(et),ze.smoothing),Ge+=ot?We:We.replace(/^M/,"L"),st.splice(st.indexOf(rt),1),at=ze.edgepaths[rt][ze.edgepaths[rt].length-1],Ie=-1,gt=0;gt<4;gt++){if(!at){e.log("Missing end?",rt,ze);break}for(Ye(at)&&!Je(at)?lt=He[1]:Ee(at)?lt=He[0]:xe(at)?lt=He[3]:Je(at)&&(lt=He[2]),be=0;be<ze.edgepaths.length;be++){var ct=ze.edgepaths[be][0];Math.abs(at[0]-lt[0])<Ce?Math.abs(at[0]-ct[0])<Ce&&(ct[1]-at[1])*(lt[1]-ct[1])>=0&&(lt=ct,Ie=be):Math.abs(at[1]-lt[1])<Ue?Math.abs(at[1]-ct[1])<Ue&&(ct[0]-at[0])*(lt[0]-ct[0])>=0&&(lt=ct,Ie=be):e.log("endpt to newendpt is not vert. or horz.",at,lt,ct)}if(Ie>=0)break;Ge+=it(at,lt),at=lt}if(Ie===ze.edgepaths.length){e.log("unclosed perimeter path");break}rt=Ie,(ot=st.indexOf(rt)===-1)&&(rt=st[0],Ge+=it(at,lt)+"Z",at=null)}for(rt=0;rt<ze.paths.length;rt++)Ge+=l.smoothclosed(ze.paths[rt].map(et),ze.smoothing);return Ge}(0,_e,we,Ae,Se,ke,le,fe);Pe?t.select(this).attr("d",Pe).style("stroke","none"):t.select(this).remove()})}(C,_,E,M,$,N,ae,k,L,B,ie),function(oe,de,le,fe,ue,we,Ae){var Se=e.ensureSingle(oe,"g","contourlines"),ke=ue.showlines!==!1,Me=ue.showlabels,ve=ke&&Me,ge=i.createLines(Se,ke||Me,de),De=i.createLineClip(Se,ve,le,fe.trace.uid),_e=oe.selectAll("g.contourlabels").data(Me?[0]:[]);if(_e.exit().remove(),_e.enter().append("g").classed("contourlabels",!0),Me){var Pe=we.xaxis,Fe=we.yaxis,ze=Pe._length,He=Fe._length,et=[[[0,0],[ze,0],[ze,He],[0,He]]],Re=[];e.clearLocationCache();var Ze=i.labelFormatter(le,fe),Ke=l.tester.append("text").attr("data-notex",1).call(l.font,ue.labelfont),$e={left:0,right:ze,center:ze/2,top:0,bottom:He,middle:He/2},rt=Math.sqrt(ze*ze+He*He),at=u.LABELDISTANCE*rt/Math.max(1,de.length/u.LABELINCREASE);ge.each(function(lt){var gt=i.calcTextOpts(lt.level,Ze,Ke,le);t.select(this).selectAll("path").each(function(Ie){var be=e.getVisibleSegment(this,$e,gt.height/2);if(be&&(function(ot,Ce,Ue,Ye,xe,Ee){for(var Je,it=0;it<Ue.pedgepaths.length;it++)Ce===Ue.pedgepaths[it]&&(Je=Ue.edgepaths[it]);if(!Je)return;var ht=xe.a[0],ct=xe.a[xe.a.length-1],mt=xe.b[0],bt=xe.b[xe.b.length-1];function Et(It,Nt){var Ot,Yt=0;return(Math.abs(It[0]-ht)<.1||Math.abs(It[0]-ct)<.1)&&(Ot=m(xe.dxydb_rough(It[0],It[1],.1)),Yt=Math.max(Yt,Ee*y(Nt,Ot)/2)),(Math.abs(It[1]-mt)<.1||Math.abs(It[1]-bt)<.1)&&(Ot=m(xe.dxyda_rough(It[0],It[1],.1)),Yt=Math.max(Yt,Ee*y(Nt,Ot)/2)),Yt}var Mt=d(ot,0,1),_t=d(ot,Ye.total,Ye.total-1),xt=Et(Je[0],Mt),At=Ye.total-Et(Je[Je.length-1],_t);Ye.min<xt&&(Ye.min=xt),Ye.max>At&&(Ye.max=At),Ye.len=Ye.max-Ye.min}(this,Ie,lt,be,Ae,gt.height),!(be.len<(gt.width+gt.height)*u.LABELMIN)))for(var We=Math.min(Math.ceil(be.len/at),u.LABELMAX),Ge=0;Ge<We;Ge++){var st=i.findBestTextLocation(this,be,gt,Re,$e);if(!st)break;i.addLabelData(st,gt,Re,et)}})}),Ke.remove(),i.drawLabels(_e,Re,le,De,ve?et:null)}Me&&!ke&&ge.remove()}(_,O,v,S,V,T,k),l.setClipUrl(_,k._clipPathId,v)}function ae(oe){var de=k.ab2xy(oe[0],oe[1],!0);return[E.c2p(de[0]),M.c2p(de[1])]}})}},{"../../components/drawing":665,"../../lib":778,"../carpet/axis_aligned_line":965,"../carpet/lookup_carpetid":981,"../carpet/makepath":982,"../carpet/map_1d_array":983,"../contour/close_boundaries":1010,"../contour/constants":1012,"../contour/convert_to_constraints":1016,"../contour/empty_pathinfo":1018,"../contour/find_all_paths":1020,"../contour/make_crossings":1025,"../contour/plot":1026,d3:169}],1035:[function(n,z,q){"use strict";var t=n("../../components/colorscale/attributes"),h=n("../../plots/template_attributes").hovertemplateAttrs,p=n("../../plots/attributes"),l=n("../scattermapbox/attributes"),e=n("../../lib/extend").extendFlat;z.exports=e({lon:l.lon,lat:l.lat,z:{valType:"data_array",editType:"calc"},radius:{valType:"number",editType:"plot",arrayOk:!0,min:1,dflt:30},below:{valType:"string",editType:"plot"},text:l.text,hovertext:l.hovertext,hoverinfo:e({},p.hoverinfo,{flags:["lon","lat","z","text","name"]}),hovertemplate:h(),showlegend:e({},p.showlegend,{dflt:!1})},t("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":650,"../../lib/extend":768,"../../plots/attributes":824,"../../plots/template_attributes":906,"../scattermapbox/attributes":1252}],1036:[function(n,z,q){"use strict";var t=n("fast-isnumeric"),h=n("../../lib").isArrayOrTypedArray,p=n("../../constants/numerical").BADNUM,l=n("../../components/colorscale/calc"),e=n("../../lib")._;z.exports=function(o,r){for(var i=r._length,u=new Array(i),s=r.z,a=h(s)&&s.length,c=0;c<i;c++){var f=u[c]={},g=r.lon[c],d=r.lat[c];if(f.lonlat=t(g)&&t(d)?[+g,+d]:[p,p],a){var m=s[c];f.z=t(m)?m:p}}return l(o,r,{vals:a?s:[0,1],containerStr:"",cLetter:"z"}),i&&(u[0].t={labels:{lat:e(o,"lat:")+" ",lon:e(o,"lon:")+" "}}),u}},{"../../components/colorscale/calc":651,"../../constants/numerical":753,"../../lib":778,"fast-isnumeric":241}],1037:[function(n,z,q){"use strict";var t=n("fast-isnumeric"),h=n("../../lib"),p=n("../../components/color"),l=n("../../components/colorscale"),e=n("../../constants/numerical").BADNUM,o=n("../../lib/geojson_utils").makeBlank;z.exports=function(r){var i=r[0].trace,u=i.visible===!0&&i._length!==0,s=i._opts={heatmap:{layout:{visibility:"none"},paint:{}},geojson:o()};if(!u)return s;var a,c=[],f=i.z,g=i.radius,d=h.isArrayOrTypedArray(f)&&f.length,m=h.isArrayOrTypedArray(g);for(a=0;a<r.length;a++){var y=r[a],v=y.lonlat;if(v[0]!==e){var T={};if(d){var w=y.z;T.z=w!==e?w:0}m&&(T.r=t(g[a])&&g[a]>0?+g[a]:0),c.push({type:"Feature",geometry:{type:"Point",coordinates:v},properties:T})}}var A=l.extractOpts(i),E=A.reversescale?l.flipScale(A.colorscale):A.colorscale,M=E[0][1],b=["interpolate",["linear"],["heatmap-density"],0,p.opacity(M)<1?M:p.addOpacity(M,0)];for(a=1;a<E.length;a++)b.push(E[a][0],E[a][1]);var _=["interpolate",["linear"],["get","z"],A.min,0,A.max,1];return h.extendFlat(s.heatmap.paint,{"heatmap-weight":d?_:1/(A.max-A.min),"heatmap-color":b,"heatmap-radius":m?{type:"identity",property:"r"}:i.radius,"heatmap-opacity":i.opacity}),s.geojson={type:"FeatureCollection",features:c},s.heatmap.layout.visibility="visible",s}},{"../../components/color":643,"../../components/colorscale":655,"../../constants/numerical":753,"../../lib":778,"../../lib/geojson_utils":772,"fast-isnumeric":241}],1038:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../../components/colorscale/defaults"),p=n("./attributes");z.exports=function(l,e,o,r){function i(c,f){return t.coerce(l,e,p,c,f)}var u=i("lon")||[],s=i("lat")||[],a=Math.min(u.length,s.length);a?(e._length=a,i("z"),i("radius"),i("below"),i("text"),i("hovertext"),i("hovertemplate"),h(l,e,r,i,{prefix:"",cLetter:"z"})):e.visible=!1}},{"../../components/colorscale/defaults":653,"../../lib":778,"./attributes":1035}],1039:[function(n,z,q){"use strict";z.exports=function(t,h){return t.lon=h.lon,t.lat=h.lat,t.z=h.z,t}},{}],1040:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../../plots/cartesian/axes"),p=n("../scattermapbox/hover");z.exports=function(l,e,o){var r=p(l,e,o);if(r){var i=r[0],u=i.cd,s=u[0].trace,a=u[i.index];if(delete i.color,"z"in a){var c=i.subplot.mockAxis;i.z=a.z,i.zLabel=h.tickText(c,c.c2l(a.z),"hover").text}return i.extraText=function(f,g,d){if(f.hovertemplate)return;var m=(g.hi||f.hoverinfo).split("+"),y=m.indexOf("all")!==-1,v=m.indexOf("lon")!==-1,T=m.indexOf("lat")!==-1,w=g.lonlat,A=[];function E(M){return M+"\xB0"}return y||v&&T?A.push("("+E(w[0])+", "+E(w[1])+")"):v?A.push(d.lon+E(w[0])):T&&A.push(d.lat+E(w[1])),(y||m.indexOf("text")!==-1)&&t.fillText(g,f,A),A.join("<br>")}(s,a,u[0].t.labels),[i]}}},{"../../lib":778,"../../plots/cartesian/axes":828,"../scattermapbox/hover":1257}],1041:[function(n,z,q){"use strict";z.exports={attributes:n("./attributes"),supplyDefaults:n("./defaults"),colorbar:n("../heatmap/colorbar"),formatLabels:n("../scattermapbox/format_labels"),calc:n("./calc"),plot:n("./plot"),hoverPoints:n("./hover"),eventData:n("./event_data"),getBelow:function(t,h){for(var p=h.getMapLayers(),l=0;l<p.length;l++){var e=p[l],o=e.id;if(e.type==="symbol"&&typeof o=="string"&&o.indexOf("plotly-")===-1)return o}},moduleType:"trace",name:"densitymapbox",basePlotModule:n("../../plots/mapbox"),categories:["mapbox","gl","showLegend"],meta:{hr_name:"density_mapbox"}}},{"../../plots/mapbox":885,"../heatmap/colorbar":1068,"../scattermapbox/format_labels":1256,"./attributes":1035,"./calc":1036,"./defaults":1038,"./event_data":1039,"./hover":1040,"./plot":1042}],1042:[function(n,z,q){"use strict";var t=n("./convert"),h=n("../../plots/mapbox/constants").traceLayerPrefix;function p(e,o){this.type="densitymapbox",this.subplot=e,this.uid=o,this.sourceId="source-"+o,this.layerList=[["heatmap",h+o+"-heatmap"]],this.below=null}var l=p.prototype;l.update=function(e){var o=this.subplot,r=this.layerList,i=t(e),u=o.belowLookup["trace-"+this.uid];o.map.getSource(this.sourceId).setData(i.geojson),u!==this.below&&(this._removeLayers(),this._addLayers(i,u),this.below=u);for(var s=0;s<r.length;s++){var a=r[s],c=a[0],f=a[1],g=i[c];o.setOptions(f,"setLayoutProperty",g.layout),g.layout.visibility==="visible"&&o.setOptions(f,"setPaintProperty",g.paint)}},l._addLayers=function(e,o){for(var r=this.subplot,i=this.layerList,u=this.sourceId,s=0;s<i.length;s++){var a=i[s],c=a[0],f=e[c];r.addLayer({type:c,id:a[1],source:u,layout:f.layout,paint:f.paint},o)}},l._removeLayers=function(){for(var e=this.subplot.map,o=this.layerList,r=o.length-1;r>=0;r--)e.removeLayer(o[r][1])},l.dispose=function(){var e=this.subplot.map;this._removeLayers(),e.removeSource(this.sourceId)},z.exports=function(e,o){var r=o[0].trace,i=new p(e,r.uid),u=i.sourceId,s=t(o),a=i.below=e.belowLookup["trace-"+r.uid];return e.map.addSource(u,{type:"geojson",data:s.geojson}),i._addLayers(s,a),i}},{"../../plots/mapbox/constants":883,"./convert":1037}],1043:[function(n,z,q){"use strict";var t=n("../../lib");z.exports=function(h,p){for(var l=0;l<h.length;l++)h[l].i=l;t.mergeArray(p.text,h,"tx"),t.mergeArray(p.hovertext,h,"htx");var e=p.marker;if(e){t.mergeArray(e.opacity,h,"mo"),t.mergeArray(e.color,h,"mc");var o=e.line;o&&(t.mergeArray(o.color,h,"mlc"),t.mergeArrayCastPositive(o.width,h,"mlw"))}}},{"../../lib":778}],1044:[function(n,z,q){"use strict";var t=n("../bar/attributes"),h=n("../scatter/attributes").line,p=n("../../plots/attributes"),l=n("../../plots/template_attributes").hovertemplateAttrs,e=n("../../plots/template_attributes").texttemplateAttrs,o=n("./constants"),r=n("../../lib/extend").extendFlat,i=n("../../components/color");z.exports={x:t.x,x0:t.x0,dx:t.dx,y:t.y,y0:t.y0,dy:t.dy,xperiod:t.xperiod,yperiod:t.yperiod,xperiod0:t.xperiod0,yperiod0:t.yperiod0,xperiodalignment:t.xperiodalignment,yperiodalignment:t.yperiodalignment,hovertext:t.hovertext,hovertemplate:l({},{keys:o.eventDataKeys}),hoverinfo:r({},p.hoverinfo,{flags:["name","x","y","text","percent initial","percent previous","percent total"]}),textinfo:{valType:"flaglist",flags:["label","text","percent initial","percent previous","percent total","value"],extras:["none"],editType:"plot",arrayOk:!1},texttemplate:e({editType:"plot"},{keys:o.eventDataKeys.concat(["label","value"])}),text:t.text,textposition:r({},t.textposition,{dflt:"auto"}),insidetextanchor:r({},t.insidetextanchor,{dflt:"middle"}),textangle:r({},t.textangle,{dflt:0}),textfont:t.textfont,insidetextfont:t.insidetextfont,outsidetextfont:t.outsidetextfont,constraintext:t.constraintext,cliponaxis:t.cliponaxis,orientation:r({},t.orientation,{}),offset:r({},t.offset,{arrayOk:!1}),width:r({},t.width,{arrayOk:!1}),marker:t.marker,connector:{fillcolor:{valType:"color",editType:"style"},line:{color:r({},h.color,{dflt:i.defaultLine}),width:r({},h.width,{dflt:0,editType:"plot"}),dash:h.dash,editType:"style"},visible:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},offsetgroup:t.offsetgroup,alignmentgroup:t.alignmentgroup}},{"../../components/color":643,"../../lib/extend":768,"../../plots/attributes":824,"../../plots/template_attributes":906,"../bar/attributes":921,"../scatter/attributes":1187,"./constants":1046}],1045:[function(n,z,q){"use strict";var t=n("../../plots/cartesian/axes"),h=n("../../plots/cartesian/align_period"),p=n("./arrays_to_calcdata"),l=n("../scatter/calc_selection"),e=n("../../constants/numerical").BADNUM;function o(r){return r===e?0:r}z.exports=function(r,i){var u,s,a,c,f,g,d=t.getFromId(r,i.xaxis||"x"),m=t.getFromId(r,i.yaxis||"y");i.orientation==="h"?(u=d.makeCalcdata(i,"x"),a=m.makeCalcdata(i,"y"),s=h(i,m,"y",a),g=!!i.yperiodalignment):(u=m.makeCalcdata(i,"y"),a=d.makeCalcdata(i,"x"),s=h(i,d,"x",a),g=!!i.xperiodalignment);var y,v=Math.min(s.length,u.length),T=new Array(v);for(i._base=[],c=0;c<v;c++){u[c]<0&&(u[c]=e);var w=!1;u[c]!==e&&c+1<v&&u[c+1]!==e&&(w=!0),f=T[c]={p:s[c],s:u[c],cNext:w},i._base[c]=-.5*f.s,g&&(T[c].orig_p=a[c]),i.ids&&(f.id=String(i.ids[c])),c===0&&(T[0].vTotal=0),T[0].vTotal+=o(f.s),f.begR=o(f.s)/o(T[0].s)}for(c=0;c<v;c++)(f=T[c]).s!==e&&(f.sumR=f.s/T[0].vTotal,f.difR=y!==void 0?f.s/y:1,y=f.s);return p(T,i),l(T,i),T}},{"../../constants/numerical":753,"../../plots/cartesian/align_period":825,"../../plots/cartesian/axes":828,"../scatter/calc_selection":1189,"./arrays_to_calcdata":1043}],1046:[function(n,z,q){"use strict";z.exports={eventDataKeys:["percentInitial","percentPrevious","percentTotal"]}},{}],1047:[function(n,z,q){"use strict";var t=n("../bar/cross_trace_calc").setGroupPositions;z.exports=function(h,p){var l,e,o=h._fullLayout,r=h._fullData,i=h.calcdata,u=p.xaxis,s=p.yaxis,a=[],c=[],f=[];for(e=0;e<r.length;e++){var g=r[e],d=g.orientation==="h";g.visible===!0&&g.xaxis===u._id&&g.yaxis===s._id&&g.type==="funnel"&&(l=i[e],d?f.push(l):c.push(l),a.push(l))}var m={mode:o.funnelmode,norm:o.funnelnorm,gap:o.funnelgap,groupgap:o.funnelgroupgap};for(t(h,u,s,c,m),t(h,s,u,f,m),e=0;e<a.length;e++){l=a[e];for(var y=0;y<l.length;y++)y+1<l.length&&(l[y].nextP0=l[y+1].p0,l[y].nextS0=l[y+1].s0,l[y].nextP1=l[y+1].p1,l[y].nextS1=l[y+1].s1)}}},{"../bar/cross_trace_calc":924}],1048:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../bar/defaults").handleGroupingDefaults,p=n("../bar/defaults").handleText,l=n("../scatter/xy_defaults"),e=n("../scatter/period_defaults"),o=n("./attributes"),r=n("../../components/color");z.exports={supplyDefaults:function(i,u,s,a){function c(m,y){return t.coerce(i,u,o,m,y)}if(l(i,u,a,c)){e(i,u,a,c),c("orientation",u.y&&!u.x?"v":"h"),c("offset"),c("width");var f=c("text");c("hovertext"),c("hovertemplate");var g=c("textposition");p(i,u,a,c,g,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),u.textposition==="none"||u.texttemplate||c("textinfo",Array.isArray(f)?"text+value":"value");var d=c("marker.color",s);c("marker.line.color",r.defaultLine),c("marker.line.width"),c("connector.visible")&&(c("connector.fillcolor",function(m){var y=t.isArrayOrTypedArray(m)?"#000":m;return r.addOpacity(y,.5*r.opacity(y))}(d)),c("connector.line.width")&&(c("connector.line.color"),c("connector.line.dash")))}else u.visible=!1},crossTraceDefaults:function(i,u){var s,a;function c(g){return t.coerce(a._input,a,o,g)}if(u.funnelmode==="group")for(var f=0;f<i.length;f++)s=(a=i[f])._input,h(s,a,u,c)}}},{"../../components/color":643,"../../lib":778,"../bar/defaults":925,"../scatter/period_defaults":1207,"../scatter/xy_defaults":1214,"./attributes":1044}],1049:[function(n,z,q){"use strict";z.exports=function(t,h){return t.x="xVal"in h?h.xVal:h.x,t.y="yVal"in h?h.yVal:h.y,"percentInitial"in h&&(t.percentInitial=h.percentInitial),"percentPrevious"in h&&(t.percentPrevious=h.percentPrevious),"percentTotal"in h&&(t.percentTotal=h.percentTotal),h.xa&&(t.xaxis=h.xa),h.ya&&(t.yaxis=h.ya),t}},{}],1050:[function(n,z,q){"use strict";var t=n("../../components/color").opacity,h=n("../bar/hover").hoverOnBars,p=n("../../lib").formatPercent;z.exports=function(l,e,o,r){var i=h(l,e,o,r);if(i){var u=i.cd,s=u[0].trace,a=s.orientation==="h",c=u[i.index];i[(a?"x":"y")+"LabelVal"]=c.s,i.percentInitial=c.begR,i.percentInitialLabel=p(c.begR,1),i.percentPrevious=c.difR,i.percentPreviousLabel=p(c.difR,1),i.percentTotal=c.sumR,i.percentTotalLabel=p(c.sumR,1);var f=c.hi||s.hoverinfo,g=[];if(f&&f!=="none"&&f!=="skip"){var d=f==="all",m=f.split("+"),y=function(v){return d||m.indexOf(v)!==-1};y("percent initial")&&g.push(i.percentInitialLabel+" of initial"),y("percent previous")&&g.push(i.percentPreviousLabel+" of previous"),y("percent total")&&g.push(i.percentTotalLabel+" of total")}return i.extraText=g.join("<br>"),i.color=function(v,T){var w=v.marker,A=T.mc||w.color,E=T.mlc||w.line.color,M=T.mlw||w.line.width;if(t(A))return A;if(t(E)&&M)return E}(s,c),[i]}}},{"../../components/color":643,"../../lib":778,"../bar/hover":928}],1051:[function(n,z,q){"use strict";z.exports={attributes:n("./attributes"),layoutAttributes:n("./layout_attributes"),supplyDefaults:n("./defaults").supplyDefaults,crossTraceDefaults:n("./defaults").crossTraceDefaults,supplyLayoutDefaults:n("./layout_defaults"),calc:n("./calc"),crossTraceCalc:n("./cross_trace_calc"),plot:n("./plot"),style:n("./style").style,hoverPoints:n("./hover"),eventData:n("./event_data"),selectPoints:n("../bar/select"),moduleType:"trace",name:"funnel",basePlotModule:n("../../plots/cartesian"),categories:["bar-like","cartesian","svg","oriented","showLegend","zoomScale"],meta:{}}},{"../../plots/cartesian":841,"../bar/select":933,"./attributes":1044,"./calc":1045,"./cross_trace_calc":1047,"./defaults":1048,"./event_data":1049,"./hover":1050,"./layout_attributes":1052,"./layout_defaults":1053,"./plot":1054,"./style":1055}],1052:[function(n,z,q){"use strict";z.exports={funnelmode:{valType:"enumerated",values:["stack","group","overlay"],dflt:"stack",editType:"calc"},funnelgap:{valType:"number",min:0,max:1,editType:"calc"},funnelgroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],1053:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("./layout_attributes");z.exports=function(p,l,e){var o=!1;function r(s,a){return t.coerce(p,l,h,s,a)}for(var i=0;i<e.length;i++){var u=e[i];if(u.visible&&u.type==="funnel"){o=!0;break}}o&&(r("funnelmode"),r("funnelgap",.2),r("funnelgroupgap"))}},{"../../lib":778,"./layout_attributes":1052}],1054:[function(n,z,q){"use strict";var t=n("d3"),h=n("../../lib"),p=n("../../components/drawing"),l=n("../../constants/numerical").BADNUM,e=n("../bar/plot"),o=n("../bar/uniform_text").clearMinTextSize;function r(i,u,s,a){var c=[],f=[],g=a?u:s,d=a?s:u;return c[0]=g.c2p(i.s0,!0),f[0]=d.c2p(i.p0,!0),c[1]=g.c2p(i.s1,!0),f[1]=d.c2p(i.p1,!0),c[2]=g.c2p(i.nextS0,!0),f[2]=d.c2p(i.nextP0,!0),c[3]=g.c2p(i.nextS1,!0),f[3]=d.c2p(i.nextP1,!0),a?[c,f]:[f,c]}z.exports=function(i,u,s,a){var c=i._fullLayout;o("funnel",c),function(f,g,d,m){var y=g.xaxis,v=g.yaxis;h.makeTraceGroups(m,d,"trace bars").each(function(T){var w=t.select(this),A=T[0].trace,E=h.ensureSingle(w,"g","regions");if(A.connector&&A.connector.visible){var M=A.orientation==="h",b=E.selectAll("g.region").data(h.identity);b.enter().append("g").classed("region",!0),b.exit().remove();var _=b.size();b.each(function(S,C){if(C===_-1||S.cNext){var k=r(S,y,v,M),L=k[0],I=k[1],R="";L[0]!==l&&I[0]!==l&&L[1]!==l&&I[1]!==l&&L[2]!==l&&I[2]!==l&&L[3]!==l&&I[3]!==l&&(R+=M?"M"+L[0]+","+I[1]+"L"+L[2]+","+I[2]+"H"+L[3]+"L"+L[1]+","+I[1]+"Z":"M"+L[1]+","+I[1]+"L"+L[2]+","+I[3]+"V"+I[2]+"L"+L[1]+","+I[0]+"Z"),R===""&&(R="M0,0Z"),h.ensureSingle(t.select(this),"path").attr("d",R).call(p.setClipUrl,g.layerClipId,f)}})}else E.remove()})}(i,u,s,a),function(f,g,d,m){var y=g.xaxis,v=g.yaxis;h.makeTraceGroups(m,d,"trace bars").each(function(T){var w=t.select(this),A=T[0].trace,E=h.ensureSingle(w,"g","lines");if(A.connector&&A.connector.visible&&A.connector.line.width){var M=A.orientation==="h",b=E.selectAll("g.line").data(h.identity);b.enter().append("g").classed("line",!0),b.exit().remove();var _=b.size();b.each(function(S,C){if(C===_-1||S.cNext){var k=r(S,y,v,M),L=k[0],I=k[1],R="";L[3]!==void 0&&I[3]!==void 0&&(M?(R+="M"+L[0]+","+I[1]+"L"+L[2]+","+I[2],R+="M"+L[1]+","+I[1]+"L"+L[3]+","+I[2]):(R+="M"+L[1]+","+I[1]+"L"+L[2]+","+I[3],R+="M"+L[1]+","+I[0]+"L"+L[2]+","+I[2])),R===""&&(R="M0,0Z"),h.ensureSingle(t.select(this),"path").attr("d",R).call(p.setClipUrl,g.layerClipId,f)}})}else E.remove()})}(i,u,s,a),e.plot(i,u,s,a,{mode:c.funnelmode,norm:c.funnelmode,gap:c.funnelgap,groupgap:c.funnelgroupgap})}},{"../../components/drawing":665,"../../constants/numerical":753,"../../lib":778,"../bar/plot":932,"../bar/uniform_text":937,d3:169}],1055:[function(n,z,q){"use strict";var t=n("d3"),h=n("../../components/drawing"),p=n("../../components/color"),l=n("../../constants/interactions").DESELECTDIM,e=n("../bar/style"),o=n("../bar/uniform_text").resizeText,r=e.styleTextPoints;z.exports={style:function(i,u,s){var a=s||t.select(i).selectAll("g.funnellayer").selectAll("g.trace");o(i,a,"funnel"),a.style("opacity",function(c){return c[0].trace.opacity}),a.each(function(c){var f=t.select(this),g=c[0].trace;f.selectAll(".point > path").each(function(d){if(!d.isBlank){var m=g.marker;t.select(this).call(p.fill,d.mc||m.color).call(p.stroke,d.mlc||m.line.color).call(h.dashLine,m.line.dash,d.mlw||m.line.width).style("opacity",g.selectedpoints&&!d.selected?l:1)}}),r(f,g,i),f.selectAll(".regions").each(function(){t.select(this).selectAll("path").style("stroke-width",0).call(p.fill,g.connector.fillcolor)}),f.selectAll(".lines").each(function(){var d=g.connector.line;h.lineGroupStyle(t.select(this).selectAll("path"),d.width,d.color,d.dash)})})}}},{"../../components/color":643,"../../components/drawing":665,"../../constants/interactions":752,"../bar/style":935,"../bar/uniform_text":937,d3:169}],1056:[function(n,z,q){"use strict";var t=n("../pie/attributes"),h=n("../../plots/attributes"),p=n("../../plots/domain").attributes,l=n("../../plots/template_attributes").hovertemplateAttrs,e=n("../../plots/template_attributes").texttemplateAttrs,o=n("../../lib/extend").extendFlat;z.exports={labels:t.labels,label0:t.label0,dlabel:t.dlabel,values:t.values,marker:{colors:t.marker.colors,line:{color:o({},t.marker.line.color,{dflt:null}),width:o({},t.marker.line.width,{dflt:1}),editType:"calc"},editType:"calc"},text:t.text,hovertext:t.hovertext,scalegroup:o({},t.scalegroup,{}),textinfo:o({},t.textinfo,{flags:["label","text","value","percent"]}),texttemplate:e({editType:"plot"},{keys:["label","color","value","text","percent"]}),hoverinfo:o({},h.hoverinfo,{flags:["label","text","value","percent","name"]}),hovertemplate:l({},{keys:["label","color","value","text","percent"]}),textposition:o({},t.textposition,{values:["inside","none"],dflt:"inside"}),textfont:t.textfont,insidetextfont:t.insidetextfont,title:{text:t.title.text,font:t.title.font,position:o({},t.title.position,{values:["top left","top center","top right"],dflt:"top center"}),editType:"plot"},domain:p({name:"funnelarea",trace:!0,editType:"calc"}),aspectratio:{valType:"number",min:0,dflt:1,editType:"plot"},baseratio:{valType:"number",min:0,max:1,dflt:.333,editType:"plot"}}},{"../../lib/extend":768,"../../plots/attributes":824,"../../plots/domain":855,"../../plots/template_attributes":906,"../pie/attributes":1161}],1057:[function(n,z,q){"use strict";var t=n("../../plots/plots");q.name="funnelarea",q.plot=function(h,p,l,e){t.plotBasePlot(q.name,h,p,l,e)},q.clean=function(h,p,l,e){t.cleanBasePlot(q.name,h,p,l,e)}},{"../../plots/plots":891}],1058:[function(n,z,q){"use strict";var t=n("../pie/calc");z.exports={calc:function(h,p){return t.calc(h,p)},crossTraceCalc:function(h){t.crossTraceCalc(h,{type:"funnelarea"})}}},{"../pie/calc":1163}],1059:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("./attributes"),p=n("../../plots/domain").defaults,l=n("../bar/defaults").handleText,e=n("../pie/defaults").handleLabelsAndValues;z.exports=function(o,r,i,u){function s(T,w){return t.coerce(o,r,h,T,w)}var a=s("labels"),c=s("values"),f=e(a,c),g=f.len;if(r._hasLabels=f.hasLabels,r._hasValues=f.hasValues,!r._hasLabels&&r._hasValues&&(s("label0"),s("dlabel")),g){r._length=g,s("marker.line.width")&&s("marker.line.color",u.paper_bgcolor),s("marker.colors"),s("scalegroup");var d,m=s("text"),y=s("texttemplate");if(y||(d=s("textinfo",Array.isArray(m)?"text+percent":"percent")),s("hovertext"),s("hovertemplate"),y||d&&d!=="none"){var v=s("textposition");l(o,r,u,s,v,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1})}p(r,u,s),s("title.text")&&(s("title.position"),t.coerceFont(s,"title.font",u.font)),s("aspectratio"),s("baseratio")}else r.visible=!1}},{"../../lib":778,"../../plots/domain":855,"../bar/defaults":925,"../pie/defaults":1164,"./attributes":1056}],1060:[function(n,z,q){"use strict";z.exports={moduleType:"trace",name:"funnelarea",basePlotModule:n("./base_plot"),categories:["pie-like","funnelarea","showLegend"],attributes:n("./attributes"),layoutAttributes:n("./layout_attributes"),supplyDefaults:n("./defaults"),supplyLayoutDefaults:n("./layout_defaults"),calc:n("./calc").calc,crossTraceCalc:n("./calc").crossTraceCalc,plot:n("./plot"),style:n("./style"),styleOne:n("../pie/style_one"),meta:{}}},{"../pie/style_one":1172,"./attributes":1056,"./base_plot":1057,"./calc":1058,"./defaults":1059,"./layout_attributes":1061,"./layout_defaults":1062,"./plot":1063,"./style":1064}],1061:[function(n,z,q){"use strict";var t=n("../pie/layout_attributes").hiddenlabels;z.exports={hiddenlabels:t,funnelareacolorway:{valType:"colorlist",editType:"calc"},extendfunnelareacolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{"../pie/layout_attributes":1168}],1062:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("./layout_attributes");z.exports=function(p,l){function e(o,r){return t.coerce(p,l,h,o,r)}e("hiddenlabels"),e("funnelareacolorway",l.colorway),e("extendfunnelareacolors")}},{"../../lib":778,"./layout_attributes":1061}],1063:[function(n,z,q){"use strict";var t=n("d3"),h=n("../../components/drawing"),p=n("../../lib"),l=p.strScale,e=p.strTranslate,o=n("../../lib/svg_text_utils"),r=n("../bar/plot").toMoveInsideBar,i=n("../bar/uniform_text"),u=i.recordMinTextSize,s=i.clearMinTextSize,a=n("../pie/helpers"),c=n("../pie/plot"),f=c.attachFxHandlers,g=c.determineInsideTextFont,d=c.layoutAreas,m=c.prerenderTitles,y=c.positionTitleOutside,v=c.formatSliceLabel;function T(w,A){return"l"+(A[0]-w[0])+","+(A[1]-w[1])}z.exports=function(w,A){var E=w._fullLayout;s("funnelarea",E),m(A,w),d(A,E._size),p.makeTraceGroups(E._funnelarealayer,A,"trace").each(function(M){var b=t.select(this),_=M[0],S=_.trace;(function(C){if(!C.length)return;var k=C[0],L=k.trace,I=L.aspectratio,R=L.baseratio;R>.999&&(R=.999);var V,O=Math.pow(R,2),J=k.vTotal,D=J,B=J*O/(1-O)/J;function N(){var ke,Me={x:ke=Math.sqrt(B),y:-ke};return[Me.x,Me.y]}var F,H,j=[];for(j.push(N()),F=C.length-1;F>-1;F--)if(!(H=C[F]).hidden){var G=H.v/D;B+=G,j.push(N())}var W=1/0,Q=-1/0;for(F=0;F<j.length;F++)V=j[F],W=Math.min(W,V[1]),Q=Math.max(Q,V[1]);for(F=0;F<j.length;F++)j[F][1]-=(Q+W)/2;var $=j[j.length-1][0],ee=k.r,ie=(Q-W)/2,ae=ee/$,oe=ee/ie*I;for(k.r=oe*ie,F=0;F<j.length;F++)j[F][0]*=ae,j[F][1]*=oe;var de=[-(V=j[0])[0],V[1]],le=[V[0],V[1]],fe=0;for(F=C.length-1;F>-1;F--)if(!(H=C[F]).hidden){var ue=j[fe+=1][0],we=j[fe][1];H.TL=[-ue,we],H.TR=[ue,we],H.BL=de,H.BR=le,H.pxmid=(Ae=H.TR,Se=H.BR,[.5*(Ae[0]+Se[0]),.5*(Ae[1]+Se[1])]),de=H.TL,le=H.TR}var Ae,Se})(M),b.each(function(){var C=t.select(this).selectAll("g.slice").data(M);C.enter().append("g").classed("slice",!0),C.exit().remove(),C.each(function(L,I){if(L.hidden)t.select(this).selectAll("path,g").remove();else{L.pointNumber=L.i,L.curveNumber=S.index;var R=_.cx,V=_.cy,O=t.select(this),J=O.selectAll("path.surface").data([L]);J.enter().append("path").classed("surface",!0).style({"pointer-events":"all"}),O.call(f,w,M);var D="M"+(R+L.TR[0])+","+(V+L.TR[1])+T(L.TR,L.BR)+T(L.BR,L.BL)+T(L.BL,L.TL)+"Z";J.attr("d",D),v(w,L,_);var B=a.castOption(S.textposition,L.pts),N=O.selectAll("g.slicetext").data(L.text&&B!=="none"?[0]:[]);N.enter().append("g").classed("slicetext",!0),N.exit().remove(),N.each(function(){var F=p.ensureSingle(t.select(this),"text","",function(ie){ie.attr("data-notex",1)}),H=p.ensureUniformFontSize(w,g(S,L,E.font));F.text(L.text).attr({class:"slicetext",transform:"","text-anchor":"middle"}).call(h.font,H).call(o.convertToTspans,w);var j,G,W,Q=h.bBox(F.node()),$=Math.min(L.BL[1],L.BR[1])+V,ee=Math.max(L.TL[1],L.TR[1])+V;G=Math.max(L.TL[0],L.BL[0])+R,W=Math.min(L.TR[0],L.BR[0])+R,(j=r(G,W,$,ee,Q,{isHorizontal:!0,constrained:!0,angle:0,anchor:"middle"})).fontSize=H.size,u(S.type,j,E),M[I].transform=j,F.attr("transform",p.getTextTransform(j))})}});var k=t.select(this).selectAll("g.titletext").data(S.title.text?[0]:[]);k.enter().append("g").classed("titletext",!0),k.exit().remove(),k.each(function(){var L=p.ensureSingle(t.select(this),"text","",function(V){V.attr("data-notex",1)}),I=S.title.text;S._meta&&(I=p.templateString(I,S._meta)),L.text(I).attr({class:"titletext",transform:"","text-anchor":"middle"}).call(h.font,S.title.font).call(o.convertToTspans,w);var R=y(_,E._size);L.attr("transform",e(R.x,R.y)+l(Math.min(1,R.scale))+e(R.tx,R.ty))})})})}},{"../../components/drawing":665,"../../lib":778,"../../lib/svg_text_utils":803,"../bar/plot":932,"../bar/uniform_text":937,"../pie/helpers":1166,"../pie/plot":1170,d3:169}],1064:[function(n,z,q){"use strict";var t=n("d3"),h=n("../pie/style_one"),p=n("../bar/uniform_text").resizeText;z.exports=function(l){var e=l._fullLayout._funnelarealayer.selectAll(".trace");p(l,e,"funnelarea"),e.each(function(o){var r=o[0].trace,i=t.select(this);i.style({opacity:r.opacity}),i.selectAll("path.surface").each(function(u){t.select(this).call(h,u,r)})})}},{"../bar/uniform_text":937,"../pie/style_one":1172,d3:169}],1065:[function(n,z,q){"use strict";var t=n("../scatter/attributes"),h=n("../../plots/attributes"),p=n("../../plots/template_attributes").hovertemplateAttrs,l=n("../../components/colorscale/attributes"),e=(n("../../constants/docs").FORMAT_LINK,n("../../lib/extend").extendFlat);z.exports=e({z:{valType:"data_array",editType:"calc"},x:e({},t.x,{impliedEdits:{xtype:"array"}}),x0:e({},t.x0,{impliedEdits:{xtype:"scaled"}}),dx:e({},t.dx,{impliedEdits:{xtype:"scaled"}}),y:e({},t.y,{impliedEdits:{ytype:"array"}}),y0:e({},t.y0,{impliedEdits:{ytype:"scaled"}}),dy:e({},t.dy,{impliedEdits:{ytype:"scaled"}}),xperiod:e({},t.xperiod,{impliedEdits:{xtype:"scaled"}}),yperiod:e({},t.yperiod,{impliedEdits:{ytype:"scaled"}}),xperiod0:e({},t.xperiod0,{impliedEdits:{xtype:"scaled"}}),yperiod0:e({},t.yperiod0,{impliedEdits:{ytype:"scaled"}}),xperiodalignment:e({},t.xperiodalignment,{impliedEdits:{xtype:"scaled"}}),yperiodalignment:e({},t.yperiodalignment,{impliedEdits:{ytype:"scaled"}}),text:{valType:"data_array",editType:"calc"},hovertext:{valType:"data_array",editType:"calc"},transpose:{valType:"boolean",dflt:!1,editType:"calc"},xtype:{valType:"enumerated",values:["array","scaled"],editType:"calc+clearAxisTypes"},ytype:{valType:"enumerated",values:["array","scaled"],editType:"calc+clearAxisTypes"},zsmooth:{valType:"enumerated",values:["fast","best",!1],dflt:!1,editType:"calc"},hoverongaps:{valType:"boolean",dflt:!0,editType:"none"},connectgaps:{valType:"boolean",editType:"calc"},xgap:{valType:"number",dflt:0,min:0,editType:"plot"},ygap:{valType:"number",dflt:0,min:0,editType:"plot"},zhoverformat:{valType:"string",dflt:"",editType:"none"},hovertemplate:p(),showlegend:e({},h.showlegend,{dflt:!1})},{transforms:void 0},l("",{cLetter:"z",autoColorDflt:!1}))},{"../../components/colorscale/attributes":650,"../../constants/docs":748,"../../lib/extend":768,"../../plots/attributes":824,"../../plots/template_attributes":906,"../scatter/attributes":1187}],1066:[function(n,z,q){"use strict";var t=n("../../registry"),h=n("../../lib"),p=n("../../plots/cartesian/axes"),l=n("../../plots/cartesian/align_period"),e=n("../histogram2d/calc"),o=n("../../components/colorscale/calc"),r=n("./convert_column_xyz"),i=n("./clean_2d_array"),u=n("./interp2d"),s=n("./find_empties"),a=n("./make_bound_array"),c=n("../../constants/numerical").BADNUM;function f(g){for(var d=[],m=g.length,y=0;y<m;y++){var v=g[y];v!==c&&d.push(v)}return d}z.exports=function(g,d){var m,y,v,T,w,A,E,M,b,_,S,C=p.getFromId(g,d.xaxis||"x"),k=p.getFromId(g,d.yaxis||"y"),L=t.traceIs(d,"contour"),I=t.traceIs(d,"histogram"),R=t.traceIs(d,"gl2d"),V=L?"best":d.zsmooth;if(C._minDtick=0,k._minDtick=0,I)T=(S=e(g,d)).orig_x,m=S.x,y=S.x0,v=S.dx,M=S.orig_y,w=S.y,A=S.y0,E=S.dy,b=S.z;else{var O=d.z;h.isArray1D(O)?(r(d,C,k,"x","y",["z"]),m=d._x,w=d._y,O=d._z):(T=d.x?C.makeCalcdata(d,"x"):[],M=d.y?k.makeCalcdata(d,"y"):[],m=l(d,C,"x",T),w=l(d,k,"y",M),d._x=m,d._y=w),y=d.x0,v=d.dx,A=d.y0,E=d.dy,b=i(O,d,C,k)}function J(ie){V=d._input.zsmooth=d.zsmooth=!1,h.warn('cannot use zsmooth: "fast": '+ie)}if((C.rangebreaks||k.rangebreaks)&&(b=function(ie,ae,oe){for(var de=[],le=-1,fe=0;fe<oe.length;fe++)if(ae[fe]!==c){le++,de[le]=[];for(var ue=0;ue<oe[fe].length;ue++)ie[ue]!==c&&de[le].push(oe[fe][ue])}return de}(m,w,b),I||(m=f(m),w=f(w),d._x=m,d._y=w)),I||!L&&!d.connectgaps||(d._emptypoints=s(b),u(b,d._emptypoints)),V==="fast"){if(C.type==="log"||k.type==="log")J("log axis found");else if(!I){if(m.length){var D=(m[m.length-1]-m[0])/(m.length-1),B=Math.abs(D/100);for(_=0;_<m.length-1;_++)if(Math.abs(m[_+1]-m[_]-D)>B){J("x scale is not linear");break}}if(w.length&&V==="fast"){var N=(w[w.length-1]-w[0])/(w.length-1),F=Math.abs(N/100);for(_=0;_<w.length-1;_++)if(Math.abs(w[_+1]-w[_]-N)>F){J("y scale is not linear");break}}}}var H=h.maxRowLength(b),j=d.xtype==="scaled"?"":m,G=a(d,j,y,v,H,C),W=d.ytype==="scaled"?"":w,Q=a(d,W,A,E,b.length,k);R||(d._extremes[C._id]=p.findExtremes(C,G),d._extremes[k._id]=p.findExtremes(k,Q));var $={x:G,y:Q,z:b,text:d._text||d.text,hovertext:d._hovertext||d.hovertext};if(d.xperiodalignment&&T&&($.orig_x=T),d.yperiodalignment&&M&&($.orig_y=M),j&&j.length===G.length-1&&($.xCenter=j),W&&W.length===Q.length-1&&($.yCenter=W),I&&($.xRanges=S.xRanges,$.yRanges=S.yRanges,$.pts=S.pts),L||o(g,d,{vals:b,cLetter:"z"}),L&&d.contours&&d.contours.coloring==="heatmap"){var ee={type:d.type==="contour"?"heatmap":"histogram2d",xcalendar:d.xcalendar,ycalendar:d.ycalendar};$.xfill=a(ee,j,y,v,H,C),$.yfill=a(ee,W,A,E,b.length,k)}return[$]}},{"../../components/colorscale/calc":651,"../../constants/numerical":753,"../../lib":778,"../../plots/cartesian/align_period":825,"../../plots/cartesian/axes":828,"../../registry":911,"../histogram2d/calc":1098,"./clean_2d_array":1067,"./convert_column_xyz":1069,"./find_empties":1071,"./interp2d":1074,"./make_bound_array":1075}],1067:[function(n,z,q){"use strict";var t=n("fast-isnumeric"),h=n("../../lib"),p=n("../../constants/numerical").BADNUM;z.exports=function(l,e,o,r){var i,u,s,a,c,f;function g(w){if(t(w))return+w}if(e&&e.transpose){for(i=0,c=0;c<l.length;c++)i=Math.max(i,l[c].length);if(i===0)return!1;s=function(w){return w.length},a=function(w,A,E){return(w[E]||[])[A]}}else i=l.length,s=function(w,A){return w[A].length},a=function(w,A,E){return(w[A]||[])[E]};var d=function(w,A,E){return A===p||E===p?p:a(w,A,E)};function m(w){if(e&&e.type!=="carpet"&&e.type!=="contourcarpet"&&w&&w.type==="category"&&e["_"+w._id.charAt(0)].length){var A=w._id.charAt(0),E={},M=e["_"+A+"CategoryMap"]||e[A];for(c=0;c<M.length;c++)E[M[c]]=c;return function(b){var _=E[w._categories[b]];return _+1?_:p}}return h.identity}var y=m(o),v=m(r);r&&r.type==="category"&&(i=r._categories.length);var T=new Array(i);for(c=0;c<i;c++)for(u=o&&o.type==="category"?o._categories.length:s(l,c),T[c]=new Array(u),f=0;f<u;f++)T[c][f]=g(d(l,v(c),y(f)));return T}},{"../../constants/numerical":753,"../../lib":778,"fast-isnumeric":241}],1068:[function(n,z,q){"use strict";z.exports={min:"zmin",max:"zmax"}},{}],1069:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../../constants/numerical").BADNUM,p=n("../../plots/cartesian/align_period");z.exports=function(l,e,o,r,i,u){var s=l._length,a=e.makeCalcdata(l,r),c=o.makeCalcdata(l,i);a=p(l,e,r,a),c=p(l,o,i,c);var f,g,d,m,y=l.text,v=y!==void 0&&t.isArray1D(y),T=l.hovertext,w=T!==void 0&&t.isArray1D(T),A=t.distinctVals(a),E=A.vals,M=t.distinctVals(c),b=M.vals,_=[],S=b.length,C=E.length;for(f=0;f<u.length;f++)_[f]=t.init2dArray(S,C);v&&(d=t.init2dArray(S,C)),w&&(m=t.init2dArray(S,C));var k=t.init2dArray(S,C);for(f=0;f<s;f++)if(a[f]!==h&&c[f]!==h){var L=t.findBin(a[f]+A.minDiff/2,E),I=t.findBin(c[f]+M.minDiff/2,b);for(g=0;g<u.length;g++){var R=l[u[g]];_[g][I][L]=R[f],k[I][L]=f}v&&(d[I][L]=y[f]),w&&(m[I][L]=T[f])}for(l["_"+r]=E,l["_"+i]=b,g=0;g<u.length;g++)l["_"+u[g]]=_[g];v&&(l._text=d),w&&(l._hovertext=m),e&&e.type==="category"&&(l["_"+r+"CategoryMap"]=E.map(function(V){return e._categories[V]})),o&&o.type==="category"&&(l["_"+i+"CategoryMap"]=b.map(function(V){return o._categories[V]})),l._after2before=k}},{"../../constants/numerical":753,"../../lib":778,"../../plots/cartesian/align_period":825}],1070:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("./xyz_defaults"),p=n("../scatter/period_defaults"),l=n("./style_defaults"),e=n("../../components/colorscale/defaults"),o=n("./attributes");z.exports=function(r,i,u,s){function a(c,f){return t.coerce(r,i,o,c,f)}h(r,i,a,s)?(p(r,i,s,a),a("text"),a("hovertext"),a("hovertemplate"),l(r,i,a,s),a("hoverongaps"),a("connectgaps",t.isArray1D(i.z)&&i.zsmooth!==!1),e(r,i,s,a,{prefix:"",cLetter:"z"})):i.visible=!1}},{"../../components/colorscale/defaults":653,"../../lib":778,"../scatter/period_defaults":1207,"./attributes":1065,"./style_defaults":1078,"./xyz_defaults":1079}],1071:[function(n,z,q){"use strict";var t=n("../../lib").maxRowLength;z.exports=function(h){var p,l,e,o,r,i,u,s,a=[],c={},f=[],g=h[0],d=[],m=[0,0,0],y=t(h);for(l=0;l<h.length;l++)for(p=d,d=g,g=h[l+1]||[],e=0;e<y;e++)d[e]===void 0&&((i=(d[e-1]!==void 0?1:0)+(d[e+1]!==void 0?1:0)+(p[e]!==void 0?1:0)+(g[e]!==void 0?1:0))?(l===0&&i++,e===0&&i++,l===h.length-1&&i++,e===d.length-1&&i++,i<4&&(c[[l,e]]=[l,e,i]),a.push([l,e,i])):f.push([l,e]));for(;f.length;){for(u={},s=!1,r=f.length-1;r>=0;r--)(i=((c[[(l=(o=f[r])[0])-1,e=o[1]]]||m)[2]+(c[[l+1,e]]||m)[2]+(c[[l,e-1]]||m)[2]+(c[[l,e+1]]||m)[2])/20)&&(u[o]=[l,e,i],f.splice(r,1),s=!0);if(!s)throw"findEmpties iterated with no new neighbors";for(o in u)c[o]=u[o],a.push(u[o])}return a.sort(function(v,T){return T[2]-v[2]})}},{"../../lib":778}],1072:[function(n,z,q){"use strict";var t=n("../../components/fx"),h=n("../../lib"),p=n("../../plots/cartesian/axes"),l=n("../../components/colorscale").extractOpts;z.exports=function(e,o,r,i,u,s){var a,c,f,g,d=e.cd[0],m=d.trace,y=e.xa,v=e.ya,T=d.x,w=d.y,A=d.z,E=d.xCenter,M=d.yCenter,b=d.zmask,_=m.zhoverformat,S=T,C=w;if(e.index!==!1){try{f=Math.round(e.index[1]),g=Math.round(e.index[0])}catch{return void h.error("Error hovering on heatmap, pointNumber must be [row,col], found:",e.index)}if(f<0||f>=A[0].length||g<0||g>A.length)return}else{if(t.inbox(o-T[0],o-T[T.length-1],0)>0||t.inbox(r-w[0],r-w[w.length-1],0)>0)return;if(s){var k;for(S=[2*T[0]-T[1]],k=1;k<T.length;k++)S.push((T[k]+T[k-1])/2);for(S.push([2*T[T.length-1]-T[T.length-2]]),C=[2*w[0]-w[1]],k=1;k<w.length;k++)C.push((w[k]+w[k-1])/2);C.push([2*w[w.length-1]-w[w.length-2]])}f=Math.max(0,Math.min(S.length-2,h.findBin(o,S))),g=Math.max(0,Math.min(C.length-2,h.findBin(r,C)))}var L,I,R=y.c2p(T[f]),V=y.c2p(T[f+1]),O=v.c2p(w[g]),J=v.c2p(w[g+1]);s?(L=d.orig_x||T,I=d.orig_y||w,V=R,a=L[f],J=O,c=I[g]):(L=d.orig_x||E||T,I=d.orig_y||M||w,a=E?L[f]:(L[f]+L[f+1])/2,c=M?I[g]:(I[g]+I[g+1])/2,y&&y.type==="category"&&(a=T[f]),v&&v.type==="category"&&(c=w[g]),m.zsmooth&&(R=V=y.c2p(a),O=J=v.c2p(c)));var D=A[g][f];if(b&&!b[g][f]&&(D=void 0),D!==void 0||m.hoverongaps){var B;Array.isArray(d.hovertext)&&Array.isArray(d.hovertext[g])?B=d.hovertext[g][f]:Array.isArray(d.text)&&Array.isArray(d.text[g])&&(B=d.text[g][f]);var N=l(m),F={type:"linear",range:[N.min,N.max],hoverformat:_,_separators:y._separators,_numFormat:y._numFormat},H=p.tickText(F,D,"hover").text;return[h.extendFlat(e,{index:m._after2before?m._after2before[g][f]:[g,f],distance:e.maxHoverDistance,spikeDistance:e.maxSpikeDistance,x0:R,x1:V,y0:O,y1:J,xLabelVal:a,yLabelVal:c,zLabelVal:D,zLabel:H,text:B})]}}},{"../../components/colorscale":655,"../../components/fx":683,"../../lib":778,"../../plots/cartesian/axes":828}],1073:[function(n,z,q){"use strict";z.exports={attributes:n("./attributes"),supplyDefaults:n("./defaults"),calc:n("./calc"),plot:n("./plot"),colorbar:n("./colorbar"),style:n("./style"),hoverPoints:n("./hover"),moduleType:"trace",name:"heatmap",basePlotModule:n("../../plots/cartesian"),categories:["cartesian","svg","2dMap","showLegend"],meta:{}}},{"../../plots/cartesian":841,"./attributes":1065,"./calc":1066,"./colorbar":1068,"./defaults":1070,"./hover":1072,"./plot":1076,"./style":1077}],1074:[function(n,z,q){"use strict";var t=n("../../lib"),h=[[-1,0],[1,0],[0,-1],[0,1]];function p(e){return .5-.25*Math.min(1,.5*e)}function l(e,o,r){var i,u,s,a,c,f,g,d,m,y,v,T,w,A=0;for(a=0;a<o.length;a++){for(u=(i=o[a])[0],s=i[1],v=e[u][s],y=0,m=0,c=0;c<4;c++)(g=e[u+(f=h[c])[0]])&&(d=g[s+f[1]])!==void 0&&(y===0?T=w=d:(T=Math.min(T,d),w=Math.max(w,d)),m++,y+=d);if(m===0)throw"iterateInterp2d order is wrong: no defined neighbors";e[u][s]=y/m,v===void 0?m<4&&(A=1):(e[u][s]=(1+r)*e[u][s]-r*v,w>T&&(A=Math.max(A,Math.abs(e[u][s]-v)/(w-T))))}return A}z.exports=function(e,o){var r,i=1;for(l(e,o),r=0;r<o.length&&!(o[r][2]<4);r++);for(o=o.slice(r),r=0;r<100&&i>.01;r++)i=l(e,o,p(i));return i>.01&&t.log("interp2d didn't converge quickly",i),e}},{"../../lib":778}],1075:[function(n,z,q){"use strict";var t=n("../../registry"),h=n("../../lib").isArrayOrTypedArray;z.exports=function(p,l,e,o,r,i){var u,s,a,c=[],f=t.traceIs(p,"contour"),g=t.traceIs(p,"histogram"),d=t.traceIs(p,"gl2d");if(h(l)&&l.length>1&&!g&&i.type!=="category"){var m=l.length;if(!(m<=r))return f?l.slice(0,r):l.slice(0,r+1);if(f||d)c=l.slice(0,r);else if(r===1)c=[l[0]-.5,l[0]+.5];else{for(c=[1.5*l[0]-.5*l[1]],a=1;a<m;a++)c.push(.5*(l[a-1]+l[a]));c.push(1.5*l[m-1]-.5*l[m-2])}if(m<r){var y=c[c.length-1],v=y-c[c.length-2];for(a=m;a<r;a++)y+=v,c.push(y)}}else{var T=p[i._id.charAt(0)+"calendar"];for(g?u=i.r2c(e,0,T):h(l)&&l.length===1?u=l[0]:e===void 0?u=0:u=(i.type==="log"?i.d2c:i.r2c)(e,0,T),s=o||1,a=f||d?0:-.5;a<r;a++)c.push(u+s*a)}return c}},{"../../lib":778,"../../registry":911}],1076:[function(n,z,q){"use strict";var t=n("d3"),h=n("tinycolor2"),p=n("../../registry"),l=n("../../lib"),e=n("../../components/colorscale").makeColorScaleFuncFromTrace,o=n("../../constants/xmlns_namespaces");function r(s,a){var c=a.length-2,f=l.constrain(l.findBin(s,a),0,c),g=a[f],d=a[f+1],m=l.constrain(f+(s-g)/(d-g)-.5,0,c),y=Math.round(m),v=Math.abs(m-y);return m&&m!==c&&v?{bin0:y,frac:v,bin1:Math.round(y+v/(m-y))}:{bin0:y,bin1:y,frac:0}}function i(s,a){var c=a.length-1,f=l.constrain(l.findBin(s,a),0,c),g=a[f],d=(s-g)/(a[f+1]-g)||0;return d<=0?{bin0:f,bin1:f,frac:0}:d<.5?{bin0:f,bin1:f+1,frac:d}:{bin0:f+1,bin1:f,frac:1-d}}function u(s,a,c){s[a]=c[0],s[a+1]=c[1],s[a+2]=c[2],s[a+3]=Math.round(255*c[3])}z.exports=function(s,a,c,f){var g=a.xaxis,d=a.yaxis;l.makeTraceGroups(f,c,"hm").each(function(m){var y,v,T,w,A,E,M=t.select(this),b=m[0],_=b.trace,S=b.z,C=b.x,k=b.y,L=b.xCenter,I=b.yCenter,R=p.traceIs(_,"contour"),V=R?"best":_.zsmooth,O=S.length,J=l.maxRowLength(S),D=!1,B=!1;for(E=0;y===void 0&&E<C.length-1;)y=g.c2p(C[E]),E++;for(E=C.length-1;v===void 0&&E>0;)v=g.c2p(C[E]),E--;for(v<y&&(T=v,v=y,y=T,D=!0),E=0;w===void 0&&E<k.length-1;)w=d.c2p(k[E]),E++;for(E=k.length-1;A===void 0&&E>0;)A=d.c2p(k[E]),E--;if(A<w&&(T=w,w=A,A=T,B=!0),R&&(L=C,I=k,C=b.xfill,k=b.yfill),V!=="fast"){var N=V==="best"?0:.5;y=Math.max(-N*g._length,y),v=Math.min((1+N)*g._length,v),w=Math.max(-N*d._length,w),A=Math.min((1+N)*d._length,A)}var F=Math.round(v-y),H=Math.round(A-w);if(F<=0||H<=0)M.selectAll("image").data([]).exit().remove();else{var j,G;V==="fast"?(j=J,G=O):(j=F,G=H);var W=document.createElement("canvas");W.width=j,W.height=G;var Q,$,ee=W.getContext("2d"),ie=e(_,{noNumericCheck:!0,returnArray:!0});V==="fast"?(Q=D?function(Ye){return J-1-Ye}:l.identity,$=B?function(Ye){return O-1-Ye}:l.identity):(Q=function(Ye){return l.constrain(Math.round(g.c2p(C[Ye])-y),0,F)},$=function(Ye){return l.constrain(Math.round(d.c2p(k[Ye])-w),0,H)});var ae,oe,de,le,fe,ue=$(0),we=[ue,ue],Ae=D?0:1,Se=B?0:1,ke=0,Me=0,ve=0,ge=0;if(V){var De,_e=0;try{De=new Uint8Array(F*H*4)}catch{De=new Array(F*H*4)}if(V==="best"){var Pe,Fe,ze,He=L||C,et=I||k,Re=new Array(He.length),Ze=new Array(et.length),Ke=new Array(F),$e=L?i:r,rt=I?i:r;for(E=0;E<He.length;E++)Re[E]=Math.round(g.c2p(He[E])-y);for(E=0;E<et.length;E++)Ze[E]=Math.round(d.c2p(et[E])-w);for(E=0;E<F;E++)Ke[E]=$e(E,Re);for(oe=0;oe<H;oe++)for(Fe=S[(Pe=rt(oe,Ze)).bin0],ze=S[Pe.bin1],E=0;E<F;E++,_e+=4)u(De,_e,fe=Ue(Fe,ze,Ke[E],Pe))}else for(oe=0;oe<O;oe++)for(le=S[oe],we=$(oe),E=0;E<F;E++)fe=Ce(le[E],1),u(De,_e=4*(we*F+Q(E)),fe);var at=ee.createImageData(F,H);try{at.data.set(De)}catch{var lt=at.data,gt=lt.length;for(oe=0;oe<gt;oe++)lt[oe]=De[oe]}ee.putImageData(at,0,0)}else{var Ie=_.xgap,be=_.ygap,We=Math.floor(Ie/2),Ge=Math.floor(be/2);for(oe=0;oe<O;oe++)if(le=S[oe],we.reverse(),we[Se]=$(oe+1),we[0]!==we[1]&&we[0]!==void 0&&we[1]!==void 0)for(ae=[de=Q(0),de],E=0;E<J;E++)ae.reverse(),ae[Ae]=Q(E+1),ae[0]!==ae[1]&&ae[0]!==void 0&&ae[1]!==void 0&&(fe=Ce(le[E],(ae[1]-ae[0])*(we[1]-we[0])),ee.fillStyle="rgba("+fe.join(",")+")",ee.fillRect(ae[0]+We,we[0]+Ge,ae[1]-ae[0]-Ie,we[1]-we[0]-be))}Me=Math.round(Me/ke),ve=Math.round(ve/ke),ge=Math.round(ge/ke);var st=h("rgb("+Me+","+ve+","+ge+")");s._hmpixcount=(s._hmpixcount||0)+ke,s._hmlumcount=(s._hmlumcount||0)+ke*st.getLuminance();var ot=M.selectAll("image").data(m);ot.enter().append("svg:image").attr({xmlns:o.svg,preserveAspectRatio:"none"}),ot.attr({height:H,width:F,x:y,y:w,"xlink:href":W.toDataURL("image/png")})}function Ce(Ye,xe){if(Ye!==void 0){var Ee=ie(Ye);return Ee[0]=Math.round(Ee[0]),Ee[1]=Math.round(Ee[1]),Ee[2]=Math.round(Ee[2]),ke+=xe,Me+=Ee[0]*xe,ve+=Ee[1]*xe,ge+=Ee[2]*xe,Ee}return[0,0,0,0]}function Ue(Ye,xe,Ee,Je){var it=Ye[Ee.bin0];if(it===void 0)return Ce(void 0,1);var ht,ct=Ye[Ee.bin1],mt=xe[Ee.bin0],bt=xe[Ee.bin1],Et=ct-it||0,Mt=mt-it||0;return ht=ct===void 0?bt===void 0?0:mt===void 0?2*(bt-it):2*(2*bt-mt-it)/3:bt===void 0?mt===void 0?0:2*(2*it-ct-mt)/3:mt===void 0?2*(2*bt-ct-it)/3:bt+it-ct-mt,Ce(it+Ee.frac*Et+Je.frac*(Mt+Ee.frac*ht))}})}},{"../../components/colorscale":655,"../../constants/xmlns_namespaces":754,"../../lib":778,"../../registry":911,d3:169,tinycolor2:576}],1077:[function(n,z,q){"use strict";var t=n("d3");z.exports=function(h){t.select(h).selectAll(".hm image").style("opacity",function(p){return p.trace.opacity})}},{d3:169}],1078:[function(n,z,q){"use strict";z.exports=function(t,h,p){p("zsmooth")===!1&&(p("xgap"),p("ygap")),p("zhoverformat")}},{}],1079:[function(n,z,q){"use strict";var t=n("fast-isnumeric"),h=n("../../lib"),p=n("../../registry");function l(e,o){var r=o(e);return(r?o(e+"type","array"):"scaled")==="scaled"&&(o(e+"0"),o("d"+e)),r}z.exports=function(e,o,r,i,u,s){var a,c,f=r("z");if(u=u||"x",s=s||"y",f===void 0||!f.length)return 0;if(h.isArray1D(e.z)){a=r(u),c=r(s);var g=h.minRowLength(a),d=h.minRowLength(c);if(g===0||d===0)return 0;o._length=Math.min(g,d,f.length)}else{if(a=l(u,r),c=l(s,r),!function(m){for(var y,v=!0,T=!1,w=!1,A=0;A<m.length;A++){if(y=m[A],!h.isArrayOrTypedArray(y)){v=!1;break}y.length>0&&(T=!0);for(var E=0;E<y.length;E++)if(t(y[E])){w=!0;break}}return v&&T&&w}(f))return 0;r("transpose"),o._length=null}return e.type==="heatmapgl"||e.type==="contourgl"||p.getComponentMethod("calendars","handleTraceDefaults")(e,o,[u,s],i),!0}},{"../../lib":778,"../../registry":911,"fast-isnumeric":241}],1080:[function(n,z,q){"use strict";for(var t=n("../heatmap/attributes"),h=n("../../components/colorscale/attributes"),p=n("../../lib/extend").extendFlat,l=n("../../plot_api/edit_types").overrideAll,e=["z","x","x0","dx","y","y0","dy","text","transpose","xtype","ytype"],o={},r=0;r<e.length;r++){var i=e[r];o[i]=t[i]}o.zsmooth={valType:"enumerated",values:["fast",!1],dflt:"fast",editType:"calc"},p(o,h("",{cLetter:"z",autoColorDflt:!1})),z.exports=l(o,"calc","nested")},{"../../components/colorscale/attributes":650,"../../lib/extend":768,"../../plot_api/edit_types":810,"../heatmap/attributes":1065}],1081:[function(n,z,q){"use strict";var t=n("gl-heatmap2d"),h=n("../../plots/cartesian/axes"),p=n("../../lib/str2rgbarray");function l(o,r){this.scene=o,this.uid=r,this.type="heatmapgl",this.name="",this.hoverinfo="all",this.xData=[],this.yData=[],this.zData=[],this.textLabels=[],this.idToIndex=[],this.bounds=[0,0,0,0],this.options={zsmooth:"fast",z:[],x:[],y:[],shape:[0,0],colorLevels:[0],colorValues:[0,0,0,1]},this.heatmap=t(o.glplot,this.options),this.heatmap._trace=this}var e=l.prototype;e.handlePick=function(o){var r=this.options,i=r.shape,u=o.pointId,s=u%i[0],a=Math.floor(u/i[0]),c=u;return{trace:this,dataCoord:o.dataCoord,traceCoord:[r.x[s],r.y[a],r.z[c]],textLabel:this.textLabels[u],name:this.name,pointIndex:[a,s],hoverinfo:this.hoverinfo}},e.update=function(o,r){var i=r[0];this.index=o.index,this.name=o.name,this.hoverinfo=o.hoverinfo;var u=i.z;this.options.z=[].concat.apply([],u);var s=u[0].length,a=u.length;this.options.shape=[s,a],this.options.x=i.x,this.options.y=i.y,this.options.zsmooth=o.zsmooth;var c=function(y){for(var v=y.colorscale,T=y.zmin,w=y.zmax,A=v.length,E=new Array(A),M=new Array(4*A),b=0;b<A;b++){var _=v[b],S=p(_[1]);E[b]=T+_[0]*(w-T);for(var C=0;C<4;C++)M[4*b+C]=S[C]}return{colorLevels:E,colorValues:M}}(o);this.options.colorLevels=c.colorLevels,this.options.colorValues=c.colorValues,this.textLabels=[].concat.apply([],o.text),this.heatmap.update(this.options);var f,g,d=this.scene.xaxis,m=this.scene.yaxis;o.zsmooth===!1&&(f={ppad:i.x[1]-i.x[0]},g={ppad:i.y[1]-i.y[0]}),o._extremes[d._id]=h.findExtremes(d,i.x,f),o._extremes[m._id]=h.findExtremes(m,i.y,g)},e.dispose=function(){this.heatmap.dispose()},z.exports=function(o,r,i){var u=new l(o,r.uid);return u.update(r,i),u}},{"../../lib/str2rgbarray":802,"../../plots/cartesian/axes":828,"gl-heatmap2d":271}],1082:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../heatmap/xyz_defaults"),p=n("../../components/colorscale/defaults"),l=n("./attributes");z.exports=function(e,o,r,i){function u(s,a){return t.coerce(e,o,l,s,a)}h(e,o,u,i)?(u("text"),u("zsmooth"),p(e,o,i,u,{prefix:"",cLetter:"z"})):o.visible=!1}},{"../../components/colorscale/defaults":653,"../../lib":778,"../heatmap/xyz_defaults":1079,"./attributes":1080}],1083:[function(n,z,q){"use strict";z.exports={attributes:n("./attributes"),supplyDefaults:n("./defaults"),colorbar:n("../heatmap/colorbar"),calc:n("../heatmap/calc"),plot:n("./convert"),moduleType:"trace",name:"heatmapgl",basePlotModule:n("../../plots/gl2d"),categories:["gl","gl2d","2dMap"],meta:{}}},{"../../plots/gl2d":868,"../heatmap/calc":1066,"../heatmap/colorbar":1068,"./attributes":1080,"./convert":1081,"./defaults":1082}],1084:[function(n,z,q){"use strict";var t=n("../bar/attributes"),h=n("../../plots/template_attributes").hovertemplateAttrs,p=n("./bin_attributes"),l=n("./constants"),e=n("../../lib/extend").extendFlat;z.exports={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},text:e({},t.text,{}),hovertext:e({},t.hovertext,{}),orientation:t.orientation,histfunc:{valType:"enumerated",values:["count","sum","avg","min","max"],dflt:"count",editType:"calc"},histnorm:{valType:"enumerated",values:["","percent","probability","density","probability density"],dflt:"",editType:"calc"},cumulative:{enabled:{valType:"boolean",dflt:!1,editType:"calc"},direction:{valType:"enumerated",values:["increasing","decreasing"],dflt:"increasing",editType:"calc"},currentbin:{valType:"enumerated",values:["include","exclude","half"],dflt:"include",editType:"calc"},editType:"calc"},nbinsx:{valType:"integer",min:0,dflt:0,editType:"calc"},xbins:p("x",!0),nbinsy:{valType:"integer",min:0,dflt:0,editType:"calc"},ybins:p("y",!0),autobinx:{valType:"boolean",dflt:null,editType:"calc"},autobiny:{valType:"boolean",dflt:null,editType:"calc"},bingroup:{valType:"string",dflt:"",editType:"calc"},hovertemplate:h({},{keys:l.eventDataKeys}),marker:t.marker,offsetgroup:t.offsetgroup,alignmentgroup:t.alignmentgroup,selected:t.selected,unselected:t.unselected,_deprecated:{bardir:t._deprecated.bardir}}},{"../../lib/extend":768,"../../plots/template_attributes":906,"../bar/attributes":921,"./bin_attributes":1086,"./constants":1090}],1085:[function(n,z,q){"use strict";z.exports=function(t,h){for(var p=t.length,l=0,e=0;e<p;e++)h[e]?(t[e]/=h[e],l+=t[e]):t[e]=null;return l}},{}],1086:[function(n,z,q){"use strict";z.exports=function(t,h){return{start:{valType:"any",editType:"calc"},end:{valType:"any",editType:"calc"},size:{valType:"any",editType:"calc"},editType:"calc"}}},{}],1087:[function(n,z,q){"use strict";var t=n("fast-isnumeric");z.exports={count:function(h,p,l){return l[h]++,1},sum:function(h,p,l,e){var o=e[p];return t(o)?(o=Number(o),l[h]+=o,o):0},avg:function(h,p,l,e,o){var r=e[p];return t(r)&&(r=Number(r),l[h]+=r,o[h]++),0},min:function(h,p,l,e){var o=e[p];if(t(o)){if(o=Number(o),!t(l[h]))return l[h]=o,o;if(l[h]>o){var r=o-l[h];return l[h]=o,r}}return 0},max:function(h,p,l,e){var o=e[p];if(t(o)){if(o=Number(o),!t(l[h]))return l[h]=o,o;if(l[h]<o){var r=o-l[h];return l[h]=o,r}}return 0}}},{"fast-isnumeric":241}],1088:[function(n,z,q){"use strict";var t=n("../../constants/numerical"),h=t.ONEAVGYEAR,p=t.ONEAVGMONTH,l=t.ONEDAY,e=t.ONEHOUR,o=t.ONEMIN,r=t.ONESEC,i=n("../../plots/cartesian/axes").tickIncrement;function u(f,g,d,m){if(f*g<=0)return 1/0;for(var y=Math.abs(g-f),v=d.type==="date",T=s(y,v),w=0;w<10;w++){var A=s(80*T,v);if(T===A||!a(A,f,g,v,d,m))break;T=A}return T}function s(f,g){return g&&f>r?f>l?f>1.1*h?h:f>1.1*p?p:l:f>e?e:f>o?o:r:Math.pow(10,Math.floor(Math.log(f)/Math.LN10))}function a(f,g,d,m,y,v){if(m&&f>l){var T=c(g,y,v),w=c(d,y,v),A=f===h?0:1;return T[A]!==w[A]}return Math.floor(d/f)-Math.floor(g/f)>.1}function c(f,g,d){var m=g.c2d(f,h,d).split("-");return m[0]===""&&(m.unshift(),m[0]="-"+m[0]),m}z.exports=function(f,g,d,m,y){var v,T,w=-1.1*g,A=-.1*g,E=f-A,M=d[0],b=d[1],_=Math.min(u(M+A,M+E,m,y),u(b+A,b+E,m,y)),S=Math.min(u(M+w,M+A,m,y),u(b+w,b+A,m,y));if(_>S&&S<Math.abs(b-M)/4e3?(v=_,T=!1):(v=Math.min(_,S),T=!0),m.type==="date"&&v>l){var C=v===h?1:6,k=v===h?"M12":"M1";return function(L,I){var R=m.c2d(L,h,y),V=R.indexOf("-",C);V>0&&(R=R.substr(0,V));var O=m.d2c(R,0,y);if(O<L){var J=i(O,k,!1,y);(O+J)/2<L+f&&(O=J)}return I&&T?i(O,k,!0,y):O}}return function(L,I){var R=v*Math.round(L/v);return R+v/10<L&&R+.9*v<L+f&&(R+=v),I&&T&&(R-=v),R}}},{"../../constants/numerical":753,"../../plots/cartesian/axes":828}],1089:[function(n,z,q){"use strict";var t=n("fast-isnumeric"),h=n("../../lib"),p=n("../../registry"),l=n("../../plots/cartesian/axes"),e=n("../bar/arrays_to_calcdata"),o=n("./bin_functions"),r=n("./norm_functions"),i=n("./average"),u=n("./bin_label_vals");function s(a,c,f,g,d){var m,y,v,T,w,A,E,M=g+"bins",b=a._fullLayout,_=c["_"+g+"bingroup"],S=b._histogramBinOpts[_],C=b.barmode==="overlay",k=function(ue){return f.r2c(ue,0,T)},L=function(ue){return f.c2r(ue,0,T)},I=f.type==="date"?function(ue){return ue||ue===0?h.cleanDate(ue,null,T):null}:function(ue){return t(ue)?Number(ue):null};function R(ue,we,Ae){we[ue+"Found"]?(we[ue]=I(we[ue]),we[ue]===null&&(we[ue]=Ae[ue])):(A[ue]=we[ue]=Ae[ue],h.nestedProperty(y[0],M+"."+ue).set(Ae[ue]))}if(c["_"+g+"autoBinFinished"])delete c["_"+g+"autoBinFinished"];else{y=S.traces;var V=[],O=!0,J=!1,D=!1;for(m=0;m<y.length;m++)if((v=y[m]).visible){var B=S.dirs[m];w=v["_"+B+"pos0"]=f.makeCalcdata(v,B),V=h.concat(V,w),delete v["_"+g+"autoBinFinished"],c.visible===!0&&(O?O=!1:(delete v._autoBin,v["_"+g+"autoBinFinished"]=1),p.traceIs(v,"2dMap")&&(J=!0),v.type==="histogram2dcontour"&&(D=!0))}T=y[0][g+"calendar"];var N=l.autoBin(V,f,S.nbins,J,T,S.sizeFound&&S.size),F=y[0]._autoBin={};if(A=F[S.dirs[0]]={},D&&(S.size||(N.start=L(l.tickIncrement(k(N.start),N.size,!0,T))),S.end===void 0&&(N.end=L(l.tickIncrement(k(N.end),N.size,!1,T)))),C&&!p.traceIs(c,"2dMap")&&N._dataSpan===0&&f.type!=="category"&&f.type!=="multicategory"){if(d)return[N,w,!0];N=function(ue,we,Ae,Se,ke){var Me,ve,ge,De=ue._fullLayout,_e=function(lt,gt){for(var Ie=gt.xaxis,be=gt.yaxis,We=gt.orientation,Ge=[],st=lt._fullData,ot=0;ot<st.length;ot++){var Ce=st[ot];Ce.type==="histogram"&&Ce.visible===!0&&Ce.orientation===We&&Ce.xaxis===Ie&&Ce.yaxis===be&&Ge.push(Ce)}return Ge}(ue,we),Pe=!1,Fe=1/0,ze=[we];for(Me=0;Me<_e.length;Me++)if((ve=_e[Me])===we)Pe=!0;else if(Pe){var He=s(ue,ve,Ae,Se,!0),et=He[0],Re=He[2];ve["_"+Se+"autoBinFinished"]=1,ve["_"+Se+"pos0"]=He[1],Re?ze.push(ve):Fe=Math.min(Fe,et.size)}else ge=De._histogramBinOpts[ve["_"+Se+"bingroup"]],Fe=Math.min(Fe,ge.size||ve[ke].size);var Ze=new Array(ze.length);for(Me=0;Me<ze.length;Me++)for(var Ke=ze[Me]["_"+Se+"pos0"],$e=0;$e<Ke.length;$e++)if(Ke[$e]!==void 0){Ze[Me]=Ke[$e];break}for(isFinite(Fe)||(Fe=h.distinctVals(Ze).minDiff),Me=0;Me<ze.length;Me++){var rt=(ve=ze[Me])[Se+"calendar"],at={start:Ae.c2r(Ze[Me]-Fe/2,0,rt),end:Ae.c2r(Ze[Me]+Fe/2,0,rt),size:Fe};ve._input[ke]=ve[ke]=at,(ge=De._histogramBinOpts[ve["_"+Se+"bingroup"]])&&h.extendFlat(ge,at)}return we[ke]}(a,c,f,g,M)}(E=v.cumulative||{}).enabled&&E.currentbin!=="include"&&(E.direction==="decreasing"?N.start=L(l.tickIncrement(k(N.start),N.size,!0,T)):N.end=L(l.tickIncrement(k(N.end),N.size,!1,T))),S.size=N.size,S.sizeFound||(A.size=N.size,h.nestedProperty(y[0],M+".size").set(N.size)),R("start",S,N),R("end",S,N)}w=c["_"+g+"pos0"],delete c["_"+g+"pos0"];var H=c._input[M]||{},j=h.extendFlat({},S),G=S.start,W=f.r2l(H.start),Q=W!==void 0;if((S.startFound||Q)&&W!==f.r2l(G)){var $=Q?W:h.aggNums(Math.min,null,w),ee={type:f.type==="category"||f.type==="multicategory"?"linear":f.type,r2l:f.r2l,dtick:S.size,tick0:G,calendar:T,range:[$,l.tickIncrement($,S.size,!1,T)].map(f.l2r)},ie=l.tickFirst(ee);ie>f.r2l($)&&(ie=l.tickIncrement(ie,S.size,!0,T)),j.start=f.l2r(ie),Q||h.nestedProperty(c,M+".start").set(j.start)}var ae=S.end,oe=f.r2l(H.end),de=oe!==void 0;if((S.endFound||de)&&oe!==f.r2l(ae)){var le=de?oe:h.aggNums(Math.max,null,w);j.end=f.l2r(le),de||h.nestedProperty(c,M+".start").set(j.end)}var fe="autobin"+g;return c._input[fe]===!1&&(c._input[M]=h.extendFlat({},c[M]||{}),delete c._input[fe],delete c[fe]),[j,w]}z.exports={calc:function(a,c){var f,g,d,m,y=[],v=[],T=l.getFromId(a,c.orientation==="h"?c.yaxis:c.xaxis),w=c.orientation==="h"?"y":"x",A={x:"y",y:"x"}[w],E=c[w+"calendar"],M=c.cumulative,b=s(a,c,T,w),_=b[0],S=b[1],C=typeof _.size=="string",k=[],L=C?k:_,I=[],R=[],V=[],O=0,J=c.histnorm,D=c.histfunc,B=J.indexOf("density")!==-1;M.enabled&&B&&(J=J.replace(/ ?density$/,""),B=!1);var N,F=D==="max"||D==="min"?null:0,H=o.count,j=r[J],G=!1,W=function(Me){return T.r2c(Me,0,E)};for(h.isArrayOrTypedArray(c[A])&&D!=="count"&&(N=c[A],G=D==="avg",H=o[D]),f=W(_.start),d=W(_.end)+(f-l.tickIncrement(f,_.size,!1,E))/1e6;f<d&&y.length<1e6&&(g=l.tickIncrement(f,_.size,!1,E),y.push((f+g)/2),v.push(F),V.push([]),k.push(f),B&&I.push(1/(g-f)),G&&R.push(0),!(g<=f));)f=g;k.push(f),C||T.type!=="date"||(L={start:W(L.start),end:W(L.end),size:L.size}),a._fullLayout._roundFnOpts||(a._fullLayout._roundFnOpts={});var Q=c["_"+w+"bingroup"],$={leftGap:1/0,rightGap:1/0};Q&&(a._fullLayout._roundFnOpts[Q]||(a._fullLayout._roundFnOpts[Q]=$),$=a._fullLayout._roundFnOpts[Q]);var ee,ie=v.length,ae=!0,oe=$.leftGap,de=$.rightGap,le={};for(f=0;f<S.length;f++){var fe=S[f];(m=h.findBin(fe,L))>=0&&m<ie&&(O+=H(m,f,v,N,R),ae&&V[m].length&&fe!==S[V[m][0]]&&(ae=!1),V[m].push(f),le[f]=m,oe=Math.min(oe,fe-k[m]),de=Math.min(de,k[m+1]-fe))}$.leftGap=oe,$.rightGap=de,ae||(ee=function(Me,ve){return function(){var ge=a._fullLayout._roundFnOpts[Q];return u(ge.leftGap,ge.rightGap,k,T,E)(Me,ve)}}),G&&(O=i(v,R)),j&&j(v,O,I),M.enabled&&function(Me,ve,ge){var De,_e,Pe;function Fe(He){Pe=Me[He],Me[He]/=2}function ze(He){_e=Me[He],Me[He]=Pe+_e/2,Pe+=_e}if(ge==="half")if(ve==="increasing")for(Fe(0),De=1;De<Me.length;De++)ze(De);else for(Fe(Me.length-1),De=Me.length-2;De>=0;De--)ze(De);else if(ve==="increasing"){for(De=1;De<Me.length;De++)Me[De]+=Me[De-1];ge==="exclude"&&(Me.unshift(0),Me.pop())}else{for(De=Me.length-2;De>=0;De--)Me[De]+=Me[De+1];ge==="exclude"&&(Me.push(0),Me.shift())}}(v,M.direction,M.currentbin);var ue=Math.min(y.length,v.length),we=[],Ae=0,Se=ue-1;for(f=0;f<ue;f++)if(v[f]){Ae=f;break}for(f=ue-1;f>=Ae;f--)if(v[f]){Se=f;break}for(f=Ae;f<=Se;f++)if(t(y[f])&&t(v[f])){var ke={p:y[f],s:v[f],b:0};M.enabled||(ke.pts=V[f],ae?ke.ph0=ke.ph1=V[f].length?S[V[f][0]]:y[f]:(c._computePh=!0,ke.ph0=ee(k[f]),ke.ph1=ee(k[f+1],!0))),we.push(ke)}return we.length===1&&(we[0].width1=l.tickIncrement(we[0].p,_.size,!1,E)-we[0].p),e(we,c),h.isArrayOrTypedArray(c.selectedpoints)&&h.tagSelected(we,c,le),we},calcAllAutoBins:s}},{"../../lib":778,"../../plots/cartesian/axes":828,"../../registry":911,"../bar/arrays_to_calcdata":920,"./average":1085,"./bin_functions":1087,"./bin_label_vals":1088,"./norm_functions":1096,"fast-isnumeric":241}],1090:[function(n,z,q){"use strict";z.exports={eventDataKeys:["binNumber"]}},{}],1091:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../../plots/cartesian/axis_ids"),p=n("../../registry").traceIs,l=n("../bar/defaults").handleGroupingDefaults,e=t.nestedProperty,o=n("../../plots/cartesian/constraints").getAxisGroup,r=[{aStr:{x:"xbins.start",y:"ybins.start"},name:"start"},{aStr:{x:"xbins.end",y:"ybins.end"},name:"end"},{aStr:{x:"xbins.size",y:"ybins.size"},name:"size"},{aStr:{x:"nbinsx",y:"nbinsy"},name:"nbins"}],i=["x","y"];z.exports=function(u,s){var a,c,f,g,d,m,y,v=s._histogramBinOpts={},T=[],w={},A=[];function E(N,F){return t.coerce(a._input,a,a._module.attributes,N,F)}function M(N){return N.orientation==="v"?"x":"y"}function b(N,F,H){var j=N.uid+"__"+H;F||(F=j);var G=function(ee,ie){return h.getFromTrace({_fullLayout:s},ee,ie).type}(N,H),W=N[H+"calendar"]||"",Q=v[F],$=!0;Q&&(G===Q.axType&&W===Q.calendar?($=!1,Q.traces.push(N),Q.dirs.push(H)):(F=j,G!==Q.axType&&t.warn(["Attempted to group the bins of trace",N.index,"set on a","type:"+G,"axis","with bins on","type:"+Q.axType,"axis."].join(" ")),W!==Q.calendar&&t.warn(["Attempted to group the bins of trace",N.index,"set with a",W,"calendar","with bins",Q.calendar?"on a "+Q.calendar+" calendar":"w/o a set calendar"].join(" ")))),$&&(v[F]={traces:[N],dirs:[H],axType:G,calendar:N[H+"calendar"]||""}),N["_"+H+"bingroup"]=F}for(d=0;d<u.length;d++)a=u[d],p(a,"histogram")&&(T.push(a),delete a._xautoBinFinished,delete a._yautoBinFinished,p(a,"2dMap")||l(a._input,a,s,E));var _=s._alignmentOpts||{};for(d=0;d<T.length;d++){if(a=T[d],f="",!p(a,"2dMap")){if(g=M(a),s.barmode==="group"&&a.alignmentgroup){var S=a[g+"axis"],C=o(s,S)+a.orientation;(_[C]||{})[a.alignmentgroup]&&(f=C)}f||s.barmode==="overlay"||(f=o(s,a.xaxis)+o(s,a.yaxis)+M(a))}f?(w[f]||(w[f]=[]),w[f].push(a)):A.push(a)}for(f in w)if((c=w[f]).length!==1){var k=!1;for(c.length&&(a=c[0],k=E("bingroup")),f=k||f,d=0;d<c.length;d++){var L=(a=c[d])._input.bingroup;L&&L!==f&&t.warn(["Trace",a.index,"must match","within bingroup",f+".","Ignoring its bingroup:",L,"setting."].join(" ")),a.bingroup=f,b(a,f,M(a))}}else A.push(c[0]);for(d=0;d<A.length;d++){a=A[d];var I=E("bingroup");if(p(a,"2dMap"))for(y=0;y<2;y++){var R=E((g=i[y])+"bingroup",I?I+"__"+g:null);b(a,R,g)}else b(a,I,M(a))}for(f in v){var V=v[f];for(c=V.traces,m=0;m<r.length;m++){var O,J,D=r[m],B=D.name;if(B!=="nbins"||!V.sizeFound){for(d=0;d<c.length;d++){if(a=c[d],g=V.dirs[d],O=D.aStr[g],e(a._input,O).get()!==void 0){V[B]=E(O),V[B+"Found"]=!0;break}(J=(a._autoBin||{})[g]||{})[B]&&e(a,O).set(J[B])}if(B==="start"||B==="end")for(;d<c.length;d++)(a=c[d])["_"+g+"bingroup"]&&E(O,(J=(a._autoBin||{})[g]||{})[B]);B!=="nbins"||V.sizeFound||V.nbinsFound||(a=c[0],V[B]=E(O))}}}}},{"../../lib":778,"../../plots/cartesian/axis_ids":831,"../../plots/cartesian/constraints":835,"../../registry":911,"../bar/defaults":925}],1092:[function(n,z,q){"use strict";var t=n("../../registry"),h=n("../../lib"),p=n("../../components/color"),l=n("../bar/style_defaults"),e=n("./attributes");z.exports=function(o,r,i,u){function s(T,w){return h.coerce(o,r,e,T,w)}var a=s("x"),c=s("y");s("cumulative.enabled")&&(s("cumulative.direction"),s("cumulative.currentbin")),s("text"),s("hovertext"),s("hovertemplate");var f=s("orientation",c&&!a?"h":"v"),g=f==="v"?"x":"y",d=f==="v"?"y":"x",m=a&&c?Math.min(h.minRowLength(a)&&h.minRowLength(c)):h.minRowLength(r[g]||[]);if(m){r._length=m,t.getComponentMethod("calendars","handleTraceDefaults")(o,r,["x","y"],u),r[d]&&s("histfunc"),s("histnorm"),s("autobin"+g),l(o,r,s,i,u),h.coerceSelectionMarkerOpacity(r,s);var y=(r.marker.line||{}).color,v=t.getComponentMethod("errorbars","supplyDefaults");v(o,r,y||p.defaultLine,{axis:"y"}),v(o,r,y||p.defaultLine,{axis:"x",inherit:"y"})}else r.visible=!1}},{"../../components/color":643,"../../lib":778,"../../registry":911,"../bar/style_defaults":936,"./attributes":1084}],1093:[function(n,z,q){"use strict";z.exports=function(t,h,p,l,e){if(t.x="xVal"in h?h.xVal:h.x,t.y="yVal"in h?h.yVal:h.y,"zLabelVal"in h&&(t.z=h.zLabelVal),h.xa&&(t.xaxis=h.xa),h.ya&&(t.yaxis=h.ya),!(p.cumulative||{}).enabled){var o,r=Array.isArray(e)?l[0].pts[e[0]][e[1]]:l[e].pts;if(t.pointNumbers=r,t.binNumber=t.pointNumber,delete t.pointNumber,delete t.pointIndex,p._indexToPoints){o=[];for(var i=0;i<r.length;i++)o=o.concat(p._indexToPoints[r[i]])}else o=r;t.pointIndices=o}return t}},{}],1094:[function(n,z,q){"use strict";var t=n("../bar/hover").hoverPoints,h=n("../../plots/cartesian/axes").hoverLabelText;z.exports=function(p,l,e,o){var r=t(p,l,e,o);if(r){var i=(p=r[0]).cd[p.index],u=p.cd[0].trace;if(!u.cumulative.enabled){var s=u.orientation==="h"?"y":"x";p[s+"Label"]=h(p[s+"a"],i.ph0,i.ph1)}return r}}},{"../../plots/cartesian/axes":828,"../bar/hover":928}],1095:[function(n,z,q){"use strict";z.exports={attributes:n("./attributes"),layoutAttributes:n("../bar/layout_attributes"),supplyDefaults:n("./defaults"),crossTraceDefaults:n("./cross_trace_defaults"),supplyLayoutDefaults:n("../bar/layout_defaults"),calc:n("./calc").calc,crossTraceCalc:n("../bar/cross_trace_calc").crossTraceCalc,plot:n("../bar/plot").plot,layerName:"barlayer",style:n("../bar/style").style,styleOnSelect:n("../bar/style").styleOnSelect,colorbar:n("../scatter/marker_colorbar"),hoverPoints:n("./hover"),selectPoints:n("../bar/select"),eventData:n("./event_data"),moduleType:"trace",name:"histogram",basePlotModule:n("../../plots/cartesian"),categories:["bar-like","cartesian","svg","bar","histogram","oriented","errorBarsOK","showLegend"],meta:{}}},{"../../plots/cartesian":841,"../bar/cross_trace_calc":924,"../bar/layout_attributes":930,"../bar/layout_defaults":931,"../bar/plot":932,"../bar/select":933,"../bar/style":935,"../scatter/marker_colorbar":1205,"./attributes":1084,"./calc":1089,"./cross_trace_defaults":1091,"./defaults":1092,"./event_data":1093,"./hover":1094}],1096:[function(n,z,q){"use strict";z.exports={percent:function(t,h){for(var p=t.length,l=100/h,e=0;e<p;e++)t[e]*=l},probability:function(t,h){for(var p=t.length,l=0;l<p;l++)t[l]/=h},density:function(t,h,p,l){var e=t.length;l=l||1;for(var o=0;o<e;o++)t[o]*=p[o]*l},"probability density":function(t,h,p,l){var e=t.length;l&&(h/=l);for(var o=0;o<e;o++)t[o]*=p[o]/h}}},{}],1097:[function(n,z,q){"use strict";var t=n("../histogram/attributes"),h=n("../histogram/bin_attributes"),p=n("../heatmap/attributes"),l=n("../../plots/attributes"),e=n("../../plots/template_attributes").hovertemplateAttrs,o=n("../../components/colorscale/attributes"),r=n("../../lib/extend").extendFlat;z.exports=r({x:t.x,y:t.y,z:{valType:"data_array",editType:"calc"},marker:{color:{valType:"data_array",editType:"calc"},editType:"calc"},histnorm:t.histnorm,histfunc:t.histfunc,nbinsx:t.nbinsx,xbins:h("x"),nbinsy:t.nbinsy,ybins:h("y"),autobinx:t.autobinx,autobiny:t.autobiny,bingroup:r({},t.bingroup,{}),xbingroup:r({},t.bingroup,{}),ybingroup:r({},t.bingroup,{}),xgap:p.xgap,ygap:p.ygap,zsmooth:p.zsmooth,zhoverformat:p.zhoverformat,hovertemplate:e({},{keys:"z"}),showlegend:r({},l.showlegend,{dflt:!1})},o("",{cLetter:"z",autoColorDflt:!1}))},{"../../components/colorscale/attributes":650,"../../lib/extend":768,"../../plots/attributes":824,"../../plots/template_attributes":906,"../heatmap/attributes":1065,"../histogram/attributes":1084,"../histogram/bin_attributes":1086}],1098:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../../plots/cartesian/axes"),p=n("../histogram/bin_functions"),l=n("../histogram/norm_functions"),e=n("../histogram/average"),o=n("../histogram/bin_label_vals"),r=n("../histogram/calc").calcAllAutoBins;function i(a,c,f,g){var d,m=new Array(a);if(g)for(d=0;d<a;d++)m[d]=1/(c[d+1]-c[d]);else{var y=1/f;for(d=0;d<a;d++)m[d]=y}return m}function u(a,c){return{start:a(c.start),end:a(c.end),size:c.size}}function s(a,c,f,g,d,m){var y,v=a.length-1,T=new Array(v),w=o(f,g,a,d,m);for(y=0;y<v;y++){var A=(c||[])[y];T[y]=A===void 0?[w(a[y]),w(a[y+1],!0)]:[A,A]}return T}z.exports=function(a,c){var f,g,d,m,y=h.getFromId(a,c.xaxis),v=h.getFromId(a,c.yaxis),T=c.xcalendar,w=c.ycalendar,A=function(be){return y.r2c(be,0,T)},E=function(be){return v.r2c(be,0,w)},M=r(a,c,y,"x"),b=M[0],_=M[1],S=r(a,c,v,"y"),C=S[0],k=S[1],L=c._length;_.length>L&&_.splice(L,_.length-L),k.length>L&&k.splice(L,k.length-L);var I=[],R=[],V=[],O=typeof b.size=="string",J=typeof C.size=="string",D=[],B=[],N=O?D:b,F=J?B:C,H=0,j=[],G=[],W=c.histnorm,Q=c.histfunc,$=W.indexOf("density")!==-1,ee=Q==="max"||Q==="min"?null:0,ie=p.count,ae=l[W],oe=!1,de=[],le=[],fe="z"in c?c.z:"marker"in c&&Array.isArray(c.marker.color)?c.marker.color:"";fe&&Q!=="count"&&(oe=Q==="avg",ie=p[Q]);var ue=b.size,we=A(b.start),Ae=A(b.end)+(we-h.tickIncrement(we,ue,!1,T))/1e6;for(f=we;f<Ae;f=h.tickIncrement(f,ue,!1,T))R.push(ee),D.push(f),oe&&V.push(0);D.push(f);var Se,ke=R.length,Me=(f-we)/ke,ve=(Se=we+Me/2,y.c2r(Se,0,T)),ge=C.size,De=E(C.start),_e=E(C.end)+(De-h.tickIncrement(De,ge,!1,w))/1e6;for(f=De;f<_e;f=h.tickIncrement(f,ge,!1,w)){I.push(R.slice()),B.push(f);var Pe=new Array(ke);for(g=0;g<ke;g++)Pe[g]=[];G.push(Pe),oe&&j.push(V.slice())}B.push(f);var Fe=I.length,ze=(f-De)/Fe,He=function(be){return v.c2r(be,0,w)}(De+ze/2);$&&(de=i(R.length,N,Me,O),le=i(I.length,F,ze,J)),O||y.type!=="date"||(N=u(A,N)),J||v.type!=="date"||(F=u(E,F));var et=!0,Re=!0,Ze=new Array(ke),Ke=new Array(Fe),$e=1/0,rt=1/0,at=1/0,lt=1/0;for(f=0;f<L;f++){var gt=_[f],Ie=k[f];d=t.findBin(gt,N),m=t.findBin(Ie,F),d>=0&&d<ke&&m>=0&&m<Fe&&(H+=ie(d,f,I[m],fe,j[m]),G[m][d].push(f),et&&(Ze[d]===void 0?Ze[d]=gt:Ze[d]!==gt&&(et=!1)),Re&&(Ke[m]===void 0?Ke[m]=Ie:Ke[m]!==Ie&&(Re=!1)),$e=Math.min($e,gt-D[d]),rt=Math.min(rt,D[d+1]-gt),at=Math.min(at,Ie-B[m]),lt=Math.min(lt,B[m+1]-Ie))}if(oe)for(m=0;m<Fe;m++)H+=e(I[m],j[m]);if(ae)for(m=0;m<Fe;m++)ae(I[m],H,de,le[m]);return{x:_,xRanges:s(D,et&&Ze,$e,rt,y,T),x0:ve,dx:Me,y:k,yRanges:s(B,Re&&Ke,at,lt,v,w),y0:He,dy:ze,z:I,pts:G}}},{"../../lib":778,"../../plots/cartesian/axes":828,"../histogram/average":1085,"../histogram/bin_functions":1087,"../histogram/bin_label_vals":1088,"../histogram/calc":1089,"../histogram/norm_functions":1096}],1099:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("./sample_defaults"),p=n("../heatmap/style_defaults"),l=n("../../components/colorscale/defaults"),e=n("./attributes");z.exports=function(o,r,i,u){function s(a,c){return t.coerce(o,r,e,a,c)}h(o,r,s,u),r.visible!==!1&&(p(o,r,s,u),l(o,r,u,s,{prefix:"",cLetter:"z"}),s("hovertemplate"))}},{"../../components/colorscale/defaults":653,"../../lib":778,"../heatmap/style_defaults":1078,"./attributes":1097,"./sample_defaults":1102}],1100:[function(n,z,q){"use strict";var t=n("../heatmap/hover"),h=n("../../plots/cartesian/axes").hoverLabelText;z.exports=function(p,l,e,o,r,i){var u=t(p,l,e,o,r,i);if(u){var s=(p=u[0]).index,a=s[0],c=s[1],f=p.cd[0],g=f.xRanges[c],d=f.yRanges[a];return p.xLabel=h(p.xa,g[0],g[1]),p.yLabel=h(p.ya,d[0],d[1]),u}}},{"../../plots/cartesian/axes":828,"../heatmap/hover":1072}],1101:[function(n,z,q){"use strict";z.exports={attributes:n("./attributes"),supplyDefaults:n("./defaults"),crossTraceDefaults:n("../histogram/cross_trace_defaults"),calc:n("../heatmap/calc"),plot:n("../heatmap/plot"),layerName:"heatmaplayer",colorbar:n("../heatmap/colorbar"),style:n("../heatmap/style"),hoverPoints:n("./hover"),eventData:n("../histogram/event_data"),moduleType:"trace",name:"histogram2d",basePlotModule:n("../../plots/cartesian"),categories:["cartesian","svg","2dMap","histogram","showLegend"],meta:{}}},{"../../plots/cartesian":841,"../heatmap/calc":1066,"../heatmap/colorbar":1068,"../heatmap/plot":1076,"../heatmap/style":1077,"../histogram/cross_trace_defaults":1091,"../histogram/event_data":1093,"./attributes":1097,"./defaults":1099,"./hover":1100}],1102:[function(n,z,q){"use strict";var t=n("../../registry"),h=n("../../lib");z.exports=function(p,l,e,o){var r=e("x"),i=e("y"),u=h.minRowLength(r),s=h.minRowLength(i);u&&s?(l._length=Math.min(u,s),t.getComponentMethod("calendars","handleTraceDefaults")(p,l,["x","y"],o),(e("z")||e("marker.color"))&&e("histfunc"),e("histnorm"),e("autobinx"),e("autobiny")):l.visible=!1}},{"../../lib":778,"../../registry":911}],1103:[function(n,z,q){"use strict";var t=n("../histogram2d/attributes"),h=n("../contour/attributes"),p=n("../../components/colorscale/attributes"),l=n("../../lib/extend").extendFlat;z.exports=l({x:t.x,y:t.y,z:t.z,marker:t.marker,histnorm:t.histnorm,histfunc:t.histfunc,nbinsx:t.nbinsx,xbins:t.xbins,nbinsy:t.nbinsy,ybins:t.ybins,autobinx:t.autobinx,autobiny:t.autobiny,bingroup:t.bingroup,xbingroup:t.xbingroup,ybingroup:t.ybingroup,autocontour:h.autocontour,ncontours:h.ncontours,contours:h.contours,line:{color:h.line.color,width:l({},h.line.width,{dflt:.5}),dash:h.line.dash,smoothing:h.line.smoothing,editType:"plot"},zhoverformat:t.zhoverformat,hovertemplate:t.hovertemplate},p("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":650,"../../lib/extend":768,"../contour/attributes":1008,"../histogram2d/attributes":1097}],1104:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../histogram2d/sample_defaults"),p=n("../contour/contours_defaults"),l=n("../contour/style_defaults"),e=n("./attributes");z.exports=function(o,r,i,u){function s(a,c){return t.coerce(o,r,e,a,c)}h(o,r,s,u),r.visible!==!1&&(p(o,r,s,function(a){return t.coerce2(o,r,e,a)}),l(o,r,s,u),s("hovertemplate"))}},{"../../lib":778,"../contour/contours_defaults":1015,"../contour/style_defaults":1029,"../histogram2d/sample_defaults":1102,"./attributes":1103}],1105:[function(n,z,q){"use strict";z.exports={attributes:n("./attributes"),supplyDefaults:n("./defaults"),crossTraceDefaults:n("../histogram/cross_trace_defaults"),calc:n("../contour/calc"),plot:n("../contour/plot").plot,layerName:"contourlayer",style:n("../contour/style"),colorbar:n("../contour/colorbar"),hoverPoints:n("../contour/hover"),moduleType:"trace",name:"histogram2dcontour",basePlotModule:n("../../plots/cartesian"),categories:["cartesian","svg","2dMap","contour","histogram","showLegend"],meta:{}}},{"../../plots/cartesian":841,"../contour/calc":1009,"../contour/colorbar":1011,"../contour/hover":1021,"../contour/plot":1026,"../contour/style":1028,"../histogram/cross_trace_defaults":1091,"./attributes":1103,"./defaults":1104}],1106:[function(n,z,q){"use strict";for(var t=n("../../plots/attributes"),h=n("../../plots/template_attributes").hovertemplateAttrs,p=n("../../lib/extend").extendFlat,l=n("./constants").colormodel,e=["rgb","rgba","rgba256","hsl","hsla"],o=[],r=[],i=0;i<e.length;i++){var u=l[e[i]];o.push("For the `"+e[i]+"` colormodel, it is ["+(u.zminDflt||u.min).join(", ")+"]."),r.push("For the `"+e[i]+"` colormodel, it is ["+(u.zmaxDflt||u.max).join(", ")+"].")}z.exports=p({source:{valType:"string",editType:"calc"},z:{valType:"data_array",editType:"calc"},colormodel:{valType:"enumerated",values:e,editType:"calc"},zmin:{valType:"info_array",items:[{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"}],editType:"calc"},zmax:{valType:"info_array",items:[{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"}],editType:"calc"},x0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},y0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dx:{valType:"number",dflt:1,editType:"calc"},dy:{valType:"number",dflt:1,editType:"calc"},text:{valType:"data_array",editType:"plot"},hovertext:{valType:"data_array",editType:"plot"},hoverinfo:p({},t.hoverinfo,{flags:["x","y","z","color","name","text"],dflt:"x+y+z+text+name"}),hovertemplate:h({},{keys:["z","color","colormodel"]}),transforms:void 0})},{"../../lib/extend":768,"../../plots/attributes":824,"../../plots/template_attributes":906,"./constants":1108}],1107:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("./constants"),p=n("fast-isnumeric"),l=n("../../plots/cartesian/axes"),e=n("../../lib").maxRowLength,o=n("./helpers").getImageSize;function r(u,s,a,c){return function(f){return t.constrain((f-u)*s,a,c)}}function i(u,s){return function(a){return t.constrain(a,u,s)}}z.exports=function(u,s){var a,c;if(s._hasZ)a=s.z.length,c=e(s.z);else if(s._hasSource){var f=o(s.source);a=f.height,c=f.width}var g,d=l.getFromId(u,s.xaxis||"x"),m=l.getFromId(u,s.yaxis||"y"),y=d.d2c(s.x0)-s.dx/2,v=m.d2c(s.y0)-s.dy/2,T=[y,y+c*s.dx],w=[v,v+a*s.dy];if(d&&d.type==="log")for(g=0;g<c;g++)T.push(y+g*s.dx);if(m&&m.type==="log")for(g=0;g<a;g++)w.push(v+g*s.dy);return s._extremes[d._id]=l.findExtremes(d,T),s._extremes[m._id]=l.findExtremes(m,w),s._scaler=function(A){var E=h.colormodel[A.colormodel],M=(E.colormodel||A.colormodel).length;A._sArray=[];for(var b=0;b<M;b++)E.min[b]!==A.zmin[b]||E.max[b]!==A.zmax[b]?A._sArray.push(r(A.zmin[b],(E.max[b]-E.min[b])/(A.zmax[b]-A.zmin[b]),E.min[b],E.max[b])):A._sArray.push(i(E.min[b],E.max[b]));return function(_){for(var S=_.slice(0,M),C=0;C<M;C++){var k=S[C];if(!p(k))return!1;S[C]=A._sArray[C](k)}return S}}(s),[{x0:y,y0:v,z:s.z,w:c,h:a}]}},{"../../lib":778,"../../plots/cartesian/axes":828,"./constants":1108,"./helpers":1111,"fast-isnumeric":241}],1108:[function(n,z,q){"use strict";z.exports={colormodel:{rgb:{min:[0,0,0],max:[255,255,255],fmt:function(t){return t.slice(0,3)},suffix:["","",""]},rgba:{min:[0,0,0,0],max:[255,255,255,1],fmt:function(t){return t.slice(0,4)},suffix:["","","",""]},rgba256:{colormodel:"rgba",zminDflt:[0,0,0,0],zmaxDflt:[255,255,255,255],min:[0,0,0,0],max:[255,255,255,1],fmt:function(t){return t.slice(0,4)},suffix:["","","",""]},hsl:{min:[0,0,0],max:[360,100,100],fmt:function(t){var h=t.slice(0,3);return h[1]=h[1]+"%",h[2]=h[2]+"%",h},suffix:["\xB0","%","%"]},hsla:{min:[0,0,0,0],max:[360,100,100,1],fmt:function(t){var h=t.slice(0,4);return h[1]=h[1]+"%",h[2]=h[2]+"%",h},suffix:["\xB0","%","%",""]}}}},{}],1109:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("./attributes"),p=n("./constants"),l=n("../../snapshot/helpers").IMAGE_URL_PREFIX;z.exports=function(e,o){function r(s,a){return t.coerce(e,o,h,s,a)}r("source"),o.source&&!o.source.match(l)&&delete o.source,o._hasSource=!!o.source;var i,u=r("z");o._hasZ=!(u===void 0||!u.length||!u[0]||!u[0].length),o._hasZ||o._hasSource?(r("x0"),r("y0"),r("dx"),r("dy"),o._hasZ?(r("colormodel","rgb"),r("zmin",(i=p.colormodel[o.colormodel]).zminDflt||i.min),r("zmax",i.zmaxDflt||i.max)):o._hasSource&&(o.colormodel="rgba256",i=p.colormodel[o.colormodel],o.zmin=i.zminDflt,o.zmax=i.zmaxDflt),r("text"),r("hovertext"),r("hovertemplate"),o._length=null):o.visible=!1}},{"../../lib":778,"../../snapshot/helpers":915,"./attributes":1106,"./constants":1108}],1110:[function(n,z,q){"use strict";z.exports=function(t,h){return"xVal"in h&&(t.x=h.xVal),"yVal"in h&&(t.y=h.yVal),h.xa&&(t.xaxis=h.xa),h.ya&&(t.yaxis=h.ya),t.color=h.color,t.colormodel=h.trace.colormodel,t.z||(t.z=h.color),t}},{}],1111:[function(n,z,q){"use strict";var t=n("image-size"),h=n("../../snapshot/helpers").IMAGE_URL_PREFIX,p=n("buffer/").Buffer;q.getImageSize=function(l){var e=l.replace(h,""),o=new p(e,"base64");return t(o)}},{"../../snapshot/helpers":915,"buffer/":111,"image-size":444}],1112:[function(n,z,q){"use strict";var t=n("../../components/fx"),h=n("../../lib"),p=n("./constants");z.exports=function(l,e,o){var r=l.cd[0],i=r.trace,u=l.xa,s=l.ya;if(!(t.inbox(e-r.x0,e-(r.x0+r.w*i.dx),0)>0||t.inbox(o-r.y0,o-(r.y0+r.h*i.dy),0)>0)){var a,c=Math.floor((e-r.x0)/i.dx),f=Math.floor(Math.abs(o-r.y0)/i.dy);if(i._hasZ?a=r.z[f][c]:i._hasSource&&(a=i._canvas.el.getContext("2d").getImageData(c,f,1,1).data),a){var g,d=r.hi||i.hoverinfo;if(d){var m=d.split("+");m.indexOf("all")!==-1&&(m=["color"]),m.indexOf("color")!==-1&&(g=!0)}var y,v=p.colormodel[i.colormodel],T=v.colormodel||i.colormodel,w=T.length,A=i._scaler(a),E=v.suffix,M=[];(i.hovertemplate||g)&&(M.push("["+[A[0]+E[0],A[1]+E[1],A[2]+E[2]].join(", ")),w===4&&M.push(", "+A[3]+E[3]),M.push("]"),M=M.join(""),l.extraText=T.toUpperCase()+": "+M),Array.isArray(i.hovertext)&&Array.isArray(i.hovertext[f])?y=i.hovertext[f][c]:Array.isArray(i.text)&&Array.isArray(i.text[f])&&(y=i.text[f][c]);var b=s.c2p(r.y0+(f+.5)*i.dy),_=r.x0+(c+.5)*i.dx,S=r.y0+(f+.5)*i.dy,C="["+a.slice(0,i.colormodel.length).join(", ")+"]";return[h.extendFlat(l,{index:[f,c],x0:u.c2p(r.x0+c*i.dx),x1:u.c2p(r.x0+(c+1)*i.dx),y0:b,y1:b,color:A,xVal:_,xLabelVal:_,yVal:S,yLabelVal:S,zLabelVal:C,text:y,hovertemplateLabels:{zLabel:C,colorLabel:M,"color[0]Label":A[0]+E[0],"color[1]Label":A[1]+E[1],"color[2]Label":A[2]+E[2],"color[3]Label":A[3]+E[3]}})]}}}},{"../../components/fx":683,"../../lib":778,"./constants":1108}],1113:[function(n,z,q){"use strict";z.exports={attributes:n("./attributes"),supplyDefaults:n("./defaults"),calc:n("./calc"),plot:n("./plot"),style:n("./style"),hoverPoints:n("./hover"),eventData:n("./event_data"),moduleType:"trace",name:"image",basePlotModule:n("../../plots/cartesian"),categories:["cartesian","svg","2dMap","noSortingByValue"],animatable:!1,meta:{}}},{"../../plots/cartesian":841,"./attributes":1106,"./calc":1107,"./defaults":1109,"./event_data":1110,"./hover":1112,"./plot":1114,"./style":1115}],1114:[function(n,z,q){"use strict";var t=n("d3"),h=n("../../lib"),p=h.strTranslate,l=n("../../constants/xmlns_namespaces"),e=n("./constants"),o=h.isIOS()||h.isSafari()||h.isIE();z.exports=function(r,i,u,s){var a=i.xaxis,c=i.yaxis,f=!(o||r._context._exportedPlot);h.makeTraceGroups(s,u,"im").each(function(g){var d=t.select(this),m=g[0],y=m.trace,v=f&&!y._hasZ&&y._hasSource&&a.type==="linear"&&c.type==="linear";y._fastImage=v;var T,w,A,E,M,b,_=m.z,S=m.x0,C=m.y0,k=m.w,L=m.h,I=y.dx,R=y.dy;for(b=0;T===void 0&&b<k;)T=a.c2p(S+b*I),b++;for(b=k;w===void 0&&b>0;)w=a.c2p(S+b*I),b--;for(b=0;E===void 0&&b<L;)E=c.c2p(C+b*R),b++;for(b=L;M===void 0&&b>0;)M=c.c2p(C+b*R),b--;w<T&&(A=w,w=T,T=A),M<E&&(A=E,E=M,M=A),!v&&(T=Math.max(-.5*a._length,T),w=Math.min(1.5*a._length,w),E=Math.max(-.5*c._length,E),M=Math.min(1.5*c._length,M));var V=Math.round(w-T),O=Math.round(M-E);if(V<=0||O<=0)d.selectAll("image").data([]).exit().remove();else{var J=d.selectAll("image").data([g]);J.enter().append("svg:image").attr({xmlns:l.svg,preserveAspectRatio:"none"}),J.exit().remove();var D="image-rendering: optimizeSpeed; image-rendering: -moz-crisp-edges; image-rendering: -o-crisp-edges; image-rendering: -webkit-optimize-contrast; image-rendering: optimize-contrast; image-rendering: crisp-edges; image-rendering: pixelated;";if(v){var B=h.simpleMap(a.range,a.r2l),N=h.simpleMap(c.range,c.r2l),F=B[1]<B[0],H=N[1]>N[0];if(F||H){var j=T+V/2,G=E+O/2;D+="transform:"+p(j+"px",G+"px")+"scale("+(F?-1:1)+","+(H?-1:1)+")"+p(-j+"px",-G+"px")+";"}}J.attr("style",D);var W=new Promise(function($){if(y._hasZ)$();else if(y._hasSource)if(y._canvas&&y._canvas.el.width===k&&y._canvas.el.height===L&&y._canvas.source===y.source)$();else{var ee=document.createElement("canvas");ee.width=k,ee.height=L;var ie=ee.getContext("2d");y._image=y._image||new Image;var ae=y._image;ae.onload=function(){ie.drawImage(ae,0,0),y._canvas={el:ee,source:y.source},$()},ae.setAttribute("src",y.source)}}).then(function(){var $;if(y._hasZ)$=Q(function(ie,ae){return _[ae][ie]}).toDataURL("image/png");else if(y._hasSource)if(v)$=y.source;else{var ee=y._canvas.el.getContext("2d").getImageData(0,0,k,L).data;$=Q(function(ie,ae){var oe=4*(ae*k+ie);return[ee[oe],ee[oe+1],ee[oe+2],ee[oe+3]]}).toDataURL("image/png")}J.attr({"xlink:href":$,height:O,width:V,x:T,y:E})});r._promises.push(W)}function Q($){var ee=document.createElement("canvas");ee.width=V,ee.height=O;var ie,ae=ee.getContext("2d"),oe=function(ve){return h.constrain(Math.round(a.c2p(S+ve*I)-T),0,V)},de=function(ve){return h.constrain(Math.round(c.c2p(C+ve*R)-E),0,O)},le=e.colormodel[y.colormodel],fe=le.colormodel||y.colormodel,ue=le.fmt;for(b=0;b<m.w;b++){var we=oe(b),Ae=oe(b+1);if(Ae!==we&&!isNaN(Ae)&&!isNaN(we))for(var Se=0;Se<m.h;Se++){var ke=de(Se),Me=de(Se+1);Me===ke||isNaN(Me)||isNaN(ke)||!$(b,Se)||(ie=y._scaler($(b,Se)),ae.fillStyle=ie?fe+"("+ue(ie).join(",")+")":"rgba(0,0,0,0)",ae.fillRect(we,ke,Ae-we,Me-ke))}}return ee}})}},{"../../constants/xmlns_namespaces":754,"../../lib":778,"./constants":1108,d3:169}],1115:[function(n,z,q){"use strict";var t=n("d3");z.exports=function(h){t.select(h).selectAll(".im image").style("opacity",function(p){return p[0].trace.opacity})}},{d3:169}],1116:[function(n,z,q){"use strict";var t=n("../../lib/extend").extendFlat,h=n("../../lib/extend").extendDeep,p=n("../../plot_api/edit_types").overrideAll,l=n("../../plots/font_attributes"),e=n("../../components/color/attributes"),o=n("../../plots/domain").attributes,r=n("../../plots/cartesian/layout_attributes"),i=n("../../plot_api/plot_template").templatedArray,u=n("../../constants/delta.js"),s=(n("../../constants/docs").FORMAT_LINK,l({editType:"plot",colorEditType:"plot"})),a={color:{valType:"color",editType:"plot"},line:{color:{valType:"color",dflt:e.defaultLine,editType:"plot"},width:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"calc"},thickness:{valType:"number",min:0,max:1,dflt:1,editType:"plot"},editType:"calc"},c={valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],editType:"plot"},f=i("step",h({},a,{range:c}));z.exports={mode:{valType:"flaglist",editType:"calc",flags:["number","delta","gauge"],dflt:"number"},value:{valType:"number",editType:"calc",anim:!0},align:{valType:"enumerated",values:["left","center","right"],editType:"plot"},domain:o({name:"indicator",trace:!0,editType:"calc"}),title:{text:{valType:"string",editType:"plot"},align:{valType:"enumerated",values:["left","center","right"],editType:"plot"},font:t({},s,{}),editType:"plot"},number:{valueformat:{valType:"string",dflt:"",editType:"plot"},font:t({},s,{}),prefix:{valType:"string",dflt:"",editType:"plot"},suffix:{valType:"string",dflt:"",editType:"plot"},editType:"plot"},delta:{reference:{valType:"number",editType:"calc"},position:{valType:"enumerated",values:["top","bottom","left","right"],dflt:"bottom",editType:"plot"},relative:{valType:"boolean",editType:"plot",dflt:!1},valueformat:{valType:"string",editType:"plot"},increasing:{symbol:{valType:"string",dflt:u.INCREASING.SYMBOL,editType:"plot"},color:{valType:"color",dflt:u.INCREASING.COLOR,editType:"plot"},editType:"plot"},decreasing:{symbol:{valType:"string",dflt:u.DECREASING.SYMBOL,editType:"plot"},color:{valType:"color",dflt:u.DECREASING.COLOR,editType:"plot"},editType:"plot"},font:t({},s,{}),editType:"calc"},gauge:{shape:{valType:"enumerated",editType:"plot",dflt:"angular",values:["angular","bullet"]},bar:h({},a,{color:{dflt:"green"}}),bgcolor:{valType:"color",editType:"plot"},bordercolor:{valType:"color",dflt:e.defaultLine,editType:"plot"},borderwidth:{valType:"number",min:0,dflt:1,editType:"plot"},axis:p({range:c,visible:t({},r.visible,{dflt:!0}),tickmode:r.tickmode,nticks:r.nticks,tick0:r.tick0,dtick:r.dtick,tickvals:r.tickvals,ticktext:r.ticktext,ticks:t({},r.ticks,{dflt:"outside"}),ticklen:r.ticklen,tickwidth:r.tickwidth,tickcolor:r.tickcolor,showticklabels:r.showticklabels,tickfont:l({}),tickangle:r.tickangle,tickformat:r.tickformat,tickformatstops:r.tickformatstops,tickprefix:r.tickprefix,showtickprefix:r.showtickprefix,ticksuffix:r.ticksuffix,showticksuffix:r.showticksuffix,separatethousands:r.separatethousands,exponentformat:r.exponentformat,minexponent:r.minexponent,showexponent:r.showexponent,editType:"plot"},"plot"),steps:f,threshold:{line:{color:t({},a.line.color,{}),width:t({},a.line.width,{dflt:1}),editType:"plot"},thickness:t({},a.thickness,{dflt:.85}),value:{valType:"number",editType:"calc",dflt:!1},editType:"plot"},editType:"plot"}}},{"../../components/color/attributes":642,"../../constants/delta.js":747,"../../constants/docs":748,"../../lib/extend":768,"../../plot_api/edit_types":810,"../../plot_api/plot_template":817,"../../plots/cartesian/layout_attributes":842,"../../plots/domain":855,"../../plots/font_attributes":856}],1117:[function(n,z,q){"use strict";var t=n("../../plots/plots");q.name="indicator",q.plot=function(h,p,l,e){t.plotBasePlot(q.name,h,p,l,e)},q.clean=function(h,p,l,e){t.cleanBasePlot(q.name,h,p,l,e)}},{"../../plots/plots":891}],1118:[function(n,z,q){"use strict";z.exports={calc:function(t,h){var p=[],l=h.value;typeof h._lastValue!="number"&&(h._lastValue=h.value);var e=h._lastValue,o=e;return h._hasDelta&&typeof h.delta.reference=="number"&&(o=h.delta.reference),p[0]={y:l,lastY:e,delta:l-o,relativeDelta:(l-o)/o},p}}},{}],1119:[function(n,z,q){"use strict";z.exports={defaultNumberFontSize:80,bulletNumberDomainSize:.25,bulletPadding:.025,innerRadius:.75,valueThickness:.5,titlePadding:5,horizontalPadding:10}},{}],1120:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("./attributes"),p=n("../../plots/domain").defaults,l=n("../../plot_api/plot_template"),e=n("../../plots/array_container_defaults"),o=n("./constants.js"),r=n("../../plots/cartesian/tick_value_defaults"),i=n("../../plots/cartesian/tick_mark_defaults"),u=n("../../plots/cartesian/tick_label_defaults");function s(a,c){function f(g,d){return t.coerce(a,c,h.gauge.steps,g,d)}f("color"),f("line.color"),f("line.width"),f("range"),f("thickness")}z.exports={supplyDefaults:function(a,c,f,g){function d(C,k){return t.coerce(a,c,h,C,k)}p(c,g,d),d("mode"),c._hasNumber=c.mode.indexOf("number")!==-1,c._hasDelta=c.mode.indexOf("delta")!==-1,c._hasGauge=c.mode.indexOf("gauge")!==-1;var m=d("value");c._range=[0,typeof m=="number"?1.5*m:1];var y,v,T,w,A,E,M=new Array(2);function b(C,k){return t.coerce(T,w,h.gauge,C,k)}function _(C,k){return t.coerce(A,E,h.gauge.axis,C,k)}if(c._hasNumber&&(d("number.valueformat"),d("number.font.color",g.font.color),d("number.font.family",g.font.family),d("number.font.size"),c.number.font.size===void 0&&(c.number.font.size=o.defaultNumberFontSize,M[0]=!0),d("number.prefix"),d("number.suffix"),y=c.number.font.size),c._hasDelta&&(d("delta.font.color",g.font.color),d("delta.font.family",g.font.family),d("delta.font.size"),c.delta.font.size===void 0&&(c.delta.font.size=(c._hasNumber?.5:1)*(y||o.defaultNumberFontSize),M[1]=!0),d("delta.reference",c.value),d("delta.relative"),d("delta.valueformat",c.delta.relative?"2%":""),d("delta.increasing.symbol"),d("delta.increasing.color"),d("delta.decreasing.symbol"),d("delta.decreasing.color"),d("delta.position"),v=c.delta.font.size),c._scaleNumbers=(!c._hasNumber||M[0])&&(!c._hasDelta||M[1])||!1,d("title.font.color",g.font.color),d("title.font.family",g.font.family),d("title.font.size",.25*(y||v||o.defaultNumberFontSize)),d("title.text"),c._hasGauge){(T=a.gauge)||(T={}),w=l.newContainer(c,"gauge"),b("shape"),(c._isBullet=c.gauge.shape==="bullet")||d("title.align","center"),(c._isAngular=c.gauge.shape==="angular")||d("align","center"),b("bgcolor",g.paper_bgcolor),b("borderwidth"),b("bordercolor"),b("bar.color"),b("bar.line.color"),b("bar.line.width"),b("bar.thickness",o.valueThickness*(c.gauge.shape==="bullet"?.5:1)),e(T,w,{name:"steps",handleItemDefaults:s}),b("threshold.value"),b("threshold.thickness"),b("threshold.line.width"),b("threshold.line.color"),A={},T&&(A=T.axis||{}),E=l.newContainer(w,"axis"),_("visible"),c._range=_("range",c._range);var S={outerTicks:!0};r(A,E,_,"linear"),u(A,E,_,"linear",S),i(A,E,_,S)}else d("title.align","center"),d("align","center"),c._isAngular=c._isBullet=!1;c._length=null}}},{"../../lib":778,"../../plot_api/plot_template":817,"../../plots/array_container_defaults":823,"../../plots/cartesian/tick_label_defaults":849,"../../plots/cartesian/tick_mark_defaults":850,"../../plots/cartesian/tick_value_defaults":851,"../../plots/domain":855,"./attributes":1116,"./constants.js":1119}],1121:[function(n,z,q){"use strict";z.exports={moduleType:"trace",name:"indicator",basePlotModule:n("./base_plot"),categories:["svg","noOpacity","noHover"],animatable:!0,attributes:n("./attributes"),supplyDefaults:n("./defaults").supplyDefaults,calc:n("./calc").calc,plot:n("./plot"),meta:{}}},{"./attributes":1116,"./base_plot":1117,"./calc":1118,"./defaults":1120,"./plot":1122}],1122:[function(n,z,q){"use strict";var t=n("d3"),h=n("../../lib"),p=h.strScale,l=h.strTranslate,e=h.rad2deg,o=n("../../constants/alignment").MID_SHIFT,r=n("../../components/drawing"),i=n("./constants"),u=n("../../lib/svg_text_utils"),s=n("../../plots/cartesian/axes"),a=n("../../plots/cartesian/axis_defaults"),c=n("../../plots/cartesian/position_defaults"),f=n("../../plots/cartesian/layout_attributes"),g=n("../../components/color"),d={left:"start",center:"middle",right:"end"},m={left:0,center:.5,right:1},y=/[yzafpn\xb5mkMGTPEZY]/;function v(b){return b&&b.duration>0}function T(b){b.each(function(_){g.stroke(t.select(this),_.line.color)}).each(function(_){g.fill(t.select(this),_.color)}).style("stroke-width",function(_){return _.line.width})}function w(b,_,S){var C=b._fullLayout,k=h.extendFlat({type:"linear",ticks:"outside",range:S,showline:!0},_),L={type:"linear",_id:"x"+_._id},I={letter:"x",font:C.font,noHover:!0,noTickson:!0};function R(V,O){return h.coerce(k,L,f,V,O)}return a(k,L,R,I,C),c(k,L,R,I),L}function A(b,_,S){return[Math.min(_/b.width,S/b.height),b,_+"x"+S]}function E(b,_,S,C){var k=document.createElementNS("http://www.w3.org/2000/svg","text"),L=t.select(k);return L.text(b).attr("x",0).attr("y",0).attr("text-anchor",S).attr("data-unformatted",b).call(u.convertToTspans,C).call(r.font,_),r.bBox(L.node())}function M(b,_,S,C,k,L){var I="_cache"+_;b[I]&&b[I].key===k||(b[I]={key:k,value:S});var R=h.aggNums(L,null,[b[I].value,C],2);return b[I].value=R,R}z.exports=function(b,_,S,C){var k,L=b._fullLayout;v(S)&&C&&(k=C()),h.makeTraceGroups(L._indicatorlayer,_,"trace").each(function(I){var R,V,O,J,D,B=I[0].trace,N=t.select(this),F=B._hasGauge,H=B._isAngular,j=B._isBullet,G=B.domain,W={w:L._size.w*(G.x[1]-G.x[0]),h:L._size.h*(G.y[1]-G.y[0]),l:L._size.l+L._size.w*G.x[0],r:L._size.r+L._size.w*(1-G.x[1]),t:L._size.t+L._size.h*(1-G.y[1]),b:L._size.b+L._size.h*G.y[0]},Q=W.l+W.w/2,$=W.t+W.h/2,ee=Math.min(W.w/2,W.h),ie=i.innerRadius*ee,ae=B.align||"center";if(V=$,F){if(H&&(R=Q,V=$+ee/2,O=function(Se){return function(ke,Me){var ve=Math.sqrt(ke.width/2*(ke.width/2)+ke.height*ke.height);return[Me/ve,ke,Me]}(Se,.9*ie)}),j){var oe=i.bulletPadding,de=1-i.bulletNumberDomainSize+oe;R=W.l+(de+(1-de)*m[ae])*W.w,O=function(Se){return A(Se,(i.bulletNumberDomainSize-oe)*W.w,W.h)}}}else R=W.l+m[ae]*W.w,O=function(Se){return A(Se,W.w,W.h)};(function(Se,ke,Me,ve){var ge,De,_e,Pe=Me[0].trace,Fe=ve.numbersX,ze=ve.numbersY,He=Pe.align||"center",et=d[He],Re=ve.transitionOpts,Ze=ve.onComplete,Ke=h.ensureSingle(ke,"g","numbers"),$e=[];Pe._hasNumber&&$e.push("number"),Pe._hasDelta&&($e.push("delta"),Pe.delta.position==="left"&&$e.reverse());var rt=Ke.selectAll("text").data($e);function at(ot,Ce,Ue,Ye){if(!ot.match("s")||Ue>=0==Ye>=0||Ce(Ue).slice(-1).match(y)||Ce(Ye).slice(-1).match(y))return Ce;var xe=ot.slice().replace("s","f").replace(/\d+/,function(Je){return parseInt(Je)-1}),Ee=w(Se,{tickformat:xe});return function(Je){return Math.abs(Je)<1?s.tickText(Ee,Je).text:Ce(Je)}}rt.enter().append("text"),rt.attr("text-anchor",function(){return et}).attr("class",function(ot){return ot}).attr("x",null).attr("y",null).attr("dx",null).attr("dy",null),rt.exit().remove();var lt,gt=Pe.mode+Pe.align;if(Pe._hasDelta&&(lt=function(){var ot=w(Se,{tickformat:Pe.delta.valueformat},Pe._range);ot.setScale(),s.prepTicks(ot);var Ce=function(it){return s.tickText(ot,it).text},Ue=function(it){return Pe.delta.relative?it.relativeDelta:it.delta},Ye=function(it,ht){return it===0||typeof it!="number"||isNaN(it)?"-":(it>0?Pe.delta.increasing.symbol:Pe.delta.decreasing.symbol)+ht(it)},xe=function(it){return it.delta>=0?Pe.delta.increasing.color:Pe.delta.decreasing.color};Pe._deltaLastValue===void 0&&(Pe._deltaLastValue=Ue(Me[0]));var Ee=Ke.select("text.delta");function Je(){Ee.text(Ye(Ue(Me[0]),Ce)).call(g.fill,xe(Me[0])).call(u.convertToTspans,Se)}return Ee.call(r.font,Pe.delta.font).call(g.fill,xe({delta:Pe._deltaLastValue})),v(Re)?Ee.transition().duration(Re.duration).ease(Re.easing).tween("text",function(){var it=t.select(this),ht=Ue(Me[0]),ct=Pe._deltaLastValue,mt=at(Pe.delta.valueformat,Ce,ct,ht),bt=t.interpolateNumber(ct,ht);return Pe._deltaLastValue=ht,function(Et){it.text(Ye(bt(Et),mt)),it.call(g.fill,xe({delta:bt(Et)}))}}).each("end",function(){Je(),Ze&&Ze()}).each("interrupt",function(){Je(),Ze&&Ze()}):Je(),De=E(Ye(Ue(Me[0]),Ce),Pe.delta.font,et,Se),Ee}(),gt+=Pe.delta.position+Pe.delta.font.size+Pe.delta.font.family+Pe.delta.valueformat,gt+=Pe.delta.increasing.symbol+Pe.delta.decreasing.symbol,_e=De),Pe._hasNumber&&(function(){var ot=w(Se,{tickformat:Pe.number.valueformat},Pe._range);ot.setScale(),s.prepTicks(ot);var Ce=function(Je){return s.tickText(ot,Je).text},Ue=Pe.number.suffix,Ye=Pe.number.prefix,xe=Ke.select("text.number");function Ee(){var Je=typeof Me[0].y=="number"?Ye+Ce(Me[0].y)+Ue:"-";xe.text(Je).call(r.font,Pe.number.font).call(u.convertToTspans,Se)}v(Re)?xe.transition().duration(Re.duration).ease(Re.easing).each("end",function(){Ee(),Ze&&Ze()}).each("interrupt",function(){Ee(),Ze&&Ze()}).attrTween("text",function(){var Je=t.select(this),it=t.interpolateNumber(Me[0].lastY,Me[0].y);Pe._lastValue=Me[0].y;var ht=at(Pe.number.valueformat,Ce,Me[0].lastY,Me[0].y);return function(ct){Je.text(Ye+ht(it(ct))+Ue)}}):Ee(),ge=E(Ye+Ce(Me[0].y)+Ue,Pe.number.font,et,Se)}(),gt+=Pe.number.font.size+Pe.number.font.family+Pe.number.valueformat+Pe.number.suffix+Pe.number.prefix,_e=ge),Pe._hasDelta&&Pe._hasNumber){var Ie,be,We=[(ge.left+ge.right)/2,(ge.top+ge.bottom)/2],Ge=[(De.left+De.right)/2,(De.top+De.bottom)/2],st=.75*Pe.delta.font.size;Pe.delta.position==="left"&&(Ie=M(Pe,"deltaPos",0,-1*(ge.width*m[Pe.align]+De.width*(1-m[Pe.align])+st),gt,Math.min),be=We[1]-Ge[1],_e={width:ge.width+De.width+st,height:Math.max(ge.height,De.height),left:De.left+Ie,right:ge.right,top:Math.min(ge.top,De.top+be),bottom:Math.max(ge.bottom,De.bottom+be)}),Pe.delta.position==="right"&&(Ie=M(Pe,"deltaPos",0,ge.width*(1-m[Pe.align])+De.width*m[Pe.align]+st,gt,Math.max),be=We[1]-Ge[1],_e={width:ge.width+De.width+st,height:Math.max(ge.height,De.height),left:ge.left,right:De.right+Ie,top:Math.min(ge.top,De.top+be),bottom:Math.max(ge.bottom,De.bottom+be)}),Pe.delta.position==="bottom"&&(Ie=null,be=De.height,_e={width:Math.max(ge.width,De.width),height:ge.height+De.height,left:Math.min(ge.left,De.left),right:Math.max(ge.right,De.right),top:ge.bottom-ge.height,bottom:ge.bottom+De.height}),Pe.delta.position==="top"&&(Ie=null,be=ge.top,_e={width:Math.max(ge.width,De.width),height:ge.height+De.height,left:Math.min(ge.left,De.left),right:Math.max(ge.right,De.right),top:ge.bottom-ge.height-De.height,bottom:ge.bottom}),lt.attr({dx:Ie,dy:be})}(Pe._hasNumber||Pe._hasDelta)&&Ke.attr("transform",function(){var ot=ve.numbersScaler(_e);gt+=ot[2];var Ce,Ue=M(Pe,"numbersScale",1,ot[0],gt,Math.min);Pe._scaleNumbers||(Ue=1),Ce=Pe._isAngular?ze-Ue*_e.bottom:ze-Ue*(_e.top+_e.bottom)/2,Pe._numbersTop=Ue*_e.top+Ce;var Ye=_e[He];He==="center"&&(Ye=(_e.left+_e.right)/2);var xe=Fe-Ue*Ye;return xe=M(Pe,"numbersTranslate",0,xe,gt,Math.max),l(xe,Ce)+p(Ue)})})(b,N,I,{numbersX:R,numbersY:V,numbersScaler:O,transitionOpts:S,onComplete:k}),F&&(J={range:B.gauge.axis.range,color:B.gauge.bgcolor,line:{color:B.gauge.bordercolor,width:0},thickness:1},D={range:B.gauge.axis.range,color:"rgba(0, 0, 0, 0)",line:{color:B.gauge.bordercolor,width:B.gauge.borderwidth},thickness:1});var le=N.selectAll("g.angular").data(H?I:[]);le.exit().remove();var fe=N.selectAll("g.angularaxis").data(H?I:[]);fe.exit().remove(),H&&function(Se,ke,Me,ve){var ge,De,_e,Pe,Fe=Me[0].trace,ze=ve.size,He=ve.radius,et=ve.innerRadius,Re=ve.gaugeBg,Ze=ve.gaugeOutline,Ke=[ze.l+ze.w/2,ze.t+ze.h/2+He/2],$e=ve.gauge,rt=ve.layer,at=ve.transitionOpts,lt=ve.onComplete,gt=Math.PI/2;function Ie(_t){var xt=Fe.gauge.axis.range[0],At=(_t-xt)/(Fe.gauge.axis.range[1]-xt)*Math.PI-gt;return At<-gt?-gt:At>gt?gt:At}function be(_t){return t.svg.arc().innerRadius((et+He)/2-_t/2*(He-et)).outerRadius((et+He)/2+_t/2*(He-et)).startAngle(-gt)}function We(_t){_t.attr("d",function(xt){return be(xt.thickness).startAngle(Ie(xt.range[0])).endAngle(Ie(xt.range[1]))()})}$e.enter().append("g").classed("angular",!0),$e.attr("transform",l(Ke[0],Ke[1])),rt.enter().append("g").classed("angularaxis",!0).classed("crisp",!0),rt.selectAll("g.xangularaxistick,path,text").remove(),(ge=w(Se,Fe.gauge.axis)).type="linear",ge.range=Fe.gauge.axis.range,ge._id="xangularaxis",ge.setScale();var Ge=function(_t){return(ge.range[0]-_t.x)/(ge.range[1]-ge.range[0])*Math.PI+Math.PI},st={},ot=s.makeLabelFns(ge,0).labelStandoff;st.xFn=function(_t){var xt=Ge(_t);return Math.cos(xt)*ot},st.yFn=function(_t){var xt=Ge(_t),At=Math.sin(xt)>0?.2:1;return-Math.sin(xt)*(ot+_t.fontSize*At)+Math.abs(Math.cos(xt))*(_t.fontSize*o)},st.anchorFn=function(_t){var xt=Ge(_t),At=Math.cos(xt);return Math.abs(At)<.1?"middle":At>0?"start":"end"},st.heightFn=function(_t,xt,At){var It=Ge(_t);return-.5*(1+Math.sin(It))*At};var Ce=function(_t){return l(Ke[0]+He*Math.cos(_t),Ke[1]-He*Math.sin(_t))};if(_e=function(_t){return Ce(Ge(_t))},De=s.calcTicks(ge),Pe=s.getTickSigns(ge)[2],ge.visible){Pe=ge.ticks==="inside"?-1:1;var Ue=(ge.linewidth||1)/2;s.drawTicks(Se,ge,{vals:De,layer:rt,path:"M"+Pe*Ue+",0h"+Pe*ge.ticklen,transFn:function(_t){var xt=Ge(_t);return Ce(xt)+"rotate("+-e(xt)+")"}}),s.drawLabels(Se,ge,{vals:De,layer:rt,transFn:_e,labelFns:st})}var Ye=[Re].concat(Fe.gauge.steps),xe=$e.selectAll("g.bg-arc").data(Ye);xe.enter().append("g").classed("bg-arc",!0).append("path"),xe.select("path").call(We).call(T),xe.exit().remove();var Ee=be(Fe.gauge.bar.thickness),Je=$e.selectAll("g.value-arc").data([Fe.gauge.bar]);Je.enter().append("g").classed("value-arc",!0).append("path");var it=Je.select("path");v(at)?(it.transition().duration(at.duration).ease(at.easing).each("end",function(){lt&&lt()}).each("interrupt",function(){lt&&lt()}).attrTween("d",(ht=Ee,ct=Ie(Me[0].lastY),mt=Ie(Me[0].y),function(){var _t=t.interpolate(ct,mt);return function(xt){return ht.endAngle(_t(xt))()}})),Fe._lastValue=Me[0].y):it.attr("d",typeof Me[0].y=="number"?Ee.endAngle(Ie(Me[0].y)):"M0,0Z");var ht,ct,mt;it.call(T),Je.exit().remove(),Ye=[];var bt=Fe.gauge.threshold.value;bt&&Ye.push({range:[bt,bt],color:Fe.gauge.threshold.color,line:{color:Fe.gauge.threshold.line.color,width:Fe.gauge.threshold.line.width},thickness:Fe.gauge.threshold.thickness});var Et=$e.selectAll("g.threshold-arc").data(Ye);Et.enter().append("g").classed("threshold-arc",!0).append("path"),Et.select("path").call(We).call(T),Et.exit().remove();var Mt=$e.selectAll("g.gauge-outline").data([Ze]);Mt.enter().append("g").classed("gauge-outline",!0).append("path"),Mt.select("path").call(We).call(T),Mt.exit().remove()}(b,0,I,{radius:ee,innerRadius:ie,gauge:le,layer:fe,size:W,gaugeBg:J,gaugeOutline:D,transitionOpts:S,onComplete:k});var ue=N.selectAll("g.bullet").data(j?I:[]);ue.exit().remove();var we=N.selectAll("g.bulletaxis").data(j?I:[]);we.exit().remove(),j&&function(Se,ke,Me,ve){var ge,De,_e,Pe,Fe,ze=Me[0].trace,He=ve.gauge,et=ve.layer,Re=ve.gaugeBg,Ze=ve.gaugeOutline,Ke=ve.size,$e=ze.domain,rt=ve.transitionOpts,at=ve.onComplete;He.enter().append("g").classed("bullet",!0),He.attr("transform",l(Ke.l,Ke.t)),et.enter().append("g").classed("bulletaxis",!0).classed("crisp",!0),et.selectAll("g.xbulletaxistick,path,text").remove();var lt=Ke.h,gt=ze.gauge.bar.thickness*lt,Ie=$e.x[0],be=$e.x[0]+($e.x[1]-$e.x[0])*(ze._hasNumber||ze._hasDelta?1-i.bulletNumberDomainSize:1);(ge=w(Se,ze.gauge.axis))._id="xbulletaxis",ge.domain=[Ie,be],ge.setScale(),De=s.calcTicks(ge),_e=s.makeTransTickFn(ge),Pe=s.getTickSigns(ge)[2],Fe=Ke.t+Ke.h,ge.visible&&(s.drawTicks(Se,ge,{vals:ge.ticks==="inside"?s.clipEnds(ge,De):De,layer:et,path:s.makeTickPath(ge,Fe,Pe),transFn:_e}),s.drawLabels(Se,ge,{vals:De,layer:et,transFn:_e,labelFns:s.makeLabelFns(ge,Fe)}));function We(xe){xe.attr("width",function(Ee){return Math.max(0,ge.c2p(Ee.range[1])-ge.c2p(Ee.range[0]))}).attr("x",function(Ee){return ge.c2p(Ee.range[0])}).attr("y",function(Ee){return .5*(1-Ee.thickness)*lt}).attr("height",function(Ee){return Ee.thickness*lt})}var Ge=[Re].concat(ze.gauge.steps),st=He.selectAll("g.bg-bullet").data(Ge);st.enter().append("g").classed("bg-bullet",!0).append("rect"),st.select("rect").call(We).call(T),st.exit().remove();var ot=He.selectAll("g.value-bullet").data([ze.gauge.bar]);ot.enter().append("g").classed("value-bullet",!0).append("rect"),ot.select("rect").attr("height",gt).attr("y",(lt-gt)/2).call(T),v(rt)?ot.select("rect").transition().duration(rt.duration).ease(rt.easing).each("end",function(){at&&at()}).each("interrupt",function(){at&&at()}).attr("width",Math.max(0,ge.c2p(Math.min(ze.gauge.axis.range[1],Me[0].y)))):ot.select("rect").attr("width",typeof Me[0].y=="number"?Math.max(0,ge.c2p(Math.min(ze.gauge.axis.range[1],Me[0].y))):0),ot.exit().remove();var Ce=Me.filter(function(){return ze.gauge.threshold.value}),Ue=He.selectAll("g.threshold-bullet").data(Ce);Ue.enter().append("g").classed("threshold-bullet",!0).append("line"),Ue.select("line").attr("x1",ge.c2p(ze.gauge.threshold.value)).attr("x2",ge.c2p(ze.gauge.threshold.value)).attr("y1",(1-ze.gauge.threshold.thickness)/2*lt).attr("y2",(1-(1-ze.gauge.threshold.thickness)/2)*lt).call(g.stroke,ze.gauge.threshold.line.color).style("stroke-width",ze.gauge.threshold.line.width),Ue.exit().remove();var Ye=He.selectAll("g.gauge-outline").data([Ze]);Ye.enter().append("g").classed("gauge-outline",!0).append("rect"),Ye.select("rect").call(We).call(T),Ye.exit().remove()}(b,0,I,{gauge:ue,layer:we,size:W,gaugeBg:J,gaugeOutline:D,transitionOpts:S,onComplete:k});var Ae=N.selectAll("text.title").data(I);Ae.exit().remove(),Ae.enter().append("text").classed("title",!0),Ae.attr("text-anchor",function(){return j?d.right:d[B.title.align]}).text(B.title.text).call(r.font,B.title.font).call(u.convertToTspans,b),Ae.attr("transform",function(){var Se,ke=W.l+W.w*m[B.title.align],Me=i.titlePadding,ve=r.bBox(Ae.node());return F?(H&&(B.gauge.axis.visible?Se=r.bBox(fe.node()).top-Me-ve.bottom:Se=W.t+W.h/2-ee/2-ve.bottom-Me),j&&(Se=V-(ve.top+ve.bottom)/2,ke=W.l-i.bulletPadding*W.w)):Se=B._numbersTop-Me-ve.bottom,l(ke,Se)})})}},{"../../components/color":643,"../../components/drawing":665,"../../constants/alignment":745,"../../lib":778,"../../lib/svg_text_utils":803,"../../plots/cartesian/axes":828,"../../plots/cartesian/axis_defaults":830,"../../plots/cartesian/layout_attributes":842,"../../plots/cartesian/position_defaults":845,"./constants":1119,d3:169}],1123:[function(n,z,q){"use strict";var t=n("../../components/colorscale/attributes"),h=n("../../plots/template_attributes").hovertemplateAttrs,p=n("../mesh3d/attributes"),l=n("../../plots/attributes"),e=n("../../lib/extend").extendFlat,o=n("../../plot_api/edit_types").overrideAll,r=z.exports=o(e({x:{valType:"data_array"},y:{valType:"data_array"},z:{valType:"data_array"},value:{valType:"data_array"},isomin:{valType:"number"},isomax:{valType:"number"},surface:{show:{valType:"boolean",dflt:!0},count:{valType:"integer",dflt:2,min:1},fill:{valType:"number",min:0,max:1,dflt:1},pattern:{valType:"flaglist",flags:["A","B","C","D","E"],extras:["all","odd","even"],dflt:"all"}},spaceframe:{show:{valType:"boolean",dflt:!1},fill:{valType:"number",min:0,max:1,dflt:.15}},slices:{x:{show:{valType:"boolean",dflt:!1},locations:{valType:"data_array",dflt:[]},fill:{valType:"number",min:0,max:1,dflt:1}},y:{show:{valType:"boolean",dflt:!1},locations:{valType:"data_array",dflt:[]},fill:{valType:"number",min:0,max:1,dflt:1}},z:{show:{valType:"boolean",dflt:!1},locations:{valType:"data_array",dflt:[]},fill:{valType:"number",min:0,max:1,dflt:1}}},caps:{x:{show:{valType:"boolean",dflt:!0},fill:{valType:"number",min:0,max:1,dflt:1}},y:{show:{valType:"boolean",dflt:!0},fill:{valType:"number",min:0,max:1,dflt:1}},z:{show:{valType:"boolean",dflt:!0},fill:{valType:"number",min:0,max:1,dflt:1}}},text:{valType:"string",dflt:"",arrayOk:!0},hovertext:{valType:"string",dflt:"",arrayOk:!0},hovertemplate:h(),showlegend:e({},l.showlegend,{dflt:!1})},t("",{colorAttr:"`value`",showScaleDflt:!0,editTypeOverride:"calc"}),{opacity:p.opacity,lightposition:p.lightposition,lighting:p.lighting,flatshading:p.flatshading,contour:p.contour,hoverinfo:e({},l.hoverinfo)}),"calc","nested");r.flatshading.dflt=!0,r.lighting.facenormalsepsilon.dflt=0,r.x.editType=r.y.editType=r.z.editType=r.value.editType="calc+clearAxisTypes",r.transforms=void 0},{"../../components/colorscale/attributes":650,"../../lib/extend":768,"../../plot_api/edit_types":810,"../../plots/attributes":824,"../../plots/template_attributes":906,"../mesh3d/attributes":1128}],1124:[function(n,z,q){"use strict";var t=n("../../components/colorscale/calc"),h=n("../streamtube/calc").processGrid,p=n("../streamtube/calc").filter;z.exports=function(l,e){e._len=Math.min(e.x.length,e.y.length,e.z.length,e.value.length),e._x=p(e.x,e._len),e._y=p(e.y,e._len),e._z=p(e.z,e._len),e._value=p(e.value,e._len);var o=h(e);e._gridFill=o.fill,e._Xs=o.Xs,e._Ys=o.Ys,e._Zs=o.Zs,e._len=o.len;for(var r=1/0,i=-1/0,u=0;u<e._len;u++){var s=e._value[u];r=Math.min(r,s),i=Math.max(i,s)}e._minValues=r,e._maxValues=i,e._vMin=e.isomin===void 0||e.isomin===null?r:e.isomin,e._vMax=e.isomax===void 0||e.isomin===null?i:e.isomax,t(l,e,{vals:[e._vMin,e._vMax],containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":651,"../streamtube/calc":1295}],1125:[function(n,z,q){"use strict";var t=n("gl-mesh3d"),h=n("../../lib/gl_format_color").parseColorScale,p=n("../../lib/str2rgbarray"),l=n("../../components/colorscale").extractOpts,e=n("../../plots/gl3d/zip3"),o=function(a,c){for(var f=c.length-1;f>0;f--){var g=Math.min(c[f],c[f-1]),d=Math.max(c[f],c[f-1]);if(d>g&&g<a&&a<=d)return{id:f,distRatio:(d-a)/(d-g)}}return{id:0,distRatio:0}};function r(a,c,f){this.scene=a,this.uid=f,this.mesh=c,this.name="",this.data=null,this.showContour=!1}var i=r.prototype;i.handlePick=function(a){if(a.object===this.mesh){var c=a.data.index,f=this.data._meshX[c],g=this.data._meshY[c],d=this.data._meshZ[c],m=this.data._Ys.length,y=this.data._Zs.length,v=o(f,this.data._Xs).id,T=o(g,this.data._Ys).id,w=o(d,this.data._Zs).id,A=a.index=w+y*T+y*m*v;a.traceCoordinate=[this.data._meshX[A],this.data._meshY[A],this.data._meshZ[A],this.data._value[A]];var E=this.data.hovertext||this.data.text;return Array.isArray(E)&&E[A]!==void 0?a.textLabel=E[A]:E&&(a.textLabel=E),!0}},i.update=function(a){var c=this.scene,f=c.fullSceneLayout;function g(y,v,T,w){return v.map(function(A){return y.d2l(A,0,w)*T})}this.data=s(a);var d={positions:e(g(f.xaxis,a._meshX,c.dataScale[0],a.xcalendar),g(f.yaxis,a._meshY,c.dataScale[1],a.ycalendar),g(f.zaxis,a._meshZ,c.dataScale[2],a.zcalendar)),cells:e(a._meshI,a._meshJ,a._meshK),lightPosition:[a.lightposition.x,a.lightposition.y,a.lightposition.z],ambient:a.lighting.ambient,diffuse:a.lighting.diffuse,specular:a.lighting.specular,roughness:a.lighting.roughness,fresnel:a.lighting.fresnel,vertexNormalsEpsilon:a.lighting.vertexnormalsepsilon,faceNormalsEpsilon:a.lighting.facenormalsepsilon,opacity:a.opacity,contourEnable:a.contour.show,contourColor:p(a.contour.color).slice(0,3),contourWidth:a.contour.width,useFacetNormals:a.flatshading},m=l(a);d.vertexIntensity=a._meshIntensity,d.vertexIntensityBounds=[m.min,m.max],d.colormap=h(a),this.mesh.update(d)},i.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()};var u=["xyz","xzy","yxz","yzx","zxy","zyx"];function s(a){a._meshI=[],a._meshJ=[],a._meshK=[];var c,f,g,d,m,y,v,T=a.surface.show,w=a.spaceframe.show,A=a.surface.fill,E=a.spaceframe.fill,M=!1,b=!1,_=0,S=a._Xs,C=a._Ys,k=a._Zs,L=S.length,I=C.length,R=k.length,V=u.indexOf(a._gridFill.replace(/-/g,"").replace(/\+/g,"")),O=function(Re,Ze,Ke){switch(V){case 5:return Ke+R*Ze+R*I*Re;case 4:return Ke+R*Re+R*L*Ze;case 3:return Ze+I*Ke+I*R*Re;case 2:return Ze+I*Re+I*L*Ke;case 1:return Re+L*Ke+L*R*Ze;default:return Re+L*Ze+L*I*Ke}},J=a._minValues,D=a._maxValues,B=a._vMin,N=a._vMax;function F(Re,Ze,Ke){for(var $e=y.length,rt=f;rt<$e;rt++)if(Re===g[rt]&&Ze===d[rt]&&Ke===m[rt])return rt;return-1}function H(){f=c}function j(){g=[],d=[],m=[],y=[],c=0,H()}function G(Re,Ze,Ke,$e){return g.push(Re),d.push(Ze),m.push(Ke),y.push($e),++c-1}function W(Re,Ze,Ke){for(var $e=[],rt=0;rt<Re.length;rt++)$e[rt]=Re[rt]*(1-Ke)+Ke*Ze[rt];return $e}function Q(Re){v=Re}function $(Re,Ze){return Re==="all"||Re===null||Re.indexOf(Ze)>-1}function ee(Re,Ze){return Re===null?Ze:Re}function ie(Re,Ze,Ke){H();var $e,rt,at,lt=[Ze],gt=[Ke];if(v>=1)lt=[Ze],gt=[Ke];else if(v>0){var Ie=function(xe,Ee){var Je=xe[0],it=xe[1],ht=xe[2],ct=function(It,Nt,Ot){for(var Yt=[],Pt=0;Pt<It.length;Pt++)Yt[Pt]=(It[Pt]+Nt[Pt]+Ot[Pt])/3;return Yt}(Je,it,ht),mt=Math.sqrt(1-v),bt=W(ct,Je,mt),Et=W(ct,it,mt),Mt=W(ct,ht,mt),_t=Ee[0],xt=Ee[1],At=Ee[2];return{xyzv:[[Je,it,Et],[Et,bt,Je],[it,ht,Mt],[Mt,Et,it],[ht,Je,bt],[bt,Mt,ht]],abc:[[_t,xt,-1],[-1,-1,_t],[xt,At,-1],[-1,-1,xt],[At,_t,-1],[-1,-1,At]]}}(Ze,Ke);lt=Ie.xyzv,gt=Ie.abc}for(var be=0;be<lt.length;be++){Ze=lt[be],Ke=gt[be];for(var We=[],Ge=0;Ge<3;Ge++){var st=Ze[Ge][0],ot=Ze[Ge][1],Ce=Ze[Ge][2],Ue=Ze[Ge][3],Ye=Ke[Ge]>-1?Ke[Ge]:F(st,ot,Ce);We[Ge]=Ye>-1?Ye:G(st,ot,Ce,ee(Re,Ue))}$e=We[0],rt=We[1],at=We[2],a._meshI.push($e),a._meshJ.push(rt),a._meshK.push(at),++_}}function ae(Re,Ze,Ke,$e){var rt=Re[3];rt<Ke&&(rt=Ke),rt>$e&&(rt=$e);for(var at=(Re[3]-rt)/(Re[3]-Ze[3]+1e-9),lt=[],gt=0;gt<4;gt++)lt[gt]=(1-at)*Re[gt]+at*Ze[gt];return lt}function oe(Re,Ze,Ke){return Re>=Ze&&Re<=Ke}function de(Re){var Ze=.001*(N-B);return Re>=B-Ze&&Re<=N+Ze}function le(Re){for(var Ze=[],Ke=0;Ke<4;Ke++){var $e=Re[Ke];Ze.push([a._x[$e],a._y[$e],a._z[$e],a._value[$e]])}return Ze}function fe(Re,Ze,Ke,$e,rt,at){at||(at=1),Ke=[-1,-1,-1];var lt=!1,gt=[oe(Ze[0][3],$e,rt),oe(Ze[1][3],$e,rt),oe(Ze[2][3],$e,rt)];if(!gt[0]&&!gt[1]&&!gt[2])return!1;var Ie=function(We,Ge,st){return de(Ge[0][3])&&de(Ge[1][3])&&de(Ge[2][3])?(ie(We,Ge,st),!0):at<3&&fe(We,Ge,st,B,N,++at)};if(gt[0]&&gt[1]&&gt[2])return Ie(Re,Ze,Ke)||lt;var be=!1;return[[0,1,2],[2,0,1],[1,2,0]].forEach(function(We){if(gt[We[0]]&&gt[We[1]]&&!gt[We[2]]){var Ge=Ze[We[0]],st=Ze[We[1]],ot=Ze[We[2]],Ce=ae(ot,Ge,$e,rt),Ue=ae(ot,st,$e,rt);lt=Ie(Re,[Ue,Ce,Ge],[-1,-1,Ke[We[0]]])||lt,lt=Ie(Re,[Ge,st,Ue],[Ke[We[0]],Ke[We[1]],-1])||lt,be=!0}}),be||[[0,1,2],[1,2,0],[2,0,1]].forEach(function(We){if(gt[We[0]]&&!gt[We[1]]&&!gt[We[2]]){var Ge=Ze[We[0]],st=Ze[We[1]],ot=Ze[We[2]],Ce=ae(st,Ge,$e,rt),Ue=ae(ot,Ge,$e,rt);lt=Ie(Re,[Ue,Ce,Ge],[-1,-1,Ke[We[0]]])||lt,be=!0}}),lt}function ue(Re,Ze,Ke,$e){var rt=!1,at=le(Ze),lt=[oe(at[0][3],Ke,$e),oe(at[1][3],Ke,$e),oe(at[2][3],Ke,$e),oe(at[3][3],Ke,$e)];if(!(lt[0]||lt[1]||lt[2]||lt[3]))return rt;if(lt[0]&&lt[1]&&lt[2]&&lt[3])return b&&(rt=function(Ie,be,We){var Ge=function(st,ot,Ce){ie(Ie,[be[st],be[ot],be[Ce]],[We[st],We[ot],We[Ce]])};Ge(0,1,2),Ge(3,0,1),Ge(2,3,0),Ge(1,2,3)}(Re,at,Ze)||rt),rt;var gt=!1;return[[0,1,2,3],[3,0,1,2],[2,3,0,1],[1,2,3,0]].forEach(function(Ie){if(lt[Ie[0]]&&lt[Ie[1]]&&lt[Ie[2]]&&!lt[Ie[3]]){var be=at[Ie[0]],We=at[Ie[1]],Ge=at[Ie[2]],st=at[Ie[3]];if(b)rt=ie(Re,[be,We,Ge],[Ze[Ie[0]],Ze[Ie[1]],Ze[Ie[2]]])||rt;else{var ot=ae(st,be,Ke,$e),Ce=ae(st,We,Ke,$e),Ue=ae(st,Ge,Ke,$e);rt=ie(null,[ot,Ce,Ue],[-1,-1,-1])||rt}gt=!0}}),gt||([[0,1,2,3],[1,2,3,0],[2,3,0,1],[3,0,1,2],[0,2,3,1],[1,3,2,0]].forEach(function(Ie){if(lt[Ie[0]]&&lt[Ie[1]]&&!lt[Ie[2]]&&!lt[Ie[3]]){var be=at[Ie[0]],We=at[Ie[1]],Ge=at[Ie[2]],st=at[Ie[3]],ot=ae(Ge,be,Ke,$e),Ce=ae(Ge,We,Ke,$e),Ue=ae(st,We,Ke,$e),Ye=ae(st,be,Ke,$e);b?(rt=ie(Re,[be,Ye,ot],[Ze[Ie[0]],-1,-1])||rt,rt=ie(Re,[We,Ce,Ue],[Ze[Ie[1]],-1,-1])||rt):rt=function(xe,Ee,Je){var it=function(ht,ct,mt){ie(xe,[Ee[ht],Ee[ct],Ee[mt]],[Je[ht],Je[ct],Je[mt]])};it(0,1,2),it(2,3,0)}(null,[ot,Ce,Ue,Ye],[-1,-1,-1,-1])||rt,gt=!0}}),gt||[[0,1,2,3],[1,2,3,0],[2,3,0,1],[3,0,1,2]].forEach(function(Ie){if(lt[Ie[0]]&&!lt[Ie[1]]&&!lt[Ie[2]]&&!lt[Ie[3]]){var be=at[Ie[0]],We=at[Ie[1]],Ge=at[Ie[2]],st=at[Ie[3]],ot=ae(We,be,Ke,$e),Ce=ae(Ge,be,Ke,$e),Ue=ae(st,be,Ke,$e);b?(rt=ie(Re,[be,ot,Ce],[Ze[Ie[0]],-1,-1])||rt,rt=ie(Re,[be,Ce,Ue],[Ze[Ie[0]],-1,-1])||rt,rt=ie(Re,[be,Ue,ot],[Ze[Ie[0]],-1,-1])||rt):rt=ie(null,[ot,Ce,Ue],[-1,-1,-1])||rt,gt=!0}})),rt}function we(Re,Ze,Ke,$e,rt,at,lt,gt,Ie,be,We){var Ge=!1;return M&&($(Re,"A")&&(Ge=ue(null,[Ze,Ke,$e,at],be,We)||Ge),$(Re,"B")&&(Ge=ue(null,[Ke,$e,rt,Ie],be,We)||Ge),$(Re,"C")&&(Ge=ue(null,[Ke,at,lt,Ie],be,We)||Ge),$(Re,"D")&&(Ge=ue(null,[$e,at,gt,Ie],be,We)||Ge),$(Re,"E")&&(Ge=ue(null,[Ke,$e,at,Ie],be,We)||Ge)),b&&(Ge=ue(Re,[Ke,$e,at,Ie],be,We)||Ge),Ge}function Ae(Re,Ze,Ke,$e,rt,at,lt,gt){return[gt[0]===!0||fe(Re,le([Ze,Ke,$e]),[Ze,Ke,$e],at,lt),gt[1]===!0||fe(Re,le([$e,rt,Ze]),[$e,rt,Ze],at,lt)]}function Se(Re,Ze,Ke,$e,rt,at,lt,gt,Ie){return gt?Ae(Re,Ze,Ke,rt,$e,at,lt,Ie):Ae(Re,Ke,rt,$e,Ze,at,lt,Ie)}function ke(Re,Ze,Ke,$e,rt,at,lt){var gt,Ie,be,We,Ge=!1,st=function(){Ge=fe(Re,[gt,Ie,be],[-1,-1,-1],rt,at)||Ge,Ge=fe(Re,[be,We,gt],[-1,-1,-1],rt,at)||Ge},ot=lt[0],Ce=lt[1],Ue=lt[2];return ot&&(gt=W(le([O(Ze,Ke-0,$e-0)])[0],le([O(Ze-1,Ke-0,$e-0)])[0],ot),Ie=W(le([O(Ze,Ke-0,$e-1)])[0],le([O(Ze-1,Ke-0,$e-1)])[0],ot),be=W(le([O(Ze,Ke-1,$e-1)])[0],le([O(Ze-1,Ke-1,$e-1)])[0],ot),We=W(le([O(Ze,Ke-1,$e-0)])[0],le([O(Ze-1,Ke-1,$e-0)])[0],ot),st()),Ce&&(gt=W(le([O(Ze-0,Ke,$e-0)])[0],le([O(Ze-0,Ke-1,$e-0)])[0],Ce),Ie=W(le([O(Ze-0,Ke,$e-1)])[0],le([O(Ze-0,Ke-1,$e-1)])[0],Ce),be=W(le([O(Ze-1,Ke,$e-1)])[0],le([O(Ze-1,Ke-1,$e-1)])[0],Ce),We=W(le([O(Ze-1,Ke,$e-0)])[0],le([O(Ze-1,Ke-1,$e-0)])[0],Ce),st()),Ue&&(gt=W(le([O(Ze-0,Ke-0,$e)])[0],le([O(Ze-0,Ke-0,$e-1)])[0],Ue),Ie=W(le([O(Ze-0,Ke-1,$e)])[0],le([O(Ze-0,Ke-1,$e-1)])[0],Ue),be=W(le([O(Ze-1,Ke-1,$e)])[0],le([O(Ze-1,Ke-1,$e-1)])[0],Ue),We=W(le([O(Ze-1,Ke-0,$e)])[0],le([O(Ze-1,Ke-0,$e-1)])[0],Ue),st()),Ge}function Me(Re,Ze,Ke,$e,rt,at,lt,gt,Ie,be,We,Ge){var st=Re;return Ge?(M&&Re==="even"&&(st=null),we(st,Ze,Ke,$e,rt,at,lt,gt,Ie,be,We)):(M&&Re==="odd"&&(st=null),we(st,Ie,gt,lt,at,rt,$e,Ke,Ze,be,We))}function ve(Re,Ze,Ke,$e,rt){for(var at=[],lt=0,gt=0;gt<Ze.length;gt++)for(var Ie=Ze[gt],be=1;be<R;be++)for(var We=1;We<I;We++)at.push(Se(Re,O(Ie,We-1,be-1),O(Ie,We-1,be),O(Ie,We,be-1),O(Ie,We,be),Ke,$e,(Ie+We+be)%2,rt&&rt[lt]?rt[lt]:[])),lt++;return at}function ge(Re,Ze,Ke,$e,rt){for(var at=[],lt=0,gt=0;gt<Ze.length;gt++)for(var Ie=Ze[gt],be=1;be<L;be++)for(var We=1;We<R;We++)at.push(Se(Re,O(be-1,Ie,We-1),O(be,Ie,We-1),O(be-1,Ie,We),O(be,Ie,We),Ke,$e,(be+Ie+We)%2,rt&&rt[lt]?rt[lt]:[])),lt++;return at}function De(Re,Ze,Ke,$e,rt){for(var at=[],lt=0,gt=0;gt<Ze.length;gt++)for(var Ie=Ze[gt],be=1;be<I;be++)for(var We=1;We<L;We++)at.push(Se(Re,O(We-1,be-1,Ie),O(We-1,be,Ie),O(We,be-1,Ie),O(We,be,Ie),Ke,$e,(We+be+Ie)%2,rt&&rt[lt]?rt[lt]:[])),lt++;return at}function _e(Re,Ze,Ke){for(var $e=1;$e<R;$e++)for(var rt=1;rt<I;rt++)for(var at=1;at<L;at++)Me(Re,O(at-1,rt-1,$e-1),O(at-1,rt-1,$e),O(at-1,rt,$e-1),O(at-1,rt,$e),O(at,rt-1,$e-1),O(at,rt-1,$e),O(at,rt,$e-1),O(at,rt,$e),Ze,Ke,(at+rt+$e)%2)}function Pe(Re,Ze,Ke){M=!0,_e(Re,Ze,Ke),M=!1}function Fe(Re,Ze,Ke,$e,rt,at){for(var lt=[],gt=0,Ie=0;Ie<Ze.length;Ie++)for(var be=Ze[Ie],We=1;We<R;We++)for(var Ge=1;Ge<I;Ge++)lt.push(ke(Re,be,Ge,We,Ke,$e,rt[Ie],at&&at[gt]&&at[gt])),gt++;return lt}function ze(Re,Ze,Ke,$e,rt,at){for(var lt=[],gt=0,Ie=0;Ie<Ze.length;Ie++)for(var be=Ze[Ie],We=1;We<L;We++)for(var Ge=1;Ge<R;Ge++)lt.push(ke(Re,We,be,Ge,Ke,$e,rt[Ie],at&&at[gt]&&at[gt])),gt++;return lt}function He(Re,Ze,Ke,$e,rt,at){for(var lt=[],gt=0,Ie=0;Ie<Ze.length;Ie++)for(var be=Ze[Ie],We=1;We<I;We++)for(var Ge=1;Ge<L;Ge++)lt.push(ke(Re,Ge,We,be,Ke,$e,rt[Ie],at&&at[gt]&&at[gt])),gt++;return lt}function et(Re,Ze){for(var Ke=[],$e=Re;$e<Ze;$e++)Ke.push($e);return Ke}return function(){if(j(),function(){for(var gt=0;gt<L;gt++)for(var Ie=0;Ie<I;Ie++)for(var be=0;be<R;be++){var We=O(gt,Ie,be);G(a._x[We],a._y[We],a._z[We],a._value[We])}}(),w&&E&&(Q(E),b=!0,_e(null,B,N),b=!1),T&&A){Q(A);for(var Re=a.surface.pattern,Ze=a.surface.count,Ke=0;Ke<Ze;Ke++){var $e=Ze===1?.5:Ke/(Ze-1),rt=(1-$e)*B+$e*N,at=Math.abs(rt-J)>Math.abs(rt-D)?[J,rt]:[rt,D];Pe(Re,at[0],at[1])}}var lt=[[Math.min(B,D),Math.max(B,D)],[Math.min(J,N),Math.max(J,N)]];["x","y","z"].forEach(function(gt){for(var Ie=[],be=0;be<lt.length;be++){var We=0,Ge=lt[be][0],st=lt[be][1],ot=a.slices[gt];if(ot.show&&ot.fill){Q(ot.fill);var Ce=[],Ue=[],Ye=[];if(ot.locations.length)for(var xe=0;xe<ot.locations.length;xe++){var Ee=o(ot.locations[xe],gt==="x"?S:gt==="y"?C:k);Ee.distRatio===0?Ce.push(Ee.id):Ee.id>0&&(Ue.push(Ee.id),gt==="x"?Ye.push([Ee.distRatio,0,0]):gt==="y"?Ye.push([0,Ee.distRatio,0]):Ye.push([0,0,Ee.distRatio]))}else Ce=et(1,gt==="x"?L-1:gt==="y"?I-1:R-1);Ue.length>0&&(Ie[We]=gt==="x"?Fe(null,Ue,Ge,st,Ye,Ie[We]):gt==="y"?ze(null,Ue,Ge,st,Ye,Ie[We]):He(null,Ue,Ge,st,Ye,Ie[We]),We++),Ce.length>0&&(Ie[We]=gt==="x"?ve(null,Ce,Ge,st,Ie[We]):gt==="y"?ge(null,Ce,Ge,st,Ie[We]):De(null,Ce,Ge,st,Ie[We]),We++)}var Je=a.caps[gt];Je.show&&Je.fill&&(Q(Je.fill),Ie[We]=gt==="x"?ve(null,[0,L-1],Ge,st,Ie[We]):gt==="y"?ge(null,[0,I-1],Ge,st,Ie[We]):De(null,[0,R-1],Ge,st,Ie[We]),We++)}}),_===0&&j(),a._meshX=g,a._meshY=d,a._meshZ=m,a._meshIntensity=y,a._Xs=S,a._Ys=C,a._Zs=k}(),a}z.exports={findNearestOnAxis:o,generateIsoMeshes:s,createIsosurfaceTrace:function(a,c){var f=a.glplot.gl,g=t({gl:f}),d=new r(a,g,c.uid);return g._trace=d,d.update(c),a.glplot.add(g),d}}},{"../../components/colorscale":655,"../../lib/gl_format_color":774,"../../lib/str2rgbarray":802,"../../plots/gl3d/zip3":881,"gl-mesh3d":309}],1126:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../../registry"),p=n("./attributes"),l=n("../../components/colorscale/defaults");function e(o,r,i,u,s){var a=s("isomin"),c=s("isomax");c!=null&&a!=null&&a>c&&(r.isomin=null,r.isomax=null);var f=s("x"),g=s("y"),d=s("z"),m=s("value");f&&f.length&&g&&g.length&&d&&d.length&&m&&m.length?(h.getComponentMethod("calendars","handleTraceDefaults")(o,r,["x","y","z"],u),["x","y","z"].forEach(function(y){var v="caps."+y;s(v+".show")&&s(v+".fill");var T="slices."+y;s(T+".show")&&(s(T+".fill"),s(T+".locations"))}),s("spaceframe.show")&&s("spaceframe.fill"),s("surface.show")&&(s("surface.count"),s("surface.fill"),s("surface.pattern")),s("contour.show")&&(s("contour.color"),s("contour.width")),["text","hovertext","hovertemplate","lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lighting.vertexnormalsepsilon","lighting.facenormalsepsilon","lightposition.x","lightposition.y","lightposition.z","flatshading","opacity"].forEach(function(y){s(y)}),l(o,r,u,s,{prefix:"",cLetter:"c"}),r._length=null):r.visible=!1}z.exports={supplyDefaults:function(o,r,i,u){e(o,r,i,u,function(s,a){return t.coerce(o,r,p,s,a)})},supplyIsoDefaults:e}},{"../../components/colorscale/defaults":653,"../../lib":778,"../../registry":911,"./attributes":1123}],1127:[function(n,z,q){"use strict";z.exports={attributes:n("./attributes"),supplyDefaults:n("./defaults").supplyDefaults,calc:n("./calc"),colorbar:{min:"cmin",max:"cmax"},plot:n("./convert").createIsosurfaceTrace,moduleType:"trace",name:"isosurface",basePlotModule:n("../../plots/gl3d"),categories:["gl3d","showLegend"],meta:{}}},{"../../plots/gl3d":870,"./attributes":1123,"./calc":1124,"./convert":1125,"./defaults":1126}],1128:[function(n,z,q){"use strict";var t=n("../../components/colorscale/attributes"),h=n("../../plots/template_attributes").hovertemplateAttrs,p=n("../surface/attributes"),l=n("../../plots/attributes"),e=n("../../lib/extend").extendFlat;z.exports=e({x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},i:{valType:"data_array",editType:"calc"},j:{valType:"data_array",editType:"calc"},k:{valType:"data_array",editType:"calc"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertemplate:h({editType:"calc"}),delaunayaxis:{valType:"enumerated",values:["x","y","z"],dflt:"z",editType:"calc"},alphahull:{valType:"number",dflt:-1,editType:"calc"},intensity:{valType:"data_array",editType:"calc"},intensitymode:{valType:"enumerated",values:["vertex","cell"],dflt:"vertex",editType:"calc"},color:{valType:"color",editType:"calc"},vertexcolor:{valType:"data_array",editType:"calc"},facecolor:{valType:"data_array",editType:"calc"},transforms:void 0},t("",{colorAttr:"`intensity`",showScaleDflt:!0,editTypeOverride:"calc"}),{opacity:p.opacity,flatshading:{valType:"boolean",dflt:!1,editType:"calc"},contour:{show:e({},p.contours.x.show,{}),color:p.contours.x.color,width:p.contours.x.width,editType:"calc"},lightposition:{x:e({},p.lightposition.x,{dflt:1e5}),y:e({},p.lightposition.y,{dflt:1e5}),z:e({},p.lightposition.z,{dflt:0}),editType:"calc"},lighting:e({vertexnormalsepsilon:{valType:"number",min:0,max:1,dflt:1e-12,editType:"calc"},facenormalsepsilon:{valType:"number",min:0,max:1,dflt:1e-6,editType:"calc"},editType:"calc"},p.lighting),hoverinfo:e({},l.hoverinfo,{editType:"calc"}),showlegend:e({},l.showlegend,{dflt:!1})})},{"../../components/colorscale/attributes":650,"../../lib/extend":768,"../../plots/attributes":824,"../../plots/template_attributes":906,"../surface/attributes":1311}],1129:[function(n,z,q){"use strict";var t=n("../../components/colorscale/calc");z.exports=function(h,p){p.intensity&&t(h,p,{vals:p.intensity,containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":651}],1130:[function(n,z,q){"use strict";var t=n("gl-mesh3d"),h=n("delaunay-triangulate"),p=n("alpha-shape"),l=n("convex-hull"),e=n("../../lib/gl_format_color").parseColorScale,o=n("../../lib/str2rgbarray"),r=n("../../components/colorscale").extractOpts,i=n("../../plots/gl3d/zip3");function u(d,m,y){this.scene=d,this.uid=y,this.mesh=m,this.name="",this.color="#fff",this.data=null,this.showContour=!1}var s=u.prototype;function a(d){for(var m=[],y=d.length,v=0;v<y;v++)m[v]=o(d[v]);return m}function c(d,m,y,v){for(var T=[],w=m.length,A=0;A<w;A++)T[A]=d.d2l(m[A],0,v)*y;return T}function f(d){for(var m=[],y=d.length,v=0;v<y;v++)m[v]=Math.round(d[v]);return m}function g(d,m){for(var y=d.length,v=0;v<y;v++)if(d[v]<=-.5||d[v]>=m-.5)return!1;return!0}s.handlePick=function(d){if(d.object===this.mesh){var m=d.index=d.data.index;d.data._cellCenter?d.traceCoordinate=d.data.dataCoordinate:d.traceCoordinate=[this.data.x[m],this.data.y[m],this.data.z[m]];var y=this.data.hovertext||this.data.text;return Array.isArray(y)&&y[m]!==void 0?d.textLabel=y[m]:y&&(d.textLabel=y),!0}},s.update=function(d){var m=this.scene,y=m.fullSceneLayout;this.data=d;var v,T=d.x.length,w=i(c(y.xaxis,d.x,m.dataScale[0],d.xcalendar),c(y.yaxis,d.y,m.dataScale[1],d.ycalendar),c(y.zaxis,d.z,m.dataScale[2],d.zcalendar));if(d.i&&d.j&&d.k){if(d.i.length!==d.j.length||d.j.length!==d.k.length||!g(d.i,T)||!g(d.j,T)||!g(d.k,T))return;v=i(f(d.i),f(d.j),f(d.k))}else v=d.alphahull===0?l(w):d.alphahull>0?p(d.alphahull,w):function(b,_){for(var S=["x","y","z"].indexOf(b),C=[],k=_.length,L=0;L<k;L++)C[L]=[_[L][(S+1)%3],_[L][(S+2)%3]];return h(C)}(d.delaunayaxis,w);var A={positions:w,cells:v,lightPosition:[d.lightposition.x,d.lightposition.y,d.lightposition.z],ambient:d.lighting.ambient,diffuse:d.lighting.diffuse,specular:d.lighting.specular,roughness:d.lighting.roughness,fresnel:d.lighting.fresnel,vertexNormalsEpsilon:d.lighting.vertexnormalsepsilon,faceNormalsEpsilon:d.lighting.facenormalsepsilon,opacity:d.opacity,contourEnable:d.contour.show,contourColor:o(d.contour.color).slice(0,3),contourWidth:d.contour.width,useFacetNormals:d.flatshading};if(d.intensity){var E=r(d);this.color="#fff";var M=d.intensitymode;A[M+"Intensity"]=d.intensity,A[M+"IntensityBounds"]=[E.min,E.max],A.colormap=e(d)}else d.vertexcolor?(this.color=d.vertexcolor[0],A.vertexColors=a(d.vertexcolor)):d.facecolor?(this.color=d.facecolor[0],A.cellColors=a(d.facecolor)):(this.color=d.color,A.meshColor=o(d.color));this.mesh.update(A)},s.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},z.exports=function(d,m){var y=d.glplot.gl,v=t({gl:y}),T=new u(d,v,m.uid);return v._trace=T,T.update(m),d.glplot.add(v),T}},{"../../components/colorscale":655,"../../lib/gl_format_color":774,"../../lib/str2rgbarray":802,"../../plots/gl3d/zip3":881,"alpha-shape":69,"convex-hull":135,"delaunay-triangulate":171,"gl-mesh3d":309}],1131:[function(n,z,q){"use strict";var t=n("../../registry"),h=n("../../lib"),p=n("../../components/colorscale/defaults"),l=n("./attributes");z.exports=function(e,o,r,i){function u(a,c){return h.coerce(e,o,l,a,c)}function s(a){var c=a.map(function(f){var g=u(f);return g&&h.isArrayOrTypedArray(g)?g:null});return c.every(function(f){return f&&f.length===c[0].length})&&c}s(["x","y","z"])?(s(["i","j","k"]),(!o.i||o.j&&o.k)&&(!o.j||o.k&&o.i)&&(!o.k||o.i&&o.j)?(t.getComponentMethod("calendars","handleTraceDefaults")(e,o,["x","y","z"],i),["lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lighting.vertexnormalsepsilon","lighting.facenormalsepsilon","lightposition.x","lightposition.y","lightposition.z","flatshading","alphahull","delaunayaxis","opacity"].forEach(function(a){u(a)}),u("contour.show")&&(u("contour.color"),u("contour.width")),"intensity"in e?(u("intensity"),u("intensitymode"),p(e,o,i,u,{prefix:"",cLetter:"c"})):(o.showscale=!1,"facecolor"in e?u("facecolor"):"vertexcolor"in e?u("vertexcolor"):u("color",r)),u("text"),u("hovertext"),u("hovertemplate"),o._length=null):o.visible=!1):o.visible=!1}},{"../../components/colorscale/defaults":653,"../../lib":778,"../../registry":911,"./attributes":1128}],1132:[function(n,z,q){"use strict";z.exports={attributes:n("./attributes"),supplyDefaults:n("./defaults"),calc:n("./calc"),colorbar:{min:"cmin",max:"cmax"},plot:n("./convert"),moduleType:"trace",name:"mesh3d",basePlotModule:n("../../plots/gl3d"),categories:["gl3d","showLegend"],meta:{}}},{"../../plots/gl3d":870,"./attributes":1128,"./calc":1129,"./convert":1130,"./defaults":1131}],1133:[function(n,z,q){"use strict";var t=n("../../lib").extendFlat,h=n("../scatter/attributes"),p=n("../../components/drawing/attributes").dash,l=n("../../components/fx/attributes"),e=n("../../constants/delta.js"),o=e.INCREASING.COLOR,r=e.DECREASING.COLOR,i=h.line;function u(s){return{line:{color:t({},i.color,{dflt:s}),width:i.width,dash:p,editType:"style"},editType:"style"}}z.exports={xperiod:h.xperiod,xperiod0:h.xperiod0,xperiodalignment:h.xperiodalignment,x:{valType:"data_array",editType:"calc+clearAxisTypes"},open:{valType:"data_array",editType:"calc"},high:{valType:"data_array",editType:"calc"},low:{valType:"data_array",editType:"calc"},close:{valType:"data_array",editType:"calc"},line:{width:t({},i.width,{}),dash:t({},p,{}),editType:"style"},increasing:u(o),decreasing:u(r),text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},tickwidth:{valType:"number",min:0,max:.5,dflt:.3,editType:"calc"},hoverlabel:t({},l.hoverlabel,{split:{valType:"boolean",dflt:!1,editType:"style"}})}},{"../../components/drawing/attributes":664,"../../components/fx/attributes":674,"../../constants/delta.js":747,"../../lib":778,"../scatter/attributes":1187}],1134:[function(n,z,q){"use strict";var t=n("../../lib"),h=t._,p=n("../../plots/cartesian/axes"),l=n("../../plots/cartesian/align_period"),e=n("../../constants/numerical").BADNUM;function o(i,u,s,a){return{o:i,h:u,l:s,c:a}}function r(i,u,s,a,c,f){for(var g=c.makeCalcdata(u,"open"),d=c.makeCalcdata(u,"high"),m=c.makeCalcdata(u,"low"),y=c.makeCalcdata(u,"close"),v=Array.isArray(u.text),T=Array.isArray(u.hovertext),w=!0,A=null,E=!!u.xperiodalignment,M=[],b=0;b<a.length;b++){var _=a[b],S=g[b],C=d[b],k=m[b],L=y[b];if(_!==e&&S!==e&&C!==e&&k!==e&&L!==e){L===S?A!==null&&L!==A&&(w=L>A):w=L>S,A=L;var I=f(S,C,k,L);I.pos=_,I.yc=(S+L)/2,I.i=b,I.dir=w?"increasing":"decreasing",I.x=I.pos,I.y=[k,C],E&&(I.orig_p=s[b]),v&&(I.tx=u.text[b]),T&&(I.htx=u.hovertext[b]),M.push(I)}else M.push({pos:_,empty:!0})}return u._extremes[c._id]=p.findExtremes(c,t.concat(m,d),{padded:!0}),M.length&&(M[0].t={labels:{open:h(i,"open:")+" ",high:h(i,"high:")+" ",low:h(i,"low:")+" ",close:h(i,"close:")+" "}}),M}z.exports={calc:function(i,u){var s=p.getFromId(i,u.xaxis),a=p.getFromId(i,u.yaxis),c=function(y,v,T){var w=T._minDiff;if(!w){var A,E=y._fullData,M=[];for(w=1/0,A=0;A<E.length;A++){var b=E[A];if(b.type==="ohlc"&&b.visible===!0&&b.xaxis===v._id){M.push(b);var _=v.makeCalcdata(b,"x");b._origX=_;var S=l(T,v,"x",_);b._xcalc=S;var C=t.distinctVals(S).minDiff;C&&isFinite(C)&&(w=Math.min(w,C))}}for(w===1/0&&(w=1),A=0;A<M.length;A++)M[A]._minDiff=w}return w*T.tickwidth}(i,s,u),f=u._minDiff;u._minDiff=null;var g=u._origX;u._origX=null;var d=u._xcalc;u._xcalc=null;var m=r(i,u,g,d,a,o);return u._extremes[s._id]=p.findExtremes(s,d,{vpad:f/2}),m.length?(t.extendFlat(m[0].t,{wHover:f/2,tickLen:c}),m):[{t:{empty:!0}}]},calcCommon:r}},{"../../constants/numerical":753,"../../lib":778,"../../plots/cartesian/align_period":825,"../../plots/cartesian/axes":828}],1135:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("./ohlc_defaults"),p=n("../scatter/period_defaults"),l=n("./attributes");function e(o,r,i,u){i(u+".line.color"),i(u+".line.width",r.line.width),i(u+".line.dash",r.line.dash)}z.exports=function(o,r,i,u){function s(a,c){return t.coerce(o,r,l,a,c)}h(o,r,s,u)?(p(o,r,u,s,{x:!0}),s("line.width"),s("line.dash"),e(o,r,s,"increasing"),e(o,r,s,"decreasing"),s("text"),s("hovertext"),s("tickwidth"),u._requestRangeslider[r.xaxis]=!0):r.visible=!1}},{"../../lib":778,"../scatter/period_defaults":1207,"./attributes":1133,"./ohlc_defaults":1138}],1136:[function(n,z,q){"use strict";var t=n("../../plots/cartesian/axes"),h=n("../../lib"),p=n("../../components/fx"),l=n("../../components/color"),e=n("../../lib").fillText,o=n("../../constants/delta.js"),r={increasing:o.INCREASING.SYMBOL,decreasing:o.DECREASING.SYMBOL};function i(a,c,f,g){var d,m,y=a.cd,v=a.xa,T=y[0].trace,w=y[0].t,A=T.type,E=A==="ohlc"?"l":"min",M=A==="ohlc"?"h":"max",b=w.bPos||0,_=w.bdPos||w.tickLen,S=w.wHover,C=Math.min(1,_/Math.abs(v.r2c(v.range[1])-v.r2c(v.range[0])));function k(D){var B=function(N){return N.pos+b-c}(D);return p.inbox(B-S,B+S,d)}function L(D){var B=D[E],N=D[M];return B===N||p.inbox(B-f,N-f,d)}function I(D){return(k(D)+L(D))/2}d=a.maxHoverDistance-C,m=a.maxSpikeDistance-C;var R=p.getDistanceFunction(g,k,L,I);if(p.getClosest(y,R,a),a.index===!1)return null;var V=y[a.index];if(V.empty)return null;var O=T[V.dir],J=O.line.color;return l.opacity(J)&&O.line.width?a.color=J:a.color=O.fillcolor,a.x0=v.c2p(V.pos+b-_,!0),a.x1=v.c2p(V.pos+b+_,!0),a.xLabelVal=V.orig_p!==void 0?V.orig_p:V.pos,a.spikeDistance=I(V)*m/d,a.xSpike=v.c2p(V.pos,!0),a}function u(a,c,f,g){var d=a.cd,m=a.ya,y=d[0].trace,v=d[0].t,T=[],w=i(a,c,f,g);if(!w)return[];var A=d[w.index].hi||y.hoverinfo,E=A.split("+");if(!(A==="all"||E.indexOf("y")!==-1))return[];for(var M=["high","open","close","low"],b={},_=0;_<M.length;_++){var S,C=M[_],k=y[C][w.index],L=m.c2p(k,!0);k in b?(S=b[k]).yLabel+="<br>"+v.labels[C]+t.hoverLabelText(m,k):((S=h.extendFlat({},w)).y0=S.y1=L,S.yLabelVal=k,S.yLabel=v.labels[C]+t.hoverLabelText(m,k),S.name="",T.push(S),b[k]=S)}return T}function s(a,c,f,g){var d=a.cd,m=a.ya,y=d[0].trace,v=d[0].t,T=i(a,c,f,g);if(!T)return[];var w=d[T.index],A=T.index=w.i,E=w.dir;function M(I){return v.labels[I]+t.hoverLabelText(m,y[I][A])}var b=w.hi||y.hoverinfo,_=b.split("+"),S=b==="all",C=S||_.indexOf("y")!==-1,k=S||_.indexOf("text")!==-1,L=C?[M("open"),M("high"),M("low"),M("close")+"  "+r[E]]:[];return k&&e(w,y,L),T.extraText=L.join("<br>"),T.y0=T.y1=m.c2p(w.yc,!0),[T]}z.exports={hoverPoints:function(a,c,f,g){return a.cd[0].trace.hoverlabel.split?u(a,c,f,g):s(a,c,f,g)},hoverSplit:u,hoverOnPoints:s}},{"../../components/color":643,"../../components/fx":683,"../../constants/delta.js":747,"../../lib":778,"../../plots/cartesian/axes":828}],1137:[function(n,z,q){"use strict";z.exports={moduleType:"trace",name:"ohlc",basePlotModule:n("../../plots/cartesian"),categories:["cartesian","svg","showLegend"],meta:{},attributes:n("./attributes"),supplyDefaults:n("./defaults"),calc:n("./calc").calc,plot:n("./plot"),style:n("./style"),hoverPoints:n("./hover").hoverPoints,selectPoints:n("./select")}},{"../../plots/cartesian":841,"./attributes":1133,"./calc":1134,"./defaults":1135,"./hover":1136,"./plot":1139,"./select":1140,"./style":1141}],1138:[function(n,z,q){"use strict";var t=n("../../registry"),h=n("../../lib");z.exports=function(p,l,e,o){var r=e("x"),i=e("open"),u=e("high"),s=e("low"),a=e("close");if(e("hoverlabel.split"),t.getComponentMethod("calendars","handleTraceDefaults")(p,l,["x"],o),i&&u&&s&&a){var c=Math.min(i.length,u.length,s.length,a.length);return r&&(c=Math.min(c,h.minRowLength(r))),l._length=c,c}}},{"../../lib":778,"../../registry":911}],1139:[function(n,z,q){"use strict";var t=n("d3"),h=n("../../lib");z.exports=function(p,l,e,o){var r=l.yaxis,i=l.xaxis,u=!!i.rangebreaks;h.makeTraceGroups(o,e,"trace ohlc").each(function(s){var a=t.select(this),c=s[0],f=c.t;if(c.trace.visible!==!0||f.empty)a.remove();else{var g=f.tickLen,d=a.selectAll("path").data(h.identity);d.enter().append("path"),d.exit().remove(),d.attr("d",function(m){if(m.empty)return"M0,0Z";var y=i.c2p(m.pos-g,!0),v=i.c2p(m.pos+g,!0),T=u?(y+v)/2:i.c2p(m.pos,!0);return"M"+y+","+r.c2p(m.o,!0)+"H"+T+"M"+T+","+r.c2p(m.h,!0)+"V"+r.c2p(m.l,!0)+"M"+v+","+r.c2p(m.c,!0)+"H"+T})}})}},{"../../lib":778,d3:169}],1140:[function(n,z,q){"use strict";z.exports=function(t,h){var p,l=t.cd,e=t.xaxis,o=t.yaxis,r=[],i=l[0].t.bPos||0;if(h===!1)for(p=0;p<l.length;p++)l[p].selected=0;else for(p=0;p<l.length;p++){var u=l[p];h.contains([e.c2p(u.pos+i),o.c2p(u.yc)],null,u.i,t)?(r.push({pointNumber:u.i,x:e.c2d(u.pos),y:o.c2d(u.yc)}),u.selected=1):u.selected=0}return r}},{}],1141:[function(n,z,q){"use strict";var t=n("d3"),h=n("../../components/drawing"),p=n("../../components/color");z.exports=function(l,e,o){var r=o||t.select(l).selectAll("g.ohlclayer").selectAll("g.trace");r.style("opacity",function(i){return i[0].trace.opacity}),r.each(function(i){var u=i[0].trace;t.select(this).selectAll("path").each(function(s){if(!s.empty){var a=u[s.dir].line;t.select(this).style("fill","none").call(p.stroke,a.color).call(h.dashLine,a.dash,a.width).style("opacity",u.selectedpoints&&!s.selected?.3:1)}})})}},{"../../components/color":643,"../../components/drawing":665,d3:169}],1142:[function(n,z,q){"use strict";var t=n("../../lib/extend").extendFlat,h=n("../../plots/attributes"),p=n("../../plots/font_attributes"),l=n("../../components/colorscale/attributes"),e=n("../../plots/template_attributes").hovertemplateAttrs,o=n("../../plots/domain").attributes,r=t({editType:"calc"},l("line",{editTypeOverride:"calc"}),{shape:{valType:"enumerated",values:["linear","hspline"],dflt:"linear",editType:"plot"},hovertemplate:e({editType:"plot",arrayOk:!1},{keys:["count","probability"]})});z.exports={domain:o({name:"parcats",trace:!0,editType:"calc"}),hoverinfo:t({},h.hoverinfo,{flags:["count","probability"],editType:"plot",arrayOk:!1}),hoveron:{valType:"enumerated",values:["category","color","dimension"],dflt:"category",editType:"plot"},hovertemplate:e({editType:"plot",arrayOk:!1},{keys:["count","probability","category","categorycount","colorcount","bandcolorcount"]}),arrangement:{valType:"enumerated",values:["perpendicular","freeform","fixed"],dflt:"perpendicular",editType:"plot"},bundlecolors:{valType:"boolean",dflt:!0,editType:"plot"},sortpaths:{valType:"enumerated",values:["forward","backward"],dflt:"forward",editType:"plot"},labelfont:p({editType:"calc"}),tickfont:p({editType:"calc"}),dimensions:{_isLinkedToArray:"dimension",label:{valType:"string",editType:"calc"},categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},ticktext:{valType:"data_array",editType:"calc"},values:{valType:"data_array",dflt:[],editType:"calc"},displayindex:{valType:"integer",editType:"calc"},editType:"calc",visible:{valType:"boolean",dflt:!0,editType:"calc"}},line:r,counts:{valType:"number",min:0,dflt:1,arrayOk:!0,editType:"calc"},customdata:void 0,hoverlabel:void 0,ids:void 0,legendgroup:void 0,opacity:void 0,selectedpoints:void 0,showlegend:void 0}},{"../../components/colorscale/attributes":650,"../../lib/extend":768,"../../plots/attributes":824,"../../plots/domain":855,"../../plots/font_attributes":856,"../../plots/template_attributes":906}],1143:[function(n,z,q){"use strict";var t=n("../../plots/get_data").getModuleCalcData,h=n("./plot");q.name="parcats",q.plot=function(p,l,e,o){var r=t(p.calcdata,"parcats");if(r.length){var i=r[0];h(p,i,e,o)}},q.clean=function(p,l,e,o){var r=o._has&&o._has("parcats"),i=l._has&&l._has("parcats");r&&!i&&o._paperdiv.selectAll(".parcats").remove()}},{"../../plots/get_data":865,"./plot":1148}],1144:[function(n,z,q){"use strict";var t=n("../../lib/gup").wrap,h=n("../../components/colorscale/helpers").hasColorscale,p=n("../../components/colorscale/calc"),l=n("../../lib/filter_unique.js"),e=n("../../components/drawing"),o=n("../../lib"),r=n("fast-isnumeric");function i(a,c,f){a.valueInds.push(c),a.count+=f}function u(a,c,f){return{categoryInds:a,color:c,rawColor:f,valueInds:[],count:0}}function s(a,c,f){a.valueInds.push(c),a.count+=f}z.exports=function(a,c){var f=o.filterVisible(c.dimensions);if(f.length===0)return[];var g,d,m,y=f.map(function(F){var H;if(F.categoryorder==="trace")H=null;else if(F.categoryorder==="array")H=F.categoryarray;else{H=l(F.values);for(var j=!0,G=0;G<H.length;G++)if(!r(H[G])){j=!1;break}H.sort(j?o.sorterAsc:void 0),F.categoryorder==="category descending"&&(H=H.reverse())}return function(W,Q){Q=Q==null?[]:Q.map(function(fe){return fe});var $={},ee={},ie=[];Q.forEach(function(fe,ue){$[fe]=0,ee[fe]=ue});for(var ae=0;ae<W.length;ae++){var oe,de=W[ae];$[de]===void 0?($[de]=1,oe=Q.push(de)-1,ee[de]=oe):($[de]++,oe=ee[de]),ie.push(oe)}var le=Q.map(function(fe){return $[fe]});return{uniqueValues:Q,uniqueCounts:le,inds:ie}}(F.values,H)});g=o.isArrayOrTypedArray(c.counts)?c.counts:[c.counts],function(F){var H;if(function(j){for(var G=new Array(j.length),W=0;W<j.length;W++){if(j[W]<0||j[W]>=j.length||G[j[W]]!==void 0)return!1;G[j[W]]=!0}return!0}(F.map(function(j){return j.displayindex})))for(H=0;H<F.length;H++)F[H]._displayindex=F[H].displayindex;else for(H=0;H<F.length;H++)F[H]._displayindex=H}(f),f.forEach(function(F,H){(function(j,G){j._categoryarray=G.uniqueValues,j.ticktext===null||j.ticktext===void 0?j._ticktext=[]:j._ticktext=j.ticktext.slice();for(var W=j._ticktext.length;W<G.uniqueValues.length;W++)j._ticktext.push(G.uniqueValues[W])})(F,y[H])});var v,T=c.line;T?(h(c,"line")&&p(a,c,{vals:c.line.color,containerStr:"line",cLetter:"c"}),v=e.tryColorscale(T)):v=o.identity;var w,A,E,M,b,_=f[0].values.length,S={},C=y.map(function(F){return F.inds});for(m=0,w=0;w<_;w++){var k=[];for(A=0;A<C.length;A++)k.push(C[A][w]);d=g[w%g.length],m+=d;var L=(E=w,M=void 0,b=void 0,o.isArrayOrTypedArray(T.color)?b=M=T.color[E%T.color.length]:M=T.color,{color:v(M),rawColor:b}),I=k+"-"+L.rawColor;S[I]===void 0&&(S[I]=u(k,L.color,L.rawColor)),s(S[I],w,d)}var R,V=f.map(function(F,H){return function(j,G,W,Q,$){return{dimensionInd:j,containerInd:G,displayInd:W,dimensionLabel:Q,count:$,categories:[],dragX:null}}(H,F._index,F._displayindex,F.label,m)});for(w=0;w<_;w++)for(d=g[w%g.length],A=0;A<V.length;A++){var O=V[A].containerInd,J=y[A].inds[w],D=V[A].categories;if(D[J]===void 0){var B=c.dimensions[O]._categoryarray[J],N=c.dimensions[O]._ticktext[J];D[J]={dimensionInd:A,categoryInd:R=J,categoryValue:B,displayInd:R,categoryLabel:N,valueInds:[],count:0,dragY:null}}i(D[J],w,d)}return t(function(F,H,j){var G=F.map(function(W){return W.categories.length}).reduce(function(W,Q){return Math.max(W,Q)});return{dimensions:F,paths:H,trace:void 0,maxCats:G,count:j}}(V,S,m))}},{"../../components/colorscale/calc":651,"../../components/colorscale/helpers":654,"../../components/drawing":665,"../../lib":778,"../../lib/filter_unique.js":769,"../../lib/gup":775,"fast-isnumeric":241}],1145:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../../components/colorscale/helpers").hasColorscale,p=n("../../components/colorscale/defaults"),l=n("../../plots/domain").defaults,e=n("../../plots/array_container_defaults"),o=n("./attributes"),r=n("../parcoords/merge_length");function i(u,s){function a(v,T){return t.coerce(u,s,o.dimensions,v,T)}var c=a("values"),f=a("visible");if(c&&c.length||(f=s.visible=!1),f){a("label"),a("displayindex",s._index);var g,d=u.categoryarray,m=Array.isArray(d)&&d.length>0;m&&(g="array");var y=a("categoryorder",g);y==="array"?(a("categoryarray"),a("ticktext")):(delete u.categoryarray,delete u.ticktext),m||y!=="array"||(s.categoryorder="trace")}}z.exports=function(u,s,a,c){function f(v,T){return t.coerce(u,s,o,v,T)}var g=e(u,s,{name:"dimensions",handleItemDefaults:i}),d=function(v,T,w,A,E){E("line.shape"),E("line.hovertemplate");var M=E("line.color",A.colorway[0]);if(h(v,"line")&&t.isArrayOrTypedArray(M)){if(M.length)return E("line.colorscale"),p(v,T,A,E,{prefix:"line.",cLetter:"c"}),M.length;T.line.color=w}return 1/0}(u,s,a,c,f);l(s,c,f),Array.isArray(g)&&g.length||(s.visible=!1),r(s,g,"values",d),f("hoveron"),f("hovertemplate"),f("arrangement"),f("bundlecolors"),f("sortpaths"),f("counts");var m={family:c.font.family,size:Math.round(c.font.size),color:c.font.color};t.coerceFont(f,"labelfont",m);var y={family:c.font.family,size:Math.round(c.font.size/1.2),color:c.font.color};t.coerceFont(f,"tickfont",y)}},{"../../components/colorscale/defaults":653,"../../components/colorscale/helpers":654,"../../lib":778,"../../plots/array_container_defaults":823,"../../plots/domain":855,"../parcoords/merge_length":1158,"./attributes":1142}],1146:[function(n,z,q){"use strict";z.exports={attributes:n("./attributes"),supplyDefaults:n("./defaults"),calc:n("./calc"),plot:n("./plot"),colorbar:{container:"line",min:"cmin",max:"cmax"},moduleType:"trace",name:"parcats",basePlotModule:n("./base_plot"),categories:["noOpacity"],meta:{}}},{"./attributes":1142,"./base_plot":1143,"./calc":1144,"./defaults":1145,"./plot":1148}],1147:[function(n,z,q){"use strict";var t=n("d3"),h=n("../../plot_api/plot_api"),p=n("../../components/fx"),l=n("../../lib"),e=l.strTranslate,o=n("../../components/drawing"),r=n("tinycolor2"),i=n("../../lib/svg_text_utils");function u(H,j,G,W){var Q=H.map(J.bind(0,j,G)),$=W.selectAll("g.parcatslayer").data([null]);$.enter().append("g").attr("class","parcatslayer").style("pointer-events","all");var ee=$.selectAll("g.trace.parcats").data(Q,s),ie=ee.enter().append("g").attr("class","trace parcats");ee.attr("transform",function(Se){return e(Se.x,Se.y)}),ie.append("g").attr("class","paths");var ae=ee.select("g.paths").selectAll("path.path").data(function(Se){return Se.paths},s);ae.attr("fill",function(Se){return Se.model.color});var oe=ae.enter().append("path").attr("class","path").attr("stroke-opacity",0).attr("fill",function(Se){return Se.model.color}).attr("fill-opacity",0);v(oe),ae.attr("d",function(Se){return Se.svgD}),oe.empty()||ae.sort(c),ae.exit().remove(),ae.on("mouseover",f).on("mouseout",g).on("click",y),ie.append("g").attr("class","dimensions");var de=ee.select("g.dimensions").selectAll("g.dimension").data(function(Se){return Se.dimensions},s);de.enter().append("g").attr("class","dimension"),de.attr("transform",function(Se){return e(Se.x,0)}),de.exit().remove();var le=de.selectAll("g.category").data(function(Se){return Se.categories},s),fe=le.enter().append("g").attr("class","category");le.attr("transform",function(Se){return e(0,Se.y)}),fe.append("rect").attr("class","catrect").attr("pointer-events","none"),le.select("rect.catrect").attr("fill","none").attr("width",function(Se){return Se.width}).attr("height",function(Se){return Se.height}),w(fe);var ue=le.selectAll("rect.bandrect").data(function(Se){return Se.bands},s);ue.each(function(){l.raiseToTop(this)}),ue.attr("fill",function(Se){return Se.color});var we=ue.enter().append("rect").attr("class","bandrect").attr("stroke-opacity",0).attr("fill",function(Se){return Se.color}).attr("fill-opacity",0);ue.attr("fill",function(Se){return Se.color}).attr("width",function(Se){return Se.width}).attr("height",function(Se){return Se.height}).attr("y",function(Se){return Se.y}).attr("cursor",function(Se){return Se.parcatsViewModel.arrangement==="fixed"?"default":Se.parcatsViewModel.arrangement==="perpendicular"?"ns-resize":"move"}),A(we),ue.exit().remove(),fe.append("text").attr("class","catlabel").attr("pointer-events","none");var Ae=j._fullLayout.paper_bgcolor;le.select("text.catlabel").attr("text-anchor",function(Se){return a(Se)?"start":"end"}).attr("alignment-baseline","middle").style("text-shadow",Ae+" -1px  1px 2px, "+Ae+" 1px  1px 2px, "+Ae+"  1px -1px 2px, "+Ae+" -1px -1px 2px").style("fill","rgb(0, 0, 0)").attr("x",function(Se){return a(Se)?Se.width+5:-5}).attr("y",function(Se){return Se.height/2}).text(function(Se){return Se.model.categoryLabel}).each(function(Se){o.font(t.select(this),Se.parcatsViewModel.categorylabelfont),i.convertToTspans(t.select(this),j)}),fe.append("text").attr("class","dimlabel"),le.select("text.dimlabel").attr("text-anchor","middle").attr("alignment-baseline","baseline").attr("cursor",function(Se){return Se.parcatsViewModel.arrangement==="fixed"?"default":"ew-resize"}).attr("x",function(Se){return Se.width/2}).attr("y",-5).text(function(Se,ke){return ke===0?Se.parcatsViewModel.model.dimensions[Se.model.dimensionInd].dimensionLabel:null}).each(function(Se){o.font(t.select(this),Se.parcatsViewModel.labelfont)}),le.selectAll("rect.bandrect").on("mouseover",S).on("mouseout",C),le.exit().remove(),de.call(t.behavior.drag().origin(function(Se){return{x:Se.x,y:0}}).on("dragstart",k).on("drag",L).on("dragend",I)),ee.each(function(Se){Se.traceSelection=t.select(this),Se.pathSelection=t.select(this).selectAll("g.paths").selectAll("path.path"),Se.dimensionSelection=t.select(this).selectAll("g.dimensions").selectAll("g.dimension")}),ee.exit().remove()}function s(H){return H.key}function a(H){var j=H.parcatsViewModel.dimensions.length,G=H.parcatsViewModel.dimensions[j-1].model.dimensionInd;return H.model.dimensionInd===G}function c(H,j){return H.model.rawColor>j.model.rawColor?1:H.model.rawColor<j.model.rawColor?-1:0}function f(H){if(!H.parcatsViewModel.dragDimension&&H.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1){l.raiseToTop(this),T(t.select(this));var j=d(H),G=m(H);if(H.parcatsViewModel.graphDiv.emit("plotly_hover",{points:j,event:t.event,constraints:G}),H.parcatsViewModel.hoverinfoItems.indexOf("none")===-1){var W,Q,$,ee=t.mouse(this)[0],ie=H.parcatsViewModel.graphDiv,ae=H.parcatsViewModel.trace,oe=ie._fullLayout,de=oe._paperdiv.node().getBoundingClientRect(),le=H.parcatsViewModel.graphDiv.getBoundingClientRect();for($=0;$<H.leftXs.length-1;$++)if(H.leftXs[$]+H.dimWidths[$]-2<=ee&&ee<=H.leftXs[$+1]+2){var fe=H.parcatsViewModel.dimensions[$],ue=H.parcatsViewModel.dimensions[$+1];W=(fe.x+fe.width+ue.x)/2,Q=(H.topYs[$]+H.topYs[$+1]+H.height)/2;break}var we=H.parcatsViewModel.x+W,Ae=H.parcatsViewModel.y+Q,Se=r.mostReadable(H.model.color,["black","white"]),ke=H.model.count,Me=ke/H.parcatsViewModel.model.count,ve={countLabel:ke,probabilityLabel:Me.toFixed(3)},ge=[];H.parcatsViewModel.hoverinfoItems.indexOf("count")!==-1&&ge.push(["Count:",ve.countLabel].join(" ")),H.parcatsViewModel.hoverinfoItems.indexOf("probability")!==-1&&ge.push(["P:",ve.probabilityLabel].join(" "));var De=ge.join("<br>"),_e=t.mouse(ie)[0];p.loneHover({trace:ae,x:we-de.left+le.left,y:Ae-de.top+le.top,text:De,color:H.model.color,borderColor:"black",fontFamily:'Monaco, "Courier New", monospace',fontSize:10,fontColor:Se,idealAlign:_e<we?"right":"left",hovertemplate:(ae.line||{}).hovertemplate,hovertemplateLabels:ve,eventData:[{data:ae._input,fullData:ae,count:ke,probability:Me}]},{container:oe._hoverlayer.node(),outerContainer:oe._paper.node(),gd:ie})}}}function g(H){if(!H.parcatsViewModel.dragDimension&&(v(t.select(this)),p.loneUnhover(H.parcatsViewModel.graphDiv._fullLayout._hoverlayer.node()),H.parcatsViewModel.pathSelection.sort(c),H.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1)){var j=d(H),G=m(H);H.parcatsViewModel.graphDiv.emit("plotly_unhover",{points:j,event:t.event,constraints:G})}}function d(H){for(var j=[],G=R(H.parcatsViewModel),W=0;W<H.model.valueInds.length;W++){var Q=H.model.valueInds[W];j.push({curveNumber:G,pointNumber:Q})}return j}function m(H){for(var j={},G=H.parcatsViewModel.model.dimensions,W=0;W<G.length;W++){var Q=G[W],$=Q.categories[H.model.categoryInds[W]];j[Q.containerInd]=$.categoryValue}return H.model.rawColor!==void 0&&(j.color=H.model.rawColor),j}function y(H){if(H.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1){var j=d(H),G=m(H);H.parcatsViewModel.graphDiv.emit("plotly_click",{points:j,event:t.event,constraints:G})}}function v(H){H.attr("fill",function(j){return j.model.color}).attr("fill-opacity",.6).attr("stroke","lightgray").attr("stroke-width",.2).attr("stroke-opacity",1)}function T(H){H.attr("fill-opacity",.8).attr("stroke",function(j){return r.mostReadable(j.model.color,["black","white"])}).attr("stroke-width",.3)}function w(H){H.select("rect.catrect").attr("stroke","black").attr("stroke-width",1).attr("stroke-opacity",1)}function A(H){H.attr("stroke","black").attr("stroke-width",.2).attr("stroke-opacity",1).attr("fill-opacity",1)}function E(H){var j=H.parcatsViewModel.pathSelection,G=H.categoryViewModel.model.dimensionInd,W=H.categoryViewModel.model.categoryInd;return j.filter(function(Q){return Q.model.categoryInds[G]===W&&Q.model.color===H.color})}function M(H,j,G){var W=t.select(H).datum(),Q=W.categoryViewModel.model,$=W.parcatsViewModel.graphDiv,ee=t.select(H.parentNode).selectAll("rect.bandrect"),ie=[];ee.each(function(oe){E(oe).each(function(de){Array.prototype.push.apply(ie,d(de))})});var ae={};ae[Q.dimensionInd]=Q.categoryValue,$.emit(j,{points:ie,event:G,constraints:ae})}function b(H,j,G){var W=t.select(H).datum(),Q=W.categoryViewModel.model,$=W.parcatsViewModel.graphDiv,ee=E(W),ie=[];ee.each(function(oe){Array.prototype.push.apply(ie,d(oe))});var ae={};ae[Q.dimensionInd]=Q.categoryValue,W.rawColor!==void 0&&(ae.color=W.rawColor),$.emit(j,{points:ie,event:G,constraints:ae})}function _(H,j,G){H._fullLayout._calcInverseTransform(H);var W,Q,$=H._fullLayout._invScaleX,ee=H._fullLayout._invScaleY,ie=t.select(G.parentNode).select("rect.catrect"),ae=ie.node().getBoundingClientRect(),oe=ie.datum(),de=oe.parcatsViewModel,le=de.model.dimensions[oe.model.dimensionInd],fe=de.trace,ue=ae.top+ae.height/2;de.dimensions.length>1&&le.displayInd===de.dimensions.length-1?(W=ae.left,Q="left"):(W=ae.left+ae.width,Q="right");var we=oe.model.count,Ae=oe.model.categoryLabel,Se=we/oe.parcatsViewModel.model.count,ke={countLabel:we,categoryLabel:Ae,probabilityLabel:Se.toFixed(3)},Me=[];oe.parcatsViewModel.hoverinfoItems.indexOf("count")!==-1&&Me.push(["Count:",ke.countLabel].join(" ")),oe.parcatsViewModel.hoverinfoItems.indexOf("probability")!==-1&&Me.push(["P("+ke.categoryLabel+"):",ke.probabilityLabel].join(" "));var ve=Me.join("<br>");return{trace:fe,x:$*(W-j.left),y:ee*(ue-j.top),text:ve,color:"lightgray",borderColor:"black",fontFamily:'Monaco, "Courier New", monospace',fontSize:12,fontColor:"black",idealAlign:Q,hovertemplate:fe.hovertemplate,hovertemplateLabels:ke,eventData:[{data:fe._input,fullData:fe,count:we,category:Ae,probability:Se}]}}function S(H){if(!H.parcatsViewModel.dragDimension&&H.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1){if(t.mouse(this)[1]<-1)return;var j,G=H.parcatsViewModel.graphDiv,W=G._fullLayout,Q=W._paperdiv.node().getBoundingClientRect(),$=H.parcatsViewModel.hoveron;$==="color"?(function(ee){var ie=t.select(ee).datum(),ae=E(ie);T(ae),ae.each(function(){l.raiseToTop(this)}),t.select(ee.parentNode).selectAll("rect.bandrect").filter(function(oe){return oe.color===ie.color}).each(function(){l.raiseToTop(this),t.select(this).attr("stroke","black").attr("stroke-width",1.5)})}(this),b(this,"plotly_hover",t.event)):(function(ee){t.select(ee.parentNode).selectAll("rect.bandrect").each(function(ie){var ae=E(ie);T(ae),ae.each(function(){l.raiseToTop(this)})}),t.select(ee.parentNode).select("rect.catrect").attr("stroke","black").attr("stroke-width",2.5)}(this),M(this,"plotly_hover",t.event)),H.parcatsViewModel.hoverinfoItems.indexOf("none")===-1&&($==="category"?j=_(G,Q,this):$==="color"?j=function(ee,ie,ae){ee._fullLayout._calcInverseTransform(ee);var oe,de,le=ee._fullLayout._invScaleX,fe=ee._fullLayout._invScaleY,ue=ae.getBoundingClientRect(),we=t.select(ae).datum(),Ae=we.categoryViewModel,Se=Ae.parcatsViewModel,ke=Se.model.dimensions[Ae.model.dimensionInd],Me=Se.trace,ve=ue.y+ue.height/2;Se.dimensions.length>1&&ke.displayInd===Se.dimensions.length-1?(oe=ue.left,de="left"):(oe=ue.left+ue.width,de="right");var ge=Ae.model.categoryLabel,De=we.parcatsViewModel.model.count,_e=0;we.categoryViewModel.bands.forEach(function(rt){rt.color===we.color&&(_e+=rt.count)});var Pe=Ae.model.count,Fe=0;Se.pathSelection.each(function(rt){rt.model.color===we.color&&(Fe+=rt.model.count)});var ze=_e/De,He=_e/Fe,et=_e/Pe,Re={countLabel:De,categoryLabel:ge,probabilityLabel:ze.toFixed(3)},Ze=[];Ae.parcatsViewModel.hoverinfoItems.indexOf("count")!==-1&&Ze.push(["Count:",Re.countLabel].join(" ")),Ae.parcatsViewModel.hoverinfoItems.indexOf("probability")!==-1&&(Ze.push("P(color \u2229 "+ge+"): "+Re.probabilityLabel),Ze.push("P("+ge+" | color): "+He.toFixed(3)),Ze.push("P(color | "+ge+"): "+et.toFixed(3)));var Ke=Ze.join("<br>"),$e=r.mostReadable(we.color,["black","white"]);return{trace:Me,x:le*(oe-ie.left),y:fe*(ve-ie.top),text:Ke,color:we.color,borderColor:"black",fontFamily:'Monaco, "Courier New", monospace',fontColor:$e,fontSize:10,idealAlign:de,hovertemplate:Me.hovertemplate,hovertemplateLabels:Re,eventData:[{data:Me._input,fullData:Me,category:ge,count:De,probability:ze,categorycount:Pe,colorcount:Fe,bandcolorcount:_e}]}}(G,Q,this):$==="dimension"&&(j=function(ee,ie,ae){var oe=[];return t.select(ae.parentNode.parentNode).selectAll("g.category").select("rect.catrect").each(function(){oe.push(_(ee,ie,this))}),oe}(G,Q,this)),j&&p.loneHover(j,{container:W._hoverlayer.node(),outerContainer:W._paper.node(),gd:G}))}}function C(H){var j=H.parcatsViewModel;!j.dragDimension&&(v(j.pathSelection),w(j.dimensionSelection.selectAll("g.category")),A(j.dimensionSelection.selectAll("g.category").selectAll("rect.bandrect")),p.loneUnhover(j.graphDiv._fullLayout._hoverlayer.node()),j.pathSelection.sort(c),j.hoverinfoItems.indexOf("skip")===-1)&&(H.parcatsViewModel.hoveron==="color"?b(this,"plotly_unhover",t.event):M(this,"plotly_unhover",t.event))}function k(H){H.parcatsViewModel.arrangement!=="fixed"&&(H.dragDimensionDisplayInd=H.model.displayInd,H.initialDragDimensionDisplayInds=H.parcatsViewModel.model.dimensions.map(function(j){return j.displayInd}),H.dragHasMoved=!1,H.dragCategoryDisplayInd=null,t.select(this).selectAll("g.category").select("rect.catrect").each(function(j){var G=t.mouse(this)[0],W=t.mouse(this)[1];-2<=G&&G<=j.width+2&&-2<=W&&W<=j.height+2&&(H.dragCategoryDisplayInd=j.model.displayInd,H.initialDragCategoryDisplayInds=H.model.categories.map(function(Q){return Q.displayInd}),j.model.dragY=j.y,l.raiseToTop(this.parentNode),t.select(this.parentNode).selectAll("rect.bandrect").each(function(Q){Q.y<W&&W<=Q.y+Q.height&&(H.potentialClickBand=this)}))}),H.parcatsViewModel.dragDimension=H,p.loneUnhover(H.parcatsViewModel.graphDiv._fullLayout._hoverlayer.node()))}function L(H){if(H.parcatsViewModel.arrangement!=="fixed"&&(H.dragHasMoved=!0,H.dragDimensionDisplayInd!==null)){var j=H.dragDimensionDisplayInd,G=j-1,W=j+1,Q=H.parcatsViewModel.dimensions[j];if(H.dragCategoryDisplayInd!==null){var $=Q.categories[H.dragCategoryDisplayInd];$.model.dragY+=t.event.dy;var ee=$.model.dragY,ie=$.model.displayInd,ae=Q.categories,oe=ae[ie-1],de=ae[ie+1];oe!==void 0&&ee<oe.y+oe.height/2&&($.model.displayInd=oe.model.displayInd,oe.model.displayInd=ie),de!==void 0&&ee+$.height>de.y+de.height/2&&($.model.displayInd=de.model.displayInd,de.model.displayInd=ie),H.dragCategoryDisplayInd=$.model.displayInd}if(H.dragCategoryDisplayInd===null||H.parcatsViewModel.arrangement==="freeform"){Q.model.dragX=t.event.x;var le=H.parcatsViewModel.dimensions[G],fe=H.parcatsViewModel.dimensions[W];le!==void 0&&Q.model.dragX<le.x+le.width&&(Q.model.displayInd=le.model.displayInd,le.model.displayInd=j),fe!==void 0&&Q.model.dragX+Q.width>fe.x&&(Q.model.displayInd=fe.model.displayInd,fe.model.displayInd=H.dragDimensionDisplayInd),H.dragDimensionDisplayInd=Q.model.displayInd}N(H.parcatsViewModel),B(H.parcatsViewModel),O(H.parcatsViewModel),V(H.parcatsViewModel)}}function I(H){if(H.parcatsViewModel.arrangement!=="fixed"&&H.dragDimensionDisplayInd!==null){t.select(this).selectAll("text").attr("font-weight","normal");var j={},G=R(H.parcatsViewModel),W=H.parcatsViewModel.model.dimensions.map(function(de){return de.displayInd}),Q=H.initialDragDimensionDisplayInds.some(function(de,le){return de!==W[le]});Q&&W.forEach(function(de,le){var fe=H.parcatsViewModel.model.dimensions[le].containerInd;j["dimensions["+fe+"].displayindex"]=de});var $=!1;if(H.dragCategoryDisplayInd!==null){var ee=H.model.categories.map(function(de){return de.displayInd});if($=H.initialDragCategoryDisplayInds.some(function(de,le){return de!==ee[le]})){var ie=H.model.categories.slice().sort(function(de,le){return de.displayInd-le.displayInd}),ae=ie.map(function(de){return de.categoryValue}),oe=ie.map(function(de){return de.categoryLabel});j["dimensions["+H.model.containerInd+"].categoryarray"]=[ae],j["dimensions["+H.model.containerInd+"].ticktext"]=[oe],j["dimensions["+H.model.containerInd+"].categoryorder"]="array"}}H.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1&&!H.dragHasMoved&&H.potentialClickBand&&(H.parcatsViewModel.hoveron==="color"?b(H.potentialClickBand,"plotly_click",t.event.sourceEvent):M(H.potentialClickBand,"plotly_click",t.event.sourceEvent)),H.model.dragX=null,H.dragCategoryDisplayInd!==null&&(H.parcatsViewModel.dimensions[H.dragDimensionDisplayInd].categories[H.dragCategoryDisplayInd].model.dragY=null,H.dragCategoryDisplayInd=null),H.dragDimensionDisplayInd=null,H.parcatsViewModel.dragDimension=null,H.dragHasMoved=null,H.potentialClickBand=null,N(H.parcatsViewModel),B(H.parcatsViewModel),t.transition().duration(300).ease("cubic-in-out").each(function(){O(H.parcatsViewModel,!0),V(H.parcatsViewModel,!0)}).each("end",function(){(Q||$)&&h.restyle(H.parcatsViewModel.graphDiv,j,[G])})}}function R(H){for(var j,G=H.graphDiv._fullData,W=0;W<G.length;W++)if(H.key===G[W].uid){j=W;break}return j}function V(H,j){var G;j===void 0&&(j=!1),H.pathSelection.data(function(W){return W.paths},s),(G=H.pathSelection,j?G.transition():G).attr("d",function(W){return W.svgD})}function O(H,j){function G(ee){return j?ee.transition():ee}j===void 0&&(j=!1),H.dimensionSelection.data(function(ee){return ee.dimensions},s);var W=H.dimensionSelection.selectAll("g.category").data(function(ee){return ee.categories},s);G(H.dimensionSelection).attr("transform",function(ee){return e(ee.x,0)}),G(W).attr("transform",function(ee){return e(0,ee.y)}),W.select(".dimlabel").text(function(ee,ie){return ie===0?ee.parcatsViewModel.model.dimensions[ee.model.dimensionInd].dimensionLabel:null}),W.select(".catlabel").attr("text-anchor",function(ee){return a(ee)?"start":"end"}).attr("x",function(ee){return a(ee)?ee.width+5:-5}).each(function(ee){var ie,ae;a(ee)?(ie=ee.width+5,ae="start"):(ie=-5,ae="end"),t.select(this).selectAll("tspan").attr("x",ie).attr("text-anchor",ae)});var Q=W.selectAll("rect.bandrect").data(function(ee){return ee.bands},s),$=Q.enter().append("rect").attr("class","bandrect").attr("cursor","move").attr("stroke-opacity",0).attr("fill",function(ee){return ee.color}).attr("fill-opacity",0);Q.attr("fill",function(ee){return ee.color}).attr("width",function(ee){return ee.width}).attr("height",function(ee){return ee.height}).attr("y",function(ee){return ee.y}),A($),Q.each(function(){l.raiseToTop(this)}),Q.exit().remove()}function J(H,j,G){var W,Q=G[0],$=j.margin||{l:80,r:80,t:100,b:80},ee=Q.trace,ie=ee.domain,ae=j.width,oe=j.height,de=Math.floor(ae*(ie.x[1]-ie.x[0])),le=Math.floor(oe*(ie.y[1]-ie.y[0])),fe=ie.x[0]*ae+$.l,ue=j.height-ie.y[1]*j.height+$.t,we=ee.line.shape;W=ee.hoverinfo==="all"?["count","probability"]:(ee.hoverinfo||"").split("+");var Ae={trace:ee,key:ee.uid,model:Q,x:fe,y:ue,width:de,height:le,hoveron:ee.hoveron,hoverinfoItems:W,arrangement:ee.arrangement,bundlecolors:ee.bundlecolors,sortpaths:ee.sortpaths,labelfont:ee.labelfont,categorylabelfont:ee.tickfont,pathShape:we,dragDimension:null,margin:$,paths:[],dimensions:[],graphDiv:H,traceSelection:null,pathSelection:null,dimensionSelection:null};return Q.dimensions&&(N(Ae),B(Ae)),Ae}function D(H,j,G,W,Q){var $,ee,ie=[],ae=[];for(ee=0;ee<G.length-1;ee++)$=t.interpolateNumber(G[ee]+H[ee],H[ee+1]),ie.push($(Q)),ae.push($(1-Q));var oe="M "+H[0]+","+j[0];for(oe+="l"+G[0]+",0 ",ee=1;ee<G.length;ee++)oe+="C"+ie[ee-1]+","+j[ee-1]+" "+ae[ee-1]+","+j[ee]+" "+H[ee]+","+j[ee],oe+="l"+G[ee]+",0 ";for(oe+="l0,"+W+" ",oe+="l -"+G[G.length-1]+",0 ",ee=G.length-2;ee>=0;ee--)oe+="C"+ae[ee]+","+(j[ee+1]+W)+" "+ie[ee]+","+(j[ee]+W)+" "+(H[ee]+G[ee])+","+(j[ee]+W),oe+="l-"+G[ee]+",0 ";return oe+="Z"}function B(H){var j=H.dimensions,G=H.model,W=j.map(function(Ze){return Ze.categories.map(function(Ke){return Ke.y})}),Q=H.model.dimensions.map(function(Ze){return Ze.categories.map(function(Ke){return Ke.displayInd})}),$=H.model.dimensions.map(function(Ze){return Ze.displayInd}),ee=H.dimensions.map(function(Ze){return Ze.model.dimensionInd}),ie=j.map(function(Ze){return Ze.x}),ae=j.map(function(Ze){return Ze.width}),oe=[];for(var de in G.paths)G.paths.hasOwnProperty(de)&&oe.push(G.paths[de]);function le(Ze){var Ke=Ze.categoryInds.map(function($e,rt){return Q[rt][$e]});return ee.map(function($e){return Ke[$e]})}oe.sort(function(Ze,Ke){var $e=le(Ze),rt=le(Ke);return H.sortpaths==="backward"&&($e.reverse(),rt.reverse()),$e.push(Ze.valueInds[0]),rt.push(Ke.valueInds[0]),H.bundlecolors&&($e.unshift(Ze.rawColor),rt.unshift(Ke.rawColor)),$e<rt?-1:$e>rt?1:0});for(var fe=new Array(oe.length),ue=j[0].model.count,we=j[0].categories.map(function(Ze){return Ze.height}).reduce(function(Ze,Ke){return Ze+Ke}),Ae=0;Ae<oe.length;Ae++){var Se,ke=oe[Ae];Se=ue>0?we*(ke.count/ue):0;for(var Me,ve=new Array(W.length),ge=0;ge<ke.categoryInds.length;ge++){var De=ke.categoryInds[ge],_e=Q[ge][De],Pe=$[ge];ve[Pe]=W[Pe][_e],W[Pe][_e]+=Se;var Fe=H.dimensions[Pe].categories[_e],ze=Fe.bands.length,He=Fe.bands[ze-1];if(He===void 0||ke.rawColor!==He.rawColor){var et=He===void 0?0:He.y+He.height;Fe.bands.push({key:et,color:ke.color,rawColor:ke.rawColor,height:Se,width:Fe.width,count:ke.count,y:et,categoryViewModel:Fe,parcatsViewModel:H})}else{var Re=Fe.bands[ze-1];Re.height+=Se,Re.count+=ke.count}}Me=H.pathShape==="hspline"?D(ie,ve,ae,Se,.5):D(ie,ve,ae,Se,0),fe[Ae]={key:ke.valueInds[0],model:ke,height:Se,leftXs:ie,topYs:ve,dimWidths:ae,svgD:Me,parcatsViewModel:H}}H.paths=fe}function N(H){var j=H.model.dimensions.map(function(ee){return{displayInd:ee.displayInd,dimensionInd:ee.dimensionInd}});j.sort(function(ee,ie){return ee.displayInd-ie.displayInd});var G=[];for(var W in j){var Q=j[W].dimensionInd,$=H.model.dimensions[Q];G.push(F(H,$))}H.dimensions=G}function F(H,j){var G,W=H.model.dimensions.length,Q=j.displayInd;G=40+(W>1?(H.width-80-16)/(W-1):0)*Q;var $,ee,ie,ae,oe,de=[],le=H.model.maxCats,fe=j.categories.length,ue=j.count,we=H.height-8*(le-1),Ae=8*(le-fe)/2,Se=j.categories.map(function(ke){return{displayInd:ke.displayInd,categoryInd:ke.categoryInd}});for(Se.sort(function(ke,Me){return ke.displayInd-Me.displayInd}),oe=0;oe<fe;oe++)ae=Se[oe].categoryInd,ee=j.categories[ae],$=ue>0?ee.count/ue*we:0,ie={key:ee.valueInds[0],model:ee,width:16,height:$,y:ee.dragY!==null?ee.dragY:Ae,bands:[],parcatsViewModel:H},Ae=Ae+$+8,de.push(ie);return{key:j.dimensionInd,x:j.dragX!==null?j.dragX:G,y:0,width:16,model:j,categories:de,parcatsViewModel:H,dragCategoryDisplayInd:null,dragDimensionDisplayInd:null,initialDragDimensionDisplayInds:null,initialDragCategoryDisplayInds:null,dragHasMoved:null,potentialClickBand:null}}z.exports=function(H,j,G,W){u(G,H,W,j)}},{"../../components/drawing":665,"../../components/fx":683,"../../lib":778,"../../lib/svg_text_utils":803,"../../plot_api/plot_api":814,d3:169,tinycolor2:576}],1148:[function(n,z,q){"use strict";var t=n("./parcats");z.exports=function(h,p,l,e){var o=h._fullLayout,r=o._paper,i=o._size;t(h,r,p,{width:i.w,height:i.h,margin:{t:i.t,r:i.r,b:i.b,l:i.l}},l,e)}},{"./parcats":1147}],1149:[function(n,z,q){"use strict";var t=n("../../components/colorscale/attributes"),h=n("../../plots/cartesian/layout_attributes"),p=n("../../plots/font_attributes"),l=n("../../plots/domain").attributes,e=n("../../lib/extend").extendFlat,o=n("../../plot_api/plot_template").templatedArray;z.exports={domain:l({name:"parcoords",trace:!0,editType:"plot"}),labelangle:{valType:"angle",dflt:0,editType:"plot"},labelside:{valType:"enumerated",values:["top","bottom"],dflt:"top",editType:"plot"},labelfont:p({editType:"plot"}),tickfont:p({editType:"plot"}),rangefont:p({editType:"plot"}),dimensions:o("dimension",{label:{valType:"string",editType:"plot"},tickvals:e({},h.tickvals,{editType:"plot"}),ticktext:e({},h.ticktext,{editType:"plot"}),tickformat:e({},h.tickformat,{editType:"plot"}),visible:{valType:"boolean",dflt:!0,editType:"plot"},range:{valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],editType:"plot"},constraintrange:{valType:"info_array",freeLength:!0,dimensions:"1-2",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],editType:"plot"},multiselect:{valType:"boolean",dflt:!0,editType:"plot"},values:{valType:"data_array",editType:"calc"},editType:"calc"}),line:e({editType:"calc"},t("line",{colorscaleDflt:"Viridis",autoColorDflt:!1,editTypeOverride:"calc"}))}},{"../../components/colorscale/attributes":650,"../../lib/extend":768,"../../plot_api/plot_template":817,"../../plots/cartesian/layout_attributes":842,"../../plots/domain":855,"../../plots/font_attributes":856}],1150:[function(n,z,q){"use strict";var t=n("./constants"),h=n("d3"),p=n("../../lib/gup").keyFun,l=n("../../lib/gup").repeat,e=n("../../lib").sorterAsc,o=n("../../lib").strTranslate,r=t.bar.snapRatio;function i(S,C){return S*(1-r)+C*r}var u=t.bar.snapClose;function s(S,C){return S*(1-u)+C*u}function a(S,C,k,L){if(function(H,j){for(var G=0;G<j.length;G++)if(H>=j[G][0]&&H<=j[G][1])return!0;return!1}(k,L))return k;var I=S?-1:1,R=0,V=C.length-1;if(I<0){var O=R;R=V,V=O}for(var J=C[R],D=J,B=R;I*B<I*V;B+=I){var N=B+I,F=C[N];if(I*k<I*s(J,F))return i(J,D);if(I*k<I*F||N===V)return i(F,J);D=J,J=F}}function c(S){S.attr("x",-t.bar.captureWidth/2).attr("width",t.bar.captureWidth)}function f(S){S.attr("visibility","visible").style("visibility","visible").attr("fill","yellow").attr("opacity",0)}function g(S){if(!S.brush.filterSpecified)return"0,"+S.height;for(var C,k,L,I=d(S.brush.filter.getConsolidated(),S.height),R=[0],V=I.length?I[0][0]:null,O=0;O<I.length;O++)k=(C=I[O])[1]-C[0],R.push(V),R.push(k),(L=O+1)<I.length&&(V=I[L][0]-C[1]);return R.push(S.height),R}function d(S,C){return S.map(function(k){return k.map(function(L){return Math.max(0,L*C)}).sort(e)})}function m(){h.select(document.body).style("cursor",null)}function y(S){S.attr("stroke-dasharray",g)}function v(S,C){var k=h.select(S).selectAll(".highlight, .highlight-shadow");y(C?k.transition().duration(t.bar.snapDuration).each("end",C):k)}function T(S,C){var k,L=S.brush,I=NaN,R={};if(L.filterSpecified){var V=S.height,O=L.filter.getConsolidated(),J=d(O,V),D=NaN,B=NaN,N=NaN;for(k=0;k<=J.length;k++){var F=J[k];if(F&&F[0]<=C&&C<=F[1]){D=k;break}if(B=k?k-1:NaN,F&&F[0]>C){N=k;break}}if(I=D,isNaN(I)&&(I=isNaN(B)||isNaN(N)?isNaN(B)?N:B:C-J[B][1]<J[N][0]-C?B:N),!isNaN(I)){var H=J[I],j=function($,ee){var ie=t.bar.handleHeight;if(!(ee>$[1]+ie||ee<$[0]-ie))return ee>=.9*$[1]+.1*$[0]?"n":ee<=.9*$[0]+.1*$[1]?"s":"ns"}(H,C);j&&(R.interval=O[I],R.intervalPix=H,R.region=j)}}if(S.ordinal&&!R.region){var G=S.unitTickvals,W=S.unitToPaddedPx.invert(C);for(k=0;k<G.length;k++){var Q=[.25*G[Math.max(k-1,0)]+.75*G[k],.25*G[Math.min(k+1,G.length-1)]+.75*G[k]];if(W>=Q[0]&&W<=Q[1]){R.clickableOrdinalRange=Q;break}}}return R}function w(S,C){h.event.sourceEvent.stopPropagation();var k=C.height-h.mouse(S)[1]-2*t.verticalPadding,L=C.brush.svgBrush;L.wasDragged=!0,L._dragging=!0,L.grabbingBar?L.newExtent=[k-L.grabPoint,k+L.barLength-L.grabPoint].map(C.unitToPaddedPx.invert):L.newExtent=[L.startExtent,C.unitToPaddedPx.invert(k)].sort(e),C.brush.filterSpecified=!0,L.extent=L.stayingIntervals.concat([L.newExtent]),L.brushCallback(C),v(S.parentNode)}function A(S,C){var k=T(C,C.height-h.mouse(S)[1]-2*t.verticalPadding),L="crosshair";k.clickableOrdinalRange?L="pointer":k.region&&(L=k.region+"-resize"),h.select(document.body).style("cursor",L)}function E(S){S.on("mousemove",function(C){h.event.preventDefault(),C.parent.inBrushDrag||A(this,C)}).on("mouseleave",function(C){C.parent.inBrushDrag||m()}).call(h.behavior.drag().on("dragstart",function(C){(function(k,L){h.event.sourceEvent.stopPropagation();var I=L.height-h.mouse(k)[1]-2*t.verticalPadding,R=L.unitToPaddedPx.invert(I),V=L.brush,O=T(L,I),J=O.interval,D=V.svgBrush;if(D.wasDragged=!1,D.grabbingBar=O.region==="ns",D.grabbingBar){var B=J.map(L.unitToPaddedPx);D.grabPoint=I-B[0]-t.verticalPadding,D.barLength=B[1]-B[0]}D.clickableOrdinalRange=O.clickableOrdinalRange,D.stayingIntervals=L.multiselect&&V.filterSpecified?V.filter.getConsolidated():[],J&&(D.stayingIntervals=D.stayingIntervals.filter(function(N){return N[0]!==J[0]&&N[1]!==J[1]})),D.startExtent=O.region?J[O.region==="s"?1:0]:R,L.parent.inBrushDrag=!0,D.brushStartCallback()})(this,C)}).on("drag",function(C){w(this,C)}).on("dragend",function(C){(function(k,L){var I=L.brush,R=I.filter,V=I.svgBrush;V._dragging||(A(k,L),w(k,L),L.brush.svgBrush.wasDragged=!1),V._dragging=!1,h.event.sourceEvent.stopPropagation();var O=V.grabbingBar;if(V.grabbingBar=!1,V.grabLocation=void 0,L.parent.inBrushDrag=!1,m(),!V.wasDragged)return V.wasDragged=void 0,V.clickableOrdinalRange?I.filterSpecified&&L.multiselect?V.extent.push(V.clickableOrdinalRange):(V.extent=[V.clickableOrdinalRange],I.filterSpecified=!0):O?(V.extent=V.stayingIntervals,V.extent.length===0&&b(I)):b(I),V.brushCallback(L),v(k.parentNode),void V.brushEndCallback(I.filterSpecified?R.getConsolidated():[]);var J=function(){R.set(R.getConsolidated())};if(L.ordinal){var D=L.unitTickvals;D[D.length-1]<D[0]&&D.reverse(),V.newExtent=[a(0,D,V.newExtent[0],V.stayingIntervals),a(1,D,V.newExtent[1],V.stayingIntervals)];var B=V.newExtent[1]>V.newExtent[0];V.extent=V.stayingIntervals.concat(B?[V.newExtent]:[]),V.extent.length||b(I),V.brushCallback(L),B?v(k.parentNode,J):(J(),v(k.parentNode))}else J();V.brushEndCallback(I.filterSpecified?R.getConsolidated():[])})(this,C)}))}function M(S,C){return S[0]-C[0]}function b(S){S.filterSpecified=!1,S.svgBrush.extent=[[-1/0,1/0]]}function _(S){for(var C,k=S.slice(),L=[],I=k.shift();I;){for(C=I.slice();(I=k.shift())&&I[0]<=C[1];)C[1]=Math.max(C[1],I[1]);L.push(C)}return L.length===1&&L[0][0]>L[0][1]&&(L=[]),L}z.exports={makeBrush:function(S,C,k,L,I,R){var V,O=function(){var J,D,B=[];return{set:function(N){(B=N.map(function(F){return F.slice().sort(e)}).sort(M)).length===1&&B[0][0]===-1/0&&B[0][1]===1/0&&(B=[[0,-1]]),J=_(B),D=B.reduce(function(F,H){return[Math.min(F[0],H[0]),Math.max(F[1],H[1])]},[1/0,-1/0])},get:function(){return B.slice()},getConsolidated:function(){return J},getBounds:function(){return D}}}();return O.set(k),{filter:O,filterSpecified:C,svgBrush:{extent:[],brushStartCallback:L,brushCallback:(V=I,function(J){var D=J.brush,B=function(N){return N.svgBrush.extent.map(function(F){return F.slice()})}(D).slice();D.filter.set(B),V()}),brushEndCallback:R}}},ensureAxisBrush:function(S){var C=S.selectAll("."+t.cn.axisBrush).data(l,p);C.enter().append("g").classed(t.cn.axisBrush,!0),function(k){var L=k.selectAll(".background").data(l);L.enter().append("rect").classed("background",!0).call(c).call(f).style("pointer-events","auto").attr("transform",o(0,t.verticalPadding)),L.call(E).attr("height",function(V){return V.height-t.verticalPadding});var I=k.selectAll(".highlight-shadow").data(l);I.enter().append("line").classed("highlight-shadow",!0).attr("x",-t.bar.width/2).attr("stroke-width",t.bar.width+t.bar.strokeWidth).attr("stroke",t.bar.strokeColor).attr("opacity",t.bar.strokeOpacity).attr("stroke-linecap","butt"),I.attr("y1",function(V){return V.height}).call(y);var R=k.selectAll(".highlight").data(l);R.enter().append("line").classed("highlight",!0).attr("x",-t.bar.width/2).attr("stroke-width",t.bar.width-t.bar.strokeWidth).attr("stroke",t.bar.fillColor).attr("opacity",t.bar.fillOpacity).attr("stroke-linecap","butt"),R.attr("y1",function(V){return V.height}).call(y)}(C)},cleanRanges:function(S,C){if(Array.isArray(S[0])?(S=S.map(function(L){return L.sort(e)}),S=C.multiselect?_(S.sort(M)):[S[0]]):S=[S.sort(e)],C.tickvals){var k=C.tickvals.slice().sort(e);if(!(S=S.map(function(L){var I=[a(0,k,L[0],[]),a(1,k,L[1],[])];if(I[1]>I[0])return I}).filter(function(L){return L})).length)return}return S.length>1?S:S[0]}}},{"../../lib":778,"../../lib/gup":775,"./constants":1153,d3:169}],1151:[function(n,z,q){"use strict";var t=n("d3"),h=n("../../plots/get_data").getModuleCalcData,p=n("./plot"),l=n("../../constants/xmlns_namespaces");q.name="parcoords",q.plot=function(e){var o=h(e.calcdata,"parcoords")[0];o.length&&p(e,o)},q.clean=function(e,o,r,i){var u=i._has&&i._has("parcoords"),s=o._has&&o._has("parcoords");u&&!s&&(i._paperdiv.selectAll(".parcoords").remove(),i._glimages.selectAll("*").remove())},q.toSVG=function(e){var o=e._fullLayout._glimages,r=t.select(e).selectAll(".svg-container");r.filter(function(i,u){return u===r.size()-1}).selectAll(".gl-canvas-context, .gl-canvas-focus").each(function(){var i=this.toDataURL("image/png");o.append("svg:image").attr({xmlns:l.svg,"xlink:href":i,preserveAspectRatio:"none",x:0,y:0,width:this.width,height:this.height})}),window.setTimeout(function(){t.selectAll("#filterBarPattern").attr("id","filterBarPattern")},60)}},{"../../constants/xmlns_namespaces":754,"../../plots/get_data":865,"./plot":1160,d3:169}],1152:[function(n,z,q){"use strict";var t=n("../../lib").isArrayOrTypedArray,h=n("../../components/colorscale"),p=n("../../lib/gup").wrap;z.exports=function(l,e){var o,r;return h.hasColorscale(e,"line")&&t(e.line.color)?(o=e.line.color,r=h.extractOpts(e.line).colorscale,h.calc(l,e,{vals:o,containerStr:"line",cLetter:"c"})):(o=function(i){for(var u=new Array(i),s=0;s<i;s++)u[s]=.5;return u}(e._length),r=[[0,e.line.color],[1,e.line.color]]),p({lineColor:o,cscale:r})}},{"../../components/colorscale":655,"../../lib":778,"../../lib/gup":775}],1153:[function(n,z,q){"use strict";z.exports={maxDimensionCount:60,overdrag:45,verticalPadding:2,tickDistance:50,canvasPixelRatio:1,blockLineCount:5e3,layers:["contextLineLayer","focusLineLayer","pickLineLayer"],axisTitleOffset:28,axisExtentOffset:10,deselectedLineColor:"#777",bar:{width:4,captureWidth:10,fillColor:"magenta",fillOpacity:1,snapDuration:150,snapRatio:.25,snapClose:.01,strokeColor:"white",strokeOpacity:1,strokeWidth:1,handleHeight:8,handleOpacity:1,handleOverlap:0},cn:{axisExtentText:"axis-extent-text",parcoordsLineLayers:"parcoords-line-layers",parcoordsLineLayer:"parcoords-lines",parcoords:"parcoords",parcoordsControlView:"parcoords-control-view",yAxis:"y-axis",axisOverlays:"axis-overlays",axis:"axis",axisHeading:"axis-heading",axisTitle:"axis-title",axisExtent:"axis-extent",axisExtentTop:"axis-extent-top",axisExtentTopText:"axis-extent-top-text",axisExtentBottom:"axis-extent-bottom",axisExtentBottomText:"axis-extent-bottom-text",axisBrush:"axis-brush"},id:{filterBarPattern:"filter-bar-pattern"}}},{}],1154:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../../components/colorscale/helpers").hasColorscale,p=n("../../components/colorscale/defaults"),l=n("../../plots/domain").defaults,e=n("../../plots/array_container_defaults"),o=n("../../plots/cartesian/axes"),r=n("./attributes"),i=n("./axisbrush"),u=n("./constants").maxDimensionCount,s=n("./merge_length");function a(c,f,g,d){function m(A,E){return t.coerce(c,f,r.dimensions,A,E)}var y=m("values"),v=m("visible");if(y&&y.length||(v=f.visible=!1),v){m("label"),m("tickvals"),m("ticktext"),m("tickformat");var T=m("range");f._ax={_id:"y",type:"linear",showexponent:"all",exponentformat:"B",range:T},o.setConvert(f._ax,d.layout),m("multiselect");var w=m("constraintrange");w&&(f.constraintrange=i.cleanRanges(w,f))}}z.exports=function(c,f,g,d){function m(A,E){return t.coerce(c,f,r,A,E)}var y=c.dimensions;Array.isArray(y)&&y.length>u&&(t.log("parcoords traces support up to "+u+" dimensions at the moment"),y.splice(u));var v=e(c,f,{name:"dimensions",layout:d,handleItemDefaults:a}),T=function(A,E,M,b,_){var S=_("line.color",M);if(h(A,"line")&&t.isArrayOrTypedArray(S)){if(S.length)return _("line.colorscale"),p(A,E,b,_,{prefix:"line.",cLetter:"c"}),S.length;E.line.color=M}return 1/0}(c,f,g,d,m);l(f,d,m),Array.isArray(v)&&v.length||(f.visible=!1),s(f,v,"values",T);var w={family:d.font.family,size:Math.round(d.font.size/1.2),color:d.font.color};t.coerceFont(m,"labelfont",w),t.coerceFont(m,"tickfont",w),t.coerceFont(m,"rangefont",w),m("labelangle"),m("labelside")}},{"../../components/colorscale/defaults":653,"../../components/colorscale/helpers":654,"../../lib":778,"../../plots/array_container_defaults":823,"../../plots/cartesian/axes":828,"../../plots/domain":855,"./attributes":1149,"./axisbrush":1150,"./constants":1153,"./merge_length":1158}],1155:[function(n,z,q){"use strict";var t=n("../../lib").isTypedArray;q.convertTypedArray=function(h){return t(h)?Array.prototype.slice.call(h):h},q.isOrdinal=function(h){return!!h.tickvals},q.isVisible=function(h){return h.visible||!("visible"in h)}},{"../../lib":778}],1156:[function(n,z,q){"use strict";z.exports={attributes:n("./attributes"),supplyDefaults:n("./defaults"),calc:n("./calc"),plot:n("./plot"),colorbar:{container:"line",min:"cmin",max:"cmax"},moduleType:"trace",name:"parcoords",basePlotModule:n("./base_plot"),categories:["gl","regl","noOpacity","noHover"],meta:{}}},{"./attributes":1149,"./base_plot":1151,"./calc":1152,"./defaults":1154,"./plot":1160}],1157:[function(n,z,q){"use strict";var t=n("glslify"),h=t([`precision highp float;
#define GLSLIFY 1

varying vec4 fragColor;

attribute vec4 p01_04, p05_08, p09_12, p13_16,
               p17_20, p21_24, p25_28, p29_32,
               p33_36, p37_40, p41_44, p45_48,
               p49_52, p53_56, p57_60, colors;

uniform mat4 dim0A, dim1A, dim0B, dim1B, dim0C, dim1C, dim0D, dim1D,
             loA, hiA, loB, hiB, loC, hiC, loD, hiD;

uniform vec2 resolution, viewBoxPos, viewBoxSize;
uniform sampler2D mask, palette;
uniform float maskHeight;
uniform float drwLayer; // 0: context, 1: focus, 2: pick
uniform vec4 contextColor;

bool isPick    = (drwLayer > 1.5);
bool isContext = (drwLayer < 0.5);

const vec4 ZEROS = vec4(0.0, 0.0, 0.0, 0.0);
const vec4 UNITS = vec4(1.0, 1.0, 1.0, 1.0);

float val(mat4 p, mat4 v) {
    return dot(matrixCompMult(p, v) * UNITS, UNITS);
}

float axisY(float ratio, mat4 A, mat4 B, mat4 C, mat4 D) {
    float y1 = val(A, dim0A) + val(B, dim0B) + val(C, dim0C) + val(D, dim0D);
    float y2 = val(A, dim1A) + val(B, dim1B) + val(C, dim1C) + val(D, dim1D);
    return y1 * (1.0 - ratio) + y2 * ratio;
}

int iMod(int a, int b) {
    return a - b * (a / b);
}

bool fOutside(float p, float lo, float hi) {
    return (lo < hi) && (lo > p || p > hi);
}

bool vOutside(vec4 p, vec4 lo, vec4 hi) {
    return (
        fOutside(p[0], lo[0], hi[0]) ||
        fOutside(p[1], lo[1], hi[1]) ||
        fOutside(p[2], lo[2], hi[2]) ||
        fOutside(p[3], lo[3], hi[3])
    );
}

bool mOutside(mat4 p, mat4 lo, mat4 hi) {
    return (
        vOutside(p[0], lo[0], hi[0]) ||
        vOutside(p[1], lo[1], hi[1]) ||
        vOutside(p[2], lo[2], hi[2]) ||
        vOutside(p[3], lo[3], hi[3])
    );
}

bool outsideBoundingBox(mat4 A, mat4 B, mat4 C, mat4 D) {
    return mOutside(A, loA, hiA) ||
           mOutside(B, loB, hiB) ||
           mOutside(C, loC, hiC) ||
           mOutside(D, loD, hiD);
}

bool outsideRasterMask(mat4 A, mat4 B, mat4 C, mat4 D) {
    mat4 pnts[4];
    pnts[0] = A;
    pnts[1] = B;
    pnts[2] = C;
    pnts[3] = D;

    for(int i = 0; i < 4; ++i) {
        for(int j = 0; j < 4; ++j) {
            for(int k = 0; k < 4; ++k) {
                if(0 == iMod(
                    int(255.0 * texture2D(mask,
                        vec2(
                            (float(i * 2 + j / 2) + 0.5) / 8.0,
                            (pnts[i][j][k] * (maskHeight - 1.0) + 1.0) / maskHeight
                        ))[3]
                    ) / int(pow(2.0, float(iMod(j * 4 + k, 8)))),
                    2
                )) return true;
            }
        }
    }
    return false;
}

vec4 position(bool isContext, float v, mat4 A, mat4 B, mat4 C, mat4 D) {
    float x = 0.5 * sign(v) + 0.5;
    float y = axisY(x, A, B, C, D);
    float z = 1.0 - abs(v);

    z += isContext ? 0.0 : 2.0 * float(
        outsideBoundingBox(A, B, C, D) ||
        outsideRasterMask(A, B, C, D)
    );

    return vec4(
        2.0 * (vec2(x, y) * viewBoxSize + viewBoxPos) / resolution - 1.0,
        z,
        1.0
    );
}

void main() {
    mat4 A = mat4(p01_04, p05_08, p09_12, p13_16);
    mat4 B = mat4(p17_20, p21_24, p25_28, p29_32);
    mat4 C = mat4(p33_36, p37_40, p41_44, p45_48);
    mat4 D = mat4(p49_52, p53_56, p57_60, ZEROS);

    float v = colors[3];

    gl_Position = position(isContext, v, A, B, C, D);

    fragColor =
        isContext ? vec4(contextColor) :
        isPick ? vec4(colors.rgb, 1.0) : texture2D(palette, vec2(abs(v), 0.5));
}
`]),p=t([`precision highp float;
#define GLSLIFY 1

varying vec4 fragColor;

void main() {
    gl_FragColor = fragColor;
}
`]),l=n("./constants").maxDimensionCount,e=n("../../lib"),o=new Uint8Array(4),r=new Uint8Array(4),i={shape:[256,1],format:"rgba",type:"uint8",mag:"nearest",min:"nearest"};function u(v,T,w,A,E){var M=v._gl;M.enable(M.SCISSOR_TEST),M.scissor(T,w,A,E),v.clear({color:[0,0,0,0],depth:1})}function s(v,T,w,A,E,M){var b=M.key;w.drawCompleted||(function(_){_.read({x:0,y:0,width:1,height:1,data:o})}(v),w.drawCompleted=!0),function _(S){var C=Math.min(A,E-S*A);S===0&&(window.cancelAnimationFrame(w.currentRafs[b]),delete w.currentRafs[b],u(v,M.scissorX,M.scissorY,M.scissorWidth,M.viewBoxSize[1])),w.clearOnly||(M.count=2*C,M.offset=2*S*A,T(M),S*A+C<E&&(w.currentRafs[b]=window.requestAnimationFrame(function(){_(S+1)})),w.drawCompleted=!1)}(0)}function a(v,T){for(var w=new Array(256),A=0;A<256;A++)w[A]=v(A/255).concat(T);return w}function c(v,T){return(v>>>8*T)%256/255}function f(v,T,w){for(var A=new Array(8*T),E=0,M=0;M<T;M++)for(var b=0;b<2;b++)for(var _=0;_<4;_++){var S=4*v+_,C=w[64*M+S];S===63&&b===0&&(C*=-1),A[E++]=C}return A}function g(v){var T="0"+v;return T.substr(T.length-2)}function d(v){return v<l?"p"+g(v+1)+"_"+g(v+4):"colors"}function m(v,T,w,A,E,M,b,_,S,C,k,L,I){for(var R=[[],[]],V=0;V<64;V++)R[0][V]=V===E?1:0,R[1][V]=V===M?1:0;var O=v.lines.canvasOverdrag,J=v.domain,D=v.canvasWidth,B=v.canvasHeight,N=v.deselectedLines.color;return e.extendFlat({key:k,resolution:[D,B],viewBoxPos:[b+O,_],viewBoxSize:[S,C],i0:E,i1:M,dim0A:R[0].slice(0,16),dim0B:R[0].slice(16,32),dim0C:R[0].slice(32,48),dim0D:R[0].slice(48,64),dim1A:R[1].slice(0,16),dim1B:R[1].slice(16,32),dim1C:R[1].slice(32,48),dim1D:R[1].slice(48,64),drwLayer:L,contextColor:[N[0]/255,N[1]/255,N[2]/255,N[3]<1?N[3]:Math.max(1/255,Math.pow(1/v.lines.color.length,1/3))],scissorX:(A===T?0:b+O)+(v.pad.l-O)+v.layoutWidth*J.x[0],scissorWidth:(A===w?D-b+O:S+.5)+(A===T?b+O:0),scissorY:_+v.pad.b+v.layoutHeight*J.y[0],scissorHeight:C,viewportX:v.pad.l-O+v.layoutWidth*J.x[0],viewportY:v.pad.b+v.layoutHeight*J.y[0],viewportWidth:D,viewportHeight:B},I)}function y(v){var T=Math.max(0,Math.floor(2047*v[0]),0),w=Math.min(2047,Math.ceil(2047*v[1]),2047);return[Math.min(T,w),Math.max(T,w)]}z.exports=function(v,T){var w,A,E,M,b,_=T.context,S=T.pick,C=T.regl,k={currentRafs:{},drawCompleted:!0,clearOnly:!1},L=function(J){for(var D={},B=0;B<=l;B+=4)D[d(B)]=J.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)});return D}(C),I=C.texture(i),R=[];O(T);var V=C({profile:!1,blend:{enable:_,func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:1,dstAlpha:1},equation:{rgb:"add",alpha:"add"},color:[0,0,0,0]},depth:{enable:!_,mask:!0,func:"less",range:[0,1]},cull:{enable:!0,face:"back"},scissor:{enable:!0,box:{x:C.prop("scissorX"),y:C.prop("scissorY"),width:C.prop("scissorWidth"),height:C.prop("scissorHeight")}},viewport:{x:C.prop("viewportX"),y:C.prop("viewportY"),width:C.prop("viewportWidth"),height:C.prop("viewportHeight")},dither:!1,vert:h,frag:p,primitive:"lines",lineWidth:1,attributes:L,uniforms:{resolution:C.prop("resolution"),viewBoxPos:C.prop("viewBoxPos"),viewBoxSize:C.prop("viewBoxSize"),dim0A:C.prop("dim0A"),dim1A:C.prop("dim1A"),dim0B:C.prop("dim0B"),dim1B:C.prop("dim1B"),dim0C:C.prop("dim0C"),dim1C:C.prop("dim1C"),dim0D:C.prop("dim0D"),dim1D:C.prop("dim1D"),loA:C.prop("loA"),hiA:C.prop("hiA"),loB:C.prop("loB"),hiB:C.prop("hiB"),loC:C.prop("loC"),hiC:C.prop("hiC"),loD:C.prop("loD"),hiD:C.prop("hiD"),palette:I,contextColor:C.prop("contextColor"),mask:C.prop("maskTexture"),drwLayer:C.prop("drwLayer"),maskHeight:C.prop("maskHeight")},offset:C.prop("offset"),count:C.prop("count")});function O(J){w=J.model,A=J.viewModel,E=A.dimensions.slice(),M=E[0]?E[0].values.length:0;var D=w.lines,B=S?D.color.map(function(F,H){return H/D.color.length}):D.color,N=function(F,H,j){for(var G,W=new Array(F*(l+4)),Q=0,$=0;$<F;$++){for(var ee=0;ee<l;ee++)W[Q++]=ee<H.length?H[ee].paddedUnitValues[$]:.5;W[Q++]=c($,2),W[Q++]=c($,1),W[Q++]=c($,0),W[Q++]=(G=j[$],Math.max(1e-6,Math.min(.999999,G)))}return W}(M,E,B);(function(F,H,j){for(var G=0;G<=l;G+=4)F[d(G)](f(G/4,H,j))})(L,M,N),_||S||(I=C.texture(e.extendFlat({data:a(w.unitToColor,255)},i)))}return{render:function(J,D,B){var N,F,H,j=J.length,G=1/0,W=-1/0;for(N=0;N<j;N++)J[N].dim0.canvasX<G&&(G=J[N].dim0.canvasX,F=N),J[N].dim1.canvasX>W&&(W=J[N].dim1.canvasX,H=N);j===0&&u(C,0,0,w.canvasWidth,w.canvasHeight);var Q=function(ue){var we,Ae,Se,ke=[[],[]];for(Se=0;Se<64;Se++){var Me=!ue&&Se<E.length?E[Se].brush.filter.getBounds():[-1/0,1/0];ke[0][Se]=Me[0],ke[1][Se]=Me[1]}var ve=new Array(16384);for(we=0;we<16384;we++)ve[we]=255;if(!ue)for(we=0;we<E.length;we++){var ge=we%8,De=(we-ge)/8,_e=Math.pow(2,ge),Pe=E[we].brush.filter.get();if(!(Pe.length<2)){var Fe=y(Pe[0])[1];for(Ae=1;Ae<Pe.length;Ae++){var ze=y(Pe[Ae]);for(Se=Fe+1;Se<ze[0];Se++)ve[8*Se+De]&=~_e;Fe=Math.max(Fe,ze[1])}}}var He={shape:[8,2048],format:"alpha",type:"uint8",mag:"nearest",min:"nearest",data:ve};return b?b(He):b=C.texture(He),{maskTexture:b,maskHeight:2048,loA:ke[0].slice(0,16),loB:ke[0].slice(16,32),loC:ke[0].slice(32,48),loD:ke[0].slice(48,64),hiA:ke[1].slice(0,16),hiB:ke[1].slice(16,32),hiC:ke[1].slice(32,48),hiD:ke[1].slice(48,64)}}(_);for(N=0;N<j;N++){var $=J[N],ee=$.dim0.crossfilterDimensionIndex,ie=$.dim1.crossfilterDimensionIndex,ae=$.canvasX,oe=$.canvasY,de=ae+$.panelSizeX;if(D||!R[ee]||R[ee][0]!==ae||R[ee][1]!==de){R[ee]=[ae,de];var le=m(w,F,H,N,ee,ie,ae,oe,$.panelSizeX,$.panelSizeY,$.dim0.crossfilterDimensionIndex,_?0:S?2:1,Q);k.clearOnly=B;var fe=D?w.lines.blockLineCount:M;s(C,V,k,fe,M,le)}}},readPixel:function(J,D){return C.read({x:J,y:D,width:1,height:1,data:r}),r},readPixels:function(J,D,B,N){var F=new Uint8Array(4*B*N);return C.read({x:J,y:D,width:B,height:N,data:F}),F},destroy:function(){for(var J in v.style["pointer-events"]="none",I.destroy(),b&&b.destroy(),L)L[J].destroy()},update:O}}},{"../../lib":778,"./constants":1153,glslify:439}],1158:[function(n,z,q){"use strict";z.exports=function(t,h,p,l){var e,o;for(l||(l=1/0),e=0;e<h.length;e++)(o=h[e]).visible&&(l=Math.min(l,o[p].length));for(l===1/0&&(l=0),t._length=l,e=0;e<h.length;e++)(o=h[e]).visible&&(o._length=l);return l}},{}],1159:[function(n,z,q){"use strict";var t=n("d3"),h=n("color-rgba"),p=n("../../plots/cartesian/axes"),l=n("../../lib"),e=l.strRotate,o=l.strTranslate,r=n("../../lib/svg_text_utils"),i=n("../../components/drawing"),u=n("../../components/colorscale"),s=n("../../lib/gup"),a=s.keyFun,c=s.repeat,f=s.unwrap,g=n("./helpers"),d=n("./constants"),m=n("./axisbrush"),y=n("./lines");function v(O,J,D){return l.aggNums(O,null,J,D)}function T(O,J){return A(v(Math.min,O,J),v(Math.max,O,J))}function w(O){var J=O.range;return J?A(J[0],J[1]):T(O.values,O._length)}function A(O,J){return!isNaN(O)&&isFinite(O)||(O=0),!isNaN(J)&&isFinite(J)||(J=0),O===J&&(O===0?(O-=1,J+=1):(O*=.9,J*=1.1)),[O,J]}function E(O,J,D,B,N){var F,H,j=w(D);return B?t.scale.ordinal().domain(B.map((F=t.format(D.tickformat),H=N,H?function(G,W){var Q=H[W];return Q??F(G)}:F))).range(B.map(function(G){var W=(G-j[0])/(j[1]-j[0]);return O-J+W*(2*J-O)})):t.scale.linear().domain(j).range([O-J,J])}function M(O){if(O.tickvals){var J=w(O);return t.scale.ordinal().domain(O.tickvals).range(O.tickvals.map(function(D){return(D-J[0])/(J[1]-J[0])}))}}function b(O){var J=O.map(function(N){return N[0]}),D=O.map(function(N){var F=h(N[1]);return t.rgb("rgb("+F[0]+","+F[1]+","+F[2]+")")}),B="rgb".split("").map(function(N){return t.scale.linear().clamp(!0).domain(J).range(D.map((F=N,function(H){return H[F]})));var F});return function(N){return B.map(function(F){return F(N)})}}function _(O){return O.dimensions.some(function(J){return J.brush.filterSpecified})}function S(O,J,D){var B=f(J),N=B.trace,F=g.convertTypedArray(B.lineColor),H=N.line,j={color:h(d.deselectedLineColor)},G=u.extractOpts(H),W=G.reversescale?u.flipScale(B.cscale):B.cscale,Q=N.domain,$=N.dimensions,ee=O.width,ie=N.labelangle,ae=N.labelside,oe=N.labelfont,de=N.tickfont,le=N.rangefont,fe=l.extendDeepNoArrays({},H,{color:F.map(t.scale.linear().domain(w({values:F,range:[G.min,G.max],_length:N._length}))),blockLineCount:d.blockLineCount,canvasOverdrag:d.overdrag*d.canvasPixelRatio}),ue=Math.floor(ee*(Q.x[1]-Q.x[0])),we=Math.floor(O.height*(Q.y[1]-Q.y[0])),Ae=O.margin||{l:80,r:80,t:100,b:80},Se=ue,ke=we;return{key:D,colCount:$.filter(g.isVisible).length,dimensions:$,tickDistance:d.tickDistance,unitToColor:b(W),lines:fe,deselectedLines:j,labelAngle:ie,labelSide:ae,labelFont:oe,tickFont:de,rangeFont:le,layoutWidth:ee,layoutHeight:O.height,domain:Q,translateX:Q.x[0]*ee,translateY:O.height-Q.y[1]*O.height,pad:Ae,canvasWidth:Se*d.canvasPixelRatio+2*fe.canvasOverdrag,canvasHeight:ke*d.canvasPixelRatio,width:Se,height:ke,canvasPixelRatio:d.canvasPixelRatio}}function C(O,J,D){var B=D.width,N=D.height,F=D.dimensions,H=D.canvasPixelRatio,j=function(ee){return B*ee/Math.max(1,D.colCount-1)},G=d.verticalPadding/N,W=function(ee,ie){return t.scale.linear().range([ie,ee-ie])}(N,d.verticalPadding),Q={key:D.key,xScale:j,model:D,inBrushDrag:!1},$={};return Q.dimensions=F.filter(g.isVisible).map(function(ee,ie){var ae=function(_e,Pe){return t.scale.linear().domain(w(_e)).range([Pe,1-Pe])}(ee,G),oe=$[ee.label];$[ee.label]=(oe||0)+1;var de=ee.label+(oe?"__"+oe:""),le=ee.constraintrange,fe=le&&le.length;fe&&!Array.isArray(le[0])&&(le=[le]);var ue=fe?le.map(function(_e){return _e.map(ae)}):[[-1/0,1/0]],we=ee.values;we.length>ee._length&&(we=we.slice(0,ee._length));var Ae,Se=ee.tickvals;function ke(_e,Pe){return{val:_e,text:Ae[Pe]}}function Me(_e,Pe){return _e.val-Pe.val}if(Array.isArray(Se)&&Se.length){Ae=ee.ticktext,Array.isArray(Ae)&&Ae.length?Ae.length>Se.length?Ae=Ae.slice(0,Se.length):Se.length>Ae.length&&(Se=Se.slice(0,Ae.length)):Ae=Se.map(t.format(ee.tickformat));for(var ve=1;ve<Se.length;ve++)if(Se[ve]<Se[ve-1]){for(var ge=Se.map(ke).sort(Me),De=0;De<Se.length;De++)Se[De]=ge[De].val,Ae[De]=ge[De].text;break}}else Se=void 0;return we=g.convertTypedArray(we),{key:de,label:ee.label,tickFormat:ee.tickformat,tickvals:Se,ticktext:Ae,ordinal:g.isOrdinal(ee),multiselect:ee.multiselect,xIndex:ie,crossfilterDimensionIndex:ie,visibleIndex:ee._index,height:N,values:we,paddedUnitValues:we.map(ae),unitTickvals:Se&&Se.map(ae),xScale:j,x:j(ie),canvasX:j(ie)*H,unitToPaddedPx:W,domainScale:E(N,d.verticalPadding,ee,Se,Ae),ordinalScale:M(ee),parent:Q,model:D,brush:m.makeBrush(O,fe,ue,function(){O.linePickActive(!1)},function(){var _e=Q;_e.focusLayer&&_e.focusLayer.render(_e.panels,!0);var Pe=_(_e);!O.contextShown()&&Pe?(_e.contextLayer&&_e.contextLayer.render(_e.panels,!0),O.contextShown(!0)):O.contextShown()&&!Pe&&(_e.contextLayer&&_e.contextLayer.render(_e.panels,!0,!0),O.contextShown(!1))},function(_e){if(Q.focusLayer.render(Q.panels,!0),Q.pickLayer&&Q.pickLayer.render(Q.panels,!0),O.linePickActive(!0),J&&J.filterChanged){var Pe=ae.invert,Fe=_e.map(function(ze){return ze.map(Pe).sort(l.sorterAsc)}).sort(function(ze,He){return ze[0]-He[0]});J.filterChanged(Q.key,ee._index,Fe)}})}}),Q}function k(O){O.classed(d.cn.axisExtentText,!0).attr("text-anchor","middle").style("cursor","default")}function L(O,J){var D=J==="top"?1:-1,B=O*Math.PI/180;return{dir:D,dx:Math.sin(B),dy:Math.cos(B),degrees:O}}function I(O,J){for(var D=J.panels||(J.panels=[]),B=O.data(),N=0;N<B.length-1;N++){var F=D[N]||(D[N]={}),H=B[N],j=B[N+1];F.dim0=H,F.dim1=j,F.canvasX=H.canvasX,F.panelSizeX=j.canvasX-H.canvasX,F.panelSizeY=J.model.canvasHeight,F.y=0,F.canvasY=0}}function R(O,J){return p.tickText(O._ax,J,!1).text}function V(O,J){if(O.ordinal)return"";var D=O.domainScale.domain(),B=D[J?D.length-1:0];return R(O.model.dimensions[O.visibleIndex],B)}z.exports=function(O,J,D,B){var N=O._fullLayout,F=N._toppaper,H=N._glcontainer;(function(ve){for(var ge=0;ge<ve.length;ge++)for(var De=0;De<ve[ge].length;De++)for(var _e=ve[ge][De].trace,Pe=_e.dimensions,Fe=0;Fe<Pe.length;Fe++){var ze=Pe[Fe].values,He=Pe[Fe]._ax;He&&(He.range?He.range=A(He.range[0],He.range[1]):He.range=T(ze,_e._length),He.dtick||(He.dtick=.01*(Math.abs(He.range[1]-He.range[0])||1)),He.tickformat=Pe[Fe].tickformat,p.calcTicks(He),He.cleanRange())}})(J);var j,G,W=(j=!0,G=!1,{linePickActive:function(ve){return arguments.length?j=!!ve:j},contextShown:function(ve){return arguments.length?G=!!ve:G}}),Q=J.filter(function(ve){return f(ve).trace.visible}).map(S.bind(0,D)).map(C.bind(0,W,B));H.each(function(ve,ge){return l.extendFlat(ve,Q[ge])});var $=H.selectAll(".gl-canvas").each(function(ve){ve.viewModel=Q[0],ve.model=ve.viewModel?ve.viewModel.model:null}),ee=null;$.filter(function(ve){return ve.pick}).style("pointer-events","auto").on("mousemove",function(ve){if(W.linePickActive()&&ve.lineLayer&&B&&B.hover){var ge=t.event,De=this.width,_e=this.height,Pe=t.mouse(this),Fe=Pe[0],ze=Pe[1];if(Fe<0||ze<0||Fe>=De||ze>=_e)return;var He=ve.lineLayer.readPixel(Fe,_e-1-ze),et=He[3]!==0,Re=et?He[2]+256*(He[1]+256*He[0]):null,Ze={x:Fe,y:ze,clientX:ge.clientX,clientY:ge.clientY,dataIndex:ve.model.key,curveNumber:Re};Re!==ee&&(et?B.hover(Ze):B.unhover&&B.unhover(Ze),ee=Re)}}),$.style("opacity",function(ve){return ve.pick?0:1}),F.style("background","rgba(255, 255, 255, 0)");var ie=F.selectAll("."+d.cn.parcoords).data(Q,a);ie.exit().remove(),ie.enter().append("g").classed(d.cn.parcoords,!0).style("shape-rendering","crispEdges").style("pointer-events","none"),ie.attr("transform",function(ve){return o(ve.model.translateX,ve.model.translateY)});var ae=ie.selectAll("."+d.cn.parcoordsControlView).data(c,a);ae.enter().append("g").classed(d.cn.parcoordsControlView,!0),ae.attr("transform",function(ve){return o(ve.model.pad.l,ve.model.pad.t)});var oe=ae.selectAll("."+d.cn.yAxis).data(function(ve){return ve.dimensions},a);oe.enter().append("g").classed(d.cn.yAxis,!0),ae.each(function(ve){I(oe,ve)}),$.each(function(ve){if(ve.viewModel){!ve.lineLayer||B?ve.lineLayer=y(this,ve):ve.lineLayer.update(ve),(ve.key||ve.key===0)&&(ve.viewModel[ve.key]=ve.lineLayer);var ge=!ve.context||B;ve.lineLayer.render(ve.viewModel.panels,ge)}}),oe.attr("transform",function(ve){return o(ve.xScale(ve.xIndex),0)}),oe.call(t.behavior.drag().origin(function(ve){return ve}).on("drag",function(ve){var ge=ve.parent;W.linePickActive(!1),ve.x=Math.max(-d.overdrag,Math.min(ve.model.width+d.overdrag,t.event.x)),ve.canvasX=ve.x*ve.model.canvasPixelRatio,oe.sort(function(De,_e){return De.x-_e.x}).each(function(De,_e){De.xIndex=_e,De.x=ve===De?De.x:De.xScale(De.xIndex),De.canvasX=De.x*De.model.canvasPixelRatio}),I(oe,ge),oe.filter(function(De){return Math.abs(ve.xIndex-De.xIndex)!==0}).attr("transform",function(De){return o(De.xScale(De.xIndex),0)}),t.select(this).attr("transform",o(ve.x,0)),oe.each(function(De,_e,Pe){Pe===ve.parent.key&&(ge.dimensions[_e]=De)}),ge.contextLayer&&ge.contextLayer.render(ge.panels,!1,!_(ge)),ge.focusLayer.render&&ge.focusLayer.render(ge.panels)}).on("dragend",function(ve){var ge=ve.parent;ve.x=ve.xScale(ve.xIndex),ve.canvasX=ve.x*ve.model.canvasPixelRatio,I(oe,ge),t.select(this).attr("transform",function(De){return o(De.x,0)}),ge.contextLayer&&ge.contextLayer.render(ge.panels,!1,!_(ge)),ge.focusLayer&&ge.focusLayer.render(ge.panels),ge.pickLayer&&ge.pickLayer.render(ge.panels,!0),W.linePickActive(!0),B&&B.axesMoved&&B.axesMoved(ge.key,ge.dimensions.map(function(De){return De.crossfilterDimensionIndex}))})),oe.exit().remove();var de=oe.selectAll("."+d.cn.axisOverlays).data(c,a);de.enter().append("g").classed(d.cn.axisOverlays,!0),de.selectAll("."+d.cn.axis).remove();var le=de.selectAll("."+d.cn.axis).data(c,a);le.enter().append("g").classed(d.cn.axis,!0),le.each(function(ve){var ge=ve.model.height/ve.model.tickDistance,De=ve.domainScale,_e=De.domain();t.select(this).call(t.svg.axis().orient("left").tickSize(4).outerTickSize(2).ticks(ge,ve.tickFormat).tickValues(ve.ordinal?_e:null).tickFormat(function(Pe){return g.isOrdinal(ve)?Pe:R(ve.model.dimensions[ve.visibleIndex],Pe)}).scale(De)),i.font(le.selectAll("text"),ve.model.tickFont)}),le.selectAll(".domain, .tick>line").attr("fill","none").attr("stroke","black").attr("stroke-opacity",.25).attr("stroke-width","1px"),le.selectAll("text").style("text-shadow","1px 1px 1px #fff, -1px -1px 1px #fff, 1px -1px 1px #fff, -1px 1px 1px #fff").style("cursor","default");var fe=de.selectAll("."+d.cn.axisHeading).data(c,a);fe.enter().append("g").classed(d.cn.axisHeading,!0);var ue=fe.selectAll("."+d.cn.axisTitle).data(c,a);ue.enter().append("text").classed(d.cn.axisTitle,!0).attr("text-anchor","middle").style("cursor","ew-resize").style("pointer-events","auto"),ue.text(function(ve){return ve.label}).each(function(ve){var ge=t.select(this);i.font(ge,ve.model.labelFont),r.convertToTspans(ge,O)}).attr("transform",function(ve){var ge=L(ve.model.labelAngle,ve.model.labelSide),De=d.axisTitleOffset;return(ge.dir>0?"":o(0,2*De+ve.model.height))+e(ge.degrees)+o(-De*ge.dx,-De*ge.dy)}).attr("text-anchor",function(ve){var ge=L(ve.model.labelAngle,ve.model.labelSide);return 2*Math.abs(ge.dx)>Math.abs(ge.dy)?ge.dir*ge.dx<0?"start":"end":"middle"});var we=de.selectAll("."+d.cn.axisExtent).data(c,a);we.enter().append("g").classed(d.cn.axisExtent,!0);var Ae=we.selectAll("."+d.cn.axisExtentTop).data(c,a);Ae.enter().append("g").classed(d.cn.axisExtentTop,!0),Ae.attr("transform",o(0,-d.axisExtentOffset));var Se=Ae.selectAll("."+d.cn.axisExtentTopText).data(c,a);Se.enter().append("text").classed(d.cn.axisExtentTopText,!0).call(k),Se.text(function(ve){return V(ve,!0)}).each(function(ve){i.font(t.select(this),ve.model.rangeFont)});var ke=we.selectAll("."+d.cn.axisExtentBottom).data(c,a);ke.enter().append("g").classed(d.cn.axisExtentBottom,!0),ke.attr("transform",function(ve){return o(0,ve.model.height+d.axisExtentOffset)});var Me=ke.selectAll("."+d.cn.axisExtentBottomText).data(c,a);Me.enter().append("text").classed(d.cn.axisExtentBottomText,!0).attr("dy","0.75em").call(k),Me.text(function(ve){return V(ve,!1)}).each(function(ve){i.font(t.select(this),ve.model.rangeFont)}),m.ensureAxisBrush(de)}},{"../../components/colorscale":655,"../../components/drawing":665,"../../lib":778,"../../lib/gup":775,"../../lib/svg_text_utils":803,"../../plots/cartesian/axes":828,"./axisbrush":1150,"./constants":1153,"./helpers":1155,"./lines":1157,"color-rgba":127,d3:169}],1160:[function(n,z,q){"use strict";var t=n("./parcoords"),h=n("../../lib/prepare_regl"),p=n("./helpers").isVisible;function l(e,o,r){var i=o.indexOf(r),u=e.indexOf(i);return u===-1&&(u+=o.length),u}z.exports=function(e,o){var r=e._fullLayout;if(h(e)){var i={},u={},s={},a={},c=r._size;o.forEach(function(f,g){var d=f[0].trace;s[g]=d.index;var m=a[g]=d._fullInput.index;i[g]=e.data[m].dimensions,u[g]=e.data[m].dimensions.slice()}),t(e,o,{width:c.w,height:c.h,margin:{t:c.t,r:c.r,b:c.b,l:c.l}},{filterChanged:function(f,g,d){var m=u[f][g],y=d.map(function(M){return M.slice()}),v="dimensions["+g+"].constraintrange",T=r._tracePreGUI[e._fullData[s[f]]._fullInput.uid];if(T[v]===void 0){var w=m.constraintrange;T[v]=w||null}var A=e._fullData[s[f]].dimensions[g];y.length?(y.length===1&&(y=y[0]),m.constraintrange=y,A.constraintrange=y.slice(),y=[y]):(delete m.constraintrange,delete A.constraintrange,y=null);var E={};E[v]=y,e.emit("plotly_restyle",[E,[a[f]]])},hover:function(f){e.emit("plotly_hover",f)},unhover:function(f){e.emit("plotly_unhover",f)},axesMoved:function(f,g){var d=function(m,y){return function(v,T){return l(m,y,v)-l(m,y,T)}}(g,u[f].filter(p));i[f].sort(d),u[f].filter(function(m){return!p(m)}).sort(function(m){return u[f].indexOf(m)}).forEach(function(m){i[f].splice(i[f].indexOf(m),1),i[f].splice(u[f].indexOf(m),0,m)}),e.emit("plotly_restyle",[{dimensions:[i[f]]},[a[f]]])}})}}},{"../../lib/prepare_regl":791,"./helpers":1155,"./parcoords":1159}],1161:[function(n,z,q){"use strict";var t=n("../../plots/attributes"),h=n("../../plots/domain").attributes,p=n("../../plots/font_attributes"),l=n("../../components/color/attributes"),e=n("../../plots/template_attributes").hovertemplateAttrs,o=n("../../plots/template_attributes").texttemplateAttrs,r=n("../../lib/extend").extendFlat,i=p({editType:"plot",arrayOk:!0,colorEditType:"plot"});z.exports={labels:{valType:"data_array",editType:"calc"},label0:{valType:"number",dflt:0,editType:"calc"},dlabel:{valType:"number",dflt:1,editType:"calc"},values:{valType:"data_array",editType:"calc"},marker:{colors:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:l.defaultLine,arrayOk:!0,editType:"style"},width:{valType:"number",min:0,dflt:0,arrayOk:!0,editType:"style"},editType:"calc"},editType:"calc"},text:{valType:"data_array",editType:"plot"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"style"},scalegroup:{valType:"string",dflt:"",editType:"calc"},textinfo:{valType:"flaglist",flags:["label","text","value","percent"],extras:["none"],editType:"calc"},hoverinfo:r({},t.hoverinfo,{flags:["label","text","value","percent","name"]}),hovertemplate:e({},{keys:["label","color","value","percent","text"]}),texttemplate:o({editType:"plot"},{keys:["label","color","value","percent","text"]}),textposition:{valType:"enumerated",values:["inside","outside","auto","none"],dflt:"auto",arrayOk:!0,editType:"plot"},textfont:r({},i,{}),insidetextorientation:{valType:"enumerated",values:["horizontal","radial","tangential","auto"],dflt:"auto",editType:"plot"},insidetextfont:r({},i,{}),outsidetextfont:r({},i,{}),automargin:{valType:"boolean",dflt:!1,editType:"plot"},title:{text:{valType:"string",dflt:"",editType:"plot"},font:r({},i,{}),position:{valType:"enumerated",values:["top left","top center","top right","middle center","bottom left","bottom center","bottom right"],editType:"plot"},editType:"plot"},domain:h({name:"pie",trace:!0,editType:"calc"}),hole:{valType:"number",min:0,max:1,dflt:0,editType:"calc"},sort:{valType:"boolean",dflt:!0,editType:"calc"},direction:{valType:"enumerated",values:["clockwise","counterclockwise"],dflt:"counterclockwise",editType:"calc"},rotation:{valType:"number",min:-360,max:360,dflt:0,editType:"calc"},pull:{valType:"number",min:0,max:1,dflt:0,arrayOk:!0,editType:"calc"},_deprecated:{title:{valType:"string",dflt:"",editType:"calc"},titlefont:r({},i,{}),titleposition:{valType:"enumerated",values:["top left","top center","top right","middle center","bottom left","bottom center","bottom right"],editType:"calc"}}}},{"../../components/color/attributes":642,"../../lib/extend":768,"../../plots/attributes":824,"../../plots/domain":855,"../../plots/font_attributes":856,"../../plots/template_attributes":906}],1162:[function(n,z,q){"use strict";var t=n("../../plots/plots");q.name="pie",q.plot=function(h,p,l,e){t.plotBasePlot(q.name,h,p,l,e)},q.clean=function(h,p,l,e){t.cleanBasePlot(q.name,h,p,l,e)}},{"../../plots/plots":891}],1163:[function(n,z,q){"use strict";var t=n("fast-isnumeric"),h=n("tinycolor2"),p=n("../../components/color"),l={};function e(r){return function(i,u){return!!i&&!!(i=h(i)).isValid()&&(i=p.addOpacity(i,i.getAlpha()),r[u]||(r[u]=i),i)}}function o(r,i){var u,s=JSON.stringify(r),a=i[s];if(!a){for(a=r.slice(),u=0;u<r.length;u++)a.push(h(r[u]).lighten(20).toHexString());for(u=0;u<r.length;u++)a.push(h(r[u]).darken(20).toHexString());i[s]=a}return a}z.exports={calc:function(r,i){var u,s,a=[],c=r._fullLayout,f=c.hiddenlabels||[],g=i.labels,d=i.marker.colors||[],m=i.values,y=i._length,v=i._hasValues&&y;if(i.dlabel)for(g=new Array(y),u=0;u<y;u++)g[u]=String(i.label0+u*i.dlabel);var T={},w=e(c["_"+i.type+"colormap"]),A=0,E=!1;for(u=0;u<y;u++){var M,b,_;if(v){if(M=m[u],!t(M)||(M=+M)<0)continue}else M=1;(b=g[u])!==void 0&&b!==""||(b=u);var S=T[b=String(b)];S===void 0?(T[b]=a.length,(_=f.indexOf(b)!==-1)||(A+=M),a.push({v:M,label:b,color:w(d[u],b),i:u,pts:[u],hidden:_})):(E=!0,(s=a[S]).v+=M,s.pts.push(u),s.hidden||(A+=M),s.color===!1&&d[u]&&(s.color=w(d[u],b)))}return(i.type==="funnelarea"?E:i.sort)&&a.sort(function(C,k){return k.v-C.v}),a[0]&&(a[0].vTotal=A),a},crossTraceCalc:function(r,i){var u=(i||{}).type;u||(u="pie");var s=r._fullLayout,a=r.calcdata,c=s[u+"colorway"],f=s["_"+u+"colormap"];s["extend"+u+"colors"]&&(c=o(c,l));for(var g=0,d=0;d<a.length;d++){var m=a[d];if(m[0].trace.type===u)for(var y=0;y<m.length;y++){var v=m[y];v.color===!1&&(f[v.label]?v.color=f[v.label]:(f[v.label]=v.color=c[g%c.length],g++))}}},makePullColorFn:e,generateExtendedColors:o}},{"../../components/color":643,"fast-isnumeric":241,tinycolor2:576}],1164:[function(n,z,q){"use strict";var t=n("fast-isnumeric"),h=n("../../lib"),p=n("./attributes"),l=n("../../plots/domain").defaults,e=n("../bar/defaults").handleText;function o(r,i){var u=Array.isArray(r),s=h.isArrayOrTypedArray(i),a=Math.min(u?r.length:1/0,s?i.length:1/0);if(isFinite(a)||(a=0),a&&s){for(var c,f=0;f<a;f++){var g=i[f];if(t(g)&&g>0){c=!0;break}}c||(a=0)}return{hasLabels:u,hasValues:s,len:a}}z.exports={handleLabelsAndValues:o,supplyDefaults:function(r,i,u,s){function a(w,A){return h.coerce(r,i,p,w,A)}var c=o(a("labels"),a("values")),f=c.len;if(i._hasLabels=c.hasLabels,i._hasValues=c.hasValues,!i._hasLabels&&i._hasValues&&(a("label0"),a("dlabel")),f){i._length=f,a("marker.line.width")&&a("marker.line.color"),a("marker.colors"),a("scalegroup");var g,d=a("text"),m=a("texttemplate");if(m||(g=a("textinfo",Array.isArray(d)?"text+percent":"percent")),a("hovertext"),a("hovertemplate"),m||g&&g!=="none"){var y=a("textposition");e(r,i,s,a,y,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),(Array.isArray(y)||y==="auto"||y==="outside")&&a("automargin"),(y==="inside"||y==="auto"||Array.isArray(y))&&a("insidetextorientation")}l(i,s,a);var v=a("hole");if(a("title.text")){var T=a("title.position",v?"middle center":"top center");v||T!=="middle center"||(i.title.position="top center"),h.coerceFont(a,"title.font",s.font)}a("sort"),a("direction"),a("rotation"),a("pull")}else i.visible=!1}}},{"../../lib":778,"../../plots/domain":855,"../bar/defaults":925,"./attributes":1161,"fast-isnumeric":241}],1165:[function(n,z,q){"use strict";var t=n("../../components/fx/helpers").appendArrayMultiPointValues;z.exports=function(h,p){var l={curveNumber:p.index,pointNumbers:h.pts,data:p._input,fullData:p,label:h.label,color:h.color,value:h.v,percent:h.percent,text:h.text,v:h.v};return h.pts.length===1&&(l.pointNumber=l.i=h.pts[0]),t(l,p,h.pts),p.type==="funnelarea"&&(delete l.v,delete l.i),l}},{"../../components/fx/helpers":679}],1166:[function(n,z,q){"use strict";var t=n("../../lib");function h(p){return p.indexOf("e")!==-1?p.replace(/[.]?0+e/,"e"):p.indexOf(".")!==-1?p.replace(/[.]?0+$/,""):p}q.formatPiePercent=function(p,l){var e=h((100*p).toPrecision(3));return t.numSeparate(e,l)+"%"},q.formatPieValue=function(p,l){var e=h(p.toPrecision(10));return t.numSeparate(e,l)},q.getFirstFilled=function(p,l){if(Array.isArray(p))for(var e=0;e<l.length;e++){var o=p[l[e]];if(o||o===0||o==="")return o}},q.castOption=function(p,l){return Array.isArray(p)?q.getFirstFilled(p,l):p||void 0},q.getRotationAngle=function(p){return(p==="auto"?0:p)*Math.PI/180}},{"../../lib":778}],1167:[function(n,z,q){"use strict";z.exports={attributes:n("./attributes"),supplyDefaults:n("./defaults").supplyDefaults,supplyLayoutDefaults:n("./layout_defaults"),layoutAttributes:n("./layout_attributes"),calc:n("./calc").calc,crossTraceCalc:n("./calc").crossTraceCalc,plot:n("./plot").plot,style:n("./style"),styleOne:n("./style_one"),moduleType:"trace",name:"pie",basePlotModule:n("./base_plot"),categories:["pie-like","pie","showLegend"],meta:{}}},{"./attributes":1161,"./base_plot":1162,"./calc":1163,"./defaults":1164,"./layout_attributes":1168,"./layout_defaults":1169,"./plot":1170,"./style":1171,"./style_one":1172}],1168:[function(n,z,q){"use strict";z.exports={hiddenlabels:{valType:"data_array",editType:"calc"},piecolorway:{valType:"colorlist",editType:"calc"},extendpiecolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],1169:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("./layout_attributes");z.exports=function(p,l){function e(o,r){return t.coerce(p,l,h,o,r)}e("hiddenlabels"),e("piecolorway",l.colorway),e("extendpiecolors")}},{"../../lib":778,"./layout_attributes":1168}],1170:[function(n,z,q){"use strict";var t=n("d3"),h=n("../../plots/plots"),p=n("../../components/fx"),l=n("../../components/color"),e=n("../../components/drawing"),o=n("../../lib"),r=o.strScale,i=o.strTranslate,u=n("../../lib/svg_text_utils"),s=n("../bar/uniform_text"),a=s.recordMinTextSize,c=s.clearMinTextSize,f=n("../bar/constants").TEXTPAD,g=n("./helpers"),d=n("./event_data"),m=n("../../lib").isValidTextValue;function y(D,B,N){var F=N[0],H=F.trace,j=F.cx,G=F.cy;"_hasHoverLabel"in H||(H._hasHoverLabel=!1),"_hasHoverEvent"in H||(H._hasHoverEvent=!1),D.on("mouseover",function(W){var Q=B._fullLayout,$=B._fullData[H.index];if(!B._dragging&&Q.hovermode!==!1){var ee=$.hoverinfo;if(Array.isArray(ee)&&(ee=p.castHoverinfo({hoverinfo:[g.castOption(ee,W.pts)],_module:H._module},Q,0)),ee==="all"&&(ee="label+text+value+percent+name"),$.hovertemplate||ee!=="none"&&ee!=="skip"&&ee){var ie=W.rInscribed||0,ae=j+W.pxmid[0]*(1-ie),oe=G+W.pxmid[1]*(1-ie),de=Q.separators,le=[];if(ee&&ee.indexOf("label")!==-1&&le.push(W.label),W.text=g.castOption($.hovertext||$.text,W.pts),ee&&ee.indexOf("text")!==-1){var fe=W.text;o.isValidTextValue(fe)&&le.push(fe)}W.value=W.v,W.valueLabel=g.formatPieValue(W.v,de),ee&&ee.indexOf("value")!==-1&&le.push(W.valueLabel),W.percent=W.v/F.vTotal,W.percentLabel=g.formatPiePercent(W.percent,de),ee&&ee.indexOf("percent")!==-1&&le.push(W.percentLabel);var ue=$.hoverlabel,we=ue.font;p.loneHover({trace:H,x0:ae-ie*F.r,x1:ae+ie*F.r,y:oe,text:le.join("<br>"),name:$.hovertemplate||ee.indexOf("name")!==-1?$.name:void 0,idealAlign:W.pxmid[0]<0?"left":"right",color:g.castOption(ue.bgcolor,W.pts)||W.color,borderColor:g.castOption(ue.bordercolor,W.pts),fontFamily:g.castOption(we.family,W.pts),fontSize:g.castOption(we.size,W.pts),fontColor:g.castOption(we.color,W.pts),nameLength:g.castOption(ue.namelength,W.pts),textAlign:g.castOption(ue.align,W.pts),hovertemplate:g.castOption($.hovertemplate,W.pts),hovertemplateLabels:W,eventData:[d(W,$)]},{container:Q._hoverlayer.node(),outerContainer:Q._paper.node(),gd:B}),H._hasHoverLabel=!0}H._hasHoverEvent=!0,B.emit("plotly_hover",{points:[d(W,$)],event:t.event})}}),D.on("mouseout",function(W){var Q=B._fullLayout,$=B._fullData[H.index],ee=t.select(this).datum();H._hasHoverEvent&&(W.originalEvent=t.event,B.emit("plotly_unhover",{points:[d(ee,$)],event:t.event}),H._hasHoverEvent=!1),H._hasHoverLabel&&(p.loneUnhover(Q._hoverlayer.node()),H._hasHoverLabel=!1)}),D.on("click",function(W){var Q=B._fullLayout,$=B._fullData[H.index];B._dragging||Q.hovermode===!1||(B._hoverdata=[d(W,$)],p.click(B,t.event))})}function v(D,B,N){var F=g.castOption(D.insidetextfont.color,B.pts);!F&&D._input.textfont&&(F=g.castOption(D._input.textfont.color,B.pts));var H=g.castOption(D.insidetextfont.family,B.pts)||g.castOption(D.textfont.family,B.pts)||N.family,j=g.castOption(D.insidetextfont.size,B.pts)||g.castOption(D.textfont.size,B.pts)||N.size;return{color:F||l.contrast(B.color),family:H,size:j}}function T(D,B){for(var N,F,H=0;H<D.length;H++)if((F=(N=D[H][0]).trace).title.text){var j=F.title.text;F._meta&&(j=o.templateString(j,F._meta));var G=e.tester.append("text").attr("data-notex",1).text(j).call(e.font,F.title.font).call(u.convertToTspans,B),W=e.bBox(G.node(),!0);N.titleBox={width:W.width,height:W.height},G.remove()}}function w(D,B,N){var F=N.r||B.rpx1,H=B.rInscribed;if(B.startangle===B.stopangle)return{rCenter:1-H,scale:0,rotate:0,textPosAngle:0};var j,G=B.ring,W=G===1&&Math.abs(B.startangle-B.stopangle)===2*Math.PI,Q=B.halfangle,$=B.midangle,ee=N.trace.insidetextorientation,ie=ee==="horizontal",ae=ee==="tangential",oe=ee==="radial",de=ee==="auto",le=[];if(!de){var fe,ue=function(ve,ge){if(function(Fe,ze){var He=Fe.startangle,et=Fe.stopangle;return He>ze&&ze>et||He<ze&&ze<et}(B,ve)){var De=Math.abs(ve-B.startangle),_e=Math.abs(ve-B.stopangle),Pe=De<_e?De:_e;(j=ge==="tan"?E(D,F,G,Pe,0):A(D,F,G,Pe,Math.PI/2)).textPosAngle=ve,le.push(j)}};if(ie||ae){for(fe=4;fe>=-4;fe-=2)ue(Math.PI*fe,"tan");for(fe=4;fe>=-4;fe-=2)ue(Math.PI*(fe+1),"tan")}if(ie||oe){for(fe=4;fe>=-4;fe-=2)ue(Math.PI*(fe+1.5),"rad");for(fe=4;fe>=-4;fe-=2)ue(Math.PI*(fe+.5),"rad")}}if(W||de||ie){var we=Math.sqrt(D.width*D.width+D.height*D.height);if((j={scale:H*F*2/we,rCenter:1-H,rotate:0}).textPosAngle=(B.startangle+B.stopangle)/2,j.scale>=1)return j;le.push(j)}(de||oe)&&((j=A(D,F,G,Q,$)).textPosAngle=(B.startangle+B.stopangle)/2,le.push(j)),(de||ae)&&((j=E(D,F,G,Q,$)).textPosAngle=(B.startangle+B.stopangle)/2,le.push(j));for(var Ae=0,Se=0,ke=0;ke<le.length;ke++){var Me=le[ke].scale;if(Se<Me&&(Se=Me,Ae=ke),!de&&Se>=1)break}return le[Ae]}function A(D,B,N,F,H){B=Math.max(0,B-2*f);var j=D.width/D.height,G=_(j,F,B,N);return{scale:2*G/D.height,rCenter:M(j,G/B),rotate:b(H)}}function E(D,B,N,F,H){B=Math.max(0,B-2*f);var j=D.height/D.width,G=_(j,F,B,N);return{scale:2*G/D.width,rCenter:M(j,G/B),rotate:b(H+Math.PI/2)}}function M(D,B){return Math.cos(B)-D*B}function b(D){return(180/Math.PI*D+720)%180-90}function _(D,B,N,F){var H=D+1/(2*Math.tan(B));return N*Math.min(1/(Math.sqrt(H*H+.5)+H),F/(Math.sqrt(D*D+F/2)+D))}function S(D,B){return D.v!==B.vTotal||B.trace.hole?Math.min(1/(1+1/Math.sin(D.halfangle)),D.ring/2):1}function C(D,B){var N=B.pxmid[0],F=B.pxmid[1],H=D.width/2,j=D.height/2;return N<0&&(H*=-1),F<0&&(j*=-1),{scale:1,rCenter:1,rotate:0,x:H+Math.abs(j)*(H>0?1:-1)/2,y:j/(1+N*N/(F*F)),outside:!0}}function k(D,B){var N,F,H,j=D.trace,G={x:D.cx,y:D.cy},W={tx:0,ty:0};W.ty+=j.title.font.size,H=I(j),j.title.position.indexOf("top")!==-1?(G.y-=(1+H)*D.r,W.ty-=D.titleBox.height):j.title.position.indexOf("bottom")!==-1&&(G.y+=(1+H)*D.r);var Q,$,ee=(Q=D.r,$=D.trace.aspectratio,Q/($===void 0?1:$)),ie=B.w*(j.domain.x[1]-j.domain.x[0])/2;return j.title.position.indexOf("left")!==-1?(ie+=ee,G.x-=(1+H)*ee,W.tx+=D.titleBox.width/2):j.title.position.indexOf("center")!==-1?ie*=2:j.title.position.indexOf("right")!==-1&&(ie+=ee,G.x+=(1+H)*ee,W.tx-=D.titleBox.width/2),N=ie/D.titleBox.width,F=L(D,B)/D.titleBox.height,{x:G.x,y:G.y,scale:Math.min(N,F),tx:W.tx,ty:W.ty}}function L(D,B){var N=D.trace,F=B.h*(N.domain.y[1]-N.domain.y[0]);return Math.min(D.titleBox.height,F/2)}function I(D){var B,N=D.pull;if(!N)return 0;if(Array.isArray(N))for(N=0,B=0;B<D.pull.length;B++)D.pull[B]>N&&(N=D.pull[B]);return N}function R(D,B){for(var N=[],F=0;F<D.length;F++){var H=D[F][0],j=H.trace,G=j.domain,W=B.w*(G.x[1]-G.x[0]),Q=B.h*(G.y[1]-G.y[0]);j.title.text&&j.title.position!=="middle center"&&(Q-=L(H,B));var $=W/2,ee=Q/2;j.type!=="funnelarea"||j.scalegroup||(ee/=j.aspectratio),H.r=Math.min($,ee)/(1+I(j)),H.cx=B.l+B.w*(j.domain.x[1]+j.domain.x[0])/2,H.cy=B.t+B.h*(1-j.domain.y[0])-Q/2,j.title.text&&j.title.position.indexOf("bottom")!==-1&&(H.cy-=L(H,B)),j.scalegroup&&N.indexOf(j.scalegroup)===-1&&N.push(j.scalegroup)}(function(ie,ae){for(var oe,de,le,fe=0;fe<ae.length;fe++){var ue=1/0,we=ae[fe];for(de=0;de<ie.length;de++)if(oe=ie[de][0],(le=oe.trace).scalegroup===we){var Ae;if(le.type==="pie")Ae=oe.r*oe.r;else if(le.type==="funnelarea"){var Se,ke;le.aspectratio>1?(Se=oe.r,ke=Se/le.aspectratio):(ke=oe.r,Se=ke*le.aspectratio),Se*=(1+le.baseratio)/2,Ae=Se*ke}ue=Math.min(ue,Ae/oe.vTotal)}for(de=0;de<ie.length;de++)if(oe=ie[de][0],(le=oe.trace).scalegroup===we){var Me=ue*oe.vTotal;le.type==="funnelarea"&&(Me/=(1+le.baseratio)/2,Me/=le.aspectratio),oe.r=Math.sqrt(Me)}}})(D,N)}function V(D,B){return[D*Math.sin(B),-D*Math.cos(B)]}function O(D,B,N){var F=D._fullLayout,H=N.trace,j=H.texttemplate,G=H.textinfo;if(!j&&G&&G!=="none"){var W,Q=G.split("+"),$=function(Ae){return Q.indexOf(Ae)!==-1},ee=$("label"),ie=$("text"),ae=$("value"),oe=$("percent"),de=F.separators;if(W=ee?[B.label]:[],ie){var le=g.getFirstFilled(H.text,B.pts);m(le)&&W.push(le)}ae&&W.push(g.formatPieValue(B.v,de)),oe&&W.push(g.formatPiePercent(B.v/N.vTotal,de)),B.text=W.join("<br>")}if(j){var fe=o.castOption(H,B.i,"texttemplate");if(fe){var ue=function(Ae){return{label:Ae.label,value:Ae.v,valueLabel:g.formatPieValue(Ae.v,F.separators),percent:Ae.v/N.vTotal,percentLabel:g.formatPiePercent(Ae.v/N.vTotal,F.separators),color:Ae.color,text:Ae.text,customdata:o.castOption(H,Ae.i,"customdata")}}(B),we=g.getFirstFilled(H.text,B.pts);(m(we)||we==="")&&(ue.text=we),B.text=o.texttemplateString(fe,ue,D._fullLayout._d3locale,ue,H._meta||{})}else B.text=""}}function J(D,B){var N=D.rotate*Math.PI/180,F=Math.cos(N),H=Math.sin(N),j=(B.left+B.right)/2,G=(B.top+B.bottom)/2;D.textX=j*F-G*H,D.textY=j*H+G*F,D.noCenter=!0}z.exports={plot:function(D,B){var N=D._fullLayout,F=N._size;c("pie",N),T(B,D),R(B,F);var H=o.makeTraceGroups(N._pielayer,B,"trace").each(function(j){var G=t.select(this),W=j[0],Q=W.trace;(function($){var ee,ie,ae,oe=$[0],de=oe.r,le=oe.trace,fe=g.getRotationAngle(le.rotation),ue=2*Math.PI/oe.vTotal,we="px0",Ae="px1";if(le.direction==="counterclockwise"){for(ee=0;ee<$.length&&$[ee].hidden;ee++);if(ee===$.length)return;fe+=ue*$[ee].v,ue*=-1,we="px1",Ae="px0"}for(ae=V(de,fe),ee=0;ee<$.length;ee++)(ie=$[ee]).hidden||(ie[we]=ae,ie.startangle=fe,fe+=ue*ie.v/2,ie.pxmid=V(de,fe),ie.midangle=fe,fe+=ue*ie.v/2,ae=V(de,fe),ie.stopangle=fe,ie[Ae]=ae,ie.largeArc=ie.v>oe.vTotal/2?1:0,ie.halfangle=Math.PI*Math.min(ie.v/oe.vTotal,.5),ie.ring=1-le.hole,ie.rInscribed=S(ie,oe))})(j),G.attr("stroke-linejoin","round"),G.each(function(){var $=t.select(this).selectAll("g.slice").data(j);$.enter().append("g").classed("slice",!0),$.exit().remove();var ee=[[[],[]],[[],[]]],ie=!1;$.each(function(Ae,Se){if(Ae.hidden)t.select(this).selectAll("path,g").remove();else{Ae.pointNumber=Ae.i,Ae.curveNumber=Q.index,ee[Ae.pxmid[1]<0?0:1][Ae.pxmid[0]<0?0:1].push(Ae);var ke=W.cx,Me=W.cy,ve=t.select(this),ge=ve.selectAll("path.surface").data([Ae]);if(ge.enter().append("path").classed("surface",!0).style({"pointer-events":"all"}),ve.call(y,D,j),Q.pull){var De=+g.castOption(Q.pull,Ae.pts)||0;De>0&&(ke+=De*Ae.pxmid[0],Me+=De*Ae.pxmid[1])}Ae.cxFinal=ke,Ae.cyFinal=Me;var _e=Q.hole;if(Ae.v===W.vTotal){var Pe="M"+(ke+Ae.px0[0])+","+(Me+Ae.px0[1])+Re(Ae.px0,Ae.pxmid,!0,1)+Re(Ae.pxmid,Ae.px0,!0,1)+"Z";_e?ge.attr("d","M"+(ke+_e*Ae.px0[0])+","+(Me+_e*Ae.px0[1])+Re(Ae.px0,Ae.pxmid,!1,_e)+Re(Ae.pxmid,Ae.px0,!1,_e)+"Z"+Pe):ge.attr("d",Pe)}else{var Fe=Re(Ae.px0,Ae.px1,!0,1);if(_e){var ze=1-_e;ge.attr("d","M"+(ke+_e*Ae.px1[0])+","+(Me+_e*Ae.px1[1])+Re(Ae.px1,Ae.px0,!1,_e)+"l"+ze*Ae.px0[0]+","+ze*Ae.px0[1]+Fe+"Z")}else ge.attr("d","M"+ke+","+Me+"l"+Ae.px0[0]+","+Ae.px0[1]+Fe+"Z")}O(D,Ae,W);var He=g.castOption(Q.textposition,Ae.pts),et=ve.selectAll("g.slicetext").data(Ae.text&&He!=="none"?[0]:[]);et.enter().append("g").classed("slicetext",!0),et.exit().remove(),et.each(function(){var Ze=o.ensureSingle(t.select(this),"text","",function(be){be.attr("data-notex",1)}),Ke=o.ensureUniformFontSize(D,He==="outside"?function(be,We,Ge){var st=g.castOption(be.outsidetextfont.color,We.pts)||g.castOption(be.textfont.color,We.pts)||Ge.color,ot=g.castOption(be.outsidetextfont.family,We.pts)||g.castOption(be.textfont.family,We.pts)||Ge.family,Ce=g.castOption(be.outsidetextfont.size,We.pts)||g.castOption(be.textfont.size,We.pts)||Ge.size;return{color:st,family:ot,size:Ce}}(Q,Ae,N.font):v(Q,Ae,N.font));Ze.text(Ae.text).attr({class:"slicetext",transform:"","text-anchor":"middle"}).call(e.font,Ke).call(u.convertToTspans,D);var $e,rt=e.bBox(Ze.node());if(He==="outside")$e=C(rt,Ae);else if($e=w(rt,Ae,W),He==="auto"&&$e.scale<1){var at=o.ensureUniformFontSize(D,Q.outsidetextfont);Ze.call(e.font,at),$e=C(rt=e.bBox(Ze.node()),Ae)}var lt=$e.textPosAngle,gt=lt===void 0?Ae.pxmid:V(W.r,lt);if($e.targetX=ke+gt[0]*$e.rCenter+($e.x||0),$e.targetY=Me+gt[1]*$e.rCenter+($e.y||0),J($e,rt),$e.outside){var Ie=$e.targetY;Ae.yLabelMin=Ie-rt.height/2,Ae.yLabelMid=Ie,Ae.yLabelMax=Ie+rt.height/2,Ae.labelExtraX=0,Ae.labelExtraY=0,ie=!0}$e.fontSize=Ke.size,a(Q.type,$e,N),j[Se].transform=$e,Ze.attr("transform",o.getTextTransform($e))})}function Re(Ze,Ke,$e,rt){var at=rt*(Ke[0]-Ze[0]),lt=rt*(Ke[1]-Ze[1]);return"a"+rt*W.r+","+rt*W.r+" 0 "+Ae.largeArc+($e?" 1 ":" 0 ")+at+","+lt}});var ae=t.select(this).selectAll("g.titletext").data(Q.title.text?[0]:[]);if(ae.enter().append("g").classed("titletext",!0),ae.exit().remove(),ae.each(function(){var Ae,Se=o.ensureSingle(t.select(this),"text","",function(Me){Me.attr("data-notex",1)}),ke=Q.title.text;Q._meta&&(ke=o.templateString(ke,Q._meta)),Se.text(ke).attr({class:"titletext",transform:"","text-anchor":"middle"}).call(e.font,Q.title.font).call(u.convertToTspans,D),Ae=Q.title.position==="middle center"?function(Me){var ve=Math.sqrt(Me.titleBox.width*Me.titleBox.width+Me.titleBox.height*Me.titleBox.height);return{x:Me.cx,y:Me.cy,scale:Me.trace.hole*Me.r*2/ve,tx:0,ty:-Me.titleBox.height/2+Me.trace.title.font.size}}(W):k(W,F),Se.attr("transform",i(Ae.x,Ae.y)+r(Math.min(1,Ae.scale))+i(Ae.tx,Ae.ty))}),ie&&function(Ae,Se){var ke,Me,ve,ge,De,_e,Pe,Fe,ze,He,et,Re,Ze;function Ke(lt,gt){return lt.pxmid[1]-gt.pxmid[1]}function $e(lt,gt){return gt.pxmid[1]-lt.pxmid[1]}function rt(lt,gt){gt||(gt={});var Ie,be,We,Ge,st=gt.labelExtraY+(Me?gt.yLabelMax:gt.yLabelMin),ot=Me?lt.yLabelMin:lt.yLabelMax,Ce=Me?lt.yLabelMax:lt.yLabelMin,Ue=lt.cyFinal+De(lt.px0[1],lt.px1[1]),Ye=st-ot;if(Ye*Pe>0&&(lt.labelExtraY=Ye),Array.isArray(Se.pull))for(be=0;be<He.length;be++)(We=He[be])===lt||(g.castOption(Se.pull,lt.pts)||0)>=(g.castOption(Se.pull,We.pts)||0)||((lt.pxmid[1]-We.pxmid[1])*Pe>0?(Ye=We.cyFinal+De(We.px0[1],We.px1[1])-ot-lt.labelExtraY)*Pe>0&&(lt.labelExtraY+=Ye):(Ce+lt.labelExtraY-Ue)*Pe>0&&(Ie=3*_e*Math.abs(be-He.indexOf(lt)),(Ge=We.cxFinal+ge(We.px0[0],We.px1[0])+Ie-(lt.cxFinal+lt.pxmid[0])-lt.labelExtraX)*_e>0&&(lt.labelExtraX+=Ge)))}for(Me=0;Me<2;Me++)for(ve=Me?Ke:$e,De=Me?Math.max:Math.min,Pe=Me?1:-1,ke=0;ke<2;ke++){for(ge=ke?Math.max:Math.min,_e=ke?1:-1,(Fe=Ae[Me][ke]).sort(ve),ze=Ae[1-Me][ke],He=ze.concat(Fe),Re=[],et=0;et<Fe.length;et++)Fe[et].yLabelMid!==void 0&&Re.push(Fe[et]);for(Ze=!1,et=0;Me&&et<ze.length;et++)if(ze[et].yLabelMid!==void 0){Ze=ze[et];break}for(et=0;et<Re.length;et++){var at=et&&Re[et-1];Ze&&!et&&(at=Ze),rt(Re[et],at)}}}(ee,Q),function(Ae,Se){Ae.each(function(ke){var Me=t.select(this);if(ke.labelExtraX||ke.labelExtraY){var ve=Me.select("g.slicetext text");ke.transform.targetX+=ke.labelExtraX,ke.transform.targetY+=ke.labelExtraY,ve.attr("transform",o.getTextTransform(ke.transform));var ge=ke.cxFinal+ke.pxmid[0],De="M"+ge+","+(ke.cyFinal+ke.pxmid[1]),_e=(ke.yLabelMax-ke.yLabelMin)*(ke.pxmid[0]<0?-1:1)/4;if(ke.labelExtraX){var Pe=ke.labelExtraX*ke.pxmid[1]/ke.pxmid[0],Fe=ke.yLabelMid+ke.labelExtraY-(ke.cyFinal+ke.pxmid[1]);Math.abs(Pe)>Math.abs(Fe)?De+="l"+Fe*ke.pxmid[0]/ke.pxmid[1]+","+Fe+"H"+(ge+ke.labelExtraX+_e):De+="l"+ke.labelExtraX+","+Pe+"v"+(Fe-Pe)+"h"+_e}else De+="V"+(ke.yLabelMid+ke.labelExtraY)+"h"+_e;o.ensureSingle(Me,"path","textline").call(l.stroke,Se.outsidetextfont.color).attr({"stroke-width":Math.min(2,Se.outsidetextfont.size/8),d:De,fill:"none"})}else Me.select("path.textline").remove()})}($,Q),ie&&Q.automargin){var oe=e.bBox(G.node()),de=Q.domain,le=F.w*(de.x[1]-de.x[0]),fe=F.h*(de.y[1]-de.y[0]),ue=(.5*le-W.r)/F.w,we=(.5*fe-W.r)/F.h;h.autoMargin(D,"pie."+Q.uid+".automargin",{xl:de.x[0]-ue,xr:de.x[1]+ue,yb:de.y[0]-we,yt:de.y[1]+we,l:Math.max(W.cx-W.r-oe.left,0),r:Math.max(oe.right-(W.cx+W.r),0),b:Math.max(oe.bottom-(W.cy+W.r),0),t:Math.max(W.cy-W.r-oe.top,0),pad:5})}})});setTimeout(function(){H.selectAll("tspan").each(function(){var j=t.select(this);j.attr("dy")&&j.attr("dy",j.attr("dy"))})},0)},formatSliceLabel:O,transformInsideText:w,determineInsideTextFont:v,positionTitleOutside:k,prerenderTitles:T,layoutAreas:R,attachFxHandlers:y,computeTransform:J}},{"../../components/color":643,"../../components/drawing":665,"../../components/fx":683,"../../lib":778,"../../lib/svg_text_utils":803,"../../plots/plots":891,"../bar/constants":923,"../bar/uniform_text":937,"./event_data":1165,"./helpers":1166,d3:169}],1171:[function(n,z,q){"use strict";var t=n("d3"),h=n("./style_one"),p=n("../bar/uniform_text").resizeText;z.exports=function(l){var e=l._fullLayout._pielayer.selectAll(".trace");p(l,e,"pie"),e.each(function(o){var r=o[0].trace,i=t.select(this);i.style({opacity:r.opacity}),i.selectAll("path.surface").each(function(u){t.select(this).call(h,u,r)})})}},{"../bar/uniform_text":937,"./style_one":1172,d3:169}],1172:[function(n,z,q){"use strict";var t=n("../../components/color"),h=n("./helpers").castOption;z.exports=function(p,l,e){var o=e.marker.line,r=h(o.color,l.pts)||t.defaultLine,i=h(o.width,l.pts)||0;p.style("stroke-width",i).call(t.fill,l.color).call(t.stroke,r)}},{"../../components/color":643,"./helpers":1166}],1173:[function(n,z,q){"use strict";var t=n("../scatter/attributes");z.exports={x:t.x,y:t.y,xy:{valType:"data_array",editType:"calc"},indices:{valType:"data_array",editType:"calc"},xbounds:{valType:"data_array",editType:"calc"},ybounds:{valType:"data_array",editType:"calc"},text:t.text,marker:{color:{valType:"color",arrayOk:!1,editType:"calc"},opacity:{valType:"number",min:0,max:1,dflt:1,arrayOk:!1,editType:"calc"},blend:{valType:"boolean",dflt:null,editType:"calc"},sizemin:{valType:"number",min:.1,max:2,dflt:.5,editType:"calc"},sizemax:{valType:"number",min:.1,dflt:20,editType:"calc"},border:{color:{valType:"color",arrayOk:!1,editType:"calc"},arearatio:{valType:"number",min:0,max:1,dflt:0,editType:"calc"},editType:"calc"},editType:"calc"},transforms:void 0}},{"../scatter/attributes":1187}],1174:[function(n,z,q){"use strict";var t=n("gl-pointcloud2d"),h=n("../../lib/str2rgbarray"),p=n("../../plots/cartesian/autorange").findExtremes,l=n("../scatter/get_trace_color");function e(r,i){this.scene=r,this.uid=i,this.type="pointcloud",this.pickXData=[],this.pickYData=[],this.xData=[],this.yData=[],this.textLabels=[],this.color="rgb(0, 0, 0)",this.name="",this.hoverinfo="all",this.idToIndex=new Int32Array(0),this.bounds=[0,0,0,0],this.pointcloudOptions={positions:new Float32Array(0),idToIndex:this.idToIndex,sizemin:.5,sizemax:12,color:[0,0,0,1],areaRatio:1,borderColor:[0,0,0,1]},this.pointcloud=t(r.glplot,this.pointcloudOptions),this.pointcloud._trace=this}var o=e.prototype;o.handlePick=function(r){var i=this.idToIndex[r.pointId];return{trace:this,dataCoord:r.dataCoord,traceCoord:this.pickXYData?[this.pickXYData[2*i],this.pickXYData[2*i+1]]:[this.pickXData[i],this.pickYData[i]],textLabel:Array.isArray(this.textLabels)?this.textLabels[i]:this.textLabels,color:this.color,name:this.name,pointIndex:i,hoverinfo:this.hoverinfo}},o.update=function(r){this.index=r.index,this.textLabels=r.text,this.name=r.name,this.hoverinfo=r.hoverinfo,this.bounds=[1/0,1/0,-1/0,-1/0],this.updateFast(r),this.color=l(r,{})},o.updateFast=function(r){var i,u,s,a,c,f,g=this.xData=this.pickXData=r.x,d=this.yData=this.pickYData=r.y,m=this.pickXYData=r.xy,y=r.xbounds&&r.ybounds,v=r.indices,T=this.bounds;if(m){if(s=m,i=m.length>>>1,y)T[0]=r.xbounds[0],T[2]=r.xbounds[1],T[1]=r.ybounds[0],T[3]=r.ybounds[1];else for(f=0;f<i;f++)a=s[2*f],c=s[2*f+1],a<T[0]&&(T[0]=a),a>T[2]&&(T[2]=a),c<T[1]&&(T[1]=c),c>T[3]&&(T[3]=c);if(v)u=v;else for(u=new Int32Array(i),f=0;f<i;f++)u[f]=f}else for(i=g.length,s=new Float32Array(2*i),u=new Int32Array(i),f=0;f<i;f++)a=g[f],c=d[f],u[f]=f,s[2*f]=a,s[2*f+1]=c,a<T[0]&&(T[0]=a),a>T[2]&&(T[2]=a),c<T[1]&&(T[1]=c),c>T[3]&&(T[3]=c);this.idToIndex=u,this.pointcloudOptions.idToIndex=u,this.pointcloudOptions.positions=s;var w=h(r.marker.color),A=h(r.marker.border.color),E=r.opacity*r.marker.opacity;w[3]*=E,this.pointcloudOptions.color=w;var M=r.marker.blend;M===null&&(M=g.length<100||d.length<100),this.pointcloudOptions.blend=M,A[3]*=E,this.pointcloudOptions.borderColor=A;var b=r.marker.sizemin,_=Math.max(r.marker.sizemax,r.marker.sizemin);this.pointcloudOptions.sizeMin=b,this.pointcloudOptions.sizeMax=_,this.pointcloudOptions.areaRatio=r.marker.border.arearatio,this.pointcloud.update(this.pointcloudOptions);var S=this.scene.xaxis,C=this.scene.yaxis,k=_/2||.5;r._extremes[S._id]=p(S,[T[0],T[2]],{ppad:k}),r._extremes[C._id]=p(C,[T[1],T[3]],{ppad:k})},o.dispose=function(){this.pointcloud.dispose()},z.exports=function(r,i){var u=new e(r,i.uid);return u.update(i),u}},{"../../lib/str2rgbarray":802,"../../plots/cartesian/autorange":827,"../scatter/get_trace_color":1197,"gl-pointcloud2d":324}],1175:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("./attributes");z.exports=function(p,l,e){function o(r,i){return t.coerce(p,l,h,r,i)}o("x"),o("y"),o("xbounds"),o("ybounds"),p.xy&&p.xy instanceof Float32Array&&(l.xy=p.xy),p.indices&&p.indices instanceof Int32Array&&(l.indices=p.indices),o("text"),o("marker.color",e),o("marker.opacity"),o("marker.blend"),o("marker.sizemin"),o("marker.sizemax"),o("marker.border.color",e),o("marker.border.arearatio"),l._length=null}},{"../../lib":778,"./attributes":1173}],1176:[function(n,z,q){"use strict";z.exports={attributes:n("./attributes"),supplyDefaults:n("./defaults"),calc:n("../scatter3d/calc"),plot:n("./convert"),moduleType:"trace",name:"pointcloud",basePlotModule:n("../../plots/gl2d"),categories:["gl","gl2d","showLegend"],meta:{}}},{"../../plots/gl2d":868,"../scatter3d/calc":1216,"./attributes":1173,"./convert":1174,"./defaults":1175}],1177:[function(n,z,q){"use strict";var t=n("../../plots/font_attributes"),h=n("../../plots/attributes"),p=n("../../components/color/attributes"),l=n("../../components/fx/attributes"),e=n("../../plots/domain").attributes,o=n("../../plots/template_attributes").hovertemplateAttrs,r=n("../../components/colorscale/attributes"),i=n("../../plot_api/plot_template").templatedArray,u=n("../../lib/extend").extendFlat,s=n("../../plot_api/edit_types").overrideAll;n("../../constants/docs").FORMAT_LINK,(z.exports=s({hoverinfo:u({},h.hoverinfo,{flags:[],arrayOk:!1}),hoverlabel:l.hoverlabel,domain:e({name:"sankey",trace:!0}),orientation:{valType:"enumerated",values:["v","h"],dflt:"h"},valueformat:{valType:"string",dflt:".3s"},valuesuffix:{valType:"string",dflt:""},arrangement:{valType:"enumerated",values:["snap","perpendicular","freeform","fixed"],dflt:"snap"},textfont:t({}),customdata:void 0,node:{label:{valType:"data_array",dflt:[]},groups:{valType:"info_array",impliedEdits:{x:[],y:[]},dimensions:2,freeLength:!0,dflt:[],items:{valType:"number",editType:"calc"}},x:{valType:"data_array",dflt:[]},y:{valType:"data_array",dflt:[]},color:{valType:"color",arrayOk:!0},customdata:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:p.defaultLine,arrayOk:!0},width:{valType:"number",min:0,dflt:.5,arrayOk:!0}},pad:{valType:"number",arrayOk:!1,min:0,dflt:20},thickness:{valType:"number",arrayOk:!1,min:1,dflt:20},hoverinfo:{valType:"enumerated",values:["all","none","skip"],dflt:"all"},hoverlabel:l.hoverlabel,hovertemplate:o({},{keys:["value","label"]})},link:{label:{valType:"data_array",dflt:[]},color:{valType:"color",arrayOk:!0},customdata:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:p.defaultLine,arrayOk:!0},width:{valType:"number",min:0,dflt:0,arrayOk:!0}},source:{valType:"data_array",dflt:[]},target:{valType:"data_array",dflt:[]},value:{valType:"data_array",dflt:[]},hoverinfo:{valType:"enumerated",values:["all","none","skip"],dflt:"all"},hoverlabel:l.hoverlabel,hovertemplate:o({},{keys:["value","label"]}),colorscales:i("concentrationscales",{editType:"calc",label:{valType:"string",editType:"calc",dflt:""},cmax:{valType:"number",editType:"calc",dflt:1},cmin:{valType:"number",editType:"calc",dflt:0},colorscale:u(r().colorscale,{dflt:[[0,"white"],[1,"black"]]})})}},"calc","nested")).transforms=void 0},{"../../components/color/attributes":642,"../../components/colorscale/attributes":650,"../../components/fx/attributes":674,"../../constants/docs":748,"../../lib/extend":768,"../../plot_api/edit_types":810,"../../plot_api/plot_template":817,"../../plots/attributes":824,"../../plots/domain":855,"../../plots/font_attributes":856,"../../plots/template_attributes":906}],1178:[function(n,z,q){"use strict";var t=n("../../plot_api/edit_types").overrideAll,h=n("../../plots/get_data").getModuleCalcData,p=n("./plot"),l=n("../../components/fx/layout_attributes"),e=n("../../lib/setcursor"),o=n("../../components/dragelement"),r=n("../../plots/cartesian/select").prepSelect,i=n("../../lib"),u=n("../../registry");function s(a,c){var f=a._fullData[c],g=a._fullLayout,d=g.dragmode,m=g.dragmode==="pan"?"move":"crosshair",y=f._bgRect;if(d!=="pan"&&d!=="zoom"){e(y,m);var v={_id:"x",c2p:i.identity,_offset:f._sankey.translateX,_length:f._sankey.width},T={_id:"y",c2p:i.identity,_offset:f._sankey.translateY,_length:f._sankey.height},w={gd:a,element:y.node(),plotinfo:{id:c,xaxis:v,yaxis:T,fillRangeItems:i.noop},subplot:c,xaxes:[v],yaxes:[T],doneFnCompleted:function(A){var E,M=a._fullData[c],b=M.node.groups.slice(),_=[];function S(I){for(var R=M._sankey.graph.nodes,V=0;V<R.length;V++)if(R[V].pointNumber===I)return R[V]}for(var C=0;C<A.length;C++){var k=S(A[C].pointNumber);if(k)if(k.group){for(var L=0;L<k.childrenNodes.length;L++)_.push(k.childrenNodes[L].pointNumber);b[k.pointNumber-M.node._count]=!1}else _.push(k.pointNumber)}E=b.filter(Boolean).concat([_]),u.call("_guiRestyle",a,{"node.groups":[E]},c)},prepFn:function(A,E,M){r(A,E,M,w,d)}};o.init(w)}}q.name="sankey",q.baseLayoutAttrOverrides=t({hoverlabel:l.hoverlabel},"plot","nested"),q.plot=function(a){var c=h(a.calcdata,"sankey")[0];p(a,c),q.updateFx(a)},q.clean=function(a,c,f,g){var d=g._has&&g._has("sankey"),m=c._has&&c._has("sankey");d&&!m&&(g._paperdiv.selectAll(".sankey").remove(),g._paperdiv.selectAll(".bgsankey").remove())},q.updateFx=function(a){for(var c=0;c<a._fullData.length;c++)s(a,c)}},{"../../components/dragelement":662,"../../components/fx/layout_attributes":684,"../../lib":778,"../../lib/setcursor":799,"../../plot_api/edit_types":810,"../../plots/cartesian/select":847,"../../plots/get_data":865,"../../registry":911,"./plot":1183}],1179:[function(n,z,q){"use strict";var t=n("strongly-connected-components"),h=n("../../lib"),p=n("../../lib/gup").wrap,l=h.isArrayOrTypedArray,e=h.isIndex,o=n("../../components/colorscale");function r(i){var u,s=i.node,a=i.link,c=[],f=l(a.color),g=l(a.customdata),d={},m={},y=a.colorscales.length;for(u=0;u<y;u++){var v=a.colorscales[u],T=o.extractScale(v,{cLetter:"c"}),w=o.makeColorScaleFunc(T);m[v.label]=w}var A=0;for(u=0;u<a.value.length;u++)a.source[u]>A&&(A=a.source[u]),a.target[u]>A&&(A=a.target[u]);var E,M=A+1;i.node._count=M;var b=i.node.groups,_={};for(u=0;u<b.length;u++){var S=b[u];for(E=0;E<S.length;E++){var C=S[E],k=M+u;_.hasOwnProperty(C)?h.warn("Node "+C+" is already part of a group."):_[C]=k}}var L={source:[],target:[]};for(u=0;u<a.value.length;u++){var I=a.value[u],R=a.source[u],V=a.target[u];if(I>0&&e(R,M)&&e(V,M)&&(!_.hasOwnProperty(R)||!_.hasOwnProperty(V)||_[R]!==_[V])){_.hasOwnProperty(V)&&(V=_[V]),_.hasOwnProperty(R)&&(R=_[R]),V=+V,d[R=+R]=d[V]=!0;var O="";a.label&&a.label[u]&&(O=a.label[u]);var J=null;O&&m.hasOwnProperty(O)&&(J=m[O]),c.push({pointNumber:u,label:O,color:f?a.color[u]:a.color,customdata:g?a.customdata[u]:a.customdata,concentrationscale:J,source:R,target:V,value:+I}),L.source.push(R),L.target.push(V)}}var D=M+b.length,B=l(s.color),N=l(s.customdata),F=[];for(u=0;u<D;u++)if(d[u]){var H=s.label[u];F.push({group:u>M-1,childrenNodes:[],pointNumber:u,label:H,color:B?s.color[u]:s.color,customdata:N?s.customdata[u]:s.customdata})}var j=!1;return function(G,W,Q){for(var $=h.init2dArray(G,0),ee=0;ee<Math.min(W.length,Q.length);ee++)if(h.isIndex(W[ee],G)&&h.isIndex(Q[ee],G)){if(W[ee]===Q[ee])return!0;$[W[ee]].push(Q[ee])}return t($).components.some(function(ie){return ie.length>1})}(D,L.source,L.target)&&(j=!0),{circular:j,links:c,nodes:F,groups:b,groupLookup:_}}z.exports=function(i,u){var s=r(u);return p({circular:s.circular,_nodes:s.nodes,_links:s.links,_groups:s.groups,_groupLookup:s.groupLookup})}},{"../../components/colorscale":655,"../../lib":778,"../../lib/gup":775,"strongly-connected-components":569}],1180:[function(n,z,q){"use strict";z.exports={nodeTextOffsetHorizontal:4,nodeTextOffsetVertical:3,nodePadAcross:10,sankeyIterations:50,forceIterations:5,forceTicksPerFrame:10,duration:500,ease:"linear",cn:{sankey:"sankey",sankeyLinks:"sankey-links",sankeyLink:"sankey-link",sankeyNodeSet:"sankey-node-set",sankeyNode:"sankey-node",nodeRect:"node-rect",nodeCapture:"node-capture",nodeCentered:"node-entered",nodeLabelGuide:"node-label-guide",nodeLabel:"node-label",nodeLabelTextPath:"node-label-text-path"}}},{}],1181:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("./attributes"),p=n("../../components/color"),l=n("tinycolor2"),e=n("../../plots/domain").defaults,o=n("../../components/fx/hoverlabel_defaults"),r=n("../../plot_api/plot_template"),i=n("../../plots/array_container_defaults");function u(s,a){function c(f,g){return t.coerce(s,a,h.link.colorscales,f,g)}c("label"),c("cmin"),c("cmax"),c("colorscale")}z.exports=function(s,a,c,f){function g(_,S){return t.coerce(s,a,h,_,S)}var d=t.extendDeep(f.hoverlabel,s.hoverlabel),m=s.node,y=r.newContainer(a,"node");function v(_,S){return t.coerce(m,y,h.node,_,S)}v("label"),v("groups"),v("x"),v("y"),v("pad"),v("thickness"),v("line.color"),v("line.width"),v("hoverinfo",s.hoverinfo),o(m,y,v,d),v("hovertemplate");var T=f.colorway;v("color",y.label.map(function(_,S){return p.addOpacity(function(C){return T[C%T.length]}(S),.8)})),v("customdata");var w=s.link||{},A=r.newContainer(a,"link");function E(_,S){return t.coerce(w,A,h.link,_,S)}E("label"),E("source"),E("target"),E("value"),E("line.color"),E("line.width"),E("hoverinfo",s.hoverinfo),o(w,A,E,d),E("hovertemplate");var M,b=l(f.paper_bgcolor).getLuminance()<.333?"rgba(255, 255, 255, 0.6)":"rgba(0, 0, 0, 0.2)";E("color",t.repeat(b,A.value.length)),E("customdata"),i(w,A,{name:"colorscales",handleItemDefaults:u}),e(a,f,g),g("orientation"),g("valueformat"),g("valuesuffix"),y.x.length&&y.y.length&&(M="freeform"),g("arrangement",M),t.coerceFont(g,"textfont",t.extendFlat({},f.font)),a._length=null}},{"../../components/color":643,"../../components/fx/hoverlabel_defaults":681,"../../lib":778,"../../plot_api/plot_template":817,"../../plots/array_container_defaults":823,"../../plots/domain":855,"./attributes":1177,tinycolor2:576}],1182:[function(n,z,q){"use strict";z.exports={attributes:n("./attributes"),supplyDefaults:n("./defaults"),calc:n("./calc"),plot:n("./plot"),moduleType:"trace",name:"sankey",basePlotModule:n("./base_plot"),selectPoints:n("./select.js"),categories:["noOpacity"],meta:{}}},{"./attributes":1177,"./base_plot":1178,"./calc":1179,"./defaults":1181,"./plot":1183,"./select.js":1185}],1183:[function(n,z,q){"use strict";var t=n("d3"),h=n("./render"),p=n("../../components/fx"),l=n("../../components/color"),e=n("../../lib"),o=n("./constants").cn,r=e._;function i(T){return T!==""}function u(T,w){return T.filter(function(A){return A.key===w.traceId})}function s(T,w){t.select(T).select("path").style("fill-opacity",w),t.select(T).select("rect").style("fill-opacity",w)}function a(T){t.select(T).select("text.name").style("fill","black")}function c(T){return function(w){return T.node.sourceLinks.indexOf(w.link)!==-1||T.node.targetLinks.indexOf(w.link)!==-1}}function f(T){return function(w){return w.node.sourceLinks.indexOf(T.link)!==-1||w.node.targetLinks.indexOf(T.link)!==-1}}function g(T,w,A){w&&A&&u(A,w).selectAll("."+o.sankeyLink).filter(c(w)).call(m.bind(0,w,A,!1))}function d(T,w,A){w&&A&&u(A,w).selectAll("."+o.sankeyLink).filter(c(w)).call(y.bind(0,w,A,!1))}function m(T,w,A,E){var M=E.datum().link.label;E.style("fill-opacity",function(b){if(!b.link.concentrationscale)return .4}),M&&u(w,T).selectAll("."+o.sankeyLink).filter(function(b){return b.link.label===M}).style("fill-opacity",function(b){if(!b.link.concentrationscale)return .4}),A&&u(w,T).selectAll("."+o.sankeyNode).filter(f(T)).call(g)}function y(T,w,A,E){var M=E.datum().link.label;E.style("fill-opacity",function(b){return b.tinyColorAlpha}),M&&u(w,T).selectAll("."+o.sankeyLink).filter(function(b){return b.link.label===M}).style("fill-opacity",function(b){return b.tinyColorAlpha}),A&&u(w,T).selectAll(o.sankeyNode).filter(f(T)).call(d)}function v(T,w){var A=T.hoverlabel||{},E=e.nestedProperty(A,w).get();return!Array.isArray(E)&&E}z.exports=function(T,w){for(var A=T._fullLayout,E=A._paper,M=A._size,b=0;b<T._fullData.length;b++)if(T._fullData[b].visible&&T._fullData[b].type===o.sankey&&!T._fullData[b]._viewInitial){var _=T._fullData[b].node;T._fullData[b]._viewInitial={node:{groups:_.groups.slice(),x:_.x.slice(),y:_.y.slice()}}}var S=r(T,"source:")+" ",C=r(T,"target:")+" ",k=r(T,"concentration:")+" ",L=r(T,"incoming flow count:")+" ",I=r(T,"outgoing flow count:")+" ";h(T,E,w,{width:M.w,height:M.h,margin:{t:M.t,r:M.r,b:M.b,l:M.l}},{linkEvents:{hover:function(R,V,O){T._fullLayout.hovermode!==!1&&(t.select(R).call(m.bind(0,V,O,!0)),V.link.trace.link.hoverinfo!=="skip"&&(V.link.fullData=V.link.trace,T.emit("plotly_hover",{event:t.event,points:[V.link]})))},follow:function(R,V){if(T._fullLayout.hovermode!==!1){var O=V.link.trace.link;if(O.hoverinfo!=="none"&&O.hoverinfo!=="skip"){for(var J=[],D=0,B=0;B<V.flow.links.length;B++){var N=V.flow.links[B];if(T._fullLayout.hovermode!=="closest"||V.link.pointNumber===N.pointNumber){V.link.pointNumber===N.pointNumber&&(D=B),N.fullData=N.trace,O=V.link.trace.link;var F=j(N),H={valueLabel:t.format(V.valueFormat)(N.value)+V.valueSuffix};J.push({x:F[0],y:F[1],name:H.valueLabel,text:[N.label||"",S+N.source.label,C+N.target.label,N.concentrationscale?k+t.format("%0.2f")(N.flow.labelConcentration):""].filter(i).join("<br>"),color:v(O,"bgcolor")||l.addOpacity(N.color,1),borderColor:v(O,"bordercolor"),fontFamily:v(O,"font.family"),fontSize:v(O,"font.size"),fontColor:v(O,"font.color"),nameLength:v(O,"namelength"),textAlign:v(O,"align"),idealAlign:t.event.x<F[0]?"right":"left",hovertemplate:O.hovertemplate,hovertemplateLabels:H,eventData:[N]})}}p.loneHover(J,{container:A._hoverlayer.node(),outerContainer:A._paper.node(),gd:T,anchorIndex:D}).each(function(){V.link.concentrationscale||s(this,.65),a(this)})}}function j(G){var W,Q;G.circular?(W=(G.circularPathData.leftInnerExtent+G.circularPathData.rightInnerExtent)/2,Q=G.circularPathData.verticalFullExtent):(W=(G.source.x1+G.target.x0)/2,Q=(G.y0+G.y1)/2);var $=[W,Q];return G.trace.orientation==="v"&&$.reverse(),$[0]+=V.parent.translateX,$[1]+=V.parent.translateY,$}},unhover:function(R,V,O){T._fullLayout.hovermode!==!1&&(t.select(R).call(y.bind(0,V,O,!0)),V.link.trace.link.hoverinfo!=="skip"&&(V.link.fullData=V.link.trace,T.emit("plotly_unhover",{event:t.event,points:[V.link]})),p.loneUnhover(A._hoverlayer.node()))},select:function(R,V){var O=V.link;O.originalEvent=t.event,T._hoverdata=[O],p.click(T,{target:!0})}},nodeEvents:{hover:function(R,V,O){T._fullLayout.hovermode!==!1&&(t.select(R).call(g,V,O),V.node.trace.node.hoverinfo!=="skip"&&(V.node.fullData=V.node.trace,T.emit("plotly_hover",{event:t.event,points:[V.node]})))},follow:function(R,V){if(T._fullLayout.hovermode!==!1){var O=V.node.trace.node;if(O.hoverinfo!=="none"&&O.hoverinfo!=="skip"){var J=t.select(R).select("."+o.nodeRect),D=T._fullLayout._paperdiv.node().getBoundingClientRect(),B=J.node().getBoundingClientRect(),N=B.left-2-D.left,F=B.right+2-D.left,H=B.top+B.height/4-D.top,j={valueLabel:t.format(V.valueFormat)(V.node.value)+V.valueSuffix};V.node.fullData=V.node.trace,T._fullLayout._calcInverseTransform(T);var G=T._fullLayout._invScaleX,W=T._fullLayout._invScaleY,Q=p.loneHover({x0:G*N,x1:G*F,y:W*H,name:t.format(V.valueFormat)(V.node.value)+V.valueSuffix,text:[V.node.label,L+V.node.targetLinks.length,I+V.node.sourceLinks.length].filter(i).join("<br>"),color:v(O,"bgcolor")||V.tinyColorHue,borderColor:v(O,"bordercolor"),fontFamily:v(O,"font.family"),fontSize:v(O,"font.size"),fontColor:v(O,"font.color"),nameLength:v(O,"namelength"),textAlign:v(O,"align"),idealAlign:"left",hovertemplate:O.hovertemplate,hovertemplateLabels:j,eventData:[V.node]},{container:A._hoverlayer.node(),outerContainer:A._paper.node(),gd:T});s(Q,.85),a(Q)}}},unhover:function(R,V,O){T._fullLayout.hovermode!==!1&&(t.select(R).call(d,V,O),V.node.trace.node.hoverinfo!=="skip"&&(V.node.fullData=V.node.trace,T.emit("plotly_unhover",{event:t.event,points:[V.node]})),p.loneUnhover(A._hoverlayer.node()))},select:function(R,V,O){var J=V.node;J.originalEvent=t.event,T._hoverdata=[J],t.select(R).call(d,V,O),p.click(T,{target:!0})}}})}},{"../../components/color":643,"../../components/fx":683,"../../lib":778,"./constants":1180,"./render":1184,d3:169}],1184:[function(n,z,q){"use strict";var t=n("./constants"),h=n("d3"),p=n("tinycolor2"),l=n("../../components/color"),e=n("../../components/drawing"),o=n("@plotly/d3-sankey"),r=n("@plotly/d3-sankey-circular"),i=n("d3-force"),u=n("../../lib"),s=u.strTranslate,a=n("../../lib/gup"),c=a.keyFun,f=a.repeat,g=a.unwrap,d=n("d3-interpolate").interpolateNumber,m=n("../../registry");function y(F,H,j){var G,W=g(H),Q=W.trace,$=Q.domain,ee=Q.orientation==="h",ie=Q.node.pad,ae=Q.node.thickness,oe=F.width*($.x[1]-$.x[0]),de=F.height*($.y[1]-$.y[0]),le=W._nodes,fe=W._links,ue=W.circular;(G=ue?r.sankeyCircular().circularLinkGap(0):o.sankey()).iterations(t.sankeyIterations).size(ee?[oe,de]:[de,oe]).nodeWidth(ae).nodePadding(ie).nodeId(function(Fe){return Fe.pointNumber}).nodes(le).links(fe);var we,Ae,Se,ke=G();for(var Me in G.nodePadding()<ie&&u.warn("node.pad was reduced to ",G.nodePadding()," to fit within the figure."),W._groupLookup){var ve,ge=parseInt(W._groupLookup[Me]);for(we=0;we<ke.nodes.length;we++)if(ke.nodes[we].pointNumber===ge){ve=ke.nodes[we];break}if(ve){var De={pointNumber:parseInt(Me),x0:ve.x0,x1:ve.x1,y0:ve.y0,y1:ve.y1,partOfGroup:!0,sourceLinks:[],targetLinks:[]};ke.nodes.unshift(De),ve.childrenNodes.unshift(De)}}if(function(){for(we=0;we<ke.nodes.length;we++){var Fe,ze,He=ke.nodes[we],et={};for(Ae=0;Ae<He.targetLinks.length;Ae++)Fe=(ze=He.targetLinks[Ae]).source.pointNumber+":"+ze.target.pointNumber,et.hasOwnProperty(Fe)||(et[Fe]=[]),et[Fe].push(ze);var Re=Object.keys(et);for(Ae=0;Ae<Re.length;Ae++){var Ze=et[Fe=Re[Ae]],Ke=0,$e={};for(Se=0;Se<Ze.length;Se++)$e[(ze=Ze[Se]).label]||($e[ze.label]=0),$e[ze.label]+=ze.value,Ke+=ze.value;for(Se=0;Se<Ze.length;Se++)(ze=Ze[Se]).flow={value:Ke,labelConcentration:$e[ze.label]/Ke,concentration:ze.value/Ke,links:Ze},ze.concentrationscale&&(ze.color=p(ze.concentrationscale(ze.flow.labelConcentration)))}var rt=0;for(Ae=0;Ae<He.sourceLinks.length;Ae++)rt+=He.sourceLinks[Ae].value;for(Ae=0;Ae<He.sourceLinks.length;Ae++)(ze=He.sourceLinks[Ae]).concentrationOut=ze.value/rt;var at=0;for(Ae=0;Ae<He.targetLinks.length;Ae++)at+=He.targetLinks[Ae].value;for(Ae=0;Ae<He.targetLinks.length;Ae++)(ze=He.targetLinks[Ae]).concenrationIn=ze.value/at}}(),Q.node.x.length&&Q.node.y.length){for(we=0;we<Math.min(Q.node.x.length,Q.node.y.length,ke.nodes.length);we++)if(Q.node.x[we]&&Q.node.y[we]){var _e=[Q.node.x[we]*oe,Q.node.y[we]*de];ke.nodes[we].x0=_e[0]-ae/2,ke.nodes[we].x1=_e[0]+ae/2;var Pe=ke.nodes[we].y1-ke.nodes[we].y0;ke.nodes[we].y0=_e[1]-Pe/2,ke.nodes[we].y1=_e[1]+Pe/2}Q.arrangement==="snap"&&function(Fe){Fe.forEach(function(ze){var He,et,Re,Ze=0,Ke=ze.length;for(ze.sort(function($e,rt){return $e.y0-rt.y0}),Re=0;Re<Ke;++Re)(He=ze[Re]).y0>=Ze||(et=Ze-He.y0)>1e-6&&(He.y0+=et,He.y1+=et),Ze=He.y1+ie})}(function(Fe){var ze,He,et=Fe.map(function(rt,at){return{x0:rt.x0,index:at}}).sort(function(rt,at){return rt.x0-at.x0}),Re=[],Ze=-1,Ke=-1/0;for(we=0;we<et.length;we++){var $e=Fe[et[we].index];$e.x0>Ke+ae&&(Ze+=1,ze=$e.x0),Ke=$e.x0,Re[Ze]||(Re[Ze]=[]),Re[Ze].push($e),He=ze-$e.x0,$e.x0+=He,$e.x1+=He}return Re}(le=ke.nodes)),G.update(ke)}return{circular:ue,key:j,trace:Q,guid:u.randstr(),horizontal:ee,width:oe,height:de,nodePad:Q.node.pad,nodeLineColor:Q.node.line.color,nodeLineWidth:Q.node.line.width,linkLineColor:Q.link.line.color,linkLineWidth:Q.link.line.width,valueFormat:Q.valueformat,valueSuffix:Q.valuesuffix,textFont:Q.textfont,translateX:$.x[0]*F.width+F.margin.l,translateY:F.height-$.y[1]*F.height+F.margin.t,dragParallel:ee?de:oe,dragPerpendicular:ee?oe:de,arrangement:Q.arrangement,sankey:G,graph:ke,forceLayouts:{},interactionState:{dragInProgress:!1,hovered:!1}}}function v(F,H,j){var G=p(H.color),W=H.source.label+"|"+H.target.label+"__"+j;return H.trace=F.trace,H.curveNumber=F.trace.index,{circular:F.circular,key:W,traceId:F.key,pointNumber:H.pointNumber,link:H,tinyColorHue:l.tinyRGB(G),tinyColorAlpha:G.getAlpha(),linkPath:T,linkLineColor:F.linkLineColor,linkLineWidth:F.linkLineWidth,valueFormat:F.valueFormat,valueSuffix:F.valueSuffix,sankey:F.sankey,parent:F,interactionState:F.interactionState,flow:H.flow}}function T(){return function(F){if(F.link.circular)return H=F.link,j=H.width/2,G=H.circularPathData,H.circularLinkType==="top"?"M "+G.targetX+" "+(G.targetY+j)+" L"+G.rightInnerExtent+" "+(G.targetY+j)+"A"+(G.rightLargeArcRadius+j)+" "+(G.rightSmallArcRadius+j)+" 0 0 1 "+(G.rightFullExtent-j)+" "+(G.targetY-G.rightSmallArcRadius)+"L"+(G.rightFullExtent-j)+" "+G.verticalRightInnerExtent+"A"+(G.rightLargeArcRadius+j)+" "+(G.rightLargeArcRadius+j)+" 0 0 1 "+G.rightInnerExtent+" "+(G.verticalFullExtent-j)+"L"+G.leftInnerExtent+" "+(G.verticalFullExtent-j)+"A"+(G.leftLargeArcRadius+j)+" "+(G.leftLargeArcRadius+j)+" 0 0 1 "+(G.leftFullExtent+j)+" "+G.verticalLeftInnerExtent+"L"+(G.leftFullExtent+j)+" "+(G.sourceY-G.leftSmallArcRadius)+"A"+(G.leftLargeArcRadius+j)+" "+(G.leftSmallArcRadius+j)+" 0 0 1 "+G.leftInnerExtent+" "+(G.sourceY+j)+"L"+G.sourceX+" "+(G.sourceY+j)+"L"+G.sourceX+" "+(G.sourceY-j)+"L"+G.leftInnerExtent+" "+(G.sourceY-j)+"A"+(G.leftLargeArcRadius-j)+" "+(G.leftSmallArcRadius-j)+" 0 0 0 "+(G.leftFullExtent-j)+" "+(G.sourceY-G.leftSmallArcRadius)+"L"+(G.leftFullExtent-j)+" "+G.verticalLeftInnerExtent+"A"+(G.leftLargeArcRadius-j)+" "+(G.leftLargeArcRadius-j)+" 0 0 0 "+G.leftInnerExtent+" "+(G.verticalFullExtent+j)+"L"+G.rightInnerExtent+" "+(G.verticalFullExtent+j)+"A"+(G.rightLargeArcRadius-j)+" "+(G.rightLargeArcRadius-j)+" 0 0 0 "+(G.rightFullExtent+j)+" "+G.verticalRightInnerExtent+"L"+(G.rightFullExtent+j)+" "+(G.targetY-G.rightSmallArcRadius)+"A"+(G.rightLargeArcRadius-j)+" "+(G.rightSmallArcRadius-j)+" 0 0 0 "+G.rightInnerExtent+" "+(G.targetY-j)+"L"+G.targetX+" "+(G.targetY-j)+"Z":"M "+G.targetX+" "+(G.targetY-j)+" L"+G.rightInnerExtent+" "+(G.targetY-j)+"A"+(G.rightLargeArcRadius+j)+" "+(G.rightSmallArcRadius+j)+" 0 0 0 "+(G.rightFullExtent-j)+" "+(G.targetY+G.rightSmallArcRadius)+"L"+(G.rightFullExtent-j)+" "+G.verticalRightInnerExtent+"A"+(G.rightLargeArcRadius+j)+" "+(G.rightLargeArcRadius+j)+" 0 0 0 "+G.rightInnerExtent+" "+(G.verticalFullExtent+j)+"L"+G.leftInnerExtent+" "+(G.verticalFullExtent+j)+"A"+(G.leftLargeArcRadius+j)+" "+(G.leftLargeArcRadius+j)+" 0 0 0 "+(G.leftFullExtent+j)+" "+G.verticalLeftInnerExtent+"L"+(G.leftFullExtent+j)+" "+(G.sourceY+G.leftSmallArcRadius)+"A"+(G.leftLargeArcRadius+j)+" "+(G.leftSmallArcRadius+j)+" 0 0 0 "+G.leftInnerExtent+" "+(G.sourceY-j)+"L"+G.sourceX+" "+(G.sourceY-j)+"L"+G.sourceX+" "+(G.sourceY+j)+"L"+G.leftInnerExtent+" "+(G.sourceY+j)+"A"+(G.leftLargeArcRadius-j)+" "+(G.leftSmallArcRadius-j)+" 0 0 1 "+(G.leftFullExtent-j)+" "+(G.sourceY+G.leftSmallArcRadius)+"L"+(G.leftFullExtent-j)+" "+G.verticalLeftInnerExtent+"A"+(G.leftLargeArcRadius-j)+" "+(G.leftLargeArcRadius-j)+" 0 0 1 "+G.leftInnerExtent+" "+(G.verticalFullExtent-j)+"L"+G.rightInnerExtent+" "+(G.verticalFullExtent-j)+"A"+(G.rightLargeArcRadius-j)+" "+(G.rightLargeArcRadius-j)+" 0 0 1 "+(G.rightFullExtent+j)+" "+G.verticalRightInnerExtent+"L"+(G.rightFullExtent+j)+" "+(G.targetY+G.rightSmallArcRadius)+"A"+(G.rightLargeArcRadius-j)+" "+(G.rightSmallArcRadius-j)+" 0 0 1 "+G.rightInnerExtent+" "+(G.targetY+j)+"L"+G.targetX+" "+(G.targetY+j)+"Z";var H,j,G,W=F.link.source.x1,Q=F.link.target.x0,$=d(W,Q),ee=$(.5),ie=$(.5),ae=F.link.y0-F.link.width/2,oe=F.link.y0+F.link.width/2,de=F.link.y1-F.link.width/2,le=F.link.y1+F.link.width/2;return"M"+W+","+ae+"C"+ee+","+ae+" "+ie+","+de+" "+Q+","+de+"L"+Q+","+le+"C"+ie+","+le+" "+ee+","+oe+" "+W+","+oe+"Z"}}function w(F,H){var j=p(H.color),G=t.nodePadAcross,W=F.nodePad/2;H.dx=H.x1-H.x0,H.dy=H.y1-H.y0;var Q=H.dx,$=Math.max(.5,H.dy),ee="node_"+H.pointNumber;return H.group&&(ee=u.randstr()),H.trace=F.trace,H.curveNumber=F.trace.index,{index:H.pointNumber,key:ee,partOfGroup:H.partOfGroup||!1,group:H.group,traceId:F.key,trace:F.trace,node:H,nodePad:F.nodePad,nodeLineColor:F.nodeLineColor,nodeLineWidth:F.nodeLineWidth,textFont:F.textFont,size:F.horizontal?F.height:F.width,visibleWidth:Math.ceil(Q),visibleHeight:$,zoneX:-G,zoneY:-W,zoneWidth:Q+2*G,zoneHeight:$+2*W,labelY:F.horizontal?H.dy/2+1:H.dx/2+1,left:H.originalLayer===1,sizeAcross:F.width,forceLayouts:F.forceLayouts,horizontal:F.horizontal,darkBackground:j.getBrightness()<=128,tinyColorHue:l.tinyRGB(j),tinyColorAlpha:j.getAlpha(),valueFormat:F.valueFormat,valueSuffix:F.valueSuffix,sankey:F.sankey,graph:F.graph,arrangement:F.arrangement,uniqueNodeLabelPathId:[F.guid,F.key,ee].join("_"),interactionState:F.interactionState,figure:F}}function A(F){F.attr("transform",function(H){return s(H.node.x0.toFixed(3),H.node.y0.toFixed(3))})}function E(F){F.call(A)}function M(F,H){F.call(E),H.attr("d",T())}function b(F){F.attr("width",function(H){return H.node.x1-H.node.x0}).attr("height",function(H){return H.visibleHeight})}function _(F){return F.link.width>1||F.linkLineWidth>0}function S(F){return s(F.translateX,F.translateY)+(F.horizontal?"matrix(1 0 0 1 0 0)":"matrix(0 1 1 0 0 0)")}function C(F){return s(F.horizontal?0:F.labelY,F.horizontal?F.labelY:0)}function k(F){return h.svg.line()([[F.horizontal?F.left?-F.sizeAcross:F.visibleWidth+t.nodeTextOffsetHorizontal:t.nodeTextOffsetHorizontal,0],[F.horizontal?F.left?-t.nodeTextOffsetHorizontal:F.sizeAcross:F.visibleHeight-t.nodeTextOffsetHorizontal,0]])}function L(F){return F.horizontal?"matrix(1 0 0 1 0 0)":"matrix(0 1 1 0 0 0)"}function I(F){return F.horizontal?"scale(1 1)":"scale(-1 1)"}function R(F){return F.darkBackground&&!F.horizontal?"rgb(255,255,255)":"rgb(0,0,0)"}function V(F){return F.horizontal&&F.left?"100%":"0%"}function O(F,H,j){F.on(".basic",null).on("mouseover.basic",function(G){G.interactionState.dragInProgress||G.partOfGroup||(j.hover(this,G,H),G.interactionState.hovered=[this,G])}).on("mousemove.basic",function(G){G.interactionState.dragInProgress||G.partOfGroup||(j.follow(this,G),G.interactionState.hovered=[this,G])}).on("mouseout.basic",function(G){G.interactionState.dragInProgress||G.partOfGroup||(j.unhover(this,G,H),G.interactionState.hovered=!1)}).on("click.basic",function(G){G.interactionState.hovered&&(j.unhover(this,G,H),G.interactionState.hovered=!1),G.interactionState.dragInProgress||G.partOfGroup||j.select(this,G,H)})}function J(F,H,j,G){var W=h.behavior.drag().origin(function(Q){return{x:Q.node.x0+Q.visibleWidth/2,y:Q.node.y0+Q.visibleHeight/2}}).on("dragstart",function(Q){if(Q.arrangement!=="fixed"&&(u.ensureSingle(G._fullLayout._infolayer,"g","dragcover",function(ee){G._fullLayout._dragCover=ee}),u.raiseToTop(this),Q.interactionState.dragInProgress=Q.node,B(Q.node),Q.interactionState.hovered&&(j.nodeEvents.unhover.apply(0,Q.interactionState.hovered),Q.interactionState.hovered=!1),Q.arrangement==="snap")){var $=Q.traceId+"|"+Q.key;Q.forceLayouts[$]?Q.forceLayouts[$].alpha(1):function(ee,ie,ae,oe){(function(le){for(var fe=0;fe<le.length;fe++)le[fe].y=(le[fe].y0+le[fe].y1)/2,le[fe].x=(le[fe].x0+le[fe].x1)/2})(ae.graph.nodes);var de=ae.graph.nodes.filter(function(le){return le.originalX===ae.node.originalX}).filter(function(le){return!le.partOfGroup});ae.forceLayouts[ie]=i.forceSimulation(de).alphaDecay(0).force("collide",i.forceCollide().radius(function(le){return le.dy/2+ae.nodePad/2}).strength(1).iterations(t.forceIterations)).force("constrain",function(le,fe,ue,we){return function(){for(var Ae=0,Se=0;Se<ue.length;Se++){var ke=ue[Se];ke===we.interactionState.dragInProgress?(ke.x=ke.lastDraggedX,ke.y=ke.lastDraggedY):(ke.vx=(ke.originalX-ke.x)/t.forceTicksPerFrame,ke.y=Math.min(we.size-ke.dy/2,Math.max(ke.dy/2,ke.y))),Ae=Math.max(Ae,Math.abs(ke.vx),Math.abs(ke.vy))}!we.interactionState.dragInProgress&&Ae<.1&&we.forceLayouts[fe].alpha()>0&&we.forceLayouts[fe].alpha(0)}}(0,ie,de,ae)).stop()}(0,$,Q),function(ee,ie,ae,oe,de){window.requestAnimationFrame(function le(){var fe;for(fe=0;fe<t.forceTicksPerFrame;fe++)ae.forceLayouts[oe].tick();if(function(we){for(var Ae=0;Ae<we.length;Ae++)we[Ae].y0=we[Ae].y-we[Ae].dy/2,we[Ae].y1=we[Ae].y0+we[Ae].dy,we[Ae].x0=we[Ae].x-we[Ae].dx/2,we[Ae].x1=we[Ae].x0+we[Ae].dx}(ae.graph.nodes),ae.sankey.update(ae.graph),M(ee.filter(N(ae)),ie),ae.forceLayouts[oe].alpha()>0)window.requestAnimationFrame(le);else{var ue=ae.node.originalX;ae.node.x0=ue-ae.visibleWidth/2,ae.node.x1=ue+ae.visibleWidth/2,D(ae,de)}})}(F,H,Q,$,G)}}).on("drag",function(Q){if(Q.arrangement!=="fixed"){var $=h.event.x,ee=h.event.y;Q.arrangement==="snap"?(Q.node.x0=$-Q.visibleWidth/2,Q.node.x1=$+Q.visibleWidth/2,Q.node.y0=ee-Q.visibleHeight/2,Q.node.y1=ee+Q.visibleHeight/2):(Q.arrangement==="freeform"&&(Q.node.x0=$-Q.visibleWidth/2,Q.node.x1=$+Q.visibleWidth/2),ee=Math.max(0,Math.min(Q.size-Q.visibleHeight/2,ee)),Q.node.y0=ee-Q.visibleHeight/2,Q.node.y1=ee+Q.visibleHeight/2),B(Q.node),Q.arrangement!=="snap"&&(Q.sankey.update(Q.graph),M(F.filter(N(Q)),H))}}).on("dragend",function(Q){if(Q.arrangement!=="fixed"){Q.interactionState.dragInProgress=!1;for(var $=0;$<Q.node.childrenNodes.length;$++)Q.node.childrenNodes[$].x=Q.node.x,Q.node.childrenNodes[$].y=Q.node.y;Q.arrangement!=="snap"&&D(Q,G)}});F.on(".drag",null).call(W)}function D(F,H){for(var j=[],G=[],W=0;W<F.graph.nodes.length;W++){var Q=(F.graph.nodes[W].x0+F.graph.nodes[W].x1)/2,$=(F.graph.nodes[W].y0+F.graph.nodes[W].y1)/2;j.push(Q/F.figure.width),G.push($/F.figure.height)}m.call("_guiRestyle",H,{"node.x":[j],"node.y":[G]},F.trace.index).then(function(){H._fullLayout._dragCover&&H._fullLayout._dragCover.remove()})}function B(F){F.lastDraggedX=F.x0+F.dx/2,F.lastDraggedY=F.y0+F.dy/2}function N(F){return function(H){return H.node.originalX===F.node.originalX}}z.exports=function(F,H,j,G,W){var Q=!1;u.ensureSingle(F._fullLayout._infolayer,"g","first-render",function(){Q=!0});var $=F._fullLayout._dragCover,ee=j.filter(function(Me){return g(Me).trace.visible}).map(y.bind(null,G)),ie=H.selectAll("."+t.cn.sankey).data(ee,c);ie.exit().remove(),ie.enter().append("g").classed(t.cn.sankey,!0).style("box-sizing","content-box").style("position","absolute").style("left",0).style("shape-rendering","geometricPrecision").style("pointer-events","auto").attr("transform",S),ie.each(function(Me,ve){F._fullData[ve]._sankey=Me;var ge="bgsankey-"+Me.trace.uid+"-"+ve;u.ensureSingle(F._fullLayout._draggers,"rect",ge),F._fullData[ve]._bgRect=h.select("."+ge),F._fullData[ve]._bgRect.style("pointer-events","all").attr("width",Me.width).attr("height",Me.height).attr("x",Me.translateX).attr("y",Me.translateY).classed("bgsankey",!0).style({fill:"transparent","stroke-width":0})}),ie.transition().ease(t.ease).duration(t.duration).attr("transform",S);var ae=ie.selectAll("."+t.cn.sankeyLinks).data(f,c);ae.enter().append("g").classed(t.cn.sankeyLinks,!0).style("fill","none");var oe=ae.selectAll("."+t.cn.sankeyLink).data(function(Me){return Me.graph.links.filter(function(ve){return ve.value}).map(v.bind(null,Me))},c);oe.enter().append("path").classed(t.cn.sankeyLink,!0).call(O,ie,W.linkEvents),oe.style("stroke",function(Me){return _(Me)?l.tinyRGB(p(Me.linkLineColor)):Me.tinyColorHue}).style("stroke-opacity",function(Me){return _(Me)?l.opacity(Me.linkLineColor):Me.tinyColorAlpha}).style("fill",function(Me){return Me.tinyColorHue}).style("fill-opacity",function(Me){return Me.tinyColorAlpha}).style("stroke-width",function(Me){return _(Me)?Me.linkLineWidth:1}).attr("d",T()),oe.style("opacity",function(){return F._context.staticPlot||Q||$?1:0}).transition().ease(t.ease).duration(t.duration).style("opacity",1),oe.exit().transition().ease(t.ease).duration(t.duration).style("opacity",0).remove();var de=ie.selectAll("."+t.cn.sankeyNodeSet).data(f,c);de.enter().append("g").classed(t.cn.sankeyNodeSet,!0),de.style("cursor",function(Me){switch(Me.arrangement){case"fixed":return"default";case"perpendicular":return"ns-resize";default:return"move"}});var le=de.selectAll("."+t.cn.sankeyNode).data(function(Me){var ve=Me.graph.nodes;return function(ge){var De,_e=[];for(De=0;De<ge.length;De++)ge[De].originalX=(ge[De].x0+ge[De].x1)/2,ge[De].originalY=(ge[De].y0+ge[De].y1)/2,_e.indexOf(ge[De].originalX)===-1&&_e.push(ge[De].originalX);for(_e.sort(function(Pe,Fe){return Pe-Fe}),De=0;De<ge.length;De++)ge[De].originalLayerIndex=_e.indexOf(ge[De].originalX),ge[De].originalLayer=ge[De].originalLayerIndex/(_e.length-1)}(ve),ve.map(w.bind(null,Me))},c);le.enter().append("g").classed(t.cn.sankeyNode,!0).call(A).style("opacity",function(Me){return!F._context.staticPlot&&!Q||Me.partOfGroup?0:1}),le.call(O,ie,W.nodeEvents).call(J,oe,W,F),le.transition().ease(t.ease).duration(t.duration).call(A).style("opacity",function(Me){return Me.partOfGroup?0:1}),le.exit().transition().ease(t.ease).duration(t.duration).style("opacity",0).remove();var fe=le.selectAll("."+t.cn.nodeRect).data(f);fe.enter().append("rect").classed(t.cn.nodeRect,!0).call(b),fe.style("stroke-width",function(Me){return Me.nodeLineWidth}).style("stroke",function(Me){return l.tinyRGB(p(Me.nodeLineColor))}).style("stroke-opacity",function(Me){return l.opacity(Me.nodeLineColor)}).style("fill",function(Me){return Me.tinyColorHue}).style("fill-opacity",function(Me){return Me.tinyColorAlpha}),fe.transition().ease(t.ease).duration(t.duration).call(b);var ue=le.selectAll("."+t.cn.nodeCapture).data(f);ue.enter().append("rect").classed(t.cn.nodeCapture,!0).style("fill-opacity",0),ue.attr("x",function(Me){return Me.zoneX}).attr("y",function(Me){return Me.zoneY}).attr("width",function(Me){return Me.zoneWidth}).attr("height",function(Me){return Me.zoneHeight});var we=le.selectAll("."+t.cn.nodeCentered).data(f);we.enter().append("g").classed(t.cn.nodeCentered,!0).attr("transform",C),we.transition().ease(t.ease).duration(t.duration).attr("transform",C);var Ae=we.selectAll("."+t.cn.nodeLabelGuide).data(f);Ae.enter().append("path").classed(t.cn.nodeLabelGuide,!0).attr("id",function(Me){return Me.uniqueNodeLabelPathId}).attr("d",k).attr("transform",L),Ae.transition().ease(t.ease).duration(t.duration).attr("d",k).attr("transform",L);var Se=we.selectAll("."+t.cn.nodeLabel).data(f);Se.enter().append("text").classed(t.cn.nodeLabel,!0).attr("transform",I).style("cursor","default").style("fill","black"),Se.style("text-shadow",function(Me){return Me.horizontal?"-1px 1px 1px #fff, 1px 1px 1px #fff, 1px -1px 1px #fff, -1px -1px 1px #fff":"none"}).each(function(Me){e.font(Se,Me.textFont)}),Se.transition().ease(t.ease).duration(t.duration).attr("transform",I);var ke=Se.selectAll("."+t.cn.nodeLabelTextPath).data(f);ke.enter().append("textPath").classed(t.cn.nodeLabelTextPath,!0).attr("alignment-baseline","middle").attr("xlink:href",function(Me){return"#"+Me.uniqueNodeLabelPathId}).attr("startOffset",V).style("fill",R),ke.text(function(Me){return Me.horizontal||Me.node.dy>5?Me.node.label:""}).attr("text-anchor",function(Me){return Me.horizontal&&Me.left?"end":"start"}),ke.transition().ease(t.ease).duration(t.duration).attr("startOffset",V).style("fill",R)}},{"../../components/color":643,"../../components/drawing":665,"../../lib":778,"../../lib/gup":775,"../../registry":911,"./constants":1180,"@plotly/d3-sankey":56,"@plotly/d3-sankey-circular":55,d3:169,"d3-force":160,"d3-interpolate":162,tinycolor2:576}],1185:[function(n,z,q){"use strict";z.exports=function(t,h){for(var p=[],l=t.cd[0].trace,e=l._sankey.graph.nodes,o=0;o<e.length;o++){var r=e[o];if(!r.partOfGroup){var i=[(r.x0+r.x1)/2,(r.y0+r.y1)/2];l.orientation==="v"&&i.reverse(),h&&h.contains(i,!1,o,t)&&p.push({pointNumber:r.pointNumber})}}return p}},{}],1186:[function(n,z,q){"use strict";var t=n("../../lib");z.exports=function(h,p){for(var l=0;l<h.length;l++)h[l].i=l;t.mergeArray(p.text,h,"tx"),t.mergeArray(p.texttemplate,h,"txt"),t.mergeArray(p.hovertext,h,"htx"),t.mergeArray(p.customdata,h,"data"),t.mergeArray(p.textposition,h,"tp"),p.textfont&&(t.mergeArrayCastPositive(p.textfont.size,h,"ts"),t.mergeArray(p.textfont.color,h,"tc"),t.mergeArray(p.textfont.family,h,"tf"));var e=p.marker;if(e){t.mergeArrayCastPositive(e.size,h,"ms"),t.mergeArrayCastPositive(e.opacity,h,"mo"),t.mergeArray(e.symbol,h,"mx"),t.mergeArray(e.color,h,"mc");var o=e.line;e.line&&(t.mergeArray(o.color,h,"mlc"),t.mergeArrayCastPositive(o.width,h,"mlw"));var r=e.gradient;r&&r.type!=="none"&&(t.mergeArray(r.type,h,"mgt"),t.mergeArray(r.color,h,"mgc"))}}},{"../../lib":778}],1187:[function(n,z,q){"use strict";var t=n("../../plots/template_attributes").texttemplateAttrs,h=n("../../plots/template_attributes").hovertemplateAttrs,p=n("../../components/colorscale/attributes"),l=n("../../plots/font_attributes"),e=n("../../components/drawing/attributes").dash,o=n("../../components/drawing"),r=n("./constants"),i=n("../../lib/extend").extendFlat;z.exports={x:{valType:"data_array",editType:"calc+clearAxisTypes",anim:!0},x0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes",anim:!0},dx:{valType:"number",dflt:1,editType:"calc",anim:!0},y:{valType:"data_array",editType:"calc+clearAxisTypes",anim:!0},y0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes",anim:!0},dy:{valType:"number",dflt:1,editType:"calc",anim:!0},xperiod:{valType:"any",dflt:0,editType:"calc"},yperiod:{valType:"any",dflt:0,editType:"calc"},xperiod0:{valType:"any",editType:"calc"},yperiod0:{valType:"any",editType:"calc"},xperiodalignment:{valType:"enumerated",values:["start","middle","end"],dflt:"middle",editType:"calc"},yperiodalignment:{valType:"enumerated",values:["start","middle","end"],dflt:"middle",editType:"calc"},stackgroup:{valType:"string",dflt:"",editType:"calc"},orientation:{valType:"enumerated",values:["v","h"],editType:"calc"},groupnorm:{valType:"enumerated",values:["","fraction","percent"],dflt:"",editType:"calc"},stackgaps:{valType:"enumerated",values:["infer zero","interpolate"],dflt:"infer zero",editType:"calc"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},texttemplate:t({},{}),hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"style"},mode:{valType:"flaglist",flags:["lines","markers","text"],extras:["none"],editType:"calc"},hoveron:{valType:"flaglist",flags:["points","fills"],editType:"style"},hovertemplate:h({},{keys:r.eventDataKeys}),line:{color:{valType:"color",editType:"style",anim:!0},width:{valType:"number",min:0,dflt:2,editType:"style",anim:!0},shape:{valType:"enumerated",values:["linear","spline","hv","vh","hvh","vhv"],dflt:"linear",editType:"plot"},smoothing:{valType:"number",min:0,max:1.3,dflt:1,editType:"plot"},dash:i({},e,{editType:"style"}),simplify:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},connectgaps:{valType:"boolean",dflt:!1,editType:"calc"},cliponaxis:{valType:"boolean",dflt:!0,editType:"plot"},fill:{valType:"enumerated",values:["none","tozeroy","tozerox","tonexty","tonextx","toself","tonext"],editType:"calc"},fillcolor:{valType:"color",editType:"style",anim:!0},marker:i({symbol:{valType:"enumerated",values:o.symbolList,dflt:"circle",arrayOk:!0,editType:"style"},opacity:{valType:"number",min:0,max:1,arrayOk:!0,editType:"style",anim:!0},size:{valType:"number",min:0,dflt:6,arrayOk:!0,editType:"calc",anim:!0},maxdisplayed:{valType:"number",min:0,dflt:0,editType:"plot"},sizeref:{valType:"number",dflt:1,editType:"calc"},sizemin:{valType:"number",min:0,dflt:0,editType:"calc"},sizemode:{valType:"enumerated",values:["diameter","area"],dflt:"diameter",editType:"calc"},line:i({width:{valType:"number",min:0,arrayOk:!0,editType:"style",anim:!0},editType:"calc"},p("marker.line",{anim:!0})),gradient:{type:{valType:"enumerated",values:["radial","horizontal","vertical","none"],arrayOk:!0,dflt:"none",editType:"calc"},color:{valType:"color",arrayOk:!0,editType:"calc"},editType:"calc"},editType:"calc"},p("marker",{anim:!0})),selected:{marker:{opacity:{valType:"number",min:0,max:1,editType:"style"},color:{valType:"color",editType:"style"},size:{valType:"number",min:0,editType:"style"},editType:"style"},textfont:{color:{valType:"color",editType:"style"},editType:"style"},editType:"style"},unselected:{marker:{opacity:{valType:"number",min:0,max:1,editType:"style"},color:{valType:"color",editType:"style"},size:{valType:"number",min:0,editType:"style"},editType:"style"},textfont:{color:{valType:"color",editType:"style"},editType:"style"},editType:"style"},textposition:{valType:"enumerated",values:["top left","top center","top right","middle left","middle center","middle right","bottom left","bottom center","bottom right"],dflt:"middle center",arrayOk:!0,editType:"calc"},textfont:l({editType:"calc",colorEditType:"style",arrayOk:!0}),r:{valType:"data_array",editType:"calc"},t:{valType:"data_array",editType:"calc"}}},{"../../components/colorscale/attributes":650,"../../components/drawing":665,"../../components/drawing/attributes":664,"../../lib/extend":768,"../../plots/font_attributes":856,"../../plots/template_attributes":906,"./constants":1191}],1188:[function(n,z,q){"use strict";var t=n("fast-isnumeric"),h=n("../../lib"),p=n("../../plots/cartesian/axes"),l=n("../../plots/cartesian/align_period"),e=n("../../constants/numerical").BADNUM,o=n("./subtypes"),r=n("./colorscale_calc"),i=n("./arrays_to_calcdata"),u=n("./calc_selection");function s(d,m,y,v,T,w,A){var E=m._length,M=d._fullLayout,b=y._id,_=v._id,S=M._firstScatter[f(m)]===m.uid,C=(g(m,M,y,v)||{}).orientation,k=m.fill;y._minDtick=0,v._minDtick=0;var L={padded:!0},I={padded:!0};A&&(L.ppad=I.ppad=A);var R=E<2||T[0]!==T[E-1]||w[0]!==w[E-1];R&&(k==="tozerox"||k==="tonextx"&&(S||C==="h"))?L.tozero=!0:(m.error_y||{}).visible||k!=="tonexty"&&k!=="tozeroy"&&(o.hasMarkers(m)||o.hasText(m))||(L.padded=!1,L.ppad=0),R&&(k==="tozeroy"||k==="tonexty"&&(S||C==="v"))?I.tozero=!0:k!=="tonextx"&&k!=="tozerox"||(I.padded=!1),b&&(m._extremes[b]=p.findExtremes(y,T,L)),_&&(m._extremes[_]=p.findExtremes(v,w,I))}function a(d,m){if(o.hasMarkers(d)){var y,v=d.marker,T=1.6*(d.marker.sizeref||1);if(y=d.marker.sizemode==="area"?function(b){return Math.max(Math.sqrt((b||0)/T),3)}:function(b){return Math.max((b||0)/T,3)},h.isArrayOrTypedArray(v.size)){var w={type:"linear"};p.setConvert(w);for(var A=w.makeCalcdata(d.marker,"size"),E=new Array(m),M=0;M<m;M++)E[M]=y(A[M]);return E}return y(v.size)}}function c(d,m){var y=f(m),v=d._firstScatter;v[y]||(v[y]=m.uid)}function f(d){var m=d.stackgroup;return d.xaxis+d.yaxis+d.type+(m?"-"+m:"")}function g(d,m,y,v){var T=d.stackgroup;if(T){var w=m._scatterStackOpts[y._id+v._id][T],A=w.orientation==="v"?v:y;return A.type==="linear"||A.type==="log"?w:void 0}}z.exports={calc:function(d,m){var y,v,T,w,A,E,M=d._fullLayout,b=p.getFromId(d,m.xaxis||"x"),_=p.getFromId(d,m.yaxis||"y"),S=b.makeCalcdata(m,"x"),C=_.makeCalcdata(m,"y"),k=l(m,b,"x",S),L=l(m,_,"y",C),I=m._length,R=new Array(I),V=m.ids,O=g(m,M,b,_),J=!1;c(M,m);var D,B="x",N="y";O?(h.pushUnique(O.traceIndices,m._expandedIndex),(y=O.orientation==="v")?(N="s",D="x"):(B="s",D="y"),A=O.stackgaps==="interpolate"):s(d,m,b,_,k,L,a(m,I));var F=!!m.xperiodalignment,H=!!m.yperiodalignment;for(v=0;v<I;v++){var j=R[v]={},G=t(k[v]),W=t(L[v]);G&&W?(j[B]=k[v],j[N]=L[v],F&&(j.orig_x=S[v]),H&&(j.orig_y=C[v])):O&&(y?G:W)?(j[D]=y?k[v]:L[v],j.gap=!0,A?(j.s=e,J=!0):j.s=0):j[B]=j[N]=e,V&&(j.id=String(V[v]))}if(i(R,m),r(d,m),u(R,m),O){for(v=0;v<R.length;)R[v][D]===e?R.splice(v,1):v++;if(h.sort(R,function(ie,ae){return ie[D]-ae[D]||ie.i-ae.i}),J){for(v=0;v<R.length-1&&R[v].gap;)v++;for((E=R[v].s)||(E=R[v].s=0),T=0;T<v;T++)R[T].s=E;for(w=R.length-1;w>v&&R[w].gap;)w--;for(E=R[w].s,T=R.length-1;T>w;T--)R[T].s=E;for(;v<w;)if(R[++v].gap){for(T=v+1;R[T].gap;)T++;for(var Q=R[v-1][D],$=R[v-1].s,ee=(R[T].s-$)/(R[T][D]-Q);v<T;)R[v].s=$+(R[v][D]-Q)*ee,v++}}}return R},calcMarkerSize:a,calcAxisExpansion:s,setFirstScatter:c,getStackOpts:g}},{"../../constants/numerical":753,"../../lib":778,"../../plots/cartesian/align_period":825,"../../plots/cartesian/axes":828,"./arrays_to_calcdata":1186,"./calc_selection":1189,"./colorscale_calc":1190,"./subtypes":1212,"fast-isnumeric":241}],1189:[function(n,z,q){"use strict";var t=n("../../lib");z.exports=function(h,p){t.isArrayOrTypedArray(p.selectedpoints)&&t.tagSelected(h,p)}},{"../../lib":778}],1190:[function(n,z,q){"use strict";var t=n("../../components/colorscale/helpers").hasColorscale,h=n("../../components/colorscale/calc"),p=n("./subtypes");z.exports=function(l,e){p.hasLines(e)&&t(e,"line")&&h(l,e,{vals:e.line.color,containerStr:"line",cLetter:"c"}),p.hasMarkers(e)&&(t(e,"marker")&&h(l,e,{vals:e.marker.color,containerStr:"marker",cLetter:"c"}),t(e,"marker.line")&&h(l,e,{vals:e.marker.line.color,containerStr:"marker.line",cLetter:"c"}))}},{"../../components/colorscale/calc":651,"../../components/colorscale/helpers":654,"./subtypes":1212}],1191:[function(n,z,q){"use strict";z.exports={PTS_LINESONLY:20,minTolerance:.2,toleranceGrowth:10,maxScreensAway:20,eventDataKeys:[]}},{}],1192:[function(n,z,q){"use strict";var t=n("./calc");function h(p,l,e,o,r,i,u){r[o]=!0;var s={i:null,gap:!0,s:0};if(s[u]=e,p.splice(l,0,s),l&&e===p[l-1][u]){var a=p[l-1];s.s=a.s,s.i=a.i,s.gap=a.gap}else i&&(s.s=function(c,f,g,d){var m=c[f-1],y=c[f+1];return y?m?m.s+(y.s-m.s)*(g-m[d])/(y[d]-m[d]):y.s:m.s}(p,l,e,u));l||(p[0].t=p[1].t,p[0].trace=p[1].trace,delete p[1].t,delete p[1].trace)}z.exports=function(p,l){var e=l.xaxis,o=l.yaxis,r=e._id+o._id,i=p._fullLayout._scatterStackOpts[r];if(i){var u,s,a,c,f,g,d,m,y,v,T,w,A,E,M,b=p.calcdata;for(var _ in i){var S=(v=i[_]).traceIndices;if(S.length){for(T=v.stackgaps==="interpolate",w=v.groupnorm,v.orientation==="v"?(A="x",E="y"):(A="y",E="x"),M=new Array(S.length),u=0;u<M.length;u++)M[u]=!1;g=b[S[0]];var C=new Array(g.length);for(u=0;u<g.length;u++)C[u]=g[u][A];for(u=1;u<S.length;u++){for(f=b[S[u]],s=a=0;s<f.length;s++){for(d=f[s][A];d>C[a]&&a<C.length;a++)h(f,s,C[a],u,M,T,A),s++;if(d!==C[a]){for(c=0;c<u;c++)h(b[S[c]],a,d,c,M,T,A);C.splice(a,0,d)}a++}for(;a<C.length;a++)h(f,s,C[a],u,M,T,A),s++}var k=C.length;for(s=0;s<g.length;s++){for(m=g[s][E]=g[s].s,u=1;u<S.length;u++)(f=b[S[u]])[0].trace._rawLength=f[0].trace._length,f[0].trace._length=k,m+=f[s].s,f[s][E]=m;if(w)for(y=(w==="fraction"?m:m/100)||1,u=0;u<S.length;u++){var L=b[S[u]][s];L[E]/=y,L.sNorm=L.s/y}}for(u=0;u<S.length;u++){var I=(f=b[S[u]])[0].trace,R=t.calcMarkerSize(I,I._rawLength),V=Array.isArray(R);if(R&&M[u]||V){var O=R;for(R=new Array(k),s=0;s<k;s++)R[s]=f[s].gap?0:V?O[f[s].i]:O}var J=new Array(k),D=new Array(k);for(s=0;s<k;s++)J[s]=f[s].x,D[s]=f[s].y;t.calcAxisExpansion(p,I,e,o,J,D,R),f[0].t.orientation=v.orientation}}}}}},{"./calc":1188}],1193:[function(n,z,q){"use strict";z.exports=function(t){for(var h=0;h<t.length;h++){var p=t[h];if(p.type==="scatter"){var l=p.fill;if(l!=="none"&&l!=="toself"&&(p.opacity=void 0,l==="tonexty"||l==="tonextx"))for(var e=h-1;e>=0;e--){var o=t[e];if(o.type==="scatter"&&o.xaxis===p.xaxis&&o.yaxis===p.yaxis){o.opacity=void 0;break}}}}}},{}],1194:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../../registry"),p=n("./attributes"),l=n("./constants"),e=n("./subtypes"),o=n("./xy_defaults"),r=n("./period_defaults"),i=n("./stack_defaults"),u=n("./marker_defaults"),s=n("./line_defaults"),a=n("./line_shape_defaults"),c=n("./text_defaults"),f=n("./fillcolor_defaults");z.exports=function(g,d,m,y){function v(S,C){return t.coerce(g,d,p,S,C)}var T=o(g,d,y,v);if(T||(d.visible=!1),d.visible){r(g,d,y,v);var w=i(g,d,y,v),A=!w&&T<l.PTS_LINESONLY?"lines+markers":"lines";v("text"),v("hovertext"),v("mode",A),e.hasLines(d)&&(s(g,d,m,y,v),a(g,d,v),v("connectgaps"),v("line.simplify")),e.hasMarkers(d)&&u(g,d,m,y,v,{gradient:!0}),e.hasText(d)&&(v("texttemplate"),c(g,d,y,v));var E=[];(e.hasMarkers(d)||e.hasText(d))&&(v("cliponaxis"),v("marker.maxdisplayed"),E.push("points")),v("fill",w?w.fillDflt:"none"),d.fill!=="none"&&(f(g,d,m,v),e.hasLines(d)||a(g,d,v));var M=(d.line||{}).color,b=(d.marker||{}).color;d.fill!=="tonext"&&d.fill!=="toself"||E.push("fills"),v("hoveron",E.join("+")||"points"),d.hoveron!=="fills"&&v("hovertemplate");var _=h.getComponentMethod("errorbars","supplyDefaults");_(g,d,M||b||m,{axis:"y"}),_(g,d,M||b||m,{axis:"x",inherit:"y"}),t.coerceSelectionMarkerOpacity(d,v)}}},{"../../lib":778,"../../registry":911,"./attributes":1187,"./constants":1191,"./fillcolor_defaults":1195,"./line_defaults":1200,"./line_shape_defaults":1202,"./marker_defaults":1206,"./period_defaults":1207,"./stack_defaults":1210,"./subtypes":1212,"./text_defaults":1213,"./xy_defaults":1214}],1195:[function(n,z,q){"use strict";var t=n("../../components/color"),h=n("../../lib").isArrayOrTypedArray;z.exports=function(p,l,e,o){var r=!1;if(l.marker){var i=l.marker.color,u=(l.marker.line||{}).color;i&&!h(i)?r=i:u&&!h(u)&&(r=u)}o("fillcolor",t.addOpacity((l.line||{}).color||r||e,.5))}},{"../../components/color":643,"../../lib":778}],1196:[function(n,z,q){"use strict";var t=n("../../plots/cartesian/axes");z.exports=function(h,p,l){var e={},o={_fullLayout:l},r=t.getFromTrace(o,p,"x"),i=t.getFromTrace(o,p,"y");return e.xLabel=t.tickText(r,h.x,!0).text,e.yLabel=t.tickText(i,h.y,!0).text,e}},{"../../plots/cartesian/axes":828}],1197:[function(n,z,q){"use strict";var t=n("../../components/color"),h=n("./subtypes");z.exports=function(p,l){var e,o;if(p.mode==="lines")return(e=p.line.color)&&t.opacity(e)?e:p.fillcolor;if(p.mode==="none")return p.fill?p.fillcolor:"";var r=l.mcc||(p.marker||{}).color,i=l.mlcc||((p.marker||{}).line||{}).color;return(o=r&&t.opacity(r)?r:i&&t.opacity(i)&&(l.mlw||((p.marker||{}).line||{}).width)?i:"")?t.opacity(o)<.3?t.addOpacity(o,.3):o:(e=(p.line||{}).color)&&t.opacity(e)&&h.hasLines(p)&&p.line.width?e:p.fillcolor}},{"../../components/color":643,"./subtypes":1212}],1198:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../../components/fx"),p=n("../../registry"),l=n("./get_trace_color"),e=n("../../components/color"),o=t.fillText;z.exports=function(r,i,u,s){var a=r.cd,c=a[0].trace,f=r.xa,g=r.ya,d=f.c2p(i),m=g.c2p(u),y=[d,m],v=c.hoveron||"",T=c.mode.indexOf("markers")!==-1?3:.5;if(v.indexOf("points")!==-1){var w=function(oe){var de=Math.max(T,oe.mrc||0),le=f.c2p(oe.x)-d,fe=g.c2p(oe.y)-m;return Math.max(Math.sqrt(le*le+fe*fe)-de,1-T/de)},A=h.getDistanceFunction(s,function(oe){var de=Math.max(3,oe.mrc||0),le=1-1/de,fe=Math.abs(f.c2p(oe.x)-d);return fe<de?le*fe/de:fe-de+le},function(oe){var de=Math.max(3,oe.mrc||0),le=1-1/de,fe=Math.abs(g.c2p(oe.y)-m);return fe<de?le*fe/de:fe-de+le},w);if(h.getClosest(a,A,r),r.index!==!1){var E=a[r.index],M=f.c2p(E.x,!0),b=g.c2p(E.y,!0),_=E.mrc||1;r.index=E.i;var S=a[0].t.orientation,C=S&&(E.sNorm||E.s),k=S==="h"?C:E.orig_x!==void 0?E.orig_x:E.x,L=S==="v"?C:E.orig_y!==void 0?E.orig_y:E.y;return t.extendFlat(r,{color:l(c,E),x0:M-_,x1:M+_,xLabelVal:k,y0:b-_,y1:b+_,yLabelVal:L,spikeDistance:w(E),hovertemplate:c.hovertemplate}),o(E,c,r),p.getComponentMethod("errorbars","hoverInfo")(E,c,r),[r]}}if(v.indexOf("fills")!==-1&&c._polygons){var I,R,V,O,J,D,B,N,F,H=c._polygons,j=[],G=!1,W=1/0,Q=-1/0,$=1/0,ee=-1/0;for(I=0;I<H.length;I++)(V=H[I]).contains(y)&&(G=!G,j.push(V),$=Math.min($,V.ymin),ee=Math.max(ee,V.ymax));if(G){var ie=(($=Math.max($,0))+(ee=Math.min(ee,g._length)))/2;for(I=0;I<j.length;I++)for(O=j[I].pts,R=1;R<O.length;R++)(N=O[R-1][1])>ie!=(F=O[R][1])>=ie&&(D=O[R-1][0],B=O[R][0],F-N&&(J=D+(B-D)*(ie-N)/(F-N),W=Math.min(W,J),Q=Math.max(Q,J)));W=Math.max(W,0),Q=Math.min(Q,f._length);var ae=e.defaultLine;return e.opacity(c.fillcolor)?ae=c.fillcolor:e.opacity((c.line||{}).color)&&(ae=c.line.color),t.extendFlat(r,{distance:r.maxHoverDistance,x0:W,x1:Q,y0:ie,y1:ie,color:ae,hovertemplate:!1}),delete r.index,c.text&&!Array.isArray(c.text)?r.text=String(c.text):r.text=c.name,[r]}}}},{"../../components/color":643,"../../components/fx":683,"../../lib":778,"../../registry":911,"./get_trace_color":1197}],1199:[function(n,z,q){"use strict";var t=n("./subtypes");z.exports={hasLines:t.hasLines,hasMarkers:t.hasMarkers,hasText:t.hasText,isBubble:t.isBubble,attributes:n("./attributes"),supplyDefaults:n("./defaults"),crossTraceDefaults:n("./cross_trace_defaults"),calc:n("./calc").calc,crossTraceCalc:n("./cross_trace_calc"),arraysToCalcdata:n("./arrays_to_calcdata"),plot:n("./plot"),colorbar:n("./marker_colorbar"),formatLabels:n("./format_labels"),style:n("./style").style,styleOnSelect:n("./style").styleOnSelect,hoverPoints:n("./hover"),selectPoints:n("./select"),animatable:!0,moduleType:"trace",name:"scatter",basePlotModule:n("../../plots/cartesian"),categories:["cartesian","svg","symbols","errorBarsOK","showLegend","scatter-like","zoomScale"],meta:{}}},{"../../plots/cartesian":841,"./arrays_to_calcdata":1186,"./attributes":1187,"./calc":1188,"./cross_trace_calc":1192,"./cross_trace_defaults":1193,"./defaults":1194,"./format_labels":1196,"./hover":1198,"./marker_colorbar":1205,"./plot":1208,"./select":1209,"./style":1211,"./subtypes":1212}],1200:[function(n,z,q){"use strict";var t=n("../../lib").isArrayOrTypedArray,h=n("../../components/colorscale/helpers").hasColorscale,p=n("../../components/colorscale/defaults");z.exports=function(l,e,o,r,i,u){var s=(l.marker||{}).color;i("line.color",o),h(l,"line")?p(l,e,r,i,{prefix:"line.",cLetter:"c"}):i("line.color",!t(s)&&s||o),i("line.width"),(u||{}).noDash||i("line.dash")}},{"../../components/colorscale/defaults":653,"../../components/colorscale/helpers":654,"../../lib":778}],1201:[function(n,z,q){"use strict";var t=n("../../constants/numerical"),h=t.BADNUM,p=t.LOG_CLIP,l=p+.5,e=p-.5,o=n("../../lib"),r=o.segmentsIntersect,i=o.constrain,u=n("./constants");z.exports=function(s,a){var c,f,g,d,m,y,v,T,w,A,E,M,b,_,S,C,k,L,I=a.xaxis,R=a.yaxis,V=I.type==="log",O=R.type==="log",J=I._length,D=R._length,B=a.connectGaps,N=a.baseTolerance,F=a.shape,H=F==="linear",j=a.fill&&a.fill!=="none",G=[],W=u.minTolerance,Q=s.length,$=new Array(Q),ee=0;function ie($e){var rt=s[$e];if(!rt)return!1;var at=a.linearized?I.l2p(rt.x):I.c2p(rt.x),lt=a.linearized?R.l2p(rt.y):R.c2p(rt.y);if(at===h){if(V&&(at=I.c2p(rt.x,!0)),at===h)return!1;O&&lt===h&&(at*=Math.abs(I._m*D*(I._m>0?l:e)/(R._m*J*(R._m>0?l:e)))),at*=1e3}if(lt===h){if(O&&(lt=R.c2p(rt.y,!0)),lt===h)return!1;lt*=1e3}return[at,lt]}function ae($e,rt,at,lt){var gt=at-$e,Ie=lt-rt,be=.5-$e,We=.5-rt,Ge=gt*gt+Ie*Ie,st=gt*be+Ie*We;if(st>0&&st<Ge){var ot=be*Ie-We*gt;if(ot*ot<Ge)return!0}}function oe($e,rt){var at=$e[0]/J,lt=$e[1]/D,gt=Math.max(0,-at,at-1,-lt,lt-1);return gt&&k!==void 0&&ae(at,lt,k,L)&&(gt=0),gt&&rt&&ae(at,lt,rt[0]/J,rt[1]/D)&&(gt=0),(1+u.toleranceGrowth*gt)*N}function de($e,rt){var at=$e[0]-rt[0],lt=$e[1]-rt[1];return Math.sqrt(at*at+lt*lt)}var le,fe,ue,we,Ae,Se,ke,Me=u.maxScreensAway,ve=-J*Me,ge=J*(1+Me),De=-D*Me,_e=D*(1+Me),Pe=[[ve,De,ge,De],[ge,De,ge,_e],[ge,_e,ve,_e],[ve,_e,ve,De]];function Fe($e){if($e[0]<ve||$e[0]>ge||$e[1]<De||$e[1]>_e)return[i($e[0],ve,ge),i($e[1],De,_e)]}function ze($e,rt){return $e[0]===rt[0]&&($e[0]===ve||$e[0]===ge)||$e[1]===rt[1]&&($e[1]===De||$e[1]===_e)||void 0}function He($e,rt,at){return function(lt,gt){var Ie=Fe(lt),be=Fe(gt),We=[];if(Ie&&be&&ze(Ie,be))return We;Ie&&We.push(Ie),be&&We.push(be);var Ge=2*o.constrain((lt[$e]+gt[$e])/2,rt,at)-((Ie||lt)[$e]+(be||gt)[$e]);return Ge&&((Ie&&be?Ge>0==Ie[$e]>be[$e]?Ie:be:Ie||be)[$e]+=Ge),We}}function et($e){var rt=$e[0],at=$e[1],lt=rt===$[ee-1][0],gt=at===$[ee-1][1];if(!lt||!gt)if(ee>1){var Ie=rt===$[ee-2][0],be=at===$[ee-2][1];lt&&(rt===ve||rt===ge)&&Ie?be?ee--:$[ee-1]=$e:gt&&(at===De||at===_e)&&be?Ie?ee--:$[ee-1]=$e:$[ee++]=$e}else $[ee++]=$e}function Re($e){$[ee-1][0]!==$e[0]&&$[ee-1][1]!==$e[1]&&et([ue,we]),et($e),Ae=null,ue=we=0}function Ze($e){if(k=$e[0]/J,L=$e[1]/D,le=$e[0]<ve?ve:$e[0]>ge?ge:0,fe=$e[1]<De?De:$e[1]>_e?_e:0,le||fe){if(ee)if(Ae){var rt=ke(Ae,$e);rt.length>1&&(Re(rt[0]),$[ee++]=rt[1])}else Se=ke($[ee-1],$e)[0],$[ee++]=Se;else $[ee++]=[le||$e[0],fe||$e[1]];var at=$[ee-1];le&&fe&&(at[0]!==le||at[1]!==fe)?(Ae&&(ue!==le&&we!==fe?et(ue&&we?(lt=Ae,Ie=(gt=$e)[0]-lt[0],be=(gt[1]-lt[1])/Ie,(lt[1]*gt[0]-gt[1]*lt[0])/Ie>0?[be>0?ve:ge,_e]:[be>0?ge:ve,De]):[ue||le,we||fe]):ue&&we&&et([ue,we])),et([le,fe])):ue-le&&we-fe&&et([le||ue,fe||we]),Ae=$e,ue=le,we=fe}else Ae&&Re(ke(Ae,$e)[0]),$[ee++]=$e;var lt,gt,Ie,be}for(F==="linear"||F==="spline"?ke=function($e,rt){for(var at=[],lt=0,gt=0;gt<4;gt++){var Ie=Pe[gt],be=r($e[0],$e[1],rt[0],rt[1],Ie[0],Ie[1],Ie[2],Ie[3]);be&&(!lt||Math.abs(be.x-at[0][0])>1||Math.abs(be.y-at[0][1])>1)&&(be=[be.x,be.y],lt&&de(be,$e)<de(at[0],$e)?at.unshift(be):at.push(be),lt++)}return at}:F==="hv"||F==="vh"?ke=function($e,rt){var at=[],lt=Fe($e),gt=Fe(rt);return lt&&gt&&ze(lt,gt)||(lt&&at.push(lt),gt&&at.push(gt)),at}:F==="hvh"?ke=He(0,ve,ge):F==="vhv"&&(ke=He(1,De,_e)),c=0;c<Q;c++)if(f=ie(c)){for(ee=0,Ae=null,Ze(f),c++;c<Q;c++){if(!(d=ie(c))){if(B)continue;break}if(H&&a.simplify){var Ke=ie(c+1);if(A=de(d,f),j&&(ee===0||ee===Q-1)||!(A<oe(d,Ke)*W)){for(T=[(d[0]-f[0])/A,(d[1]-f[1])/A],m=f,E=A,M=_=S=0,v=!1,g=d,c++;c<s.length;c++){if(y=Ke,Ke=ie(c+1),!y){if(B)continue;break}if(C=(w=[y[0]-f[0],y[1]-f[1]])[0]*T[1]-w[1]*T[0],_=Math.min(_,C),(S=Math.max(S,C))-_>oe(y,Ke))break;g=y,(b=w[0]*T[0]+w[1]*T[1])>E?(E=b,d=y,v=!1):b<M&&(M=b,m=y,v=!0)}if(v?(Ze(d),g!==m&&Ze(m)):(m!==f&&Ze(m),g!==d&&Ze(d)),Ze(g),c>=s.length||!y)break;Ze(y),f=y}}else Ze(d)}Ae&&et([ue||Ae[0],we||Ae[1]]),G.push($.slice(0,ee))}return G}},{"../../constants/numerical":753,"../../lib":778,"./constants":1191}],1202:[function(n,z,q){"use strict";z.exports=function(t,h,p){p("line.shape")==="spline"&&p("line.smoothing")}},{}],1203:[function(n,z,q){"use strict";var t={tonextx:1,tonexty:1,tonext:1};z.exports=function(h,p,l){var e,o,r,i,u,s={},a=!1,c=-1,f=0,g=-1;for(o=0;o<l.length;o++)(r=(e=l[o][0].trace).stackgroup||"")?r in s?u=s[r]:(u=s[r]=f,f++):e.fill in t&&g>=0?u=g:(u=g=f,f++),u<c&&(a=!0),e._groupIndex=c=u;var d=l.slice();a&&d.sort(function(y,v){var T=y[0].trace,w=v[0].trace;return T._groupIndex-w._groupIndex||T.index-w.index});var m={};for(o=0;o<d.length;o++)r=(e=d[o][0].trace).stackgroup||"",e.visible===!0?(e._nexttrace=null,e.fill in t&&(i=m[r],e._prevtrace=i||null,i&&(i._nexttrace=e)),e._ownfill=e.fill&&(e.fill.substr(0,6)==="tozero"||e.fill==="toself"||e.fill.substr(0,2)==="to"&&!e._prevtrace),m[r]=e):e._prevtrace=e._nexttrace=e._ownfill=null;return d}},{}],1204:[function(n,z,q){"use strict";var t=n("fast-isnumeric");z.exports=function(h){var p=h.marker,l=p.sizeref||1,e=p.sizemin||0,o=p.sizemode==="area"?function(r){return Math.sqrt(r/l)}:function(r){return r/l};return function(r){var i=o(r/2);return t(i)&&i>0?Math.max(i,e):0}}},{"fast-isnumeric":241}],1205:[function(n,z,q){"use strict";z.exports={container:"marker",min:"cmin",max:"cmax"}},{}],1206:[function(n,z,q){"use strict";var t=n("../../components/color"),h=n("../../components/colorscale/helpers").hasColorscale,p=n("../../components/colorscale/defaults"),l=n("./subtypes");z.exports=function(e,o,r,i,u,s){var a=l.isBubble(e),c=(e.line||{}).color;s=s||{},c&&(r=c),u("marker.symbol"),u("marker.opacity",a?.7:1),u("marker.size"),u("marker.color",r),h(e,"marker")&&p(e,o,i,u,{prefix:"marker.",cLetter:"c"}),s.noSelect||(u("selected.marker.color"),u("unselected.marker.color"),u("selected.marker.size"),u("unselected.marker.size")),s.noLine||(u("marker.line.color",c&&!Array.isArray(c)&&o.marker.color!==c?c:a?t.background:t.defaultLine),h(e,"marker.line")&&p(e,o,i,u,{prefix:"marker.line.",cLetter:"c"}),u("marker.line.width",a?1:0)),a&&(u("marker.sizeref"),u("marker.sizemin"),u("marker.sizemode")),s.gradient&&u("marker.gradient.type")!=="none"&&u("marker.gradient.color")}},{"../../components/color":643,"../../components/colorscale/defaults":653,"../../components/colorscale/helpers":654,"./subtypes":1212}],1207:[function(n,z,q){"use strict";var t=n("../../lib").dateTick0,h=n("../../constants/numerical").ONEWEEK;function p(l,e){return t(e,l%h==0?1:0)}z.exports=function(l,e,o,r,i){if(i||(i={x:!0,y:!0}),i.x){var u=r("xperiod");u&&(r("xperiod0",p(u,e.xcalendar)),r("xperiodalignment"))}if(i.y){var s=r("yperiod");s&&(r("yperiod0",p(s,e.ycalendar)),r("yperiodalignment"))}}},{"../../constants/numerical":753,"../../lib":778}],1208:[function(n,z,q){"use strict";var t=n("d3"),h=n("../../registry"),p=n("../../lib"),l=p.ensureSingle,e=p.identity,o=n("../../components/drawing"),r=n("./subtypes"),i=n("./line_points"),u=n("./link_traces"),s=n("../../lib/polygon").tester;function a(c,f,g,d,m,y,v){var T;(function(ge,De,_e,Pe,Fe){var ze=_e.xaxis,He=_e.yaxis,et=t.extent(p.simpleMap(ze.range,ze.r2c)),Re=t.extent(p.simpleMap(He.range,He.r2c)),Ze=Pe[0].trace;if(r.hasMarkers(Ze)){var Ke=Ze.marker.maxdisplayed;if(Ke!==0){var $e=Pe.filter(function(gt){return gt.x>=et[0]&&gt.x<=et[1]&&gt.y>=Re[0]&&gt.y<=Re[1]}),rt=Math.ceil($e.length/Ke),at=0;Fe.forEach(function(gt,Ie){var be=gt[0].trace;r.hasMarkers(be)&&be.marker.maxdisplayed>0&&Ie<De&&at++});var lt=Math.round(at*rt/3+Math.floor(at/3)*rt/7.1);Pe.forEach(function(gt){delete gt.vis}),$e.forEach(function(gt,Ie){Math.round((Ie+lt)%rt)===0&&(gt.vis=!0)})}}})(0,f,g,d,m);var w=!!v&&v.duration>0;function A(ge){return w?ge.transition():ge}var E=g.xaxis,M=g.yaxis,b=d[0].trace,_=b.line,S=t.select(y),C=l(S,"g","errorbars"),k=l(S,"g","lines"),L=l(S,"g","points"),I=l(S,"g","text");if(h.getComponentMethod("errorbars","plot")(c,C,g,v),b.visible===!0){var R,V;A(S).style("opacity",b.opacity);var O=b.fill.charAt(b.fill.length-1);O!=="x"&&O!=="y"&&(O=""),d[0][g.isRangePlot?"nodeRangePlot3":"node3"]=S;var J,D,B="",N=[],F=b._prevtrace;F&&(B=F._prevRevpath||"",V=F._nextFill,N=F._polygons);var H,j,G,W,Q,$,ee,ie="",ae="",oe=[],de=p.noop;if(R=b._ownFill,r.hasLines(b)||b.fill!=="none"){for(V&&V.datum(d),["hv","vh","hvh","vhv"].indexOf(_.shape)!==-1?(H=o.steps(_.shape),j=o.steps(_.shape.split("").reverse().join(""))):H=j=_.shape==="spline"?function(ge){var De=ge[ge.length-1];return ge.length>1&&ge[0][0]===De[0]&&ge[0][1]===De[1]?o.smoothclosed(ge.slice(1),_.smoothing):o.smoothopen(ge,_.smoothing)}:function(ge){return"M"+ge.join("L")},G=function(ge){return j(ge.reverse())},oe=i(d,{xaxis:E,yaxis:M,connectGaps:b.connectgaps,baseTolerance:Math.max(_.width||1,3)/4,shape:_.shape,simplify:_.simplify,fill:b.fill}),ee=b._polygons=new Array(oe.length),T=0;T<oe.length;T++)b._polygons[T]=s(oe[T]);oe.length&&(W=oe[0][0],$=(Q=oe[oe.length-1])[Q.length-1]),de=function(ge){return function(De){if(J=H(De),D=G(De),ie?O?(ie+="L"+J.substr(1),ae=D+"L"+ae.substr(1)):(ie+="Z"+J,ae=D+"Z"+ae):(ie=J,ae=D),r.hasLines(b)&&De.length>1){var _e=t.select(this);if(_e.datum(d),ge)A(_e.style("opacity",0).attr("d",J).call(o.lineGroupStyle)).style("opacity",1);else{var Pe=A(_e);Pe.attr("d",J),o.singleLineStyle(d,Pe)}}}}}var le=k.selectAll(".js-line").data(oe);A(le.exit()).style("opacity",0).remove(),le.each(de(!1)),le.enter().append("path").classed("js-line",!0).style("vector-effect","non-scaling-stroke").call(o.lineGroupStyle).each(de(!0)),o.setClipUrl(le,g.layerClipId,c),oe.length?(R?(R.datum(d),W&&$&&(O?(O==="y"?W[1]=$[1]=M.c2p(0,!0):O==="x"&&(W[0]=$[0]=E.c2p(0,!0)),A(R).attr("d","M"+$+"L"+W+"L"+ie.substr(1)).call(o.singleFillStyle)):A(R).attr("d",ie+"Z").call(o.singleFillStyle))):V&&(b.fill.substr(0,6)==="tonext"&&ie&&B?(b.fill==="tonext"?A(V).attr("d",ie+"Z"+B+"Z").call(o.singleFillStyle):A(V).attr("d",ie+"L"+B.substr(1)+"Z").call(o.singleFillStyle),b._polygons=b._polygons.concat(N)):(ue(V),b._polygons=null)),b._prevRevpath=ae,b._prevPolygons=ee):(R?ue(R):V&&ue(V),b._polygons=b._prevRevpath=b._prevPolygons=null),L.datum(d),I.datum(d),function(ge,De,_e){var Pe,Fe=_e[0].trace,ze=r.hasMarkers(Fe),He=r.hasText(Fe),et=Me(Fe),Re=ve,Ze=ve;if(ze||He){var Ke=e,$e=Fe.stackgroup,rt=$e&&c._fullLayout._scatterStackOpts[E._id+M._id][$e].stackgaps==="infer zero";Fe.marker.maxdisplayed||Fe._needsCull?Ke=rt?Ae:we:$e&&!rt&&(Ke=Se),ze&&(Re=Ke),He&&(Ze=Ke)}var at,lt=(Pe=ge.selectAll("path.point").data(Re,et)).enter().append("path").classed("point",!0);w&&lt.call(o.pointStyle,Fe,c).call(o.translatePoints,E,M).style("opacity",0).transition().style("opacity",1),Pe.order(),ze&&(at=o.makePointStyleFns(Fe)),Pe.each(function(gt){var Ie=t.select(this),be=A(Ie);o.translatePoint(gt,be,E,M)?(o.singlePointStyle(gt,be,Fe,at,c),g.layerClipId&&o.hideOutsideRangePoint(gt,be,E,M,Fe.xcalendar,Fe.ycalendar),Fe.customdata&&Ie.classed("plotly-customdata",gt.data!==null&&gt.data!==void 0)):be.remove()}),w?Pe.exit().transition().style("opacity",0).remove():Pe.exit().remove(),(Pe=De.selectAll("g").data(Ze,et)).enter().append("g").classed("textpoint",!0).append("text"),Pe.order(),Pe.each(function(gt){var Ie=t.select(this),be=A(Ie.select("text"));o.translatePoint(gt,be,E,M)?g.layerClipId&&o.hideOutsideRangePoint(gt,Ie,E,M,Fe.xcalendar,Fe.ycalendar):Ie.remove()}),Pe.selectAll("text").call(o.textPointStyle,Fe,c).each(function(gt){var Ie=E.c2p(gt.x),be=M.c2p(gt.y);t.select(this).selectAll("tspan.line").each(function(){A(t.select(this)).attr({x:Ie,y:be})})}),Pe.exit().remove()}(L,I,d);var fe=b.cliponaxis===!1?null:g.layerClipId;o.setClipUrl(L,fe,c),o.setClipUrl(I,fe,c)}function ue(ge){A(ge).attr("d","M0,0Z")}function we(ge){return ge.filter(function(De){return!De.gap&&De.vis})}function Ae(ge){return ge.filter(function(De){return De.vis})}function Se(ge){return ge.filter(function(De){return!De.gap})}function ke(ge){return ge.id}function Me(ge){if(ge.ids)return ke}function ve(){return!1}}z.exports=function(c,f,g,d,m,y){var v,T,w=!m,A=!!m&&m.duration>0,E=u(c,f,g);(v=d.selectAll("g.trace").data(E,function(M){return M[0].trace.uid})).enter().append("g").attr("class",function(M){return"trace scatter trace"+M[0].trace.uid}).style("stroke-miterlimit",2),v.order(),function(M,b,_){b.each(function(S){var C=l(t.select(this),"g","fills");o.setClipUrl(C,_.layerClipId,M);var k=S[0].trace,L=[];k._ownfill&&L.push("_ownFill"),k._nexttrace&&L.push("_nextFill");var I=C.selectAll("g").data(L,e);I.enter().append("g"),I.exit().each(function(R){k[R]=null}).remove(),I.order().each(function(R){k[R]=l(t.select(this),"path","js-fill")})})}(c,v,f),A?(y&&(T=y()),t.transition().duration(m.duration).ease(m.easing).each("end",function(){T&&T()}).each("interrupt",function(){T&&T()}).each(function(){d.selectAll("g.trace").each(function(M,b){a(c,b,f,M,E,this,m)})})):v.each(function(M,b){a(c,b,f,M,E,this,m)}),w&&v.exit().remove(),d.selectAll("path:not([d])").remove()}},{"../../components/drawing":665,"../../lib":778,"../../lib/polygon":790,"../../registry":911,"./line_points":1201,"./link_traces":1203,"./subtypes":1212,d3:169}],1209:[function(n,z,q){"use strict";var t=n("./subtypes");z.exports=function(h,p){var l,e,o,r,i=h.cd,u=h.xaxis,s=h.yaxis,a=[],c=i[0].trace;if(!t.hasMarkers(c)&&!t.hasText(c))return[];if(p===!1)for(l=0;l<i.length;l++)i[l].selected=0;else for(l=0;l<i.length;l++)e=i[l],o=u.c2p(e.x),r=s.c2p(e.y),e.i!==null&&p.contains([o,r],!1,l,h)?(a.push({pointNumber:e.i,x:u.c2d(e.x),y:s.c2d(e.y)}),e.selected=1):e.selected=0;return a}},{"./subtypes":1212}],1210:[function(n,z,q){"use strict";var t=["orientation","groupnorm","stackgaps"];z.exports=function(h,p,l,e){var o=l._scatterStackOpts,r=e("stackgroup");if(r){var i=p.xaxis+p.yaxis,u=o[i];u||(u=o[i]={});var s=u[r],a=!1;s?s.traces.push(p):(s=u[r]={traceIndices:[],traces:[p]},a=!0);for(var c={orientation:p.x&&!p.y?"h":"v"},f=0;f<t.length;f++){var g=t[f],d=g+"Found";if(!s[d]){var m=h[g]!==void 0,y=g==="orientation";if((m||a)&&(s[g]=e(g,c[g]),y&&(s.fillDflt=s[g]==="h"?"tonextx":"tonexty"),m&&(s[d]=!0,!a&&(delete s.traces[0][g],y))))for(var v=0;v<s.traces.length-1;v++){var T=s.traces[v];T._input.fill!==T.fill&&(T.fill=s.fillDflt)}}}return s}}},{}],1211:[function(n,z,q){"use strict";var t=n("d3"),h=n("../../components/drawing"),p=n("../../registry");function l(o,r,i){h.pointStyle(o.selectAll("path.point"),r,i)}function e(o,r,i){h.textPointStyle(o.selectAll("text"),r,i)}z.exports={style:function(o){var r=t.select(o).selectAll("g.trace.scatter");r.style("opacity",function(i){return i[0].trace.opacity}),r.selectAll("g.points").each(function(i){l(t.select(this),i.trace||i[0].trace,o)}),r.selectAll("g.text").each(function(i){e(t.select(this),i.trace||i[0].trace,o)}),r.selectAll("g.trace path.js-line").call(h.lineGroupStyle),r.selectAll("g.trace path.js-fill").call(h.fillGroupStyle),p.getComponentMethod("errorbars","style")(r)},stylePoints:l,styleText:e,styleOnSelect:function(o,r,i){var u=r[0].trace;u.selectedpoints?(h.selectedPointStyle(i.selectAll("path.point"),u),h.selectedTextStyle(i.selectAll("text"),u)):(l(i,u,o),e(i,u,o))}}},{"../../components/drawing":665,"../../registry":911,d3:169}],1212:[function(n,z,q){"use strict";var t=n("../../lib");z.exports={hasLines:function(h){return h.visible&&h.mode&&h.mode.indexOf("lines")!==-1},hasMarkers:function(h){return h.visible&&(h.mode&&h.mode.indexOf("markers")!==-1||h.type==="splom")},hasText:function(h){return h.visible&&h.mode&&h.mode.indexOf("text")!==-1},isBubble:function(h){return t.isPlainObject(h.marker)&&t.isArrayOrTypedArray(h.marker.size)}}},{"../../lib":778}],1213:[function(n,z,q){"use strict";var t=n("../../lib");z.exports=function(h,p,l,e,o){o=o||{},e("textposition"),t.coerceFont(e,"textfont",l.font),o.noSelect||(e("selected.textfont.color"),e("unselected.textfont.color"))}},{"../../lib":778}],1214:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../../registry");z.exports=function(p,l,e,o){var r,i=o("x"),u=o("y");if(h.getComponentMethod("calendars","handleTraceDefaults")(p,l,["x","y"],e),i){var s=t.minRowLength(i);u?r=Math.min(s,t.minRowLength(u)):(r=s,o("y0"),o("dy"))}else{if(!u)return 0;r=t.minRowLength(u),o("x0"),o("dx")}return l._length=r,r}},{"../../lib":778,"../../registry":911}],1215:[function(n,z,q){"use strict";var t=n("../scatter/attributes"),h=n("../../components/colorscale/attributes"),p=n("../../plots/template_attributes").hovertemplateAttrs,l=n("../../plots/template_attributes").texttemplateAttrs,e=n("../../plots/attributes"),o=n("../../constants/gl3d_dashes"),r=n("../../constants/gl3d_markers"),i=n("../../lib/extend").extendFlat,u=n("../../plot_api/edit_types").overrideAll,s=t.line,a=t.marker,c=a.line,f=i({width:s.width,dash:{valType:"enumerated",values:Object.keys(o),dflt:"solid"}},h("line")),g=z.exports=u({x:t.x,y:t.y,z:{valType:"data_array"},text:i({},t.text,{}),texttemplate:l({},{}),hovertext:i({},t.hovertext,{}),hovertemplate:p(),mode:i({},t.mode,{dflt:"lines+markers"}),surfaceaxis:{valType:"enumerated",values:[-1,0,1,2],dflt:-1},surfacecolor:{valType:"color"},projection:{x:{show:{valType:"boolean",dflt:!1},opacity:{valType:"number",min:0,max:1,dflt:1},scale:{valType:"number",min:0,max:10,dflt:2/3}},y:{show:{valType:"boolean",dflt:!1},opacity:{valType:"number",min:0,max:1,dflt:1},scale:{valType:"number",min:0,max:10,dflt:2/3}},z:{show:{valType:"boolean",dflt:!1},opacity:{valType:"number",min:0,max:1,dflt:1},scale:{valType:"number",min:0,max:10,dflt:2/3}}},connectgaps:t.connectgaps,line:f,marker:i({symbol:{valType:"enumerated",values:Object.keys(r),dflt:"circle",arrayOk:!0},size:i({},a.size,{dflt:8}),sizeref:a.sizeref,sizemin:a.sizemin,sizemode:a.sizemode,opacity:i({},a.opacity,{arrayOk:!1}),colorbar:a.colorbar,line:i({width:i({},c.width,{arrayOk:!1})},h("marker.line"))},h("marker")),textposition:i({},t.textposition,{dflt:"top center"}),textfont:{color:t.textfont.color,size:t.textfont.size,family:i({},t.textfont.family,{arrayOk:!1})},hoverinfo:i({},e.hoverinfo)},"calc","nested");g.x.editType=g.y.editType=g.z.editType="calc+clearAxisTypes"},{"../../components/colorscale/attributes":650,"../../constants/gl3d_dashes":750,"../../constants/gl3d_markers":751,"../../lib/extend":768,"../../plot_api/edit_types":810,"../../plots/attributes":824,"../../plots/template_attributes":906,"../scatter/attributes":1187}],1216:[function(n,z,q){"use strict";var t=n("../scatter/arrays_to_calcdata"),h=n("../scatter/colorscale_calc");z.exports=function(p,l){var e=[{x:!1,y:!1,trace:l,t:{}}];return t(e,l),h(p,l),e}},{"../scatter/arrays_to_calcdata":1186,"../scatter/colorscale_calc":1190}],1217:[function(n,z,q){"use strict";var t=n("../../registry");function h(p,l,e,o){if(!l||!l.visible)return null;for(var r=t.getComponentMethod("errorbars","makeComputeError")(l),i=new Array(p.length),u=0;u<p.length;u++){var s=r(+p[u],u);if(o.type==="log"){var a=o.c2l(p[u]),c=p[u]-s[0],f=p[u]+s[1];if(i[u]=[(o.c2l(c,!0)-a)*e,(o.c2l(f,!0)-a)*e],c>0){var g=o.c2l(c);o._lowerLogErrorBound||(o._lowerLogErrorBound=g),o._lowerErrorBound=Math.min(o._lowerLogErrorBound,g)}}else i[u]=[-s[0]*e,s[1]*e]}return i}z.exports=function(p,l,e){var o=[h(p.x,p.error_x,l[0],e.xaxis),h(p.y,p.error_y,l[1],e.yaxis),h(p.z,p.error_z,l[2],e.zaxis)],r=function(f){for(var g=0;g<f.length;g++)if(f[g])return f[g].length;return 0}(o);if(r===0)return null;for(var i=new Array(r),u=0;u<r;u++){for(var s=[[0,0,0],[0,0,0]],a=0;a<3;a++)if(o[a])for(var c=0;c<2;c++)s[c][a]=o[a][u][c];i[u]=s}return i}},{"../../registry":911}],1218:[function(n,z,q){"use strict";var t=n("gl-line3d"),h=n("gl-scatter3d"),p=n("gl-error3d"),l=n("gl-mesh3d"),e=n("delaunay-triangulate"),o=n("../../lib"),r=n("../../lib/str2rgbarray"),i=n("../../lib/gl_format_color").formatColor,u=n("../scatter/make_bubble_size_func"),s=n("../../constants/gl3d_dashes"),a=n("../../constants/gl3d_markers"),c=n("../../plots/cartesian/axes"),f=n("../../components/fx/helpers").appendArrayPointValue,g=n("./calc_errors");function d(_,S){this.scene=_,this.uid=S,this.linePlot=null,this.scatterPlot=null,this.errorBars=null,this.textMarkers=null,this.delaunayMesh=null,this.color=null,this.mode="",this.dataPoints=[],this.axesBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.textLabels=null,this.data=null}var m=d.prototype;function y(_){return _==null?0:_.indexOf("left")>-1?-1:_.indexOf("right")>-1?1:0}function v(_){return _==null?0:_.indexOf("top")>-1?-1:_.indexOf("bottom")>-1?1:0}function T(_,S){return S(4*_)}function w(_){return a[_]}function A(_,S,C,k,L){var I=null;if(o.isArrayOrTypedArray(_)){I=[];for(var R=0;R<S;R++)_[R]===void 0?I[R]=k:I[R]=C(_[R],L)}else I=C(_,o.identity);return I}function E(_,S){var C,k,L,I,R,V,O=[],J=_.fullSceneLayout,D=_.dataScale,B=J.xaxis,N=J.yaxis,F=J.zaxis,H=S.marker,j=S.line,G=S.x||[],W=S.y||[],Q=S.z||[],$=G.length,ee=S.xcalendar,ie=S.ycalendar,ae=S.zcalendar;for(R=0;R<$;R++)C=B.d2l(G[R],0,ee)*D[0],k=N.d2l(W[R],0,ie)*D[1],L=F.d2l(Q[R],0,ae)*D[2],O[R]=[C,k,L];if(Array.isArray(S.text))V=S.text;else if(S.text!==void 0)for(V=new Array($),R=0;R<$;R++)V[R]=S.text;function oe(Pe,Fe){var ze=J[Pe];return c.tickText(ze,ze.d2l(Fe),!0).text}var de=S.texttemplate;if(de){var le=_.fullLayout._d3locale,fe=Array.isArray(de),ue=fe?Math.min(de.length,$):$,we=fe?function(Pe){return de[Pe]}:function(){return de};for(V=new Array(ue),R=0;R<ue;R++){var Ae={x:G[R],y:W[R],z:Q[R]},Se={xLabel:oe("xaxis",G[R]),yLabel:oe("yaxis",W[R]),zLabel:oe("zaxis",Q[R])},ke={};f(ke,S,R);var Me=S._meta||{};V[R]=o.texttemplateString(we(R),Se,le,ke,Ae,Me)}}if(I={position:O,mode:S.mode,text:V},"line"in S&&(I.lineColor=i(j,1,$),I.lineWidth=j.width,I.lineDashes=j.dash),"marker"in S){var ve=u(S);I.scatterColor=i(H,1,$),I.scatterSize=A(H.size,$,T,20,ve),I.scatterMarker=A(H.symbol,$,w,"\u25CF"),I.scatterLineWidth=H.line.width,I.scatterLineColor=i(H.line,1,$),I.scatterAngle=0}"textposition"in S&&(I.textOffset=function(Pe){var Fe=[0,0];if(Array.isArray(Pe))for(var ze=0;ze<Pe.length;ze++)Fe[ze]=[0,0],Pe[ze]&&(Fe[ze][0]=y(Pe[ze]),Fe[ze][1]=v(Pe[ze]));else Fe[0]=y(Pe),Fe[1]=v(Pe);return Fe}(S.textposition),I.textColor=i(S.textfont,1,$),I.textSize=A(S.textfont.size,$,o.identity,12),I.textFont=S.textfont.family,I.textAngle=0);var ge=["x","y","z"];for(I.project=[!1,!1,!1],I.projectScale=[1,1,1],I.projectOpacity=[1,1,1],R=0;R<3;++R){var De=S.projection[ge[R]];(I.project[R]=De.show)&&(I.projectOpacity[R]=De.opacity,I.projectScale[R]=De.scale)}I.errorBounds=g(S,D,J);var _e=function(Pe){for(var Fe=[0,0,0],ze=[[0,0,0],[0,0,0],[0,0,0]],He=[1,1,1],et=0;et<3;et++){var Re=Pe[et];Re&&Re.copy_zstyle!==!1&&Pe[2].visible!==!1&&(Re=Pe[2]),Re&&Re.visible&&(Fe[et]=Re.width/2,ze[et]=r(Re.color),He[et]=Re.thickness)}return{capSize:Fe,color:ze,lineWidth:He}}([S.error_x,S.error_y,S.error_z]);return I.errorColor=_e.color,I.errorLineWidth=_e.lineWidth,I.errorCapSize=_e.capSize,I.delaunayAxis=S.surfaceaxis,I.delaunayColor=r(S.surfacecolor),I}function M(_){if(o.isArrayOrTypedArray(_)){var S=_[0];return o.isArrayOrTypedArray(S)&&(_=S),"rgb("+_.slice(0,3).map(function(C){return Math.round(255*C)})+")"}return null}function b(_){return o.isArrayOrTypedArray(_)?_.length===4&&typeof _[0]=="number"?M(_):_.map(M):null}m.handlePick=function(_){if(_.object&&(_.object===this.linePlot||_.object===this.delaunayMesh||_.object===this.textMarkers||_.object===this.scatterPlot)){var S=_.index=_.data.index;return _.object.highlight&&_.object.highlight(null),this.scatterPlot&&(_.object=this.scatterPlot,this.scatterPlot.highlight(_.data)),_.textLabel="",this.textLabels&&(Array.isArray(this.textLabels)?(this.textLabels[S]||this.textLabels[S]===0)&&(_.textLabel=this.textLabels[S]):_.textLabel=this.textLabels),_.traceCoordinate=[this.data.x[S],this.data.y[S],this.data.z[S]],!0}},m.update=function(_){var S,C,k,L,I=this.scene.glplot.gl,R=s.solid;this.data=_;var V=E(this.scene,_);"mode"in V&&(this.mode=V.mode),"lineDashes"in V&&V.lineDashes in s&&(R=s[V.lineDashes]),this.color=b(V.scatterColor)||b(V.lineColor),this.dataPoints=V.position,S={gl:this.scene.glplot.gl,position:V.position,color:V.lineColor,lineWidth:V.lineWidth||1,dashes:R[0],dashScale:R[1],opacity:_.opacity,connectGaps:_.connectgaps},this.mode.indexOf("lines")!==-1?this.linePlot?this.linePlot.update(S):(this.linePlot=t(S),this.linePlot._trace=this,this.scene.glplot.add(this.linePlot)):this.linePlot&&(this.scene.glplot.remove(this.linePlot),this.linePlot.dispose(),this.linePlot=null);var O=_.opacity;if(_.marker&&_.marker.opacity&&(O*=_.marker.opacity),C={gl:this.scene.glplot.gl,position:V.position,color:V.scatterColor,size:V.scatterSize,glyph:V.scatterMarker,opacity:O,orthographic:!0,lineWidth:V.scatterLineWidth,lineColor:V.scatterLineColor,project:V.project,projectScale:V.projectScale,projectOpacity:V.projectOpacity},this.mode.indexOf("markers")!==-1?this.scatterPlot?this.scatterPlot.update(C):(this.scatterPlot=h(C),this.scatterPlot._trace=this,this.scatterPlot.highlightScale=1,this.scene.glplot.add(this.scatterPlot)):this.scatterPlot&&(this.scene.glplot.remove(this.scatterPlot),this.scatterPlot.dispose(),this.scatterPlot=null),L={gl:this.scene.glplot.gl,position:V.position,glyph:V.text,color:V.textColor,size:V.textSize,angle:V.textAngle,alignment:V.textOffset,font:V.textFont,orthographic:!0,lineWidth:0,project:!1,opacity:_.opacity},this.textLabels=_.hovertext||_.text,this.mode.indexOf("text")!==-1?this.textMarkers?this.textMarkers.update(L):(this.textMarkers=h(L),this.textMarkers._trace=this,this.textMarkers.highlightScale=1,this.scene.glplot.add(this.textMarkers)):this.textMarkers&&(this.scene.glplot.remove(this.textMarkers),this.textMarkers.dispose(),this.textMarkers=null),k={gl:this.scene.glplot.gl,position:V.position,color:V.errorColor,error:V.errorBounds,lineWidth:V.errorLineWidth,capSize:V.errorCapSize,opacity:_.opacity},this.errorBars?V.errorBounds?this.errorBars.update(k):(this.scene.glplot.remove(this.errorBars),this.errorBars.dispose(),this.errorBars=null):V.errorBounds&&(this.errorBars=p(k),this.errorBars._trace=this,this.scene.glplot.add(this.errorBars)),V.delaunayAxis>=0){var J=function(D,B,N){var F,H=(N+1)%3,j=(N+2)%3,G=[],W=[];for(F=0;F<D.length;++F){var Q=D[F];!isNaN(Q[H])&&isFinite(Q[H])&&!isNaN(Q[j])&&isFinite(Q[j])&&(G.push([Q[H],Q[j]]),W.push(F))}var $=e(G);for(F=0;F<$.length;++F)for(var ee=$[F],ie=0;ie<ee.length;++ie)ee[ie]=W[ee[ie]];return{positions:D,cells:$,meshColor:B}}(V.position,V.delaunayColor,V.delaunayAxis);J.opacity=_.opacity,this.delaunayMesh?this.delaunayMesh.update(J):(J.gl=I,this.delaunayMesh=l(J),this.delaunayMesh._trace=this,this.scene.glplot.add(this.delaunayMesh))}else this.delaunayMesh&&(this.scene.glplot.remove(this.delaunayMesh),this.delaunayMesh.dispose(),this.delaunayMesh=null)},m.dispose=function(){this.linePlot&&(this.scene.glplot.remove(this.linePlot),this.linePlot.dispose()),this.scatterPlot&&(this.scene.glplot.remove(this.scatterPlot),this.scatterPlot.dispose()),this.errorBars&&(this.scene.glplot.remove(this.errorBars),this.errorBars.dispose()),this.textMarkers&&(this.scene.glplot.remove(this.textMarkers),this.textMarkers.dispose()),this.delaunayMesh&&(this.scene.glplot.remove(this.delaunayMesh),this.delaunayMesh.dispose())},z.exports=function(_,S){var C=new d(_,S.uid);return C.update(S),C}},{"../../components/fx/helpers":679,"../../constants/gl3d_dashes":750,"../../constants/gl3d_markers":751,"../../lib":778,"../../lib/gl_format_color":774,"../../lib/str2rgbarray":802,"../../plots/cartesian/axes":828,"../scatter/make_bubble_size_func":1204,"./calc_errors":1217,"delaunay-triangulate":171,"gl-error3d":266,"gl-line3d":275,"gl-mesh3d":309,"gl-scatter3d":330}],1219:[function(n,z,q){"use strict";var t=n("../../registry"),h=n("../../lib"),p=n("../scatter/subtypes"),l=n("../scatter/marker_defaults"),e=n("../scatter/line_defaults"),o=n("../scatter/text_defaults"),r=n("./attributes");z.exports=function(i,u,s,a){function c(T,w){return h.coerce(i,u,r,T,w)}if(function(T,w,A,E){var M=0,b=A("x"),_=A("y"),S=A("z");return t.getComponentMethod("calendars","handleTraceDefaults")(T,w,["x","y","z"],E),b&&_&&S&&(M=Math.min(b.length,_.length,S.length),w._length=w._xlength=w._ylength=w._zlength=M),M}(i,u,c,a)){c("text"),c("hovertext"),c("hovertemplate"),c("mode"),p.hasLines(u)&&(c("connectgaps"),e(i,u,s,a,c)),p.hasMarkers(u)&&l(i,u,s,a,c,{noSelect:!0}),p.hasText(u)&&(c("texttemplate"),o(i,u,a,c,{noSelect:!0}));var f=(u.line||{}).color,g=(u.marker||{}).color;c("surfaceaxis")>=0&&c("surfacecolor",f||g);for(var d=["x","y","z"],m=0;m<3;++m){var y="projection."+d[m];c(y+".show")&&(c(y+".opacity"),c(y+".scale"))}var v=t.getComponentMethod("errorbars","supplyDefaults");v(i,u,f||g||s,{axis:"z"}),v(i,u,f||g||s,{axis:"y",inherit:"z"}),v(i,u,f||g||s,{axis:"x",inherit:"z"})}else u.visible=!1}},{"../../lib":778,"../../registry":911,"../scatter/line_defaults":1200,"../scatter/marker_defaults":1206,"../scatter/subtypes":1212,"../scatter/text_defaults":1213,"./attributes":1215}],1220:[function(n,z,q){"use strict";z.exports={plot:n("./convert"),attributes:n("./attributes"),markerSymbols:n("../../constants/gl3d_markers"),supplyDefaults:n("./defaults"),colorbar:[{container:"marker",min:"cmin",max:"cmax"},{container:"line",min:"cmin",max:"cmax"}],calc:n("./calc"),moduleType:"trace",name:"scatter3d",basePlotModule:n("../../plots/gl3d"),categories:["gl3d","symbols","showLegend","scatter-like"],meta:{}}},{"../../constants/gl3d_markers":751,"../../plots/gl3d":870,"./attributes":1215,"./calc":1216,"./convert":1218,"./defaults":1219}],1221:[function(n,z,q){"use strict";var t=n("../scatter/attributes"),h=n("../../plots/attributes"),p=n("../../plots/template_attributes").hovertemplateAttrs,l=n("../../plots/template_attributes").texttemplateAttrs,e=n("../../components/colorscale/attributes"),o=n("../../lib/extend").extendFlat,r=t.marker,i=t.line,u=r.line;z.exports={carpet:{valType:"string",editType:"calc"},a:{valType:"data_array",editType:"calc"},b:{valType:"data_array",editType:"calc"},mode:o({},t.mode,{dflt:"markers"}),text:o({},t.text,{}),texttemplate:l({editType:"plot"},{keys:["a","b","text"]}),hovertext:o({},t.hovertext,{}),line:{color:i.color,width:i.width,dash:i.dash,shape:o({},i.shape,{values:["linear","spline"]}),smoothing:i.smoothing,editType:"calc"},connectgaps:t.connectgaps,fill:o({},t.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:t.fillcolor,marker:o({symbol:r.symbol,opacity:r.opacity,maxdisplayed:r.maxdisplayed,size:r.size,sizeref:r.sizeref,sizemin:r.sizemin,sizemode:r.sizemode,line:o({width:u.width,editType:"calc"},e("marker.line")),gradient:r.gradient,editType:"calc"},e("marker")),textfont:t.textfont,textposition:t.textposition,selected:t.selected,unselected:t.unselected,hoverinfo:o({},h.hoverinfo,{flags:["a","b","text","name"]}),hoveron:t.hoveron,hovertemplate:p()}},{"../../components/colorscale/attributes":650,"../../lib/extend":768,"../../plots/attributes":824,"../../plots/template_attributes":906,"../scatter/attributes":1187}],1222:[function(n,z,q){"use strict";var t=n("fast-isnumeric"),h=n("../scatter/colorscale_calc"),p=n("../scatter/arrays_to_calcdata"),l=n("../scatter/calc_selection"),e=n("../scatter/calc").calcMarkerSize,o=n("../carpet/lookup_carpetid");z.exports=function(r,i){var u=i._carpetTrace=o(r,i);if(u&&u.visible&&u.visible!=="legendonly"){var s;i.xaxis=u.xaxis,i.yaxis=u.yaxis;var a,c,f=i._length,g=new Array(f),d=!1;for(s=0;s<f;s++)if(a=i.a[s],c=i.b[s],t(a)&&t(c)){var m=u.ab2xy(+a,+c,!0),y=u.isVisible(+a,+c);y||(d=!0),g[s]={x:m[0],y:m[1],a,b:c,vis:y}}else g[s]={x:!1,y:!1};return i._needsCull=d,g[0].carpet=u,g[0].trace=i,e(i,f),h(r,i),p(g,i),l(g,i),g}}},{"../carpet/lookup_carpetid":981,"../scatter/arrays_to_calcdata":1186,"../scatter/calc":1188,"../scatter/calc_selection":1189,"../scatter/colorscale_calc":1190,"fast-isnumeric":241}],1223:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../scatter/constants"),p=n("../scatter/subtypes"),l=n("../scatter/marker_defaults"),e=n("../scatter/line_defaults"),o=n("../scatter/line_shape_defaults"),r=n("../scatter/text_defaults"),i=n("../scatter/fillcolor_defaults"),u=n("./attributes");z.exports=function(s,a,c,f){function g(T,w){return t.coerce(s,a,u,T,w)}g("carpet"),a.xaxis="x",a.yaxis="y";var d=g("a"),m=g("b"),y=Math.min(d.length,m.length);if(y){a._length=y,g("text"),g("texttemplate"),g("hovertext"),g("mode",y<h.PTS_LINESONLY?"lines+markers":"lines"),p.hasLines(a)&&(e(s,a,c,f,g),o(s,a,g),g("connectgaps")),p.hasMarkers(a)&&l(s,a,c,f,g,{gradient:!0}),p.hasText(a)&&r(s,a,f,g);var v=[];(p.hasMarkers(a)||p.hasText(a))&&(g("marker.maxdisplayed"),v.push("points")),g("fill"),a.fill!=="none"&&(i(s,a,c,g),p.hasLines(a)||o(s,a,g)),a.fill!=="tonext"&&a.fill!=="toself"||v.push("fills"),g("hoveron",v.join("+")||"points")!=="fills"&&g("hovertemplate"),t.coerceSelectionMarkerOpacity(a,g)}else a.visible=!1}},{"../../lib":778,"../scatter/constants":1191,"../scatter/fillcolor_defaults":1195,"../scatter/line_defaults":1200,"../scatter/line_shape_defaults":1202,"../scatter/marker_defaults":1206,"../scatter/subtypes":1212,"../scatter/text_defaults":1213,"./attributes":1221}],1224:[function(n,z,q){"use strict";z.exports=function(t,h,p,l,e){var o=l[e];return t.a=o.a,t.b=o.b,t.y=o.y,t}},{}],1225:[function(n,z,q){"use strict";z.exports=function(t,h){var p={},l=h._carpet,e=l.ab2ij([t.a,t.b]),o=Math.floor(e[0]),r=e[0]-o,i=Math.floor(e[1]),u=e[1]-i,s=l.evalxy([],o,i,r,u);return p.yLabel=s[1].toFixed(3),p}},{}],1226:[function(n,z,q){"use strict";var t=n("../scatter/hover"),h=n("../../lib").fillText;z.exports=function(p,l,e,o){var r=t(p,l,e,o);if(r&&r[0].index!==!1){var i=r[0];if(i.index===void 0){var u=1-i.y0/p.ya._length,s=p.xa._length,a=s*u/2,c=s-a;return i.x0=Math.max(Math.min(i.x0,c),a),i.x1=Math.max(Math.min(i.x1,c),a),r}var f=i.cd[i.index];i.a=f.a,i.b=f.b,i.xLabelVal=void 0,i.yLabelVal=void 0;var g=i.trace,d=g._carpet,m=g._module.formatLabels(f,g);i.yLabel=m.yLabel,delete i.text;var y=[];if(!g.hovertemplate){var v=(f.hi||g.hoverinfo).split("+");v.indexOf("all")!==-1&&(v=["a","b","text"]),v.indexOf("a")!==-1&&T(d.aaxis,f.a),v.indexOf("b")!==-1&&T(d.baxis,f.b),y.push("y: "+i.yLabel),v.indexOf("text")!==-1&&h(f,g,y),i.extraText=y.join("<br>")}return r}function T(w,A){var E;E=w.labelprefix&&w.labelprefix.length>0?w.labelprefix.replace(/ = $/,""):w._hovertitle,y.push(E+": "+A.toFixed(3)+w.labelsuffix)}}},{"../../lib":778,"../scatter/hover":1198}],1227:[function(n,z,q){"use strict";z.exports={attributes:n("./attributes"),supplyDefaults:n("./defaults"),colorbar:n("../scatter/marker_colorbar"),formatLabels:n("./format_labels"),calc:n("./calc"),plot:n("./plot"),style:n("../scatter/style").style,styleOnSelect:n("../scatter/style").styleOnSelect,hoverPoints:n("./hover"),selectPoints:n("../scatter/select"),eventData:n("./event_data"),moduleType:"trace",name:"scattercarpet",basePlotModule:n("../../plots/cartesian"),categories:["svg","carpet","symbols","showLegend","carpetDependent","zoomScale"],meta:{}}},{"../../plots/cartesian":841,"../scatter/marker_colorbar":1205,"../scatter/select":1209,"../scatter/style":1211,"./attributes":1221,"./calc":1222,"./defaults":1223,"./event_data":1224,"./format_labels":1225,"./hover":1226,"./plot":1228}],1228:[function(n,z,q){"use strict";var t=n("../scatter/plot"),h=n("../../plots/cartesian/axes"),p=n("../../components/drawing");z.exports=function(l,e,o,r){var i,u,s,a=o[0][0].carpet,c={xaxis:h.getFromId(l,a.xaxis||"x"),yaxis:h.getFromId(l,a.yaxis||"y"),plot:e.plot};for(t(l,c,o,r),i=0;i<o.length;i++)u=o[i][0].trace,s=r.selectAll("g.trace"+u.uid+" .js-line"),p.setClipUrl(s,o[i][0].carpet._clipPathId,l)}},{"../../components/drawing":665,"../../plots/cartesian/axes":828,"../scatter/plot":1208}],1229:[function(n,z,q){"use strict";var t=n("../../plots/template_attributes").hovertemplateAttrs,h=n("../../plots/template_attributes").texttemplateAttrs,p=n("../scatter/attributes"),l=n("../../plots/attributes"),e=n("../../components/colorscale/attributes"),o=n("../../components/drawing/attributes").dash,r=n("../../lib/extend").extendFlat,i=n("../../plot_api/edit_types").overrideAll,u=p.marker,s=p.line,a=u.line;z.exports=i({lon:{valType:"data_array"},lat:{valType:"data_array"},locations:{valType:"data_array"},locationmode:{valType:"enumerated",values:["ISO-3","USA-states","country names","geojson-id"],dflt:"ISO-3"},geojson:{valType:"any",editType:"calc"},featureidkey:{valType:"string",editType:"calc",dflt:"id"},mode:r({},p.mode,{dflt:"markers"}),text:r({},p.text,{}),texttemplate:h({editType:"plot"},{keys:["lat","lon","location","text"]}),hovertext:r({},p.hovertext,{}),textfont:p.textfont,textposition:p.textposition,line:{color:s.color,width:s.width,dash:o},connectgaps:p.connectgaps,marker:r({symbol:u.symbol,opacity:u.opacity,size:u.size,sizeref:u.sizeref,sizemin:u.sizemin,sizemode:u.sizemode,colorbar:u.colorbar,line:r({width:a.width},e("marker.line")),gradient:u.gradient},e("marker")),fill:{valType:"enumerated",values:["none","toself"],dflt:"none"},fillcolor:p.fillcolor,selected:p.selected,unselected:p.unselected,hoverinfo:r({},l.hoverinfo,{flags:["lon","lat","location","text","name"]}),hovertemplate:t()},"calc","nested")},{"../../components/colorscale/attributes":650,"../../components/drawing/attributes":664,"../../lib/extend":768,"../../plot_api/edit_types":810,"../../plots/attributes":824,"../../plots/template_attributes":906,"../scatter/attributes":1187}],1230:[function(n,z,q){"use strict";var t=n("fast-isnumeric"),h=n("../../constants/numerical").BADNUM,p=n("../scatter/colorscale_calc"),l=n("../scatter/arrays_to_calcdata"),e=n("../scatter/calc_selection"),o=n("../../lib")._;function r(i){return i&&typeof i=="string"}z.exports=function(i,u){var s,a=Array.isArray(u.locations),c=a?u.locations.length:u._length,f=new Array(c);s=u.geojson?function(T){return r(T)||t(T)}:r;for(var g=0;g<c;g++){var d=f[g]={};if(a){var m=u.locations[g];d.loc=s(m)?m:null}else{var y=u.lon[g],v=u.lat[g];t(y)&&t(v)?d.lonlat=[+y,+v]:d.lonlat=[h,h]}}return l(f,u),p(i,u),e(f,u),c&&(f[0].t={labels:{lat:o(i,"lat:")+" ",lon:o(i,"lon:")+" "}}),f}},{"../../constants/numerical":753,"../../lib":778,"../scatter/arrays_to_calcdata":1186,"../scatter/calc_selection":1189,"../scatter/colorscale_calc":1190,"fast-isnumeric":241}],1231:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../scatter/subtypes"),p=n("../scatter/marker_defaults"),l=n("../scatter/line_defaults"),e=n("../scatter/text_defaults"),o=n("../scatter/fillcolor_defaults"),r=n("./attributes");z.exports=function(i,u,s,a){function c(T,w){return t.coerce(i,u,r,T,w)}var f,g=c("locations");if(g&&g.length){var d,m=c("geojson");(typeof m=="string"&&m!==""||t.isPlainObject(m))&&(d="geojson-id"),c("locationmode",d)==="geojson-id"&&c("featureidkey"),f=g.length}else{var y=c("lon")||[],v=c("lat")||[];f=Math.min(y.length,v.length)}f?(u._length=f,c("text"),c("hovertext"),c("hovertemplate"),c("mode"),h.hasLines(u)&&(l(i,u,s,a,c),c("connectgaps")),h.hasMarkers(u)&&p(i,u,s,a,c,{gradient:!0}),h.hasText(u)&&(c("texttemplate"),e(i,u,a,c)),c("fill"),u.fill!=="none"&&o(i,u,s,c),t.coerceSelectionMarkerOpacity(u,c)):u.visible=!1}},{"../../lib":778,"../scatter/fillcolor_defaults":1195,"../scatter/line_defaults":1200,"../scatter/marker_defaults":1206,"../scatter/subtypes":1212,"../scatter/text_defaults":1213,"./attributes":1229}],1232:[function(n,z,q){"use strict";z.exports=function(t,h,p,l,e){t.lon=h.lon,t.lat=h.lat,t.location=h.loc?h.loc:null;var o=l[e];return o.fIn&&o.fIn.properties&&(t.properties=o.fIn.properties),t}},{}],1233:[function(n,z,q){"use strict";var t=n("../../plots/cartesian/axes");z.exports=function(h,p,l){var e={},o=l[p.geo]._subplot.mockAxis,r=h.lonlat;return e.lonLabel=t.tickText(o,o.c2l(r[0]),!0).text,e.latLabel=t.tickText(o,o.c2l(r[1]),!0).text,e}},{"../../plots/cartesian/axes":828}],1234:[function(n,z,q){"use strict";var t=n("../../components/fx"),h=n("../../constants/numerical").BADNUM,p=n("../scatter/get_trace_color"),l=n("../../lib").fillText,e=n("./attributes");z.exports=function(o,r,i){var u=o.cd,s=u[0].trace,a=o.xa,c=o.ya,f=o.subplot,g=f.projection.isLonLatOverEdges,d=f.project;if(t.getClosest(u,function(E){var M=E.lonlat;if(M[0]===h||g(M))return 1/0;var b=d(M),_=d([r,i]),S=Math.abs(b[0]-_[0]),C=Math.abs(b[1]-_[1]),k=Math.max(3,E.mrc||0);return Math.max(Math.sqrt(S*S+C*C)-k,1-3/k)},o),o.index!==!1){var m=u[o.index],y=m.lonlat,v=[a.c2p(y),c.c2p(y)],T=m.mrc||1;o.x0=v[0]-T,o.x1=v[0]+T,o.y0=v[1]-T,o.y1=v[1]+T,o.loc=m.loc,o.lon=y[0],o.lat=y[1];var w={};w[s.geo]={_subplot:f};var A=s._module.formatLabels(m,s,w);return o.lonLabel=A.lonLabel,o.latLabel=A.latLabel,o.color=p(s,m),o.extraText=function(E,M,b,_){if(E.hovertemplate)return;var S=M.hi||E.hoverinfo,C=S==="all"?e.hoverinfo.flags:S.split("+"),k=C.indexOf("location")!==-1&&Array.isArray(E.locations),L=C.indexOf("lon")!==-1,I=C.indexOf("lat")!==-1,R=C.indexOf("text")!==-1,V=[];function O(J){return J+"\xB0"}return k?V.push(M.loc):L&&I?V.push("("+O(b.lonLabel)+", "+O(b.latLabel)+")"):L?V.push(_.lon+O(b.lonLabel)):I&&V.push(_.lat+O(b.latLabel)),R&&l(M,E,V),V.join("<br>")}(s,m,o,u[0].t.labels),o.hovertemplate=s.hovertemplate,[o]}}},{"../../components/fx":683,"../../constants/numerical":753,"../../lib":778,"../scatter/get_trace_color":1197,"./attributes":1229}],1235:[function(n,z,q){"use strict";z.exports={attributes:n("./attributes"),supplyDefaults:n("./defaults"),colorbar:n("../scatter/marker_colorbar"),formatLabels:n("./format_labels"),calc:n("./calc"),calcGeoJSON:n("./plot").calcGeoJSON,plot:n("./plot").plot,style:n("./style"),styleOnSelect:n("../scatter/style").styleOnSelect,hoverPoints:n("./hover"),eventData:n("./event_data"),selectPoints:n("./select"),moduleType:"trace",name:"scattergeo",basePlotModule:n("../../plots/geo"),categories:["geo","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/geo":860,"../scatter/marker_colorbar":1205,"../scatter/style":1211,"./attributes":1229,"./calc":1230,"./defaults":1231,"./event_data":1232,"./format_labels":1233,"./hover":1234,"./plot":1236,"./select":1237,"./style":1238}],1236:[function(n,z,q){"use strict";var t=n("d3"),h=n("../../lib"),p=n("../../lib/topojson_utils").getTopojsonFeatures,l=n("../../lib/geojson_utils"),e=n("../../lib/geo_location_utils"),o=n("../../plots/cartesian/autorange").findExtremes,r=n("../../constants/numerical").BADNUM,i=n("../scatter/calc").calcMarkerSize,u=n("../scatter/subtypes"),s=n("./style");z.exports={calcGeoJSON:function(a,c){var f,g,d=a[0].trace,m=c[d.geo],y=m._subplot,v=d._length;if(Array.isArray(d.locations)){var T=d.locationmode,w=T==="geojson-id"?e.extractTraceFeature(a):p(d,y.topojson);for(f=0;f<v;f++){g=a[f];var A=T==="geojson-id"?g.fOut:e.locationToFeature(T,g.loc,w);g.lonlat=A?A.properties.ct:[r,r]}}var E,M,b={padded:!0};if(m.fitbounds==="geojson"&&d.locationmode==="geojson-id"){var _=e.computeBbox(e.getTraceGeojson(d));E=[_[0],_[2]],M=[_[1],_[3]]}else{for(E=new Array(v),M=new Array(v),f=0;f<v;f++)g=a[f],E[f]=g.lonlat[0],M[f]=g.lonlat[1];b.ppad=i(d,v)}d._extremes.lon=o(m.lonaxis._ax,E,b),d._extremes.lat=o(m.lataxis._ax,M,b)},plot:function(a,c,f){var g=c.layers.frontplot.select(".scatterlayer"),d=h.makeTraceGroups(g,f,"trace scattergeo");function m(y,v){y.lonlat[0]===r&&t.select(v).remove()}d.selectAll("*").remove(),d.each(function(y){var v=t.select(this),T=y[0].trace;if(u.hasLines(T)||T.fill!=="none"){var w=l.calcTraceToLineCoords(y),A=T.fill!=="none"?l.makePolygon(w):l.makeLine(w);v.selectAll("path.js-line").data([{geojson:A,trace:T}]).enter().append("path").classed("js-line",!0).style("stroke-miterlimit",2)}u.hasMarkers(T)&&v.selectAll("path.point").data(h.identity).enter().append("path").classed("point",!0).each(function(E){m(E,this)}),u.hasText(T)&&v.selectAll("g").data(h.identity).enter().append("g").append("text").each(function(E){m(E,this)}),s(a,y)})}}},{"../../constants/numerical":753,"../../lib":778,"../../lib/geo_location_utils":771,"../../lib/geojson_utils":772,"../../lib/topojson_utils":806,"../../plots/cartesian/autorange":827,"../scatter/calc":1188,"../scatter/subtypes":1212,"./style":1238,d3:169}],1237:[function(n,z,q){"use strict";var t=n("../scatter/subtypes"),h=n("../../constants/numerical").BADNUM;z.exports=function(p,l){var e,o,r,i,u,s=p.cd,a=p.xaxis,c=p.yaxis,f=[],g=s[0].trace;if(!t.hasMarkers(g)&&!t.hasText(g))return[];if(l===!1)for(u=0;u<s.length;u++)s[u].selected=0;else for(u=0;u<s.length;u++)(o=(e=s[u]).lonlat)[0]!==h&&(r=a.c2p(o),i=c.c2p(o),l.contains([r,i],null,u,p)?(f.push({pointNumber:u,lon:o[0],lat:o[1]}),e.selected=1):e.selected=0);return f}},{"../../constants/numerical":753,"../scatter/subtypes":1212}],1238:[function(n,z,q){"use strict";var t=n("d3"),h=n("../../components/drawing"),p=n("../../components/color"),l=n("../scatter/style"),e=l.stylePoints,o=l.styleText;z.exports=function(r,i){i&&function(u,s){var a=s[0].trace,c=s[0].node3;c.style("opacity",s[0].trace.opacity),e(c,a,u),o(c,a,u),c.selectAll("path.js-line").style("fill","none").each(function(f){var g=t.select(this),d=f.trace,m=d.line||{};g.call(p.stroke,m.color).call(h.dashLine,m.dash||"",m.width||0),d.fill!=="none"&&g.call(p.fill,d.fillcolor)})}(r,i)}},{"../../components/color":643,"../../components/drawing":665,"../scatter/style":1211,d3:169}],1239:[function(n,z,q){"use strict";var t=n("../../plots/attributes"),h=n("../scatter/attributes"),p=n("../../components/colorscale/attributes"),l=n("../../lib/extend").extendFlat,e=n("../../plot_api/edit_types").overrideAll,o=n("./constants").DASHES,r=h.line,i=h.marker,u=i.line,s=z.exports=e({x:h.x,x0:h.x0,dx:h.dx,y:h.y,y0:h.y0,dy:h.dy,xperiod:h.xperiod,yperiod:h.yperiod,xperiod0:h.xperiod0,yperiod0:h.yperiod0,xperiodalignment:h.xperiodalignment,yperiodalignment:h.yperiodalignment,text:h.text,hovertext:h.hovertext,textposition:h.textposition,textfont:h.textfont,mode:{valType:"flaglist",flags:["lines","markers","text"],extras:["none"]},line:{color:r.color,width:r.width,shape:{valType:"enumerated",values:["linear","hv","vh","hvh","vhv"],dflt:"linear",editType:"plot"},dash:{valType:"enumerated",values:Object.keys(o),dflt:"solid"}},marker:l({},p("marker"),{symbol:i.symbol,size:i.size,sizeref:i.sizeref,sizemin:i.sizemin,sizemode:i.sizemode,opacity:i.opacity,colorbar:i.colorbar,line:l({},p("marker.line"),{width:u.width})}),connectgaps:h.connectgaps,fill:l({},h.fill,{dflt:"none"}),fillcolor:h.fillcolor,selected:{marker:h.selected.marker,textfont:h.selected.textfont},unselected:{marker:h.unselected.marker,textfont:h.unselected.textfont},opacity:t.opacity},"calc","nested");s.x.editType=s.y.editType=s.x0.editType=s.y0.editType="calc+clearAxisTypes",s.hovertemplate=h.hovertemplate,s.texttemplate=h.texttemplate},{"../../components/colorscale/attributes":650,"../../lib/extend":768,"../../plot_api/edit_types":810,"../../plots/attributes":824,"../scatter/attributes":1187,"./constants":1241}],1240:[function(n,z,q){"use strict";var t=n("@plotly/point-cluster"),h=n("../../lib"),p=n("../../plots/cartesian/axis_ids"),l=n("../../plots/cartesian/autorange").findExtremes,e=n("../../plots/cartesian/align_period"),o=n("../scatter/calc"),r=o.calcMarkerSize,i=o.calcAxisExpansion,u=o.setFirstScatter,s=n("../scatter/colorscale_calc"),a=n("./convert"),c=n("./scene_update"),f=n("../../constants/numerical").BADNUM,g=n("./constants").TOO_MANY_POINTS;function d(m,y,v){var T=m._extremes[y._id],w=l(y,v._bnds,{padded:!0});T.min=T.min.concat(w.min),T.max=T.max.concat(w.max)}z.exports=function(m,y){var v,T,w,A=m._fullLayout,E=p.getFromId(m,y.xaxis),M=p.getFromId(m,y.yaxis),b=A._plots[y.xaxis+y.yaxis],_=y._length,S=_>=g,C=2*_,k={},L=E.makeCalcdata(y,"x"),I=M.makeCalcdata(y,"y"),R=e(y,E,"x",L),V=e(y,M,"y",I);y._x=R,y._y=V,y.xperiodalignment&&(y._origX=L),y.yperiodalignment&&(y._origY=I);var O=new Array(C);for(v=0;v<_;v++)T=R[v],w=V[v],O[2*v]=T===f?NaN:T,O[2*v+1]=w===f?NaN:w;if(E.type==="log")for(v=0;v<C;v+=2)O[v]=E.c2l(O[v]);if(M.type==="log")for(v=1;v<C;v+=2)O[v]=M.c2l(O[v]);if(S&&E.type!=="log"&&M.type!=="log")k.tree=t(O);else{var J=k.ids=new Array(_);for(v=0;v<_;v++)J[v]=v}s(m,y);var D,B=function(F,H,j,G,W,Q){var $=a.style(F,j);if($.marker&&($.marker.positions=G),$.line&&G.length>1&&h.extendFlat($.line,a.linePositions(F,j,G)),$.errorX||$.errorY){var ee=a.errorBarPositions(F,j,G,W,Q);$.errorX&&h.extendFlat($.errorX,ee.x),$.errorY&&h.extendFlat($.errorY,ee.y)}return $.text&&(h.extendFlat($.text,{positions:G},a.textPosition(F,j,$.text,$.marker)),h.extendFlat($.textSel,{positions:G},a.textPosition(F,j,$.text,$.markerSel)),h.extendFlat($.textUnsel,{positions:G},a.textPosition(F,j,$.text,$.markerUnsel))),$}(m,0,y,O,R,V),N=c(m,b);return u(A,y),S?B.marker&&(D=2*(B.marker.sizeAvg||Math.max(B.marker.size,3))):D=r(y,_),i(m,y,E,M,R,V,D),B.errorX&&d(y,E,B.errorX),B.errorY&&d(y,M,B.errorY),B.fill&&!N.fill2d&&(N.fill2d=!0),B.marker&&!N.scatter2d&&(N.scatter2d=!0),B.line&&!N.line2d&&(N.line2d=!0),!B.errorX&&!B.errorY||N.error2d||(N.error2d=!0),B.text&&!N.glText&&(N.glText=!0),B.marker&&(B.marker.snap=_),N.lineOptions.push(B.line),N.errorXOptions.push(B.errorX),N.errorYOptions.push(B.errorY),N.fillOptions.push(B.fill),N.markerOptions.push(B.marker),N.markerSelectedOptions.push(B.markerSel),N.markerUnselectedOptions.push(B.markerUnsel),N.textOptions.push(B.text),N.textSelectedOptions.push(B.textSel),N.textUnselectedOptions.push(B.textUnsel),N.selectBatch.push([]),N.unselectBatch.push([]),k._scene=N,k.index=N.count,k.x=R,k.y=V,k.positions=O,N.count++,[{x:!1,y:!1,t:k,trace:y}]}},{"../../constants/numerical":753,"../../lib":778,"../../plots/cartesian/align_period":825,"../../plots/cartesian/autorange":827,"../../plots/cartesian/axis_ids":831,"../scatter/calc":1188,"../scatter/colorscale_calc":1190,"./constants":1241,"./convert":1242,"./scene_update":1250,"@plotly/point-cluster":57}],1241:[function(n,z,q){"use strict";z.exports={TOO_MANY_POINTS:1e5,SYMBOL_SDF_SIZE:200,SYMBOL_SIZE:20,SYMBOL_STROKE:1,DOT_RE:/-dot/,OPEN_RE:/-open/,DASHES:{solid:[1],dot:[1,1],dash:[4,1],longdash:[8,1],dashdot:[4,1,1,1],longdashdot:[8,1,1,1]}}},{}],1242:[function(n,z,q){"use strict";var t=n("fast-isnumeric"),h=n("svg-path-sdf"),p=n("color-normalize"),l=n("../../registry"),e=n("../../lib"),o=n("../../components/drawing"),r=n("../../plots/cartesian/axis_ids"),i=n("../../lib/gl_format_color").formatColor,u=n("../scatter/subtypes"),s=n("../scatter/make_bubble_size_func"),a=n("./helpers"),c=n("./constants"),f=n("../../constants/interactions").DESELECTDIM,g={start:1,left:1,end:-1,right:-1,middle:0,center:0,bottom:1,top:-1},d=n("../../components/fx/helpers").appendArrayPointValue;function m(C,k){var L,I=C._fullLayout,R=k._length,V=k.textfont,O=k.textposition,J=Array.isArray(O)?O:[O],D=V.color,B=V.size,N=V.family,F={},H=k.texttemplate;if(H){F.text=[];var j=I._d3locale,G=Array.isArray(H),W=G?Math.min(H.length,R):R,Q=G?function(le){return H[le]}:function(){return H};for(L=0;L<W;L++){var $={i:L},ee=k._module.formatLabels($,k,I),ie={};d(ie,k,L);var ae=k._meta||{};F.text.push(e.texttemplateString(Q(L),ee,j,ie,$,ae))}}else Array.isArray(k.text)&&k.text.length<R?F.text=k.text.slice():F.text=k.text;if(Array.isArray(F.text))for(L=F.text.length;L<R;L++)F.text[L]="";for(F.opacity=k.opacity,F.font={},F.align=[],F.baseline=[],L=0;L<J.length;L++){var oe=J[L].split(/\s+/);switch(oe[1]){case"left":F.align.push("right");break;case"right":F.align.push("left");break;default:F.align.push(oe[1])}switch(oe[0]){case"top":F.baseline.push("bottom");break;case"bottom":F.baseline.push("top");break;default:F.baseline.push(oe[0])}}if(Array.isArray(D))for(F.color=new Array(R),L=0;L<R;L++)F.color[L]=D[L];else F.color=D;if(e.isArrayOrTypedArray(B)||Array.isArray(N))for(F.font=new Array(R),L=0;L<R;L++){var de=F.font[L]={};de.size=e.isTypedArray(B)?B[L]:Array.isArray(B)?t(B[L])?B[L]:0:B,de.family=Array.isArray(N)?N[L]:N}else F.font={size:B,family:N};return F}function y(C){var k,L,I=C._length,R=C.marker,V={},O=e.isArrayOrTypedArray(R.symbol),J=e.isArrayOrTypedArray(R.color),D=e.isArrayOrTypedArray(R.line.color),B=e.isArrayOrTypedArray(R.opacity),N=e.isArrayOrTypedArray(R.size),F=e.isArrayOrTypedArray(R.line.width);if(O||(L=a.isOpenSymbol(R.symbol)),O||J||D||B){V.colors=new Array(I),V.borderColors=new Array(I);var H=i(R,R.opacity,I),j=i(R.line,R.opacity,I);if(!Array.isArray(j[0])){var G=j;for(j=Array(I),k=0;k<I;k++)j[k]=G}if(!Array.isArray(H[0])){var W=H;for(H=Array(I),k=0;k<I;k++)H[k]=W}for(V.colors=H,V.borderColors=j,k=0;k<I;k++){if(O){var Q=R.symbol[k];L=a.isOpenSymbol(Q)}L&&(j[k]=H[k].slice(),H[k]=H[k].slice(),H[k][3]=0)}V.opacity=C.opacity}else L?(V.color=p(R.color,"uint8"),V.color[3]=0,V.borderColor=p(R.color,"uint8")):(V.color=p(R.color,"uint8"),V.borderColor=p(R.line.color,"uint8")),V.opacity=C.opacity*R.opacity;if(O)for(V.markers=new Array(I),k=0;k<I;k++)V.markers[k]=S(R.symbol[k]);else V.marker=S(R.symbol);var $,ee=s(C);if(N||F){var ie,ae=V.sizes=new Array(I),oe=V.borderSizes=new Array(I),de=0;if(N){for(k=0;k<I;k++)ae[k]=ee(R.size[k]),de+=ae[k];ie=de/I}else for($=ee(R.size),k=0;k<I;k++)ae[k]=$;if(F)for(k=0;k<I;k++)oe[k]=R.line.width[k]/2;else for($=R.line.width/2,k=0;k<I;k++)oe[k]=$;V.sizeAvg=ie}else V.size=ee(R&&R.size||10),V.borderSizes=ee(R.line.width);return V}function v(C,k){var L=C.marker,I={};return k&&(k.marker&&k.marker.symbol?I=y(e.extendFlat({},L,k.marker)):k.marker&&(k.marker.size&&(I.size=k.marker.size/2),k.marker.color&&(I.colors=k.marker.color),k.marker.opacity!==void 0&&(I.opacity=k.marker.opacity))),I}function T(C,k,L){var I={};if(!L)return I;if(L.textfont){var R={opacity:1,text:k.text,texttemplate:k.texttemplate,textposition:k.textposition,textfont:e.extendFlat({},k.textfont)};L.textfont&&e.extendFlat(R.textfont,L.textfont),I=m(C,R)}return I}function w(C,k){var L={capSize:2*k.width,lineWidth:k.thickness,color:k.color};return k.copy_ystyle&&(L=C.error_y),L}var A=c.SYMBOL_SDF_SIZE,E=c.SYMBOL_SIZE,M=c.SYMBOL_STROKE,b={},_=o.symbolFuncs[0](.05*E);function S(C){if(C==="circle")return null;var k,L,I=o.symbolNumber(C),R=o.symbolFuncs[I%100],V=!!o.symbolNoDot[I%100],O=!!o.symbolNoFill[I%100],J=a.isDotSymbol(C);return b[C]?b[C]:(k=J&&!V?R(1.1*E)+_:R(E),L=h(k,{w:A,h:A,viewBox:[-E,-E,E,E],stroke:O?M:-M}),b[C]=L,L||null)}z.exports={style:function(C,k){var L,I={marker:void 0,markerSel:void 0,markerUnsel:void 0,line:void 0,fill:void 0,errorX:void 0,errorY:void 0,text:void 0,textSel:void 0,textUnsel:void 0};if(k.visible!==!0)return I;if(u.hasText(k)&&(I.text=m(C,k),I.textSel=T(C,k,k.selected),I.textUnsel=T(C,k,k.unselected)),u.hasMarkers(k)&&(I.marker=y(k),I.markerSel=v(k,k.selected),I.markerUnsel=v(k,k.unselected),!k.unselected&&e.isArrayOrTypedArray(k.marker.opacity))){var R=k.marker.opacity;for(I.markerUnsel.opacity=new Array(R.length),L=0;L<R.length;L++)I.markerUnsel.opacity[L]=f*R[L]}if(u.hasLines(k)){I.line={overlay:!0,thickness:k.line.width,color:k.line.color,opacity:k.opacity};var V=(c.DASHES[k.line.dash]||[1]).slice();for(L=0;L<V.length;++L)V[L]*=k.line.width;I.line.dashes=V}return k.error_x&&k.error_x.visible&&(I.errorX=w(k,k.error_x)),k.error_y&&k.error_y.visible&&(I.errorY=w(k,k.error_y)),k.fill&&k.fill!=="none"&&(I.fill={closed:!0,fill:k.fillcolor,thickness:0}),I},markerStyle:y,markerSelection:v,linePositions:function(C,k,L){var I,R,V=L.length,O=V/2;if(u.hasLines(k)&&O)if(k.line.shape==="hv"){for(I=[],R=0;R<O-1;R++)isNaN(L[2*R])||isNaN(L[2*R+1])?I.push(NaN,NaN,NaN,NaN):(I.push(L[2*R],L[2*R+1]),isNaN(L[2*R+2])||isNaN(L[2*R+3])?I.push(NaN,NaN):I.push(L[2*R+2],L[2*R+1]));I.push(L[V-2],L[V-1])}else if(k.line.shape==="hvh"){for(I=[],R=0;R<O-1;R++)if(isNaN(L[2*R])||isNaN(L[2*R+1])||isNaN(L[2*R+2])||isNaN(L[2*R+3]))isNaN(L[2*R])||isNaN(L[2*R+1])?I.push(NaN,NaN):I.push(L[2*R],L[2*R+1]),I.push(NaN,NaN);else{var J=(L[2*R]+L[2*R+2])/2;I.push(L[2*R],L[2*R+1],J,L[2*R+1],J,L[2*R+3])}I.push(L[V-2],L[V-1])}else if(k.line.shape==="vhv"){for(I=[],R=0;R<O-1;R++)if(isNaN(L[2*R])||isNaN(L[2*R+1])||isNaN(L[2*R+2])||isNaN(L[2*R+3]))isNaN(L[2*R])||isNaN(L[2*R+1])?I.push(NaN,NaN):I.push(L[2*R],L[2*R+1]),I.push(NaN,NaN);else{var D=(L[2*R+1]+L[2*R+3])/2;I.push(L[2*R],L[2*R+1],L[2*R],D,L[2*R+2],D)}I.push(L[V-2],L[V-1])}else if(k.line.shape==="vh"){for(I=[],R=0;R<O-1;R++)isNaN(L[2*R])||isNaN(L[2*R+1])?I.push(NaN,NaN,NaN,NaN):(I.push(L[2*R],L[2*R+1]),isNaN(L[2*R+2])||isNaN(L[2*R+3])?I.push(NaN,NaN):I.push(L[2*R],L[2*R+3]));I.push(L[V-2],L[V-1])}else I=L;var B=!1;for(R=0;R<I.length;R++)if(isNaN(I[R])){B=!0;break}var N=B||I.length>c.TOO_MANY_POINTS||u.hasMarkers(k)?"rect":"round";if(B&&k.connectgaps){var F=I[0],H=I[1];for(R=0;R<I.length;R+=2)isNaN(I[R])||isNaN(I[R+1])?(I[R]=F,I[R+1]=H):(F=I[R],H=I[R+1])}return{join:N,positions:I}},errorBarPositions:function(C,k,L,I,R){var V=l.getComponentMethod("errorbars","makeComputeError"),O=r.getFromId(C,k.xaxis),J=r.getFromId(C,k.yaxis),D=L.length/2,B={};function N(F,H){var j=H._id.charAt(0),G=k["error_"+j];if(G&&G.visible&&(H.type==="linear"||H.type==="log")){for(var W=V(G),Q={x:0,y:1}[j],$={x:[0,1,2,3],y:[2,3,0,1]}[j],ee=new Float64Array(4*D),ie=1/0,ae=-1/0,oe=0,de=0;oe<D;oe++,de+=4){var le=F[oe];if(t(le)){var fe=L[2*oe+Q],ue=W(le,oe),we=ue[0],Ae=ue[1];if(t(we)&&t(Ae)){var Se=le-we,ke=le+Ae;ee[de+$[0]]=fe-H.c2l(Se),ee[de+$[1]]=H.c2l(ke)-fe,ee[de+$[2]]=0,ee[de+$[3]]=0,ie=Math.min(ie,le-we),ae=Math.max(ae,le+Ae)}}}B[j]={positions:L,errors:ee,_bnds:[ie,ae]}}}return N(I,O),N(R,J),B},textPosition:function(C,k,L,I){var R,V=k._length,O={};if(u.hasMarkers(k)){var J=L.font,D=L.align,B=L.baseline;for(O.offset=new Array(V),R=0;R<V;R++){var N=I.sizes?I.sizes[R]:I.size,F=Array.isArray(J)?J[R].size:J.size,H=Array.isArray(D)?D.length>1?D[R]:D[0]:D,j=Array.isArray(B)?B.length>1?B[R]:B[0]:B,G=g[H],W=g[j],Q=N?N/.8+1:0,$=-W*Q-.5*W;O.offset[R]=[G*Q/F,$/F]}}return O}}},{"../../components/drawing":665,"../../components/fx/helpers":679,"../../constants/interactions":752,"../../lib":778,"../../lib/gl_format_color":774,"../../plots/cartesian/axis_ids":831,"../../registry":911,"../scatter/make_bubble_size_func":1204,"../scatter/subtypes":1212,"./constants":1241,"./helpers":1246,"color-normalize":125,"fast-isnumeric":241,"svg-path-sdf":574}],1243:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../../registry"),p=n("./helpers"),l=n("./attributes"),e=n("../scatter/constants"),o=n("../scatter/subtypes"),r=n("../scatter/xy_defaults"),i=n("../scatter/period_defaults"),u=n("../scatter/marker_defaults"),s=n("../scatter/line_defaults"),a=n("../scatter/fillcolor_defaults"),c=n("../scatter/text_defaults");z.exports=function(f,g,d,m){function y(_,S){return t.coerce(f,g,l,_,S)}var v=!!f.marker&&p.isOpenSymbol(f.marker.symbol),T=o.isBubble(f),w=r(f,g,m,y);if(w){i(f,g,m,y);var A=w<e.PTS_LINESONLY?"lines+markers":"lines";y("text"),y("hovertext"),y("hovertemplate"),y("mode",A),o.hasLines(g)&&(y("connectgaps"),s(f,g,d,m,y),y("line.shape")),o.hasMarkers(g)&&(u(f,g,d,m,y),y("marker.line.width",v||T?1:0)),o.hasText(g)&&(y("texttemplate"),c(f,g,m,y));var E=(g.line||{}).color,M=(g.marker||{}).color;y("fill"),g.fill!=="none"&&a(f,g,d,y);var b=h.getComponentMethod("errorbars","supplyDefaults");b(f,g,E||M||d,{axis:"y"}),b(f,g,E||M||d,{axis:"x",inherit:"y"}),t.coerceSelectionMarkerOpacity(g,y)}else g.visible=!1}},{"../../lib":778,"../../registry":911,"../scatter/constants":1191,"../scatter/fillcolor_defaults":1195,"../scatter/line_defaults":1200,"../scatter/marker_defaults":1206,"../scatter/period_defaults":1207,"../scatter/subtypes":1212,"../scatter/text_defaults":1213,"../scatter/xy_defaults":1214,"./attributes":1239,"./helpers":1246}],1244:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../../components/color"),p=n("../../constants/interactions").DESELECTDIM;z.exports={styleTextSelection:function(l){var e,o,r=l[0],i=r.trace,u=r.t,s=u._scene,a=u.index,c=s.selectBatch[a],f=s.unselectBatch[a],g=s.textOptions[a],d=s.textSelectedOptions[a]||{},m=s.textUnselectedOptions[a]||{},y=t.extendFlat({},g);if(c.length||f.length){var v=d.color,T=m.color,w=g.color,A=Array.isArray(w);for(y.color=new Array(i._length),e=0;e<c.length;e++)o=c[e],y.color[o]=v||(A?w[o]:w);for(e=0;e<f.length;e++){o=f[e];var E=A?w[o]:w;y.color[o]=T||(v?E:h.addOpacity(E,p))}}s.glText[a].update(y)}}},{"../../components/color":643,"../../constants/interactions":752,"../../lib":778}],1245:[function(n,z,q){"use strict";var t=n("../scatter/format_labels");z.exports=function(h,p,l){var e=h.i;return"x"in h||(h.x=p._x[e]),"y"in h||(h.y=p._y[e]),t(h,p,l)}},{"../scatter/format_labels":1196}],1246:[function(n,z,q){"use strict";var t=n("./constants");q.isOpenSymbol=function(h){return typeof h=="string"?t.OPEN_RE.test(h):h%200>100},q.isDotSymbol=function(h){return typeof h=="string"?t.DOT_RE.test(h):h>200}},{"./constants":1241}],1247:[function(n,z,q){"use strict";var t=n("../../registry"),h=n("../../lib"),p=n("../scatter/get_trace_color");function l(e,o,r,i){var u=e.xa,s=e.ya,a=e.distance,c=e.dxy,f=e.index,g={pointNumber:f,x:o[f],y:r[f]};g.tx=Array.isArray(i.text)?i.text[f]:i.text,g.htx=Array.isArray(i.hovertext)?i.hovertext[f]:i.hovertext,g.data=Array.isArray(i.customdata)?i.customdata[f]:i.customdata,g.tp=Array.isArray(i.textposition)?i.textposition[f]:i.textposition;var d=i.textfont;d&&(g.ts=h.isArrayOrTypedArray(d.size)?d.size[f]:d.size,g.tc=Array.isArray(d.color)?d.color[f]:d.color,g.tf=Array.isArray(d.family)?d.family[f]:d.family);var m=i.marker;m&&(g.ms=h.isArrayOrTypedArray(m.size)?m.size[f]:m.size,g.mo=h.isArrayOrTypedArray(m.opacity)?m.opacity[f]:m.opacity,g.mx=h.isArrayOrTypedArray(m.symbol)?m.symbol[f]:m.symbol,g.mc=h.isArrayOrTypedArray(m.color)?m.color[f]:m.color);var y=m&&m.line;y&&(g.mlc=Array.isArray(y.color)?y.color[f]:y.color,g.mlw=h.isArrayOrTypedArray(y.width)?y.width[f]:y.width);var v=m&&m.gradient;v&&v.type!=="none"&&(g.mgt=Array.isArray(v.type)?v.type[f]:v.type,g.mgc=Array.isArray(v.color)?v.color[f]:v.color);var T=u.c2p(g.x,!0),w=s.c2p(g.y,!0),A=g.mrc||1,E=i.hoverlabel;E&&(g.hbg=Array.isArray(E.bgcolor)?E.bgcolor[f]:E.bgcolor,g.hbc=Array.isArray(E.bordercolor)?E.bordercolor[f]:E.bordercolor,g.hts=h.isArrayOrTypedArray(E.font.size)?E.font.size[f]:E.font.size,g.htc=Array.isArray(E.font.color)?E.font.color[f]:E.font.color,g.htf=Array.isArray(E.font.family)?E.font.family[f]:E.font.family,g.hnl=h.isArrayOrTypedArray(E.namelength)?E.namelength[f]:E.namelength);var M=i.hoverinfo;M&&(g.hi=Array.isArray(M)?M[f]:M);var b=i.hovertemplate;b&&(g.ht=Array.isArray(b)?b[f]:b);var _={};_[e.index]=g;var S=i._origX,C=i._origY,k=h.extendFlat({},e,{color:p(i,g),x0:T-A,x1:T+A,xLabelVal:S?S[f]:g.x,y0:w-A,y1:w+A,yLabelVal:C?C[f]:g.y,cd:_,distance:a,spikeDistance:c,hovertemplate:g.ht});return g.htx?k.text=g.htx:g.tx?k.text=g.tx:i.text&&(k.text=i.text),h.fillText(g,i,k),t.getComponentMethod("errorbars","hoverInfo")(g,i,k),k}z.exports={hoverPoints:function(e,o,r,i){var u,s,a,c,f,g,d,m,y,v=e.cd,T=v[0].t,w=v[0].trace,A=e.xa,E=e.ya,M=T.x,b=T.y,_=A.c2p(o),S=E.c2p(r),C=e.distance;if(T.tree){var k=A.p2c(_-C),L=A.p2c(_+C),I=E.p2c(S-C),R=E.p2c(S+C);u=i==="x"?T.tree.range(Math.min(k,L),Math.min(E._rl[0],E._rl[1]),Math.max(k,L),Math.max(E._rl[0],E._rl[1])):T.tree.range(Math.min(k,L),Math.min(I,R),Math.max(k,L),Math.max(I,R))}else u=T.ids;var V=C;if(i==="x")for(f=0;f<u.length;f++)a=M[u[f]],(g=Math.abs(A.c2p(a)-_))<V&&(V=g,d=E.c2p(b[u[f]])-S,y=Math.sqrt(g*g+d*d),s=u[f]);else for(f=u.length-1;f>-1;f--)a=M[u[f]],c=b[u[f]],g=A.c2p(a)-_,d=E.c2p(c)-S,(m=Math.sqrt(g*g+d*d))<V&&(V=y=m,s=u[f]);return e.index=s,e.distance=V,e.dxy=y,s===void 0?[e]:[l(e,M,b,w)]},calcHover:l}},{"../../lib":778,"../../registry":911,"../scatter/get_trace_color":1197}],1248:[function(n,z,q){"use strict";var t=n("./hover");z.exports={moduleType:"trace",name:"scattergl",basePlotModule:n("../../plots/cartesian"),categories:["gl","regl","cartesian","symbols","errorBarsOK","showLegend","scatter-like"],attributes:n("./attributes"),supplyDefaults:n("./defaults"),crossTraceDefaults:n("../scatter/cross_trace_defaults"),colorbar:n("../scatter/marker_colorbar"),formatLabels:n("./format_labels"),calc:n("./calc"),plot:n("./plot"),hoverPoints:t.hoverPoints,selectPoints:n("./select"),meta:{}}},{"../../plots/cartesian":841,"../scatter/cross_trace_defaults":1193,"../scatter/marker_colorbar":1205,"./attributes":1239,"./calc":1240,"./defaults":1243,"./format_labels":1245,"./hover":1247,"./plot":1249,"./select":1251}],1249:[function(n,z,q){"use strict";var t=n("regl-scatter2d"),h=n("regl-line2d"),p=n("regl-error2d"),l=n("gl-text"),e=n("../../lib"),o=n("../../components/dragelement/helpers").selectMode,r=n("../../lib/prepare_regl"),i=n("../scatter/subtypes"),u=n("../scatter/link_traces"),s=n("./edit_style").styleTextSelection;function a(c,f,g){var d=c._size,m=c.width,y=c.height;return[d.l+f.domain[0]*d.w,d.b+g.domain[0]*d.h,m-d.r-(1-f.domain[1])*d.w,y-d.t-(1-g.domain[1])*d.h]}z.exports=function(c,f,g){if(g.length){var d,m,y=c._fullLayout,v=f._scene,T=f.xaxis,w=f.yaxis;if(v)if(r(c,["ANGLE_instanced_arrays","OES_element_index_uint"])){var A=v.count,E=y._glcanvas.data()[0].regl;if(u(c,f,g),v.dirty){if(v.error2d===!0&&(v.error2d=p(E)),v.line2d===!0&&(v.line2d=h(E)),v.scatter2d===!0&&(v.scatter2d=t(E,{constPointSize:!0})),v.fill2d===!0&&(v.fill2d=h(E)),v.glText===!0)for(v.glText=new Array(A),d=0;d<A;d++)v.glText[d]=new l(E);if(v.glText){if(A>v.glText.length){var M=A-v.glText.length;for(d=0;d<M;d++)v.glText.push(new l(E))}else if(A<v.glText.length){var b=v.glText.length-A;v.glText.splice(A,b).forEach(function($){$.destroy()})}for(d=0;d<A;d++)v.glText[d].update(v.textOptions[d])}if(v.line2d&&(v.line2d.update(v.lineOptions),v.lineOptions=v.lineOptions.map(function($){if($&&$.positions){for(var ee=$.positions,ie=0;ie<ee.length&&(isNaN(ee[ie])||isNaN(ee[ie+1]));)ie+=2;for(var ae=ee.length-2;ae>ie&&(isNaN(ee[ae])||isNaN(ee[ae+1]));)ae-=2;$.positions=ee.slice(ie,ae+2)}return $}),v.line2d.update(v.lineOptions)),v.error2d){var _=(v.errorXOptions||[]).concat(v.errorYOptions||[]);v.error2d.update(_)}v.scatter2d&&v.scatter2d.update(v.markerOptions),v.fillOrder=e.repeat(null,A),v.fill2d&&(v.fillOptions=v.fillOptions.map(function($,ee){var ie=g[ee];if($&&ie&&ie[0]&&ie[0].trace){var ae,oe,de=ie[0],le=de.trace,fe=de.t,ue=v.lineOptions[ee],we=[];le._ownfill&&we.push(ee),le._nexttrace&&we.push(ee+1),we.length&&(v.fillOrder[ee]=we);var Ae,Se,ke=[],Me=ue&&ue.positions||fe.positions;if(le.fill==="tozeroy"){for(Ae=0;Ae<Me.length&&isNaN(Me[Ae+1]);)Ae+=2;for(Se=Me.length-2;Se>Ae&&isNaN(Me[Se+1]);)Se-=2;Me[Ae+1]!==0&&(ke=[Me[Ae],0]),ke=ke.concat(Me.slice(Ae,Se+2)),Me[Se+1]!==0&&(ke=ke.concat([Me[Se],0]))}else if(le.fill==="tozerox"){for(Ae=0;Ae<Me.length&&isNaN(Me[Ae]);)Ae+=2;for(Se=Me.length-2;Se>Ae&&isNaN(Me[Se]);)Se-=2;Me[Ae]!==0&&(ke=[0,Me[Ae+1]]),ke=ke.concat(Me.slice(Ae,Se+2)),Me[Se]!==0&&(ke=ke.concat([0,Me[Se+1]]))}else if(le.fill==="toself"||le.fill==="tonext"){for(ke=[],ae=0,oe=0;oe<Me.length;oe+=2)(isNaN(Me[oe])||isNaN(Me[oe+1]))&&((ke=ke.concat(Me.slice(ae,oe))).push(Me[ae],Me[ae+1]),ae=oe+2);ke=ke.concat(Me.slice(ae)),ae&&ke.push(Me[ae],Me[ae+1])}else{var ve=le._nexttrace;if(ve){var ge=v.lineOptions[ee+1];if(ge){var De=ge.positions;if(le.fill==="tonexty"){for(ke=Me.slice(),ee=Math.floor(De.length/2);ee--;){var _e=De[2*ee],Pe=De[2*ee+1];isNaN(_e)||isNaN(Pe)||ke.push(_e,Pe)}$.fill=ve.fillcolor}}}}if(le._prevtrace&&le._prevtrace.fill==="tonext"){var Fe=v.lineOptions[ee-1].positions,ze=ke.length/2,He=[ae=ze];for(oe=0;oe<Fe.length;oe+=2)(isNaN(Fe[oe])||isNaN(Fe[oe+1]))&&(He.push(oe/2+ze+1),ae=oe+2);ke=ke.concat(Fe),$.hole=He}return $.fillmode=le.fill,$.opacity=le.opacity,$.positions=ke,$}}),v.fill2d.update(v.fillOptions))}var S=y.dragmode,C=o(S),k=y.clickmode.indexOf("select")>-1;for(d=0;d<A;d++){var L=g[d][0],I=L.trace,R=L.t,V=R.index,O=I._length,J=R.x,D=R.y;if(I.selectedpoints||C||k){if(C||(C=!0),I.selectedpoints){var B=v.selectBatch[V]=e.selIndices2selPoints(I),N={};for(m=0;m<B.length;m++)N[B[m]]=1;var F=[];for(m=0;m<O;m++)N[m]||F.push(m);v.unselectBatch[V]=F}var H=R.xpx=new Array(O),j=R.ypx=new Array(O);for(m=0;m<O;m++)H[m]=T.c2p(J[m]),j[m]=w.c2p(D[m])}else R.xpx=R.ypx=null}if(C){if(v.select2d||(v.select2d=t(y._glcanvas.data()[1].regl)),v.scatter2d){var G=new Array(A);for(d=0;d<A;d++)G[d]=v.selectBatch[d].length||v.unselectBatch[d].length?v.markerUnselectedOptions[d]:{};v.scatter2d.update(G)}v.select2d&&(v.select2d.update(v.markerOptions),v.select2d.update(v.markerSelectedOptions)),v.glText&&g.forEach(function($){var ee=(($||[])[0]||{}).trace||{};i.hasText(ee)&&s($)})}else v.scatter2d&&v.scatter2d.update(v.markerOptions);var W={viewport:a(y,T,w),range:[(T._rl||T.range)[0],(w._rl||w.range)[0],(T._rl||T.range)[1],(w._rl||w.range)[1]]},Q=e.repeat(W,v.count);v.fill2d&&v.fill2d.update(Q),v.line2d&&v.line2d.update(Q),v.error2d&&v.error2d.update(Q.concat(Q)),v.scatter2d&&v.scatter2d.update(Q),v.select2d&&v.select2d.update(Q),v.glText&&v.glText.forEach(function($){$.update(W)})}else v.init()}}},{"../../components/dragelement/helpers":661,"../../lib":778,"../../lib/prepare_regl":791,"../scatter/link_traces":1203,"../scatter/subtypes":1212,"./edit_style":1244,"gl-text":352,"regl-error2d":534,"regl-line2d":535,"regl-scatter2d":537}],1250:[function(n,z,q){"use strict";var t=n("../../lib");z.exports=function(h,p){var l=p._scene,e={count:0,dirty:!0,lineOptions:[],fillOptions:[],markerOptions:[],markerSelectedOptions:[],markerUnselectedOptions:[],errorXOptions:[],errorYOptions:[],textOptions:[],textSelectedOptions:[],textUnselectedOptions:[],selectBatch:[],unselectBatch:[]},o={fill2d:!1,scatter2d:!1,error2d:!1,line2d:!1,glText:!1,select2d:!1};return p._scene||((l=p._scene={}).init=function(){t.extendFlat(l,o,e)},l.init(),l.update=function(r){var i=t.repeat(r,l.count);if(l.fill2d&&l.fill2d.update(i),l.scatter2d&&l.scatter2d.update(i),l.line2d&&l.line2d.update(i),l.error2d&&l.error2d.update(i.concat(i)),l.select2d&&l.select2d.update(i),l.glText)for(var u=0;u<l.count;u++)l.glText[u].update(r)},l.draw=function(){for(var r=l.count,i=l.fill2d,u=l.error2d,s=l.line2d,a=l.scatter2d,c=l.glText,f=l.select2d,g=l.selectBatch,d=l.unselectBatch,m=0;m<r;m++){if(i&&l.fillOrder[m]&&i.draw(l.fillOrder[m]),s&&l.lineOptions[m]&&s.draw(m),u&&(l.errorXOptions[m]&&u.draw(m),l.errorYOptions[m]&&u.draw(m+r)),a&&l.markerOptions[m])if(d[m].length){var y=t.repeat([],l.count);y[m]=d[m],a.draw(y)}else g[m].length||a.draw(m);c[m]&&l.textOptions[m]&&c[m].render()}f&&f.draw(g),l.dirty=!1},l.destroy=function(){l.fill2d&&l.fill2d.destroy&&l.fill2d.destroy(),l.scatter2d&&l.scatter2d.destroy&&l.scatter2d.destroy(),l.error2d&&l.error2d.destroy&&l.error2d.destroy(),l.line2d&&l.line2d.destroy&&l.line2d.destroy(),l.select2d&&l.select2d.destroy&&l.select2d.destroy(),l.glText&&l.glText.forEach(function(r){r.destroy&&r.destroy()}),l.lineOptions=null,l.fillOptions=null,l.markerOptions=null,l.markerSelectedOptions=null,l.markerUnselectedOptions=null,l.errorXOptions=null,l.errorYOptions=null,l.textOptions=null,l.textSelectedOptions=null,l.textUnselectedOptions=null,l.selectBatch=null,l.unselectBatch=null,p._scene=null}),l.dirty||t.extendFlat(l,e),l}},{"../../lib":778}],1251:[function(n,z,q){"use strict";var t=n("../scatter/subtypes"),h=n("./edit_style").styleTextSelection;z.exports=function(p,l){var e=p.cd,o=[],r=e[0].trace,i=e[0].t,u=r._length,s=i.x,a=i.y,c=i._scene,f=i.index;if(!c)return o;var g=t.hasText(r),d=t.hasMarkers(r),m=!d&&!g;if(r.visible!==!0||m)return o;var y=[],v=[];if(l!==!1&&!l.degenerate)for(var T=0;T<u;T++)l.contains([i.xpx[T],i.ypx[T]],!1,T,p)?(y.push(T),o.push({pointNumber:T,x:s[T],y:a[T]})):v.push(T);if(d){var w=c.scatter2d;if(y.length||v.length){if(!c.selectBatch[f].length&&!c.unselectBatch[f].length){var A=new Array(c.count);A[f]=c.markerUnselectedOptions[f],w.update.apply(w,A)}}else{var E=new Array(c.count);E[f]=c.markerOptions[f],w.update.apply(w,E)}}return c.selectBatch[f]=y,c.unselectBatch[f]=v,g&&h(e),o}},{"../scatter/subtypes":1212,"./edit_style":1244}],1252:[function(n,z,q){"use strict";var t=n("../../plots/template_attributes").hovertemplateAttrs,h=n("../../plots/template_attributes").texttemplateAttrs,p=n("../scattergeo/attributes"),l=n("../scatter/attributes"),e=n("../../plots/mapbox/layout_attributes"),o=n("../../plots/attributes"),r=n("../../components/colorscale/attributes"),i=n("../../lib/extend").extendFlat,u=n("../../plot_api/edit_types").overrideAll,s=p.line,a=p.marker;z.exports=u({lon:p.lon,lat:p.lat,mode:i({},l.mode,{dflt:"markers"}),text:i({},l.text,{}),texttemplate:h({editType:"plot"},{keys:["lat","lon","text"]}),hovertext:i({},l.hovertext,{}),line:{color:s.color,width:s.width},connectgaps:l.connectgaps,marker:i({symbol:{valType:"string",dflt:"circle",arrayOk:!0},angle:{valType:"number",dflt:"auto",arrayOk:!0},allowoverlap:{valType:"boolean",dflt:!1},opacity:a.opacity,size:a.size,sizeref:a.sizeref,sizemin:a.sizemin,sizemode:a.sizemode},r("marker")),fill:p.fill,fillcolor:l.fillcolor,textfont:e.layers.symbol.textfont,textposition:e.layers.symbol.textposition,below:{valType:"string"},selected:{marker:l.selected.marker},unselected:{marker:l.unselected.marker},hoverinfo:i({},o.hoverinfo,{flags:["lon","lat","text","name"]}),hovertemplate:t()},"calc","nested")},{"../../components/colorscale/attributes":650,"../../lib/extend":768,"../../plot_api/edit_types":810,"../../plots/attributes":824,"../../plots/mapbox/layout_attributes":887,"../../plots/template_attributes":906,"../scatter/attributes":1187,"../scattergeo/attributes":1229}],1253:[function(n,z,q){"use strict";var t=n("fast-isnumeric"),h=n("../../lib"),p=n("../../constants/numerical").BADNUM,l=n("../../lib/geojson_utils"),e=n("../../components/colorscale"),o=n("../../components/drawing"),r=n("../scatter/make_bubble_size_func"),i=n("../scatter/subtypes"),u=n("../../plots/mapbox/convert_text_opts"),s=n("../../components/fx/helpers").appendArrayPointValue,a=n("../../lib/svg_text_utils").NEWLINES,c=n("../../lib/svg_text_utils").BR_TAG_ALL;function f(){return{geojson:l.makeBlank(),layout:{visibility:"none"},paint:{}}}function g(y,v){return h.isArrayOrTypedArray(y)?v?function(T){return t(y[T])?+y[T]:0}:function(T){return y[T]}:y?function(){return y}:d}function d(){return""}function m(y){return y[0]===p}z.exports=function(y,v){var T,w=v[0].trace,A=w.visible===!0&&w._length!==0,E=w.fill!=="none",M=i.hasLines(w),b=i.hasMarkers(w),_=i.hasText(w),S=b&&w.marker.symbol==="circle",C=b&&w.marker.symbol!=="circle",k=f(),L=f(),I=f(),R=f(),V={fill:k,line:L,circle:I,symbol:R};if(!A)return V;if((E||M)&&(T=l.calcTraceToLineCoords(v)),E&&(k.geojson=l.makePolygon(T),k.layout.visibility="visible",h.extendFlat(k.paint,{"fill-color":w.fillcolor})),M&&(L.geojson=l.makeLine(T),L.layout.visibility="visible",h.extendFlat(L.paint,{"line-width":w.line.width,"line-color":w.line.color,"line-opacity":w.opacity})),S){var O=function(B){var N,F,H,j,G=B[0].trace,W=G.marker,Q=G.selectedpoints,$=h.isArrayOrTypedArray(W.color),ee=h.isArrayOrTypedArray(W.size),ie=h.isArrayOrTypedArray(W.opacity);function ae(Se){return G.opacity*Se}$&&(F=e.hasColorscale(G,"marker")?e.makeColorScaleFuncFromTrace(W):h.identity),ee&&(H=r(G)),ie&&(j=function(Se){return ae(t(Se)?+h.constrain(Se,0,1):0)});var oe,de=[];for(N=0;N<B.length;N++){var le=B[N],fe=le.lonlat;if(!m(fe)){var ue={};F&&(ue.mcc=le.mcc=F(le.mc)),H&&(ue.mrc=le.mrc=H(le.ms)),j&&(ue.mo=j(le.mo)),Q&&(ue.selected=le.selected||0),de.push({type:"Feature",geometry:{type:"Point",coordinates:fe},properties:ue})}}if(Q)for(oe=o.makeSelectedPointStyleFns(G),N=0;N<de.length;N++){var we=de[N].properties;oe.selectedOpacityFn&&(we.mo=ae(oe.selectedOpacityFn(we))),oe.selectedColorFn&&(we.mcc=oe.selectedColorFn(we)),oe.selectedSizeFn&&(we.mrc=oe.selectedSizeFn(we))}return{geojson:{type:"FeatureCollection",features:de},mcc:$||oe&&oe.selectedColorFn?{type:"identity",property:"mcc"}:W.color,mrc:ee||oe&&oe.selectedSizeFn?{type:"identity",property:"mrc"}:(Ae=W.size,Ae/2),mo:ie||oe&&oe.selectedOpacityFn?{type:"identity",property:"mo"}:ae(W.opacity)};var Ae}(v);I.geojson=O.geojson,I.layout.visibility="visible",h.extendFlat(I.paint,{"circle-color":O.mcc,"circle-radius":O.mrc,"circle-opacity":O.mo})}if((C||_)&&(R.geojson=function(B,N){for(var F=N._fullLayout,H=B[0].trace,j=H.marker||{},G=j.symbol,W=j.angle,Q=G!=="circle"?g(G):d,$=W!=="auto"?g(W,!0):d,ee=i.hasText(H)?g(H.text):d,ie=[],ae=0;ae<B.length;ae++){var oe=B[ae];if(!m(oe.lonlat)){var de,le=H.texttemplate;if(le){var fe=Array.isArray(le)?le[ae]||"":le,ue=H._module.formatLabels(oe,H,F),we={};s(we,H,oe.i);var Ae=H._meta||{};de=h.texttemplateString(fe,ue,F._d3locale,we,oe,Ae)}else de=ee(ae);de&&(de=de.replace(a,"").replace(c,`
`)),ie.push({type:"Feature",geometry:{type:"Point",coordinates:oe.lonlat},properties:{symbol:Q(ae),angle:$(ae),text:de}})}}return{type:"FeatureCollection",features:ie}}(v,y),h.extendFlat(R.layout,{visibility:"visible","icon-image":"{symbol}-15","text-field":"{text}"}),C&&(h.extendFlat(R.layout,{"icon-size":w.marker.size/10}),"angle"in w.marker&&w.marker.angle!=="auto"&&h.extendFlat(R.layout,{"icon-rotate":{type:"identity",property:"angle"},"icon-rotation-alignment":"map"}),R.layout["icon-allow-overlap"]=w.marker.allowoverlap,h.extendFlat(R.paint,{"icon-opacity":w.opacity*w.marker.opacity,"icon-color":w.marker.color})),_)){var J=(w.marker||{}).size,D=u(w.textposition,J);h.extendFlat(R.layout,{"text-size":w.textfont.size,"text-anchor":D.anchor,"text-offset":D.offset}),h.extendFlat(R.paint,{"text-color":w.textfont.color,"text-opacity":w.opacity})}return V}},{"../../components/colorscale":655,"../../components/drawing":665,"../../components/fx/helpers":679,"../../constants/numerical":753,"../../lib":778,"../../lib/geojson_utils":772,"../../lib/svg_text_utils":803,"../../plots/mapbox/convert_text_opts":884,"../scatter/make_bubble_size_func":1204,"../scatter/subtypes":1212,"fast-isnumeric":241}],1254:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../scatter/subtypes"),p=n("../scatter/marker_defaults"),l=n("../scatter/line_defaults"),e=n("../scatter/text_defaults"),o=n("../scatter/fillcolor_defaults"),r=n("./attributes");z.exports=function(i,u,s,a){function c(g,d){return t.coerce(i,u,r,g,d)}if(function(g,d,m){var y=m("lon")||[],v=m("lat")||[],T=Math.min(y.length,v.length);return d._length=T,T}(0,u,c)){if(c("text"),c("texttemplate"),c("hovertext"),c("hovertemplate"),c("mode"),c("below"),h.hasLines(u)&&(l(i,u,s,a,c,{noDash:!0}),c("connectgaps")),h.hasMarkers(u)){p(i,u,s,a,c,{noLine:!0}),c("marker.allowoverlap"),c("marker.angle");var f=u.marker;f.symbol!=="circle"&&(t.isArrayOrTypedArray(f.size)&&(f.size=f.size[0]),t.isArrayOrTypedArray(f.color)&&(f.color=f.color[0]))}h.hasText(u)&&e(i,u,a,c,{noSelect:!0}),c("fill"),u.fill!=="none"&&o(i,u,s,c),t.coerceSelectionMarkerOpacity(u,c)}else u.visible=!1}},{"../../lib":778,"../scatter/fillcolor_defaults":1195,"../scatter/line_defaults":1200,"../scatter/marker_defaults":1206,"../scatter/subtypes":1212,"../scatter/text_defaults":1213,"./attributes":1252}],1255:[function(n,z,q){"use strict";z.exports=function(t,h){return t.lon=h.lon,t.lat=h.lat,t}},{}],1256:[function(n,z,q){"use strict";var t=n("../../plots/cartesian/axes");z.exports=function(h,p,l){var e={},o=l[p.subplot]._subplot.mockAxis,r=h.lonlat;return e.lonLabel=t.tickText(o,o.c2l(r[0]),!0).text,e.latLabel=t.tickText(o,o.c2l(r[1]),!0).text,e}},{"../../plots/cartesian/axes":828}],1257:[function(n,z,q){"use strict";var t=n("../../components/fx"),h=n("../../lib"),p=n("../scatter/get_trace_color"),l=h.fillText,e=n("../../constants/numerical").BADNUM;z.exports=function(o,r,i){var u=o.cd,s=u[0].trace,a=o.xa,c=o.ya,f=o.subplot,g=360*(r>=0?Math.floor((r+180)/360):Math.ceil((r-180)/360)),d=r-g;if(t.getClosest(u,function(b){var _=b.lonlat;if(_[0]===e)return 1/0;var S=h.modHalf(_[0],360),C=_[1],k=f.project([S,C]),L=k.x-a.c2p([d,C]),I=k.y-c.c2p([S,i]),R=Math.max(3,b.mrc||0);return Math.max(Math.sqrt(L*L+I*I)-R,1-3/R)},o),o.index!==!1){var m=u[o.index],y=m.lonlat,v=[h.modHalf(y[0],360)+g,y[1]],T=a.c2p(v),w=c.c2p(v),A=m.mrc||1;o.x0=T-A,o.x1=T+A,o.y0=w-A,o.y1=w+A;var E={};E[s.subplot]={_subplot:f};var M=s._module.formatLabels(m,s,E);return o.lonLabel=M.lonLabel,o.latLabel=M.latLabel,o.color=p(s,m),o.extraText=function(b,_,S){if(b.hovertemplate)return;var C=(_.hi||b.hoverinfo).split("+"),k=C.indexOf("all")!==-1,L=C.indexOf("lon")!==-1,I=C.indexOf("lat")!==-1,R=_.lonlat,V=[];function O(J){return J+"\xB0"}return k||L&&I?V.push("("+O(R[0])+", "+O(R[1])+")"):L?V.push(S.lon+O(R[0])):I&&V.push(S.lat+O(R[1])),(k||C.indexOf("text")!==-1)&&l(_,b,V),V.join("<br>")}(s,m,u[0].t.labels),o.hovertemplate=s.hovertemplate,[o]}}},{"../../components/fx":683,"../../constants/numerical":753,"../../lib":778,"../scatter/get_trace_color":1197}],1258:[function(n,z,q){"use strict";z.exports={attributes:n("./attributes"),supplyDefaults:n("./defaults"),colorbar:n("../scatter/marker_colorbar"),formatLabels:n("./format_labels"),calc:n("../scattergeo/calc"),plot:n("./plot"),hoverPoints:n("./hover"),eventData:n("./event_data"),selectPoints:n("./select"),styleOnSelect:function(t,h){h&&h[0].trace._glTrace.update(h)},moduleType:"trace",name:"scattermapbox",basePlotModule:n("../../plots/mapbox"),categories:["mapbox","gl","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/mapbox":885,"../scatter/marker_colorbar":1205,"../scattergeo/calc":1230,"./attributes":1252,"./defaults":1254,"./event_data":1255,"./format_labels":1256,"./hover":1257,"./plot":1259,"./select":1260}],1259:[function(n,z,q){"use strict";var t=n("./convert"),h=n("../../plots/mapbox/constants").traceLayerPrefix,p=["fill","line","circle","symbol"];function l(o,r){this.type="scattermapbox",this.subplot=o,this.uid=r,this.sourceIds={fill:"source-"+r+"-fill",line:"source-"+r+"-line",circle:"source-"+r+"-circle",symbol:"source-"+r+"-symbol"},this.layerIds={fill:h+r+"-fill",line:h+r+"-line",circle:h+r+"-circle",symbol:h+r+"-symbol"},this.below=null}var e=l.prototype;e.addSource=function(o,r){this.subplot.map.addSource(this.sourceIds[o],{type:"geojson",data:r.geojson})},e.setSourceData=function(o,r){this.subplot.map.getSource(this.sourceIds[o]).setData(r.geojson)},e.addLayer=function(o,r,i){this.subplot.addLayer({type:o,id:this.layerIds[o],source:this.sourceIds[o],layout:r.layout,paint:r.paint},i)},e.update=function(o){var r,i,u,s=this.subplot,a=s.map,c=t(s.gd,o),f=s.belowLookup["trace-"+this.uid];if(f!==this.below){for(r=p.length-1;r>=0;r--)i=p[r],a.removeLayer(this.layerIds[i]);for(r=0;r<p.length;r++)u=c[i=p[r]],this.addLayer(i,u,f);this.below=f}for(r=0;r<p.length;r++)u=c[i=p[r]],s.setOptions(this.layerIds[i],"setLayoutProperty",u.layout),u.layout.visibility==="visible"&&(this.setSourceData(i,u),s.setOptions(this.layerIds[i],"setPaintProperty",u.paint));o[0].trace._glTrace=this},e.dispose=function(){for(var o=this.subplot.map,r=p.length-1;r>=0;r--){var i=p[r];o.removeLayer(this.layerIds[i]),o.removeSource(this.sourceIds[i])}},z.exports=function(o,r){for(var i=r[0].trace,u=new l(o,i.uid),s=t(o.gd,r),a=u.below=o.belowLookup["trace-"+i.uid],c=0;c<p.length;c++){var f=p[c],g=s[f];u.addSource(f,g),u.addLayer(f,g,a)}return r[0].trace._glTrace=u,u}},{"../../plots/mapbox/constants":883,"./convert":1253}],1260:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../scatter/subtypes"),p=n("../../constants/numerical").BADNUM;z.exports=function(l,e){var o,r=l.cd,i=l.xaxis,u=l.yaxis,s=[],a=r[0].trace;if(!h.hasMarkers(a))return[];if(e===!1)for(o=0;o<r.length;o++)r[o].selected=0;else for(o=0;o<r.length;o++){var c=r[o],f=c.lonlat;if(f[0]!==p){var g=[t.modHalf(f[0],360),f[1]],d=[i.c2p(g),u.c2p(g)];e.contains(d,null,o,l)?(s.push({pointNumber:o,lon:f[0],lat:f[1]}),c.selected=1):c.selected=0}}return s}},{"../../constants/numerical":753,"../../lib":778,"../scatter/subtypes":1212}],1261:[function(n,z,q){"use strict";var t=n("../../plots/template_attributes").hovertemplateAttrs,h=n("../../plots/template_attributes").texttemplateAttrs,p=n("../../lib/extend").extendFlat,l=n("../scatter/attributes"),e=n("../../plots/attributes"),o=l.line;z.exports={mode:l.mode,r:{valType:"data_array",editType:"calc+clearAxisTypes"},theta:{valType:"data_array",editType:"calc+clearAxisTypes"},r0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dr:{valType:"number",dflt:1,editType:"calc"},theta0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dtheta:{valType:"number",editType:"calc"},thetaunit:{valType:"enumerated",values:["radians","degrees","gradians"],dflt:"degrees",editType:"calc+clearAxisTypes"},text:l.text,texttemplate:h({editType:"plot"},{keys:["r","theta","text"]}),hovertext:l.hovertext,line:{color:o.color,width:o.width,dash:o.dash,shape:p({},o.shape,{values:["linear","spline"]}),smoothing:o.smoothing,editType:"calc"},connectgaps:l.connectgaps,marker:l.marker,cliponaxis:p({},l.cliponaxis,{dflt:!1}),textposition:l.textposition,textfont:l.textfont,fill:p({},l.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:l.fillcolor,hoverinfo:p({},e.hoverinfo,{flags:["r","theta","text","name"]}),hoveron:l.hoveron,hovertemplate:t(),selected:l.selected,unselected:l.unselected}},{"../../lib/extend":768,"../../plots/attributes":824,"../../plots/template_attributes":906,"../scatter/attributes":1187}],1262:[function(n,z,q){"use strict";var t=n("fast-isnumeric"),h=n("../../constants/numerical").BADNUM,p=n("../../plots/cartesian/axes"),l=n("../scatter/colorscale_calc"),e=n("../scatter/arrays_to_calcdata"),o=n("../scatter/calc_selection"),r=n("../scatter/calc").calcMarkerSize;z.exports=function(i,u){for(var s=i._fullLayout,a=u.subplot,c=s[a].radialaxis,f=s[a].angularaxis,g=c.makeCalcdata(u,"r"),d=f.makeCalcdata(u,"theta"),m=u._length,y=new Array(m),v=0;v<m;v++){var T=g[v],w=d[v],A=y[v]={};t(T)&&t(w)?(A.r=T,A.theta=w):A.r=h}var E=r(u,m);return u._extremes.x=p.findExtremes(c,g,{ppad:E}),l(i,u),e(y,u),o(y,u),y}},{"../../constants/numerical":753,"../../plots/cartesian/axes":828,"../scatter/arrays_to_calcdata":1186,"../scatter/calc":1188,"../scatter/calc_selection":1189,"../scatter/colorscale_calc":1190,"fast-isnumeric":241}],1263:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../scatter/subtypes"),p=n("../scatter/marker_defaults"),l=n("../scatter/line_defaults"),e=n("../scatter/line_shape_defaults"),o=n("../scatter/text_defaults"),r=n("../scatter/fillcolor_defaults"),i=n("../scatter/constants").PTS_LINESONLY,u=n("./attributes");function s(a,c,f,g){var d,m=g("r"),y=g("theta");if(m)y?d=Math.min(m.length,y.length):(d=m.length,g("theta0"),g("dtheta"));else{if(!y)return 0;d=c.theta.length,g("r0"),g("dr")}return c._length=d,d}z.exports={handleRThetaDefaults:s,supplyDefaults:function(a,c,f,g){function d(v,T){return t.coerce(a,c,u,v,T)}var m=s(a,c,g,d);if(m){d("thetaunit"),d("mode",m<i?"lines+markers":"lines"),d("text"),d("hovertext"),c.hoveron!=="fills"&&d("hovertemplate"),h.hasLines(c)&&(l(a,c,f,g,d),e(a,c,d),d("connectgaps")),h.hasMarkers(c)&&p(a,c,f,g,d,{gradient:!0}),h.hasText(c)&&(d("texttemplate"),o(a,c,g,d));var y=[];(h.hasMarkers(c)||h.hasText(c))&&(d("cliponaxis"),d("marker.maxdisplayed"),y.push("points")),d("fill"),c.fill!=="none"&&(r(a,c,f,d),h.hasLines(c)||e(a,c,d)),c.fill!=="tonext"&&c.fill!=="toself"||y.push("fills"),d("hoveron",y.join("+")||"points"),t.coerceSelectionMarkerOpacity(c,d)}else c.visible=!1}}},{"../../lib":778,"../scatter/constants":1191,"../scatter/fillcolor_defaults":1195,"../scatter/line_defaults":1200,"../scatter/line_shape_defaults":1202,"../scatter/marker_defaults":1206,"../scatter/subtypes":1212,"../scatter/text_defaults":1213,"./attributes":1261}],1264:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../../plots/cartesian/axes");z.exports=function(p,l,e){var o,r,i={},u=e[l.subplot]._subplot;u?(o=u.radialAxis,r=u.angularAxis):(o=(u=e[l.subplot]).radialaxis,r=u.angularaxis);var s=o.c2l(p.r);i.rLabel=h.tickText(o,s,!0).text;var a=r.thetaunit==="degrees"?t.rad2deg(p.theta):p.theta;return i.thetaLabel=h.tickText(r,a,!0).text,i}},{"../../lib":778,"../../plots/cartesian/axes":828}],1265:[function(n,z,q){"use strict";var t=n("../scatter/hover");function h(p,l,e,o){var r=e.radialAxis,i=e.angularAxis;r._hovertitle="r",i._hovertitle="\u03B8";var u={};u[l.subplot]={_subplot:e};var s=l._module.formatLabels(p,l,u);o.rLabel=s.rLabel,o.thetaLabel=s.thetaLabel;var a=p.hi||l.hoverinfo,c=[];function f(d,m){c.push(d._hovertitle+": "+m)}if(!l.hovertemplate){var g=a.split("+");g.indexOf("all")!==-1&&(g=["r","theta","text"]),g.indexOf("r")!==-1&&f(r,o.rLabel),g.indexOf("theta")!==-1&&f(i,o.thetaLabel),g.indexOf("text")!==-1&&o.text&&(c.push(o.text),delete o.text),o.extraText=c.join("<br>")}}z.exports={hoverPoints:function(p,l,e,o){var r=t(p,l,e,o);if(r&&r[0].index!==!1){var i=r[0];if(i.index===void 0)return r;var u=p.subplot,s=i.cd[i.index],a=i.trace;if(u.isPtInside(s))return i.xLabelVal=void 0,i.yLabelVal=void 0,h(s,a,u,i),i.hovertemplate=a.hovertemplate,r}},makeHoverPointText:h}},{"../scatter/hover":1198}],1266:[function(n,z,q){"use strict";z.exports={moduleType:"trace",name:"scatterpolar",basePlotModule:n("../../plots/polar"),categories:["polar","symbols","showLegend","scatter-like"],attributes:n("./attributes"),supplyDefaults:n("./defaults").supplyDefaults,colorbar:n("../scatter/marker_colorbar"),formatLabels:n("./format_labels"),calc:n("./calc"),plot:n("./plot"),style:n("../scatter/style").style,styleOnSelect:n("../scatter/style").styleOnSelect,hoverPoints:n("./hover").hoverPoints,selectPoints:n("../scatter/select"),meta:{}}},{"../../plots/polar":894,"../scatter/marker_colorbar":1205,"../scatter/select":1209,"../scatter/style":1211,"./attributes":1261,"./calc":1262,"./defaults":1263,"./format_labels":1264,"./hover":1265,"./plot":1267}],1267:[function(n,z,q){"use strict";var t=n("../scatter/plot"),h=n("../../constants/numerical").BADNUM;z.exports=function(p,l,e){for(var o=l.layers.frontplot.select("g.scatterlayer"),r={xaxis:l.xaxis,yaxis:l.yaxis,plot:l.framework,layerClipId:l._hasClipOnAxisFalse?l.clipIds.forTraces:null},i=l.radialAxis,u=l.angularAxis,s=0;s<e.length;s++)for(var a=e[s],c=0;c<a.length;c++){var f=a[c],g=f.r;if(g===h)f.x=f.y=h;else{var d=i.c2g(g),m=u.c2g(f.theta);f.x=d*Math.cos(m),f.y=d*Math.sin(m)}}t(p,r,e,o)}},{"../../constants/numerical":753,"../scatter/plot":1208}],1268:[function(n,z,q){"use strict";var t=n("../scatterpolar/attributes"),h=n("../scattergl/attributes"),p=n("../../plots/template_attributes").texttemplateAttrs;z.exports={mode:t.mode,r:t.r,theta:t.theta,r0:t.r0,dr:t.dr,theta0:t.theta0,dtheta:t.dtheta,thetaunit:t.thetaunit,text:t.text,texttemplate:p({editType:"plot"},{keys:["r","theta","text"]}),hovertext:t.hovertext,hovertemplate:t.hovertemplate,line:h.line,connectgaps:h.connectgaps,marker:h.marker,fill:h.fill,fillcolor:h.fillcolor,textposition:h.textposition,textfont:h.textfont,hoverinfo:t.hoverinfo,selected:t.selected,unselected:t.unselected}},{"../../plots/template_attributes":906,"../scattergl/attributes":1239,"../scatterpolar/attributes":1261}],1269:[function(n,z,q){"use strict";var t=n("../scatter/colorscale_calc"),h=n("../scatter/calc").calcMarkerSize,p=n("../scattergl/convert"),l=n("../../plots/cartesian/axes"),e=n("../scattergl/constants").TOO_MANY_POINTS;z.exports=function(o,r){var i=o._fullLayout,u=r.subplot,s=i[u].radialaxis,a=i[u].angularaxis,c=r._r=s.makeCalcdata(r,"r"),f=r._theta=a.makeCalcdata(r,"theta"),g=r._length,d={};g<c.length&&(c=c.slice(0,g)),g<f.length&&(f=f.slice(0,g)),d.r=c,d.theta=f,t(o,r);var m,y=d.opts=p.style(o,r);return g<e?m=h(r,g):y.marker&&(m=2*(y.marker.sizeAvg||Math.max(y.marker.size,3))),r._extremes.x=l.findExtremes(s,c,{ppad:m}),[{x:!1,y:!1,t:d,trace:r}]}},{"../../plots/cartesian/axes":828,"../scatter/calc":1188,"../scatter/colorscale_calc":1190,"../scattergl/constants":1241,"../scattergl/convert":1242}],1270:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../scatter/subtypes"),p=n("../scatterpolar/defaults").handleRThetaDefaults,l=n("../scatter/marker_defaults"),e=n("../scatter/line_defaults"),o=n("../scatter/text_defaults"),r=n("../scatter/fillcolor_defaults"),i=n("../scatter/constants").PTS_LINESONLY,u=n("./attributes");z.exports=function(s,a,c,f){function g(m,y){return t.coerce(s,a,u,m,y)}var d=p(s,a,f,g);d?(g("thetaunit"),g("mode",d<i?"lines+markers":"lines"),g("text"),g("hovertext"),a.hoveron!=="fills"&&g("hovertemplate"),h.hasLines(a)&&(e(s,a,c,f,g),g("connectgaps")),h.hasMarkers(a)&&l(s,a,c,f,g),h.hasText(a)&&(g("texttemplate"),o(s,a,f,g)),g("fill"),a.fill!=="none"&&r(s,a,c,g),t.coerceSelectionMarkerOpacity(a,g)):a.visible=!1}},{"../../lib":778,"../scatter/constants":1191,"../scatter/fillcolor_defaults":1195,"../scatter/line_defaults":1200,"../scatter/marker_defaults":1206,"../scatter/subtypes":1212,"../scatter/text_defaults":1213,"../scatterpolar/defaults":1263,"./attributes":1268}],1271:[function(n,z,q){"use strict";var t=n("../scatterpolar/format_labels");z.exports=function(h,p,l){var e=h.i;return"r"in h||(h.r=p._r[e]),"theta"in h||(h.theta=p._theta[e]),t(h,p,l)}},{"../scatterpolar/format_labels":1264}],1272:[function(n,z,q){"use strict";var t=n("../scattergl/hover"),h=n("../scatterpolar/hover").makeHoverPointText;z.exports={hoverPoints:function(p,l,e,o){var r=p.cd[0].t,i=r.r,u=r.theta,s=t.hoverPoints(p,l,e,o);if(s&&s[0].index!==!1){var a=s[0];if(a.index===void 0)return s;var c=p.subplot,f=a.cd[a.index],g=a.trace;if(f.r=i[a.index],f.theta=u[a.index],c.isPtInside(f))return a.xLabelVal=void 0,a.yLabelVal=void 0,h(f,g,c,a),s}}}},{"../scattergl/hover":1247,"../scatterpolar/hover":1265}],1273:[function(n,z,q){"use strict";z.exports={moduleType:"trace",name:"scatterpolargl",basePlotModule:n("../../plots/polar"),categories:["gl","regl","polar","symbols","showLegend","scatter-like"],attributes:n("./attributes"),supplyDefaults:n("./defaults"),colorbar:n("../scatter/marker_colorbar"),formatLabels:n("./format_labels"),calc:n("./calc"),plot:n("./plot"),hoverPoints:n("./hover").hoverPoints,selectPoints:n("../scattergl/select"),meta:{}}},{"../../plots/polar":894,"../scatter/marker_colorbar":1205,"../scattergl/select":1251,"./attributes":1268,"./calc":1269,"./defaults":1270,"./format_labels":1271,"./hover":1272,"./plot":1274}],1274:[function(n,z,q){"use strict";var t=n("@plotly/point-cluster"),h=n("fast-isnumeric"),p=n("../scattergl/plot"),l=n("../scattergl/scene_update"),e=n("../scattergl/convert"),o=n("../../lib"),r=n("../scattergl/constants").TOO_MANY_POINTS;z.exports=function(i,u,s){if(s.length){var a=u.radialAxis,c=u.angularAxis,f=l(i,u);return s.forEach(function(g){if(g&&g[0]&&g[0].trace){var d,m=g[0],y=m.trace,v=m.t,T=y._length,w=v.r,A=v.theta,E=v.opts,M=w.slice(),b=A.slice();for(d=0;d<w.length;d++)u.isPtInside({r:w[d],theta:A[d]})||(M[d]=NaN,b[d]=NaN);var _=new Array(2*T),S=Array(T),C=Array(T);for(d=0;d<T;d++){var k,L,I=M[d];if(h(I)){var R=a.c2g(I),V=c.c2g(b[d],y.thetaunit);k=R*Math.cos(V),L=R*Math.sin(V)}else k=L=NaN;S[d]=_[2*d]=k,C[d]=_[2*d+1]=L}v.tree=t(_),E.marker&&T>=r&&(E.marker.cluster=v.tree),E.marker&&(E.markerSel.positions=E.markerUnsel.positions=E.marker.positions=_),E.line&&_.length>1&&o.extendFlat(E.line,e.linePositions(i,y,_)),E.text&&(o.extendFlat(E.text,{positions:_},e.textPosition(i,y,E.text,E.marker)),o.extendFlat(E.textSel,{positions:_},e.textPosition(i,y,E.text,E.markerSel)),o.extendFlat(E.textUnsel,{positions:_},e.textPosition(i,y,E.text,E.markerUnsel))),E.fill&&!f.fill2d&&(f.fill2d=!0),E.marker&&!f.scatter2d&&(f.scatter2d=!0),E.line&&!f.line2d&&(f.line2d=!0),E.text&&!f.glText&&(f.glText=!0),f.lineOptions.push(E.line),f.fillOptions.push(E.fill),f.markerOptions.push(E.marker),f.markerSelectedOptions.push(E.markerSel),f.markerUnselectedOptions.push(E.markerUnsel),f.textOptions.push(E.text),f.textSelectedOptions.push(E.textSel),f.textUnselectedOptions.push(E.textUnsel),f.selectBatch.push([]),f.unselectBatch.push([]),v.x=S,v.y=C,v.rawx=S,v.rawy=C,v.r=w,v.theta=A,v.positions=_,v._scene=f,v.index=f.count,f.count++}}),p(i,u,s)}}},{"../../lib":778,"../scattergl/constants":1241,"../scattergl/convert":1242,"../scattergl/plot":1249,"../scattergl/scene_update":1250,"@plotly/point-cluster":57,"fast-isnumeric":241}],1275:[function(n,z,q){"use strict";var t=n("../../plots/template_attributes").hovertemplateAttrs,h=n("../../plots/template_attributes").texttemplateAttrs,p=n("../scatter/attributes"),l=n("../../plots/attributes"),e=n("../../components/colorscale/attributes"),o=n("../../components/drawing/attributes").dash,r=n("../../lib/extend").extendFlat,i=p.marker,u=p.line,s=i.line;z.exports={a:{valType:"data_array",editType:"calc"},b:{valType:"data_array",editType:"calc"},c:{valType:"data_array",editType:"calc"},sum:{valType:"number",dflt:0,min:0,editType:"calc"},mode:r({},p.mode,{dflt:"markers"}),text:r({},p.text,{}),texttemplate:h({editType:"plot"},{keys:["a","b","c","text"]}),hovertext:r({},p.hovertext,{}),line:{color:u.color,width:u.width,dash:o,shape:r({},u.shape,{values:["linear","spline"]}),smoothing:u.smoothing,editType:"calc"},connectgaps:p.connectgaps,cliponaxis:p.cliponaxis,fill:r({},p.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:p.fillcolor,marker:r({symbol:i.symbol,opacity:i.opacity,maxdisplayed:i.maxdisplayed,size:i.size,sizeref:i.sizeref,sizemin:i.sizemin,sizemode:i.sizemode,line:r({width:s.width,editType:"calc"},e("marker.line")),gradient:i.gradient,editType:"calc"},e("marker")),textfont:p.textfont,textposition:p.textposition,selected:p.selected,unselected:p.unselected,hoverinfo:r({},l.hoverinfo,{flags:["a","b","c","text","name"]}),hoveron:p.hoveron,hovertemplate:t()}},{"../../components/colorscale/attributes":650,"../../components/drawing/attributes":664,"../../lib/extend":768,"../../plots/attributes":824,"../../plots/template_attributes":906,"../scatter/attributes":1187}],1276:[function(n,z,q){"use strict";var t=n("fast-isnumeric"),h=n("../scatter/colorscale_calc"),p=n("../scatter/arrays_to_calcdata"),l=n("../scatter/calc_selection"),e=n("../scatter/calc").calcMarkerSize,o=["a","b","c"],r={a:["b","c"],b:["a","c"],c:["a","b"]};z.exports=function(i,u){var s,a,c,f,g,d,m=i._fullLayout[u.subplot].sum,y=u.sum||m,v={a:u.a,b:u.b,c:u.c};for(s=0;s<o.length;s++)if(!v[c=o[s]]){for(g=v[r[c][0]],d=v[r[c][1]],f=new Array(g.length),a=0;a<g.length;a++)f[a]=y-g[a]-d[a];v[c]=f}var T,w,A,E,M,b,_=u._length,S=new Array(_);for(s=0;s<_;s++)T=v.a[s],w=v.b[s],A=v.c[s],t(T)&&t(w)&&t(A)?((E=m/((T=+T)+(w=+w)+(A=+A)))!==1&&(T*=E,w*=E,A*=E),b=T,M=A-w,S[s]={x:M,y:b,a:T,b:w,c:A}):S[s]={x:!1,y:!1};return e(u,_),h(i,u),p(S,u),l(S,u),S}},{"../scatter/arrays_to_calcdata":1186,"../scatter/calc":1188,"../scatter/calc_selection":1189,"../scatter/colorscale_calc":1190,"fast-isnumeric":241}],1277:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../scatter/constants"),p=n("../scatter/subtypes"),l=n("../scatter/marker_defaults"),e=n("../scatter/line_defaults"),o=n("../scatter/line_shape_defaults"),r=n("../scatter/text_defaults"),i=n("../scatter/fillcolor_defaults"),u=n("./attributes");z.exports=function(s,a,c,f){function g(w,A){return t.coerce(s,a,u,w,A)}var d,m=g("a"),y=g("b"),v=g("c");if(m?(d=m.length,y?(d=Math.min(d,y.length),v&&(d=Math.min(d,v.length))):d=v?Math.min(d,v.length):0):y&&v&&(d=Math.min(y.length,v.length)),d){a._length=d,g("sum"),g("text"),g("hovertext"),a.hoveron!=="fills"&&g("hovertemplate"),g("mode",d<h.PTS_LINESONLY?"lines+markers":"lines"),p.hasLines(a)&&(e(s,a,c,f,g),o(s,a,g),g("connectgaps")),p.hasMarkers(a)&&l(s,a,c,f,g,{gradient:!0}),p.hasText(a)&&(g("texttemplate"),r(s,a,f,g));var T=[];(p.hasMarkers(a)||p.hasText(a))&&(g("cliponaxis"),g("marker.maxdisplayed"),T.push("points")),g("fill"),a.fill!=="none"&&(i(s,a,c,g),p.hasLines(a)||o(s,a,g)),a.fill!=="tonext"&&a.fill!=="toself"||T.push("fills"),g("hoveron",T.join("+")||"points"),t.coerceSelectionMarkerOpacity(a,g)}else a.visible=!1}},{"../../lib":778,"../scatter/constants":1191,"../scatter/fillcolor_defaults":1195,"../scatter/line_defaults":1200,"../scatter/line_shape_defaults":1202,"../scatter/marker_defaults":1206,"../scatter/subtypes":1212,"../scatter/text_defaults":1213,"./attributes":1275}],1278:[function(n,z,q){"use strict";z.exports=function(t,h,p,l,e){if(h.xa&&(t.xaxis=h.xa),h.ya&&(t.yaxis=h.ya),l[e]){var o=l[e];t.a=o.a,t.b=o.b,t.c=o.c}else t.a=h.a,t.b=h.b,t.c=h.c;return t}},{}],1279:[function(n,z,q){"use strict";var t=n("../../plots/cartesian/axes");z.exports=function(h,p,l){var e={},o=l[p.subplot]._subplot;return e.aLabel=t.tickText(o.aaxis,h.a,!0).text,e.bLabel=t.tickText(o.baxis,h.b,!0).text,e.cLabel=t.tickText(o.caxis,h.c,!0).text,e}},{"../../plots/cartesian/axes":828}],1280:[function(n,z,q){"use strict";var t=n("../scatter/hover");z.exports=function(h,p,l,e){var o=t(h,p,l,e);if(o&&o[0].index!==!1){var r=o[0];if(r.index===void 0){var i=1-r.y0/h.ya._length,u=h.xa._length,s=u*i/2,a=u-s;return r.x0=Math.max(Math.min(r.x0,a),s),r.x1=Math.max(Math.min(r.x1,a),s),o}var c=r.cd[r.index],f=r.trace,g=r.subplot;r.a=c.a,r.b=c.b,r.c=c.c,r.xLabelVal=void 0,r.yLabelVal=void 0;var d={};d[f.subplot]={_subplot:g};var m=f._module.formatLabels(c,f,d);r.aLabel=m.aLabel,r.bLabel=m.bLabel,r.cLabel=m.cLabel;var y=c.hi||f.hoverinfo,v=[];if(!f.hovertemplate){var T=y.split("+");T.indexOf("all")!==-1&&(T=["a","b","c"]),T.indexOf("a")!==-1&&w(g.aaxis,r.aLabel),T.indexOf("b")!==-1&&w(g.baxis,r.bLabel),T.indexOf("c")!==-1&&w(g.caxis,r.cLabel)}return r.extraText=v.join("<br>"),r.hovertemplate=f.hovertemplate,o}function w(A,E){v.push(A._hovertitle+": "+E)}}},{"../scatter/hover":1198}],1281:[function(n,z,q){"use strict";z.exports={attributes:n("./attributes"),supplyDefaults:n("./defaults"),colorbar:n("../scatter/marker_colorbar"),formatLabels:n("./format_labels"),calc:n("./calc"),plot:n("./plot"),style:n("../scatter/style").style,styleOnSelect:n("../scatter/style").styleOnSelect,hoverPoints:n("./hover"),selectPoints:n("../scatter/select"),eventData:n("./event_data"),moduleType:"trace",name:"scatterternary",basePlotModule:n("../../plots/ternary"),categories:["ternary","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/ternary":907,"../scatter/marker_colorbar":1205,"../scatter/select":1209,"../scatter/style":1211,"./attributes":1275,"./calc":1276,"./defaults":1277,"./event_data":1278,"./format_labels":1279,"./hover":1280,"./plot":1282}],1282:[function(n,z,q){"use strict";var t=n("../scatter/plot");z.exports=function(h,p,l){var e=p.plotContainer;e.select(".scatterlayer").selectAll("*").remove();var o={xaxis:p.xaxis,yaxis:p.yaxis,plot:e,layerClipId:p._hasClipOnAxisFalse?p.clipIdRelative:null},r=p.layers.frontplot.select("g.scatterlayer");t(h,o,l,r)}},{"../scatter/plot":1208}],1283:[function(n,z,q){"use strict";var t=n("../scatter/attributes"),h=n("../../components/colorscale/attributes"),p=n("../../plots/template_attributes").hovertemplateAttrs,l=n("../scattergl/attributes"),e=n("../../plots/cartesian/constants").idRegex,o=n("../../plot_api/plot_template").templatedArray,r=n("../../lib/extend").extendFlat,i=t.marker,u=i.line,s=r(h("marker.line",{editTypeOverride:"calc"}),{width:r({},u.width,{editType:"calc"}),editType:"calc"}),a=r(h("marker"),{symbol:i.symbol,size:r({},i.size,{editType:"markerSize"}),sizeref:i.sizeref,sizemin:i.sizemin,sizemode:i.sizemode,opacity:i.opacity,colorbar:i.colorbar,line:s,editType:"calc"});function c(f){return{valType:"info_array",freeLength:!0,editType:"calc",items:{valType:"subplotid",regex:e[f],editType:"plot"}}}a.color.editType=a.cmin.editType=a.cmax.editType="style",z.exports={dimensions:o("dimension",{visible:{valType:"boolean",dflt:!0,editType:"calc"},label:{valType:"string",editType:"calc"},values:{valType:"data_array",editType:"calc+clearAxisTypes"},axis:{type:{valType:"enumerated",values:["linear","log","date","category"],editType:"calc+clearAxisTypes"},matches:{valType:"boolean",dflt:!1,editType:"calc"},editType:"calc+clearAxisTypes"},editType:"calc+clearAxisTypes"}),text:r({},l.text,{}),hovertext:r({},l.hovertext,{}),hovertemplate:p(),marker:a,xaxes:c("x"),yaxes:c("y"),diagonal:{visible:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"},showupperhalf:{valType:"boolean",dflt:!0,editType:"calc"},showlowerhalf:{valType:"boolean",dflt:!0,editType:"calc"},selected:{marker:l.selected.marker,editType:"calc"},unselected:{marker:l.unselected.marker,editType:"calc"},opacity:l.opacity}},{"../../components/colorscale/attributes":650,"../../lib/extend":768,"../../plot_api/plot_template":817,"../../plots/cartesian/constants":834,"../../plots/template_attributes":906,"../scatter/attributes":1187,"../scattergl/attributes":1239}],1284:[function(n,z,q){"use strict";var t=n("regl-line2d"),h=n("../../registry"),p=n("../../lib/prepare_regl"),l=n("../../plots/get_data").getModuleCalcData,e=n("../../plots/cartesian"),o=n("../../plots/cartesian/axis_ids").getFromId,r=n("../../plots/cartesian/axes").shouldShowZeroLine;function i(s,a,c){for(var f=c.matrixOptions.data.length,g=a._visibleDims,d=c.viewOpts.ranges=new Array(f),m=0;m<g.length;m++){var y=g[m],v=d[m]=new Array(4),T=o(s,a._diag[y][0]);T&&(v[0]=T.r2l(T.range[0]),v[2]=T.r2l(T.range[1]));var w=o(s,a._diag[y][1]);w&&(v[1]=w.r2l(w.range[0]),v[3]=w.r2l(w.range[1]))}c.selectBatch.length||c.unselectBatch.length?c.matrix.update({ranges:d},{ranges:d}):c.matrix.update({ranges:d})}function u(s){var a=s._fullLayout,c=a._glcanvas.data()[0].regl,f=a._splomGrid;f||(f=a._splomGrid=t(c)),f.update(function(g){var d,m=g._fullLayout,y=m._size,v=[0,0,m.width,m.height],T={};function w(V,O,J,D,B,N){var F=O[V+"color"],H=O[V+"width"],j=String(F+H);j in T?T[j].data.push(NaN,NaN,J,D,B,N):T[j]={data:[J,D,B,N],join:"rect",thickness:H,color:F,viewport:v,range:v,overlay:!1}}for(d in m._splomSubplots){var A,E,M=m._plots[d],b=M.xaxis,_=M.yaxis,S=b._gridVals,C=_._gridVals,k=y.b+_.domain[0]*y.h,L=-_._m,I=-L*_.r2l(_.range[0],_.calendar);if(b.showgrid)for(d=0;d<S.length;d++)A=b._offset+b.l2p(S[d].x),w("grid",b,A,k,A,k+_._length);if(_.showgrid)for(d=0;d<C.length;d++)E=k+I+L*C[d].x,w("grid",_,b._offset,E,b._offset+b._length,E);r(g,b,_)&&(A=b._offset+b.l2p(0),w("zeroline",b,A,k,A,k+_._length)),r(g,_,b)&&(E=k+I+0,w("zeroline",_,b._offset,E,b._offset+b._length,E))}var R=[];for(d in T)R.push(T[d]);return R}(s))}z.exports={name:"splom",attr:e.attr,attrRegex:e.attrRegex,layoutAttributes:e.layoutAttributes,supplyLayoutDefaults:e.supplyLayoutDefaults,drawFramework:e.drawFramework,plot:function(s){var a=s._fullLayout,c=h.getModule("splom"),f=l(s.calcdata,c)[0];p(s,["ANGLE_instanced_arrays","OES_element_index_uint"])&&(a._hasOnlyLargeSploms&&u(s),c.plot(s,{},f))},drag:function(s){var a=s.calcdata,c=s._fullLayout;c._hasOnlyLargeSploms&&u(s);for(var f=0;f<a.length;f++){var g=a[f][0].trace,d=c._splomScenes[g.uid];g.type==="splom"&&d&&d.matrix&&i(s,g,d)}},updateGrid:u,clean:function(s,a,c,f){var g,d={};if(f._splomScenes){for(g=0;g<s.length;g++){var m=s[g];m.type==="splom"&&(d[m.uid]=1)}for(g=0;g<c.length;g++){var y=c[g];if(!d[y.uid]){var v=f._splomScenes[y.uid];v&&v.destroy&&v.destroy(),f._splomScenes[y.uid]=null,delete f._splomScenes[y.uid]}}}Object.keys(f._splomScenes||{}).length===0&&delete f._splomScenes,f._splomGrid&&!a._hasOnlyLargeSploms&&f._hasOnlyLargeSploms&&(f._splomGrid.destroy(),f._splomGrid=null,delete f._splomGrid),e.clean(s,a,c,f)},updateFx:e.updateFx,toSVG:e.toSVG}},{"../../lib/prepare_regl":791,"../../plots/cartesian":841,"../../plots/cartesian/axes":828,"../../plots/cartesian/axis_ids":831,"../../plots/get_data":865,"../../registry":911,"regl-line2d":535}],1285:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../../plots/cartesian/axis_ids"),p=n("../scatter/calc").calcMarkerSize,l=n("../scatter/calc").calcAxisExpansion,e=n("../scatter/colorscale_calc"),o=n("../scattergl/convert").markerSelection,r=n("../scattergl/convert").markerStyle,i=n("./scene_update"),u=n("../../constants/numerical").BADNUM,s=n("../scattergl/constants").TOO_MANY_POINTS;z.exports=function(a,c){var f,g,d,m,y,v,T=c.dimensions,w=c._length,A={},E=A.cdata=[],M=A.data=[],b=c._visibleDims=[];function _(C,k){for(var L=C.makeCalcdata({v:k.values,vcalendar:c.calendar},"v"),I=0;I<L.length;I++)L[I]=L[I]===u?NaN:L[I];E.push(L),M.push(C.type==="log"?t.simpleMap(L,C.c2l):L)}for(f=0;f<T.length;f++)if((d=T[f]).visible){if(m=h.getFromId(a,c._diag[f][0]),y=h.getFromId(a,c._diag[f][1]),m&&y&&m.type!==y.type){t.log("Skipping splom dimension "+f+" with conflicting axis types");continue}m?(_(m,d),y&&y.type==="category"&&(y._categories=m._categories.slice())):_(y,d),b.push(f)}for(e(a,c),t.extendFlat(A,r(c)),v=E.length*w>s?2*(A.sizeAvg||Math.max(A.size,3)):p(c,w),g=0;g<b.length;g++)d=T[f=b[g]],m=h.getFromId(a,c._diag[f][0])||{},y=h.getFromId(a,c._diag[f][1])||{},l(a,c,m,y,E[g],E[g],v);var S=i(a,c);return S.matrix||(S.matrix=!0),S.matrixOptions=A,S.selectedOptions=o(c,c.selected),S.unselectedOptions=o(c,c.unselected),[{x:!1,y:!1,t:{},trace:c}]}},{"../../constants/numerical":753,"../../lib":778,"../../plots/cartesian/axis_ids":831,"../scatter/calc":1188,"../scatter/colorscale_calc":1190,"../scattergl/constants":1241,"../scattergl/convert":1242,"./scene_update":1292}],1286:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../../plots/array_container_defaults"),p=n("./attributes"),l=n("../scatter/subtypes"),e=n("../scatter/marker_defaults"),o=n("../parcoords/merge_length"),r=n("../scattergl/helpers").isOpenSymbol;function i(u,s){function a(f,g){return t.coerce(u,s,p.dimensions,f,g)}a("label");var c=a("values");c&&c.length?a("visible"):s.visible=!1,a("axis.type"),a("axis.matches")}z.exports=function(u,s,a,c){function f(w,A){return t.coerce(u,s,p,w,A)}var g=h(u,s,{name:"dimensions",handleItemDefaults:i}),d=f("diagonal.visible"),m=f("showupperhalf"),y=f("showlowerhalf");if(o(s,g,"values")&&(d||m||y)){f("text"),f("hovertext"),f("hovertemplate"),e(u,s,a,c,f);var v=r(s.marker.symbol),T=l.isBubble(s);f("marker.line.width",v||T?1:0),function(w,A,E,M){var b,_,S=A.dimensions,C=S.length,k=A.showupperhalf,L=A.showlowerhalf,I=A.diagonal.visible,R=new Array(C),V=new Array(C);for(b=0;b<C;b++){var O=b?b+1:"";R[b]="x"+O,V[b]="y"+O}var J=M("xaxes",R),D=M("yaxes",V),B=A._diag=new Array(C);A._xaxes={},A._yaxes={};var N=[],F=[];function H(oe,de,le,fe){if(oe){var ue=oe.charAt(0),we=E._splomAxes[ue];if(A["_"+ue+"axes"][oe]=1,fe.push(oe),!(oe in we)){var Ae=we[oe]={};le&&(Ae.label=le.label||"",le.visible&&le.axis&&(le.axis.type&&(Ae.type=le.axis.type),le.axis.matches&&(Ae.matches=de)))}}}var j=!I&&!L,G=!I&&!k;for(A._axesDim={},b=0;b<C;b++){var W=S[b],Q=b===0,$=b===C-1,ee=Q&&j||$&&G?void 0:J[b],ie=Q&&G||$&&j?void 0:D[b];H(ee,ie,W,N),H(ie,ee,W,F),B[b]=[ee,ie],A._axesDim[ee]=b,A._axesDim[ie]=b}for(b=0;b<N.length;b++)for(_=0;_<F.length;_++){var ae=N[b]+F[_];b>_&&k||b<_&&L?E._splomSubplots[ae]=1:b!==_||!I&&L&&k||(E._splomSubplots[ae]=1)}(!L||!I&&k&&L)&&(E._splomGridDflt.xside="bottom",E._splomGridDflt.yside="left")}(0,s,c,f),t.coerceSelectionMarkerOpacity(s,f)}else s.visible=!1}},{"../../lib":778,"../../plots/array_container_defaults":823,"../parcoords/merge_length":1158,"../scatter/marker_defaults":1206,"../scatter/subtypes":1212,"../scattergl/helpers":1246,"./attributes":1283}],1287:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../scatter/colorscale_calc"),p=n("../scattergl/convert").markerStyle;z.exports=function(l,e){var o=e.trace,r=l._fullLayout._splomScenes[o.uid];if(r){h(l,o),t.extendFlat(r.matrixOptions,p(o));var i=t.extendFlat({},r.matrixOptions,r.viewOpts);r.matrix.update(i,null)}}},{"../../lib":778,"../scatter/colorscale_calc":1190,"../scattergl/convert":1242}],1288:[function(n,z,q){"use strict";q.getDimIndex=function(t,h){for(var p=h._id,l={x:0,y:1}[p.charAt(0)],e=t._visibleDims,o=0;o<e.length;o++){var r=e[o];if(t._diag[r][l]===p)return o}return!1}},{}],1289:[function(n,z,q){"use strict";var t=n("./helpers"),h=n("../scattergl/hover").calcHover;z.exports={hoverPoints:function(p,l,e){var o=p.cd[0].trace,r=p.scene.matrixOptions.cdata,i=p.xa,u=p.ya,s=i.c2p(l),a=u.c2p(e),c=p.distance,f=t.getDimIndex(o,i),g=t.getDimIndex(o,u);if(f===!1||g===!1)return[p];for(var d,m,y=r[f],v=r[g],T=c,w=0;w<y.length;w++){var A=y[w],E=v[w],M=i.c2p(A)-s,b=u.c2p(E)-a,_=Math.sqrt(M*M+b*b);_<T&&(T=m=_,d=w)}return p.index=d,p.distance=T,p.dxy=m,d===void 0?[p]:[h(p,y,v,o)]}}},{"../scattergl/hover":1247,"./helpers":1288}],1290:[function(n,z,q){"use strict";var t=n("../../registry"),h=n("../../components/grid");z.exports={moduleType:"trace",name:"splom",basePlotModule:n("./base_plot"),categories:["gl","regl","cartesian","symbols","showLegend","scatter-like"],attributes:n("./attributes"),supplyDefaults:n("./defaults"),colorbar:n("../scatter/marker_colorbar"),calc:n("./calc"),plot:n("./plot"),hoverPoints:n("./hover").hoverPoints,selectPoints:n("./select"),editStyle:n("./edit_style"),meta:{}},t.register(h)},{"../../components/grid":687,"../../registry":911,"../scatter/marker_colorbar":1205,"./attributes":1283,"./base_plot":1284,"./calc":1285,"./defaults":1286,"./edit_style":1287,"./hover":1289,"./plot":1291,"./select":1293}],1291:[function(n,z,q){"use strict";var t=n("regl-splom"),h=n("../../lib"),p=n("../../plots/cartesian/axis_ids"),l=n("../../components/dragelement/helpers").selectMode;function e(o,r){var i,u,s,a,c,f=o._fullLayout,g=f._size,d=r.trace,m=r.t,y=f._splomScenes[d.uid],v=y.matrixOptions,T=v.cdata,w=f._glcanvas.data()[0].regl,A=f.dragmode;if(T.length!==0){v.lower=d.showupperhalf,v.upper=d.showlowerhalf,v.diagonal=d.diagonal.visible;var E=d._visibleDims,M=T.length,b=y.viewOpts={};for(b.ranges=new Array(M),b.domains=new Array(M),c=0;c<E.length;c++){s=E[c];var _=b.ranges[c]=new Array(4),S=b.domains[c]=new Array(4);(i=p.getFromId(o,d._diag[s][0]))&&(_[0]=i._rl[0],_[2]=i._rl[1],S[0]=i.domain[0],S[2]=i.domain[1]),(u=p.getFromId(o,d._diag[s][1]))&&(_[1]=u._rl[0],_[3]=u._rl[1],S[1]=u.domain[0],S[3]=u.domain[1])}b.viewport=[g.l,g.b,g.w+g.l,g.h+g.b],y.matrix===!0&&(y.matrix=t(w));var C=f.clickmode.indexOf("select")>-1,k=!0;if(l(A)||d.selectedpoints||C){var L=d._length;if(d.selectedpoints){y.selectBatch=d.selectedpoints;var I=d.selectedpoints,R={};for(s=0;s<I.length;s++)R[I[s]]=!0;var V=[];for(s=0;s<L;s++)R[s]||V.push(s);y.unselectBatch=V}var O=m.xpx=new Array(M),J=m.ypx=new Array(M);for(c=0;c<E.length;c++){if(s=E[c],i=p.getFromId(o,d._diag[s][0]))for(O[c]=new Array(L),a=0;a<L;a++)O[c][a]=i.c2p(T[c][a]);if(u=p.getFromId(o,d._diag[s][1]))for(J[c]=new Array(L),a=0;a<L;a++)J[c][a]=u.c2p(T[c][a])}if(y.selectBatch.length||y.unselectBatch.length){var D=h.extendFlat({},v,y.unselectedOptions,b),B=h.extendFlat({},v,y.selectedOptions,b);y.matrix.update(D,B),k=!1}}else m.xpx=m.ypx=null;if(k){var N=h.extendFlat({},v,b);y.matrix.update(N,null)}}}z.exports=function(o,r,i){if(i.length)for(var u=0;u<i.length;u++)e(o,i[u][0])}},{"../../components/dragelement/helpers":661,"../../lib":778,"../../plots/cartesian/axis_ids":831,"regl-splom":539}],1292:[function(n,z,q){"use strict";var t=n("../../lib");z.exports=function(h,p){var l=h._fullLayout,e=p.uid,o=l._splomScenes;o||(o=l._splomScenes={});var r={dirty:!0,selectBatch:[],unselectBatch:[]},i=o[p.uid];return i||((i=o[e]=t.extendFlat({},r,{matrix:!1,selectBatch:[],unselectBatch:[]})).draw=function(){i.matrix&&i.matrix.draw&&(i.selectBatch.length||i.unselectBatch.length?i.matrix.draw(i.unselectBatch,i.selectBatch):i.matrix.draw()),i.dirty=!1},i.destroy=function(){i.matrix&&i.matrix.destroy&&i.matrix.destroy(),i.matrixOptions=null,i.selectBatch=null,i.unselectBatch=null,i=null}),i.dirty||t.extendFlat(i,r),i}},{"../../lib":778}],1293:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../scatter/subtypes"),p=n("./helpers");z.exports=function(l,e){var o=l.cd,r=o[0].trace,i=o[0].t,u=l.scene,s=u.matrixOptions.cdata,a=l.xaxis,c=l.yaxis,f=[];if(!u)return f;var g=!h.hasMarkers(r)&&!h.hasText(r);if(r.visible!==!0||g)return f;var d=p.getDimIndex(r,a),m=p.getDimIndex(r,c);if(d===!1||m===!1)return f;var y=i.xpx[d],v=i.ypx[m],T=s[d],w=s[m],A=[],E=[];if(e!==!1&&!e.degenerate)for(var M=0;M<T.length;M++)e.contains([y[M],v[M]],null,M,l)?(A.push(M),f.push({pointNumber:M,x:T[M],y:w[M]})):E.push(M);var b=u.matrixOptions;return A.length||E.length?u.selectBatch.length||u.unselectBatch.length||u.matrix.update(u.unselectedOptions,t.extendFlat({},b,u.selectedOptions,u.viewOpts)):u.matrix.update(b,null),u.selectBatch=A,u.unselectBatch=E,f}},{"../../lib":778,"../scatter/subtypes":1212,"./helpers":1288}],1294:[function(n,z,q){"use strict";var t=n("../../components/colorscale/attributes"),h=n("../../plots/template_attributes").hovertemplateAttrs,p=n("../mesh3d/attributes"),l=n("../../plots/attributes"),e=n("../../lib/extend").extendFlat,o={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},u:{valType:"data_array",editType:"calc"},v:{valType:"data_array",editType:"calc"},w:{valType:"data_array",editType:"calc"},starts:{x:{valType:"data_array",editType:"calc"},y:{valType:"data_array",editType:"calc"},z:{valType:"data_array",editType:"calc"},editType:"calc"},maxdisplayed:{valType:"integer",min:0,dflt:1e3,editType:"calc"},sizeref:{valType:"number",editType:"calc",min:0,dflt:1},text:{valType:"string",dflt:"",editType:"calc"},hovertext:{valType:"string",dflt:"",editType:"calc"},hovertemplate:h({editType:"calc"},{keys:["tubex","tubey","tubez","tubeu","tubev","tubew","norm","divergence"]}),showlegend:e({},l.showlegend,{dflt:!1})};e(o,t("",{colorAttr:"u/v/w norm",showScaleDflt:!0,editTypeOverride:"calc"})),["opacity","lightposition","lighting"].forEach(function(r){o[r]=p[r]}),o.hoverinfo=e({},l.hoverinfo,{editType:"calc",flags:["x","y","z","u","v","w","norm","divergence","text","name"],dflt:"x+y+z+norm+text+name"}),o.transforms=void 0,z.exports=o},{"../../components/colorscale/attributes":650,"../../lib/extend":768,"../../plots/attributes":824,"../../plots/template_attributes":906,"../mesh3d/attributes":1128}],1295:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../../components/colorscale/calc");function p(o){var r,i,u,s,a,c,f,g,d,m,y,v,T=o._x,w=o._y,A=o._z,E=o._len,M=-1/0,b=1/0,_=-1/0,S=1/0,C=-1/0,k=1/0,L="";for(E&&(f=T[0],d=w[0],y=A[0]),E>1&&(g=T[E-1],m=w[E-1],v=A[E-1]),r=0;r<E;r++)M=Math.max(M,T[r]),b=Math.min(b,T[r]),_=Math.max(_,w[r]),S=Math.min(S,w[r]),C=Math.max(C,A[r]),k=Math.min(k,A[r]),s||T[r]===f||(s=!0,L+="x"),a||w[r]===d||(a=!0,L+="y"),c||A[r]===y||(c=!0,L+="z");s||(L+="x"),a||(L+="y"),c||(L+="z");var I=l(o._x),R=l(o._y),V=l(o._z);L=(L=(L=L.replace("x",(f>g?"-":"+")+"x")).replace("y",(d>m?"-":"+")+"y")).replace("z",(y>v?"-":"+")+"z");var O=function(){E=0,I=[],R=[],V=[]};(!E||E<I.length*R.length*V.length)&&O();var J=function(ue){return ue==="x"?T:ue==="y"?w:A},D=function(ue){return ue==="x"?I:ue==="y"?R:V},B=function(ue){return ue[E-1]<ue[0]?-1:1},N=J(L[1]),F=J(L[3]),H=J(L[5]),j=D(L[1]).length,G=D(L[3]).length,W=D(L[5]).length,Q=!1,$=function(ue,we,Ae){return j*(G*ue+we)+Ae},ee=B(J(L[1])),ie=B(J(L[3])),ae=B(J(L[5]));for(r=0;r<W-1;r++){for(i=0;i<G-1;i++){for(u=0;u<j-1;u++){var oe=$(r,i,u),de=$(r,i,u+1),le=$(r,i+1,u),fe=$(r+1,i,u);if(N[oe]*ee<N[de]*ee&&F[oe]*ie<F[le]*ie&&H[oe]*ae<H[fe]*ae||(Q=!0),Q)break}if(Q)break}if(Q)break}return Q&&(t.warn("Encountered arbitrary coordinates! Unable to input data grid."),O()),{xMin:b,yMin:S,zMin:k,xMax:M,yMax:_,zMax:C,Xs:I,Ys:R,Zs:V,len:E,fill:L}}function l(o){return t.distinctVals(o).vals}function e(o,r){if(r===void 0&&(r=o.length),t.isTypedArray(o))return o.subarray(0,r);for(var i=[],u=0;u<r;u++)i[u]=+o[u];return i}z.exports={calc:function(o,r){r._len=Math.min(r.u.length,r.v.length,r.w.length,r.x.length,r.y.length,r.z.length),r._u=e(r.u,r._len),r._v=e(r.v,r._len),r._w=e(r.w,r._len),r._x=e(r.x,r._len),r._y=e(r.y,r._len),r._z=e(r.z,r._len);var i=p(r);r._gridFill=i.fill,r._Xs=i.Xs,r._Ys=i.Ys,r._Zs=i.Zs,r._len=i.len;var u,s,a,c=0;r.starts&&(u=e(r.starts.x||[]),s=e(r.starts.y||[]),a=e(r.starts.z||[]),c=Math.min(u.length,s.length,a.length)),r._startsX=u||[],r._startsY=s||[],r._startsZ=a||[];var f,g=0,d=1/0;for(f=0;f<r._len;f++){var m=r._u[f],y=r._v[f],v=r._w[f],T=Math.sqrt(m*m+y*y+v*v);g=Math.max(g,T),d=Math.min(d,T)}for(h(o,r,{vals:[d,g],containerStr:"",cLetter:"c"}),f=0;f<c;f++){var w=u[f];i.xMax=Math.max(i.xMax,w),i.xMin=Math.min(i.xMin,w);var A=s[f];i.yMax=Math.max(i.yMax,A),i.yMin=Math.min(i.yMin,A);var E=a[f];i.zMax=Math.max(i.zMax,E),i.zMin=Math.min(i.zMin,E)}r._slen=c,r._normMax=g,r._xbnds=[i.xMin,i.xMax],r._ybnds=[i.yMin,i.yMax],r._zbnds=[i.zMin,i.zMax]},filter:e,processGrid:p}},{"../../components/colorscale/calc":651,"../../lib":778}],1296:[function(n,z,q){"use strict";var t=n("gl-streamtube3d"),h=t.createTubeMesh,p=n("../../lib"),l=n("../../lib/gl_format_color").parseColorScale,e=n("../../components/colorscale").extractOpts,o=n("../../plots/gl3d/zip3"),r={xaxis:0,yaxis:1,zaxis:2};function i(f,g){this.scene=f,this.uid=g,this.mesh=null,this.data=null}var u=i.prototype;function s(f){var g=f.length;return g>2?f.slice(1,g-1):g===2?[(f[0]+f[1])/2]:f}function a(f){var g=f.length;return g===1?[.5,.5]:[f[1]-f[0],f[g-1]-f[g-2]]}function c(f,g){var d=f.fullSceneLayout,m=f.dataScale,y=g._len,v={};function T(j,G){var W=d[G],Q=m[r[G]];return p.simpleMap(j,function($){return W.d2l($)*Q})}if(v.vectors=o(T(g._u,"xaxis"),T(g._v,"yaxis"),T(g._w,"zaxis"),y),!y)return{positions:[],cells:[]};var w=T(g._Xs,"xaxis"),A=T(g._Ys,"yaxis"),E=T(g._Zs,"zaxis");if(v.meshgrid=[w,A,E],v.gridFill=g._gridFill,g._slen)v.startingPositions=o(T(g._startsX,"xaxis"),T(g._startsY,"yaxis"),T(g._startsZ,"zaxis"));else{for(var M=A[0],b=s(w),_=s(E),S=new Array(b.length*_.length),C=0,k=0;k<b.length;k++)for(var L=0;L<_.length;L++)S[C++]=[b[k],M,_[L]];v.startingPositions=S}v.colormap=l(g),v.tubeSize=g.sizeref,v.maxLength=g.maxdisplayed;var I=T(g._xbnds,"xaxis"),R=T(g._ybnds,"yaxis"),V=T(g._zbnds,"zaxis"),O=a(w),J=a(A),D=a(E),B=[[I[0]-O[0],R[0]-J[0],V[0]-D[0]],[I[1]+O[1],R[1]+J[1],V[1]+D[1]]],N=t(v,B),F=e(g);N.vertexIntensityBounds=[F.min/g._normMax,F.max/g._normMax];var H=g.lightposition;return N.lightPosition=[H.x,H.y,H.z],N.ambient=g.lighting.ambient,N.diffuse=g.lighting.diffuse,N.specular=g.lighting.specular,N.roughness=g.lighting.roughness,N.fresnel=g.lighting.fresnel,N.opacity=g.opacity,g._pad=N.tubeScale*g.sizeref*2,N}u.handlePick=function(f){var g=this.scene.fullSceneLayout,d=this.scene.dataScale;function m(T,w){var A=g[w],E=d[r[w]];return A.l2c(T)/E}if(f.object===this.mesh){var y=f.data.position,v=f.data.velocity;return f.traceCoordinate=[m(y[0],"xaxis"),m(y[1],"yaxis"),m(y[2],"zaxis"),m(v[0],"xaxis"),m(v[1],"yaxis"),m(v[2],"zaxis"),f.data.intensity*this.data._normMax,f.data.divergence],f.textLabel=this.data.hovertext||this.data.text,!0}},u.update=function(f){this.data=f;var g=c(this.scene,f);this.mesh.update(g)},u.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},z.exports=function(f,g){var d=f.glplot.gl,m=c(f,g),y=h(d,m),v=new i(f,g.uid);return v.mesh=y,v.data=g,y._trace=v,f.glplot.add(y),v}},{"../../components/colorscale":655,"../../lib":778,"../../lib/gl_format_color":774,"../../plots/gl3d/zip3":881,"gl-streamtube3d":348}],1297:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../../components/colorscale/defaults"),p=n("./attributes");z.exports=function(l,e,o,r){function i(d,m){return t.coerce(l,e,p,d,m)}var u=i("u"),s=i("v"),a=i("w"),c=i("x"),f=i("y"),g=i("z");u&&u.length&&s&&s.length&&a&&a.length&&c&&c.length&&f&&f.length&&g&&g.length?(i("starts.x"),i("starts.y"),i("starts.z"),i("maxdisplayed"),i("sizeref"),i("lighting.ambient"),i("lighting.diffuse"),i("lighting.specular"),i("lighting.roughness"),i("lighting.fresnel"),i("lightposition.x"),i("lightposition.y"),i("lightposition.z"),h(l,e,r,i,{prefix:"",cLetter:"c"}),i("text"),i("hovertext"),i("hovertemplate"),e._length=null):e.visible=!1}},{"../../components/colorscale/defaults":653,"../../lib":778,"./attributes":1294}],1298:[function(n,z,q){"use strict";z.exports={moduleType:"trace",name:"streamtube",basePlotModule:n("../../plots/gl3d"),categories:["gl3d","showLegend"],attributes:n("./attributes"),supplyDefaults:n("./defaults"),colorbar:{min:"cmin",max:"cmax"},calc:n("./calc").calc,plot:n("./convert"),eventData:function(t,h){return t.tubex=t.x,t.tubey=t.y,t.tubez=t.z,t.tubeu=h.traceCoordinate[3],t.tubev=h.traceCoordinate[4],t.tubew=h.traceCoordinate[5],t.norm=h.traceCoordinate[6],t.divergence=h.traceCoordinate[7],delete t.x,delete t.y,delete t.z,t},meta:{}}},{"../../plots/gl3d":870,"./attributes":1294,"./calc":1295,"./convert":1296,"./defaults":1297}],1299:[function(n,z,q){"use strict";var t=n("../../plots/attributes"),h=n("../../plots/template_attributes").hovertemplateAttrs,p=n("../../plots/template_attributes").texttemplateAttrs,l=n("../../components/colorscale/attributes"),e=n("../../plots/domain").attributes,o=n("../pie/attributes"),r=n("./constants"),i=n("../../lib/extend").extendFlat;z.exports={labels:{valType:"data_array",editType:"calc"},parents:{valType:"data_array",editType:"calc"},values:{valType:"data_array",editType:"calc"},branchvalues:{valType:"enumerated",values:["remainder","total"],dflt:"remainder",editType:"calc"},count:{valType:"flaglist",flags:["branches","leaves"],dflt:"leaves",editType:"calc"},level:{valType:"any",editType:"plot",anim:!0},maxdepth:{valType:"integer",editType:"plot",dflt:-1},marker:i({colors:{valType:"data_array",editType:"calc"},line:{color:i({},o.marker.line.color,{dflt:null}),width:i({},o.marker.line.width,{dflt:1}),editType:"calc"},editType:"calc"},l("marker",{colorAttr:"colors",anim:!1})),leaf:{opacity:{valType:"number",editType:"style",min:0,max:1},editType:"plot"},text:o.text,textinfo:{valType:"flaglist",flags:["label","text","value","current path","percent root","percent entry","percent parent"],extras:["none"],editType:"plot"},texttemplate:p({editType:"plot"},{keys:r.eventDataKeys.concat(["label","value"])}),hovertext:o.hovertext,hoverinfo:i({},t.hoverinfo,{flags:["label","text","value","name","current path","percent root","percent entry","percent parent"],dflt:"label+text+value+name"}),hovertemplate:h({},{keys:r.eventDataKeys}),textfont:o.textfont,insidetextorientation:o.insidetextorientation,insidetextfont:o.insidetextfont,outsidetextfont:i({},o.outsidetextfont,{}),rotation:{valType:"angle",dflt:0,editType:"plot"},sort:o.sort,root:{color:{valType:"color",editType:"calc",dflt:"rgba(0,0,0,0)"},editType:"calc"},domain:e({name:"sunburst",trace:!0,editType:"calc"})}},{"../../components/colorscale/attributes":650,"../../lib/extend":768,"../../plots/attributes":824,"../../plots/domain":855,"../../plots/template_attributes":906,"../pie/attributes":1161,"./constants":1302}],1300:[function(n,z,q){"use strict";var t=n("../../plots/plots");q.name="sunburst",q.plot=function(h,p,l,e){t.plotBasePlot(q.name,h,p,l,e)},q.clean=function(h,p,l,e){t.cleanBasePlot(q.name,h,p,l,e)}},{"../../plots/plots":891}],1301:[function(n,z,q){"use strict";var t=n("d3-hierarchy"),h=n("fast-isnumeric"),p=n("../../lib"),l=n("../../components/colorscale").makeColorScaleFuncFromTrace,e=n("../pie/calc").makePullColorFn,o=n("../pie/calc").generateExtendedColors,r=n("../../components/colorscale").calc,i=n("../../constants/numerical").ALMOST_EQUAL,u={},s={};q.calc=function(a,c){var f,g,d,m,y,v,T=a._fullLayout,w=c.ids,A=p.isArrayOrTypedArray(w),E=c.labels,M=c.parents,b=c.values,_=p.isArrayOrTypedArray(b),S=[],C={},k={},L=function(ee){return ee||typeof ee=="number"},I=function(ee){return!_||h(b[ee])&&b[ee]>=0};A?(f=Math.min(w.length,M.length),g=function(ee){return L(w[ee])&&I(ee)},d=function(ee){return String(w[ee])}):(f=Math.min(E.length,M.length),g=function(ee){return L(E[ee])&&I(ee)},d=function(ee){return String(E[ee])}),_&&(f=Math.min(f,b.length));for(var R=0;R<f;R++)if(g(R)){var V=d(R),O=L(M[R])?String(M[R]):"",J={i:R,id:V,pid:O,label:L(E[R])?String(E[R]):""};_&&(J.v=+b[R]),S.push(J),y=V,C[m=O]?C[m].push(y):C[m]=[y],k[y]=1}if(C[""]){if(C[""].length>1){for(var D=p.randstr(),B=0;B<S.length;B++)S[B].pid===""&&(S[B].pid=D);S.unshift({hasMultipleRoots:!0,id:D,pid:"",label:""})}}else{var N,F=[];for(N in C)k[N]||F.push(N);if(F.length!==1)return p.warn(["Multiple implied roots, cannot build",c.type,"hierarchy of",c.name+".","These roots include:",F.join(", ")].join(" "));N=F[0],S.unshift({hasImpliedRoot:!0,id:N,pid:"",label:N})}try{v=t.stratify().id(function(ee){return ee.id}).parentId(function(ee){return ee.pid})(S)}catch(ee){return p.warn(["Failed to build",c.type,"hierarchy of",c.name+".","Error:",ee.message].join(" "))}var H=t.hierarchy(v),j=!1;if(_)switch(c.branchvalues){case"remainder":H.sum(function(ee){return ee.data.v});break;case"total":H.each(function(ee){var ie=ee.data.data,ae=ie.v;if(ee.children){var oe=ee.children.reduce(function(de,le){return de+le.data.data.v},0);if((ie.hasImpliedRoot||ie.hasMultipleRoots)&&(ae=oe),ae<oe*i)return j=!0,p.warn(["Total value for node",ee.data.data.id,"of",c.name,"is smaller than the sum of its children.",`
parent value =`,ae,`
children sum =`,oe].join(" "))}ee.value=ae})}else(function ee(ie,ae,oe){var de=0,le=ie.children;if(le){for(var fe=le.length,ue=0;ue<fe;ue++)de+=ee(le[ue],ae,oe);oe.branches&&de++}else oe.leaves&&de++;return ie.value=ie.data.data.value=de,ae._values||(ae._values=[]),ae._values[ie.data.data.i]=de,de})(H,c,{branches:c.count.indexOf("branches")!==-1,leaves:c.count.indexOf("leaves")!==-1});if(!j){var G,W;c.sort&&H.sort(function(ee,ie){return ie.value-ee.value});var Q=c.marker.colors||[],$=!!Q.length;return c._hasColorscale?($||(Q=_?c.values:c._values),r(a,c,{vals:Q,containerStr:"marker",cLetter:"c"}),W=l(c.marker)):G=e(T["_"+c.type+"colormap"]),H.each(function(ee){var ie=ee.data.data;ie.color=c._hasColorscale?W(Q[ie.i]):G(Q[ie.i],ie.id)}),S[0].hierarchy=H,S}},q._runCrossTraceCalc=function(a,c){var f=c._fullLayout,g=c.calcdata,d=f[a+"colorway"],m=f["_"+a+"colormap"];f["extend"+a+"colors"]&&(d=o(d,a==="treemap"?s:u));var y,v=0;function T(E){var M=E.data.data,b=M.id;M.color===!1&&(m[b]?M.color=m[b]:E.parent?E.parent.parent?M.color=E.parent.data.data.color:(m[b]=M.color=d[v%d.length],v++):M.color=y)}for(var w=0;w<g.length;w++){var A=g[w][0];A.trace.type===a&&A.hierarchy&&(y=A.trace.root.color,A.hierarchy.each(T))}},q.crossTraceCalc=function(a){return q._runCrossTraceCalc("sunburst",a)}},{"../../components/colorscale":655,"../../constants/numerical":753,"../../lib":778,"../pie/calc":1163,"d3-hierarchy":161,"fast-isnumeric":241}],1302:[function(n,z,q){"use strict";z.exports={CLICK_TRANSITION_TIME:750,CLICK_TRANSITION_EASING:"linear",eventDataKeys:["currentPath","root","entry","percentRoot","percentEntry","percentParent"]}},{}],1303:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("./attributes"),p=n("../../plots/domain").defaults,l=n("../bar/defaults").handleText,e=n("../../components/colorscale"),o=e.hasColorscale,r=e.handleDefaults;z.exports=function(i,u,s,a){function c(v,T){return t.coerce(i,u,h,v,T)}var f=c("labels"),g=c("parents");if(f&&f.length&&g&&g.length){var d=c("values");d&&d.length?c("branchvalues"):c("count"),c("level"),c("maxdepth"),c("marker.line.width")&&c("marker.line.color",a.paper_bgcolor),c("marker.colors");var m=u._hasColorscale=o(i,"marker","colors")||(i.marker||{}).coloraxis;m&&r(i,u,a,c,{prefix:"marker.",cLetter:"c"}),c("leaf.opacity",m?1:.7);var y=c("text");c("texttemplate"),u.texttemplate||c("textinfo",Array.isArray(y)?"text+label":"label"),c("hovertext"),c("hovertemplate"),l(i,u,a,c,"auto",{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),c("insidetextorientation"),c("sort"),c("rotation"),c("root.color"),p(u,a,c),u._length=null}else u.visible=!1}},{"../../components/colorscale":655,"../../lib":778,"../../plots/domain":855,"../bar/defaults":925,"./attributes":1299}],1304:[function(n,z,q){"use strict";var t=n("d3"),h=n("../../registry"),p=n("../../components/fx/helpers").appendArrayPointValue,l=n("../../components/fx"),e=n("../../lib"),o=n("../../lib/events"),r=n("./helpers"),i=n("../pie/helpers").formatPieValue;function u(s,a,c){for(var f=s.data.data,g={curveNumber:a.index,pointNumber:f.i,data:a._input,fullData:a},d=0;d<c.length;d++){var m=c[d];m in s&&(g[m]=s[m])}return"parentString"in s&&!r.isHierarchyRoot(s)&&(g.parent=s.parentString),p(g,a,f.i),g}z.exports=function(s,a,c,f,g){var d=f[0],m=d.trace,y=d.hierarchy,v=m.type==="sunburst",T=m.type==="treemap";"_hasHoverLabel"in m||(m._hasHoverLabel=!1),"_hasHoverEvent"in m||(m._hasHoverEvent=!1),s.on("mouseover",function(w){var A=c._fullLayout;if(!c._dragging&&A.hovermode!==!1){var E=c._fullData[m.index],M=w.data.data,b=M.i,_=r.isHierarchyRoot(w),S=r.getParent(y,w),C=r.getValue(w),k=function(Q){return e.castOption(E,b,Q)},L=k("hovertemplate"),I=l.castHoverinfo(E,A,b),R=A.separators;if(L||I&&I!=="none"&&I!=="skip"){var V,O;v&&(V=d.cx+w.pxmid[0]*(1-w.rInscribed),O=d.cy+w.pxmid[1]*(1-w.rInscribed)),T&&(V=w._hoverX,O=w._hoverY);var J,D={},B=[],N=[],F=function(Q){return B.indexOf(Q)!==-1};I&&(B=I==="all"?E._module.attributes.hoverinfo.flags:I.split("+")),D.label=M.label,F("label")&&D.label&&N.push(D.label),M.hasOwnProperty("v")&&(D.value=M.v,D.valueLabel=i(D.value,R),F("value")&&N.push(D.valueLabel)),D.currentPath=w.currentPath=r.getPath(w.data),F("current path")&&!_&&N.push(D.currentPath);var H=[],j=function(){H.indexOf(J)===-1&&(N.push(J),H.push(J))};D.percentParent=w.percentParent=C/r.getValue(S),D.parent=w.parentString=r.getPtLabel(S),F("percent parent")&&(J=r.formatPercent(D.percentParent,R)+" of "+D.parent,j()),D.percentEntry=w.percentEntry=C/r.getValue(a),D.entry=w.entry=r.getPtLabel(a),!F("percent entry")||_||w.onPathbar||(J=r.formatPercent(D.percentEntry,R)+" of "+D.entry,j()),D.percentRoot=w.percentRoot=C/r.getValue(y),D.root=w.root=r.getPtLabel(y),F("percent root")&&!_&&(J=r.formatPercent(D.percentRoot,R)+" of "+D.root,j()),D.text=k("hovertext")||k("text"),F("text")&&(J=D.text,e.isValidTextValue(J)&&N.push(J));var G={trace:E,y:O,text:N.join("<br>"),name:L||F("name")?E.name:void 0,color:k("hoverlabel.bgcolor")||M.color,borderColor:k("hoverlabel.bordercolor"),fontFamily:k("hoverlabel.font.family"),fontSize:k("hoverlabel.font.size"),fontColor:k("hoverlabel.font.color"),nameLength:k("hoverlabel.namelength"),textAlign:k("hoverlabel.align"),hovertemplate:L,hovertemplateLabels:D,eventData:[u(w,E,g.eventDataKeys)]};v&&(G.x0=V-w.rInscribed*w.rpx1,G.x1=V+w.rInscribed*w.rpx1,G.idealAlign=w.pxmid[0]<0?"left":"right"),T&&(G.x=V,G.idealAlign=V<0?"left":"right"),l.loneHover(G,{container:A._hoverlayer.node(),outerContainer:A._paper.node(),gd:c}),m._hasHoverLabel=!0}if(T){var W=s.select("path.surface");g.styleOne(W,w,E,{hovered:!0})}m._hasHoverEvent=!0,c.emit("plotly_hover",{points:[u(w,E,g.eventDataKeys)],event:t.event})}}),s.on("mouseout",function(w){var A=c._fullLayout,E=c._fullData[m.index],M=t.select(this).datum();if(m._hasHoverEvent&&(w.originalEvent=t.event,c.emit("plotly_unhover",{points:[u(M,E,g.eventDataKeys)],event:t.event}),m._hasHoverEvent=!1),m._hasHoverLabel&&(l.loneUnhover(A._hoverlayer.node()),m._hasHoverLabel=!1),T){var b=s.select("path.surface");g.styleOne(b,M,E,{hovered:!1})}}),s.on("click",function(w){var A=c._fullLayout,E=c._fullData[m.index],M=v&&(r.isHierarchyRoot(w)||r.isLeaf(w)),b=r.getPtId(w),_=r.isEntry(w)?r.findEntryWithChild(y,b):r.findEntryWithLevel(y,b),S=r.getPtId(_),C={points:[u(w,E,g.eventDataKeys)],event:t.event};M||(C.nextLevel=S);var k=o.triggerHandler(c,"plotly_"+m.type+"click",C);if(k!==!1&&A.hovermode&&(c._hoverdata=[u(w,E,g.eventDataKeys)],l.click(c,t.event)),!M&&k!==!1&&!c._dragging&&!c._transitioning){h.call("_storeDirectGUIEdit",E,A._tracePreGUI[E.uid],{level:E.level});var L={data:[{level:S}],traces:[m.index]},I={frame:{redraw:!1,duration:g.transitionTime},transition:{duration:g.transitionTime,easing:g.transitionEasing},mode:"immediate",fromcurrent:!0};l.loneUnhover(A._hoverlayer.node()),h.call("animate",c,L,I)}})}},{"../../components/fx":683,"../../components/fx/helpers":679,"../../lib":778,"../../lib/events":767,"../../registry":911,"../pie/helpers":1166,"./helpers":1305,d3:169}],1305:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../../components/color"),p=n("../../lib/setcursor"),l=n("../pie/helpers");function e(o){return o.data.data.pid}q.findEntryWithLevel=function(o,r){var i;return r&&o.eachAfter(function(u){if(q.getPtId(u)===r)return i=u.copy()}),i||o},q.findEntryWithChild=function(o,r){var i;return o.eachAfter(function(u){for(var s=u.children||[],a=0;a<s.length;a++){var c=s[a];if(q.getPtId(c)===r)return i=u.copy()}}),i||o},q.isEntry=function(o){return!o.parent},q.isLeaf=function(o){return!o.children},q.getPtId=function(o){return o.data.data.id},q.getPtLabel=function(o){return o.data.data.label},q.getValue=function(o){return o.value},q.isHierarchyRoot=function(o){return e(o)===""},q.setSliceCursor=function(o,r,i){var u=i.isTransitioning;if(!u){var s=o.datum();u=i.hideOnRoot&&q.isHierarchyRoot(s)||i.hideOnLeaves&&q.isLeaf(s)}p(o,u?null:"pointer")},q.getInsideTextFontKey=function(o,r,i,u,s){var a=(s||{}).onPathbar?"pathbar.textfont":"insidetextfont",c=i.data.data.i;return t.castOption(r,c,a+"."+o)||t.castOption(r,c,"textfont."+o)||u.size},q.getOutsideTextFontKey=function(o,r,i,u){var s=i.data.data.i;return t.castOption(r,s,"outsidetextfont."+o)||t.castOption(r,s,"textfont."+o)||u.size},q.isOutsideText=function(o,r){return!o._hasColorscale&&q.isHierarchyRoot(r)},q.determineTextFont=function(o,r,i,u){return q.isOutsideText(o,r)?function(s,a,c){return{color:q.getOutsideTextFontKey("color",s,a,c),family:q.getOutsideTextFontKey("family",s,a,c),size:q.getOutsideTextFontKey("size",s,a,c)}}(o,r,i):function(s,a,c,f){var g=(f||{}).onPathbar,d=a.data.data,m=d.i,y=t.castOption(s,m,(g?"pathbar.textfont":"insidetextfont")+".color");return!y&&s._input.textfont&&(y=t.castOption(s._input,m,"textfont.color")),{color:y||h.contrast(d.color),family:q.getInsideTextFontKey("family",s,a,c,f),size:q.getInsideTextFontKey("size",s,a,c,f)}}(o,r,i,u)},q.hasTransition=function(o){return!!(o&&o.duration>0)},q.getMaxDepth=function(o){return o.maxdepth>=0?o.maxdepth:1/0},q.isHeader=function(o,r){return!(q.isLeaf(o)||o.depth===r._maxDepth-1)},q.getParent=function(o,r){return q.findEntryWithLevel(o,e(r))},q.listPath=function(o,r){var i=o.parent;if(!i)return[];var u=r?[i.data[r]]:[i];return q.listPath(i,r).concat(u)},q.getPath=function(o){return q.listPath(o,"label").join("/")+"/"},q.formatValue=l.formatPieValue,q.formatPercent=function(o,r){var i=t.formatPercent(o,0);return i==="0%"&&(i=l.formatPiePercent(o,r)),i}},{"../../components/color":643,"../../lib":778,"../../lib/setcursor":799,"../pie/helpers":1166}],1306:[function(n,z,q){"use strict";z.exports={moduleType:"trace",name:"sunburst",basePlotModule:n("./base_plot"),categories:[],animatable:!0,attributes:n("./attributes"),layoutAttributes:n("./layout_attributes"),supplyDefaults:n("./defaults"),supplyLayoutDefaults:n("./layout_defaults"),calc:n("./calc").calc,crossTraceCalc:n("./calc").crossTraceCalc,plot:n("./plot").plot,style:n("./style").style,colorbar:n("../scatter/marker_colorbar"),meta:{}}},{"../scatter/marker_colorbar":1205,"./attributes":1299,"./base_plot":1300,"./calc":1301,"./defaults":1303,"./layout_attributes":1307,"./layout_defaults":1308,"./plot":1309,"./style":1310}],1307:[function(n,z,q){"use strict";z.exports={sunburstcolorway:{valType:"colorlist",editType:"calc"},extendsunburstcolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],1308:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("./layout_attributes");z.exports=function(p,l){function e(o,r){return t.coerce(p,l,h,o,r)}e("sunburstcolorway",l.colorway),e("extendsunburstcolors")}},{"../../lib":778,"./layout_attributes":1307}],1309:[function(n,z,q){"use strict";var t=n("d3"),h=n("d3-hierarchy"),p=n("../../components/drawing"),l=n("../../lib"),e=n("../../lib/svg_text_utils"),o=n("../bar/uniform_text"),r=o.recordMinTextSize,i=o.clearMinTextSize,u=n("../pie/plot"),s=n("../pie/helpers").getRotationAngle,a=u.computeTransform,c=u.transformInsideText,f=n("./style").styleOne,g=n("../bar/style").resizeText,d=n("./fx"),m=n("./constants"),y=n("./helpers");function v(w,A,E,M){var b=w._fullLayout,_=!b.uniformtext.mode&&y.hasTransition(M),S=t.select(E).selectAll("g.slice"),C=A[0],k=C.trace,L=C.hierarchy,I=y.findEntryWithLevel(L,k.level),R=y.getMaxDepth(k),V=b._size,O=k.domain,J=V.w*(O.x[1]-O.x[0]),D=V.h*(O.y[1]-O.y[0]),B=.5*Math.min(J,D),N=C.cx=V.l+V.w*(O.x[1]+O.x[0])/2,F=C.cy=V.t+V.h*(1-O.y[0])-D/2;if(!I)return S.remove();var H=null,j={};_&&S.each(function(ke){j[y.getPtId(ke)]={rpx0:ke.rpx0,rpx1:ke.rpx1,x0:ke.x0,x1:ke.x1,transform:ke.transform},!H&&y.isEntry(ke)&&(H=ke)});var G=function(ke){return h.partition().size([2*Math.PI,ke.height+1])(ke)}(I).descendants(),W=I.height+1,Q=0,$=R;C.hasMultipleRoots&&y.isHierarchyRoot(I)&&(G=G.slice(1),W-=1,Q=1,$+=1),G=G.filter(function(ke){return ke.y1<=$});var ee=s(k.rotation);ee&&G.forEach(function(ke){ke.x0+=ee,ke.x1+=ee});var ie=Math.min(W,R),ae=function(ke){return(ke-Q)/ie*B},oe=function(ke,Me){return[ke*Math.cos(Me),-ke*Math.sin(Me)]},de=function(ke){return l.pathAnnulus(ke.rpx0,ke.rpx1,ke.x0,ke.x1,N,F)},le=function(ke){return N+T(ke)[0]*(ke.transform.rCenter||0)+(ke.transform.x||0)},fe=function(ke){return F+T(ke)[1]*(ke.transform.rCenter||0)+(ke.transform.y||0)};(S=S.data(G,y.getPtId)).enter().append("g").classed("slice",!0),_?S.exit().transition().each(function(){var ke=t.select(this);ke.select("path.surface").transition().attrTween("d",function(Me){var ve=function(ge){var De,_e=y.getPtId(ge),Pe=j[_e],Fe=j[y.getPtId(I)];if(Fe){var ze=(ge.x1>Fe.x1?2*Math.PI:0)+ee;De=ge.rpx1<Fe.rpx1?{rpx0:0,rpx1:0}:{x0:ze,x1:ze}}else{var He,et=y.getPtId(ge.parent);S.each(function(rt){if(y.getPtId(rt)===et)return He=rt});var Re,Ze=He.children;Ze.forEach(function(rt,at){if(y.getPtId(rt)===_e)return Re=at});var Ke=Ze.length,$e=t.interpolate(He.x0,He.x1);De={rpx0:B,rpx1:B,x0:$e(Re/Ke),x1:$e((Re+1)/Ke)}}return t.interpolate(Pe,De)}(Me);return function(ge){return de(ve(ge))}}),ke.select("g.slicetext").attr("opacity",0)}).remove():S.exit().remove(),S.order();var ue=null;if(_&&H){var we=y.getPtId(H);S.each(function(ke){ue===null&&y.getPtId(ke)===we&&(ue=ke.x1)})}var Ae=S;function Se(ke){var Me=ke.parent,ve=j[y.getPtId(Me)],ge={};if(ve){var De=Me.children,_e=De.indexOf(ke),Pe=De.length,Fe=t.interpolate(ve.x0,ve.x1);ge.x0=Fe(_e/Pe),ge.x1=Fe(_e/Pe)}else ge.x0=ge.x1=0;return ge}_&&(Ae=Ae.transition().each("end",function(){var ke=t.select(this);y.setSliceCursor(ke,w,{hideOnRoot:!0,hideOnLeaves:!0,isTransitioning:!1})})),Ae.each(function(ke){var Me=t.select(this),ve=l.ensureSingle(Me,"path","surface",function(ze){ze.style("pointer-events","all")});ke.rpx0=ae(ke.y0),ke.rpx1=ae(ke.y1),ke.xmid=(ke.x0+ke.x1)/2,ke.pxmid=oe(ke.rpx1,ke.xmid),ke.midangle=-(ke.xmid-Math.PI/2),ke.startangle=-(ke.x0-Math.PI/2),ke.stopangle=-(ke.x1-Math.PI/2),ke.halfangle=.5*Math.min(l.angleDelta(ke.x0,ke.x1)||Math.PI,Math.PI),ke.ring=1-ke.rpx0/ke.rpx1,ke.rInscribed=function(ze){return ze.rpx0===0&&l.isFullCircle([ze.x0,ze.x1])?1:Math.max(0,Math.min(1/(1+1/Math.sin(ze.halfangle)),ze.ring/2))}(ke),_?ve.transition().attrTween("d",function(ze){var He=function(et){var Re,Ze=j[y.getPtId(et)],Ke={x0:et.x0,x1:et.x1,rpx0:et.rpx0,rpx1:et.rpx1};if(Ze)Re=Ze;else if(H)if(et.parent)if(ue){var $e=(et.x1>ue?2*Math.PI:0)+ee;Re={x0:$e,x1:$e}}else Re={rpx0:B,rpx1:B},l.extendFlat(Re,Se(et));else Re={rpx0:0,rpx1:0};else Re={x0:ee,x1:ee};return t.interpolate(Re,Ke)}(ze);return function(et){return de(He(et))}}):ve.attr("d",de),Me.call(d,I,w,A,{eventDataKeys:m.eventDataKeys,transitionTime:m.CLICK_TRANSITION_TIME,transitionEasing:m.CLICK_TRANSITION_EASING}).call(y.setSliceCursor,w,{hideOnRoot:!0,hideOnLeaves:!0,isTransitioning:w._transitioning}),ve.call(f,ke,k);var ge=l.ensureSingle(Me,"g","slicetext"),De=l.ensureSingle(ge,"text","",function(ze){ze.attr("data-notex",1)}),_e=l.ensureUniformFontSize(w,y.determineTextFont(k,ke,b.font));De.text(q.formatSliceLabel(ke,I,k,A,b)).classed("slicetext",!0).attr("text-anchor","middle").call(p.font,_e).call(e.convertToTspans,w);var Pe=p.bBox(De.node());ke.transform=c(Pe,ke,C),ke.transform.targetX=le(ke),ke.transform.targetY=fe(ke);var Fe=function(ze,He){var et=ze.transform;return a(et,He),et.fontSize=_e.size,r(k.type,et,b),l.getTextTransform(et)};_?De.transition().attrTween("transform",function(ze){var He=function(et){var Re,Ze=j[y.getPtId(et)],Ke=et.transform;if(Ze)Re=Ze;else if(Re={rpx1:et.rpx1,transform:{textPosAngle:Ke.textPosAngle,scale:0,rotate:Ke.rotate,rCenter:Ke.rCenter,x:Ke.x,y:Ke.y}},H)if(et.parent)if(ue){var $e=et.x1>ue?2*Math.PI:0;Re.x0=Re.x1=$e}else l.extendFlat(Re,Se(et));else Re.x0=Re.x1=ee;else Re.x0=Re.x1=ee;var rt=t.interpolate(Re.transform.textPosAngle,et.transform.textPosAngle),at=t.interpolate(Re.rpx1,et.rpx1),lt=t.interpolate(Re.x0,et.x0),gt=t.interpolate(Re.x1,et.x1),Ie=t.interpolate(Re.transform.scale,Ke.scale),be=t.interpolate(Re.transform.rotate,Ke.rotate),We=Ke.rCenter===0?3:Re.transform.rCenter===0?1/3:1,Ge=t.interpolate(Re.transform.rCenter,Ke.rCenter);return function(st){var ot=at(st),Ce=lt(st),Ue=gt(st),Ye=function(Ee){return Ge(Math.pow(Ee,We))}(st),xe={pxmid:oe(ot,(Ce+Ue)/2),rpx1:ot,transform:{textPosAngle:rt(st),rCenter:Ye,x:Ke.x,y:Ke.y}};return r(k.type,Ke,b),{transform:{targetX:le(xe),targetY:fe(xe),scale:Ie(st),rotate:be(st),rCenter:Ye}}}}(ze);return function(et){return Fe(He(et),Pe)}}):De.attr("transform",Fe(ke,Pe))})}function T(w){return A=w.rpx1,E=w.transform.textPosAngle,[A*Math.sin(E),-A*Math.cos(E)];var A,E}q.plot=function(w,A,E,M){var b,_,S=w._fullLayout,C=S._sunburstlayer,k=!E,L=!S.uniformtext.mode&&y.hasTransition(E);i("sunburst",S),(b=C.selectAll("g.trace.sunburst").data(A,function(I){return I[0].trace.uid})).enter().append("g").classed("trace",!0).classed("sunburst",!0).attr("stroke-linejoin","round"),b.order(),L?(M&&(_=M()),t.transition().duration(E.duration).ease(E.easing).each("end",function(){_&&_()}).each("interrupt",function(){_&&_()}).each(function(){C.selectAll("g.trace").each(function(I){v(w,I,this,E)})})):(b.each(function(I){v(w,I,this,E)}),S.uniformtext.mode&&g(w,S._sunburstlayer.selectAll(".trace"),"sunburst")),k&&b.exit().remove()},q.formatSliceLabel=function(w,A,E,M,b){var _=E.texttemplate,S=E.textinfo;if(!(_||S&&S!=="none"))return"";var C=b.separators,k=M[0],L=w.data.data,I=k.hierarchy,R=y.isHierarchyRoot(w),V=y.getParent(I,w),O=y.getValue(w);if(!_){var J,D=S.split("+"),B=function(ee){return D.indexOf(ee)!==-1},N=[];if(B("label")&&L.label&&N.push(L.label),L.hasOwnProperty("v")&&B("value")&&N.push(y.formatValue(L.v,C)),!R){B("current path")&&N.push(y.getPath(w.data));var F=0;B("percent parent")&&F++,B("percent entry")&&F++,B("percent root")&&F++;var H=F>1;if(F){var j,G=function(ee){J=y.formatPercent(j,C),H&&(J+=" of "+ee),N.push(J)};B("percent parent")&&!R&&(j=O/y.getValue(V),G("parent")),B("percent entry")&&(j=O/y.getValue(A),G("entry")),B("percent root")&&(j=O/y.getValue(I),G("root"))}}return B("text")&&(J=l.castOption(E,L.i,"text"),l.isValidTextValue(J)&&N.push(J)),N.join("<br>")}var W=l.castOption(E,L.i,"texttemplate");if(!W)return"";var Q={};L.label&&(Q.label=L.label),L.hasOwnProperty("v")&&(Q.value=L.v,Q.valueLabel=y.formatValue(L.v,C)),Q.currentPath=y.getPath(w.data),R||(Q.percentParent=O/y.getValue(V),Q.percentParentLabel=y.formatPercent(Q.percentParent,C),Q.parent=y.getPtLabel(V)),Q.percentEntry=O/y.getValue(A),Q.percentEntryLabel=y.formatPercent(Q.percentEntry,C),Q.entry=y.getPtLabel(A),Q.percentRoot=O/y.getValue(I),Q.percentRootLabel=y.formatPercent(Q.percentRoot,C),Q.root=y.getPtLabel(I),L.hasOwnProperty("color")&&(Q.color=L.color);var $=l.castOption(E,L.i,"text");return(l.isValidTextValue($)||$==="")&&(Q.text=$),Q.customdata=l.castOption(E,L.i,"customdata"),l.texttemplateString(W,Q,b._d3locale,Q,E._meta||{})}},{"../../components/drawing":665,"../../lib":778,"../../lib/svg_text_utils":803,"../bar/style":935,"../bar/uniform_text":937,"../pie/helpers":1166,"../pie/plot":1170,"./constants":1302,"./fx":1304,"./helpers":1305,"./style":1310,d3:169,"d3-hierarchy":161}],1310:[function(n,z,q){"use strict";var t=n("d3"),h=n("../../components/color"),p=n("../../lib"),l=n("../bar/uniform_text").resizeText;function e(o,r,i){var u=r.data.data,s=!r.children,a=u.i,c=p.castOption(i,a,"marker.line.color")||h.defaultLine,f=p.castOption(i,a,"marker.line.width")||0;o.style("stroke-width",f).call(h.fill,u.color).call(h.stroke,c).style("opacity",s?i.leaf.opacity:null)}z.exports={style:function(o){var r=o._fullLayout._sunburstlayer.selectAll(".trace");l(o,r,"sunburst"),r.each(function(i){var u=t.select(this),s=i[0].trace;u.style("opacity",s.opacity),u.selectAll("path.surface").each(function(a){t.select(this).call(e,a,s)})})},styleOne:e}},{"../../components/color":643,"../../lib":778,"../bar/uniform_text":937,d3:169}],1311:[function(n,z,q){"use strict";var t=n("../../components/color"),h=n("../../components/colorscale/attributes"),p=n("../../plots/template_attributes").hovertemplateAttrs,l=n("../../plots/attributes"),e=n("../../lib/extend").extendFlat,o=n("../../plot_api/edit_types").overrideAll;function r(u){return{show:{valType:"boolean",dflt:!1},start:{valType:"number",dflt:null,editType:"plot"},end:{valType:"number",dflt:null,editType:"plot"},size:{valType:"number",dflt:null,min:0,editType:"plot"},project:{x:{valType:"boolean",dflt:!1},y:{valType:"boolean",dflt:!1},z:{valType:"boolean",dflt:!1}},color:{valType:"color",dflt:t.defaultLine},usecolormap:{valType:"boolean",dflt:!1},width:{valType:"number",min:1,max:16,dflt:2},highlight:{valType:"boolean",dflt:!0},highlightcolor:{valType:"color",dflt:t.defaultLine},highlightwidth:{valType:"number",min:1,max:16,dflt:2}}}var i=z.exports=o(e({z:{valType:"data_array"},x:{valType:"data_array"},y:{valType:"data_array"},text:{valType:"string",dflt:"",arrayOk:!0},hovertext:{valType:"string",dflt:"",arrayOk:!0},hovertemplate:p(),connectgaps:{valType:"boolean",dflt:!1,editType:"calc"},surfacecolor:{valType:"data_array"}},h("",{colorAttr:"z or surfacecolor",showScaleDflt:!0,autoColorDflt:!1,editTypeOverride:"calc"}),{contours:{x:r(),y:r(),z:r()},hidesurface:{valType:"boolean",dflt:!1},lightposition:{x:{valType:"number",min:-1e5,max:1e5,dflt:10},y:{valType:"number",min:-1e5,max:1e5,dflt:1e4},z:{valType:"number",min:-1e5,max:1e5,dflt:0}},lighting:{ambient:{valType:"number",min:0,max:1,dflt:.8},diffuse:{valType:"number",min:0,max:1,dflt:.8},specular:{valType:"number",min:0,max:2,dflt:.05},roughness:{valType:"number",min:0,max:1,dflt:.5},fresnel:{valType:"number",min:0,max:5,dflt:.2}},opacity:{valType:"number",min:0,max:1,dflt:1},opacityscale:{valType:"any",editType:"calc"},_deprecated:{zauto:e({},h.zauto,{}),zmin:e({},h.zmin,{}),zmax:e({},h.zmax,{})},hoverinfo:e({},l.hoverinfo),showlegend:e({},l.showlegend,{dflt:!1})}),"calc","nested");i.x.editType=i.y.editType=i.z.editType="calc+clearAxisTypes",i.transforms=void 0},{"../../components/color":643,"../../components/colorscale/attributes":650,"../../lib/extend":768,"../../plot_api/edit_types":810,"../../plots/attributes":824,"../../plots/template_attributes":906}],1312:[function(n,z,q){"use strict";var t=n("../../components/colorscale/calc");z.exports=function(h,p){p.surfacecolor?t(h,p,{vals:p.surfacecolor,containerStr:"",cLetter:"c"}):t(h,p,{vals:p.z,containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":651}],1313:[function(n,z,q){"use strict";var t=n("gl-surface3d"),h=n("ndarray"),p=n("ndarray-linear-interpolate").d2,l=n("../heatmap/interp2d"),e=n("../heatmap/find_empties"),o=n("../../lib").isArrayOrTypedArray,r=n("../../lib/gl_format_color").parseColorScale,i=n("../../lib/str2rgbarray"),u=n("../../components/colorscale").extractOpts;function s(M,b,_){this.scene=M,this.uid=_,this.surface=b,this.data=null,this.showContour=[!1,!1,!1],this.contourStart=[null,null,null],this.contourEnd=[null,null,null],this.contourSize=[0,0,0],this.minValues=[1/0,1/0,1/0],this.maxValues=[-1/0,-1/0,-1/0],this.dataScaleX=1,this.dataScaleY=1,this.refineData=!0,this.objectOffset=[0,0,0]}var a=s.prototype;a.getXat=function(M,b,_,S){var C=o(this.data.x)?o(this.data.x[0])?this.data.x[b][M]:this.data.x[M]:M;return _===void 0?C:S.d2l(C,0,_)},a.getYat=function(M,b,_,S){var C=o(this.data.y)?o(this.data.y[0])?this.data.y[b][M]:this.data.y[b]:b;return _===void 0?C:S.d2l(C,0,_)},a.getZat=function(M,b,_,S){var C=this.data.z[b][M];return C===null&&this.data.connectgaps&&this.data._interpolatedZ&&(C=this.data._interpolatedZ[b][M]),_===void 0?C:S.d2l(C,0,_)},a.handlePick=function(M){if(M.object===this.surface){var b=(M.data.index[0]-1)/this.dataScaleX-1,_=(M.data.index[1]-1)/this.dataScaleY-1,S=Math.max(Math.min(Math.round(b),this.data.z[0].length-1),0),C=Math.max(Math.min(Math.round(_),this.data._ylength-1),0);M.index=[S,C],M.traceCoordinate=[this.getXat(S,C),this.getYat(S,C),this.getZat(S,C)],M.dataCoordinate=[this.getXat(S,C,this.data.xcalendar,this.scene.fullSceneLayout.xaxis),this.getYat(S,C,this.data.ycalendar,this.scene.fullSceneLayout.yaxis),this.getZat(S,C,this.data.zcalendar,this.scene.fullSceneLayout.zaxis)];for(var k=0;k<3;k++){var L=M.dataCoordinate[k];L!=null&&(M.dataCoordinate[k]*=this.scene.dataScale[k])}var I=this.data.hovertext||this.data.text;return Array.isArray(I)&&I[C]&&I[C][S]!==void 0?M.textLabel=I[C][S]:M.textLabel=I||"",M.data.dataCoordinate=M.dataCoordinate.slice(),this.surface.highlight(M.data),this.scene.glplot.spikes.position=M.dataCoordinate,!0}};var c=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997,1009,1013,1019,1021,1031,1033,1039,1049,1051,1061,1063,1069,1087,1091,1093,1097,1103,1109,1117,1123,1129,1151,1153,1163,1171,1181,1187,1193,1201,1213,1217,1223,1229,1231,1237,1249,1259,1277,1279,1283,1289,1291,1297,1301,1303,1307,1319,1321,1327,1361,1367,1373,1381,1399,1409,1423,1427,1429,1433,1439,1447,1451,1453,1459,1471,1481,1483,1487,1489,1493,1499,1511,1523,1531,1543,1549,1553,1559,1567,1571,1579,1583,1597,1601,1607,1609,1613,1619,1621,1627,1637,1657,1663,1667,1669,1693,1697,1699,1709,1721,1723,1733,1741,1747,1753,1759,1777,1783,1787,1789,1801,1811,1823,1831,1847,1861,1867,1871,1873,1877,1879,1889,1901,1907,1913,1931,1933,1949,1951,1973,1979,1987,1993,1997,1999,2003,2011,2017,2027,2029,2039,2053,2063,2069,2081,2083,2087,2089,2099,2111,2113,2129,2131,2137,2141,2143,2153,2161,2179,2203,2207,2213,2221,2237,2239,2243,2251,2267,2269,2273,2281,2287,2293,2297,2309,2311,2333,2339,2341,2347,2351,2357,2371,2377,2381,2383,2389,2393,2399,2411,2417,2423,2437,2441,2447,2459,2467,2473,2477,2503,2521,2531,2539,2543,2549,2551,2557,2579,2591,2593,2609,2617,2621,2633,2647,2657,2659,2663,2671,2677,2683,2687,2689,2693,2699,2707,2711,2713,2719,2729,2731,2741,2749,2753,2767,2777,2789,2791,2797,2801,2803,2819,2833,2837,2843,2851,2857,2861,2879,2887,2897,2903,2909,2917,2927,2939,2953,2957,2963,2969,2971,2999];function f(M,b){if(M<b)return 0;for(var _=0;Math.floor(M%b)===0;)M/=b,_++;return _}function g(M){for(var b=[],_=0;_<c.length;_++){var S=c[_];b.push(f(M,S))}return b}function d(M){for(var b=g(M),_=M,S=0;S<c.length;S++)if(b[S]>0){_=c[S];break}return _}function m(M,b){if(!(M<1||b<1)){for(var _=g(M),S=g(b),C=1,k=0;k<c.length;k++)C*=Math.pow(c[k],Math.max(_[k],S[k]));return C}}a.calcXnums=function(M){var b,_=[];for(b=1;b<M;b++){var S=this.getXat(b-1,0),C=this.getXat(b,0);_[b-1]=C!==S&&S!=null&&C!=null?Math.abs(C-S):0}var k=0;for(b=1;b<M;b++)k+=_[b-1];for(b=1;b<M;b++)_[b-1]===0?_[b-1]=1:_[b-1]=Math.round(k/_[b-1]);return _},a.calcYnums=function(M){var b,_=[];for(b=1;b<M;b++){var S=this.getYat(0,b-1),C=this.getYat(0,b);_[b-1]=C!==S&&S!=null&&C!=null?Math.abs(C-S):0}var k=0;for(b=1;b<M;b++)k+=_[b-1];for(b=1;b<M;b++)_[b-1]===0?_[b-1]=1:_[b-1]=Math.round(k/_[b-1]);return _};var y=[1,2,4,6,12,24,36,48,60,120,180,240,360,720,840,1260],v=y[9],T=y[13];function w(M,b,_){var S=_[8]+_[2]*b[0]+_[5]*b[1];return M[0]=(_[6]+_[0]*b[0]+_[3]*b[1])/S,M[1]=(_[7]+_[1]*b[0]+_[4]*b[1])/S,M}function A(M,b,_){return function(S,C,k,L){for(var I=[0,0],R=S.shape[0],V=S.shape[1],O=0;O<R;O++)for(var J=0;J<V;J++)k(I,[O,J],L),S.set(O,J,p(C,I[0],I[1]))}(M,b,w,_),M}function E(M,b){for(var _=!1,S=0;S<M.length;S++)if(b===M[S]){_=!0;break}_===!1&&M.push(b)}a.estimateScale=function(M,b){for(var _=1+function(C){if(C.length!==0){for(var k=1,L=0;L<C.length;L++)k=m(k,C[L]);return k}}(b===0?this.calcXnums(M):this.calcYnums(M));_<v;)_*=2;for(;_>T;)_--,_/=d(_),++_<v&&(_=T);var S=Math.round(_/M);return S>1?S:1},a.refineCoords=function(M){for(var b=this.dataScaleX,_=this.dataScaleY,S=M[0].shape[0],C=M[0].shape[1],k=0|Math.floor(M[0].shape[0]*b+1),L=0|Math.floor(M[0].shape[1]*_+1),I=1+S+1,R=1+C+1,V=h(new Float32Array(I*R),[I,R]),O=[1/b,0,0,0,1/_,0,0,0,1],J=0;J<M.length;++J){this.surface.padField(V,M[J]);var D=h(new Float32Array(k*L),[k,L]);A(D,V,O),M[J]=D}},a.setContourLevels=function(){var M,b,_,S=[[],[],[]],C=[!1,!1,!1],k=!1;for(M=0;M<3;++M)if(this.showContour[M]&&(k=!0,this.contourSize[M]>0&&this.contourStart[M]!==null&&this.contourEnd[M]!==null&&this.contourEnd[M]>this.contourStart[M]))for(C[M]=!0,b=this.contourStart[M];b<this.contourEnd[M];b+=this.contourSize[M])_=b*this.scene.dataScale[M],E(S[M],_);if(k){var L=[[],[],[]];for(M=0;M<3;++M)this.showContour[M]&&(L[M]=C[M]?S[M]:this.scene.contourLevels[M]);this.surface.update({levels:L})}},a.update=function(M){var b,_,S,C,k=this.scene,L=k.fullSceneLayout,I=this.surface,R=r(M),V=k.dataScale,O=M.z[0].length,J=M._ylength,D=k.contourLevels;this.data=M;var B=[];for(b=0;b<3;b++)for(B[b]=[],_=0;_<O;_++)B[b][_]=[];for(_=0;_<O;_++)for(S=0;S<J;S++)B[0][_][S]=this.getXat(_,S,M.xcalendar,L.xaxis),B[1][_][S]=this.getYat(_,S,M.ycalendar,L.yaxis),B[2][_][S]=this.getZat(_,S,M.zcalendar,L.zaxis);if(M.connectgaps)for(M._emptypoints=e(B[2]),l(B[2],M._emptypoints),M._interpolatedZ=[],_=0;_<O;_++)for(M._interpolatedZ[_]=[],S=0;S<J;S++)M._interpolatedZ[_][S]=B[2][_][S];for(b=0;b<3;b++)for(_=0;_<O;_++)for(S=0;S<J;S++)(C=B[b][_][S])==null?B[b][_][S]=NaN:C=B[b][_][S]*=V[b];for(b=0;b<3;b++)for(_=0;_<O;_++)for(S=0;S<J;S++)(C=B[b][_][S])!=null&&(this.minValues[b]>C&&(this.minValues[b]=C),this.maxValues[b]<C&&(this.maxValues[b]=C));for(b=0;b<3;b++)this.objectOffset[b]=.5*(this.minValues[b]+this.maxValues[b]);for(b=0;b<3;b++)for(_=0;_<O;_++)for(S=0;S<J;S++)(C=B[b][_][S])!=null&&(B[b][_][S]-=this.objectOffset[b]);var N=[h(new Float32Array(O*J),[O,J]),h(new Float32Array(O*J),[O,J]),h(new Float32Array(O*J),[O,J])];for(b=0;b<3;b++)for(_=0;_<O;_++)for(S=0;S<J;S++)N[b].set(_,S,B[b][_][S]);B=[];var F={colormap:R,levels:[[],[],[]],showContour:[!0,!0,!0],showSurface:!M.hidesurface,contourProject:[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1]],contourWidth:[1,1,1],contourColor:[[1,1,1,1],[1,1,1,1],[1,1,1,1]],contourTint:[1,1,1],dynamicColor:[[1,1,1,1],[1,1,1,1],[1,1,1,1]],dynamicWidth:[1,1,1],dynamicTint:[1,1,1],opacityscale:M.opacityscale,opacity:M.opacity},H=u(M);if(F.intensityBounds=[H.min,H.max],M.surfacecolor){var j=h(new Float32Array(O*J),[O,J]);for(_=0;_<O;_++)for(S=0;S<J;S++)j.set(_,S,M.surfacecolor[S][_]);N.push(j)}else F.intensityBounds[0]*=V[2],F.intensityBounds[1]*=V[2];(T<N[0].shape[0]||T<N[0].shape[1])&&(this.refineData=!1),this.refineData===!0&&(this.dataScaleX=this.estimateScale(N[0].shape[0],0),this.dataScaleY=this.estimateScale(N[0].shape[1],1),this.dataScaleX===1&&this.dataScaleY===1||this.refineCoords(N)),M.surfacecolor&&(F.intensity=N.pop());var G=[!0,!0,!0],W=["x","y","z"];for(b=0;b<3;++b){var Q=M.contours[W[b]];G[b]=Q.highlight,F.showContour[b]=Q.show||Q.highlight,F.showContour[b]&&(F.contourProject[b]=[Q.project.x,Q.project.y,Q.project.z],Q.show?(this.showContour[b]=!0,F.levels[b]=D[b],I.highlightColor[b]=F.contourColor[b]=i(Q.color),Q.usecolormap?I.highlightTint[b]=F.contourTint[b]=0:I.highlightTint[b]=F.contourTint[b]=1,F.contourWidth[b]=Q.width,this.contourStart[b]=Q.start,this.contourEnd[b]=Q.end,this.contourSize[b]=Q.size):(this.showContour[b]=!1,this.contourStart[b]=null,this.contourEnd[b]=null,this.contourSize[b]=0),Q.highlight&&(F.dynamicColor[b]=i(Q.highlightcolor),F.dynamicWidth[b]=Q.highlightwidth))}(function($){var ee=$[0].rgb,ie=$[$.length-1].rgb;return ee[0]===ie[0]&&ee[1]===ie[1]&&ee[2]===ie[2]&&ee[3]===ie[3]})(R)&&(F.vertexColor=!0),F.objectOffset=this.objectOffset,F.coords=N,I.update(F),I.visible=M.visible,I.enableDynamic=G,I.enableHighlight=G,I.snapToData=!0,"lighting"in M&&(I.ambientLight=M.lighting.ambient,I.diffuseLight=M.lighting.diffuse,I.specularLight=M.lighting.specular,I.roughness=M.lighting.roughness,I.fresnel=M.lighting.fresnel),"lightposition"in M&&(I.lightPosition=[M.lightposition.x,M.lightposition.y,M.lightposition.z])},a.dispose=function(){this.scene.glplot.remove(this.surface),this.surface.dispose()},z.exports=function(M,b){var _=M.glplot.gl,S=t({gl:_}),C=new s(M,S,b.uid);return S._trace=C,C.update(b),M.glplot.add(S),C}},{"../../components/colorscale":655,"../../lib":778,"../../lib/gl_format_color":774,"../../lib/str2rgbarray":802,"../heatmap/find_empties":1071,"../heatmap/interp2d":1074,"gl-surface3d":351,ndarray:495,"ndarray-linear-interpolate":489}],1314:[function(n,z,q){"use strict";var t=n("../../registry"),h=n("../../lib"),p=n("../../components/colorscale/defaults"),l=n("./attributes");function e(r,i,u,s){var a=s("opacityscale");a==="max"?i.opacityscale=[[0,.1],[1,1]]:a==="min"?i.opacityscale=[[0,1],[1,.1]]:a==="extremes"?i.opacityscale=function(c,f){for(var g=[],d=0;d<32;d++){var m=d/31,y=f+(1-f)*(1-Math.pow(Math.sin(c*m*Math.PI),2));g.push([m,Math.max(0,Math.min(1,y))])}return g}(1,.1):function(c){var f=0;if(!Array.isArray(c)||c.length<2||!c[0]||!c[c.length-1]||+c[0][0]!=0||+c[c.length-1][0]!=1)return!1;for(var g=0;g<c.length;g++){var d=c[g];if(d.length!==2||+d[0]<f)return!1;f=+d[0]}return!0}(a)||(i.opacityscale=void 0)}function o(r,i,u){i in r&&!(u in r)&&(r[u]=r[i])}z.exports={supplyDefaults:function(r,i,u,s){var a,c;function f(E,M){return h.coerce(r,i,l,E,M)}var g=f("x"),d=f("y"),m=f("z");if(!m||!m.length||g&&g.length<1||d&&d.length<1)i.visible=!1;else{i._xlength=Array.isArray(g)&&h.isArrayOrTypedArray(g[0])?m.length:m[0].length,i._ylength=m.length,t.getComponentMethod("calendars","handleTraceDefaults")(r,i,["x","y","z"],s),f("text"),f("hovertext"),f("hovertemplate"),["lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lightposition.x","lightposition.y","lightposition.z","hidesurface","connectgaps","opacity"].forEach(function(E){f(E)});var y=f("surfacecolor"),v=["x","y","z"];for(a=0;a<3;++a){var T="contours."+v[a],w=f(T+".show"),A=f(T+".highlight");if(w||A)for(c=0;c<3;++c)f(T+".project."+v[c]);w&&(f(T+".color"),f(T+".width"),f(T+".usecolormap")),A&&(f(T+".highlightcolor"),f(T+".highlightwidth")),f(T+".start"),f(T+".end"),f(T+".size")}y||(o(r,"zmin","cmin"),o(r,"zmax","cmax"),o(r,"zauto","cauto")),p(r,i,s,f,{prefix:"",cLetter:"c"}),e(r,i,s,f),i._length=null}},opacityscaleDefaults:e}},{"../../components/colorscale/defaults":653,"../../lib":778,"../../registry":911,"./attributes":1311}],1315:[function(n,z,q){"use strict";z.exports={attributes:n("./attributes"),supplyDefaults:n("./defaults").supplyDefaults,colorbar:{min:"cmin",max:"cmax"},calc:n("./calc"),plot:n("./convert"),moduleType:"trace",name:"surface",basePlotModule:n("../../plots/gl3d"),categories:["gl3d","2dMap","showLegend"],meta:{}}},{"../../plots/gl3d":870,"./attributes":1311,"./calc":1312,"./convert":1313,"./defaults":1314}],1316:[function(n,z,q){"use strict";var t=n("../../components/annotations/attributes"),h=n("../../lib/extend").extendFlat,p=n("../../plot_api/edit_types").overrideAll,l=n("../../plots/font_attributes"),e=n("../../plots/domain").attributes;n("../../constants/docs").FORMAT_LINK,(z.exports=p({domain:e({name:"table",trace:!0}),columnwidth:{valType:"number",arrayOk:!0,dflt:null},columnorder:{valType:"data_array"},header:{values:{valType:"data_array",dflt:[]},format:{valType:"data_array",dflt:[]},prefix:{valType:"string",arrayOk:!0,dflt:null},suffix:{valType:"string",arrayOk:!0,dflt:null},height:{valType:"number",dflt:28},align:h({},t.align,{arrayOk:!0}),line:{width:{valType:"number",arrayOk:!0,dflt:1},color:{valType:"color",arrayOk:!0,dflt:"grey"}},fill:{color:{valType:"color",arrayOk:!0,dflt:"white"}},font:h({},l({arrayOk:!0}))},cells:{values:{valType:"data_array",dflt:[]},format:{valType:"data_array",dflt:[]},prefix:{valType:"string",arrayOk:!0,dflt:null},suffix:{valType:"string",arrayOk:!0,dflt:null},height:{valType:"number",dflt:20},align:h({},t.align,{arrayOk:!0}),line:{width:{valType:"number",arrayOk:!0,dflt:1},color:{valType:"color",arrayOk:!0,dflt:"grey"}},fill:{color:{valType:"color",arrayOk:!0,dflt:"white"}},font:h({},l({arrayOk:!0}))}},"calc","from-root")).transforms=void 0},{"../../components/annotations/attributes":626,"../../constants/docs":748,"../../lib/extend":768,"../../plot_api/edit_types":810,"../../plots/domain":855,"../../plots/font_attributes":856}],1317:[function(n,z,q){"use strict";var t=n("../../plots/get_data").getModuleCalcData,h=n("./plot");q.name="table",q.plot=function(p){var l=t(p.calcdata,"table")[0];l.length&&h(p,l)},q.clean=function(p,l,e,o){var r=o._has&&o._has("table"),i=l._has&&l._has("table");r&&!i&&o._paperdiv.selectAll(".table").remove()}},{"../../plots/get_data":865,"./plot":1324}],1318:[function(n,z,q){"use strict";var t=n("../../lib/gup").wrap;z.exports=function(){return t({})}},{"../../lib/gup":775}],1319:[function(n,z,q){"use strict";z.exports={cellPad:8,columnExtentOffset:10,columnTitleOffset:28,emptyHeaderHeight:16,latexCheck:/^\$.*\$$/,goldenRatio:1.618,lineBreaker:"<br>",maxDimensionCount:60,overdrag:45,releaseTransitionDuration:120,releaseTransitionEase:"cubic-out",scrollbarCaptureWidth:18,scrollbarHideDelay:1e3,scrollbarHideDuration:1e3,scrollbarOffset:5,scrollbarWidth:8,transitionDuration:100,transitionEase:"cubic-out",uplift:5,wrapSpacer:" ",wrapSplitCharacter:" ",cn:{table:"table",tableControlView:"table-control-view",scrollBackground:"scroll-background",yColumn:"y-column",columnBlock:"column-block",scrollAreaClip:"scroll-area-clip",scrollAreaClipRect:"scroll-area-clip-rect",columnBoundary:"column-boundary",columnBoundaryClippath:"column-boundary-clippath",columnBoundaryRect:"column-boundary-rect",columnCells:"column-cells",columnCell:"column-cell",cellRect:"cell-rect",cellText:"cell-text",cellTextHolder:"cell-text-holder",scrollbarKit:"scrollbar-kit",scrollbar:"scrollbar",scrollbarSlider:"scrollbar-slider",scrollbarGlyph:"scrollbar-glyph",scrollbarCaptureZone:"scrollbar-capture-zone"}}},{}],1320:[function(n,z,q){"use strict";var t=n("./constants"),h=n("../../lib/extend").extendFlat,p=n("fast-isnumeric");function l(a){if(Array.isArray(a)){for(var c=0,f=0;f<a.length;f++)c=Math.max(c,l(a[f]));return c}return a}function e(a,c){return a+c}function o(a){var c,f=a.slice(),g=1/0,d=0;for(c=0;c<f.length;c++)Array.isArray(f[c])||(f[c]=[f[c]]),g=Math.min(g,f[c].length),d=Math.max(d,f[c].length);if(g!==d)for(c=0;c<f.length;c++){var m=d-f[c].length;m&&(f[c]=f[c].concat(r(m)))}return f}function r(a){for(var c=new Array(a),f=0;f<a;f++)c[f]="";return c}function i(a){return a.calcdata.columns.reduce(function(c,f){return f.xIndex<a.xIndex?c+f.columnWidth:c},0)}function u(a,c){return Object.keys(a).map(function(f){return h({},a[f],{auxiliaryBlocks:c})})}function s(a,c){for(var f,g={},d=0,m=0,y={firstRowIndex:null,lastRowIndex:null,rows:[]},v=0,T=0,w=0;w<a.length;w++)f=a[w],y.rows.push({rowIndex:w,rowHeight:f}),((m+=f)>=c||w===a.length-1)&&(g[d]=y,y.key=T++,y.firstRowIndex=v,y.lastRowIndex=w,y={firstRowIndex:null,lastRowIndex:null,rows:[]},d+=m,v=w+1,m=0);return g}z.exports=function(a,c){var f=o(c.cells.values),g=function(V){return V.slice(c.header.values.length,V.length)},d=o(c.header.values);d.length&&!d[0].length&&(d[0]=[""],d=o(d));var m=d.concat(g(f).map(function(){return r((d[0]||[""]).length)})),y=c.domain,v=Math.floor(a._fullLayout._size.w*(y.x[1]-y.x[0])),T=Math.floor(a._fullLayout._size.h*(y.y[1]-y.y[0])),w=c.header.values.length?m[0].map(function(){return c.header.height}):[t.emptyHeaderHeight],A=f.length?f[0].map(function(){return c.cells.height}):[],E=w.reduce(e,0),M=s(A,T-E+t.uplift),b=u(s(w,E),[]),_=u(M,b),S={},C=c._fullInput.columnorder.concat(g(f.map(function(V,O){return O}))),k=m.map(function(V,O){var J=Array.isArray(c.columnwidth)?c.columnwidth[Math.min(O,c.columnwidth.length-1)]:c.columnwidth;return p(J)?Number(J):1}),L=k.reduce(e,0);k=k.map(function(V){return V/L*v});var I=Math.max(l(c.header.line.width),l(c.cells.line.width)),R={key:c.uid+a._context.staticPlot,translateX:y.x[0]*a._fullLayout._size.w,translateY:a._fullLayout._size.h*(1-y.y[1]),size:a._fullLayout._size,width:v,maxLineWidth:I,height:T,columnOrder:C,groupHeight:T,rowBlocks:_,headerRowBlocks:b,scrollY:0,cells:h({},c.cells,{values:f}),headerCells:h({},c.header,{values:m}),gdColumns:m.map(function(V){return V[0]}),gdColumnsOriginalOrder:m.map(function(V){return V[0]}),prevPages:[0,0],scrollbarState:{scrollbarScrollInProgress:!1},columns:m.map(function(V,O){var J=S[V];return S[V]=(J||0)+1,{key:V+"__"+S[V],label:V,specIndex:O,xIndex:C[O],xScale:i,x:void 0,calcdata:void 0,columnWidth:k[O]}})};return R.columns.forEach(function(V){V.calcdata=R,V.x=i(V)}),R}},{"../../lib/extend":768,"./constants":1319,"fast-isnumeric":241}],1321:[function(n,z,q){"use strict";var t=n("../../lib/extend").extendFlat;q.splitToPanels=function(h){var p=[0,0],l=t({},h,{key:"header",type:"header",page:0,prevPages:p,currentRepaint:[null,null],dragHandle:!0,values:h.calcdata.headerCells.values[h.specIndex],rowBlocks:h.calcdata.headerRowBlocks,calcdata:t({},h.calcdata,{cells:h.calcdata.headerCells})});return[t({},h,{key:"cells1",type:"cells",page:0,prevPages:p,currentRepaint:[null,null],dragHandle:!1,values:h.calcdata.cells.values[h.specIndex],rowBlocks:h.calcdata.rowBlocks}),t({},h,{key:"cells2",type:"cells",page:1,prevPages:p,currentRepaint:[null,null],dragHandle:!1,values:h.calcdata.cells.values[h.specIndex],rowBlocks:h.calcdata.rowBlocks}),l]},q.splitToCells=function(h){var p=function(l){var e=l.rowBlocks[l.page],o=e?e.rows[0].rowIndex:0,r=e?o+e.rows.length:0;return[o,r]}(h);return(h.values||[]).slice(p[0],p[1]).map(function(l,e){return{keyWithinBlock:e+(typeof l=="string"&&l.match(/[<$&> ]/)?"_keybuster_"+Math.random():""),key:p[0]+e,column:h,calcdata:h.calcdata,page:h.page,rowBlocks:h.rowBlocks,value:l}})}},{"../../lib/extend":768}],1322:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("./attributes"),p=n("../../plots/domain").defaults;z.exports=function(l,e,o,r){function i(u,s){return t.coerce(l,e,h,u,s)}p(e,r,i),i("columnwidth"),i("header.values"),i("header.format"),i("header.align"),i("header.prefix"),i("header.suffix"),i("header.height"),i("header.line.width"),i("header.line.color"),i("header.fill.color"),t.coerceFont(i,"header.font",t.extendFlat({},r.font)),function(u,s){for(var a=u.columnorder||[],c=u.header.values.length,f=a.slice(0,c),g=f.slice().sort(function(y,v){return y-v}),d=f.map(function(y){return g.indexOf(y)}),m=d.length;m<c;m++)d.push(m);s("columnorder",d)}(e,i),i("cells.values"),i("cells.format"),i("cells.align"),i("cells.prefix"),i("cells.suffix"),i("cells.height"),i("cells.line.width"),i("cells.line.color"),i("cells.fill.color"),t.coerceFont(i,"cells.font",t.extendFlat({},r.font)),e._length=null}},{"../../lib":778,"../../plots/domain":855,"./attributes":1316}],1323:[function(n,z,q){"use strict";z.exports={attributes:n("./attributes"),supplyDefaults:n("./defaults"),calc:n("./calc"),plot:n("./plot"),moduleType:"trace",name:"table",basePlotModule:n("./base_plot"),categories:["noOpacity"],meta:{}}},{"./attributes":1316,"./base_plot":1317,"./calc":1318,"./defaults":1322,"./plot":1324}],1324:[function(n,z,q){"use strict";var t=n("./constants"),h=n("d3"),p=n("../../lib/gup"),l=n("../../components/drawing"),e=n("../../lib/svg_text_utils"),o=n("../../lib").raiseToTop,r=n("../../lib").strTranslate,i=n("../../lib").cancelTransition,u=n("./data_preparation_helper"),s=n("./data_split_helpers"),a=n("../../components/color");function c(B){return Math.ceil(B.calcdata.maxLineWidth/2)}function f(B,N){return"clip"+B._fullLayout._uid+"_scrollAreaBottomClip_"+N.key}function g(B,N){return"clip"+B._fullLayout._uid+"_columnBoundaryClippath_"+N.calcdata.key+"_"+N.specIndex}function d(B){return[].concat.apply([],B.map(function(N){return N})).map(function(N){return N.__data__})}function m(B,N,F){var H=B.selectAll("."+t.cn.scrollbarKit).data(p.repeat,p.keyFun);H.enter().append("g").classed(t.cn.scrollbarKit,!0).style("shape-rendering","geometricPrecision"),H.each(function($){var ee=$.scrollbarState;ee.totalHeight=function(ie){var ae=ie.rowBlocks;return V(ae,ae.length-1)+(ae.length?O(ae[ae.length-1],1/0):1)}($),ee.scrollableAreaHeight=$.groupHeight-b($),ee.currentlyVisibleHeight=Math.min(ee.totalHeight,ee.scrollableAreaHeight),ee.ratio=ee.currentlyVisibleHeight/ee.totalHeight,ee.barLength=Math.max(ee.ratio*ee.currentlyVisibleHeight,t.goldenRatio*t.scrollbarWidth),ee.barWiggleRoom=ee.currentlyVisibleHeight-ee.barLength,ee.wiggleRoom=Math.max(0,ee.totalHeight-ee.scrollableAreaHeight),ee.topY=ee.barWiggleRoom===0?0:$.scrollY/ee.wiggleRoom*ee.barWiggleRoom,ee.bottomY=ee.topY+ee.barLength,ee.dragMultiplier=ee.wiggleRoom/ee.barWiggleRoom}).attr("transform",function($){var ee=$.width+t.scrollbarWidth/2+t.scrollbarOffset;return r(ee,b($))});var j=H.selectAll("."+t.cn.scrollbar).data(p.repeat,p.keyFun);j.enter().append("g").classed(t.cn.scrollbar,!0);var G=j.selectAll("."+t.cn.scrollbarSlider).data(p.repeat,p.keyFun);G.enter().append("g").classed(t.cn.scrollbarSlider,!0),G.attr("transform",function($){return r(0,$.scrollbarState.topY||0)});var W=G.selectAll("."+t.cn.scrollbarGlyph).data(p.repeat,p.keyFun);W.enter().append("line").classed(t.cn.scrollbarGlyph,!0).attr("stroke","black").attr("stroke-width",t.scrollbarWidth).attr("stroke-linecap","round").attr("y1",t.scrollbarWidth/2),W.attr("y2",function($){return $.scrollbarState.barLength-t.scrollbarWidth/2}).attr("stroke-opacity",function($){return $.columnDragInProgress||!$.scrollbarState.barWiggleRoom||F?0:.4}),W.transition().delay(0).duration(0),W.transition().delay(t.scrollbarHideDelay).duration(t.scrollbarHideDuration).attr("stroke-opacity",0);var Q=j.selectAll("."+t.cn.scrollbarCaptureZone).data(p.repeat,p.keyFun);Q.enter().append("line").classed(t.cn.scrollbarCaptureZone,!0).attr("stroke","white").attr("stroke-opacity",.01).attr("stroke-width",t.scrollbarCaptureWidth).attr("stroke-linecap","butt").attr("y1",0).on("mousedown",function($){var ee=h.event.y,ie=this.getBoundingClientRect(),ae=$.scrollbarState,oe=ee-ie.top,de=h.scale.linear().domain([0,ae.scrollableAreaHeight]).range([0,ae.totalHeight]).clamp(!0);ae.topY<=oe&&oe<=ae.bottomY||S(N,B,null,de(oe-ae.barLength/2))($)}).call(h.behavior.drag().origin(function($){return h.event.stopPropagation(),$.scrollbarState.scrollbarScrollInProgress=!0,$}).on("drag",S(N,B)).on("dragend",function(){})),Q.attr("y2",function($){return $.scrollbarState.scrollableAreaHeight}),N._context.staticPlot&&(W.remove(),Q.remove())}function y(B,N,F,H){var j=function(W){var Q=W.selectAll("."+t.cn.columnCell).data(s.splitToCells,function($){return $.keyWithinBlock});return Q.enter().append("g").classed(t.cn.columnCell,!0),Q.exit().remove(),Q}(function(W){var Q=W.selectAll("."+t.cn.columnCells).data(p.repeat,p.keyFun);return Q.enter().append("g").classed(t.cn.columnCells,!0),Q.exit().remove(),Q}(F));(function(W){W.each(function(Q,$){var ee=Q.calcdata.cells.font,ie=Q.column.specIndex,ae={size:w(ee.size,ie,$),color:w(ee.color,ie,$),family:w(ee.family,ie,$)};Q.rowNumber=Q.key,Q.align=w(Q.calcdata.cells.align,ie,$),Q.cellBorderWidth=w(Q.calcdata.cells.line.width,ie,$),Q.font=ae})})(j),function(W){W.attr("width",function(Q){return Q.column.columnWidth}).attr("stroke-width",function(Q){return Q.cellBorderWidth}).each(function(Q){var $=h.select(this);a.stroke($,w(Q.calcdata.cells.line.color,Q.column.specIndex,Q.rowNumber)),a.fill($,w(Q.calcdata.cells.fill.color,Q.column.specIndex,Q.rowNumber))})}(function(W){var Q=W.selectAll("."+t.cn.cellRect).data(p.repeat,function($){return $.keyWithinBlock});return Q.enter().append("rect").classed(t.cn.cellRect,!0),Q}(j));var G=function(W){var Q=W.selectAll("."+t.cn.cellText).data(p.repeat,function($){return $.keyWithinBlock});return Q.enter().append("text").classed(t.cn.cellText,!0).style("cursor",function(){return"auto"}).on("mousedown",function(){h.event.stopPropagation()}),Q}(function(W){var Q=W.selectAll("."+t.cn.cellTextHolder).data(p.repeat,function($){return $.keyWithinBlock});return Q.enter().append("g").classed(t.cn.cellTextHolder,!0).style("shape-rendering","geometricPrecision"),Q}(j));(function(W){W.each(function(Q){l.font(h.select(this),Q.font)})})(G),v(G,N,H,B),R(j)}function v(B,N,F,H){B.text(function(j){var G=j.column.specIndex,W=j.rowNumber,Q=j.value,$=typeof Q=="string",ee=$&&Q.match(/<br>/i),ie=!$||ee;j.mayHaveMarkup=$&&Q.match(/[<&>]/);var ae,oe=typeof(ae=Q)=="string"&&ae.match(t.latexCheck);j.latex=oe;var de,le,fe=oe?"":w(j.calcdata.cells.prefix,G,W)||"",ue=oe?"":w(j.calcdata.cells.suffix,G,W)||"",we=oe?null:w(j.calcdata.cells.format,G,W)||null,Ae=fe+(we?h.format(we)(j.value):j.value)+ue;if(j.wrappingNeeded=!j.wrapped&&!ie&&!oe&&(de=T(Ae)),j.cellHeightMayIncrease=ee||oe||j.mayHaveMarkup||(de===void 0?T(Ae):de),j.needsConvertToTspans=j.mayHaveMarkup||j.wrappingNeeded||j.latex,j.wrappingNeeded){var Se=(t.wrapSplitCharacter===" "?Ae.replace(/<a href=/gi,"<a_href="):Ae).split(t.wrapSplitCharacter),ke=t.wrapSplitCharacter===" "?Se.map(function(Me){return Me.replace(/<a_href=/gi,"<a href=")}):Se;j.fragments=ke.map(function(Me){return{text:Me,width:null}}),j.fragments.push({fragment:t.wrapSpacer,width:null}),le=ke.join(t.lineBreaker)+t.lineBreaker+t.wrapSpacer}else delete j.fragments,le=Ae;return le}).attr("dy",function(j){return j.needsConvertToTspans?0:"0.75em"}).each(function(j){var G=h.select(this),W=j.wrappingNeeded?k:L;j.needsConvertToTspans?e.convertToTspans(G,H,W(F,this,N,H,j)):h.select(this.parentNode).attr("transform",function(Q){return r(I(Q),t.cellPad)}).attr("text-anchor",function(Q){return{left:"start",center:"middle",right:"end"}[Q.align]})})}function T(B){return B.indexOf(t.wrapSplitCharacter)!==-1}function w(B,N,F){if(Array.isArray(B)){var H=B[Math.min(N,B.length-1)];return Array.isArray(H)?H[Math.min(F,H.length-1)]:H}return B}function A(B,N,F){B.transition().ease(t.releaseTransitionEase).duration(t.releaseTransitionDuration).attr("transform",r(N.x,F))}function E(B){return B.type==="cells"}function M(B){return B.type==="header"}function b(B){return(B.rowBlocks.length?B.rowBlocks[0].auxiliaryBlocks:[]).reduce(function(N,F){return N+O(F,1/0)},0)}function _(B,N,F){var H=d(N)[0];if(H!==void 0){var j=H.rowBlocks,G=H.calcdata,W=V(j,j.length),Q=H.calcdata.groupHeight-b(H),$=G.scrollY=Math.max(0,Math.min(W-Q,G.scrollY)),ee=function(ie,ae,oe){for(var de=[],le=0,fe=0;fe<ie.length;fe++){for(var ue=ie[fe],we=ue.rows,Ae=0,Se=0;Se<we.length;Se++)Ae+=we[Se].rowHeight;ue.allRowsHeight=Ae,ae<le+Ae&&ae+oe>le&&de.push(fe),le+=Ae}return de}(j,$,Q);ee.length===1&&(ee[0]===j.length-1?ee.unshift(ee[0]-1):ee.push(ee[0]+1)),ee[0]%2&&ee.reverse(),N.each(function(ie,ae){ie.page=ee[ae],ie.scrollY=$}),N.attr("transform",function(ie){var ae=V(ie.rowBlocks,ie.page)-ie.scrollY;return r(0,ae)}),B&&(C(B,F,N,ee,H.prevPages,H,0),C(B,F,N,ee,H.prevPages,H,1),m(F,B))}}function S(B,N,F,H){return function(j){var G=j.calcdata?j.calcdata:j,W=N.filter(function(ie){return G.key===ie.key}),Q=F||G.scrollbarState.dragMultiplier,$=G.scrollY;G.scrollY=H===void 0?G.scrollY+Q*h.event.dy:H;var ee=W.selectAll("."+t.cn.yColumn).selectAll("."+t.cn.columnBlock).filter(E);return _(B,ee,W),G.scrollY===$}}function C(B,N,F,H,j,G,W){H[W]!==j[W]&&(clearTimeout(G.currentRepaint[W]),G.currentRepaint[W]=setTimeout(function(){var Q=F.filter(function($,ee){return ee===W&&H[ee]!==j[ee]});y(B,N,Q,F),j[W]=H[W]}))}function k(B,N,F,H){return function(){var j=h.select(N.parentNode);j.each(function(G){var W=G.fragments;j.selectAll("tspan.line").each(function(le,fe){W[fe].width=this.getComputedTextLength()});var Q,$,ee=W[W.length-1].width,ie=W.slice(0,-1),ae=[],oe=0,de=G.column.columnWidth-2*t.cellPad;for(G.value="";ie.length;)oe+($=(Q=ie.shift()).width+ee)>de&&(G.value+=ae.join(t.wrapSpacer)+t.lineBreaker,ae=[],oe=0),ae.push(Q.text),oe+=$;oe&&(G.value+=ae.join(t.wrapSpacer)),G.wrapped=!0}),j.selectAll("tspan.line").remove(),v(j.select("."+t.cn.cellText),F,B,H),h.select(N.parentNode.parentNode).call(R)}}function L(B,N,F,H,j){return function(){if(!j.settledY){var G=h.select(N.parentNode),W=D(j),Q=j.key-W.firstRowIndex,$=W.rows[Q].rowHeight,ee=j.cellHeightMayIncrease?N.parentNode.getBoundingClientRect().height+2*t.cellPad:$,ie=Math.max(ee,$);ie-W.rows[Q].rowHeight&&(W.rows[Q].rowHeight=ie,B.selectAll("."+t.cn.columnCell).call(R),_(null,B.filter(E),0),m(F,H,!0)),G.attr("transform",function(){var ae=this.parentNode.getBoundingClientRect(),oe=h.select(this.parentNode).select("."+t.cn.cellRect).node().getBoundingClientRect(),de=this.transform.baseVal.consolidate(),le=oe.top-ae.top+(de?de.matrix.f:t.cellPad);return r(I(j,h.select(this.parentNode).select("."+t.cn.cellTextHolder).node().getBoundingClientRect().width),le)}),j.settledY=!0}}}function I(B,N){switch(B.align){case"left":return t.cellPad;case"right":return B.column.columnWidth-(N||0)-t.cellPad;case"center":return(B.column.columnWidth-(N||0))/2;default:return t.cellPad}}function R(B){B.attr("transform",function(N){var F=N.rowBlocks[0].auxiliaryBlocks.reduce(function(j,G){return j+O(G,1/0)},0),H=O(D(N),N.key);return r(0,H+F)}).selectAll("."+t.cn.cellRect).attr("height",function(N){return(F=D(N),H=N.key,F.rows[H-F.firstRowIndex]).rowHeight;var F,H})}function V(B,N){for(var F=0,H=N-1;H>=0;H--)F+=J(B[H]);return F}function O(B,N){for(var F=0,H=0;H<B.rows.length&&B.rows[H].rowIndex<N;H++)F+=B.rows[H].rowHeight;return F}function J(B){var N=B.allRowsHeight;if(N!==void 0)return N;for(var F=0,H=0;H<B.rows.length;H++)F+=B.rows[H].rowHeight;return B.allRowsHeight=F,F}function D(B){return B.rowBlocks[B.page]}z.exports=function(B,N){var F=!B._context.staticPlot,H=B._fullLayout._paper.selectAll("."+t.cn.table).data(N.map(function(ue){var we=p.unwrap(ue).trace;return u(B,we)}),p.keyFun);H.exit().remove(),H.enter().append("g").classed(t.cn.table,!0).attr("overflow","visible").style("box-sizing","content-box").style("position","absolute").style("left",0).style("overflow","visible").style("shape-rendering","crispEdges").style("pointer-events","all"),H.attr("width",function(ue){return ue.width+ue.size.l+ue.size.r}).attr("height",function(ue){return ue.height+ue.size.t+ue.size.b}).attr("transform",function(ue){return r(ue.translateX,ue.translateY)});var j=H.selectAll("."+t.cn.tableControlView).data(p.repeat,p.keyFun),G=j.enter().append("g").classed(t.cn.tableControlView,!0).style("box-sizing","content-box");if(F){var W="onwheel"in document?"wheel":"mousewheel";G.on("mousemove",function(ue){j.filter(function(we){return ue===we}).call(m,B)}).on(W,function(ue){if(!ue.scrollbarState.wheeling){ue.scrollbarState.wheeling=!0;var we=ue.scrollY+h.event.deltaY;S(B,j,null,we)(ue)||(h.event.stopPropagation(),h.event.preventDefault()),ue.scrollbarState.wheeling=!1}}).call(m,B,!0)}j.attr("transform",function(ue){return r(ue.size.l,ue.size.t)});var Q=j.selectAll("."+t.cn.scrollBackground).data(p.repeat,p.keyFun);Q.enter().append("rect").classed(t.cn.scrollBackground,!0).attr("fill","none"),Q.attr("width",function(ue){return ue.width}).attr("height",function(ue){return ue.height}),j.each(function(ue){l.setClipUrl(h.select(this),f(B,ue),B)});var $=j.selectAll("."+t.cn.yColumn).data(function(ue){return ue.columns},p.keyFun);$.enter().append("g").classed(t.cn.yColumn,!0),$.exit().remove(),$.attr("transform",function(ue){return r(ue.x,0)}),F&&$.call(h.behavior.drag().origin(function(ue){return A(h.select(this),ue,-t.uplift),o(this),ue.calcdata.columnDragInProgress=!0,m(j.filter(function(we){return ue.calcdata.key===we.key}),B),ue}).on("drag",function(ue){var we=h.select(this),Ae=function(Se){return(ue===Se?h.event.x:Se.x)+Se.columnWidth/2};ue.x=Math.max(-t.overdrag,Math.min(ue.calcdata.width+t.overdrag-ue.columnWidth,h.event.x)),d($).filter(function(Se){return Se.calcdata.key===ue.calcdata.key}).sort(function(Se,ke){return Ae(Se)-Ae(ke)}).forEach(function(Se,ke){Se.xIndex=ke,Se.x=ue===Se?Se.x:Se.xScale(Se)}),$.filter(function(Se){return ue!==Se}).transition().ease(t.transitionEase).duration(t.transitionDuration).attr("transform",function(Se){return r(Se.x,0)}),we.call(i).attr("transform",r(ue.x,-t.uplift))}).on("dragend",function(ue){var we=h.select(this),Ae=ue.calcdata;ue.x=ue.xScale(ue),ue.calcdata.columnDragInProgress=!1,A(we,ue,0),function(Se,ke,Me){var ve=ke.gdColumnsOriginalOrder;ke.gdColumns.sort(function(ge,De){return Me[ve.indexOf(ge)]-Me[ve.indexOf(De)]}),ke.columnorder=Me,Se.emit("plotly_restyle")}(B,Ae,Ae.columns.map(function(Se){return Se.xIndex}))})),$.each(function(ue){l.setClipUrl(h.select(this),g(B,ue),B)});var ee=$.selectAll("."+t.cn.columnBlock).data(s.splitToPanels,p.keyFun);ee.enter().append("g").classed(t.cn.columnBlock,!0).attr("id",function(ue){return ue.key}),ee.style("cursor",function(ue){return ue.dragHandle?"ew-resize":ue.calcdata.scrollbarState.barWiggleRoom?"ns-resize":"default"});var ie=ee.filter(M),ae=ee.filter(E);F&&ae.call(h.behavior.drag().origin(function(ue){return h.event.stopPropagation(),ue}).on("drag",S(B,j,-1)).on("dragend",function(){})),y(B,j,ie,ee),y(B,j,ae,ee);var oe=j.selectAll("."+t.cn.scrollAreaClip).data(p.repeat,p.keyFun);oe.enter().append("clipPath").classed(t.cn.scrollAreaClip,!0).attr("id",function(ue){return f(B,ue)});var de=oe.selectAll("."+t.cn.scrollAreaClipRect).data(p.repeat,p.keyFun);de.enter().append("rect").classed(t.cn.scrollAreaClipRect,!0).attr("x",-t.overdrag).attr("y",-t.uplift).attr("fill","none"),de.attr("width",function(ue){return ue.width+2*t.overdrag}).attr("height",function(ue){return ue.height+t.uplift}),$.selectAll("."+t.cn.columnBoundary).data(p.repeat,p.keyFun).enter().append("g").classed(t.cn.columnBoundary,!0);var le=$.selectAll("."+t.cn.columnBoundaryClippath).data(p.repeat,p.keyFun);le.enter().append("clipPath").classed(t.cn.columnBoundaryClippath,!0),le.attr("id",function(ue){return g(B,ue)});var fe=le.selectAll("."+t.cn.columnBoundaryRect).data(p.repeat,p.keyFun);fe.enter().append("rect").classed(t.cn.columnBoundaryRect,!0).attr("fill","none"),fe.attr("width",function(ue){return ue.columnWidth+2*c(ue)}).attr("height",function(ue){return ue.calcdata.height+2*c(ue)+t.uplift}).attr("x",function(ue){return-c(ue)}).attr("y",function(ue){return-c(ue)}),_(null,ae,j)}},{"../../components/color":643,"../../components/drawing":665,"../../lib":778,"../../lib/gup":775,"../../lib/svg_text_utils":803,"./constants":1319,"./data_preparation_helper":1320,"./data_split_helpers":1321,d3:169}],1325:[function(n,z,q){"use strict";var t=n("../../plots/template_attributes").hovertemplateAttrs,h=n("../../plots/template_attributes").texttemplateAttrs,p=n("../../components/colorscale/attributes"),l=n("../../plots/domain").attributes,e=n("../pie/attributes"),o=n("../sunburst/attributes"),r=n("./constants"),i=n("../../lib/extend").extendFlat;z.exports={labels:o.labels,parents:o.parents,values:o.values,branchvalues:o.branchvalues,count:o.count,level:o.level,maxdepth:o.maxdepth,tiling:{packing:{valType:"enumerated",values:["squarify","binary","dice","slice","slice-dice","dice-slice"],dflt:"squarify",editType:"plot"},squarifyratio:{valType:"number",min:1,dflt:1,editType:"plot"},flip:{valType:"flaglist",flags:["x","y"],dflt:"",editType:"plot"},pad:{valType:"number",min:0,dflt:3,editType:"plot"},editType:"calc"},marker:i({pad:{t:{valType:"number",min:0,editType:"plot"},l:{valType:"number",min:0,editType:"plot"},r:{valType:"number",min:0,editType:"plot"},b:{valType:"number",min:0,editType:"plot"},editType:"calc"},colors:o.marker.colors,depthfade:{valType:"enumerated",values:[!0,!1,"reversed"],editType:"style"},line:o.marker.line,editType:"calc"},p("marker",{colorAttr:"colors",anim:!1})),pathbar:{visible:{valType:"boolean",dflt:!0,editType:"plot"},side:{valType:"enumerated",values:["top","bottom"],dflt:"top",editType:"plot"},edgeshape:{valType:"enumerated",values:[">","<","|","/","\\"],dflt:">",editType:"plot"},thickness:{valType:"number",min:12,editType:"plot"},textfont:i({},e.textfont,{}),editType:"calc"},text:e.text,textinfo:o.textinfo,texttemplate:h({editType:"plot"},{keys:r.eventDataKeys.concat(["label","value"])}),hovertext:e.hovertext,hoverinfo:o.hoverinfo,hovertemplate:t({},{keys:r.eventDataKeys}),textfont:e.textfont,insidetextfont:e.insidetextfont,outsidetextfont:i({},e.outsidetextfont,{}),textposition:{valType:"enumerated",values:["top left","top center","top right","middle left","middle center","middle right","bottom left","bottom center","bottom right"],dflt:"top left",editType:"plot"},sort:e.sort,root:o.root,domain:l({name:"treemap",trace:!0,editType:"calc"})}},{"../../components/colorscale/attributes":650,"../../lib/extend":768,"../../plots/domain":855,"../../plots/template_attributes":906,"../pie/attributes":1161,"../sunburst/attributes":1299,"./constants":1328}],1326:[function(n,z,q){"use strict";var t=n("../../plots/plots");q.name="treemap",q.plot=function(h,p,l,e){t.plotBasePlot(q.name,h,p,l,e)},q.clean=function(h,p,l,e){t.cleanBasePlot(q.name,h,p,l,e)}},{"../../plots/plots":891}],1327:[function(n,z,q){"use strict";var t=n("../sunburst/calc");q.calc=function(h,p){return t.calc(h,p)},q.crossTraceCalc=function(h){return t._runCrossTraceCalc("treemap",h)}},{"../sunburst/calc":1301}],1328:[function(n,z,q){"use strict";z.exports={CLICK_TRANSITION_TIME:750,CLICK_TRANSITION_EASING:"poly",eventDataKeys:["currentPath","root","entry","percentRoot","percentEntry","percentParent"],gapWithPathbar:1}},{}],1329:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("./attributes"),p=n("../../components/color"),l=n("../../plots/domain").defaults,e=n("../bar/defaults").handleText,o=n("../bar/constants").TEXTPAD,r=n("../../components/colorscale"),i=r.hasColorscale,u=r.handleDefaults;z.exports=function(s,a,c,f){function g(b,_){return t.coerce(s,a,h,b,_)}var d=g("labels"),m=g("parents");if(d&&d.length&&m&&m.length){var y=g("values");y&&y.length?g("branchvalues"):g("count"),g("level"),g("maxdepth"),g("tiling.packing")==="squarify"&&g("tiling.squarifyratio"),g("tiling.flip"),g("tiling.pad");var v=g("text");g("texttemplate"),a.texttemplate||g("textinfo",Array.isArray(v)?"text+label":"label"),g("hovertext"),g("hovertemplate");var T=g("pathbar.visible");e(s,a,f,g,"auto",{hasPathbar:T,moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),g("textposition");var w=a.textposition.indexOf("bottom")!==-1;g("marker.line.width")&&g("marker.line.color",f.paper_bgcolor);var A=g("marker.colors"),E=a._hasColorscale=i(s,"marker","colors")||(s.marker||{}).coloraxis;E?u(s,a,f,g,{prefix:"marker.",cLetter:"c"}):g("marker.depthfade",!(A||[]).length);var M=2*a.textfont.size;g("marker.pad.t",w?M/4:M),g("marker.pad.l",M/4),g("marker.pad.r",M/4),g("marker.pad.b",w?M:M/4),E&&u(s,a,f,g,{prefix:"marker.",cLetter:"c"}),a._hovered={marker:{line:{width:2,color:p.contrast(f.paper_bgcolor)}}},T&&(g("pathbar.thickness",a.pathbar.textfont.size+2*o),g("pathbar.side"),g("pathbar.edgeshape")),g("sort"),g("root.color"),l(a,f,g),a._length=null}else a.visible=!1}},{"../../components/color":643,"../../components/colorscale":655,"../../lib":778,"../../plots/domain":855,"../bar/constants":923,"../bar/defaults":925,"./attributes":1325}],1330:[function(n,z,q){"use strict";var t=n("d3"),h=n("../../lib"),p=n("../../components/drawing"),l=n("../../lib/svg_text_utils"),e=n("./partition"),o=n("./style").styleOne,r=n("./constants"),i=n("../sunburst/helpers"),u=n("../sunburst/fx");z.exports=function(s,a,c,f,g){var d=g.barDifY,m=g.width,y=g.height,v=g.viewX,T=g.viewY,w=g.pathSlice,A=g.toMoveInsideSlice,E=g.strTransform,M=g.hasTransition,b=g.handleSlicesExit,_=g.makeUpdateSliceInterpolator,S=g.makeUpdateTextInterpolator,C={},k=s._fullLayout,L=a[0],I=L.trace,R=L.hierarchy,V=m/I._entryDepth,O=i.listPath(c.data,"id"),J=e(R.copy(),[m,y],{packing:"dice",pad:{inner:0,top:0,left:0,right:0,bottom:0}}).descendants();(J=J.filter(function(B){var N=O.indexOf(B.data.id);return N!==-1&&(B.x0=V*N,B.x1=V*(N+1),B.y0=d,B.y1=d+y,B.onPathbar=!0,!0)})).reverse(),(f=f.data(J,i.getPtId)).enter().append("g").classed("pathbar",!0),b(f,!0,C,[m,y],w),f.order();var D=f;M&&(D=D.transition().each("end",function(){var B=t.select(this);i.setSliceCursor(B,s,{hideOnRoot:!1,hideOnLeaves:!1,isTransitioning:!1})})),D.each(function(B){B._hoverX=v(B.x1-Math.min(m,y)/2),B._hoverY=T(B.y1-y/2);var N=t.select(this),F=h.ensureSingle(N,"path","surface",function(W){W.style("pointer-events","all")});M?F.transition().attrTween("d",function(W){var Q=_(W,!0,C,[m,y]);return function($){return w(Q($))}}):F.attr("d",w),N.call(u,c,s,a,{styleOne:o,eventDataKeys:r.eventDataKeys,transitionTime:r.CLICK_TRANSITION_TIME,transitionEasing:r.CLICK_TRANSITION_EASING}).call(i.setSliceCursor,s,{hideOnRoot:!1,hideOnLeaves:!1,isTransitioning:s._transitioning}),F.call(o,B,I,{hovered:!1}),B._text=(i.getPtLabel(B)||"").split("<br>").join(" ")||"";var H=h.ensureSingle(N,"g","slicetext"),j=h.ensureSingle(H,"text","",function(W){W.attr("data-notex",1)}),G=h.ensureUniformFontSize(s,i.determineTextFont(I,B,k.font,{onPathbar:!0}));j.text(B._text||" ").classed("slicetext",!0).attr("text-anchor","start").call(p.font,G).call(l.convertToTspans,s),B.textBB=p.bBox(j.node()),B.transform=A(B,{fontSize:G.size,onPathbar:!0}),B.transform.fontSize=G.size,M?j.transition().attrTween("transform",function(W){var Q=S(W,!0,C,[m,y]);return function($){return E(Q($))}}):j.attr("transform",E(B))})}},{"../../components/drawing":665,"../../lib":778,"../../lib/svg_text_utils":803,"../sunburst/fx":1304,"../sunburst/helpers":1305,"./constants":1328,"./partition":1335,"./style":1337,d3:169}],1331:[function(n,z,q){"use strict";var t=n("d3"),h=n("../../lib"),p=n("../../components/drawing"),l=n("../../lib/svg_text_utils"),e=n("./partition"),o=n("./style").styleOne,r=n("./constants"),i=n("../sunburst/helpers"),u=n("../sunburst/fx"),s=n("../sunburst/plot").formatSliceLabel;z.exports=function(a,c,f,g,d){var m=d.width,y=d.height,v=d.viewX,T=d.viewY,w=d.pathSlice,A=d.toMoveInsideSlice,E=d.strTransform,M=d.hasTransition,b=d.handleSlicesExit,_=d.makeUpdateSliceInterpolator,S=d.makeUpdateTextInterpolator,C=d.prevEntry,k=a._fullLayout,L=c[0].trace,I=L.textposition.indexOf("left")!==-1,R=L.textposition.indexOf("right")!==-1,V=L.textposition.indexOf("bottom")!==-1,O=!V&&!L.marker.pad.t||V&&!L.marker.pad.b,J=e(f,[m,y],{packing:L.tiling.packing,squarifyratio:L.tiling.squarifyratio,flipX:L.tiling.flip.indexOf("x")>-1,flipY:L.tiling.flip.indexOf("y")>-1,pad:{inner:L.tiling.pad,top:L.marker.pad.t,left:L.marker.pad.l,right:L.marker.pad.r,bottom:L.marker.pad.b}}).descendants(),D=1/0,B=-1/0;J.forEach(function(G){var W=G.depth;W>=L._maxDepth?(G.x0=G.x1=(G.x0+G.x1)/2,G.y0=G.y1=(G.y0+G.y1)/2):(D=Math.min(D,W),B=Math.max(B,W))}),g=g.data(J,i.getPtId),L._maxVisibleLayers=isFinite(B)?B-D+1:0,g.enter().append("g").classed("slice",!0),b(g,!1,{},[m,y],w),g.order();var N=null;if(M&&C){var F=i.getPtId(C);g.each(function(G){N===null&&i.getPtId(G)===F&&(N={x0:G.x0,x1:G.x1,y0:G.y0,y1:G.y1})})}var H=function(){return N||{x0:0,x1:m,y0:0,y1:y}},j=g;return M&&(j=j.transition().each("end",function(){var G=t.select(this);i.setSliceCursor(G,a,{hideOnRoot:!0,hideOnLeaves:!1,isTransitioning:!1})})),j.each(function(G){var W=i.isHeader(G,L);G._hoverX=v(G.x1-L.marker.pad.r),G._hoverY=T(V?G.y1-L.marker.pad.b/2:G.y0+L.marker.pad.t/2);var Q=t.select(this),$=h.ensureSingle(Q,"path","surface",function(oe){oe.style("pointer-events","all")});M?$.transition().attrTween("d",function(oe){var de=_(oe,!1,H(),[m,y]);return function(le){return w(de(le))}}):$.attr("d",w),Q.call(u,f,a,c,{styleOne:o,eventDataKeys:r.eventDataKeys,transitionTime:r.CLICK_TRANSITION_TIME,transitionEasing:r.CLICK_TRANSITION_EASING}).call(i.setSliceCursor,a,{isTransitioning:a._transitioning}),$.call(o,G,L,{hovered:!1}),G.x0===G.x1||G.y0===G.y1?G._text="":G._text=W?O?"":i.getPtLabel(G)||"":s(G,f,L,c,k)||"";var ee=h.ensureSingle(Q,"g","slicetext"),ie=h.ensureSingle(ee,"text","",function(oe){oe.attr("data-notex",1)}),ae=h.ensureUniformFontSize(a,i.determineTextFont(L,G,k.font));ie.text(G._text||" ").classed("slicetext",!0).attr("text-anchor",R?"end":I||W?"start":"middle").call(p.font,ae).call(l.convertToTspans,a),G.textBB=p.bBox(ie.node()),G.transform=A(G,{fontSize:ae.size,isHeader:W}),G.transform.fontSize=ae.size,M?ie.transition().attrTween("transform",function(oe){var de=S(oe,!1,H(),[m,y]);return function(le){return E(de(le))}}):ie.attr("transform",E(G))}),N}},{"../../components/drawing":665,"../../lib":778,"../../lib/svg_text_utils":803,"../sunburst/fx":1304,"../sunburst/helpers":1305,"../sunburst/plot":1309,"./constants":1328,"./partition":1335,"./style":1337,d3:169}],1332:[function(n,z,q){"use strict";z.exports={moduleType:"trace",name:"treemap",basePlotModule:n("./base_plot"),categories:[],animatable:!0,attributes:n("./attributes"),layoutAttributes:n("./layout_attributes"),supplyDefaults:n("./defaults"),supplyLayoutDefaults:n("./layout_defaults"),calc:n("./calc").calc,crossTraceCalc:n("./calc").crossTraceCalc,plot:n("./plot"),style:n("./style").style,colorbar:n("../scatter/marker_colorbar"),meta:{}}},{"../scatter/marker_colorbar":1205,"./attributes":1325,"./base_plot":1326,"./calc":1327,"./defaults":1329,"./layout_attributes":1333,"./layout_defaults":1334,"./plot":1336,"./style":1337}],1333:[function(n,z,q){"use strict";z.exports={treemapcolorway:{valType:"colorlist",editType:"calc"},extendtreemapcolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],1334:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("./layout_attributes");z.exports=function(p,l){function e(o,r){return t.coerce(p,l,h,o,r)}e("treemapcolorway",l.colorway),e("extendtreemapcolors")}},{"../../lib":778,"./layout_attributes":1333}],1335:[function(n,z,q){"use strict";var t=n("d3-hierarchy");z.exports=function(h,p,l){var e,o=l.flipX,r=l.flipY,i=l.packing==="dice-slice",u=l.pad[r?"bottom":"top"],s=l.pad[o?"right":"left"],a=l.pad[o?"left":"right"],c=l.pad[r?"top":"bottom"];i&&(e=s,s=u,u=e,e=a,a=c,c=e);var f=t.treemap().tile(function(g,d){switch(g){case"squarify":return t.treemapSquarify.ratio(d);case"binary":return t.treemapBinary;case"dice":return t.treemapDice;case"slice":return t.treemapSlice;default:return t.treemapSliceDice}}(l.packing,l.squarifyratio)).paddingInner(l.pad.inner).paddingLeft(s).paddingRight(a).paddingTop(u).paddingBottom(c).size(i?[p[1],p[0]]:p)(h);return(i||o||r)&&function g(d,m,y){var v;y.swapXY&&(v=d.x0,d.x0=d.y0,d.y0=v,v=d.x1,d.x1=d.y1,d.y1=v),y.flipX&&(v=d.x0,d.x0=m[0]-d.x1,d.x1=m[0]-v),y.flipY&&(v=d.y0,d.y0=m[1]-d.y1,d.y1=m[1]-v);var T=d.children;if(T)for(var w=0;w<T.length;w++)g(T[w],m,y)}(f,p,{swapXY:i,flipX:o,flipY:r}),f}},{"d3-hierarchy":161}],1336:[function(n,z,q){"use strict";var t=n("d3"),h=n("../sunburst/helpers"),p=n("../../lib"),l=n("../bar/constants").TEXTPAD,e=n("../bar/plot").toMoveInsideBar,o=n("../bar/uniform_text"),r=o.recordMinTextSize,i=o.clearMinTextSize,u=n("../bar/style").resizeText,s=n("./constants"),a=n("./draw_descendants"),c=n("./draw_ancestors");function f(d){return h.isHierarchyRoot(d)?"":h.getPtId(d)}function g(d,m,y,v){var T=d._fullLayout,w=m[0],A=w.trace,E=w.hierarchy,M=h.findEntryWithLevel(E,A.level),b=t.select(y),_=b.selectAll("g.pathbar"),S=b.selectAll("g.slice");if(!M)return _.remove(),void S.remove();var C=h.isHierarchyRoot(M),k=!T.uniformtext.mode&&h.hasTransition(v),L=h.getMaxDepth(A),I=T._size,R=A.domain,V=I.w*(R.x[1]-R.x[0]),O=I.h*(R.y[1]-R.y[0]),J=V,D=A.pathbar.thickness,B=A.marker.line.width+s.gapWithPathbar,N=A.pathbar.visible?A.pathbar.side.indexOf("bottom")>-1?O+B:-(D+B):0,F={x0:J,x1:J,y0:N,y1:N+D},H=function(ze,He,et){var Re=A.tiling.pad,Ze=function(at){return at-Re<=He.x0},Ke=function(at){return at+Re>=He.x1},$e=function(at){return at-Re<=He.y0},rt=function(at){return at+Re>=He.y1};return{x0:Ze(ze.x0-Re)?0:Ke(ze.x0-Re)?et[0]:ze.x0,x1:Ze(ze.x1+Re)?0:Ke(ze.x1+Re)?et[0]:ze.x1,y0:$e(ze.y0-Re)?0:rt(ze.y0-Re)?et[1]:ze.y0,y1:$e(ze.y1+Re)?0:rt(ze.y1+Re)?et[1]:ze.y1}},j=null,G={},W={},Q=null,$=function(ze,He){return He?G[f(ze)]:W[f(ze)]},ee=function(ze,He,et,Re){if(He)return G[f(E)]||F;var Ze=W[A.level]||et;return function(Ke){return Ke.data.depth-M.data.depth<L}(ze)?H(ze,Ze,Re):{}};w.hasMultipleRoots&&C&&L++,A._maxDepth=L,A._backgroundColor=T.paper_bgcolor,A._entryDepth=M.data.depth,A._atRootLevel=C;var ie=-V/2+I.l+I.w*(R.x[1]+R.x[0])/2,ae=-O/2+I.t+I.h*(1-(R.y[1]+R.y[0])/2),oe=function(ze){return ie+ze},de=function(ze){return ae+ze},le=de(0),fe=oe(0),ue=function(ze){return fe+ze},we=function(ze){return le+ze};function Ae(ze,He){return ze+","+He}var Se=ue(0),ke=function(ze){ze.x=Math.max(Se,ze.x)},Me=A.pathbar.edgeshape,ve=function(ze,He){var et=ze.x0,Re=ze.x1,Ze=ze.y0,Ke=ze.y1,$e=ze.textBB,rt=function(ot){return A.textposition.indexOf(ot)!==-1},at=rt("bottom"),lt=rt("top")||He.isHeader&&!at?"start":at?"end":"middle",gt=rt("right"),Ie=rt("left")||He.onPathbar?-1:gt?1:0,be=A.marker.pad;if(He.isHeader){if((et+=be.l-l)>=(Re-=be.r-l)){var We=(et+Re)/2;et=We,Re=We}var Ge;at?Ze<(Ge=Ke-be.b)&&Ge<Ke&&(Ze=Ge):Ze<(Ge=Ze+be.t)&&Ge<Ke&&(Ke=Ge)}var st=e(et,Re,Ze,Ke,$e,{isHorizontal:!1,constrained:!0,angle:0,anchor:lt,leftToRight:Ie});return st.fontSize=He.fontSize,st.targetX=oe(st.targetX),st.targetY=de(st.targetY),isNaN(st.targetX)||isNaN(st.targetY)?{}:(et!==Re&&Ze!==Ke&&r(A.type,st,T),{scale:st.scale,rotate:st.rotate,textX:st.textX,textY:st.textY,anchorX:st.anchorX,anchorY:st.anchorY,targetX:st.targetX,targetY:st.targetY})},ge=function(ze,He){for(var et,Re=0,Ze=ze;!et&&Re<L;)Re++,(Ze=Ze.parent)?et=$(Ze,He):Re=L;return et||{}},De=function(ze,He,et,Re){var Ze,Ke=$(ze,He);if(Ke)Ze=Ke;else if(He)Ze=F;else if(j)if(ze.parent){var $e=Q||et;$e&&!He?Ze=H(ze,$e,Re):(Ze={},p.extendFlat(Ze,ge(ze,He)))}else Ze=ze;else Ze={};return t.interpolate(Ze,{x0:ze.x0,x1:ze.x1,y0:ze.y0,y1:ze.y1})},_e=function(ze,He,et,Re){var Ze=$(ze,He),Ke={},$e=ee(ze,He,et,Re);p.extendFlat(Ke,{transform:ve({x0:$e.x0,x1:$e.x1,y0:$e.y0,y1:$e.y1,textBB:ze.textBB,_text:ze._text},{isHeader:h.isHeader(ze,A)})}),Ze?Ke=Ze:ze.parent&&p.extendFlat(Ke,ge(ze,He));var rt=ze.transform;return ze.x0!==ze.x1&&ze.y0!==ze.y1&&r(A.type,rt,T),t.interpolate(Ke,{transform:{scale:rt.scale,rotate:rt.rotate,textX:rt.textX,textY:rt.textY,anchorX:rt.anchorX,anchorY:rt.anchorY,targetX:rt.targetX,targetY:rt.targetY}})},Pe=function(ze,He,et,Re,Ze){var Ke=Re[0],$e=Re[1];k?ze.exit().transition().each(function(){var rt=t.select(this);rt.select("path.surface").transition().attrTween("d",function(at){var lt=function(gt,Ie,be,We){var Ge,st=$(gt,Ie);if(Ie)Ge=F;else{var ot=$(M,Ie);Ge=ot?H(gt,ot,We):{}}return t.interpolate(st,Ge)}(at,He,0,[Ke,$e]);return function(gt){return Ze(lt(gt))}}),rt.select("g.slicetext").attr("opacity",0)}).remove():ze.exit().remove()},Fe=function(ze){var He=ze.transform;return ze.x0!==ze.x1&&ze.y0!==ze.y1&&r(A.type,He,T),p.getTextTransform({textX:He.textX,textY:He.textY,anchorX:He.anchorX,anchorY:He.anchorY,targetX:He.targetX,targetY:He.targetY,scale:He.scale,rotate:He.rotate})};k&&(_.each(function(ze){G[f(ze)]={x0:ze.x0,x1:ze.x1,y0:ze.y0,y1:ze.y1},ze.transform&&(G[f(ze)].transform={textX:ze.transform.textX,textY:ze.transform.textY,anchorX:ze.transform.anchorX,anchorY:ze.transform.anchorY,targetX:ze.transform.targetX,targetY:ze.transform.targetY,scale:ze.transform.scale,rotate:ze.transform.rotate})}),S.each(function(ze){W[f(ze)]={x0:ze.x0,x1:ze.x1,y0:ze.y0,y1:ze.y1},ze.transform&&(W[f(ze)].transform={textX:ze.transform.textX,textY:ze.transform.textY,anchorX:ze.transform.anchorX,anchorY:ze.transform.anchorY,targetX:ze.transform.targetX,targetY:ze.transform.targetY,scale:ze.transform.scale,rotate:ze.transform.rotate}),!j&&h.isEntry(ze)&&(j=ze)})),Q=a(d,m,M,S,{width:V,height:O,viewX:oe,viewY:de,pathSlice:function(ze){var He=oe(ze.x0),et=oe(ze.x1),Re=de(ze.y0),Ze=de(ze.y1),Ke=et-He,$e=Ze-Re;return!Ke||!$e?"":"M"+Ae(He,Re+0)+"L"+Ae(et-0,Re)+"L"+Ae(et,Ze-0)+"L"+Ae(He+0,Ze)+"Z"},toMoveInsideSlice:ve,prevEntry:j,makeUpdateSliceInterpolator:De,makeUpdateTextInterpolator:_e,handleSlicesExit:Pe,hasTransition:k,strTransform:Fe}),A.pathbar.visible?c(d,m,M,_,{barDifY:N,width:J,height:D,viewX:ue,viewY:we,pathSlice:function(ze){var He=ue(Math.max(Math.min(ze.x0,ze.x0),0)),et=ue(Math.min(Math.max(ze.x1,ze.x1),J)),Re=we(ze.y0),Ze=we(ze.y1),Ke=D/2,$e={},rt={};$e.x=He,rt.x=et,$e.y=rt.y=(Re+Ze)/2;var at={x:He,y:Re},lt={x:et,y:Re},gt={x:et,y:Ze},Ie={x:He,y:Ze};return Me===">"?(at.x-=Ke,lt.x-=Ke,gt.x-=Ke,Ie.x-=Ke):Me==="/"?(gt.x-=Ke,Ie.x-=Ke,$e.x-=Ke/2,rt.x-=Ke/2):Me==="\\"?(at.x-=Ke,lt.x-=Ke,$e.x-=Ke/2,rt.x-=Ke/2):Me==="<"&&($e.x-=Ke,rt.x-=Ke),ke(at),ke(Ie),ke($e),ke(lt),ke(gt),ke(rt),"M"+Ae(at.x,at.y)+"L"+Ae(lt.x,lt.y)+"L"+Ae(rt.x,rt.y)+"L"+Ae(gt.x,gt.y)+"L"+Ae(Ie.x,Ie.y)+"L"+Ae($e.x,$e.y)+"Z"},toMoveInsideSlice:ve,makeUpdateSliceInterpolator:De,makeUpdateTextInterpolator:_e,handleSlicesExit:Pe,hasTransition:k,strTransform:Fe}):_.remove()}z.exports=function(d,m,y,v){var T,w,A=d._fullLayout,E=A._treemaplayer,M=!y;i("treemap",A),(T=E.selectAll("g.trace.treemap").data(m,function(b){return b[0].trace.uid})).enter().append("g").classed("trace",!0).classed("treemap",!0),T.order(),!A.uniformtext.mode&&h.hasTransition(y)?(v&&(w=v()),t.transition().duration(y.duration).ease(y.easing).each("end",function(){w&&w()}).each("interrupt",function(){w&&w()}).each(function(){E.selectAll("g.trace").each(function(b){g(d,b,this,y)})})):(T.each(function(b){g(d,b,this,y)}),A.uniformtext.mode&&u(d,A._treemaplayer.selectAll(".trace"),"treemap")),M&&T.exit().remove()}},{"../../lib":778,"../bar/constants":923,"../bar/plot":932,"../bar/style":935,"../bar/uniform_text":937,"../sunburst/helpers":1305,"./constants":1328,"./draw_ancestors":1330,"./draw_descendants":1331,d3:169}],1337:[function(n,z,q){"use strict";var t=n("d3"),h=n("../../components/color"),p=n("../../lib"),l=n("../sunburst/helpers"),e=n("../bar/uniform_text").resizeText;function o(r,i,u,s){var a,c,f=(s||{}).hovered,g=i.data.data,d=g.i,m=g.color,y=l.isHierarchyRoot(i),v=1;if(f)a=u._hovered.marker.line.color,c=u._hovered.marker.line.width;else if(y&&m===u.root.color)v=100,a="rgba(0,0,0,0)",c=0;else if(a=p.castOption(u,d,"marker.line.color")||h.defaultLine,c=p.castOption(u,d,"marker.line.width")||0,!u._hasColorscale&&!i.onPathbar){var T=u.marker.depthfade;if(T){var w,A=h.combine(h.addOpacity(u._backgroundColor,.75),m);if(T===!0){var E=l.getMaxDepth(u);w=isFinite(E)?l.isLeaf(i)?0:u._maxVisibleLayers-(i.data.depth-u._entryDepth):i.data.height+1}else w=i.data.depth-u._entryDepth,u._atRootLevel||w++;if(w>0)for(var M=0;M<w;M++){var b=.5*M/w;m=h.combine(h.addOpacity(A,b),m)}}}r.style("stroke-width",c).call(h.fill,m).call(h.stroke,a).style("opacity",v)}z.exports={style:function(r){var i=r._fullLayout._treemaplayer.selectAll(".trace");e(r,i,"treemap"),i.each(function(u){var s=t.select(this),a=u[0].trace;s.style("opacity",a.opacity),s.selectAll("path.surface").each(function(c){t.select(this).call(o,c,a,{hovered:!1})})})},styleOne:o}},{"../../components/color":643,"../../lib":778,"../bar/uniform_text":937,"../sunburst/helpers":1305,d3:169}],1338:[function(n,z,q){"use strict";var t=n("../box/attributes"),h=n("../../lib/extend").extendFlat;z.exports={y:t.y,x:t.x,x0:t.x0,y0:t.y0,name:h({},t.name,{}),orientation:h({},t.orientation,{}),bandwidth:{valType:"number",min:0,editType:"calc"},scalegroup:{valType:"string",dflt:"",editType:"calc"},scalemode:{valType:"enumerated",values:["width","count"],dflt:"width",editType:"calc"},spanmode:{valType:"enumerated",values:["soft","hard","manual"],dflt:"soft",editType:"calc"},span:{valType:"info_array",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}],editType:"calc"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,dflt:2,editType:"style"},editType:"plot"},fillcolor:t.fillcolor,points:h({},t.boxpoints,{}),jitter:h({},t.jitter,{}),pointpos:h({},t.pointpos,{}),width:h({},t.width,{}),marker:t.marker,text:t.text,hovertext:t.hovertext,hovertemplate:t.hovertemplate,box:{visible:{valType:"boolean",dflt:!1,editType:"plot"},width:{valType:"number",min:0,max:1,dflt:.25,editType:"plot"},fillcolor:{valType:"color",editType:"style"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,editType:"style"},editType:"style"},editType:"plot"},meanline:{visible:{valType:"boolean",dflt:!1,editType:"plot"},color:{valType:"color",editType:"style"},width:{valType:"number",min:0,editType:"style"},editType:"plot"},side:{valType:"enumerated",values:["both","positive","negative"],dflt:"both",editType:"calc"},offsetgroup:t.offsetgroup,alignmentgroup:t.alignmentgroup,selected:t.selected,unselected:t.unselected,hoveron:{valType:"flaglist",flags:["violins","points","kde"],dflt:"violins+points+kde",extras:["all"],editType:"style"}}},{"../../lib/extend":768,"../box/attributes":946}],1339:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../../plots/cartesian/axes"),p=n("../box/calc"),l=n("./helpers"),e=n("../../constants/numerical").BADNUM;function o(i,u,s){var a=u.max-u.min;if(!a)return i.bandwidth?i.bandwidth:0;if(i.bandwidth)return Math.max(i.bandwidth,a/1e4);var c=s.length,f=t.stdev(s,c-1,u.mean);return Math.max(function(g,d,m){return 1.059*Math.min(d,m/1.349)*Math.pow(g,-.2)}(c,f,u.q3-u.q1),a/100)}function r(i,u,s,a){var c,f=i.spanmode,g=i.span||[],d=[u.min,u.max],m=[u.min-2*a,u.max+2*a];function y(T){var w=g[T],A=s.type==="multicategory"?s.r2c(w):s.d2c(w,0,i[u.valLetter+"calendar"]);return A===e?m[T]:A}var v={type:"linear",range:c=f==="soft"?m:f==="hard"?d:[y(0),y(1)]};return h.setConvert(v),v.cleanRange(),c}z.exports=function(i,u){var s=p(i,u);if(s[0].t.empty)return s;for(var a=i._fullLayout,c=h.getFromId(i,u[u.orientation==="h"?"xaxis":"yaxis"]),f=1/0,g=-1/0,d=0,m=0,y=0;y<s.length;y++){var v=s[y],T=v.pts.map(l.extractVal),w=v.bandwidth=o(u,v,T),A=v.span=r(u,v,c,w);if(v.min===v.max&&w===0)A=v.span=[v.min,v.max],v.density=[{v:1,t:A[0]}],v.bandwidth=w,d=Math.max(d,1);else{var E=A[1]-A[0],M=Math.ceil(E/(w/3)),b=E/M;if(!isFinite(b)||!isFinite(M))return t.error("Something went wrong with computing the violin span"),s[0].t.empty=!0,s;var _=l.makeKDE(v,u,T);v.density=new Array(M);for(var S=0,C=A[0];C<A[1]+b/2;S++,C+=b){var k=_(C);v.density[S]={v:k,t:C},d=Math.max(d,k)}}m=Math.max(m,T.length),f=Math.min(f,A[0]),g=Math.max(g,A[1])}var L=h.findExtremes(c,[f,g],{padded:!0});if(u._extremes[c._id]=L,u.width)s[0].t.maxKDE=d;else{var I=a._violinScaleGroupStats,R=u.scalegroup,V=I[R];V?(V.maxKDE=Math.max(V.maxKDE,d),V.maxCount=Math.max(V.maxCount,m)):I[R]={maxKDE:d,maxCount:m}}return s[0].t.labels.kde=t._(i,"kde:"),s}},{"../../constants/numerical":753,"../../lib":778,"../../plots/cartesian/axes":828,"../box/calc":947,"./helpers":1342}],1340:[function(n,z,q){"use strict";var t=n("../box/cross_trace_calc").setPositionOffset,h=["v","h"];z.exports=function(p,l){for(var e=p.calcdata,o=l.xaxis,r=l.yaxis,i=0;i<h.length;i++){for(var u=h[i],s=u==="h"?r:o,a=[],c=0;c<e.length;c++){var f=e[c],g=f[0].t,d=f[0].trace;d.visible!==!0||d.type!=="violin"||g.empty||d.orientation!==u||d.xaxis!==o._id||d.yaxis!==r._id||a.push(c)}t("violin",p,a,s)}}},{"../box/cross_trace_calc":948}],1341:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../../components/color"),p=n("../box/defaults"),l=n("./attributes");z.exports=function(e,o,r,i){function u(E,M){return t.coerce(e,o,l,E,M)}function s(E,M){return t.coerce2(e,o,l,E,M)}if(p.handleSampleDefaults(e,o,u,i),o.visible!==!1){u("bandwidth"),u("side"),u("width")||(u("scalegroup",o.name),u("scalemode"));var a,c=u("span");Array.isArray(c)&&(a="manual"),u("spanmode",a);var f=u("line.color",(e.marker||{}).color||r),g=u("line.width"),d=u("fillcolor",h.addOpacity(o.line.color,.5));p.handlePointsDefaults(e,o,u,{prefix:""});var m=s("box.width"),y=s("box.fillcolor",d),v=s("box.line.color",f),T=s("box.line.width",g);u("box.visible",!!(m||y||v||T))||(o.box={visible:!1});var w=s("meanline.color",f),A=s("meanline.width",g);u("meanline.visible",!!(w||A))||(o.meanline={visible:!1})}}},{"../../components/color":643,"../../lib":778,"../box/defaults":949,"./attributes":1338}],1342:[function(n,z,q){"use strict";var t=n("../../lib"),h=function(p){return 1/Math.sqrt(2*Math.PI)*Math.exp(-.5*p*p)};q.makeKDE=function(p,l,e){var o=e.length,r=h,i=p.bandwidth,u=1/(o*i);return function(s){for(var a=0,c=0;c<o;c++)a+=r((s-e[c])/i);return u*a}},q.getPositionOnKdePath=function(p,l,e){var o,r;l.orientation==="h"?(o="y",r="x"):(o="x",r="y");var i=t.findPointOnPath(p.path,e,r,{pathLength:p.pathLength}),u=p.posCenterPx,s=i[o];return[s,l.side==="both"?2*u-s:u]},q.getKdeValue=function(p,l,e){var o=p.pts.map(q.extractVal);return q.makeKDE(p,l,o)(e)/p.posDensityScale},q.extractVal=function(p){return p.v}},{"../../lib":778}],1343:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../../plots/cartesian/axes"),p=n("../box/hover"),l=n("./helpers");z.exports=function(e,o,r,i,u){var s,a,c=e.cd,f=c[0].trace,g=f.hoveron,d=g.indexOf("violins")!==-1,m=g.indexOf("kde")!==-1,y=[];if(d||m){var v=p.hoverOnBoxes(e,o,r,i);if(m&&v.length>0){var T,w,A,E,M,b=e.xa,_=e.ya;f.orientation==="h"?(M=o,T="y",A=_,w="x",E=b):(M=r,T="x",A=b,w="y",E=_);var S=c[e.index];if(M>=S.span[0]&&M<=S.span[1]){var C=t.extendFlat({},e),k=E.c2p(M,!0),L=l.getKdeValue(S,f,M),I=l.getPositionOnKdePath(S,f,k),R=A._offset,V=A._length;C[T+"0"]=I[0],C[T+"1"]=I[1],C[w+"0"]=C[w+"1"]=k,C[w+"Label"]=w+": "+h.hoverLabelText(E,M)+", "+c[0].t.labels.kde+" "+L.toFixed(3),C.spikeDistance=v[0].spikeDistance;var O=T+"Spike";C[O]=v[0][O],v[0].spikeDistance=void 0,v[0][O]=void 0,C.hovertemplate=!1,y.push(C),(a={stroke:e.color})[T+"1"]=t.constrain(R+I[0],R,R+V),a[T+"2"]=t.constrain(R+I[1],R,R+V),a[w+"1"]=a[w+"2"]=E._offset+k}}d&&(y=y.concat(v))}g.indexOf("points")!==-1&&(s=p.hoverOnPoints(e,o,r));var J=u.selectAll(".violinline-"+f.uid).data(a?[0]:[]);return J.enter().append("line").classed("violinline-"+f.uid,!0).attr("stroke-width",1.5),J.exit().remove(),J.attr(a),i==="closest"?s?[s]:y:(s&&y.push(s),y)}},{"../../lib":778,"../../plots/cartesian/axes":828,"../box/hover":951,"./helpers":1342}],1344:[function(n,z,q){"use strict";z.exports={attributes:n("./attributes"),layoutAttributes:n("./layout_attributes"),supplyDefaults:n("./defaults"),crossTraceDefaults:n("../box/defaults").crossTraceDefaults,supplyLayoutDefaults:n("./layout_defaults"),calc:n("./calc"),crossTraceCalc:n("./cross_trace_calc"),plot:n("./plot"),style:n("./style"),styleOnSelect:n("../scatter/style").styleOnSelect,hoverPoints:n("./hover"),selectPoints:n("../box/select"),moduleType:"trace",name:"violin",basePlotModule:n("../../plots/cartesian"),categories:["cartesian","svg","symbols","oriented","box-violin","showLegend","violinLayout","zoomScale"],meta:{}}},{"../../plots/cartesian":841,"../box/defaults":949,"../box/select":956,"../scatter/style":1211,"./attributes":1338,"./calc":1339,"./cross_trace_calc":1340,"./defaults":1341,"./hover":1343,"./layout_attributes":1345,"./layout_defaults":1346,"./plot":1347,"./style":1348}],1345:[function(n,z,q){"use strict";var t=n("../box/layout_attributes"),h=n("../../lib").extendFlat;z.exports={violinmode:h({},t.boxmode,{}),violingap:h({},t.boxgap,{}),violingroupgap:h({},t.boxgroupgap,{})}},{"../../lib":778,"../box/layout_attributes":953}],1346:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("./layout_attributes"),p=n("../box/layout_defaults");z.exports=function(l,e,o){p._supply(l,e,o,function(r,i){return t.coerce(l,e,h,r,i)},"violin")}},{"../../lib":778,"../box/layout_defaults":954,"./layout_attributes":1345}],1347:[function(n,z,q){"use strict";var t=n("d3"),h=n("../../lib"),p=n("../../components/drawing"),l=n("../box/plot"),e=n("../scatter/line_points"),o=n("./helpers");z.exports=function(r,i,u,s){var a=r._fullLayout,c=i.xaxis,f=i.yaxis;function g(d){var m=e(d,{xaxis:c,yaxis:f,connectGaps:!0,baseTolerance:.75,shape:"spline",simplify:!0,linearized:!0});return p.smoothopen(m[0],1)}h.makeTraceGroups(s,u,"trace violins").each(function(d){var m=t.select(this),y=d[0],v=y.t,T=y.trace;if(T.visible!==!0||v.empty)m.remove();else{var w=v.bPos,A=v.bdPos,E=i[v.valLetter+"axis"],M=i[v.posLetter+"axis"],b=T.side==="both",_=b||T.side==="positive",S=b||T.side==="negative",C=m.selectAll("path.violin").data(h.identity);C.enter().append("path").style("vector-effect","non-scaling-stroke").attr("class","violin"),C.exit().remove(),C.each(function(D){var B,N,F,H,j,G,W,Q,$=t.select(this),ee=D.density,ie=ee.length,ae=M.c2l(D.pos+w,!0),oe=M.l2p(ae);if(T.width)B=v.maxKDE/A;else{var de=a._violinScaleGroupStats[T.scalegroup];B=T.scalemode==="count"?de.maxKDE/A*(de.maxCount/D.pts.length):de.maxKDE/A}if(_){for(W=new Array(ie),j=0;j<ie;j++)(Q=W[j]={})[v.posLetter]=ae+ee[j].v/B,Q[v.valLetter]=E.c2l(ee[j].t,!0);N=g(W)}if(S){for(W=new Array(ie),G=0,j=ie-1;G<ie;G++,j--)(Q=W[G]={})[v.posLetter]=ae-ee[j].v/B,Q[v.valLetter]=E.c2l(ee[j].t,!0);F=g(W)}if(b)H=N+"L"+F.substr(1)+"Z";else{var le=[oe,E.c2p(ee[0].t)],fe=[oe,E.c2p(ee[ie-1].t)];T.orientation==="h"&&(le.reverse(),fe.reverse()),H=_?"M"+le+"L"+N.substr(1)+"L"+fe:"M"+fe+"L"+F.substr(1)+"L"+le}$.attr("d",H),D.posCenterPx=oe,D.posDensityScale=B*A,D.path=$.node(),D.pathLength=D.path.getTotalLength()/(b?2:1)});var k,L,I,R=T.box,V=R.width,O=(R.line||{}).width;b?(k=A*V,L=0):_?(k=[0,A*V/2],L=O*{x:1,y:-1}[v.posLetter]):(k=[A*V/2,0],L=O*{x:-1,y:1}[v.posLetter]),l.plotBoxAndWhiskers(m,{pos:M,val:E},T,{bPos:w,bdPos:k,bPosPxOffset:L}),l.plotBoxMean(m,{pos:M,val:E},T,{bPos:w,bdPos:k,bPosPxOffset:L}),!T.box.visible&&T.meanline.visible&&(I=h.identity);var J=m.selectAll("path.meanline").data(I||[]);J.enter().append("path").attr("class","meanline").style("fill","none").style("vector-effect","non-scaling-stroke"),J.exit().remove(),J.each(function(D){var B=E.c2p(D.mean,!0),N=o.getPositionOnKdePath(D,T,B);t.select(this).attr("d",T.orientation==="h"?"M"+B+","+N[0]+"V"+N[1]:"M"+N[0]+","+B+"H"+N[1])}),l.plotPoints(m,{x:c,y:f},T,v)}})}},{"../../components/drawing":665,"../../lib":778,"../box/plot":955,"../scatter/line_points":1201,"./helpers":1342,d3:169}],1348:[function(n,z,q){"use strict";var t=n("d3"),h=n("../../components/color"),p=n("../scatter/style").stylePoints;z.exports=function(l){var e=t.select(l).selectAll("g.trace.violins");e.style("opacity",function(o){return o[0].trace.opacity}),e.each(function(o){var r=o[0].trace,i=t.select(this),u=r.box||{},s=u.line||{},a=r.meanline||{},c=a.width;i.selectAll("path.violin").style("stroke-width",r.line.width+"px").call(h.stroke,r.line.color).call(h.fill,r.fillcolor),i.selectAll("path.box").style("stroke-width",s.width+"px").call(h.stroke,s.color).call(h.fill,u.fillcolor);var f={"stroke-width":c+"px","stroke-dasharray":2*c+"px,"+c+"px"};i.selectAll("path.mean").style(f).call(h.stroke,a.color),i.selectAll("path.meanline").style(f).call(h.stroke,a.color),p(i,r,l)})}},{"../../components/color":643,"../scatter/style":1211,d3:169}],1349:[function(n,z,q){"use strict";var t=n("../../components/colorscale/attributes"),h=n("../isosurface/attributes"),p=n("../surface/attributes"),l=n("../../plots/attributes"),e=n("../../lib/extend").extendFlat,o=n("../../plot_api/edit_types").overrideAll,r=z.exports=o(e({x:h.x,y:h.y,z:h.z,value:h.value,isomin:h.isomin,isomax:h.isomax,surface:h.surface,spaceframe:{show:{valType:"boolean",dflt:!1},fill:{valType:"number",min:0,max:1,dflt:1}},slices:h.slices,caps:h.caps,text:h.text,hovertext:h.hovertext,hovertemplate:h.hovertemplate},t("",{colorAttr:"`value`",showScaleDflt:!0,editTypeOverride:"calc"}),{colorbar:h.colorbar,opacity:h.opacity,opacityscale:p.opacityscale,lightposition:h.lightposition,lighting:h.lighting,flatshading:h.flatshading,contour:h.contour,hoverinfo:e({},l.hoverinfo),showlegend:e({},l.showlegend,{dflt:!1})}),"calc","nested");r.x.editType=r.y.editType=r.z.editType=r.value.editType="calc+clearAxisTypes",r.transforms=void 0},{"../../components/colorscale/attributes":650,"../../lib/extend":768,"../../plot_api/edit_types":810,"../../plots/attributes":824,"../isosurface/attributes":1123,"../surface/attributes":1311}],1350:[function(n,z,q){"use strict";var t=n("gl-mesh3d"),h=n("../../lib/gl_format_color").parseColorScale,p=n("../../lib/str2rgbarray"),l=n("../../components/colorscale").extractOpts,e=n("../../plots/gl3d/zip3"),o=n("../isosurface/convert").findNearestOnAxis,r=n("../isosurface/convert").generateIsoMeshes;function i(s,a,c){this.scene=s,this.uid=c,this.mesh=a,this.name="",this.data=null,this.showContour=!1}var u=i.prototype;u.handlePick=function(s){if(s.object===this.mesh){var a=s.data.index,c=this.data._meshX[a],f=this.data._meshY[a],g=this.data._meshZ[a],d=this.data._Ys.length,m=this.data._Zs.length,y=o(c,this.data._Xs).id,v=o(f,this.data._Ys).id,T=o(g,this.data._Zs).id,w=s.index=T+m*v+m*d*y;s.traceCoordinate=[this.data._meshX[w],this.data._meshY[w],this.data._meshZ[w],this.data._value[w]];var A=this.data.hovertext||this.data.text;return Array.isArray(A)&&A[w]!==void 0?s.textLabel=A[w]:A&&(s.textLabel=A),!0}},u.update=function(s){var a=this.scene,c=a.fullSceneLayout;function f(m,y,v,T){return y.map(function(w){return m.d2l(w,0,T)*v})}this.data=r(s);var g={positions:e(f(c.xaxis,s._meshX,a.dataScale[0],s.xcalendar),f(c.yaxis,s._meshY,a.dataScale[1],s.ycalendar),f(c.zaxis,s._meshZ,a.dataScale[2],s.zcalendar)),cells:e(s._meshI,s._meshJ,s._meshK),lightPosition:[s.lightposition.x,s.lightposition.y,s.lightposition.z],ambient:s.lighting.ambient,diffuse:s.lighting.diffuse,specular:s.lighting.specular,roughness:s.lighting.roughness,fresnel:s.lighting.fresnel,vertexNormalsEpsilon:s.lighting.vertexnormalsepsilon,faceNormalsEpsilon:s.lighting.facenormalsepsilon,opacity:s.opacity,opacityscale:s.opacityscale,contourEnable:s.contour.show,contourColor:p(s.contour.color).slice(0,3),contourWidth:s.contour.width,useFacetNormals:s.flatshading},d=l(s);g.vertexIntensity=s._meshIntensity,g.vertexIntensityBounds=[d.min,d.max],g.colormap=h(s),this.mesh.update(g)},u.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},z.exports=function(s,a){var c=s.glplot.gl,f=t({gl:c}),g=new i(s,f,a.uid);return f._trace=g,g.update(a),s.glplot.add(f),g}},{"../../components/colorscale":655,"../../lib/gl_format_color":774,"../../lib/str2rgbarray":802,"../../plots/gl3d/zip3":881,"../isosurface/convert":1125,"gl-mesh3d":309}],1351:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("./attributes"),p=n("../isosurface/defaults").supplyIsoDefaults,l=n("../surface/defaults").opacityscaleDefaults;z.exports=function(e,o,r,i){function u(s,a){return t.coerce(e,o,h,s,a)}p(e,o,r,i,u),l(e,o,i,u)}},{"../../lib":778,"../isosurface/defaults":1126,"../surface/defaults":1314,"./attributes":1349}],1352:[function(n,z,q){"use strict";z.exports={attributes:n("./attributes"),supplyDefaults:n("./defaults"),calc:n("../isosurface/calc"),colorbar:{min:"cmin",max:"cmax"},plot:n("./convert"),moduleType:"trace",name:"volume",basePlotModule:n("../../plots/gl3d"),categories:["gl3d","showLegend"],meta:{}}},{"../../plots/gl3d":870,"../isosurface/calc":1124,"./attributes":1349,"./convert":1350,"./defaults":1351}],1353:[function(n,z,q){"use strict";var t=n("../bar/attributes"),h=n("../scatter/attributes").line,p=n("../../plots/attributes"),l=n("../../plots/template_attributes").hovertemplateAttrs,e=n("../../plots/template_attributes").texttemplateAttrs,o=n("./constants"),r=n("../../lib/extend").extendFlat,i=n("../../components/color");function u(s){return{marker:{color:r({},t.marker.color,{arrayOk:!1,editType:"style"}),line:{color:r({},t.marker.line.color,{arrayOk:!1,editType:"style"}),width:r({},t.marker.line.width,{arrayOk:!1,editType:"style"}),editType:"style"},editType:"style"},editType:"style"}}z.exports={measure:{valType:"data_array",dflt:[],editType:"calc"},base:{valType:"number",dflt:null,arrayOk:!1,editType:"calc"},x:t.x,x0:t.x0,dx:t.dx,y:t.y,y0:t.y0,dy:t.dy,xperiod:t.xperiod,yperiod:t.yperiod,xperiod0:t.xperiod0,yperiod0:t.yperiod0,xperiodalignment:t.xperiodalignment,yperiodalignment:t.yperiodalignment,hovertext:t.hovertext,hovertemplate:l({},{keys:o.eventDataKeys}),hoverinfo:r({},p.hoverinfo,{flags:["name","x","y","text","initial","delta","final"]}),textinfo:{valType:"flaglist",flags:["label","text","initial","delta","final"],extras:["none"],editType:"plot",arrayOk:!1},texttemplate:e({editType:"plot"},{keys:o.eventDataKeys.concat(["label"])}),text:t.text,textposition:t.textposition,insidetextanchor:t.insidetextanchor,textangle:t.textangle,textfont:t.textfont,insidetextfont:t.insidetextfont,outsidetextfont:t.outsidetextfont,constraintext:t.constraintext,cliponaxis:t.cliponaxis,orientation:t.orientation,offset:t.offset,width:t.width,increasing:u(),decreasing:u(),totals:u(),connector:{line:{color:r({},h.color,{dflt:i.defaultLine}),width:r({},h.width,{editType:"plot"}),dash:h.dash,editType:"plot"},mode:{valType:"enumerated",values:["spanning","between"],dflt:"between",editType:"plot"},visible:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},offsetgroup:t.offsetgroup,alignmentgroup:t.alignmentgroup}},{"../../components/color":643,"../../lib/extend":768,"../../plots/attributes":824,"../../plots/template_attributes":906,"../bar/attributes":921,"../scatter/attributes":1187,"./constants":1355}],1354:[function(n,z,q){"use strict";var t=n("../../plots/cartesian/axes"),h=n("../../plots/cartesian/align_period"),p=n("../../lib").mergeArray,l=n("../scatter/calc_selection"),e=n("../../constants/numerical").BADNUM;function o(i){return i==="a"||i==="absolute"}function r(i){return i==="t"||i==="total"}z.exports=function(i,u){var s,a,c,f,g=t.getFromId(i,u.xaxis||"x"),d=t.getFromId(i,u.yaxis||"y");u.orientation==="h"?(s=g.makeCalcdata(u,"x"),c=d.makeCalcdata(u,"y"),a=h(u,d,"y",c),f=!!u.yperiodalignment):(s=d.makeCalcdata(u,"y"),c=g.makeCalcdata(u,"x"),a=h(u,g,"x",c),f=!!u.xperiodalignment);for(var m,y=Math.min(a.length,s.length),v=new Array(y),T=0,w=!1,A=0;A<y;A++){var E=s[A]||0,M=!1;(s[A]!==e||r(u.measure[A])||o(u.measure[A]))&&A+1<y&&(s[A+1]!==e||r(u.measure[A+1])||o(u.measure[A+1]))&&(M=!0);var b=v[A]={i:A,p:a[A],s:E,rawS:E,cNext:M};o(u.measure[A])?(T=b.s,b.isSum=!0,b.dir="totals",b.s=T):r(u.measure[A])?(b.isSum=!0,b.dir="totals",b.s=T):(b.isSum=!1,b.dir=b.rawS<0?"decreasing":"increasing",m=b.s,b.s=T+m,T+=m),b.dir==="totals"&&(w=!0),f&&(v[A].orig_p=c[A]),u.ids&&(b.id=String(u.ids[A])),b.v=(u.base||0)+T}return v.length&&(v[0].hasTotals=w),p(u.text,v,"tx"),p(u.hovertext,v,"htx"),l(v,u),v}},{"../../constants/numerical":753,"../../lib":778,"../../plots/cartesian/align_period":825,"../../plots/cartesian/axes":828,"../scatter/calc_selection":1189}],1355:[function(n,z,q){"use strict";z.exports={eventDataKeys:["initial","delta","final"]}},{}],1356:[function(n,z,q){"use strict";var t=n("../bar/cross_trace_calc").setGroupPositions;z.exports=function(h,p){var l,e,o=h._fullLayout,r=h._fullData,i=h.calcdata,u=p.xaxis,s=p.yaxis,a=[],c=[],f=[];for(e=0;e<r.length;e++){var g=r[e];g.visible===!0&&g.xaxis===u._id&&g.yaxis===s._id&&g.type==="waterfall"&&(l=i[e],g.orientation==="h"?f.push(l):c.push(l),a.push(l))}var d={mode:o.waterfallmode,norm:o.waterfallnorm,gap:o.waterfallgap,groupgap:o.waterfallgroupgap};for(t(h,u,s,c,d),t(h,s,u,f,d),e=0;e<a.length;e++){l=a[e];for(var m=0;m<l.length;m++){var y=l[m];y.isSum===!1&&(y.s0+=m===0?0:l[m-1].s),m+1<l.length&&(l[m].nextP0=l[m+1].p0,l[m].nextS0=l[m+1].s0)}}}},{"../bar/cross_trace_calc":924}],1357:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("../bar/defaults").handleGroupingDefaults,p=n("../bar/defaults").handleText,l=n("../scatter/xy_defaults"),e=n("../scatter/period_defaults"),o=n("./attributes"),r=n("../../components/color"),i=n("../../constants/delta.js"),u=i.INCREASING.COLOR,s=i.DECREASING.COLOR;function a(c,f,g){c(f+".marker.color",g),c(f+".marker.line.color",r.defaultLine),c(f+".marker.line.width")}z.exports={supplyDefaults:function(c,f,g,d){function m(v,T){return t.coerce(c,f,o,v,T)}if(l(c,f,d,m)){e(c,f,d,m),m("measure"),m("orientation",f.x&&!f.y?"h":"v"),m("base"),m("offset"),m("width"),m("text"),m("hovertext"),m("hovertemplate");var y=m("textposition");p(c,f,d,m,y,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),f.textposition!=="none"&&(m("texttemplate"),f.texttemplate||m("textinfo")),a(m,"increasing",u),a(m,"decreasing",s),a(m,"totals","#4499FF"),m("connector.visible")&&(m("connector.mode"),m("connector.line.width")&&(m("connector.line.color"),m("connector.line.dash")))}else f.visible=!1},crossTraceDefaults:function(c,f){var g,d;function m(v){return t.coerce(d._input,d,o,v)}if(f.waterfallmode==="group")for(var y=0;y<c.length;y++)g=(d=c[y])._input,h(g,d,f,m)}}},{"../../components/color":643,"../../constants/delta.js":747,"../../lib":778,"../bar/defaults":925,"../scatter/period_defaults":1207,"../scatter/xy_defaults":1214,"./attributes":1353}],1358:[function(n,z,q){"use strict";z.exports=function(t,h){return t.x="xVal"in h?h.xVal:h.x,t.y="yVal"in h?h.yVal:h.y,"initial"in h&&(t.initial=h.initial),"delta"in h&&(t.delta=h.delta),"final"in h&&(t.final=h.final),h.xa&&(t.xaxis=h.xa),h.ya&&(t.yaxis=h.ya),t}},{}],1359:[function(n,z,q){"use strict";var t=n("../../plots/cartesian/axes").hoverLabelText,h=n("../../components/color").opacity,p=n("../bar/hover").hoverOnBars,l=n("../../constants/delta.js"),e=l.INCREASING.SYMBOL,o=l.DECREASING.SYMBOL;z.exports=function(r,i,u,s){var a=p(r,i,u,s);if(a){var c=a.cd,f=c[0].trace,g=f.orientation==="h",d=g?r.xa:r.ya,m=c[a.index],y=m.isSum?m.b+m.s:m.rawS;if(!m.isSum){a.initial=m.b+m.s-y,a.delta=y,a.final=a.initial+a.delta;var v=b(Math.abs(a.delta));a.deltaLabel=y<0?"("+v+")":v,a.finalLabel=b(a.final),a.initialLabel=b(a.initial)}var T=m.hi||f.hoverinfo,w=[];if(T&&T!=="none"&&T!=="skip"){var A=T==="all",E=T.split("+"),M=function(_){return A||E.indexOf(_)!==-1};m.isSum||(!M("final")||M(g?"x":"y")||w.push(a.finalLabel),M("delta")&&(y<0?w.push(a.deltaLabel+" "+o):w.push(a.deltaLabel+" "+e)),M("initial")&&w.push("Initial: "+a.initialLabel))}return w.length&&(a.extraText=w.join("<br>")),a.color=function(_,S){var C=_[S.dir].marker,k=C.color,L=C.line.color,I=C.line.width;if(h(k))return k;if(h(L)&&I)return L}(f,m),[a]}function b(_){return t(d,_)}}},{"../../components/color":643,"../../constants/delta.js":747,"../../plots/cartesian/axes":828,"../bar/hover":928}],1360:[function(n,z,q){"use strict";z.exports={attributes:n("./attributes"),layoutAttributes:n("./layout_attributes"),supplyDefaults:n("./defaults").supplyDefaults,crossTraceDefaults:n("./defaults").crossTraceDefaults,supplyLayoutDefaults:n("./layout_defaults"),calc:n("./calc"),crossTraceCalc:n("./cross_trace_calc"),plot:n("./plot"),style:n("./style").style,hoverPoints:n("./hover"),eventData:n("./event_data"),selectPoints:n("../bar/select"),moduleType:"trace",name:"waterfall",basePlotModule:n("../../plots/cartesian"),categories:["bar-like","cartesian","svg","oriented","showLegend","zoomScale"],meta:{}}},{"../../plots/cartesian":841,"../bar/select":933,"./attributes":1353,"./calc":1354,"./cross_trace_calc":1356,"./defaults":1357,"./event_data":1358,"./hover":1359,"./layout_attributes":1361,"./layout_defaults":1362,"./plot":1363,"./style":1364}],1361:[function(n,z,q){"use strict";z.exports={waterfallmode:{valType:"enumerated",values:["group","overlay"],dflt:"group",editType:"calc"},waterfallgap:{valType:"number",min:0,max:1,editType:"calc"},waterfallgroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],1362:[function(n,z,q){"use strict";var t=n("../../lib"),h=n("./layout_attributes");z.exports=function(p,l,e){var o=!1;function r(s,a){return t.coerce(p,l,h,s,a)}for(var i=0;i<e.length;i++){var u=e[i];if(u.visible&&u.type==="waterfall"){o=!0;break}}o&&(r("waterfallmode"),r("waterfallgap",.2),r("waterfallgroupgap"))}},{"../../lib":778,"./layout_attributes":1361}],1363:[function(n,z,q){"use strict";var t=n("d3"),h=n("../../lib"),p=n("../../components/drawing"),l=n("../../constants/numerical").BADNUM,e=n("../bar/plot"),o=n("../bar/uniform_text").clearMinTextSize;z.exports=function(r,i,u,s){var a=r._fullLayout;o("waterfall",a),e.plot(r,i,u,s,{mode:a.waterfallmode,norm:a.waterfallmode,gap:a.waterfallgap,groupgap:a.waterfallgroupgap}),function(c,f,g,d){var m=f.xaxis,y=f.yaxis;h.makeTraceGroups(d,g,"trace bars").each(function(v){var T=t.select(this),w=v[0].trace,A=h.ensureSingle(T,"g","lines");if(w.connector&&w.connector.visible){var E=w.orientation==="h",M=w.connector.mode,b=A.selectAll("g.line").data(h.identity);b.enter().append("g").classed("line",!0),b.exit().remove();var _=b.size();b.each(function(S,C){if(C===_-1||S.cNext){var k=function(V,O,J,D){var B=[],N=[],F=D?O:J,H=D?J:O;return B[0]=F.c2p(V.s0,!0),N[0]=H.c2p(V.p0,!0),B[1]=F.c2p(V.s1,!0),N[1]=H.c2p(V.p1,!0),B[2]=F.c2p(V.nextS0,!0),N[2]=H.c2p(V.nextP0,!0),D?[B,N]:[N,B]}(S,m,y,E),L=k[0],I=k[1],R="";L[0]!==l&&I[0]!==l&&L[1]!==l&&I[1]!==l&&(M==="spanning"&&!S.isSum&&C>0&&(R+=E?"M"+L[0]+","+I[1]+"V"+I[0]:"M"+L[1]+","+I[0]+"H"+L[0]),M!=="between"&&(S.isSum||C<_-1)&&(R+=E?"M"+L[1]+","+I[0]+"V"+I[1]:"M"+L[0]+","+I[1]+"H"+L[1]),L[2]!==l&&I[2]!==l&&(R+=E?"M"+L[1]+","+I[1]+"V"+I[2]:"M"+L[1]+","+I[1]+"H"+L[2])),R===""&&(R="M0,0Z"),h.ensureSingle(t.select(this),"path").attr("d",R).call(p.setClipUrl,f.layerClipId,c)}})}else A.remove()})}(r,i,u,s)}},{"../../components/drawing":665,"../../constants/numerical":753,"../../lib":778,"../bar/plot":932,"../bar/uniform_text":937,d3:169}],1364:[function(n,z,q){"use strict";var t=n("d3"),h=n("../../components/drawing"),p=n("../../components/color"),l=n("../../constants/interactions").DESELECTDIM,e=n("../bar/style"),o=n("../bar/uniform_text").resizeText,r=e.styleTextPoints;z.exports={style:function(i,u,s){var a=s||t.select(i).selectAll("g.waterfalllayer").selectAll("g.trace");o(i,a,"waterfall"),a.style("opacity",function(c){return c[0].trace.opacity}),a.each(function(c){var f=t.select(this),g=c[0].trace;f.selectAll(".point > path").each(function(d){if(!d.isBlank){var m=g[d.dir].marker;t.select(this).call(p.fill,m.color).call(p.stroke,m.line.color).call(h.dashLine,m.line.dash,m.line.width).style("opacity",g.selectedpoints&&!d.selected?l:1)}}),r(f,g,i),f.selectAll(".lines").each(function(){var d=g.connector.line;h.lineGroupStyle(t.select(this).selectAll("path"),d.width,d.color,d.dash)})})}}},{"../../components/color":643,"../../components/drawing":665,"../../constants/interactions":752,"../bar/style":935,"../bar/uniform_text":937,d3:169}],1365:[function(n,z,q){"use strict";var t=n("../plots/cartesian/axes"),h=n("../lib"),p=n("../plot_api/plot_schema"),l=n("./helpers").pointsAccessorFunction,e=n("../constants/numerical").BADNUM;q.moduleType="transform",q.name="aggregate";var o=q.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},groups:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},aggregations:{_isLinkedToArray:"aggregation",target:{valType:"string",editType:"calc"},func:{valType:"enumerated",values:["count","sum","avg","median","mode","rms","stddev","min","max","first","last","change","range"],dflt:"first",editType:"calc"},funcmode:{valType:"enumerated",values:["sample","population"],dflt:"sample",editType:"calc"},enabled:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"},editType:"calc"},r=o.aggregations;function i(c,f,g,d){if(d.enabled){for(var m=d.target,y=h.nestedProperty(f,m),v=y.get(),T=function(E,M){var b=E.func,_=M.d2c,S=M.c2d;switch(b){case"count":return u;case"first":return s;case"last":return a;case"sum":return function(C,k){for(var L=0,I=0;I<k.length;I++){var R=_(C[k[I]]);R!==e&&(L+=R)}return S(L)};case"avg":return function(C,k){for(var L=0,I=0,R=0;R<k.length;R++){var V=_(C[k[R]]);V!==e&&(L+=V,I++)}return I?S(L/I):e};case"min":return function(C,k){for(var L=1/0,I=0;I<k.length;I++){var R=_(C[k[I]]);R!==e&&(L=Math.min(L,R))}return L===1/0?e:S(L)};case"max":return function(C,k){for(var L=-1/0,I=0;I<k.length;I++){var R=_(C[k[I]]);R!==e&&(L=Math.max(L,R))}return L===-1/0?e:S(L)};case"range":return function(C,k){for(var L=1/0,I=-1/0,R=0;R<k.length;R++){var V=_(C[k[R]]);V!==e&&(L=Math.min(L,V),I=Math.max(I,V))}return I===-1/0||L===1/0?e:S(I-L)};case"change":return function(C,k){var L=_(C[k[0]]),I=_(C[k[k.length-1]]);return L===e||I===e?e:S(I-L)};case"median":return function(C,k){for(var L=[],I=0;I<k.length;I++){var R=_(C[k[I]]);R!==e&&L.push(R)}if(!L.length)return e;L.sort(h.sorterAsc);var V=(L.length-1)/2;return S((L[Math.floor(V)]+L[Math.ceil(V)])/2)};case"mode":return function(C,k){for(var L={},I=0,R=e,V=0;V<k.length;V++){var O=_(C[k[V]]);if(O!==e){var J=L[O]=(L[O]||0)+1;J>I&&(I=J,R=O)}}return I?S(R):e};case"rms":return function(C,k){for(var L=0,I=0,R=0;R<k.length;R++){var V=_(C[k[R]]);V!==e&&(L+=V*V,I++)}return I?S(Math.sqrt(L/I)):e};case"stddev":return function(C,k){var L,I=0,R=0,V=1,O=e;for(L=0;L<k.length&&O===e;L++)O=_(C[k[L]]);if(O===e)return e;for(;L<k.length;L++){var J=_(C[k[L]]);if(J!==e){var D=J-O;I+=D,R+=D*D,V++}}var B=E.funcmode==="sample"?V-1:V;return B?Math.sqrt((R-I*I/V)/B):0}}}(d,t.getDataConversions(c,f,m,v)),w=new Array(g.length),A=0;A<g.length;A++)w[A]=T(v,g[A]);y.set(w),d.func==="count"&&h.pushUnique(f._arrayAttrs,m)}}function u(c,f){return f.length}function s(c,f){return c[f[0]]}function a(c,f){return c[f[f.length-1]]}q.supplyDefaults=function(c,f){var g,d={};function m(S,C){return h.coerce(c,d,o,S,C)}if(!m("enabled"))return d;var y=p.findArrayAttributes(f),v={};for(g=0;g<y.length;g++)v[y[g]]=1;var T=m("groups");if(!Array.isArray(T)){if(!v[T])return d.enabled=!1,d;v[T]=0}var w,A=c.aggregations||[],E=d.aggregations=new Array(A.length);function M(S,C){return h.coerce(A[g],w,r,S,C)}for(g=0;g<A.length;g++){w={_index:g};var b=M("target"),_=M("func");M("enabled")&&b&&(v[b]||_==="count"&&v[b]===void 0)?(_==="stddev"&&M("funcmode"),v[b]=0,E[g]=w):E[g]={enabled:!1,_index:g}}for(g=0;g<y.length;g++)v[y[g]]&&E.push({target:y[g],func:r.func.dflt,enabled:!0,_index:-1});return d},q.calcTransform=function(c,f,g){if(g.enabled){var d=g.groups,m=h.getTargetArray(f,{target:d});if(m){var y,v,T,w,A={},E={},M=[],b=l(f.transforms,g),_=m.length;for(f._length&&(_=Math.min(_,f._length)),y=0;y<_;y++)(T=A[v=m[y]])===void 0?(A[v]=M.length,w=[y],M.push(w),E[A[v]]=b(y)):(M[T].push(y),E[A[v]]=(E[A[v]]||[]).concat(b(y)));g._indexToPoints=E;var S=g.aggregations;for(y=0;y<S.length;y++)i(c,f,M,S[y]);typeof d=="string"&&i(c,f,M,{target:d,func:"first",enabled:!0}),f._length=M.length}}}},{"../constants/numerical":753,"../lib":778,"../plot_api/plot_schema":816,"../plots/cartesian/axes":828,"./helpers":1368}],1366:[function(n,z,q){"use strict";var t=n("../lib"),h=n("../registry"),p=n("../plots/cartesian/axes"),l=n("./helpers").pointsAccessorFunction,e=n("../constants/filter_ops"),o=e.COMPARISON_OPS,r=e.INTERVAL_OPS,i=e.SET_OPS;q.moduleType="transform",q.name="filter",q.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},target:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},operation:{valType:"enumerated",values:[].concat(o).concat(r).concat(i),dflt:"=",editType:"calc"},value:{valType:"any",dflt:0,editType:"calc"},preservegaps:{valType:"boolean",dflt:!1,editType:"calc"},editType:"calc"},q.supplyDefaults=function(u){var s={};function a(g,d){return t.coerce(u,s,q.attributes,g,d)}if(a("enabled")){var c=a("target");if(t.isArrayOrTypedArray(c)&&c.length===0)return s.enabled=!1,s;a("preservegaps"),a("operation"),a("value");var f=h.getComponentMethod("calendars","handleDefaults");f(u,s,"valuecalendar",null),f(u,s,"targetcalendar",null)}return s},q.calcTransform=function(u,s,a){if(a.enabled){var c=t.getTargetArray(s,a);if(c){var f=a.target,g=c.length;s._length&&(g=Math.min(g,s._length));var d=a.targetcalendar,m=s._arrayAttrs,y=a.preservegaps;if(typeof f=="string"){var v=t.nestedProperty(s,f+"calendar").get();v&&(d=v)}var T,w,A=function(k,L,I){var R=k.operation,V=k.value,O=Array.isArray(V);function J(F){return F.indexOf(R)!==-1}var D,B=function(F){return L(F,0,k.valuecalendar)},N=function(F){return L(F,0,I)};switch(J(o)?D=B(O?V[0]:V):J(r)?D=O?[B(V[0]),B(V[1])]:[B(V),B(V)]:J(i)&&(D=O?V.map(B):[B(V)]),R){case"=":return function(F){return N(F)===D};case"!=":return function(F){return N(F)!==D};case"<":return function(F){return N(F)<D};case"<=":return function(F){return N(F)<=D};case">":return function(F){return N(F)>D};case">=":return function(F){return N(F)>=D};case"[]":return function(F){var H=N(F);return H>=D[0]&&H<=D[1]};case"()":return function(F){var H=N(F);return H>D[0]&&H<D[1]};case"[)":return function(F){var H=N(F);return H>=D[0]&&H<D[1]};case"(]":return function(F){var H=N(F);return H>D[0]&&H<=D[1]};case"][":return function(F){var H=N(F);return H<=D[0]||H>=D[1]};case")(":return function(F){var H=N(F);return H<D[0]||H>D[1]};case"](":return function(F){var H=N(F);return H<=D[0]||H>D[1]};case")[":return function(F){var H=N(F);return H<D[0]||H>=D[1]};case"{}":return function(F){return D.indexOf(N(F))!==-1};case"}{":return function(F){return D.indexOf(N(F))===-1}}}(a,p.getDataToCoordFunc(u,s,f,c),d),E={},M={},b=0;y?(T=function(k){E[k.astr]=t.extendDeep([],k.get()),k.set(new Array(g))},w=function(k,L){var I=E[k.astr][L];k.get()[L]=I}):(T=function(k){E[k.astr]=t.extendDeep([],k.get()),k.set([])},w=function(k,L){var I=E[k.astr][L];k.get().push(I)}),C(T);for(var _=l(s.transforms,a),S=0;S<g;S++)A(c[S])?(C(w,S),M[b++]=_(S)):y&&b++;a._indexToPoints=M,s._length=b}}function C(k,L){for(var I=0;I<m.length;I++)k(t.nestedProperty(s,m[I]),L)}}},{"../constants/filter_ops":749,"../lib":778,"../plots/cartesian/axes":828,"../registry":911,"./helpers":1368}],1367:[function(n,z,q){"use strict";var t=n("../lib"),h=n("../plot_api/plot_schema"),p=n("../plots/plots"),l=n("./helpers").pointsAccessorFunction;function e(o,r){var i,u,s,a,c,f,g,d,m,y,v=r.transform,T=r.transformIndex,w=o.transforms[T].groups,A=l(o.transforms,v);if(!t.isArrayOrTypedArray(w)||w.length===0)return[o];var E=t.filterUnique(w),M=new Array(E.length),b=w.length,_=h.findArrayAttributes(o),S=v.styles||[],C={};for(i=0;i<S.length;i++)C[S[i].target]=S[i].value;v.styles&&(y=t.keyedContainer(v,"styles","target","value.name"));var k={},L={};for(i=0;i<E.length;i++){k[f=E[i]]=i,L[f]=0,(g=M[i]=t.extendDeepNoArrays({},o))._group=f,g.transforms[T]._indexToPoints={};var I=null;for(y&&(I=y.get(f)),g.name=I||I===""?I:t.templateString(v.nameformat,{trace:o.name,group:f}),d=g.transforms,g.transforms=[],u=0;u<d.length;u++)g.transforms[u]=t.extendDeepNoArrays({},d[u]);for(u=0;u<_.length;u++)t.nestedProperty(g,_[u]).set([])}for(s=0;s<_.length;s++){for(a=_[s],u=0,m=[];u<E.length;u++)m[u]=t.nestedProperty(M[u],a).get();for(c=t.nestedProperty(o,a).get(),u=0;u<b;u++)m[k[w[u]]].push(c[u])}for(u=0;u<b;u++)(g=M[k[w[u]]]).transforms[T]._indexToPoints[L[w[u]]]=A(u),L[w[u]]++;for(i=0;i<E.length;i++)f=E[i],g=M[i],p.clearExpandedTraceDefaultColors(g),g=t.extendDeepNoArrays(g,C[f]||{});return M}q.moduleType="transform",q.name="groupby",q.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},groups:{valType:"data_array",dflt:[],editType:"calc"},nameformat:{valType:"string",editType:"calc"},styles:{_isLinkedToArray:"style",target:{valType:"string",editType:"calc"},value:{valType:"any",dflt:{},editType:"calc",_compareAsJSON:!0},editType:"calc"},editType:"calc"},q.supplyDefaults=function(o,r,i){var u,s={};function a(m,y){return t.coerce(o,s,q.attributes,m,y)}if(!a("enabled"))return s;a("groups"),a("nameformat",i._dataLength>1?"%{group} (%{trace})":"%{group}");var c=o.styles,f=s.styles=[];if(c)for(u=0;u<c.length;u++){var g=f[u]={};t.coerce(c[u],f[u],q.attributes.styles,"target");var d=t.coerce(c[u],f[u],q.attributes.styles,"value");t.isPlainObject(d)?g.value=t.extendDeep({},d):d&&delete g.value}return s},q.transform=function(o,r){var i,u,s,a=[];for(u=0;u<o.length;u++)for(i=e(o[u],r),s=0;s<i.length;s++)a.push(i[s]);return a}},{"../lib":778,"../plot_api/plot_schema":816,"../plots/plots":891,"./helpers":1368}],1368:[function(n,z,q){"use strict";q.pointsAccessorFunction=function(t,h){for(var p,l,e=0;e<t.length&&(p=t[e])!==h;e++)p._indexToPoints&&p.enabled!==!1&&(l=p._indexToPoints);return l?function(o){return l[o]}:function(o){return[o]}}},{}],1369:[function(n,z,q){"use strict";var t=n("../lib"),h=n("../plots/cartesian/axes"),p=n("./helpers").pointsAccessorFunction,l=n("../constants/numerical").BADNUM;q.moduleType="transform",q.name="sort",q.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},target:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},order:{valType:"enumerated",values:["ascending","descending"],dflt:"ascending",editType:"calc"},editType:"calc"},q.supplyDefaults=function(e){var o={};function r(i,u){return t.coerce(e,o,q.attributes,i,u)}return r("enabled")&&(r("target"),r("order")),o},q.calcTransform=function(e,o,r){if(r.enabled){var i=t.getTargetArray(o,r);if(i){var u=r.target,s=i.length;o._length&&(s=Math.min(s,o._length));var a,c,f=o._arrayAttrs,g=function(w,A,E,M){var b,_=new Array(M),S=new Array(M);for(b=0;b<M;b++)_[b]={v:A[b],i:b};for(_.sort(function(C,k){switch(C.order){case"ascending":return function(L,I){var R=k(L.v),V=k(I.v);return R===l?1:V===l?-1:R-V};case"descending":return function(L,I){var R=k(L.v),V=k(I.v);return R===l?1:V===l?-1:V-R}}}(w,E)),b=0;b<M;b++)S[b]=_[b].i;return S}(r,i,h.getDataToCoordFunc(e,o,u,i),s),d=p(o.transforms,r),m={};for(a=0;a<f.length;a++){var y=t.nestedProperty(o,f[a]),v=y.get(),T=new Array(s);for(c=0;c<s;c++)T[c]=v[g[c]];y.set(T)}for(c=0;c<s;c++)m[c]=d(g[c]);r._indexToPoints=m,o._length=s}}}},{"../constants/numerical":753,"../lib":778,"../plots/cartesian/axes":828,"./helpers":1368}],1370:[function(n,z,q){"use strict";q.version="1.58.5"},{}]},{},[26])(26)});var sp=document.createElement("div");sp.innerHTML="Press F12 to see results";document.body.appendChild(sp);var Hp=n=>(console.log("Example 1: input",n),n*2);Wo(Hp,{message:5}).then(n=>{console.log("Example 1: result",n)}).catch(n=>{console.error("Example 1: error",n)});var Gp=n=>(console.log("Example 2: input",n),n*2);Wo(Gp).then(n=>{n.run(5).then(z=>{console.log("Example 2: r1",z)}),n.run(10).then(z=>{console.log("Example 2: r2",z),n.terminate()})}).catch(n=>{console.error("Example 2: error",n)});var Yp=n=>(console.log("Example 3: A input",n),n*2),Wp=n=>(console.log("Example 3: B input",n),n+3);Wo(Yp,{blocking:!0}).then(n=>{Wo(Wp).then(z=>{n.addPort(z.worker);let q=0;z.addCallback(t=>{console.log("Chain workerHelperB result",t),q++,q===2&&(n.terminate(),z.terminate()),n.run(10)}),n.run(5).then(t=>{console.log("Chain workerHelperA result",t)}),n.run(15)})}).catch(n=>{console.error(n)});var Zp=n=>{let z=globalThis.nj,q=z.array(n);return z.mean(q)},Xp=[1,2,3,4,5];Wo(Zp,{imports:"./lib/num.min.js",message:Xp}).then(n=>{console.log("Example 4: Mean:",n)}).catch(n=>{console.error("Example 4: Error:",n)});var Jp=n=>n.map(snakeCase),Kp=["HelloWorld","left pad","ECMAScript"];Wo(Jp,{imports:{["https://cdn.skypack.dev/lodash@4"]:{snakeCase:!0}},message:Kp}).then(n=>{console.log("Example 5: Snake Case result:",n)}).catch(n=>{console.error("Example 5: Error:",n)});var Qp=n=>(self.encoder||(self.encoder=new TextEncoder),encoder.encode(n)),Rl=["Hello","World","My","Old","Friend"];Wo(Qp,{pool:Rl.length,message:Rl}).then(n=>{console.log("Example 6: Threadpool result:",n,"input:",Rl)}).catch(n=>{console.error("Example 5: Error:",n)});var $p=n=>{let z=btoa(n);return{input:n,encoded:z}},ed=n=>({reversed:n.encoded.split("").reverse().join(""),input:n.input});Wo(ed,{pool:Rl.length}).then(n=>new Promise((z,q)=>{let t=[];n.addCallback(h=>{if(t.push(h),t.length==Rl.length){let p=[];Rl.map((l,e)=>{p[e]=t.find(o=>o.input===l).reversed}),console.log("Example 7: threadpool chain output",p,`
Re-decoded:`,p.map(l=>atob(l.split("").reverse().join("")))),n.terminate(),z(p)}}),console.log("Example 7: threadpool chain input",Rl),Wo($p,{pool:Rl.length,message:Rl,port:Object.values(n.workers)})})).catch(n=>{console.error("Example 7: Error:",n)});Wo(n=>`Processed ${n}, ${new Date().toLocaleString()}`,{message:"ABC123",loop:1e3,callback:n=>{console.log(n)}}).then(n=>{setTimeout(()=>{n.stop(),n.terminate()},5e3)});var Pc=document.createElement("canvas");Pc.width=800;Pc.height=600;Pc.style.width="100%";Pc.style.height="100%";Pc.style.position="absolute";document.body.appendChild(Pc);var rp=Pc.transferControlToOffscreen();Wo(n=>{if(n.canvas&&!self.canvas){let z=n.canvas,q=n.canvas.getContext("2d");self.canvas=z,self.ctx=q;let t=["red","orange","yellow","green","blue","indigo","violet"],h=0;self.drawWave=()=>{q.clearRect(0,0,z.width,z.height);let p=q.createLinearGradient(0,z.height/2,z.width,z.height/2);t.forEach((r,i)=>{p.addColorStop(i/(t.length-1),r)}),q.fillStyle=p;let l=100,e=.01,o=.04;q.beginPath();for(let r=0;r<z.width;r++){let i=z.height/2+l*Math.sin(e*r+h);q.lineTo(r,i)}q.lineTo(z.width,z.height),q.lineTo(0,z.height),q.closePath(),q.fill(),h-=o}}else n.width&&self.canvas?.width!==n.width&&(console.log("resized!"),self.canvas.width=n.width,self.canvas.height=n.height);self.drawWave()},{animate:!0,message:{canvas:rp},transfer:[rp]}).then(n=>{window.onresize=z=>{n.setAnimation({width:window.innerWidth,height:window.innerHeight})}});function td(n){let z=0;if(n&&!(n&n-1))return n;for(;n!=0;)n>>=1,z+=1;return 1<<z}async function Yu(n){let z=n.length;if(z<=1)return n;let q=[],t=[];for(let o=0;o<z;o+=2)q.push(n[o]),o+1<z&&t.push(n[o+1]);let h,p,l=7500;q.length>=l?[h,p]=await new Promise(o=>{import(location.origin+"/lib/threadop.esm.js").then(async r=>{o(await Promise.all([r.threadop(Yu,{message:q}),r.threadop(Yu,{message:t})]))})}):[h,p]=[await Yu(q),await Yu(t)];let e=new Array(z);for(let o=0;o<z/2;o++){let r=-2*Math.PI*o/z,i=Math.cos(r)*p[o].real-Math.sin(r)*p[o].imag,u=Math.cos(r)*p[o].imag+Math.sin(r)*p[o].real;e[o]={real:h[o].real+i,imag:h[o].imag+u},e[o+z/2]={real:h[o].real-i,imag:h[o].imag-u}}return e}async function np(n,z=44100,q=1,t=!0){let h=n.length,p=Math.max(td(h),Math.ceil(z/q));for(;n.length<p;)n.push({real:0,imag:0});if(h<=1)return n;let e=(await Wo(t?"./dist/fft.thread.js":Yu,{message:n})).map(u=>Math.sqrt(u.real*u.real+u.imag*u.imag)/p),o=Math.floor(p/2),r=new Array(p);for(let u=0;u<p;u++)u<o?r[o+u]=e[u]:r[u-o]=e[u];let i=[...Array(p).keys()].map(u=>(u-o)*z/p);return{amplitudes:r,freqs:i}}document.body.insertAdjacentHTML("beforeend",'<div id="plot"></div>');document.body.insertAdjacentHTML("beforeend",'<div id="plot2"></div>');var Ns=44100,lp=2500,rd=1,cp=.5,ph=[],nd=[];for(let n=0;n<Ns*rd;n++){let z={real:cp*Math.sin(2*Math.PI*lp*n/Ns),imag:0};ph.push(z),nd.push(z.real)}setTimeout(()=>{console.time("parallelFFT with file (CPU)"),np(ph,Ns,1).then(n=>{console.timeEnd("parallelFFT with file (CPU)");let z=n.freqs,q=n.amplitudes,t={x:z,y:q,type:"line",name:"Amplitude Spectrum"},h={title:"Threaded 2-radix FFT Output",xaxis:{title:"Frequency (Hz)"},yaxis:{title:"Amplitude"}};globalThis.Plotly.newPlot("plot",[t],h),setTimeout(()=>{console.time("parallelFFT with dynamic importing function (CPU)"),np(ph,Ns,1,!1).then(p=>{console.timeEnd("parallelFFT with dynamic importing function (CPU)")})},1e3)})},5e3);async function ad({inputArray:n,sampleRate:z,frequencyResolution:q}){if(!self.DFT){class t{static async create(p=null){p||(p=await(await navigator.gpu.requestAdapter()).requestDevice());let l=new t;return await l.init(p),l}async init(p=null){this.device=p,this.bindGroupLayout=this.device.createBindGroupLayout({entries:[{binding:0,visibility:GPUShaderStage.COMPUTE,buffer:{type:"read-only-storage"}},{binding:1,visibility:GPUShaderStage.COMPUTE,buffer:{type:"storage"}}]}),this.pipelineLayout=this.device.createPipelineLayout({bindGroupLayouts:[this.bindGroupLayout]}),this.shaderModule=this.device.createShaderModule({code:`
                
        struct InputData {
            values : array<f32>
        }
        
        struct OutputData {
            values: array<f32>
        }
        
        @group(0) @binding(0)
        var<storage, read> inputData: InputData;
        
        @group(0) @binding(1)
        var<storage, read_write> outputData: OutputData;
        
        @compute @workgroup_size(256)
        fn main(
            @builtin(global_invocation_id) globalId: vec3<u32>
        ) {
            let N = arrayLength(&inputData.values);
            let k = globalId.x;
            var sum = vec2<f32>(0.0, 0.0);
        
            for (var n = 0u; n < N; n = n + 1u) {
                let phase = 2.0 * 3.14159265359 * f32(k) * f32(n) / f32(N);
                sum = sum + vec2<f32>(
                    inputData.values[n] * cos(phase),
                    -inputData.values[n] * sin(phase)
                );
            }
        
            let outputIndex = k * 2;
            if (outputIndex + 1 < arrayLength(&outputData.values)) {
                outputData.values[outputIndex] = sum.x;
                outputData.values[outputIndex + 1] = sum.y;
            }
        }
        
        `}),this.computePipeline=this.device.createComputePipeline({layout:this.pipelineLayout,compute:{module:this.shaderModule,entryPoint:"main"}})}process(p,l,e){let o=this.device.createBuffer({size:p.byteLength,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC,mappedAtCreation:!0});new Float32Array(o.getMappedRange()).set(p),o.unmap();let r=this.device.createBuffer({size:p.byteLength*2,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST|GPUBufferUsage.COPY_SRC});this.bindGroup=this.device.createBindGroup({layout:this.bindGroupLayout,entries:[{binding:0,resource:{buffer:o}},{binding:1,resource:{buffer:r}}]});let i=this.device.createCommandEncoder(),u=i.beginComputePass();u.setPipeline(this.computePipeline),u.setBindGroup(0,this.bindGroup),u.dispatchWorkgroups(Math.ceil(p.length/64)),u.end();let s=this.device.createBuffer({size:r.size,usage:GPUBufferUsage.MAP_READ|GPUBufferUsage.COPY_DST});return i.copyBufferToBuffer(r,0,s,0,r.size),this.device.queue.submit([i.finish()]),new Promise(a=>{s.mapAsync(GPUMapMode.READ).then(()=>{let c=s.getMappedRange(),f=new Float32Array(c),g=new Float32Array(f.length);g.set(f),s.unmap(),a({message:g,transfer:[g.buffer]})})})}}self.DFT=await t.create()}return self.DFT.process(n,z,q)}var If=new Float32Array(Ns);for(let n=0;n<Ns;n++)If[n]=cp*Math.sin(2*Math.PI*lp*n/Ns);var ap=new Float32Array(If);console.time("WGSL DFT Thread");Wo(ad).then(n=>{n.run({inputArray:If,sampleRate:Ns,frequencyResolution:1},[If.buffer]).then(z=>{console.timeEnd("WGSL DFT Thread");function q(i){let u=i.length/2,s=new Float32Array(i.length);return s.set(i.subarray(u),0),s.set(i.subarray(0,u),u),s}let t=q(z),h=[];for(let i=0;i<t.length;i+=2){let u=t[i],s=t[i+1],a=4*Math.sqrt(u*u+s*s)/t.length;h.push(a)}let p=[],l=z.length/2,e=Ns/l;for(let i=0;i<l/2;i++)p[i]=-Ns/2+i*e;for(let i=l/2;i<l;i++)p[i]=e*(i-l/2);let o={x:p,y:h,type:"line"};document.body.insertAdjacentHTML("beforeend",'<div id="plot3"></div>');let r={title:"DFT Magnitude Spectrum",xaxis:{title:"Frequency (Hz)"},yaxis:{title:"Magnitude"}};Plotly.newPlot("plot3",[o],r),console.time("WGSL DFT Thread Run 2"),n.run({inputArray:ap,sampleRate:Ns,frequencyResolution:1},[ap.buffer]).then(i=>{console.timeEnd("WGSL DFT Thread Run 2"),n.terminate()})})});document.body.style.backgroundColor="#101010";document.body.style.color="white";var dh=document.createElement("div");dh.innerHTML="Hello World!";dh.id="floatingDiv";document.body.appendChild(dh);console.warn("Tinybuild successful!");var Cf=document.getElementById("floatingDiv"),Lf=0,Pf=0,ip=2,op=2;function up(){Lf+=ip,Pf+=op,(Lf<=0||Lf+Cf.offsetWidth>=window.innerWidth)&&(ip*=-1),(Pf<=0||Pf+Cf.offsetHeight>=window.innerHeight)&&(op*=-1),Cf.style.left=Lf+"px",Cf.style.top=Pf+"px",requestAnimationFrame(up)}requestAnimationFrame(up);})();
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/
/*!
 * pad-left <https://github.com/jonschlinkert/pad-left>
 *
 * Copyright (c) 2014-2015, Jon Schlinkert.
 * Licensed under the MIT license.
 */
/*
 * @copyright 2016 Sean Connelly (@voidqk), http://syntheti.cc
 * @license MIT
 * @preserve Project Home: https://github.com/voidqk/polybooljs
 */
/*!
 * repeat-string <https://github.com/jonschlinkert/repeat-string>
 *
 * Copyright (c) 2014-2015, Jon Schlinkert.
 * Licensed under the MIT License.
 */
