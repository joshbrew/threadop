(()=>{var A=Object.defineProperty;var v=(t,g)=>{for(var f in g)A(t,f,{get:g[f],enumerable:!0})};var P={};v(P,{default:()=>B,generateWorkerURL:()=>N,initWorker:()=>D,threadop:()=>C,workerFnString:()=>L});function C(t=W=>W,{imports:g,message:f,transfer:r,port:n,blocking:l,pool:d,loop:u,animate:y,callback:S}={}){return new Promise((W,M)=>{let O;if(typeof t!="function"){if(typeof t=="string"&&t.startsWith("./")){let i=location.origin,a=location.pathname.split("/");a.pop();let c=a.join("/");c.startsWith("http")?i+="/":i+=c+"/",t=i+t}O=t}else O=N(t,g);let K=i=>{let a={},c=!1;i.onmessage=s=>{for(let e in a)a[e](s.data.message,s.data.cb)},i.onerror=s=>{console.error(new Error("Worker encountered an error: "+s.message))};let R=(s,e,o)=>new Promise((b,p)=>{if(!o&&i.PORTS)i.postMessage({message:s,overridePort:o},e),b(!0);else{if(l){if(c)return new Promise((h,T)=>{T("Thread Blocked")});c=!0}let E=Math.random();a[E]=(h,T)=>{E===T&&(delete a[E],l&&(c=!1),b(h))},i.postMessage({message:s,cb:E,overridePort:o},e)}}),m={run:(s,e,o)=>R(s,e,o),terminate:()=>{if(URL.revokeObjectURL(O),i.terminate(),i.PORTS){let s=(e,o)=>{e.postMessage({COMMAND:{DELETED:i.id}})};i.PORTS.forEach(s)}},addPort:s=>k(i,s,l),addCallback:(s=o=>{},e)=>{let o=Math.random();return a[o]=e?b=>{s(b),delete a[o]}:s,o},removeCallback:s=>{delete m.callbacks[s]},setLoop:(s,e,o)=>{i.postMessage({message:e,COMMAND:{SETLOOP:s}},o)},setAnimation:(s,e)=>{i.postMessage({message:s,COMMAND:{SETANIM:!0}},e)},stop:()=>{i.postMessage({COMMAND:{STOP:!0}})},worker:i,callbacks:a,id:i.id};return S&&m.addCallback(S),u?m.setLoop(u,f,r):y&&m.setAnimation(f,r),m};if(d){let c=function(){let m=new Worker(O,g||typeof t!="function"?{type:"module"}:void 0),s=Math.random();return m.id=s,i[s]=m,s},i={},a={};for(let m=0;m<d;m++)c();let R=Object.keys(i);if(n&&R.forEach((m,s)=>{let e=i[m];Array.isArray(n)?n.length===R.length?k(e,n[s],l):n.forEach(o=>{k(e,o,l)}):k(e,n,l)}),f&&!u&&!y)Promise.all(R.map((m,s)=>{let e=i[m],o=Array.isArray(f)?f[s]:f;return new Promise((b,p)=>{e.onmessage=h=>{Promise.resolve().then(()=>{e.terminate(),delete i[e.id]}),b(h.data.message)},e.onerror=h=>{Promise.resolve().then(()=>{e.terminate(),delete i[e.id]}),p(new Error("Worker encountered an error: "+h.message))};let E={message:o,oneOff:!0};e.postMessage(E,r)})})).then(m=>{URL.revokeObjectURL(O),W(m)}).catch(m=>{URL.revokeObjectURL(O),Object.keys(i).map((s,e)=>{let o=i[s];o&&o.terminate(),delete i[s],delete a.helpers?.[s]}),M(m)});else{let m=0;Object.assign(a,{workers:i,helpers:{},keys:R,run:(e,o,b,p)=>{if(p)return a.helpers[p]?.run(e,o);if(Array.isArray(e)){let E=e.length,h=[];for(let T=0;T<E;T++){let I=a.helpers[R[m]].run(e[T],o[T],b);m++,m>=R.length&&(m=0),h.push(I)}return h}else{let E=a.helpers[R[m]].run(e,o,b);return m++,m>=R.length&&(m=0),E}},terminate:e=>{function o(b){a.helpers[b]?.terminate(),delete a.helpers[b],delete a.workers[b]}e?o(e):R.forEach(o)},addWorker:()=>{let e=c(),o=i[e];return s(o),R.length=0,R.push(...R),e},addPort:(e,o)=>{function b(p){return a.helpers[p]?.addPort(e),!0}return o?b(o):R.map(b)},addCallback:(e,o,b)=>{function p(E){return a.helpers[E]?.addCallback(e,o)}return b?p(b):R.map(p)},removeCallback:(e,o)=>{function b(p){return a.helpers[p]?.removeCallback(e),!0}return o?b(o):R.map(b)},setLoop:(e,o,b,p)=>{function E(h){a.helpers[h]?.setLoop(e,o,b)}return p?E(p):R.map(E)},setAnimation:(e,o,b)=>{function p(E){a.helpers[E]?.setAnimation(e,o)}return b?p(b):R.map(p)},stop:e=>{function o(b){a.helpers[b]?.stop()}return e?o(e):R.map(o)}});let s=e=>{a.helpers[e.id]=K(e)};Object.keys(i).forEach((e,o)=>{s(i[e])}),W(a)}}else{let i=Math.random(),a=new Worker(O,g||typeof t!="function"?{type:"module"}:void 0);if(a.id=i,n&&(n.id||(n.id=Math.random()),Array.isArray(n)?n.map(c=>{k(a,c,l)}):k(a,n,l)),f&&!u&&!y)a.onmessage=c=>{Promise.resolve().then(()=>{a.terminate(),URL.revokeObjectURL(O)}),W(c.data.message)},a.onerror=c=>{Promise.resolve().then(()=>{a.terminate(),URL.revokeObjectURL(O)}),M(new Error("Worker encountered an error: "+c.message))},a.postMessage({message:f,oneOff:!0},r);else{let c=K(a);W(c)}}})}function j(t){let g=location.pathname.split("/");g.pop();let f=location.origin+g.join("/")+"/";return typeof t=="string"?(t.startsWith("./")&&(t=f+t),t.includes("import")?`${t}`:`import '${t}';`):Array.isArray(t)?t.map(r=>(r.startsWith("./")&&(r=f+r),r.includes("import")?r:`import '${r}';`)).join(`
`):typeof t=="object"?Object.entries(t).map(([n,l])=>(n.startsWith("./")&&(n=f+n),typeof l=="string"?`import ${l} from '${n}';`:typeof l=="boolean"&&l?`import '${n}'`:`import { ${Object.entries(l).map(([u,y])=>typeof y=="string"?`${u} as ${y}`:u).join(", ")} } from '${n}';`)).join(`
`)+"":""}function k(t,g,f){let r=new MessageChannel;t.id||(t.id=Math.random()),g.id||(g.id=Math.random()),t.postMessage({COMMAND:{SENDER:r.port1,id:g.id,blocking:f}},[r.port1]),g.postMessage({COMMAND:{RECEIVER:r.port2,id:t.id,blocking:f}},[r.port2]),t.PORTS||(t.PORTS=[]),t.PORTS.push(g),g.PORTS||(g.PORTS=[]),g.PORTS.push(t)}var D=(t=()=>{})=>{globalThis.WORKER={},t=t.bind(globalThis.WORKER);let g=(r,n,l,d)=>{if(globalThis.WORKER.SENDERS&&d!==!0)if(d!==void 0&&d!=="both")globalThis.WORKER.SENDERS[d]&&(r?.message?globalThis.WORKER.SENDERS[d].postMessage({message:r.message,overridePort:r?.overridePort},r.transfer):globalThis.WORKER.SENDERS[d].postMessage({message:r,overridePort:r?.overridePort}));else{for(let u in globalThis.WORKER.SENDERS){if(globalThis.WORKER.BLOCKING[u]){if(globalThis.WORKER.BLOCKED[u]){console.error("Thread Blocked: "+u);continue}globalThis.WORKER.BLOCKED[u]=!0}r?.message?globalThis.WORKER.SENDERS[u].postMessage({message:r.message,overridePort:r?.overridePort},r.transfer):globalThis.WORKER.SENDERS[u].postMessage({message:r,overridePort:r?.overridePort})}l&&postMessage(!0)}(!globalThis.WORKER.SENDERS||d===!0||d==="both")&&(r?.message?postMessage({message:r.message,cb:n,overridePort:r?.overridePort},r.transfer):postMessage({message:r,cb:n,overridePort:r?.overridePort}))},f=(r,n)=>{let l=t(r.data?.message);l?.then?l.then(d=>{n&&n.postMessage(!0),g(d,r.data.cb,r.data.oneOff,r.data.overridePort)}):(n&&n.postMessage(!0),g(l,r.data.cb,r.data.oneOff,r.data.overridePort))};globalThis.onmessage=r=>{if(r.data?.COMMAND){let n=r.data.COMMAND;if(typeof n.SETLOOP=="number"){globalThis.WORKER.LOOP&&clearTimeout(globalThis.WORKER.LOOP);let l=()=>{f(r),globalThis.WORKER.LOOP=setTimeout(()=>{l()},n.SETLOOP)};l()}if(n.SETANIM){globalThis.WORKER.ANIM&&cancelAnimationFrame(globalThis.WORKER.ANIM);let l=()=>{f(r),globalThis.WORKER.ANIM=requestAnimationFrame(()=>{l()})};l()}if(n.STOP&&(globalThis.WORKER.LOOP&&clearTimeout(globalThis.WORKER.LOOP),globalThis.WORKER.ANIM&&cancelAnimationFrame(globalThis.WORKER.ANIM)),n.RECEIVER){let l=n.blocking;globalThis.WORKER.RECEIVERS||(globalThis.WORKER.RTCR=0,globalThis.WORKER.RECEIVERS={});let d=n.id;globalThis.WORKER.RECEIVERS[d]=n.RECEIVER,globalThis.WORKER.RTCR++,n.RECEIVER.onmessage=u=>{f(u,l?n.RECEIVER:void 0)},n.RECEIVER.onerror=u=>{delete globalThis.WORKER.RECEIVERS[d]}}if(n.SENDER){globalThis.WORKER.SENDERS||(globalThis.WORKER.PCTR=0,globalThis.WORKER.SENDERS={},globalThis.WORKER.BLOCKING={},globalThis.WORKER.BLOCKED={});let l=n.blocking,d=n.id?n.id:globalThis.WORKER.PCTR;globalThis.WORKER.SENDERS[d]=n.SENDER,globalThis.WORKER.PCTR++,l&&(globalThis.WORKER.BLOCKING[d]=!0),n.SENDER.onmessage=u=>{globalThis.WORKER.BLOCKING[d]&&(globalThis.WORKER.BLOCKED[d]=!1)},n.SENDER.onerror=u=>{delete globalThis.WORKER.SENDERS[d]}}n.DELETED&&(delete globalThis.WORKER.RECEIVERS?.[n.DELETED],delete globalThis.WORKER.SENDERS?.[n.DELETED])}else f(r)},globalThis.onerror=r=>{console.error(r)}},L=D.toString(),N=(t,g)=>{let f=L.replace("()=>{}",t.toString()),n=`${j(g)}

(${f})()`,l=new Blob([n],{type:"application/javascript"});return URL.createObjectURL(l)},B=C;["threadop","initWorker"].forEach(t=>{P[t]&&(globalThis[t]=P[t])});})();
