(()=>{var O=Object.defineProperty;var L=(a,n)=>{for(var d in n)O(a,d,{get:n[d],enumerable:!0})};var T={};L(T,{default:()=>N,threadop:()=>P});function P(a=f=>f,{imports:n,message:d,transfer:b,port:s,blocking:g}={}){return new Promise((f,m)=>{let c=Math.random(),D=(()=>{let l=(r,i)=>{if(globalThis.SENDERS)for(let e in globalThis.SENDERS){if(globalThis.BLOCKING[e]){if(globalThis.BLOCKED[e]){console.error("Thread Blocked: "+e);continue}globalThis.BLOCKED[e]=!0}globalThis.SENDERS[e].postMessage({message:r,cb:i})}else postMessage({message:r,cb:i})},E=(r,i)=>{let e=(()=>{})(r.data.message);e?.then?e.then(t=>{i&&i.postMessage(!0),l(t,r.data.cb)}):(i&&i.postMessage(!0),l(e,r.data.cb))};globalThis.onmessage=r=>{if(r.data?.RECEIVER){let i=r.data.blocking;globalThis.RECEIVERS||(globalThis.RTCR=0,globalThis.RECEIVERS={});let e=r.data.id;globalThis.RECEIVERS[e]=r.data.RECEIVER,globalThis.RTCR++,r.data.RECEIVER.onmessage=t=>{E(t,i?r.data.RECEIVER:void 0)},r.data.RECEIVER.onerror=t=>{delete globalThis.RECEIVER[e]}}else if(r.data?.SENDER){globalThis.SENDERS||(globalThis.PCTR=0,globalThis.SENDERS={},globalThis.BLOCKING={},globalThis.BLOCKED={});let i=r.data.blocking,e=r.data.id?r.data.id:globalThis.PCTR;globalThis.SENDERS[e]=r.data.SENDER,globalThis.PCTR++,i&&(globalThis.BLOCKING[e]=!0),r.data.SENDER.onmessage=t=>{globalThis.BLOCKING[e]&&(globalThis.BLOCKED[e]=!1)},r.data.SENDER.onerror=t=>{delete globalThis.SENDERS[e]}}else r.data?.DELETED?(delete globalThis.RECEIVERS?.[r.data.DELETED],delete globalThis.SENDERS?.[r.data.DELETED]):E(r)},globalThis.onerror=r=>{console.error(r)}}).toString().replace("()=>{}",a.toString()),C=`${M(n)}
(${D})()`,I=new Blob([C],{type:"application/javascript"}),h=URL.createObjectURL(I),o=new Worker(h,n?{type:"module"}:void 0);if(s&&y(o,s,c,g),d)o.onmessage=l=>{Promise.resolve().then(()=>{o.terminate(),URL.revokeObjectURL(h)}),f(l.data.message)},o.onerror=l=>{Promise.resolve().then(()=>{o.terminate(),URL.revokeObjectURL(h)}),m(new Error("Worker encountered an error: "+l.message))},o.postMessage({message:d},b);else{let l={},E=!1;o.onmessage=e=>{for(let t in l)l[t](e.data.message,e.data.cb)},o.onerror=e=>{console.error(new Error("Worker encountered an error: "+e.message))};let r=(e,t)=>new Promise((p,S)=>{if(o.PORTS)o.postMessage({message:e},t),p(!0);else{if(g){if(E)return new Promise((k,u)=>{u("Thread Blocked")});E=!0}let R=Math.random();l[R]=(k,u)=>{R===u&&(delete l[R],g&&(E=!1),p(k))},o.postMessage({message:e,cb:R},t)}}),i={run:(e,t)=>r(e,t),terminate:()=>{if(URL.revokeObjectURL(h),o.terminate(),o.PORTS){let e=(t,p)=>{t.postMessage({DELETED:c})};o.PORTS.forEach(e)}},addPort:e=>y(o,e,c,g),addCallback:(e=p=>{},t)=>{let p=Math.random();return l[p]=t?S=>{e(S),delete l[p]}:e,p},removeCallback:e=>{delete i.callbacks[e]},worker:o,callbacks:l};f(i)}})}function M(a){let n=location.pathname.split("/");n.pop();let d=location.origin+n.join("/")+"/";return typeof a=="string"?(a.startsWith("./")&&(a=d+a),a.includes("import")?`${a}`:`import '${a}';`):Array.isArray(a)?a.map(b=>(b.startsWith("./")&&(b=d+b),b.includes("import")?b:`import '${b}';`)).join(`
`):typeof a=="object"?Object.entries(a).map(([s,g])=>(s.startsWith("./")&&(s=d+s),typeof g=="string"?`import ${g} from '${s}';`:typeof g=="boolean"&&g?`import '${s}'`:`import { ${Object.entries(g).map(([m,c])=>typeof c=="string"?`${m} as ${c}`:m).join(", ")} } from '${s}';`)).join(`
`)+"":""}function y(a,n,d,b){let s=new MessageChannel;a.postMessage({SENDER:s.port1,id:d,blocking:b},[s.port1]),n.postMessage({RECEIVER:s.port2,id:d,blocking:b},[s.port2]),a.PORTS||(a.PORTS=[]),a.PORTS.push(n),n.PORTS||(n.PORTS=[]),n.PORTS.push(a)}var N=P;["threadop"].forEach(a=>{T[a]&&(globalThis[a]=T[a])});})();
