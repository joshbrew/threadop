(()=>{var D=Object.defineProperty;var A=(b,u)=>{for(var d in u)D(b,d,{get:u[d],enumerable:!0})};var W={};A(W,{default:()=>j,threadop:()=>K});function K(b=T=>T,{imports:u,message:d,transfer:R,port:p,blocking:c,pool:k,loop:E,animate:O,callback:P}={}){return new Promise((T,S)=>{let C=(()=>{globalThis.WORKER={};let s=(i,a,n)=>{if(globalThis.WORKER.SENDERS)for(let r in globalThis.WORKER.SENDERS){if(globalThis.WORKER.BLOCKING[r]){if(globalThis.WORKER.BLOCKED[r]){console.error("Thread Blocked: "+r);continue}globalThis.WORKER.BLOCKED[r]=!0}globalThis.WORKER.SENDERS[r].postMessage({message:i,cb:a}),n&&postMessage(!0)}else postMessage({message:i,cb:a})},t=(i,a)=>{let n=(()=>{})(i.data?.message);n?.then?n.then(r=>{a&&a.postMessage(!0),s(r,i.data.cb,i.data.oneOff)}):(a&&a.postMessage(!0),s(n,i.data.cb,i.data.oneOff))};globalThis.onmessage=i=>{if(i.data?.COMMAND){let a=i.data.COMMAND;if(typeof a.SETLOOP=="number"){globalThis.WORKER.LOOP&&clearTimeout(globalThis.WORKER.LOOP);let n=()=>{t(i),globalThis.WORKER.LOOP=setTimeout(()=>{n()},a.SETLOOP)};n()}if(a.SETANIM){globalThis.WORKER.ANIM&&cancelAnimationFrame(globalThis.WORKER.ANIM);let n=()=>{t(i),globalThis.WORKER.ANIM=requestAnimationFrame(()=>{n()})};n()}if(a.STOP&&(globalThis.WORKER.LOOP&&clearTimeout(globalThis.WORKER.LOOP),globalThis.WORKER.ANIM&&cancelAnimationFrame(globalThis.WORKER.ANIM)),a.RECEIVER){let n=a.blocking;globalThis.WORKER.RECEIVERS||(globalThis.WORKER.RTCR=0,globalThis.WORKER.RECEIVERS={});let r=a.id;globalThis.WORKER.RECEIVERS[r]=a.RECEIVER,globalThis.WORKER.RTCR++,a.RECEIVER.onmessage=e=>{t(e,n?a.RECEIVER:void 0)},a.RECEIVER.onerror=e=>{delete globalThis.WORKER.RECEIVERS[r]}}if(a.SENDER){globalThis.WORKER.SENDERS||(globalThis.WORKER.PCTR=0,globalThis.WORKER.SENDERS={},globalThis.WORKER.BLOCKING={},globalThis.WORKER.BLOCKED={});let n=a.blocking,r=a.id?a.id:globalThis.WORKER.PCTR;globalThis.WORKER.SENDERS[r]=a.SENDER,globalThis.WORKER.PCTR++,n&&(globalThis.WORKER.BLOCKING[r]=!0),a.SENDER.onmessage=e=>{globalThis.WORKER.BLOCKING[r]&&(globalThis.WORKER.BLOCKED[r]=!1)},a.SENDER.onerror=e=>{delete globalThis.WORKER.SENDERS[r]}}a.DELETED&&(delete globalThis.WORKER.RECEIVERS?.[a.DELETED],delete globalThis.WORKER.SENDERS?.[a.DELETED])}else t(i)},globalThis.onerror=i=>{console.error(i)}}).toString().replace("()=>{}",b.toString()),L=`${N(u)}
(${C})()`,I=new Blob([L],{type:"application/javascript"}),h=URL.createObjectURL(I),M=s=>{let t={},i=!1;s.onmessage=r=>{for(let e in t)t[e](r.data.message,r.data.cb)},s.onerror=r=>{console.error(new Error("Worker encountered an error: "+r.message))};let a=(r,e)=>new Promise((o,l)=>{if(s.PORTS)s.postMessage({message:r},e),o(!0);else{if(c){if(i)return new Promise((f,g)=>{g("Thread Blocked")});i=!0}let m=Math.random();t[m]=(f,g)=>{m===g&&(delete t[m],c&&(i=!1),o(f))},s.postMessage({message:r,cb:m},e)}}),n={run:(r,e)=>a(r,e),terminate:()=>{if(URL.revokeObjectURL(h),s.terminate(),s.PORTS){let r=(e,o)=>{e.postMessage({COMMAND:{DELETED:s.id}})};s.PORTS.forEach(r)}},addPort:r=>y(s,r,s.id,c),addCallback:(r=o=>{},e)=>{let o=Math.random();return t[o]=e?l=>{r(l),delete t[o]}:r,o},removeCallback:r=>{delete n.callbacks[r]},setLoop:(r,e,o)=>{s.postMessage({message:e,COMMAND:{SETLOOP:r}},o)},setAnimation:(r,e)=>{s.postMessage({message:r,COMMAND:{SETANIM:!0}},e)},stop:()=>{s.postMessage({COMMAND:{STOP:!0}})},worker:s,callbacks:t};return P&&n.addCallback(P),E?n.setLoop(E,d,R):O&&n.setAnimation(d,R),n};if(k){let i=function(){let n=new Worker(h,u?{type:"module"}:void 0),r=Math.random();return n.id=r,s[r]=n,r},s={},t={};for(let n=0;n<k;n++)i();let a=Object.keys(s);if(p&&a.forEach((n,r)=>{let e=s[n];Array.isArray(p)?y(e,p[r],e.id,c):y(e,p,e.id,c)}),d&&!E&&!O)Promise.all(a.map((n,r)=>{let e=s[n],o=Array.isArray(d)?d[r]:d;return new Promise((l,m)=>{e.onmessage=g=>{Promise.resolve().then(()=>{e.terminate(),delete s[e.id]}),l(g.data.message)},e.onerror=g=>{Promise.resolve().then(()=>{e.terminate(),delete s[e.id]}),m(new Error("Worker encountered an error: "+g.message))};let f={message:o,oneOff:!0};e.postMessage(f,R)})})).then(n=>{URL.revokeObjectURL(h),T(n)}).catch(n=>{URL.revokeObjectURL(h),Object.keys(s).map((r,e)=>{let o=s[r];o&&o.terminate(),delete s[r],delete t.helpers?.[r]}),S(n)});else{let n=0;Object.assign(t,{workers:s,helpers:{},keys:a,run:(e,o,l)=>{if(l)t.helpers[l]?.run(e,o);else if(Array.isArray(e)){let m=e.length;for(let f=0;f<m;f++)t.helpers[a[n]].run(e[f],o[f]),n++,n>=a.length&&(n=0)}else t.helpers[a[n]].run(e,o),n++,n>=a.length&&(n=0)},terminate:e=>{function o(l){t.helpers[l]?.terminate(),delete t.helpers[l],delete t.workers[l]}e?o(e):a.forEach(o)},addWorker:()=>{let e=i(),o=s[e];return r(o),a.length=0,a.push(...a),e},addPort:(e,o)=>{function l(m){return t.helpers[m]?.addPort(e),!0}return o?l(o):a.map(l)},addCallback:(e,o,l)=>{function m(f){return t.helpers[f]?.addCallback(e,o)}return l?m(l):a.map(m)},removeCallback:(e,o)=>{function l(m){return t.helpers[m]?.removeCallback(e),!0}return o?l(o):a.map(l)},setLoop:(e,o,l,m)=>{function f(g){t.helpers[g]?.setLoop(e,o,l)}return m?f(m):a.map(f)},setAnimation:(e,o,l)=>{function m(f){t.helpers[f]?.setAnimation(e,o)}return l?m(l):a.map(m)},stop:e=>{function o(l){t.helpers[l]?.stop()}return e?o(e):a.map(o)}});let r=e=>{t.helpers[e.id]=M(e)};Object.keys(s).forEach((e,o)=>{r(s[e])}),T(t)}}else{let s=Math.random(),t=new Worker(h,u?{type:"module"}:void 0);if(t.id=s,p&&(Array.isArray(p)?p.map(i=>{y(t,i,s,c)}):y(t,p,s,c)),d&&!E&&!O)t.onmessage=i=>{Promise.resolve().then(()=>{t.terminate(),URL.revokeObjectURL(h)}),T(i.data.message)},t.onerror=i=>{Promise.resolve().then(()=>{t.terminate(),URL.revokeObjectURL(h)}),S(new Error("Worker encountered an error: "+i.message))},t.postMessage({message:d,oneOff:!0},R);else{let i=M(t);T(i)}}})}function N(b){let u=location.pathname.split("/");u.pop();let d=location.origin+u.join("/")+"/";return typeof b=="string"?(b.startsWith("./")&&(b=d+b),b.includes("import")?`${b}`:`import '${b}';`):Array.isArray(b)?b.map(R=>(R.startsWith("./")&&(R=d+R),R.includes("import")?R:`import '${R}';`)).join(`
`):typeof b=="object"?Object.entries(b).map(([p,c])=>(p.startsWith("./")&&(p=d+p),typeof c=="string"?`import ${c} from '${p}';`:typeof c=="boolean"&&c?`import '${p}'`:`import { ${Object.entries(c).map(([E,O])=>typeof O=="string"?`${E} as ${O}`:E).join(", ")} } from '${p}';`)).join(`
`)+"":""}function y(b,u,d,R){let p=new MessageChannel;b.postMessage({COMMAND:{SENDER:p.port1,id:d,blocking:R}},[p.port1]),u.postMessage({COMMAND:{RECEIVER:p.port2,id:d,blocking:R}},[p.port2]),b.PORTS||(b.PORTS=[]),b.PORTS.push(u),u.PORTS||(u.PORTS=[]),u.PORTS.push(b)}var j=K;["threadop"].forEach(b=>{W[b]&&(globalThis[b]=W[b])});})();
